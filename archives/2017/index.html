<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>phpsmarter</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
</head>
<body class="home">
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="phpsmarter"><span class="octicon octicon-mark-github"></span> phpsmarter</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="首页">首页</a>
        
              
              <a href="/category/" target="true" class=" site-header-nav-item hvr-underline-from-center" title="分类">分类</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="开源项目">开源项目</a>
        
              
              <a href="/message/"  class=" site-header-nav-item hvr-underline-from-center" title="留言板">留言板</a>
        
      </nav>
  </div>
</header>

	<section class="banner-false">
    <div class="collection-head">
        <div class="container">
            <div class="collection-title">
                <h1 class="collection-header" id="site-description">
                    
                </h1>
                <div class="collection-info">
                    
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-location">
                                   
                                        ChengDu, China
                                    
                                </span>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-mark-github">
                                   
                                </span>
                                
                                    <a href="http://github.com/yumemor" target="_blank">yumemor</a>
                                
                            
                        </span>
                    
                </div>
            </div>
        </div>
    </div>
</section>
	   <section class="container">
    <div class="columns">
        <div class="column two-thirds">
            
                  <article id="post-javascript桥接模式(1)-队列数据结构" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/javascript桥接模式(1)-队列数据结构/">javascript桥接模式(1)-队列数据结构</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>根据书上例子的实际要求，涉及到js队列的问题。所以先把js中队列的具体实现数据结构贴出来。具体参考《学习javascript数据结构和算法》第四章。<br>队列数据结构遵循先入先出的原则。入队操作添加到数组的末尾，返回新数组。出队操作弹出数组第一个元素，返回新数组。两个操作对于数组都有结构的改变</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//js中队列的实现是依赖数组的数据结构</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];  <span class="comment">//初始化空数组，let关键字是es6中的</span></div><div class="line">    <span class="comment">//用于形成大括号包围的作用域</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123; <span class="comment">//入队操作</span></div><div class="line">        items.push(element); <span class="comment">//数组push操作</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//出对</span></div><div class="line">        <span class="keyword">return</span> items.shift(); <span class="comment">//数组shift操作</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//队列第一个元素</span></div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];     <span class="comment">//数组第一个元素</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//判断队列有无成员</span></div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>; <span class="comment">//布尔值判断</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//清空队列</span></div><div class="line">        items = [];   <span class="comment">//变量重新赋值空数组</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//获得队列的长度</span></div><div class="line">        <span class="keyword">return</span> items.length; </div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//打印队列</span></div><div class="line">        <span class="built_in">console</span>.log(items.toString());</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>下面是优先队列。数据成员入队的时候要携带数据和优先级。<br>优先级在这里的定义是数字越大在数组中的位置靠后。当插入一个数组元素的时候，先要根据它的优先级来判断，最小是直接插入到第一位，紧邻一个比他大的优先级是，就插入到这个邻居的前面。如果是最大的数字就插到数组的最后。<br>一维数组变成了二位数组。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PriorityQueue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">QueueElement</span> (<span class="params">element, priority</span>)</span>&#123; </div><div class="line">            <span class="keyword">this</span>.element = element;<span class="comment">//成员本身</span></div><div class="line">        <span class="keyword">this</span>.priority = priority;  <span class="comment">//优先级</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element, priority</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> queueElement = <span class="keyword">new</span> QueueElement(element, priority);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> added = <span class="literal">false</span>; <span class="comment">//添加标记</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (queueElement.priority &lt;            </div><div class="line"> items[i].priority)&#123;  <span class="comment">//找到优先级数字比他大的那个元素</span></div><div class="line"></div><div class="line">                items.splice(i,<span class="number">0</span>,queueElement);            </div><div class="line">             <span class="comment">// 插到这个元素的前面</span></div><div class="line">                added = <span class="literal">true</span>;</div><div class="line">                <span class="keyword">break</span>; <span class="comment">// 终止</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!added)&#123; <span class="comment">//如果是优先级数字是最大的，直接插入到</span></div><div class="line">        <span class="comment">//数组的末尾</span></div><div class="line">            items.push(queueElement); <span class="comment">//&#123;5&#125;</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="comment">//其他操作和普通队列是一样的</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.shift();</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//print使用了es6里的拼接字符串的方法</span></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;items[i].element&#125;</span>  - <span class="subst">$&#123;items[i].priority&#125;</span>`</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> priorityQueue = <span class="keyword">new</span> PriorityQueue();</div><div class="line">priorityQueue.enqueue(<span class="string">"John"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Jack"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Camila"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Maxwell"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Ana"</span>, <span class="number">3</span>);</div><div class="line">priorityQueue.print();</div><div class="line"><span class="comment">//=&gt;</span></div><div class="line"><span class="comment">//打印出的结果</span></div><div class="line">Jack  - <span class="number">1</span>  <span class="comment">//数组元素--优先级</span></div><div class="line">Camila  - <span class="number">1</span></div><div class="line">John  - <span class="number">2</span></div><div class="line">Maxwell  - <span class="number">2</span></div><div class="line">Ana  - <span class="number">3</span></div></pre></td></tr></table></figure>
<p>在这个队列的基础上可以实现javascript中桥接模式的例子。本文算是一个独立的javascript队列的介绍，也作为桥接模式例子的背景方法。<br><a href="http://www.apress.com/cn/book/9781590599082" target="_blank" rel="external">javascript设计模式 第八章-桥接模式</a></p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-24T11:04:10.000Z" itemprop="datePublished">2017-03-24</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-react-native视差滚动组件使用" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/react-native视差滚动组件使用/">react-native视差滚动组件使用</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p>看到许多app在界面上实现了头部的图片和文字的渐隐效果，在网上找到一个组件，实现了这个功能。如果要体现比较好的效果还需要在细节地方多研究。<br>这里写出来仅供学习的进一步的研究</p>
<p>   看看效果图</p>
<p><a href="https://github.com/phpsmarter/react-native-parallax-scroll-view" target="_blank" rel="external">react-native-parallax-scroll-view ,github地址</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-32c303299eff67ca.gif?imageMogr2/auto-orient/strip" alt="ScreenFlow.gif"><br>下面看一下代码<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> React, &#123; Component &#125; from <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  Dimensions,</div><div class="line">  Image,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">  AppRegistry,</div><div class="line">  StatusBar</div><div class="line">&#125; from <span class="string">'react-native'</span>;</div><div class="line"><span class="comment">//导入组件</span></div><div class="line"><span class="keyword">import</span> ParallaxScrollView from <span class="string">'react-native-parallax-scroll-view'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> window = Dimensions.<span class="built_in">get</span>(<span class="string">'window'</span>);<span class="comment">//获取宽度</span></div><div class="line">console.<span class="built_in">log</span>(window.<span class="built_in">width</span>);</div><div class="line"></div><div class="line">class Nested extends Component &#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View style=&#123;&#123; flex: <span class="number">1</span> &#125;&#125;&gt;</div><div class="line">         <span class="comment">//方向，可以为row</span></div><div class="line">        &lt;View style=&#123;&#123; flex: <span class="number">1</span>, flexDirection: <span class="string">'column'</span> &#125;&#125;&gt;</div><div class="line">          &lt;View style=&#123;&#123; <span class="built_in">width</span>: <span class="number">60</span>, backgroundColor: <span class="string">'red'</span> &#125;&#125;/&gt;</div><div class="line">         <span class="comment">//滚动效果都在下面这个组件</span></div><div class="line">          &lt;ParallaxScrollView</div><div class="line">              style=&#123;&#123; flex: <span class="number">1</span>, backgroundColor: <span class="string">'hotpink'</span>, overflow: <span class="string">'hidden'</span> &#125;&#125;</div><div class="line">             <span class="comment">//下面渲染背景</span></div><div class="line">              renderBackground=&#123;() =&gt;  &lt;Image style=&#123;&#123;<span class="built_in">width</span>:window.<span class="built_in">width</span>,<span class="built_in">height</span>:<span class="number">350</span>&#125;&#125; source=&#123;require(<span class="string">'./images/schedule-background.png'</span>)&#125;/&gt;&#125;</div><div class="line">             <span class="comment">//下面是渲染前景</span></div><div class="line">              renderForeground=&#123;() =&gt; (</div><div class="line">                &lt;View&gt;</div><div class="line">                &lt;View style=&#123;&#123;alignItems: <span class="string">'center'</span>, justifyContent: <span class="string">'center'</span>,marginTop:<span class="number">50</span>&#125;&#125;&gt;</div><div class="line">              </div><div class="line">                &lt;Image style=&#123;&#123;borderRadius:<span class="number">50</span></div><div class="line">              &#125;&#125; source=&#123;&#123;</div><div class="line">                  uri: <span class="string">'https://pbs.twimg.com/profile_images/2694242404/5b0619220a92d391534b0cd89bf5adc1_400x400.jpeg'</span>,</div><div class="line">                  <span class="built_in">width</span>: <span class="number">100</span>,</div><div class="line">                  <span class="built_in">height</span>: <span class="number">100</span></div><div class="line">                &#125;&#125;/&gt;</div><div class="line">                &lt;/View&gt;</div><div class="line">               </div><div class="line">                  &lt;Text style=&#123;&#123;paddingVertical: <span class="number">5</span>,<span class="built_in">textAlign</span>:<span class="string">'center'</span>,<span class="built_in">color</span>:<span class="string">'white'</span>&#125;&#125;&gt;</div><div class="line">                    Talks by Rich Hickey</div><div class="line">                   &lt;/Text&gt;</div><div class="line">                   &lt;Text style=&#123;&#123;paddingVertical: <span class="number">5</span> ,<span class="built_in">textAlign</span>:<span class="string">'center'</span>,<span class="built_in">color</span>:<span class="string">'white'</span>&#125;&#125;&gt;</div><div class="line">                    CTO of Cognitec, Creator of Clojure</div><div class="line">                  &lt;/Text&gt;</div><div class="line">                </div><div class="line">                &lt;/View&gt;</div><div class="line">                </div><div class="line">            )&#125;</div><div class="line">             <span class="comment">//渲染固定头部</span></div><div class="line">              renderFixedHeader=&#123;() =&gt; &lt;Text style=&#123;&#123; <span class="built_in">textAlign</span>: <span class="string">'right'</span>, <span class="built_in">color</span>: <span class="string">'white'</span>, padding: <span class="number">5</span>, fontSize: <span class="number">20</span>,marginTop:<span class="number">20</span> &#125;&#125;&gt;Hello&lt;/Text&gt;&#125;</div><div class="line">              parallaxHeaderHeight=&#123; <span class="number">350</span> &#125;&gt;</div><div class="line">                        &lt;View style=&#123;&#123; alignItems: <span class="string">'center'</span>&#125;&#125;&gt;&lt;Text style=&#123;&#123; fontSize: <span class="number">20</span> ,backgroundColor:<span class="string">"#519caf"</span>,<span class="built_in">width</span>:window.<span class="built_in">width</span>,<span class="built_in">textAlign</span>:<span class="string">'center'</span>&#125;&#125;&gt;This is parallaxbox&lt;/Text&gt;&lt;/View&gt;          </div><div class="line"></div><div class="line">          &lt;/ParallaxScrollView&gt;</div><div class="line">          </div><div class="line">        &lt;/View&gt;</div><div class="line">        &lt;View style=&#123;&#123; <span class="built_in">height</span>: <span class="number">30</span>, backgroundColor: <span class="string">'#6577cc'</span> &#125;&#125;/&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export <span class="keyword">default</span> Nested;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">AppRegistry.registerComponent(<span class="string">'parallaxBox'</span>, () =&gt; Nested);</div></pre></td></tr></table></figure></p>
<p>背景图片用了一张f8app的背景图片，曲线有动态变化效果。<br>这个组件的api还是有一些，用好了效果就出来了。具体的看github介绍</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:44:17.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/React-native/' title=''>React-native</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Velocity动画库学习" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/Velocity动画库学习/">Velocity动画库学习</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p><img src="http://upload-images.jianshu.io/upload_images/2044710-a6a2735312d5c432.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240" alt="1661.987.big.jpg.png"></p>
<blockquote>
<p>看velocity.js的内容有段时间了，源于图片这本书。前面看直观的感受是：这个库的操作很简单。要解决一个rn的动画问题，把这本书又拿出来看，刚好看到也有了velocity-react版，考虑是否以后可以用在react-native上，这样的话应用范围就大很多。<br><a href="http://velocityjs.org" target="_blank" rel="external">Velocity.js文档</a><br><a href="https://github.com/twitter-fabric/velocity-react" target="_blank" rel="external">velocity-react github地址</a>；<br><a href="https://fabric.io/blog/introducing-the-velocityreact-library" target="_blank" rel="external">velocity-react的内容</a>；</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-a00dfb63a7e5f09d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="1443477710321.png"><br>初始化比较简单，网页中先导入jquery库，然后导入velocity.js库<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  //最好是配合jquery来使用，可以使用jquery的链式操作。</div><div class="line">  //jquery的函数操作在完成以后会有一句 return this,由此链式操作的</div><div class="line"> //的后一个方法的对象和前一个方法的对象是相同的</div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"lib/js/jquery.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"lib/js/velocity.min.js"</span>&gt;</span><span class="javascript">/script&gt; </span></div><div class="line">   $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $div=$(<span class="string">"div"</span>);   <span class="comment">//jQuery对象缓存起来</span></div><div class="line">    $div.velocity(&#123;<span class="attr">opacity</span>:<span class="number">0.5</span>&#125;);  <span class="comment">//调用方法</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><em>Velocity接受多个参数</em>，第一个参数是一个对象，用于将css属性映射到对应的目标值，第二个参数是指定动画的选项<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> $element.velocity(&#123;<span class="string">width:</span><span class="string">"500px"</span>,<span class="string">opacity:</span><span class="number">0.5</span>&#125;,&#123;<span class="string">duration:</span><span class="number">400</span>,<span class="string">easing:</span><span class="string">"swing"</span>&#125;)</div><div class="line"></div><div class="line"><span class="comment">//也可以使用简写</span></div><div class="line">$element.velocity(&#123;<span class="string">width:</span><span class="string">"500px"</span>,<span class="string">opacity:</span><span class="number">0.5</span>&#125;,<span class="number">400</span>，<span class="string">"ease-in-out"</span>);</div></pre></td></tr></table></figure></p>
<p><em>对于css属性，velocity不支持简写，只能一个一个的写，而且css属性也和react一样是驼峰命名。</em></p>
<p>链式操作；如果为了效率放弃使用jquery,那么就不能使用链式操作了<br>每个操作单独写就可以了。<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$elemnt</span><span class="selector-class">.velocity</span>(&#123;<span class="attribute">width</span>:<span class="string">"400px"</span>&#125;).velocity(&#123;opacity:<span class="number">0.6</span>&#125;);</div></pre></td></tr></table></figure></p>
<p>使用这个库实现旋转动画 </p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-5ddc998c6c858840.gif?imageMogr2/auto-orient/strip" alt="ScreenFlow.gif"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;image id=<span class="string">"pic"</span> src=<span class="string">"img/pic.jpg"</span>/&gt;</div><div class="line">   <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></span></div><div class="line">         $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">             $pic=$(<span class="string">"#pic"</span>);</div><div class="line">            $pic.velocity(  <span class="comment">//loop表示无限循环</span></div><div class="line">                    &#123;<span class="attr">rotateZ</span>: <span class="string">"360deg"</span>&#125;,&#123;<span class="attr">duration</span>:<span class="number">5000</span>,<span class="attr">loop</span>: <span class="literal">true</span> &#125;,<span class="string">"linear"</span>)；   </div><div class="line">         &#125;);   </div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><a href="http://twitter-fabric.github.io/velocity-react/" target="_blank" rel="external">这是官方的一个示例</a><br><img src="http://upload-images.jianshu.io/upload_images/2044710-019b0a1d63961dd2.gif?imageMogr2/auto-orient/strip" alt="ScreenFlow3.gif"><br>下面是react组件的用法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ npm install --save velocity-react</div><div class="line"><span class="built_in">require</span>(<span class="string">'velocity-animate'</span>);</div><div class="line"><span class="built_in">require</span>(<span class="string">'velocity-animate/velocity.ui'</span>);</div><div class="line"> <span class="xml"><span class="tag">&lt;<span class="name">VelocityComponent</span> <span class="attr">animation</span>=<span class="string">&#123;&#123;</span> <span class="attr">opacity:</span> <span class="attr">this.state.showSubComponent</span> ? <span class="attr">1</span> <span class="attr">:</span> <span class="attr">0</span> &#125;&#125; <span class="attr">duration</span>=<span class="string">&#123;500&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">MySubComponent</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">VelocityComponent</span>&gt;</span></div></pre></td></tr></table></figure></p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:37:04.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/React/' title=''>React</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-React组件的享元模式-1" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/React组件的享元模式-1/">React组件的享元模式</a>
  

      </h3>
      <div class="repo-list-description">
        
          
        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:30:54.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-React组件的享元模式" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/React组件的享元模式/">React组件的享元模式</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p>我们在react/react-native的代码中都有这样的代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; View,  </div><div class="line">               StyleSheet, </div><div class="line">               ScrollView, </div><div class="line">               ListView,  </div><div class="line">               StatusBar,</div><div class="line">              InteractionManager,</div><div class="line">              Navigator, &#125;</div><div class="line">              <span class="keyword">from</span> <span class="string">'react-native'</span></div></pre></td></tr></table></figure>
<p>通过这样的方式引入组件对象。 今天又一次读js设计模式的时候发现原来的理解是错误的，误解了组件的外部状态和内部状态，从而没有领会组件的微妙之处。今天把正确的概念写出来。</p>
<p>在曾探的《javascript 设计模式与开发实践》关于享元模式的内部状态和外部状态有这样的描述</p>
<blockquote>
<p>-内部状态存储于对象内部<br>  -内部状态可以被一些对象共享<br>  -内部状态可以独立于场景，通常不会变<br>  -外部状态取决于具体的场景，并根据场景而变化，外部状态不能被共享</p>
</blockquote>
<p>怎么解释呢？意思是页面中出现的所有View组件实际是同一个共享对象，外部状态从对象上剥离开来，并存储在外部。<br>   剥离了外部状态的就是共享组件。 外部状态必要时传入共享组件就可以组成一个完整的对象。这些外部状态包括 state，props,style等<br>组装外部状态需要时间，但是可以大大减少系统中的对象数量，享元模式是用时间换空间的做法。<br>通过import导入的就是公共组件对象。 公共组件内部可以为外部状态加上标签以示区别，这就是ref参数存在的含义。</p>
<p>这就是借助享元模式理解的react组件的构造和用法。</p>
<p>借助模式设计慢慢读代码，写代码。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:29:41.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Redux函数-2" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/Redux函数-2/">Redux函数</a>
  

      </h3>
      <div class="repo-list-description">
        
          
        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:12:02.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Redux函数-1" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/Redux函数-1/">Redux函数</a>
  

      </h3>
      <div class="repo-list-description">
        
          
        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:10:42.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Redux函数" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/Redux函数/">Redux函数</a>
  

      </h3>
      <div class="repo-list-description">
        
          
        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:06:24.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Javascript reducer函数" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/24/Javascript reducer函数/">Javascript reducer函数实战</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>javascript Reduce函数是比较强大的一个函数,在简书上看到有个作者写了这个函数的文章,也是看到有个问题就向他请教,大神很忙,但是仍然在github上做了答复,我对那个问题搞明白了,所以写了下面这个文章,但是没有写完,现在陪老娘在医院,又把这个问题翻出来看,又不懂了,还是拉锯战啊. javascript的编程中,我开始感到看别人的源码最难的地方实际还是两个,一个是数组方法的灵活应用,另一个是对象的浅拷贝和深拷贝的问题.这两个问题要是有深刻的体会,看源码的难度会降低很多.reduce,slice,splice,concat函数是明星.遇到这几个函数的时候就有些看不懂,所以掌握这几个函数是非常重要的. 深拷贝和浅拷贝的问题其实和javascript的对象和函数都是传引用赋值息息相关,一句话解决对象的共享还是独享的问题.javascript的设计模式很多都是利用对象很函数的传引用赋值的特点来完成的.所以这儿地方也是非常的重要.javascript的数组元素也可以是对象的引用.</p>
</blockquote>
<p>本人是新手,最大的体会是学到的两个简单原则:1 对象是用来组织数据和相关方法的,所以组织方式越简单,越灵活越好,由于js的对象和函数都可以传引用赋值,所以在js中,以对象字面量和数组的组织方式真的是非常的强大,之所以这么讲,就是要把学习数组的方法提到新的高度.2 编程到底是在干什么？ 我逐渐体会到编程也就是解决信息的传递，存储和处理的问题. 所以很多问题其实稍微抽象一下,问题可能会简单一点. 我简单的写了一个东西,在学习React/Redux的时候,总是掌握不了实质,就是Redux中的state的实质是什么.前面学习的时候,总是言必称state,想了各种办法去了解什么是state，为什么要这样设计.其实再抽象一下,这不就是一个小型的数据库吗？可以这样说吗？当然可以了,我看了一本介绍React的书,有点确认了,当我这几天再读F8 app的代码官方文档的时候,facebook直接就是把Redux称为数据层.我还想了一些办法来理解Redux，比如说借用中介者模式,MVC解耦和模式,但是如果抽象为数据层,那么还有什么问题解决不了的吗？ 如果接触过任何一种web框架语言,例如php/mysql,node/mongodb.每种都是解耦和,每种都是中介者模式.所以在理解这些概念的时候最基础的内容可能是最解决问题的条件.你可以梳理一下这些框架中与数据库操作都有哪些? 连接数据库,数据库操作语句,数据库文件,返回值等等.这些东西在react/redux中都能找到一摸一样的内容.web框架里的数据库操作和redux的操作是完全一样的,有什么奇怪的吗？都是数据库.</p>
<p>Redux的文档中有个redo,undo的例子,我最近又重新看redux文档的时候，感觉这一部分讲的真是好,以前怎么没有理解呢？  有三个缺陷一个是对于state的数据结构的理解,一个是堆栈方法使用理解,另一个就是js的浅拷贝的问题。前面看那本数据结构的书,也不得法,但是硬着头皮把几种数据结构拿下以后,突然觉得好多问题都找到了解决办法,计算机中对于数据结构和算法的重视不是白来的.state如果作为一个简单数据库,他里面就是一些<code>键值对</code>. 由于js中对象可以传引用,所以可以很容易的建立一个类数据库的结构.其他语言可以吗？</p>
<p>#####下面我们就贯彻以上的理念,来研究一些基础的内容。<br>第一个就是Reducer函数,参考 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="external">MDN</a> 文档</p>
<p>直接看代码例子</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//accumulator是累加值,currentValue是当前遍历的值</span></div><div class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>].reduce( (accumulator, currentValue, currentIndex, array) =&gt; &#123;</div><div class="line">  return accumulator + currentValue;</div><div class="line">&#125;, <span class="number">10</span>);</div></pre></td></tr></table></figure>
<hr>
<table>
<thead>
<tr>
<th style="text-align:left">callback</th>
<th style="text-align:left">accumulate</th>
<th style="text-align:left">currentValue</th>
<th style="text-align:left">currentIndex</th>
<th style="text-align:left">array</th>
<th style="text-align:left">return</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">第一次调用</td>
<td style="text-align:left">10</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">[0,1,2,3,4]</td>
<td style="text-align:left">10</td>
</tr>
<tr>
<td style="text-align:left">第二次调用</td>
<td style="text-align:left">10</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">[0,1,2,3,4]</td>
<td style="text-align:left">11</td>
</tr>
<tr>
<td style="text-align:left">第三次调用</td>
<td style="text-align:left">11</td>
<td style="text-align:left">2</td>
<td style="text-align:left">2</td>
<td style="text-align:left">[0,1,2,3,4]</td>
<td style="text-align:left">13</td>
</tr>
<tr>
<td style="text-align:left">第四次调用</td>
<td style="text-align:left">13</td>
<td style="text-align:left">3</td>
<td style="text-align:left">3</td>
<td style="text-align:left">[0,1,2,3,4]</td>
<td style="text-align:left">16</td>
</tr>
<tr>
<td style="text-align:left">第五次调用</td>
<td style="text-align:left">16</td>
<td style="text-align:left">4</td>
<td style="text-align:left">4</td>
<td style="text-align:left">[0,1,2,3,4]</td>
<td style="text-align:left">20</td>
</tr>
</tbody>
</table>
<p>第一个遍历，accumulate等于10.遍历的数组元素是0，index是0.这是巧合。数组还是[0,1,2,3,4]。返回的值是初始值加当前的数组元素值，也就是返回accumulate+array[currentIndex]。return的就是 10+array[0]=10.</p>
<p>第二个遍历，accumulate就是10，遍历的数组元素是1，index是1.这也是巧合。数组还是[0,1,2,3,4]。返回的值是accumulate加当前的数组值，accumulate+array[currentIndex]。<br>也就是返回 10+array[1]=11.</p>
<p>第二个遍历和第一个遍历的区别就是初始值来源不同。第一个遍历的是reduce带进来的数据。第二个遍历使用的是第一个遍历返回的值。<br>后面的几个遍历就和第二个遍历一样了。</p>
<p><em>数组扁平化</em><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var flattened = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]].reduce(function(a, b) &#123;</div><div class="line">    return a.concat(b); <span class="comment">//要了解concat的使用,返回的是</span></div><div class="line">    <span class="comment">//数组合并的返回对象</span></div><div class="line">&#125;, []); <span class="comment">//起始是空数组</span></div><div class="line"><span class="comment">// flattened is [0, 1, 2, 3, 4, 5]</span></div></pre></td></tr></table></figure></p>
<hr>
<p>就这么简单,但是灵活变动起来也不是太好理解啊<br>看这个计算器的React-Native的代码,在UI组件中渲染出计算器的几个按键的方法</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> Types = &#123; <span class="comment">//类型</span></div><div class="line">  NUMBER: <span class="string">'NUMBER'</span>,</div><div class="line">  DECIMAL: <span class="string">'DECIMAL'</span>,</div><div class="line">  SIGN: <span class="string">'SIGN'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> inputs = [</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">1</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">2</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">3</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">4</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">5</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">6</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">7</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">8</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">9</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'+/-'</span>, type: Types.SIGN&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">0</span>, type: Types.NUMBER&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'.'</span>, type: Types.DECIMAL&#125;,</div><div class="line">];</div><div class="line"><span class="comment">//操作符的配置</span></div><div class="line"><span class="keyword">var</span> operations = [</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'/'</span>, color: <span class="string">'#c77ccc'</span>, altColor: <span class="string">'#b16eb7'</span>, operation: OPERATION_DIVIDE&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'-'</span>, color: <span class="string">'#f8b055'</span>, altColor: <span class="string">'#dc9c4c'</span>, operation: OPERATION_SUBTRACT&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'+'</span>, color: <span class="string">'#f796d2'</span>, altColor: <span class="string">'#e088be'</span>, operation: OPERATION_ADD&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'x'</span>, color: <span class="string">'#6fcdf4'</span>, altColor: <span class="string">'#65badd'</span>, operation: OPERATION_MULTIPLY&#125;</div><div class="line">];</div><div class="line"></div><div class="line">renderInputRows() &#123;</div><div class="line">    <span class="keyword">var</span> &#123;inputNumber, inputSigned, inputDecimal&#125; = <span class="keyword">this</span>.props;<span class="comment">//注意在redux中那个地方返回了这三个函数的名字</span></div><div class="line">    <span class="keyword">return</span> inputs.reduce((collection, input) =&gt; &#123;<span class="comment">//这里的reduce是怎么用的呢？</span></div><div class="line">      <span class="keyword">if</span> (collection[collection.length - <span class="number">1</span>].length === <span class="number">3</span>) &#123;<span class="comment">//为什么等于3</span></div><div class="line">        collection.push([]);</div><div class="line">      &#125;</div><div class="line">      collection[collection.length<span class="number">-1</span>].push(input);</div><div class="line">      <span class="keyword">return</span> collection;</div><div class="line">    &#125;, [[]]).map((<span class="keyword">group</span>, rowIndex) =&gt; &#123;</div><div class="line">      <span class="keyword">var</span> columns = <span class="keyword">group</span>.map((item, columnIndex) =&gt; &#123;<span class="comment">//看看map的方法</span></div><div class="line">        <span class="keyword">return</span> (</div><div class="line">          &lt;TouchableHighlight</div><div class="line">            key=&#123;<span class="string">'inputRow_'</span> + rowIndex + <span class="string">'_inputCol_'</span> + columnIndex&#125;</div><div class="line">            underlayColor=<span class="string">"#ededed"</span></div><div class="line">            style=&#123;styles.input&#125;</div><div class="line">            onPress=&#123;() =&gt; &#123; <span class="comment">//dispatch方法</span></div><div class="line">              <span class="keyword">if</span> (item.type === Types.NUMBER) &#123;</div><div class="line">                inputNumber(item.<span class="keyword">value</span>);</div><div class="line">              &#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">item.type === Types.DECIMAL</span>) </span>&#123;</div><div class="line">                inputDecimal();</div><div class="line">              &#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">item.type === Types.SIGN</span>) </span>&#123;</div><div class="line">                inputSigned();</div><div class="line">              &#125;</div><div class="line">            &#125;&#125;&gt;</div><div class="line">            &lt;Text style=&#123;styles.inputText&#125;&gt;&#123;item.<span class="keyword">value</span>&#125;&lt;/Text&gt;</div><div class="line">          &lt;/TouchableHighlight&gt;</div><div class="line">        );</div><div class="line">      &#125;);</div></pre></td></tr></table></figure>
<p>看看这个数组的reducer方法的使用.<a href="https://github.com/benoitvallon/react-native-nw-react-calculator" target="_blank" rel="external">源代码在这里</a></p>
<p>这个我稍后再补充,会补充大神给我的解答.</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"> var Types = &#123;</div><div class="line">  <span class="keyword">NUMBER</span>: <span class="string">'NUMBER'</span>,</div><div class="line">  <span class="keyword">DECIMAL</span>: <span class="string">'DECIMAL'</span>,</div><div class="line">  <span class="built_in">SIGN</span>: <span class="string">'SIGN'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">var inputs = [</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">1</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">2</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">3</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">4</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">5</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">6</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">7</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">8</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">9</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'+/-'</span>, <span class="keyword">type</span>: Types.<span class="built_in">SIGN</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="number">0</span>, <span class="keyword">type</span>: Types.<span class="keyword">NUMBER</span>&#125;,</div><div class="line">  &#123;<span class="keyword">value</span>: <span class="string">'.'</span>, <span class="keyword">type</span>: Types.<span class="keyword">DECIMAL</span>&#125;,</div><div class="line">];</div><div class="line">//这里其实是有一维数组转为二维数组，打印结构可以看到.</div><div class="line">//注意reduce的起始值就是一个二维数组.</div><div class="line">var result = inputs.reduce((collection, input) =&gt; &#123;</div><div class="line">      <span class="keyword">if</span> (collection[collection.length - <span class="number">1</span>].length === <span class="number">3</span>) &#123;</div><div class="line">        collection.push([]);</div><div class="line">      &#125;</div><div class="line">      collection[collection.length-<span class="number">1</span>].push(input);</div><div class="line">      <span class="keyword">return</span> collection;</div><div class="line">    &#125;, [[]])</div><div class="line"></div><div class="line">console.<span class="built_in">log</span>(result)</div><div class="line">console.table(result)</div></pre></td></tr></table></figure>
<p>再看看下面这里两段代码<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let str = `name,  age,  hair\nMerble,  <span class="number">35</span>,  red\nBob,  <span class="number">64</span>,  blonde`;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">lameCSV</span><span class="params">(str)</span></span> &#123;</div><div class="line">  <span class="keyword">return</span> str.split(<span class="string">'\n'</span>).reduce(<span class="function"><span class="keyword">function</span><span class="params">(table, row)</span></span>&#123;</div><div class="line">    <span class="built_in">table</span>.push(row.split(<span class="string">','</span>).map(<span class="function"><span class="keyword">function</span><span class="params">(c)</span></span> &#123;<span class="keyword">return</span> c.trim();&#125;));</div><div class="line">    <span class="keyword">return</span> <span class="built_in">table</span></div><div class="line">  &#125;, <span class="string">[[]]</span>);</div><div class="line">&#125;;</div><div class="line">lameCSV(str);</div></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var arr=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</div><div class="line"> var result = arr.reduce((collection, input) =&gt; &#123;</div><div class="line">      if (collection[collection.length - <span class="number">1</span>].length === <span class="number">3</span>) &#123;</div><div class="line">        collection.push([]);</div><div class="line">      &#125;</div><div class="line">      collection[collection.length<span class="number">-1</span>].push(input);</div><div class="line">      console.log(collection);</div><div class="line">      return collection;</div><div class="line">    &#125;, [[]]);</div></pre></td></tr></table></figure>
<hr>
<p><a href="https://github.com/zaxlct/baike_spider/issues/1" target="_blank" rel="external">感谢大神的帮助,大神的github</a><br>reduce这个方法还能演变出什么花样来呢？数组的操作真的是一个需要好好学习的内容.</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T21:03:59.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/javascript/' title=''>javascript</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-new-article-2" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/23/new-article-2/">测试文件</a>
  

      </h3>
      <div class="repo-list-description">
        
          
        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T15:31:30.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/javascript/' title=''>javascript</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redux/">Redux</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
        </div>
        <div class="column one-third">
          <!--处理未安装 search 插件 默认 Google 搜索-->
 

<h3>Search</h3>

<div id="site_search">

	<!-- Google -->
	

	<!-- 本地搜索 -->
	
		<form id="search-form" >
			<input type="text" id="search" placeholder="Search" >
			<button type="button" class="btn btn-default" id="site_search_do"><span class="octicon octicon-search"></span></button>
		</form>

		<div id="local-search-result"></div>

		<script src="/js/search.js"></script>	
		<script type="text/javascript">
			$(function(){
				var currentIndex = -1;
				var search_path = "search.xml";
				if (!search_path) search_path = "search.xml";
				var path = "/" + search_path;
				searchFunc(path, 'search', 'local-search-result');

				$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
					var liNode = $("#local-search-result>.search-result-list li");
					liNode.removeClass("hover");
					currentIndex = $("#local-search-result>.search-result-list li").index($(this));
					liNode.eq(currentIndex).addClass("hover");
				})

				$("#search-form").submit(function(){
					return false;
				})

				$("#search").keydown(function(event){
					var keyCode = event.keyCode;
					var liNode = $("#local-search-result>.search-result-list li");
					if(keyCode == 38 || keyCode == 40 || keyCode == 13){
						liNode.removeClass("hover");
						if(keyCode == 38){
							if(currentIndex - 1 >= 0) currentIndex --;
						}
						if(keyCode == 40){
							if(currentIndex + 1 < liNode.length) currentIndex ++;
						}
						if(keyCode == 13){
							location.href = liNode.eq(currentIndex).find("a").attr("href");
						}
						liNode.eq(currentIndex).addClass("hover");
						return false;
					}else{
						currentIndex = -1;
					}
				})
			})
		</script>

	

</div>

<h3>Popular Repositories</h3>
    <div class="popular-container"></div>
    
    <script type="text/template" id="popular-list-template">
        <a href="{%=clone_url%}" class="card text-center" target="_blank">
            <div class="thumbnail">
                <div class="card-image geopattern" data-pattern-id="{%=name%}">
                    <div class="card-image-cell">
                        <h3 class="card-title">
                            {%=name%}
                        </h3>
                    </div>
                </div>
                <div class="caption">
                    <div class="card-description">
                        <p class="card-text">
                            {%=description%}
                        </p>
                    </div>
                    <div class="card-text">
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=stargazers_count%} stars">
                            <span class="octicon octicon-star"></span> {%=stargazers_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=forks_count%} forks">
                            <span class="octicon octicon-git-branch"></span> {%=forks_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="最后更新时间：{%=updated_at%}">
                            <span class="octicon octicon-clock"></span>
                            <time datetime="{%=updated_at%}">{%=updated_at%}</time>
                        </span>
                    </div>
                </div>
            </div>
        </a>
    </script>

    <script src="/js/baiduTemplate.js"></script>
    <script type="text/javascript">
        var popular_repos = function(){

            var baiduTpl = new Object();

            var handleTpl = function(){
                baiduTpl.popular_list = baidu.template("popular-list-template");
            };

            var handleGithub = function(){
                var popularContainer = $(".popular-container");

                var repos = "hexo-theme-primer".split(",");
                for(var i in repos){
                    var name = repos[i];
                    $.get("https://api.github.com/repos/yumemor/"+name,handle);
                }

                function handle(result){
                    result.updated_at = result.updated_at.split("T")[0];
                    if(result){
                        var html = baiduTpl.popular_list(result);
                        popularContainer.append(html);
                        $(".geopattern").each(function(){           
                            $(this).geopattern($(this).data('pattern-id'));
                        });
                    }
                }
            };

            return {
                init:function(){
                    handleTpl();
                    handleGithub();
                }
            }
        }; 
        $(popular_repos().init);
    </script>

        </div>
    </div>

    
      <div class="pagination text-align">
          <div class="btn-group">
              <span class="page-number current">1</span><a class="page-number" href="/archives/2017/page/2/">2</a><a class="page-number" href="/archives/2017/page/3/">3</a><a class="page-number" href="/archives/2017/page/4/">4</a><a class="page-number" href="/archives/2017/page/5/">5</a><a class="page-number" href="/archives/2017/page/6/">6</a><a class="extend next" rel="next" href="/archives/2017/page/2/">&raquo;</a>
          </div>
      </div>
    
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/category/" target="true" title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="开源项目">开源项目</a>
                  </li>
            
                  
                  <li>
                    <a href="/message/"  title="留言板">留言板</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>