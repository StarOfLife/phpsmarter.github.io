<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>phpsmarter</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--åœ¨è¿™é‡Œå€’å…¥jquery æ–¹ä¾¿å¤„ç†éƒ¨åˆ†é¡µé¢çš„jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
</head>
<body class="home">
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="phpsmarter"><span class="octicon octicon-mark-github"></span> phpsmarter</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="é¦–é¡µ">é¦–é¡µ</a>
        
              
              <a href="/category/" target="true" class=" site-header-nav-item hvr-underline-from-center" title="åˆ†ç±»">åˆ†ç±»</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="å¼€æºé¡¹ç›®">å¼€æºé¡¹ç›®</a>
        
              
              <a href="/message/"  class=" site-header-nav-item hvr-underline-from-center" title="ç•™è¨€æ¿">ç•™è¨€æ¿</a>
        
      </nav>
  </div>
</header>

	<section class="banner-false">
    <div class="collection-head">
        <div class="container">
            <div class="collection-title">
                <h1 class="collection-header" id="site-description">
                    
                </h1>
                <div class="collection-info">
                    
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-location">
                                   
                                        ChengDu, China
                                    
                                </span>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-mark-github">
                                   
                                </span>
                                
                                    <a href="http://github.com/yumemor" target="_blank">yumemor</a>
                                
                            
                        </span>
                    
                </div>
            </div>
        </div>
    </div>
</section>
	   <section class="container">
    <div class="columns">
        <div class="column two-thirds">
            
                  <article id="post-ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/23/ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App/">ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>æœ¬æ–‡æ˜¯ç¿»è¯‘ç‰ˆæœ¬,<a href="https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/" target="_blank" rel="external">åŸæ–‡è¯·è§</a><br><em>By Dan Prince  May 03, 2016</em></p>
</blockquote>
<p>Reactä½¿ç”¨ç»„ä»¶å’Œå•å‘æ•°æ®æµæ–¹å¼æè¿°ç”¨æˆ·ç•Œé¢,ä½†æ˜¯Reactå¯¹stateçš„å¤„ç†éå¸¸çš„ç®€å•.è¿™ä¸€ç‚¹è®©æˆ‘ä»¬çŸ¥é“,Reactä»…ä»…åªå½“äºä¼ ç»Ÿçš„<code>Model-View-Controller</code>æ„æ¶çš„<code>View</code>å±‚.</p>
<p>ä»…ä»…ä½¿ç”¨Reactä¹Ÿå¯ä»¥æ„å»ºå¤§å‹çš„app,ä½†æ˜¯å¾ˆå¿«æˆ‘ä»¬ä¼šå‘ç°,è¦ä¿æŒä»£ç çš„ç®€æ´,æˆ‘ä»¬éœ€è¦åœ¨å…¶ä»–åœ°æ–¹ç®¡ç†state(æŠŠstateçš„ç®¡ç†ç‹¬ç«‹å‡ºæ¥).</p>
<p>æ²¡æœ‰å®˜æ–¹ç®¡ç†åº”ç”¨stateçš„å·¥å…·,ä½†æ˜¯æœ‰å‡ ä¸ªåº“å·¥ä½œçš„çš„ä¸é”™.ä»Šå¤©æˆ‘ä»¬æ·»åŠ ä¸¤ä¸ªåº“å’ŒReactä¸€èµ·æ¥æ„å»ºä¸€ä¸ªç®€å•çš„app.</p>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>Reduxæ˜¯ä¸€ä¸ªå°å‹çš„jsåº“,ä½œä¸ºappçš„stateå®¹å™¨.ç³…åˆäº†Flucå’ŒElmçš„æ¦‚å¿µ.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reduxç®¡ç†ä»»ä½•appçš„state,åªè¦æˆ‘ä»¬ç´§æ‰£ä¸‹é¢çš„æŒ‡å¯¼ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„stateä¿æŒåœ¨ä¸€ä¸ªå•ä¸€çš„storeä¸­</li>
<li>stateçš„æ”¹å˜åªä¼šæ¥è‡ªäºactions</li>
</ol>
<p>Reduxçš„æ ¸å¿ƒ storeæ˜¯ä¸€ä¸ªå‡½æ•°,å®ƒæ¥æ”¶å½“å‰çš„applicationçš„stateå’Œä¸€ä¸ªaction,åˆå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„application state,è¿™ä¸ªå‡½æ•°å«åšReducer.</p>
<p>æˆ‘ä»¬çš„Reactç»„ä»¶è´Ÿè´£å‘é€actionsåˆ°æˆ‘ä»¬çš„store,åè¿‡æ¥,å¦‚æœç»„ä»¶éœ€è¦æ¸²æŸ“çš„æ—¶å€™,storeä¼šé€šçŸ¥ä»–.</p>
<h2 id="ImmutableJS"><a href="#ImmutableJS" class="headerlink" title="ImmutableJS"></a>ImmutableJS</h2><p>å› ä¸ºReduxä¸å…è®¸æˆ‘ä»¬mutateç¨‹åºçš„state,å¦‚æœå€ŸåŠ©immutableæ•°æ®ç»“æ„æ¨¡å‹åŒ–åº”ç”¨ç¨‹åºçš„stateå°†ä¼šéå¸¸çš„æœ‰ç”¨.<br><code>Immutable.js</code>ä½¿ç”¨çªå˜ç•Œé¢(mutative interfaces)æä¾›ä¸€äº›immutableæ•°æ®ç»“æ„,è¿™äº›ç•Œé¢å®æ–½æ—¶éå¸¸çš„é«˜æ•ˆ,çµæ„Ÿæ¥è‡ªäºClojureå’ŒScala.</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>æˆ‘ä»¬å°†ä¼šä½¿ç”¨React,Reduxå’ŒImmutableJSå»æ„å»ºä¸€ä¸ªç®€å•çš„todo list,å…è®¸æˆ‘ä»¬æ·»åŠ todos,åœ¨å®Œæˆå’Œæœªå®Œæˆä¹‹é—´åˆ‡æ¢.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//html</div><div class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">//css</div><div class="line"> html, body, input, button &#123;</div><div class="line">  font-family: Sawasdee;</div><div class="line">  font-size: 20px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__list &#123;</div><div class="line">  margin: 0;</div><div class="line">  padding: 0;</div><div class="line">  list-style-type: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item &#123;</div><div class="line">  padding: .5em .25em;</div><div class="line">  border-bottom: solid 1px #eee;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item:hover &#123;</div><div class="line">  background: #f7f7f7;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__entry &#123;</div><div class="line">  border: solid 1px #ccc;</div><div class="line">  padding: .25em .5em;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #f3f3f3;</div><div class="line">  width: 100%;</div><div class="line">  box-sizing: border-box;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button &#123;</div><div class="line">  border: 0;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #71B7FF;  </div><div class="line">  color: #fff;</div><div class="line">  padding: .25em .5em;</div><div class="line">  margin: .5em 0;</div><div class="line">  margin-right: .25em;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button:hover &#123;</div><div class="line">  background: #B2D8FF;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//js</span></div><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span>, List &#125; = Immutable;</div><div class="line"><span class="keyword">const</span> &#123; createStore &#125; = Redux;</div><div class="line"><span class="keyword">const</span> &#123; Provider, connect &#125; = reactRedux;</div><div class="line"></div><div class="line"><span class="keyword">const</span> components = &#123;</div><div class="line">  Todo(&#123; todo &#125;) &#123;</div><div class="line">    <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;  </div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  TodoList(&#123; todos, toggleTodo, addTodo &#125;) &#123;</div><div class="line">    <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> text = e.target.value;</div><div class="line">      <span class="keyword">if</span>(e.which === <span class="number">13</span> &amp;&amp; text.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        addTodo(text);</div><div class="line">        e.target.value = <span class="string">''</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> toggleClick = <span class="function">(<span class="params">id</span>) =&gt;</span> () =&gt; toggleTodo(id);</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> &#123; Todo &#125; = components;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='todo'&gt;</div><div class="line">        &lt;input type='text'</div><div class="line">               className='todo__entry'</div><div class="line">               placeholder='Add todo'</div><div class="line">               onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">        &lt;ul className='todo__list'&gt;</div><div class="line">          &#123;todos.map(t =&gt; (</div><div class="line">            &lt;li</div><div class="line">              key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">              &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">            &lt;/li&gt;</div><div class="line">          ))&#125; </div><div class="line">        &lt;/ul&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const actions = &#123;</div><div class="line">  addTodo(text) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'ADD_TODO',</div><div class="line">      payload: &#123;</div><div class="line">        id: Math.random().toString(34).slice(2),</div><div class="line">        isDone: false,</div><div class="line">        text</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  toggleTodo(id) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'TOGGLE_TODO',</div><div class="line">      payload: id</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const init = List();</div><div class="line"></div><div class="line">const reducer = function(state=init, action) &#123;</div><div class="line">  switch(action.type) &#123;</div><div class="line">    case 'ADD_TODO':</div><div class="line">      return state.push(</div><div class="line">        Map(action.payload)</div><div class="line">      );</div><div class="line">    case 'TOGGLE_TODO':</div><div class="line">      return state.map(t =&gt; &#123;</div><div class="line">        if(t.get('id') == action.payload) &#123;</div><div class="line">          return t.update('isDone', isDone =&gt; !isDone);</div><div class="line">        &#125; else &#123;</div><div class="line">          return t;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    default:</div><div class="line">      return state;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const containers = &#123;</div><div class="line">  TodoList: connect(</div><div class="line">    function mapStateToProps(state) &#123;</div><div class="line">      return &#123;</div><div class="line">        todos: state</div><div class="line">      &#125;;</div><div class="line">    &#125;,</div><div class="line">    function mapDispatchToProps(dispatch) &#123;</div><div class="line">      return &#123;</div><div class="line">        toggleTodo: (id) =&gt; dispatch(actions.toggleTodo(id)),</div><div class="line">        addTodo: (text) =&gt; dispatch(actions.addTodo(text))</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">  )(components.TodoList)</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const &#123; TodoList &#125; = containers;</div><div class="line">const store = createStore(reducer);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    &lt;TodoList /&gt;</div><div class="line">  &lt;/Provider&gt;,</div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä»£ç åœ¨ <a href="https://github.com/sitepoint-editors/immutable-redux-todo" target="_blank" rel="external">Github</a></p>
<blockquote>
<p>å¯èƒ½æç¤ºbuildå¤±è´¥,<code>npm install babel-core</code>è¯•è¯•</p>
</blockquote>
<h2 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h2><p>ä»åˆ›å»ºé¡¹ç›®ğŸ“‚å¼€å§‹,å»ºç«‹ä¸€ä¸ªpackage.jsonæ–‡ä»¶.ç„¶åå®‰è£…éœ€è¦çš„ä¾èµ–åŒ….</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> npm install --save react react-dom redux react-redux immutable</div><div class="line">npm install --save-dev webpack babel-loader babel-preset-es2015 babel-preset-react</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨JSXå’ŒES2015,ç”¨Babelç¼–è¯‘ä»£ç ,ä½¿ç”¨Webpackæ¥å®Œæˆè¿™ä¸ªæ¨¡å—ç»‘å®šè¿‡ç¨‹.</p>
<p>åœ¨<code>webpack.config.js</code>æ–‡ä»¶ä¸­åˆ›å»ºWebpacké…ç½®æ–‡ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./src/app.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname,</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel'</span>,</div><div class="line">        <span class="attr">query</span>: &#123; <span class="attr">presets</span>: [ <span class="string">'es2015'</span>, <span class="string">'react'</span> ] &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<p>æœ€åæ‰©å±•ä¸€ä¸‹<code>package.json</code>,æ·»åŠ ä¸€ä¸ªnpm scriptä½¿ç”¨source mapsç¼–è¯‘æˆ‘ä»¬çš„ä»£ç .</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> "scripts": &#123;</div><div class="line">  "build": "webpack --debug"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯æ¬¡ç¼–è¯‘ä»£ç çš„æ—¶å€™,è¿è¡Œ<code>npm run build</code>.</p>
<h2 id="React-amp-Components"><a href="#React-amp-Components" class="headerlink" title="React&amp;Components"></a>React&amp;Components</h2><p>åœ¨å®æ–½é¡¹ç›®ä¹‹å‰,å…ˆåˆ›å»ºä¸€äº›å‚»ç“œæ•°æ®æœ‰å¾ˆå¤§çš„ç”¨å¤„,ä½†æˆ‘ä»¬æ„æ€éœ€è¦æ¸²æŸ“çš„ç»„ä»¶çš„æ—¶å€™,æœ‰ä¸€ç‚¹ç‚¹åˆæ­¥çš„æ„Ÿè§‰.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªReactç»„ä»¶<code>&lt;Todo/&gt;</code>å’Œ<code>&lt;TodoList&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/components.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Todo</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todo &#125; = props;</div><div class="line">  <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos &#125; = props;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text' placeholder='Add todo' /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.id&#125; className='todo__item'&gt;</div><div class="line">            &lt;Todo todo=&#123;t&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>åˆ°äº†è¿™ä¸€æ­¥,å¯ä»¥åˆ›å»º<code>index.html</code>æ–‡ä»¶æ¥æµ‹è¯•è¿™äº›ç»„ä»·,æ·»åŠ ä¸‹é¢çš„æ ‡è®°</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Immutable Todo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p>è¿˜æœ‰ä¸€ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶<code>src/app.js</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;dummyTodos&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>npm run build</code>ç¼–è¯‘æ–‡ä»¶,ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€index.htmlæ–‡ä»¶,ç¡®ä¿è¿è¡Œ.</p>
<h2 id="Redux-amp-ImmutableJS"><a href="#Redux-amp-ImmutableJS" class="headerlink" title="Redux&amp;ImmutableJS"></a>Redux&amp;ImmutableJS</h2><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å¾ˆå¥½çš„UI,å¯ä»¥å¼€å§‹è€ƒè™‘ç»„ä»¶æœ€åçš„state.å¼€å§‹åˆ›å»ºçš„å‚»ç“œæ•°æ®æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€ç«¯,æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“è½¬åŒ–ä¸ºImmutableJSé›†åˆ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = List([</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;)</div><div class="line">]);</div></pre></td></tr></table></figure>
<hr>
<p>ImmutableJS mapå’ŒJavascriptçš„å¯¹è±¡å·¥ä½œæ–¹å¼ä¸åŒ,æ‰€ä»¥æˆ‘ä»¬è¦å¯¹ç»„ä»¶åšä¸€ç‚¹è½»å¾®çš„æ”¹å˜.propertyæ¥å…¥çš„åœ°æ–¹(ä¾‹å¦‚ï¼štodo.id)éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•è°ƒç”¨æ¥ä»£æ›¿(ä¾‹å¦‚:<code>todo.get(â€˜idâ€™)</code>).</p>
<h2 id="è®¾è®¡Actions"><a href="#è®¾è®¡Actions" class="headerlink" title="è®¾è®¡Actions"></a>è®¾è®¡Actions</h2><p>ç°åœ¨æˆ‘ä»¬è·å¾—äº†æ•°æ®çš„ç‰¹å¾,å¯ä»¥è€ƒè™‘ä¸€ä¸‹actionsçš„æ›´æ–°.è¿™ä¸ªå®ä¾‹ä¸­,æˆ‘ä»¬ä»…ä»…éœ€è¦ä¸¤ä¸ªacions,ä¸€ä¸ªæ˜¯æ·»åŠ æ–°çš„todo,å¦ä¸€ä¸ªè½¬æ¢todoçš„çŠ¶æ€.</p>
<p>è®©æˆ‘ä»¬å®šä¹‰å‡ ä¸ªå‡½æ•°åˆ›å»ºè¿™äº›actions</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// src/actions.js</span></div><div class="line"></div><div class="line"><span class="comment">// succinct hack for generating passable unique ids</span></div><div class="line"><span class="keyword">const</span> uid = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random().toString(<span class="number">34</span>).slice(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'ADD_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: &#123;</div><div class="line">      <span class="attr">id</span>: uid(),</div><div class="line">      <span class="attr">isDone</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">text</span>: text</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'TOGGLE_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: id</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ªactionä»…ä»…æ˜¯ä¸€ä¸ªæœ‰typeå’Œpayloadçš„å±æ€§å¯¹è±¡.åœ¨æˆ‘ä»¬è§¦å‘actionå,typeå±æ€§å¸®åŠ©æˆ‘ä»¬ç”¨payloadæ¥ä½œä»€ä¹ˆ.</p>
<h2 id="è®¾è®¡ä¸€ä¸ªReducer"><a href="#è®¾è®¡ä¸€ä¸ªReducer" class="headerlink" title="è®¾è®¡ä¸€ä¸ªReducer"></a>è®¾è®¡ä¸€ä¸ªReducer</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†stateçš„ç‰¹æ€§å’Œæ›´æ–°stateçš„action,æˆ‘ä»¬å¯ä»¥åˆ›å»ºreduceräº†.ä»…ä»…æé†’ä¸€ä¸‹,reduceræ˜¯ä¸€ä¸ªæ¥æ”¶stateå’Œactionçš„å‡½æ•°,ç„¶åç”¨æ¥è®¡ç®—æ›´æ–°state.</p>
<p>è¿™é‡Œæ˜¯æˆ‘ä»¬reducerçš„åˆå§‹ç»“æ„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/reducer.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> init = List([]);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">todos=init, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span>(action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> todos;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ“ä½œ<code>ADD_TODO</code>actionéå¸¸ç®€å•,å¯æ˜¯ä½¿ç”¨<code>.push()</code>æ–¹æ³•,è¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨,æ·»åŠ todoåˆ°æœ«å°¾.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.push(<span class="built_in">Map</span>(action.payload));</div></pre></td></tr></table></figure>
<hr>
<p>è®°ä½è¦pushåˆ°åˆ—è¡¨ä¹‹å‰,è¦æŠŠtodoå¯¹è±¡è½¬å˜ä¸ºimmutable map.</p>
<p>æˆ‘ä»¬éœ€è¦å¤„ç†çš„ç¨å¾®å¤æ‚çš„actionæ˜¯<code>TOOGLE_TODO</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.map(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</div><div class="line">   <span class="keyword">if</span>(t.get(<span class="string">'id'</span>) === action.payload) &#123;</div><div class="line">     <span class="keyword">return</span> t.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line">   &#125; <span class="keyword">else</span> &#123;</div><div class="line">     <span class="keyword">return</span> t;</div><div class="line">   &#125;</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>.map()</code>éå†åˆ—è¡¨,æ‰¾åˆ°ä¸aciton<code>id</code>åŒ¹é…çš„todoé¡¹ç›®.ä¹‹åæˆ‘ä»¬è°ƒç”¨<code>.update()</code>æ–¹æ³•,æ¥æ”¶ä¸€ä¸ªé”®å’Œå‡½æ•°,ç„¶åè¿”å›ä¸€ä¸ªmapçš„æ–°æ‹·è´åˆ°updataå‡½æ•°,æ–°æ‹·è´ä¸­æ–°å€¼æ›¿æ¢äº†åˆå§‹å€¼.</p>
<p>å­—é¢é‡ç‰ˆæœ¬<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">const</span> todo = <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">'foo'</span>, <span class="attr">isDone</span>: <span class="literal">false</span> &#125;);</div><div class="line">todo.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line"><span class="comment">// =&gt; &#123; id: 0, text: 'foo', isDone: true &#125;</span></div></pre></td></tr></table></figure></p>
<hr>
<h2 id="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"><a href="#æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·" class="headerlink" title="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"></a>æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·</h2><p>actionså’Œreducerå‡†å¤‡å¥½äº†,å¯ä»¥åˆ›å»ºä¸€ä¸ªstore,è¿æ¥åˆ°æˆ‘ä»¬çš„Reactç»„ä»¶ä¸­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;store.getState()&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä¸ºäº†ä¿æŒç»„ä»¶å’Œstoreçš„ç‹¬ç«‹,æˆ‘ä»¬ä½¿ç”¨<code>react-redux</code>å¸®åŠ©ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹.å®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºç‹¬ç«‹äºstoreçš„å®¹å™¨,åŒ…è£…æ‰€æœ‰çš„ç»„ä»¶,æˆ‘ä»¬ä¸éœ€è¦æ”¹å˜å…ˆå‰çš„è®¾è®¡.</p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¹å™¨åŒ…è£…<code>&lt;TodoList/&gt;</code>ç»„ä»¶,çœ‹çœ‹ä¸‹é¢çš„å†…å®¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/containers.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> components <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> &#123; addTodo, toggleTodo &#125; <span class="keyword">from</span> <span class="string">'./actions'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> TodoList = connect(</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">)(components.TodoList);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>connect</code>å‡½æ•°åˆ›å»ºå®¹å™¨.å½“æˆ‘ä»¬è°ƒç”¨<code>connect()</code>å‡½æ•°,ä¼ é€’ä¸¤ä¸ªå‡½æ•°,<code>mapStateToProps()</code>å’Œ<code>mapDispatchToProps()</code>.</p>
<p><code>mapStateToProps()</code>å‡½æ•°æ¥æ”¶å½“å‰storeçš„stateä½œä¸ºå‚æ•°,æœŸå¾…è¿”å›ä¸€ä¸ªæˆ‘ä»¬åŒ…è£…ç»„ä»¶éœ€è¦çš„å¯¹è±¡æ˜ å°„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; <span class="attr">todos</span>: state &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢ä»£ç æ˜¯ä¸€ä¸ªåŒ…è£…ç»„ä»¶æ ¹æ®æ˜ å°„mapå¯è§†åŒ–çš„ç»“æœ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›<code>mapDispatchProps</code>å‡½æ•°,ä¼ é€’storeçš„<code>dispatch</code>æ–¹æ³•,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨action creatrosæ¥dispatch actions.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">addTodo</span>: <span class="function"><span class="params">text</span> =&gt;</span> dispatch(addTodo(text)),</div><div class="line">    <span class="attr">toggleTodo</span>: <span class="function"><span class="params">id</span> =&gt;</span> dispatch(toggleTodo(id))</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å†ä¸€æ¬¡å®ä¾‹åŒ–ç»„ä»¶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125;</div><div class="line">         addTodo=&#123;text =&gt; dispatch(addTodo(text))&#125;</div><div class="line">         toggleTodo=&#123;id =&gt; dispatch(toggleTodo(id))&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠaction creatorsæ˜ å°„åˆ°ç»„ä»¶,å¯ä»¥ä»äº‹ä»¶ç›‘å¬ä¸­è°ƒç”¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos, toggleTodo, addTodo &#125; = props;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> input = event.target;</div><div class="line">    <span class="keyword">const</span> text = input.value;</div><div class="line">    <span class="keyword">const</span> isEnterKey = (event.which == <span class="number">13</span>);</div><div class="line">    <span class="keyword">const</span> isLongEnough = text.length &gt; <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(isEnterKey &amp;&amp; isLongEnough) &#123;</div><div class="line">      input.value = <span class="string">''</span>;</div><div class="line">      addTodo(text);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> toggleClick = <span class="function"><span class="params">id</span> =&gt;</span> event =&gt; toggleTodo(id);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text'</div><div class="line">             className='todo__entry'</div><div class="line">             placeholder='Add todo'</div><div class="line">             onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">            &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>containerå®¹å™¨è‡ªåŠ¨è®¢é˜…storeçš„å˜åŒ–,åªè¦çš„æ˜ å°„çš„propså˜åŒ–çš„æ—¶å€™,å®¹å™¨åŒ…è£…çš„ç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“.</p>
<p>æœ€å,éœ€è¦ä½¿å®¹å™¨ç»„ä»¶ç‹¬ç«‹äºstore,ä½¿ç”¨<code>&lt;Provider/&gt;</code>ç»„ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./containers'</span>;</div><div class="line"><span class="comment">//                          ^^^^^^^^^^</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">TodoList</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>ä¸å¯å¦è®¤,å¯¹äºåˆå­¦è€…æ¥è¯´,Reactå’ŒReduxçš„ç”Ÿæ€ç³»ç»Ÿæ˜¯ç›¸å½“å¤æ‚å’Œä»¤äººè¿·æƒ‘çš„.<br>ä½†æ˜¯å¥½æ¶ˆæ¯æ˜¯è¿™äº›æ¦‚å¿µæ˜¯å¯ä»¥å¯ä»¥è½¬ç§»çš„.æˆ‘ä»¬ä»…ä»…ç²—ç•¥çš„æ¥è§¦äº†Reduxçš„åŸºç¡€æ„æ¶,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Elm æ„æ¶</code>,æˆ–è€…é€‰å–ClojureScriptåº“ä¾‹å¦‚ï¼š<code>Om</code>,<code>Re-frame</code>.ç±»ä¼¼çš„,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°immutableæ•°æ®ç»“æ„çš„åªè¨€ç‰‡è¯­,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Clojure</code>æˆ–è€…<code>Haskell</code>.</p>
<p>ä¸ç®¡ä½ æ˜¯åˆšå¼€å§‹æ¢ç´¢æœ‰å…³stateçš„webç¼–ç¨‹å¼€å‘è€…,è¿˜æ˜¯ä½¿ç”¨javascriptå¾ˆé•¿æ—¶é—´çš„å¼€å‘è€…,åŸºäºactionæ„æ¶çš„åŠæˆå’Œimmutableæ•°æ®ç»“æ„å˜å¾—è‡³è§‚é‡è¦çš„æŠ€èƒ½.æ‰€ä»¥ç°åœ¨æ˜¯å­¦ä¹ è¿™äº›å†…å®¹çš„æ—¶é—´äº†.</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-23T00:04:10.000Z" itemprop="datePublished">2017-03-23</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/ç¿»è¯‘/' title=''>ç¿»è¯‘</a>
          </span>
        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-Immutable collections for JavaScript" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/22/Immutable collections for JavaScript/">Immutable-collections</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h1 id="Immutable-collections-for-JavaScript"><a href="#Immutable-collections-for-JavaScript" class="headerlink" title="Immutable collections for JavaScript"></a>Immutable collections for JavaScript</h1><p><a href="https://travis-ci.org/facebook/immutable-js" target="_blank" rel="external"><img src="https://travis-ci.org/facebook/immutable-js.svg?branch=master" alt="Build Status"></a></p>
<p><a href="http://en.wikipedia.org/wiki/Immutable_object" target="_blank" rel="external">Immutable</a> data cannot be changed once created, leading to much simpler<br>application development, no defensive copying, and enabling advanced memoization<br>and change detection techniques with simple logic. <a href="http://en.wikipedia.org/wiki/Persistent_data_structure" target="_blank" rel="external">Persistent</a> data presents<br>a mutative API which does not update the data in-place, but instead always<br>yields new updated data.</p>
<p>Immutable.js provides many Persistent Immutable data structures including:<br><code>List</code>, <code>Stack</code>, <code>Map</code>, <code>OrderedMap</code>, <code>Set</code>, <code>OrderedSet</code> and <code>Record</code>.</p>
<p>These data structures are highly efficient on modern JavaScript VMs by using<br>structural sharing via <a href="http://en.wikipedia.org/wiki/Hash_array_mapped_trie" target="_blank" rel="external">hash maps tries</a> and <a href="http://hypirion.com/musings/understanding-persistent-vector-pt-1" target="_blank" rel="external">vector tries</a> as popularized<br>by Clojure and Scala, minimizing the need to copy or cache data.</p>
<p><code>Immutable</code> also provides a lazy <code>Seq</code>, allowing efficient<br>chaining of collection methods like <code>map</code> and <code>filter</code> without creating<br>intermediate representations. Create some <code>Seq</code> with <code>Range</code> and <code>Repeat</code>.</p>
<p>Want to hear more? Watch the presentation about Immutable.js:</p>
<p><a href="https://youtu.be/I7IdS-PbEgI" target="_blank" alt="Immutable Data and React"><img src="https://img.youtube.com/vi/I7IdS-PbEgI/0.jpg"></a></p>
<h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><p>Install <code>immutable</code> using npm.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install immutable</div></pre></td></tr></table></figure>
<p>Then require it into any module.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Immutable = <span class="built_in">require</span>(<span class="string">'immutable'</span>);</div><div class="line"><span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div></pre></td></tr></table></figure>
<h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><p>To use <code>immutable</code> from a browser, download <a href="https://github.com/facebook/immutable-js/blob/master/dist/immutable.min.js" target="_blank" rel="external">dist/immutable.min.js</a><br>or use a CDN such as <a href="https://cdnjs.com/libraries/immutable" target="_blank" rel="external">CDNJS</a><br>or <a href="http://www.jsdelivr.com/#!immutable.js" target="_blank" rel="external">jsDelivr</a>.</p>
<p>Then, add it as a script tag to your page:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"immutable.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line">    <span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">    map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">    map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Or use an AMD loader (such as <a href="http://requirejs.org/" target="_blank" rel="external">RequireJS</a>):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>([<span class="string">'./immutable.min.js'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">Immutable</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line">    <span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">    map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">    map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>If youâ€™re using <a href="http://browserify.org/" target="_blank" rel="external">browserify</a>, the <code>immutable</code> npm module<br>also works from the browser.</p>
<h3 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h3><p>Use these Immutable collections and sequences as you would use native<br>collections in your <a href="http://typescriptlang.org" target="_blank" rel="external">TypeScript</a> programs while still taking<br>advantage of type generics, error detection, and auto-complete in your IDE.</p>
<p>Just add a reference with a relative path to the type declarations at the top<br>of your file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///&lt;reference path='./node_modules/immutable/dist/immutable.d.ts'/&gt;</span></div><div class="line"><span class="keyword">import</span> Immutable = <span class="built_in">require</span>(<span class="string">'immutable'</span>);</div><div class="line"><span class="keyword">var</span> map1: Immutable.Map&lt;string, number&gt;;</div><div class="line">map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div></pre></td></tr></table></figure>
<h2 id="The-case-for-Immutability"><a href="#The-case-for-Immutability" class="headerlink" title="The case for Immutability"></a>The case for Immutability</h2><p>Much of what makes application development difficult is tracking mutation and<br>maintaining state. Developing with immutable data encourages you to think<br>differently about how data flows through your application.</p>
<p>Subscribing to data events throughout your application creates a huge overhead of<br>book-keeping which can hurt performance, sometimes dramatically, and creates<br>opportunities for areas of your application to get out of sync with each other<br>due to easy to make programmer error. Since immutable data never changes,<br>subscribing to changes throughout the model is a dead-end and new data can only<br>ever be passed from above.</p>
<p>This model of data flow aligns well with the architecture of <a href="http://facebook.github.io/react/" target="_blank" rel="external">React</a><br>and especially well with an application designed using the ideas of <a href="http://facebook.github.io/flux/docs/overview.html" target="_blank" rel="external">Flux</a>.</p>
<p>When data is passed from above rather than being subscribed to, and youâ€™re only<br>interested in doing work when something has changed, you can use equality.</p>
<p>Immutable collections should be treated as <em>values</em> rather than <em>objects</em>. While<br>objects represent some thing which could change over time, a value represents<br>the state of that thing at a particular instance of time. This principle is most<br>important to understanding the appropriate use of immutable data. In order to<br>treat Immutable.js collections as values, itâ€™s important to use the<br><code>Immutable.is()</code> function or <code>.equals()</code> method to determine value equality<br>instead of the <code>===</code> operator which determines object reference identity.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">2</span>);</div><div class="line">assert(map1.equals(map2) === <span class="literal">true</span>);</div><div class="line"><span class="keyword">var</span> map3 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">assert(map1.equals(map3) === <span class="literal">false</span>);</div></pre></td></tr></table></figure>
<p>Note: As a performance optimization <code>Immutable</code> attempts to return the existing<br>collection when an operation would result in an identical collection, allowing<br>for using <code>===</code> reference equality to determine if something definitely has not<br>changed. This can be extremely useful when used within a memoization function<br>which would prefer to re-run the function if a deeper equality check could<br>potentially be more costly. The <code>===</code> equality check is also used internally by<br><code>Immutable.is</code> and <code>.equals()</code> as a performance optimization.</p>
<p>If an object is immutable, it can be â€œcopiedâ€ simply by making another reference<br>to it instead of copying the entire object. Because a reference is much smaller<br>than the object itself, this results in memory savings and a potential boost in<br>execution speed for programs which rely on copies (such as an undo-stack).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line"><span class="keyword">var</span> clone = map1;</div></pre></td></tr></table></figure>
<h2 id="JavaScript-first-API"><a href="#JavaScript-first-API" class="headerlink" title="JavaScript-first API"></a>JavaScript-first API</h2><p>While <code>immutable</code> is inspired by Clojure, Scala, Haskell and other functional<br>programming environments, itâ€™s designed to bring these powerful concepts to<br>JavaScript, and therefore has an Object-Oriented API that closely mirrors that<br>of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla" target="_blank" rel="external">ES6</a> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="external">Array</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a>.</p>
<p>The difference for the immutable collections is that methods which would mutate<br>the collection, like <code>push</code>, <code>set</code>, <code>unshift</code> or <code>splice</code> instead return a new<br>immutable collection. Methods which return new arrays like <code>slice</code> or <code>concat</code><br>instead return new immutable collections.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list1 = Immutable.List.of(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="keyword">var</span> list2 = list1.push(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="keyword">var</span> list3 = list2.unshift(<span class="number">0</span>);</div><div class="line"><span class="keyword">var</span> list4 = list1.concat(list2, list3);</div><div class="line">assert(list1.size === <span class="number">2</span>);</div><div class="line">assert(list2.size === <span class="number">5</span>);</div><div class="line">assert(list3.size === <span class="number">6</span>);</div><div class="line">assert(list4.size === <span class="number">13</span>);</div><div class="line">assert(list4.get(<span class="number">0</span>) === <span class="number">1</span>);</div></pre></td></tr></table></figure>
<p>Almost all of the methods on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="external">Array</a> will be found in similar form on<br><code>Immutable.List</code>, those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a> found on <code>Immutable.Map</code>, and those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a><br>found on <code>Immutable.Set</code>, including collection operations like <code>forEach()</code><br>and <code>map()</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> alpha = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>, <span class="attr">d</span>:<span class="number">4</span>&#125;);</div><div class="line">alpha.map(<span class="function">(<span class="params">v, k</span>) =&gt;</span> k.toUpperCase()).join();</div><div class="line"><span class="comment">// 'A,B,C,D'</span></div></pre></td></tr></table></figure>
<h3 id="Accepts-raw-JavaScript-objects"><a href="#Accepts-raw-JavaScript-objects" class="headerlink" title="Accepts raw JavaScript objects."></a>Accepts raw JavaScript objects.</h3><p>Designed to inter-operate with your existing JavaScript, <code>immutable</code><br>accepts plain JavaScript Arrays and Objects anywhere a method expects an<br><code>Iterable</code> with no performance penalty.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>, <span class="attr">d</span>:<span class="number">4</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = Immutable.Map(&#123;<span class="attr">c</span>:<span class="number">10</span>, <span class="attr">a</span>:<span class="number">20</span>, <span class="attr">t</span>:<span class="number">30</span>&#125;);</div><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">d</span>:<span class="number">100</span>, <span class="attr">o</span>:<span class="number">200</span>, <span class="attr">g</span>:<span class="number">300</span>&#125;;</div><div class="line"><span class="keyword">var</span> map3 = map1.merge(map2, obj);</div><div class="line"><span class="comment">// Map &#123; a: 20, b: 2, c: 10, d: 100, t: 30, o: 200, g: 300 &#125;</span></div></pre></td></tr></table></figure>
<p>This is possible because <code>immutable</code> can treat any JavaScript Array or Object<br>as an Iterable. You can take advantage of this in order to get sophisticated<br>collection methods on JavaScript Objects, which otherwise have a very sparse<br>native API. Because Seq evaluates lazily and does not cache intermediate<br>results, these operations can be extremely efficient.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>&#125;;</div><div class="line">Immutable.Seq(myObject).map(<span class="function"><span class="params">x</span> =&gt;</span> x * x).toObject();</div><div class="line"><span class="comment">// &#123; a: 1, b: 4, c: 9 &#125;</span></div></pre></td></tr></table></figure>
<p>Keep in mind, when using JS objects to construct Immutable Maps, that<br>JavaScript Object properties are always strings, even if written in a quote-less<br>shorthand, while Immutable Maps accept keys of any type.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="number">1</span>: <span class="string">"one"</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.keys(obj); <span class="comment">// [ "1" ]</span></div><div class="line">obj[<span class="string">"1"</span>]; <span class="comment">// "one"</span></div><div class="line">obj[<span class="number">1</span>];   <span class="comment">// "one"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> map = Immutable.fromJS(obj);</div><div class="line">map.get(<span class="string">"1"</span>); <span class="comment">// "one"</span></div><div class="line">map.get(<span class="number">1</span>);   <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>Property access for JavaScript Objects first converts the key to a string, but<br>since Immutable Map keys can be of any type the argument to <code>get()</code> is<br>not altered.</p>
<h3 id="Converts-back-to-raw-JavaScript-objects"><a href="#Converts-back-to-raw-JavaScript-objects" class="headerlink" title="Converts back to raw JavaScript objects."></a>Converts back to raw JavaScript objects.</h3><p>All <code>immutable</code> Iterables can be converted to plain JavaScript Arrays and<br>Objects shallowly with <code>toArray()</code> and <code>toObject()</code> or deeply with <code>toJS()</code>.<br>All Immutable Iterables also implement <code>toJSON()</code> allowing them to be passed to<br><code>JSON.stringify</code> directly.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deep = Immutable.Map(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: Immutable.List.of(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>) &#125;);</div><div class="line">deep.toObject() <span class="comment">// &#123; a: 1, b: 2, c: List [ 3, 4, 5 ] &#125;</span></div><div class="line">deep.toArray() <span class="comment">// [ 1, 2, List [ 3, 4, 5 ] ]</span></div><div class="line">deep.toJS() <span class="comment">// &#123; a: 1, b: 2, c: [ 3, 4, 5 ] &#125;</span></div><div class="line"><span class="built_in">JSON</span>.stringify(deep) <span class="comment">// '&#123;"a":1,"b":2,"c":[3,4,5]&#125;'</span></div></pre></td></tr></table></figure>
<h3 id="Embraces-ES6"><a href="#Embraces-ES6" class="headerlink" title="Embraces ES6"></a>Embraces ES6</h3><p><code>Immutable</code> takes advantage of features added to JavaScript in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla" target="_blank" rel="external">ES6</a>,<br>the latest standard version of ECMAScript (JavaScript), including <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/The_Iterator_protocol" target="_blank" rel="external">Iterators</a>,<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="external">Arrow Functions</a>, <a href="http://wiki.ecmascript.org/doku.php?id=strawman:maximally_minimal_classes" target="_blank" rel="external">Classes</a>, and <a href="http://www.2ality.com/2014/09/es6-modules-final.html" target="_blank" rel="external">Modules</a>. Itâ€™s also inspired by the<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a> collections added to ES6. The library is â€œtranspiledâ€ to ES3<br>in order to support all modern browsers.</p>
<p>All examples are presented in ES6. To run in all browsers, they need to be<br>translated to ES3.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6</span></div><div class="line">foo.map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div><div class="line"><span class="comment">// ES3</span></div><div class="line">foo.map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x * x; &#125;);</div></pre></td></tr></table></figure>
<h2 id="Nested-Structures"><a href="#Nested-Structures" class="headerlink" title="Nested Structures"></a>Nested Structures</h2><p>The collections in <code>immutable</code> are intended to be nested, allowing for deep<br>trees of data, similar to JSON.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> nested = Immutable.fromJS(&#123;<span class="attr">a</span>:&#123;<span class="attr">b</span>:&#123;<span class="attr">c</span>:[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]&#125;&#125;&#125;);</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ] &#125; &#125; &#125;</span></div></pre></td></tr></table></figure>
<p>A few power-tools allow for reading and operating on nested data. The<br>most useful are <code>mergeDeep</code>, <code>getIn</code>, <code>setIn</code>, and <code>updateIn</code>, found on <code>List</code>,<br><code>Map</code> and <code>OrderedMap</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> nested2 = nested.mergeDeep(&#123;<span class="attr">a</span>:&#123;<span class="attr">b</span>:&#123;<span class="attr">d</span>:<span class="number">6</span>&#125;&#125;&#125;);</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ], d: 6 &#125; &#125; &#125;</span></div><div class="line"></div><div class="line">nested2.getIn([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>]); <span class="comment">// 6</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> nested3 = nested2.updateIn([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>], value =&gt; value + <span class="number">1</span>);</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ], d: 7 &#125; &#125; &#125;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> nested4 = nested3.updateIn([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], list =&gt; list.push(<span class="number">6</span>));</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5, 6 ], d: 7 &#125; &#125; &#125;</span></div></pre></td></tr></table></figure>
<h2 id="Lazy-Seq"><a href="#Lazy-Seq" class="headerlink" title="Lazy Seq"></a>Lazy Seq</h2><p><code>Seq</code> describes a lazy operation, allowing them to efficiently chain<br>use of all the Iterable methods (such as <code>map</code> and <code>filter</code>).</p>
<p><strong>Seq is immutable</strong> â€” Once a Seq is created, it cannot be<br>changed, appended to, rearranged or otherwise modified. Instead, any mutative<br>method called on a Seq will return a new Seq.</p>
<p><strong>Seq is lazy</strong> â€” Seq does as little work as necessary to respond to any<br>method call.</p>
<p>For example, the following does not perform any work, because the resulting<br>Seq is never used:</p>
<pre><code>var oddSquares = Immutable.Seq.of(1,2,3,4,5,6,7,8)
  .filter(x =&gt; x % 2).map(x =&gt; x * x);
</code></pre><p>Once the Seq is used, it performs only the work necessary. In this<br>example, no intermediate arrays are ever created, filter is called three times,<br>and map is only called once:</p>
<pre><code>console.log(oddSquares.get(1)); // 9
</code></pre><p>Any collection can be converted to a lazy Seq with <code>.toSeq()</code>.</p>
<pre><code>var seq = Immutable.Map({a:1, b:1, c:1}).toSeq();
</code></pre><p>Seq allows for the efficient chaining of sequence operations, especially when<br>converting to a different concrete type (such as to a JS object):</p>
<pre><code>seq.flip().map(key =&gt; key.toUpperCase()).flip().toObject();
// { A: 1, B: 1, C: 1 }
</code></pre><p>As well as expressing logic that would otherwise seem memory-limited:</p>
<pre><code>Immutable.Range(1, Infinity)
  .skip(1000)
  .map(n =&gt; -n)
  .filter(n =&gt; n % 2 === 0)
  .take(2)
  .reduce((r, n) =&gt; r * n, 1);
// 1006008
</code></pre><p>Note: An iterable is always iterated in the same order, however that order may<br>not always be well defined, as is the case for the <code>Map</code>.</p>
<h2 id="Equality-treats-Collections-as-Data"><a href="#Equality-treats-Collections-as-Data" class="headerlink" title="Equality treats Collections as Data"></a>Equality treats Collections as Data</h2><p><code>Immutable</code> provides equality which treats immutable data structures as pure<br>data, performing a deep equality check if necessary.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">1</span>, <span class="attr">c</span>:<span class="number">1</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">1</span>, <span class="attr">c</span>:<span class="number">1</span>&#125;);</div><div class="line">assert(map1 !== map2); <span class="comment">// two different instances</span></div><div class="line">assert(Immutable.is(map1, map2)); <span class="comment">// have equivalent values</span></div><div class="line">assert(map1.equals(map2)); <span class="comment">// alternatively use the equals method</span></div></pre></td></tr></table></figure>
<p><code>Immutable.is()</code> uses the same measure of equality as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="external">Object.is</a><br>including if both are immutable and all keys and values are equal<br>using the same measure of equality.</p>
<h2 id="Batching-Mutations"><a href="#Batching-Mutations" class="headerlink" title="Batching Mutations"></a>Batching Mutations</h2><blockquote>
<p>If a tree falls in the woods, does it make a sound?</p>
<p>If a pure function mutates some local data in order to produce an immutable<br>return value, is that ok?</p>
<p>â€” Rich Hickey, Clojure</p>
</blockquote>
<p>Applying a mutation to create a new immutable object results in some overhead,<br>which can add up to a minor performance penalty. If you need to apply a series<br>of mutations locally before returning, <code>Immutable</code> gives you the ability to<br>create a temporary mutable (transient) copy of a collection and apply a batch of<br>mutations in a performant manner by using <code>withMutations</code>. In fact, this is<br>exactly how  <code>Immutable</code> applies complex mutations itself.</p>
<p>As an example, building <code>list2</code> results in the creation of 1, not 3, new<br>immutable Lists.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list1 = Immutable.List.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</div><div class="line"><span class="keyword">var</span> list2 = list1.withMutations(<span class="function"><span class="keyword">function</span> (<span class="params">list</span>) </span>&#123;</div><div class="line">  list.push(<span class="number">4</span>).push(<span class="number">5</span>).push(<span class="number">6</span>);</div><div class="line">&#125;);</div><div class="line">assert(list1.size === <span class="number">3</span>);</div><div class="line">assert(list2.size === <span class="number">6</span>);</div></pre></td></tr></table></figure>
<p>Note: <code>immutable</code> also provides <code>asMutable</code> and <code>asImmutable</code>, but only<br>encourages their use when <code>withMutations</code> will not suffice. Use caution to not<br>return a mutable copy, which could result in undesired behavior.</p>
<p><em>Important!</em>: Only a select few methods can be used in <code>withMutations</code> including<br><code>set</code>, <code>push</code> and <code>pop</code>. These methods can be applied directly against a<br>persistent data-structure where other methods like <code>map</code>, <code>filter</code>, <code>sort</code>,<br>and <code>splice</code> will always return new immutable data-structures and never mutate<br>a mutable collection.</p>
<h2 id="Documentation"><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h2><p><a href="http://facebook.github.io/immutable-js/docs/" target="_blank" rel="external">Read the docs</a> and eat your vegetables.</p>
<p>Docs are automatically generated from <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts" target="_blank" rel="external">Immutable.d.ts</a>.<br>Please contribute!</p>
<p>Also, donâ€™t miss the <a href="https://github.com/facebook/immutable-js/wiki" target="_blank" rel="external">Wiki</a> which<br>contains articles on specific topics. Canâ€™t find something? Open an <a href="https://github.com/facebook/immutable-js/issues" target="_blank" rel="external">issue</a>.</p>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><p>If you are using the <a href="http://chaijs.com/" target="_blank" rel="external">Chai Assertion Library</a>, <a href="https://github.com/astorije/chai-immutable" target="_blank" rel="external">Chai Immutable</a> provides a set of assertions to use against <code>Immutable</code> collections.</p>
<h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><p>Use <a href="https://github.com/facebook/immutable-js/issues" target="_blank" rel="external">Github issues</a> for requests.</p>
<p>We actively welcome pull requests, learn how to <a href="./CONTRIBUTING.md">contribute</a>.</p>
<h2 id="Changelog"><a href="#Changelog" class="headerlink" title="Changelog"></a>Changelog</h2><p>Changes are tracked as <a href="https://github.com/facebook/immutable-js/releases" target="_blank" rel="external">Github releases</a>.</p>
<h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a href="https://www.youtube.com/watch?v=K2NYwP90bNs" target="_blank" rel="external">Phil Bagwell</a>, for his inspiration<br>and research in persistent data structures.</p>
<p><a href="https://github.com/hughfdjackson/" target="_blank" rel="external">Hugh Jackson</a>, for providing the npm package<br>name. If youâ€™re looking for his unsupported package, see <a href="https://github.com/hughfdjackson/immutable" target="_blank" rel="external">this repository</a>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p><code>Immutable</code> is <a href="https://github.com/facebook/immutable-js/blob/master/LICENSE" target="_blank" rel="external">BSD-licensed</a>. We also provide an additional <a href="https://github.com/facebook/immutable-js/blob/master/PATENTS" target="_blank" rel="external">patent grant</a>.</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-22T00:04:10.000Z" itemprop="datePublished">2017-03-22</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Redux/' title=''>Redux</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/21/ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥/">ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p><em>Arunoda Susiripala</em>  <a href="https://voice.kadira.io/let-s-compose-some-react-containers-3b91b6d9b7c8#.92sjwgug1" target="_blank" rel="external">è¯·å‚çœ‹åŸæ–‡</a></p>
</blockquote>
<p>è¿‘æ¥(Jan,2016),è‡ªç»™è‡ªè¶³çš„container(Reduxçš„å®¹å™¨)æ–¹æ³•åœ¨Reactçš„ç¤¾åŒºä¸­éå¸¸çš„æµè¡Œ.ä»–ä»¬åœ¨Realy,Reduxç”šè‡³æ˜¯åœ¨Meteorä¸­å¹¿æ³›ä½¿ç”¨.è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ·±å…¥containerå†…éƒ¨,äº†è§£ä¸€ä¸‹æ€ä¹ˆç®€ä¾¿çš„ç»„åˆcontainers.</p>
<h2 id="ä»€ä¹ˆæ˜¯Container"><a href="#ä»€ä¹ˆæ˜¯Container" class="headerlink" title="ä»€ä¹ˆæ˜¯Container?"></a>ä»€ä¹ˆæ˜¯Container?</h2><p>åœ¨Reactä¸­,æˆ‘ä»¬æœ‰propså’Œstatesæ¥ç®¡ç†ç»„ä»¶çš„æ•°æ®éœ€æ±‚.æœ€è¿‘æœ‰ä¸€ä¸ªè¶‹åŠ¿,åœ¨ç»„ä»¶ä¸­ä»…ä»…åªé€šè¿‡propsæ¥æ¥æ”¶æ•°æ®å’Œaction.æˆ‘ä»¬ä»…ä»…åœ¨ç»„ä»¶å†…éƒ¨ä¿ç•™state.</p>
<p>æˆ‘ä»¬æœ‰æ—¶å€™å«è¿™äº›ç»„ä»¶ä¸ºâ€œå•çº¯å±•ç¤ºç»„ä»¶â€.<br>æˆ‘ä¹Ÿä¸å¤ªç¡®å®šè°å‘æ˜çš„è¿™ä¸ªæœ¯è¯­.ä½†æ˜¯æˆ‘æ‰å¯èƒ½æ˜¯<a href="https://medium.com/@dan_abramov" target="_blank" rel="external">Dan Abramov</a>.<br>æŸ¥çœ‹ä¸€ä¸‹ä»–çš„æ–‡ç« â€œSmart and Dumb Componentsâ€.</p>
<p>ä½†æ˜¯æˆ‘è®¤ä¸ºå«åš<strong><code>UIç»„ä»¶</code></strong>æ›´å¥½ä¸€ç‚¹(æˆ–è€…ä»…ä»…å«åšç»„ä»¶).<br>æ¥ç€åˆå¦ä¸€å¥—ç»„ä»¶å®é™…ç®¡ç†æœ¬åœ°æ•°æ®å’Œè·å–è¿œç¨‹æ•°æ®.è¿™äº›ç»„ä»¶è¢«ç§°ä¸º<strong><code>containerç»„ä»¶</code></strong>.Relayå’ŒReduxçš„Reactç»‘å®šæ˜¯ä»–ä»¬æ›´æµè¡Œäº†.</p>
<p>ä¸‹é¢æ˜¯æ€ä¹ˆä½¿ç”¨Reat Devtoolsæ¥æŸ¥çœ‹ç»„ä»¶çš„è§†å›¾.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-f461d4894bfc06de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="1*QhMLf9dhu-cbAxN9Gc9dtg-2.png"></p>
<p>Container(BlogPost)æ¥æ”¶postId Props.ç„¶åä»–å°†ä¼šè·å–æ•°æ®ä¼ é€’åˆ°å®é™…UIç»„ä»¶ä¸­.</p>
<h2 id="Containerçš„å¸¸è§„ä»»åŠ¡"><a href="#Containerçš„å¸¸è§„ä»»åŠ¡" class="headerlink" title="Containerçš„å¸¸è§„ä»»åŠ¡"></a>Containerçš„å¸¸è§„ä»»åŠ¡</h2><p>containerçš„ä¸»è¦ä»»åŠ¡æ˜¯è·å–æ•°æ®,è¿™é‡Œé¢æœ‰ä¸€äº›äº‹æƒ…è¦åš,è®©æˆ‘ä»¬çœ‹çœ‹:</p>
<ul>
<li>è¯·æ±‚æ•°æ®(è°ƒç”¨è®¢é˜…æˆ–è€…ä»…ä»…è·å–æ•°æ®)</li>
<li>å½“æ•°æ®åŠ è½½çš„æ—¶å€™å±•ç¤ºåŠ è½½å›¾ç‰‡</li>
<li>ä¸€æ—¦æ•°æ®è¿”å›,æŠŠå®ƒä¼ é€’åˆ°UIç»„ä»¶ä¸­</li>
<li>å¦‚æœæœ‰é”™è¯¯,å±•ç¤ºç»™ç”¨æˆ·</li>
<li>å½“propsæ”¹å˜äº†,éœ€è¦é‡æ–°è·å–æˆ–è€…é‡æ–°è®¢é˜…</li>
<li>å½“containerå¸è½½çš„æ—¶å€™,éœ€è¦æ¸…é™¤èµ„æº.</li>
</ul>
<p>è¿™é‡Œcontaineræœ‰å¾ˆå¤šçš„ä»»åŠ¡è¦å®Œæˆ.å¦‚æœä½ æƒ³è‡ªå·±åšè¿™äº›ä»»åŠ¡,ä½ å°±ä¸å¾—ä¸åšä¸€äº›é‡å¤çš„å·¥ä½œ,å‘ç”Ÿé”™è¯¯çš„æ¥æºå°±ç”±æ­¤è¯ç”Ÿäº†.</p>
<h2 id="React-Komposerçš„ä»‹ç»"><a href="#React-Komposerçš„ä»‹ç»" class="headerlink" title="React Komposerçš„ä»‹ç»"></a>React Komposerçš„ä»‹ç»</h2><p>React Komposerè¯•å›¾å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“çš„åˆå¹¶containers.æœ‰äº†å®ƒ,ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®èµ„æº,ä¸ç®¡ä½ çš„æ•°æ®æ˜¯æ¥è‡ªäºPromise,Observableç”šè‡³æ˜¯Meteorâ€˜s Tracker.</p>
<h3 id="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3><p>åƒä¸‹é¢è¿™æ ·åˆ›å»ºä¸€ä¸ª<em>æ•°å­—æ—¶é’Ÿ</em>:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-10d84673aea28707.gif?imageMogr2/auto-orient/strip" alt="Digital clock"></p>
<p>è¿™æ˜¯ä¸€ä¸ªå¥½çš„å®ä¾‹,å› ä¸ºæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸ªcontainerçš„å‡ ä¹æ‰€æœ‰çš„åŠŸèƒ½.å¼€å§‹</p>
<p>é¦–å…ˆå®‰è£…react-komposer:</p>
<p><code>npm i â€” save react-komposer</code></p>
<p>ç„¶åè¾“å…¥composeå‡½æ•°ï¼š<br><code>import {compose} from â€˜react-komposerâ€™;</code></p>
<p>ç°åœ¨éœ€è¦ä¸€ä¸ªUIç»„ä»¶å»æ¸²æŸ“æ—¶é—´:</p>
<p><code>const Time = ({time}) =&gt; (&lt;div&gt;{time}&lt;/div&gt;);</code></p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„ç»„åˆå‡½æ•°:</p>
<p>è·å–æ—¶é—´çš„æ—¶å€™éœ€è¦è°ƒç”¨<code>onData</code>å›è°ƒå‡½æ•°(è¿™é‡Œæ²¡æœ‰å®é™…åšä»€ä¹ˆ.)</p>
<p>éœ€è¦è°ƒç”¨<code>onData</code>å‡½æ•°å¤šå°‘æ¬¡å¯ä»¥,åªè¦ç¨‹åºéœ€è¦.å¦‚æœæœ‰é”™è¯¯,å¯ä»¥æŠŠé”™è¯¯ä¿¡æ¯ä½œä¸º<code>onData</code>çš„ç¬¬ä¸€ä¸ªå€¼.</p>
<p>æœ€å,æˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ªæ¸…é™¤èµ„æºçš„é¢å‡½æ•°.åœ¨è¿™ä¸ªå®ä¾‹ä¸­ç”¨ä»–æ¥æ¸…é™¤setIntervaçš„å¥æŸ„.</p>
<p>å¥½äº†,ç°åœ¨æ¥åˆå¹¶ä¸€ä¸‹composer:<br><code>const Clock = compose(composerFunction)(Time);</code></p>
<p>ç„¶åæ¸²æŸ“åˆ°DOMä¸­:<br><code>ReactDOM.render(&lt;Clock /&gt;, document.body);</code></p>
<p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè‡ªæˆ‘ç®¡ç†(state)çš„æ—¶é’Ÿ.<a href="https://jsfiddle.net/arunoda/jxse2yw8/" target="_blank" rel="external">çœ‹çœ‹å®é™…æ¼”ç¤º</a>.</p>
<p>è¿™é‡Œæœ‰ä¸ª<a href="https://jsfiddle.net/arunoda/7qy1mxc7/" target="_blank" rel="external">æ›´å¤æ‚çš„ç‰ˆæœ¬</a>,ä½¿ç”¨props,å¤„ç†é”™è¯¯ä¿¡æ¯.</p>
<p>ä½ ä¹Ÿå¯ä»¥æ”¹å˜é»˜è®¤åŠ è½½å’Œé”™è¯¯ç»„ä»¶.æŸ¥çœ‹ä¸€ä¸‹<a href="https://github.com/kadirahq/react-komposer#api" target="_blank" rel="external">react-komposer æ–‡æ¡£</a>.</p>
<p>è·å¾—å¥½å¤„:æ›´å®¹æ˜“æµ‹è¯•</p>
<p>ä½œä¸ºè¿™ä¸ªç»„ä»¶çš„é™„åŠ æ•ˆæœ,æˆ‘ä»¬ç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“æµ‹è¯•UIä»£ç .</p>
<ul>
<li>å› ä¸ºUIç»„ä»¶ä»…ä»…é€šè¿‡propsæ¥æ”¶æ•°æ®(å’Œaction),æ˜¯çš„æµ‹è¯•å¾ˆå®¹æ˜“.</li>
<li>ä¹Ÿå¯ä»¥æµ‹è¯•ç»„åˆå‡½æ•°çš„æ•°æ®è·å–é€»è¾‘.</li>
</ul>
<h2 id="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"><a href="#å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ" class="headerlink" title="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"></a>å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ</h2><p>æˆ‘å·²ç»æåˆ°è¿‡,å¯ä»¥ä½¿ç”¨è¿™ä¸ªç»„ä»¶å’Œä»»ä½•æ•°æ®æºä¸€èµ·å·¥ä½œ,å› ä¸ºç»„åˆçš„APIæ˜¯é€šç”¨çš„.æˆ‘ä»¬æœ‰å¤„ç†æµè¡Œæ•°æ®æºçš„ç‰¹å®šAPIS.<br> è¿™é‡Œæ˜¯:</p>
<ul>
<li><em>composeWithPromise</em>ç”¨äºPromise-baseed æ•°æ®æº</li>
<li><em>composeWithObservable</em>ç”¨äºRx.js Observalbe-basedæ•°æ®æº</li>
<li><em>composeWithTracker</em>å‡ºäº‹ç‰¹æ®Šçš„ä¸€äº›æ•°æ®æº.</li>
</ul>
<p>æœ‰äº†è¿™äº›API,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨react-komposerå»åˆå¹¶ä»»ä½•æ•°æ®æºçš„container.</p>
<p>çœ‹çœ‹<a href="https://github.com/kadirahq/react-komposer#using-with-xxx" target="_blank" rel="external">repo</a>,æœ‰æ›´å¤šçš„ä¾‹å­.</p>
<p>åœ¨ä½ çš„appä¸­ä½¿ç”¨ä¸€ä¸‹react-komposer,ä½ ä¼šå–œæ¬¢ä¸Šä»–çš„.</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-21T00:04:10.000Z" itemprop="datePublished">2017-03-21</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/ç¿»è¯‘/' title=''>ç¿»è¯‘</a>
          </span>
        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/20/javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†/">javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p>å†¬è‡³æ¥äº†ï¼Œåˆšå»åƒäº†ä¸€ç¢—èåœé¥ºå­ï¼Œæµ‘èº«å‘çƒ­ã€‚çªç„¶è§‰å¾—é¸­å­å·²ç»ç†Ÿäº†ã€‚</p>
<p>å¼€ä¸ªç©ç¬‘ã€‚è¿™é‡Œè¦è¯´çš„æ˜¯åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»å‹(ducking type)ã€‚ <code>è¿™ä¸ªè¯é¢˜åº”è¯¥æ˜¯æ•´ä¸ªjavascripté¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³</code>.ä¸çŸ¥é“ä¸‹è¿™ä¸ªç»“è®ºå¯¹ä¸å¯¹ï¼Ÿå¯æ˜¯åœ¨å‰é¢è¿˜ä¸å¤ªäº†è§£åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ã€‚çœ‹ä»£ç çš„æ—¶å€™æ€»æœ‰ç§æ„Ÿè§‰ï¼Œå°±æ˜¯javascriptå¤ªçµæ´»äº†ï¼Œæ€ä¹ˆä»€ä¹ˆå¯¹è±¡çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡å‚æ•°ä¼ é€’çš„æ–¹å¼æ¥åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ã€‚åœ¨æ¨¡å¼å­¦ä¹ æ—¶å¸¸çœ‹åˆ°è¿™ç§ä»£ç ã€‚<br>åˆšæ‰åˆé‡æ–°çœ‹è¿™éƒ¨åˆ†å†…å®¹æ—¶çªç„¶æ˜ç™½äº†ã€‚è¿™ä¸ªæ–¹æ³•å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹é‡Œçš„é¸­å­æ¨¡å‹ã€‚</p>
<p>ä»€ä¹ˆæ˜¯é¸­å­ç±»å‹å‘¢ï¼Ÿæˆ‘æ€»ç»“ä¸€å¥è¯ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦èƒ½å¹²æ´»å°±è¡Œã€‚javascripté‡Œé¢å¯¹è±¡éƒ½æ˜¯è“é¢†ï¼Œåªå¹²æ´»ï¼Œè‡³äºæ˜¯å°å­¦æ°´å¹³è¿˜æ˜¯åšå£«æ°´å¹³ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒï¼Œèƒ½å¹²æ´»å°±è¡Œã€‚ javaè¯­è¨€å°±ä¸æ˜¯ï¼Œjavaåœ¨ä½ å¹²æ´»ä¹‹å‰æƒ³è¦æŠŠä½ çš„ç¥–å®—åå…«ä»£éƒ½æŸ¥ä¸€éï¼Œæ ¹æ­£è‹—çº¢çš„æ‰èƒ½æ¥å¹²æ´»ã€‚æ‰€ä»¥javascriptå°±å¾ˆçµæ´»å•¦ã€‚</p>
<p>è¿™å°±æ˜¯é¸­å­ç±»å‹ã€‚<code>å¦‚æœå®ƒèµ°èµ·è·¯æ¥åƒé¸­å­ï¼Œå«èµ·æ¥å˜å˜çš„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­</code>ã€‚</p>
<p>é¸­å­ç±»å‹èµ‹äºˆäº†javascriptæå¤§çš„çµæ´»æ€§ï¼ŒåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„æ—¶å€™éå¸¸è‡ªç”±ã€‚ </p>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ ç¬¬ä¸€ç« </p>
<p>çœ‹ä¸‹é¢ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> duck = &#123;  <span class="comment">//é¸­å­å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> chicken = &#123;  <span class="comment">//é¸¡å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> choir = []; <span class="comment">// åˆå”±å›¢</span></div><div class="line">	<span class="keyword">var</span> joinChoir = <span class="function"><span class="keyword">function</span>(<span class="params"> animal </span>)</span>&#123; <span class="comment">//å®ä¾‹åŒ–åŠ¨ç‰©å¯¹è±¡</span></div><div class="line">		<span class="keyword">if</span> ( animal &amp;&amp; <span class="keyword">typeof</span> animal.duckSinging === <span class="string">'function'</span> )&#123; </div><div class="line">       <span class="comment">//ç¨ä½œæ£€æµ‹ï¼Œåªè¦æœ‰å”±æ­Œçš„æ–¹æ³•å°±å¯ä»¥ç”¨ã€‚</span></div><div class="line">			choir.push( animal );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ­å–œåŠ å…¥åˆå”±å›¢'</span> );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'åˆå”±å›¢å·²æœ‰æˆå‘˜æ•°é‡:'</span> + choir.length );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	joinChoir( duck ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div><div class="line">	joinChoir( chicken ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªé¸­å­ç±»å‹çš„ä»£ç ï¼Œ é¸¡ä¹Ÿæ··å…¥åˆå”±å›¢äº†ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦ä½ èƒ½å”±æ­Œå°±è¡Œäº†ã€‚<br>å¾ˆæ–¹ä¾¿å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚ javascriptä»£ç ä¸­éå¸ƒè¿™æ ·çš„ä¾‹å­ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥ä¸€ç‚¹ä¹Ÿä¸å¥‡æ€ªäº†ã€‚å› ä¸ºè¿™é¸­å­ç±»å‹å°±æ˜¯åŠ¨æ€è¯­è¨€çš„ä¼˜åŠ¿ã€‚è€Œjavascriptå°±æ˜¯åŠ¨æ€è¯­è¨€ä¹‹ä¸€ï¼Œåªæ˜¯å®ç°äº†è¿™ç§æ¨¡å¼è€Œå·²ã€‚</p>
<p>å¯¹äºè¿™ä¸ªé—®é¢˜çš„è®¤è¯†ä¹Ÿç ´è´¹å‘¨æŠ˜ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥æ˜¯å€¼å¾—çš„ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå¯¹javascriptçš„åº”ç”¨èƒ½åŠ›å°±æ›´åŠ æ·±äº†ä¸€æ­¥ã€‚</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-20T00:04:10.000Z" itemprop="datePublished">2017-03-20</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/19/javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼/">javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ç§åªéœ€è¦ä½¿ç”¨ç»§æ‰¿å°±å¯ä»¥å®ç°çš„éå¸¸ç®€å•çš„æ¨¡å¼<br> æ¨¡æ¿æ–¹æ³•ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€æ˜¯æŠ½è±¡çš„çˆ¶ç±»ï¼ŒäºŒæ˜¯å…·ä½“å®ç°çš„å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°ä¸€äº›å…¬å…±æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚</p>
</blockquote>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬11ç« </p>
<p>è¿™ä¸ªæ¨¡å¼æ–¹æ³•å¾ˆæœ‰æ„æ€,åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„é¢è¿‡ç¨‹ï¼Œæ˜¯å¯¹ç±»ä¼¼çš„ç”Ÿäº§è¿‡ç¨‹çš„å…·ä½“ç»†èŠ‚çš„ç†è§£ï¼Œæ‰¾å‡ºæµç¨‹ä¸­çš„å…±åŒç‚¹ä½œä¸ºæŠ½è±¡çš„çˆ¶ç±»ã€‚<br>å’–å•¡å’ŒèŒ¶çš„å†²æ³¡è¿‡ç¨‹</p>
<table>
<thead>
<tr>
<th style="text-align:left">æ³¡<code>å’–å•¡</code></th>
<th style="text-align:left">æ³¡<code>èŒ¶</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
</tr>
<tr>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æ³¡å’–å•¡</code></td>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æµ¸æ³¡èŒ¶å¶</code></td>
</tr>
<tr>
<td style="text-align:left">æŠŠ<code>å’–å•¡</code>å€’è¿›æ¯å­</td>
<td style="text-align:left">æŠŠ<code>èŒ¶æ°´</code>å€’è¿›æ¯å­</td>
</tr>
<tr>
<td style="text-align:left">åŠ <code>ç³–å’Œç‰›å¥¶</code></td>
<td style="text-align:left">åŠ <code>æŸ æª¬</code></td>
</tr>
</tbody>
</table>
<p>æŠŠæ³¡å’–å•¡å’Œæ³¡èŒ¶çš„ä¸åŒç‚¹æ ‡ç¤ºå‡ºæ¥ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯å…±åŒçš„éƒ¨åˆ†</p>
<ul>
<li>[ ] åŸæ–™ä¸åŒï¼Œä¸€ä¸ªæ˜¯å’–å•¡ï¼Œä¸€ä¸ªæ˜¯èŒ¶ã€‚æŠ½è±¡ä¸ºé¥®æ–™</li>
<li>[ ] æ³¡çš„æ–¹å¼ä¸åŒï¼Œä¸€ä¸ªæ˜¯æ³¡ï¼Œä¸€ä¸ªæ˜¯æµ¸æ³¡ã€‚ç»Ÿä¸€æŠ½è±¡ä¸ºæ³¡</li>
<li>[ ] åŠ å…¥çš„è°ƒå‘³å“ä¸åŒï¼Œä¸€ä¸ªæ˜¯ç³–å’Œç‰›å¥¶ï¼Œä¸€ä¸ªæ˜¯æŸ æª¬ã€‚æŠ½è±¡ä¸ºè°ƒæ–™<br>æ•´ä¸ªå†²æ³¡é¥®æ–™çš„è¿‡ç¨‹å°±æŠ½è±¡ä¸ºä¸‹é¢çš„æµç¨‹</li>
</ul>
<ol>
<li>æŠŠæ°´ç…®æ²¸</li>
<li>ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</li>
<li>æŠŠé¥®æ–™å€’è¿›è¢«å­</li>
<li>åŠ è°ƒæ–™</li>
</ol>
<p>æŠ½è±¡çš„çˆ¶ç±»çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; </div><div class="line">Beverage.prototype.boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log( <span class="string">'æŠŠæ°´ç…®æ²¸'</span> );</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Beverage.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å®šä¹‰å­ç±»çš„å‡½æ•°æ‰§è¡Œé¡ºåº</span></div><div class="line">	<span class="keyword">this</span>.boilWater();</div><div class="line">	<span class="keyword">this</span>.brew();</div><div class="line">	<span class="keyword">this</span>.pourInCup();</div><div class="line">	<span class="keyword">this</span>.addCondiments();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ‰äº†çˆ¶ç±»çš„æ¨¡æ¿ï¼Œåœ¨ç…®èŒ¶æ˜¯å°±ä¾ç…§çˆ¶ç±»çš„æ¨¡æ¿æ¥ä½¿ç”¨ï¼Œé€šç”¨éƒ¨åˆ†ä¸åŠ¨ï¼Œç‰¹æ®Šçš„åœ°æ–¹é‡å†™çˆ¶ç±»çš„æ–¹æ³•</p>
<p>èŒ¶å¶å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ¨¡æ¿</p>
<pre><code>var Tea = function(){}; //å®šä¹‰ç…®èŒ¶å­ç±»
Tea.prototype = new Beverage(); //ç»§æ‰¿çˆ¶ç±»
Tea.prototype.brew = function(){ //é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&apos; );
};
Tea.prototype.pourInCup = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;æŠŠèŒ¶å€’è¿›æ¯å­&apos; );
};
Tea.prototype.addCondiments = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;åŠ æŸ æª¬&apos; );
};
var tea = new Tea(); //å®ä¾‹åŒ–å­ç±»
tea.init(); //ä¾ç…§çˆ¶ç±»çš„æ–¹æ³•æ‰§è¡Œé¡ºåºæ¥æ‰§è¡Œ

//ç”±äºjavascriptçš„å¯¹è±¡åŸå‹ç»§æ‰¿é“¾çš„æ–¹å¼å’Œjavaçš„ç»§æ‰¿æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¿™é‡Œä»£ç ç»“æ„å’Œjavaç±»ä¼¼ï¼Œä½†æ˜¯é‡Œé¢çš„æœºåˆ¶æ˜¯ä¸åŒçš„

<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line"></div><div class="line"><span class="clean">#####é’©å­æ–¹æ³•</span></div><div class="line"></div><div class="line"><span class="number">1.</span> æŠŠæ°´ç…®æ²¸</div><div class="line"><span class="number">2.</span> ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</div><div class="line"><span class="number">3.</span> æŠŠé¥®æ–™å€’è¿›è¢«å­</div><div class="line"><span class="number">4.</span> åŠ è°ƒæ–™</div><div class="line"></div><div class="line">ä¸Šé¢æ˜¯ä¸€èˆ¬çš„å†²è°ƒé¥®æ–™çš„æµç¨‹ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚æœ‰çš„äººå¯èƒ½ä¸ä¼šåŠ è°ƒæ–™ã€‚é‡åˆ°è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨`é’©å­æ–¹æ³•`æ¥åœ¨éš”ç¦»æœ‰å˜åŒ–çš„æ­¥éª¤</div></pre></td></tr></table></figure>
</code></pre><p>var Beverage = function(){};<br>    Beverage.prototype.boilWater = function(){<br>        console.log( â€˜æŠŠæ°´ç…®æ²¸â€™ );<br>    };<br>    Beverage.prototype.brew = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™brew æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.pourInCup = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™pourInCup æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.addCondiments = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™addCondiments æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.customerWantsCondiments = function(){<br>        return true; // é»˜è®¤éœ€è¦è°ƒæ–™<br>    };<br>    Beverage.prototype.init = function(){<br>        this.boilWater();<br>        this.brew();<br>        this.pourInCup();<br>    if ( this.customerWantsCondiments() ){ // å¦‚æœæŒ‚é’©è¿”å›trueï¼Œåˆ™éœ€è¦è°ƒæ–™<br>        this.addCondiments(); //ç¬¬å››æ­¥å°±å˜ä¸ºå¯é€‰çš„æ–¹æ³•äº†<br>    }<br>};<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å®ä¾‹åŒ–å†²æ³¡å’–å•¡çš„å®ä¾‹</div></pre></td></tr></table></figure></p>
<p> var CoffeeWithHook = function(){};<br> CoffeeWithHook.prototype = new Beverage();<br>CoffeeWithHook.prototype.brew = function(){<br>    console.log( â€˜ç”¨æ²¸æ°´å†²æ³¡å’–å•¡â€™ );<br>};<br>CoffeeWithHook.prototype.pourInCup = function(){<br>    console.log( â€˜æŠŠå’–å•¡å€’è¿›æ¯å­â€™ );<br>};<br>CoffeeWithHook.prototype.addCondiments = function(){<br>    console.log( â€˜åŠ ç³–å’Œç‰›å¥¶â€™ );<br>};<br>CoffeeWithHook.prototype.customerWantsCondiments = function(){<br>    return window.confirm( â€˜è¯·é—®éœ€è¦è°ƒæ–™å—ï¼Ÿâ€™ );//å¯¹é¡¾å®¢é€‰æ‹©çš„åˆ¤æ–­æ¡ä»¶<br>};<br>var coffeeWithHook = new CoffeeWithHook();</p>
<p>```</p>
<p>æ¨¡æ¿æ–¹æ³•é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ã€‚</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-19T00:04:10.000Z" itemprop="datePublished">2017-03-19</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptç»„åˆæ¨¡å¼" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/18/javascriptç»„åˆæ¨¡å¼/">javascriptç»„åˆæ¨¡å¼</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ç”±æ›´å°çš„å¯¹è±¡ç»„æˆçš„ã€‚è¿™é‡Œåªæ˜¯ç»„åˆï¼Œå¹¶æ²¡æœ‰ä»å±å…³ç³»ã€‚å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬åç« </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®å‘½ä»¤çš„ä»£ç </span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openPcCommand = &#123; <span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openQQCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//ç»„åˆæ¨¡å¼çš„æ ¹å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;<span class="comment">//å¶å¯¹è±¡ä½œä¸ºæ•°ç»„çš„å…ƒç´ ä¼ é€’åˆ°</span></div><div class="line">			<span class="comment">//æ•°ç»„ä¸­</span></div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰§è¡Œç»„åˆå‘½ä»¤</span></div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute(); <span class="comment">//å¶å¯¹è±¡éƒ½æœ‰executeæ–¹æ³•</span></div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> macroCommand = MacroCommand();</div><div class="line">	macroCommand.add( closeDoorCommand );<span class="comment">//æ·»åŠ åˆ°æ ¹å¯¹è±¡æ•°ç»„ä¸­</span></div><div class="line">	macroCommand.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.add( openQQCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.execute();<span class="comment">//æ‰§è¡Œæ ¹å‘½ä»¤</span></div></pre></td></tr></table></figure>
<p><em>ä¸¤ä¸ªè¦ç‚¹</em>:1.jså¯¹è±¡å¼•ç”¨å¯ä»¥ä½œä¸ºæ•°ç»„å…ƒç´ åŠ å…¥åˆ°æ•°ç»„ä¸­ã€‚2. å¶å¯¹è±¡éƒ½æœ‰ä¸€æ ·çš„executeæ–¹æ³•ã€‚åœ¨æ ¹å¯¹è±¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨leaf.executeçš„æ¨¡å¼æ¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>åœ¨å¶å¯¹è±¡ä¸­è¿˜å¯ä»¥ç»§ç»­æ‰©å±•ä¹Ÿå¯¹è±¡ï¼Œç»„åˆçš„æ·±åº¦ç»§ç»­åŠ æ·±ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ ¹å¯¹è±¡çš„æ–¹æ³•ä¿æŒä¸å˜</span></div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openAcCommand = &#123;</div><div class="line">		<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç©ºè°ƒ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"><span class="comment">/**********å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤</span></div><div class="line">*********/</div><div class="line"><span class="keyword">var</span> openTvCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç”µè§†'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openSoundCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€éŸ³å“'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand1 = MacroCommand(); <span class="comment">//ç¬¬ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openTvCommand ); <span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openSoundCommand );<span class="comment">//åŒä¸Š</span></div><div class="line"><span class="comment">/*********å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½•QQ çš„å‘½ä»¤****************/</span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openPcCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openQQCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand2 = MacroCommand();<span class="comment">//ç¬¬äºŒä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( closeDoorCommand );<span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">macroCommand2.add( openQQCommand );</div><div class="line"><span class="comment">/*********ç°åœ¨æŠŠæ‰€æœ‰çš„å‘½ä»¤ç»„åˆæˆä¸€ä¸ªâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> macroCommand = MacroCommand(); <span class="comment">//é¡¶çº§æ ¹å¯¹è±¡</span></div><div class="line">macroCommand.add( openAcCommand ); <span class="comment">//ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand.add( macroCommand1 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line">macroCommand.add( macroCommand2 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line"><span class="comment">/*********æœ€åç»™é¥æ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> setCommand = (<span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		command.execute();</div><div class="line">	&#125;</div><div class="line">&#125;)( macroCommand );</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//æœ€ç»ˆæ‰€æœ‰çš„å¶å¯¹è±¡çš„å¼•ç”¨éƒ½æ·»åŠ åˆ°commandlistæ•°ç»„ä¸­ï¼Œåœ¨æ ¹å¯¹è±¡ä¸Šæ‰§è¡Œ</span></div><div class="line"><span class="comment">//executeæ–¹æ³•æ—¶ï¼Œä¼šéå†æ‰€æœ‰çš„å¶å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œleaf.execute()æ–¹æ³•ã€‚</span></div><div class="line"><span class="comment">//å¾—åˆ°ç»“æœ</span></div></pre></td></tr></table></figure>
<p>#####æœ€ç»ˆè¿˜æ˜¯ä½¿ç”¨äº†javascriptçš„æ•°ç»„æ“ä½œå’Œå¯¹è±¡æ“ä½œçš„ä¾¿åˆ©æ€§ã€‚åœ¨javascriptçš„æ¨¡å¼è®¾è®¡ä¸­ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨æ“ä½œæ•°ç»„å’Œå¯¹è±¡ã€‚æ‰€æœ‰æœ‰å¿…è¦è¿˜å¥½åœ¨æ·±åˆ»ç†è§£ä¸€ä¸‹æ•°ç»„å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>è¿™ä¸ªç³»åˆ—å†™äº†å¥½å‡ ç¯‡æ–‡ç« äº†ã€‚å…¶å®å†™çš„æ—¶å€™å¥½å¤šåœ°æ–¹è¿˜ä¸å¤ªæ‡‚ï¼Œå†™ç€å†™ç€æœ‰äº›åœ°æ–¹å°±æ˜ç™½äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦åšæŒå†™ä¸‹å»ã€‚ç°åœ¨è§‰å¾—å†™çš„è¿˜ä¸é”™ï¼Œè¿‡åŠå¹´å¯èƒ½è§‰å¾—å°±å¾ˆå‚»äº†ã€‚</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-17T23:04:10.000Z" itemprop="datePublished">2017-03-17</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptæ¡¥æ¥æ¨¡å¼(2)" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/17/javascriptæ¡¥æ¥æ¨¡å¼(2)/">javascriptæ¡¥æ¥æ¨¡å¼(2)</a>
  

      </h3>
      <div class="repo-list-description">
        
          <ol>
<li>äº‹ä»¶ç›‘å¬å™¨</li>
<li>æ¡¥æ¥æ¨¡å¼çš„å…¶ä»–ä¾‹å­<br>è¿™å®é™…å°±æ˜¯ä¸€ä¸ªé—­åŒ…çš„ä¾‹å­ï¼Œé€šè¿‡é—­åŒ…å‡½æ•°è·å–å¤–å±‚å‡½æ•°ä½œç”¨åŸŸå†…å®šä¹‰çš„ç§æœ‰å˜é‡ã€‚è¿™ä¸ªå‡½æ•°åˆå¯ä»¥å«åšç‰¹æƒå‡½æ•°ï¼Œgetterå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªgetä¸set.       </li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> <span class="keyword">Public</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">var</span> secret = <span class="number">3</span>;</div><div class="line">  this.privilegedGetter = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> secret;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="keyword">Public</span>;</div><div class="line"><span class="keyword">var</span> data = o.privilegedGetter();</div></pre></td></tr></table></figure>
<p>3 .  ç”¨æ¡¥æ¥æ¨¡å¼è”ç»“å¤šä¸ªç±».é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œå¦‚æœä»£ç ä»ä¸Šå¾€ä¸‹çœ‹æ˜¯èšåˆäº†è¿ä¸ªç±»ã€‚åœ¨æ¡¥æ¥ç±»ä¸­ç»Ÿä¸€è¿”å›ã€‚å¦‚æœæ˜¯ä»ä¸‹å¾€ä¸Šçœ‹ä»£ç ï¼Œå®é™…æ˜¯æŠŠä¸€ä¸ªå®Œæ•´çš„ä»£ç æ‹†æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„ç±»ï¼Œè¿™æ ·ä¸¤ä¸ªç‹¬ç«‹çš„ç±»å¯ä»¥ä¿®æ”¹è‡ªå·±çš„é€»è¾‘ï¼Œä¸ä¼šå½±å“åˆ°å¦ä¸€ç±»çš„å·¥ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">var</span> Class1 = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = a;</div><div class="line">  <span class="keyword">this</span>.b = b;</div><div class="line">  <span class="keyword">this</span>.c = c;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> Class2 = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.d = d;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> BridgeClass = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.one = <span class="keyword">new</span> Class1(a, b, c);</div><div class="line">  <span class="keyword">this</span>.two = <span class="keyword">new</span> Class2(d);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>4 . æ„å»ºXHRè¿æ¥é˜Ÿåˆ—</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-17T13:04:10.000Z" itemprop="datePublished">2017-03-17</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptå•ä¾‹æ¨¡å¼(1)" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/16/javascriptå•ä¾‹æ¨¡å¼(1)/">javascriptå•ä¾‹æ¨¡å¼(1)</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>å•ä¾‹(singleton).è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ç§å°†ä»£ç ç»„ç»‡ä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒçš„æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡å•ä¸€å˜é‡æ¥è®¿é—®ã€‚é€šè¿‡ç¡®ä¿å•ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªæ‹·è´ï¼Œå¯ä»¥ç¡®ä¿ä»£ä¹°ä½¿ç”¨ç«¥é¢œçš„å…¨å±€èµ„æºã€‚å•ä¾‹å¯ä»¥ç”¨æ¥åˆ’åˆ†å‘½åç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ©å•ä¾‹æŠŠä»£ç ç»„ç»‡çš„æ›´ä¸ºä¸€è‡´ï¼Œä»è€Œæ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚</p>
</blockquote>
<pre><code>æœ¬æ–‡å‚ç…§è¿™æœ¬ä¹¦ç¬¬äº”ç« ï¼Œä»‹ç»çš„é‡ç‚¹å’Œå¦ä¸€æœ¬ä¹¦å¥½åƒæ˜¯ä¸åŒçš„ã€‚ç»“åˆç€çœ‹çœ‹    
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2044710-c97bcd5773f19459.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="s3398900.jpg"></p>
<p>####å•ä¾‹çš„åŸºæœ¬ç»“æ„<br>æœ€åŸºæœ¬çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯¹è±¡å­—é¢é‡ä½œä¸ºå•ä½“</span></div><div class="line"><span class="keyword">var</span> Singleton = &#123;</div><div class="line">  <span class="attr">attribute1</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">attribute2</span>: <span class="number">10</span>,</div><div class="line"></div><div class="line">  <span class="attr">method1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">method2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Singleton.attribute1 = <span class="literal">false</span>; <span class="comment">//ä¿®æ”¹</span></div><div class="line"><span class="keyword">var</span> total = Singleton.attribute2 + <span class="number">5</span>; <span class="comment">//ä½¿ç”¨å•ä¾‹</span></div><div class="line"><span class="keyword">var</span> result = Singleton.method1();</div></pre></td></tr></table></figure>
<p><code>æ–¹æ³•ä½äºå¯¹è±¡å­—é¢é‡ä¸­å°±æœ‰äº†å‘½åç©ºé—´ï¼Œå’Œå…¶ä»–åŒåçš„å‡½æ•°å°±ä¸ä¼šå†²çªäº†ã€‚å¯¹è±¡å­—é¢é‡é‡Œçš„æ–¹æ³•ç»Ÿä¸€ç”¨  nameSpace.methodçš„æ ¼å¼è°ƒç”¨</code><br>å¯¹è±¡å­—é¢é‡çš„å‘½åç©ºé—´è¿˜å¯ä»¥ç»§ç»­åˆ’åˆ†ä¾‹å¦‚parent.children.methodã€‚<br>è¿™æ ·ä¸ä»…å˜é‡å‘ç”Ÿå†²çªçš„æœºä¼šå¤§å¤§å‡å°‘ï¼Œè€Œä¸”å½’å±æ›´æ˜ç¡®äº†ã€‚</p>
<p>ä¸Šé¢çš„å¯¹è±¡å­—é¢é‡çš„å•ä¾‹æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Ÿ åœ¨nodeç¨‹åºä¸­çš„é…ç½®æ–‡ä»¶config.jsé‡Œé¢æ˜¯ä¸æ˜¯éƒ½æ˜¯è¿™ç§ä»£ç ï¼Ÿ é…ç½®é¡¹éƒ½æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚</p>
<p>#####æƒ°æ€§å®ä¾‹åŒ–<br>æœ¬æ¥å•ä¾‹æ˜¯æƒ³å†™è¿™ä¸ªå†…å®¹çš„ï¼Œä½†æ˜¯ä»Šå¤©ä¸€çœ‹ï¼Œè¿˜æ˜¯æ²¡çœ‹å…¨ã€‚æ›¾æ¢çš„jsæ¨¡å¼ä¹¦é‡Œçš„å•ä¾‹å…¶å®éƒ½æ˜¯è¿™ä¸ªéƒ¨åˆ†ã€‚<code>å®é™…çš„å•ä¾‹ä»£ç æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥ç¼“å­˜å®ä¾‹åŒ–çš„ä»£ç ï¼Œå¦‚æœå·²ç»å®ä¾‹åŒ–å°±ç›´æ¥è¿”å›ç¼“å­˜çš„ä»£ç ã€‚</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">  MyNamespace.Singleton = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">var</span> uniqueInstance; <span class="comment">// ç§æœ‰å˜é‡ç¼“å­˜å®ä¾‹åŒ–å•ä¾‹</span></div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">constructor</span>(<span class="params"></span>) </span>&#123; <span class="comment">// å…·ä½“éœ€è¦æŒ‰éœ€åŠ è½½çš„ä»£ç .</span></div><div class="line">    <span class="keyword">var</span> privateAttribute1 = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">var</span> privateAttribute2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod2</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123; <span class="comment">// Public members.</span></div><div class="line">      publicAttribute1: <span class="literal">true</span>,</div><div class="line">      <span class="attr">publicAttribute2</span>: <span class="number">10</span>,</div><div class="line">    </div><div class="line">      <span class="attr">publicMethod1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">publicMethod2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;</div><div class="line">    &#125;  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">getInstance</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>(!uniqueInstance) &#123; <span class="comment">// å•ä¾‹è‹¥ä¸å­˜åœ¨ï¼Œè°ƒç”¨constructorå‡½æ•°</span></div><div class="line">        uniqueInstance = <span class="keyword">constructor</span>(); //è°ƒç”¨<span class="keyword">constructor</span>å‡½æ•°åï¼Œç¼“å­˜è¿”å›å€¼</div><div class="line">      &#125;</div><div class="line">      return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-16T00:04:10.000Z" itemprop="datePublished">2017-03-16</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-javascriptä»£ç†æ¨¡å¼" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/12/javascriptä»£ç†æ¨¡å¼/">javascriptä»£ç†æ¨¡å¼</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>ä»£ç†æ¨¡å¼æ˜¯ç»™å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®<br>   å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<p><code>ç¼“å­˜ä»£ç†</code></p>
<p>  ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€æ¯”è¾ƒå¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œä¸‹ä¸€æ¬¡è¿ç®—æ—¶å¦‚æœä¼ é€’å‚æ•°å’Œç¼“å­˜çš„å‚æ•°ä¸€è‡´ï¼Œåˆ™å¯æ˜¯ç›´æ¥è¿”å›å‰é¢å­˜å‚¨çš„è¿ç®—ç»“æœ</p>
<p>è®¡ç®—ä¹˜ç§¯çš„å®ä¾‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//é»˜è®¤ä¼ é€’çš„argumentså‚æ•°åˆ—è¡¨</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹è®¡ç®—ä¹˜ç§¯'</span> );</div><div class="line">		<span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++ )&#123;</div><div class="line">			a = a * <span class="built_in">arguments</span>[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> a;</div><div class="line">	&#125;;</div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span> ); <span class="comment">// è¾“å‡ºï¼š6</span></div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24</span></div><div class="line">	<span class="comment">//ç°åœ¨åŠ å…¥ç¼“å­˜ä»£ç†å‡½æ•°ï¼š</span></div><div class="line"></div><div class="line">	<span class="keyword">var</span> proxyMult = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> cache = &#123;&#125;;  <span class="comment">//ç¼“å­˜å¯¹è±¡</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.join.call( <span class="built_in">arguments</span>, <span class="string">','</span> ); </div><div class="line">			<span class="keyword">if</span> ( args <span class="keyword">in</span> cache )&#123; <span class="comment">//å¦‚æœåˆå¹¶çš„å‚æ•°åœ¨ç¼“å­˜ä¸­</span></div><div class="line">				<span class="keyword">return</span> cache[ args ]; <span class="comment">//ç›´æ¥åˆ†ä¼šç¼“å­˜æ•°æ®</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> cache[ args ] = mult.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> ); </div><div class="line">                        <span class="comment">//è°ƒç”¨å‡½æ•°ä¹‹åå­˜å‚¨åˆ°ç¼“å­˜å¯¹è±¡ä¸­</span></div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line"></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24  //ç¬¬ä¸€æ¬¡è®¡ç®—</span></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24 //ç¬¬äºŒæ¬¡è®¡ç®—ï¼Œç›´æ¥å­˜ç¼“å­˜ä¸­è·å–</span></div><div class="line"></div><div class="line"><span class="comment">//è¿™é‡Œçš„ä¸¤ä¸ªå‡½æ•°ï¼Œmultiè´Ÿè´£è®¡ç®—ï¼ŒproxyMultiè´Ÿè´£ç¼“å­˜çš„å­˜å‚¨å’Œè¯»å–ã€‚</span></div><div class="line"><span class="comment">//ä¸¤ä¸ªå‡½æ•°åˆ†åŠŸèƒ½å®Œæˆå¯¹åº”çš„åŠŸèƒ½</span></div></pre></td></tr></table></figure>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-12T00:04:10.000Z" itemprop="datePublished">2017-03-12</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/Designpattern/' title=''>Designpattern</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2017/03/12/ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App/">ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>è¿™ç¯‡æ–‡ç« æ—¶é—´æœ‰ç‚¹ä¹…è¿œ,ç¿»è¯‘è¯•è¯•çœ‹.ä½†æ˜¯æœ¬ç¯‡æ–‡ç« å¯¹äºReactçš„æ¸²æŸ“å·¥ä½œåŸç†è®²çš„æ¯”è¾ƒå¥½,ä½¿ç”¨ä¸€ä¸ªæ¸¸æˆå¼•æ“çš„æ¸²æŸ“æ–¹å¼æ¥ç±»æ¯”è§£é‡ŠReactçš„æ•°æ®æµç¨‹,å€¼å¾—å­¦ä¹ . <a href="http://konkle.us/architecting-your-app-react-part-1/" target="_blank" rel="external">åŸæ–‡åœ¨è¿™é‡Œ</a></p>
</blockquote>
<p>å»å¹´äº”æœˆ(2013å¹´5æœˆ),Facebookå‘å¸ƒäº†æ„å»ºå‰ç«¯ç»„ä»¶åº“çš„å¼€æºè½¯ä»¶-React.Reactå¯¹äºæµè§ˆå™¨å’Œappçš„ç»“æ„æ¥è¯´æœ‰ç‚¹å¼‚ç±».ä½†æ˜¯ç»è¿‡è¿™æ®µæ—¶é—´,å¼€å‘è€…é€æ¸çœ‹åˆ°äº†ä¸€äº›ä¼˜åŠ¿,Reactä¹Ÿå› æ­¤è·å–äº†å¾ˆå¤šçš„äººæ°”.Reactæœ€ä¸ºç›¸åŠ©çš„é¢ç‰¹å¾æ˜¯å¼•å…¥äº†virtual-DOMæ–¹æ³•,virtual-DOMä½¿å®é™…çš„æµè§ˆå™¨çš„DOMå˜åŒ–å‡åˆ°æœ€ä½,DOMçš„æ¸²æŸ“æ€§èƒ½å¤§å¹…æé«˜.</p>
<p>Reactå¹¶ä¸æ˜¯å®Œæ•´çš„MVCæ¡†æ¶,Reactå®é™…æ˜¯MVCçš„åŠ å¼ºç‰ˆ(è¿™ç‚¹,çœŸæ˜¯é›ªä¸­é€ç‚­,ä¸€ç›´éƒ½å¯¹è¿™ä¸ªæ¡†æ¶åˆ°åº•æ˜¯ä¸æ˜¯MVCè€Œå¿ƒå­˜ç–‘è™‘).å¾ˆå¤šå¼€å‘è€…é€‰æ‹©Reactä½œä¸ºMVCæ¡†æ¶çš„å»¶ä¼¸,ä¾‹å¦‚Backbone.Reactæœ¬èº«å¹¶æ²¡æœ‰è·¯ç”±å’Œæ•°æ®åŒæ­¥çš„å†…å®¹,æ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨å–œæ¬¢çš„å·¥å…·æ¥å®Œæˆç±»ä¼¼çš„åŠŸèƒ½.Reactä¹Ÿå¯ä»¥åœ¨å…¶ä»–çš„åº”ç”¨ä¸­ç®¡ç†ä¸€éƒ¨åˆ†ç‰¹å®šçš„ç»„ä»¶.ä½†æ˜¯å¦‚æœåœ¨åº”ç”¨çš„ç•Œé¢ä¸Šå…¨é¢ä½¿ç”¨React,å‘æŒ¥çš„åŠŸèƒ½ä¼šæ›´å¤§.</p>
<p>#####å°½å¯èƒ½çš„é¿å…DOM<br>Reactä½œä¸ºjavascriptçš„ä¸€ä¸ªç±»,æä¾›virtual-DOMå®æ–½æ–¹æ¡ˆ.è¿™æ„å‘³ç€ä½ å¯ä»¥é¢‘ç¹çš„æ›´æ–°ä½ çš„åº”ç”¨ç¨‹åºçš„å…ƒç´ æ ‘,ä½†æ˜¯å®é™…ä¸Šæ²¡æœ‰å‘ç”Ÿæµè§ˆå™¨çš„DOMæ“ä½œ.ç”±äºä½¿ç”¨äº†ç°ä»£çš„å¼•æ“,Javascriptçš„é€Ÿåº¦ç›¸å½“å¿«.å®é™…ç”±äºå¼•æ“çš„é€Ÿåº¦å¾ˆå¿«,å½“æ¯ä¸€æ¬¡æ•°æ®æ›´æ–°çš„æ—¶å€™,æ¸²æŸ“åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å¯ä»¥çš„,å‡å°‘äº†å®æ—¶å…ƒç´ æ“ä½œå’ŒåŒå‘æ•°æ®ç»‘å®šçš„éœ€æ±‚.Reactå‘¨æœŸæ€§çš„æ¯”è¾ƒvirtual-DOMå’Œæµè§ˆå™¨DOM,ä»…ä»…åšå‡ºæœ€æœ‰å¿…è¦çš„DOMåŒæ­¥.</p>
<p>#####å•å‘æ•°æ®æµ<br>å½“HTMLå…ƒç´ çš„æ¸²æŸ“èŠ±é”€å¤§å¹…åº¦é™ä½ä»¥å,ä½ ç°åœ¨éœ€è¦èŠ±è´¹æ›´å¤šçš„çš„æ–¹æ³•æ¥ç®¡ç†ä½ çš„ç•Œé¢.æ”¾å¼ƒé”™ç»¼å¤æ‚çš„å°±åœ°æ›´æ–°å…ƒç´ æ“ä½œå’Œæ•°æ®å˜åŒ–ä¸­çš„çš„å¤šä¸ªstateçš„åŒæ­¥,ä½ å¯ä»¥æŠŠçŠ¶æ€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹,åŸºäºé›†ä¸­çš„stateæ¥æè¿°ä½ çš„ç•Œé¢.åªè¦çŠ¶æ€ä»¥æ”¹å˜,Reactçš„ç»„ä»¶å°±å¯ä»¥è¿›è¡Œæ›´æ–°æ“ä½œ.<br>å½“ä½ çš„æ•´ä¸ªåº”ç”¨éƒ½åŸºäºè¿™ä¸ªæ€æƒ³æ¥è®¾è®¡,ä½ å¯ä»¥æŠŠimmutable æ•°æ®ä»é¡¶å±‚ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶,ç„¶åæ‰§è¡Œè‡ªé¡¶å‘ä¸‹çš„åº”ç”¨æ›´æ–°.Reactä»æ ¹æœ¬ä¸Šæ”¹å˜äº†ä½ å¯¹åº”ç”¨çš„æ€è·¯,è€Œä¸”ç»å¸¸ä¼šç®€åŒ–åº”ç”¨çš„è®¾è®¡.</p>
<p>#####æµè§ˆå™¨ä½œä¸ºæ¸²æŸ“å¼•æ“<br>è¿™ä¸€ç‚¹æ˜¯å¯¹MVCæ¡†æ¶éå¸¸æ¿€è¿›çš„æ”¹å˜,å®ƒå¼ºè°ƒä½¿ç”¨åŒå‘æ•°æ®ç»‘å®š,å°½å¯èƒ½å¤šè‡ªåŠ¨å°±åœ°é‡æ–°æ¸²æŸ“.å½“æˆ‘åˆšå¼€å§‹äº†è§£Reactçš„æ—¶å€™,æˆ‘è¿˜ä¸æ˜¯å¤ªç¡®å®š.è½¬æŠ˜ç‚¹æ˜¯æˆ‘çœ‹äº†ä¸€ä¸ªPete Huntçš„è§†é¢‘:æ¯”è¾ƒReactå’ŒDoom3æ¸²æŸ“å¼•æ“.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-a1553d287e86aebb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="doom3çš„æ¸²æŸ“ç¤ºæ„å›¾"><br>åœ¨å›¾è¡¨ä¸­,æ¸¸æˆçš„sateç»è¿‡åº•å±‚çš„å›¾å½¢ä»£ç å¯¼å…¥å‰ç«¯é€»è¾‘å’ŒæŠ½è±¡å±‚.è¿™ä¸ªæ“ä½œä¼šåˆ›å»ºä¸€ä¸ªâ€œåœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚â€(scene intermediate representation),è¿™ä¸ªè¡¨ç¤ºå±‚è¡¨ç°å‡ºç”¨æˆ·åº”è¯¥çœ‹åˆ°çš„å†…å®¹.è¿™ä¸ªè¡¨ç¤ºå±‚ä¼šä¼ é€’ç»™â€backendâ€(åç«¯),åç«¯æ¥æ”¶è¡¨ç¤ºå±‚å†…å®¹,éšä¹‹è½¬æ¢ä¸ºOpenGLæ“ä½œ,OpenGLä½¿ç”¨å›¾å½¢å¡(ç”µè„‘æ˜¾å¡)æ¸²æŸ“å‡ºå†…å®¹.Reactçš„å·¥ä½œåŸç†å’ŒDoom3çš„æ¸²æŸ“æ–¹å¼æ˜¯ä¸€æ ·çš„.(doom3æ˜¯æ—©æœŸä¸€æ¬¾æ¯”è¾ƒè‘—åçš„ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆ,è¿™é‡Œä½¿ç”¨doom3çš„å›¾å½¢æ¸²æŸ“æ–¹å¼æ¥è¯´æ˜Reactçš„å·¥ä½œæ–¹å¼).</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-73a98731bc9d6411.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Reactç»„ä»¶æ¸²æŸ“"></p>
<p>å½“ç¨‹åºçš„stateç”±äºæµè§ˆå™¨æˆ–è€…å®æ—¶äº‹ä»¶å‘ç”Ÿå˜åŒ–,Reactç¨‹åºæ¥æ”¶è¿™äº›å˜åŒ–,å¹¶ä¸”ä¼ é€’ç»™ç»„ä»¶ä»¬,æ¥ç€ä½¿ç”¨virtual-DOMæ–¹å¼ç”Ÿæˆä¸­é—´è¡¨ç¤ºå±‚.æµè§ˆå™¨çš„DOMå¹¶ä¸ä¼šå‘ç”Ÿç«‹å³çš„å˜åŒ–.ç„¶è€ŒReactä¼šå‘¨æœŸæ€§çš„æ¥æ”¶virtual DOM,è®¡ç®—å‡ºå¿…è¦çš„DOMæ“ä½œ.è¿™ä¸€ç‚¹å’Œæ¸¸æˆå¼•æ“æ¥å—åœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚,å†³å®šæ˜¯å¦ä½¿ç”¨OpenGLæ¸²æŸ“åœºæ™¯ç±»ä¼¼.Reactæ˜¯æ¥æ”¶DOM,æŠŠå®ƒæ¸²æŸ“åˆ°ç”¨æˆ·å±å¹•ä¸Š.(å¯è§ä¸¤è€…æ¸²æŸ“çš„æ€è·¯æ˜¯ä¸€æ ·çš„,Reactä½¿ç”¨äº†æµè§ˆå™¨æ¥åšè¿™ä¸ªå·¥ä½œ).</p>
<p>æµè§ˆå™¨å’Œæ¸¸æˆå¼•æ“ä¸€æ ·,æœ€æ…¢çš„éƒ¨åˆ†å®é™…æ˜¯ä¸­é—´è¡¨ç¤ºå±‚åˆ°å±å¹•çš„æ¸²æŸ“éƒ¨åˆ†.ä½ å¯ä»¥å¯¹virtual-DOMåšå‡ºè®¸å¤šç»†å°çš„æ”¹å˜,Reactä¼˜åŒ–äº†è¿™ä¸ªéƒ¨åˆ†,æ‰€ä»¥ä¸ä¼šå› æ­¤è€Œç‰ºç‰²æ¸²æŸ“çš„æ€§èƒ½.</p>
<p>#####æ›´å¤šçš„èµ„æº<br>åœ¨ç¬¬äºŒéƒ¨åˆ†,æˆ‘å°†ä¼šæ¼”ç¤ºæ€ä¹ˆæŠŠReactçš„è®¾è®¡å“²å­¦ä»˜è¯¸å®è·µ.æˆ‘ä¼šåˆ†äº«æ€ä¹ˆæ›´å…·ä¸åŒçš„åŠŸèƒ½è´£ä»»,æ¸²æŸ“ä¸€ä¸ªç”±å°ç»„ä»¶ç»„æˆçš„é¡¶çº§ç»„ä»¶çš„ç•Œé¢.æˆ‘ä¹Ÿä¼šæ¼”ç¤ºæ€ä¹ˆåœ¨Reactåº”ç”¨ä¸­æ•´åˆè·¯ç”±åŠŸèƒ½å’Œæ•°æ®åŒæ­¥åŠŸèƒ½.</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„Reactå†…å®¹,æƒ³çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„,çœ‹çœ‹ä¸‹é¢çš„èµ„æºåˆ—è¡¨.</p>
<ul>
<li><a href="http://facebook.github.io/react/" target="_blank" rel="external">Reactä¸»é¡µ</a></li>
<li><a href="http://facebook.github.io/react/docs/videos.html" target="_blank" rel="external">è§†é¢‘</a></li>
<li><a href="http://facebook.github.io/react/docs/examples.html" target="_blank" rel="external">å®ä¾‹</a></li>
<li><a href="https://groups.google.com/forum/#!forum/reactjs" target="_blank" rel="external">React Google Group</a></li>
<li>#reactjs on Freenode-å®˜æ–¹ IRCé¢‘é“,æ¯”è¾ƒæ´»è·ƒ</li>
</ul>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2017-03-12T00:04:10.000Z" itemprop="datePublished">2017-03-12</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/ç¿»è¯‘/' title=''>ç¿»è¯‘</a>
          </span>
        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
        </div>
        <div class="column one-third">
          <!--å¤„ç†æœªå®‰è£… search æ’ä»¶ é»˜è®¤ Google æœç´¢-->
 

<h3>Search</h3>

<div id="site_search">

	<!-- Google -->
	

	<!-- æœ¬åœ°æœç´¢ -->
	
		<form id="search-form" >
			<input type="text" id="search" placeholder="Search" >
			<button type="button" class="btn btn-default" id="site_search_do"><span class="octicon octicon-search"></span></button>
		</form>

		<div id="local-search-result"></div>

		<script src="/js/search.js"></script>	
		<script type="text/javascript">
			$(function(){
				var currentIndex = -1;
				var search_path = "search.xml";
				if (!search_path) search_path = "search.xml";
				var path = "/" + search_path;
				searchFunc(path, 'search', 'local-search-result');

				$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
					var liNode = $("#local-search-result>.search-result-list li");
					liNode.removeClass("hover");
					currentIndex = $("#local-search-result>.search-result-list li").index($(this));
					liNode.eq(currentIndex).addClass("hover");
				})

				$("#search-form").submit(function(){
					return false;
				})

				$("#search").keydown(function(event){
					var keyCode = event.keyCode;
					var liNode = $("#local-search-result>.search-result-list li");
					if(keyCode == 38 || keyCode == 40 || keyCode == 13){
						liNode.removeClass("hover");
						if(keyCode == 38){
							if(currentIndex - 1 >= 0) currentIndex --;
						}
						if(keyCode == 40){
							if(currentIndex + 1 < liNode.length) currentIndex ++;
						}
						if(keyCode == 13){
							location.href = liNode.eq(currentIndex).find("a").attr("href");
						}
						liNode.eq(currentIndex).addClass("hover");
						return false;
					}else{
						currentIndex = -1;
					}
				})
			})
		</script>

	

</div>

<h3>Popular Repositories</h3>
    <div class="popular-container"></div>
    
    <script type="text/template" id="popular-list-template">
        <a href="{%=clone_url%}" class="card text-center" target="_blank">
            <div class="thumbnail">
                <div class="card-image geopattern" data-pattern-id="{%=name%}">
                    <div class="card-image-cell">
                        <h3 class="card-title">
                            {%=name%}
                        </h3>
                    </div>
                </div>
                <div class="caption">
                    <div class="card-description">
                        <p class="card-text">
                            {%=description%}
                        </p>
                    </div>
                    <div class="card-text">
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=stargazers_count%} stars">
                            <span class="octicon octicon-star"></span> {%=stargazers_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=forks_count%} forks">
                            <span class="octicon octicon-git-branch"></span> {%=forks_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="æœ€åæ›´æ–°æ—¶é—´ï¼š{%=updated_at%}">
                            <span class="octicon octicon-clock"></span>
                            <time datetime="{%=updated_at%}">{%=updated_at%}</time>
                        </span>
                    </div>
                </div>
            </div>
        </a>
    </script>

    <script src="/js/baiduTemplate.js"></script>
    <script type="text/javascript">
        var popular_repos = function(){

            var baiduTpl = new Object();

            var handleTpl = function(){
                baiduTpl.popular_list = baidu.template("popular-list-template");
            };

            var handleGithub = function(){
                var popularContainer = $(".popular-container");

                var repos = "hexo-theme-primer".split(",");
                for(var i in repos){
                    var name = repos[i];
                    $.get("https://api.github.com/repos/yumemor/"+name,handle);
                }

                function handle(result){
                    result.updated_at = result.updated_at.split("T")[0];
                    if(result){
                        var html = baiduTpl.popular_list(result);
                        popularContainer.append(html);
                        $(".geopattern").each(function(){           
                            $(this).geopattern($(this).data('pattern-id'));
                        });
                    }
                }
            };

            return {
                init:function(){
                    handleTpl();
                    handleGithub();
                }
            }
        }; 
        $(popular_repos().init);
    </script>

        </div>
    </div>

    
      <div class="pagination text-align">
          <div class="btn-group">
              <a class="extend prev" rel="prev" href="/archives/2017/">&laquo;</a><a class="page-number" href="/archives/2017/">1</a><span class="page-number current">2</span><a class="page-number" href="/archives/2017/page/3/">3</a><a class="page-number" href="/archives/2017/page/4/">4</a><a class="page-number" href="/archives/2017/page/5/">5</a><a class="page-number" href="/archives/2017/page/6/">6</a><a class="extend next" rel="next" href="/archives/2017/page/3/">&raquo;</a>
          </div>
      </div>
    
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                Â© 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="é¦–é¡µ">é¦–é¡µ</a>
                  </li>
            
                  
                  <li>
                    <a href="/category/" target="true" title="åˆ†ç±»">åˆ†ç±»</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="å¼€æºé¡¹ç›®">å¼€æºé¡¹ç›®</a>
                  </li>
            
                  
                  <li>
                    <a href="/message/"  title="ç•™è¨€æ¿">ç•™è¨€æ¿</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>