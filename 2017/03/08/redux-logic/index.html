<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>phpsmarter | redux-logic</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
</head>

<body>
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="phpsmarter"><span class="octicon octicon-mark-github"></span> phpsmarter</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="首页">首页</a>
        
              
              <a href="/category/" target="true" class=" site-header-nav-item hvr-underline-from-center" title="分类">分类</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="开源项目">开源项目</a>
        
              
              <a href="/message/"  class=" site-header-nav-item hvr-underline-from-center" title="留言板">留言板</a>
        
      </nav>
  </div>
</header>

	
<section class="collection-head geopattern" data-pattern-id="redux-logic" >
    <div class="container">
        <div class="collection-title">
            <h1 class="collection-header">
                redux-logic
            </h1>
            
                <div class="collection-info">
                    <span class="meta-info">
                        <span class="octicon octicon-calendar"></span>
                        <time datetime="2017-03-08T00:04:10.000Z" itemprop="datePublished">2017-03-08</time>
                    </span>
                    
                        <span class="meta-info">
                            <span class="octicon octicon-file-directory"></span>
                            <a href='/categories/Redux/' title=''>Redux</a>
                        </span>
                    
                </div>
            
        </div>
    </div>
</section>
	<section class="container">
    <div class="columns">
        <div class="column three-fourths" >
            <article class="article-content markdown-body">
                <h1 id="redux-logic"><a href="#redux-logic" class="headerlink" title="redux-logic"></a>redux-logic</h1><blockquote>
<p>“One place for all your business logic and action side effects”</p>
</blockquote>
<p>Redux middleware that can:</p>
<ul>
<li><strong>intercept</strong> (validate/transform/augment) actions AND</li>
<li><strong>perform async processing</strong> (fetching, I/O, side effects)</li>
</ul>
<p><a href="http://travis-ci.org/jeffbski/redux-logic" target="_blank" rel="external"><img src="https://secure.travis-ci.org/jeffbski/redux-logic.png?branch=master" alt="Build Status"></a> <a href="https://www.codacy.com/app/jeff-barczewski/redux-logic" target="_blank" rel="external"><img src="https://img.shields.io/codacy/grade/3687e7267e6d466b9d226c22b24f0061.svg" alt="Codacy Grade Badge"></a> <a href="https://www.codacy.com/app/jeff-barczewski/redux-logic" target="_blank" rel="external"><img src="https://img.shields.io/codacy/coverage/3687e7267e6d466b9d226c22b24f0061.svg" alt="Codacy Coverage Badge"></a> <a href="https://snyk.io/test/github/jeffbski/redux-logic" target="_blank" rel="external"><img src="https://snyk.io/test/github/jeffbski/redux-logic/badge.svg" alt="Known Vulnerabilities"></a> <a href="https://www.npmjs.com/package/redux-logic" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-logic.svg" alt="NPM Version Badge"></a></p>
<h2 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h2><p>With redux-logic, you have the <strong>freedom</strong> to write your logic in <strong>your favorite JS style</strong>:</p>
<ul>
<li>plain <strong>callback</strong> code - <code>dispatch(resultAction)</code></li>
<li><strong>promises</strong> - <code>return axios.get(url).then(...)</code></li>
<li><strong>async/await</strong> - <code>result = await fetch(url)</code></li>
<li><strong>observables</strong> - <code>ob$.next(action1)</code></li>
</ul>
<blockquote>
<p>Use the type of code you and your team are comfortable and experienced with.</p>
</blockquote>
<p>Leverage powerful <strong>declarative</strong> features by simply setting properties:</p>
<ul>
<li><strong>filtering</strong> for action type(s) or with regular expression(s)</li>
<li><strong>cancellation</strong> on receiving action type(s)</li>
<li>use only response for the <strong>latest</strong> request</li>
<li><strong>debouncing</strong></li>
<li><strong>throttling</strong></li>
<li>dispatch actions - auto <strong>decoration</strong> of payloads</li>
</ul>
<p>Testing your logic is straight forward and simple.</p>
<p>With simple code your logic can:</p>
<ul>
<li><strong>intercept</strong> actions before they hit the reducer<ul>
<li><strong>validate</strong>, verify, auth check actions and allow/reject or modify actions</li>
<li><strong>transform</strong> - augment/enhance/modify actions</li>
</ul>
</li>
<li><strong>process</strong> - <strong>async processing</strong> and dispatching, orchestration, I/O (ajax, REST, subscriptions, GraphQL, web sockets, …)</li>
</ul>
<p>Redux-logic makes it easy to use code that is split into bundles, so you can dynamically load logic right along with your split UI.</p>
<p>Server rendering is simplified with redux-logic since it lets you know when all your async fetching is complete without manual tracking.</p>
<p>Inspired by redux-observable epics, redux-saga, and custom redux middleware, redux-logic combines ideas of each into a simple easy to use API.</p>
<h2 id="Quick-Example"><a href="#Quick-Example" class="headerlink" title="Quick Example"></a>Quick Example</h2><p>This is an example of logic which will listen for actions of type FETCH_POLLS and it will perform ajax request to fetch data for which it dispatches the results (or error) on completion. It supports cancellation by allowing anything to send an action of type CANCEL_FETCH_POLLS. It also uses <code>take latest</code> feature that if additional FETCH_POLLS actions come in before this completes, it will ignore the outdated requests.</p>
<p>The developer can just declare the type filtering, cancellation, and take latest behavior, no code needs to be written for that. That leaves the developer to focus on the real business requirements which are invoked in the process hook.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fetchPollsLogic = createLogic(&#123;</div><div class="line"></div><div class="line">  <span class="comment">// declarative built-in functionality wraps your code</span></div><div class="line">  type: FETCH_POLLS, <span class="comment">// only apply this logic to this type</span></div><div class="line">  cancelType: CANCEL_FETCH_POLLS, <span class="comment">// cancel on this type</span></div><div class="line">  latest: <span class="literal">true</span>, <span class="comment">// only take latest</span></div><div class="line"></div><div class="line">  <span class="comment">// your code here, hook into one or more of these execution</span></div><div class="line">  <span class="comment">// phases: validate, transform, and/or process</span></div><div class="line">  process(&#123; getState, action &#125;, dispatch, done) &#123;</div><div class="line">    axios.get(<span class="string">'https://survey.codewinds.com/polls'</span>)</div><div class="line">      .then(<span class="function"><span class="params">resp</span> =&gt;</span> resp.data.polls)</div><div class="line">      .then(<span class="function"><span class="params">polls</span> =&gt;</span> dispatch(&#123; <span class="attr">type</span>: FETCH_POLLS_SUCCESS,</div><div class="line">                                <span class="attr">payload</span>: polls &#125;))</div><div class="line">      .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">             <span class="built_in">console</span>.error(err); <span class="comment">// log since could be render err</span></div><div class="line">             dispatch(&#123; <span class="attr">type</span>: FETCH_POLLS_FAILED, <span class="attr">payload</span>: err,</div><div class="line">                        <span class="attr">error</span>: <span class="literal">true</span> &#125;)</div><div class="line">      &#125;)</div><div class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> done()); <span class="comment">// call done when finished dispatching</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Since redux-logic gives you the freedom to use your favorite style of JS code (callbacks, promises, async/await, observables), it supports many features to make that easier, <a href="/jeffbski/redux-logic/blob/master/docs/api.md#dispatch---multi-dispatching-and-process-variable-signature">explained in more detail</a>.</p>
<h2 id="Table-of-contents"><a href="#Table-of-contents" class="headerlink" title="Table of contents"></a>Table of contents</h2><ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="./docs/api.md">Full API</a></li>
<li><a href="#examples">Examples</a> - <a href="#jsfiddle-live-examples">JSFiddle</a> and <a href="#full-examples">full examples</a></li>
<li><a href="#comparison-summaries">Comparison summaries</a> to <a href="#compared-to-fat-action-creators">fat action creators</a>, <a href="#compared-to-redux-thunk">thunks</a>, <a href="#compared-to-redux-observable">redux-observable</a>, <a href="#compared-to-redux-saga">redux-saga</a>, <a href="#compared-to-custom-redux-middleware">custom middleware</a></li>
<li><a href="#implementing-sampal-pattern">SAM/PAL pattern</a></li>
<li><a href="#other">Other</a> - todo, inspiration, license</li>
</ul>
<h2 id="Goals"><a href="#Goals" class="headerlink" title="Goals"></a>Goals</h2><ul>
<li>organize business logic keeping action creators and reducers clean<ul>
<li>action creators are light and just post action objects</li>
<li>reducers just focus on updating state</li>
<li>intercept and perform validations, verifications, authentication</li>
<li>intercept and transform actions</li>
<li>perform async processing, orchestration, dispatch actions</li>
</ul>
</li>
<li>wrap your core business logic code with declarative behavior<ul>
<li>filtered - apply to one or many action types or even all actions</li>
<li>cancellable - async work can be cancelled</li>
<li>limiting (like taking only the latest, throttling, and debouncing)</li>
</ul>
</li>
<li>features to support business logic and large apps<ul>
<li>have access to full state to make decisions</li>
<li>easily composable to support large applications</li>
<li>inject dependencies into your logic, so you have everything needed in your logic code</li>
<li>dynamic loading of logic for splitting bundles in your app</li>
<li>your core logic code stays focussed and simple, don’t use generators or observables unless you want to.</li>
<li>create subscriptions - streaming updates</li>
<li>easy testing - since your code is just a function it’s easy to isolate and test</li>
</ul>
</li>
</ul>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install rxjs --save</div><div class="line">npm install redux-logic --save</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// in configureStore.js</span></div><div class="line"><span class="keyword">import</span> &#123; createLogic, createLogicMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux-logic'</span>;</div><div class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'./rootReducer'</span>;</div><div class="line"><span class="keyword">import</span> arrLogic <span class="keyword">from</span> <span class="string">'./logic'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> deps = &#123; <span class="comment">// optional injected dependencies for logic</span></div><div class="line">  <span class="comment">// anything you need to have available in your logic</span></div><div class="line">  A_SECRET_KEY: <span class="string">'dsfjsdkfjsdlfjls'</span>,</div><div class="line">  <span class="attr">firebase</span>: firebaseInstance</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> logicMiddleware = createLogicMiddleware(arrLogic, deps);</div><div class="line"></div><div class="line"><span class="keyword">const</span> middleware = applyMiddleware(</div><div class="line">  logicMiddleware</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">const</span> enhancer = middleware; <span class="comment">// could compose in dev tools too</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">configureStore</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> store = createStore(rootReducer, enhancer);</div><div class="line">  <span class="keyword">return</span> store;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// in logic.js - combines logic from across many files, just</span></div><div class="line"><span class="comment">// a simple array of logic to be used for this app</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</div><div class="line"> ...todoLogic,</div><div class="line"> ...pollsLogic</div><div class="line">];</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// in polls/logic.js</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> validationLogic = createLogic(&#123;</div><div class="line">  <span class="attr">type</span>: ADD_USER,</div><div class="line">  validate(&#123; getState, action &#125;, allow, reject) &#123;</div><div class="line">    <span class="keyword">const</span> user = action.payload;</div><div class="line">    <span class="keyword">if</span> (!getState().users[user.id]) &#123; <span class="comment">// can also hit server to check</span></div><div class="line">      allow(action);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      reject(&#123; <span class="attr">type</span>: USER_EXISTS_ERROR, <span class="attr">payload</span>: user, <span class="attr">error</span>: <span class="literal">true</span> &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> addUniqueId = createLogic(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'*'</span>,</div><div class="line">  transform(&#123; getState, action &#125;, next) &#123;</div><div class="line">    <span class="comment">// add unique tid to action.meta of every action</span></div><div class="line">    <span class="keyword">const</span> existingMeta = action.meta || &#123;&#125;;</div><div class="line">    <span class="keyword">const</span> meta = &#123;</div><div class="line">      ...existingMeta,</div><div class="line">      <span class="attr">tid</span>: shortid.generate()</div><div class="line">    &#125;,</div><div class="line">    next(&#123;</div><div class="line">      ...action,</div><div class="line">      meta</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> fetchPollsLogic = createLogic(&#123;</div><div class="line">  <span class="attr">type</span>: FETCH_POLLS, <span class="comment">// only apply this logic to this type</span></div><div class="line">  cancelType: CANCEL_FETCH_POLLS, <span class="comment">// cancel on this type</span></div><div class="line">  latest: <span class="literal">true</span>, <span class="comment">// only take latest</span></div><div class="line">  process(&#123; getState, action &#125;, dispatch, done) &#123;</div><div class="line">    axios.get(<span class="string">'https://survey.codewinds.com/polls'</span>)</div><div class="line">      .then(<span class="function"><span class="params">resp</span> =&gt;</span> resp.data.polls)</div><div class="line">      .then(<span class="function"><span class="params">polls</span> =&gt;</span> dispatch(&#123; <span class="attr">type</span>: FETCH_POLLS_SUCCESS,</div><div class="line">                                <span class="attr">payload</span>: polls &#125;))</div><div class="line">      .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">             <span class="built_in">console</span>.error(err); <span class="comment">// log since could be render err</span></div><div class="line">             dispatch(&#123; <span class="attr">type</span>: FETCH_POLLS_FAILED, <span class="attr">payload</span>: err,</div><div class="line">                        <span class="attr">error</span>: <span class="literal">true</span> &#125;)</div><div class="line">      &#125;)</div><div class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> done());</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// pollsLogic</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</div><div class="line">  validationLogic,</div><div class="line">  addUniqueId,</div><div class="line">  fetchPollsLogic</div><div class="line">];</div></pre></td></tr></table></figure>
<h3 id="processOptions-introduced-for-redux-logic-0-8-2-allowing-for-even-more-streamlined-code"><a href="#processOptions-introduced-for-redux-logic-0-8-2-allowing-for-even-more-streamlined-code" class="headerlink" title="processOptions introduced for redux-logic@0.8.2 allowing for even more streamlined code"></a>processOptions introduced for redux-logic@0.8.2 allowing for even more streamlined code</h3><p><code>processOptions</code> has these new properties which affect the process hook behavior:</p>
<ul>
<li><p><code>dispatchReturn</code> - the returned value of the process function will be dispatched or if it is a promise or observable then the resolve, reject, or observable values will be dispatched applying any successType or failType logic if defined. Default is determined by arity of process fn, <code>true</code> if dispatch not provided, <code>false</code> otherwise. <a href="https://github.com/jeffbski/redux-logic/blob/master/docs/api.md#dispatch---multi-dispatching-and-process-variable-signature" target="_blank" rel="external">Details</a></p>
</li>
<li><p><code>successType</code> - dispatch this action type using contents of dispatch as the payload (also would work with with promise or observable). You may alternatively provide an action creator function to use instead and it will receive the value as only parameter. Default: <code>undefined</code>.</p>
<ul>
<li><p>if successType is a string action type</p>
<ul>
<li>create action using successType and provide value as payload. ex: with <code>successType:&#39;FOO&#39;</code>, result would be <code>{ type: &#39;FOO&#39;, payload: value }</code></li>
</ul>
</li>
<li><p>if successType is an action creator fn receiving the value as only parameter</p>
<ul>
<li>use the return value from the action creator fn for dispatching ex: <code>successType: x =&gt; ({ type: &#39;FOO&#39;, payload: x })</code></li>
<li>if the action creator fn returns a falsey value like <code>undefined</code> then nothing will be dispatched. This allows your action creator to control whether something is actually dispatched based on the value provided to it.</li>
</ul>
</li>
</ul>
</li>
<li><p><code>failType</code> - dispatch this action type using contents of error as the payload, sets error: true (would also work for rejects of promises or error from observable). You may alternatively provide an action creator function to use instead which will receive the error as the only parameter. Default: <code>undefined</code>.</p>
<ul>
<li><p>if failType is a string action type</p>
<ul>
<li>create action using failType, provide value as the payload, and set error to true. ex: with <code>failType:&#39;BAR&#39;</code>, result would be <code>{ type: &#39;BAR&#39;, payload: errorValue, error: true }</code></li>
</ul>
</li>
<li><p>if failType is an action creator function receiving the error value as its only parameter</p>
<ul>
<li>use the return value from the action creator fn for dispatching. ex: <code>failType: x =&gt; ({ type: &#39;BAR&#39;, payload: x, error: true })</code></li>
<li>if the action creator fn returns a falsey value like <code>undefined</code> then nothing will be dispatched. This allows your action creator to control whether something is actually dispatched based on teh value provided to it.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The successType and failType would enable clean code, where you can simply return a promise or observable that resolves to the payload and rejects on error. The resulting code doesn’t have to deal with dispatch and actions directly.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fetchPollsLogic = createLogic(&#123;</div><div class="line"></div><div class="line">  <span class="comment">// declarative built-in functionality wraps your code</span></div><div class="line">  type: FETCH_POLLS, <span class="comment">// only apply this logic to this type</span></div><div class="line">  cancelType: CANCEL_FETCH_POLLS, <span class="comment">// cancel on this type</span></div><div class="line">  latest: <span class="literal">true</span>, <span class="comment">// only take latest</span></div><div class="line"></div><div class="line">  processOptions: &#123;</div><div class="line">    <span class="comment">// optional since the default is true when dispatch is omitted from</span></div><div class="line">    <span class="comment">// the process fn signature</span></div><div class="line">    dispatchReturn: <span class="literal">true</span>, <span class="comment">// use returned/resolved value(s) for dispatching</span></div><div class="line">    <span class="comment">// provide action types or action creator functions to be used</span></div><div class="line">    <span class="comment">// with the resolved/rejected values from promise/observable returned</span></div><div class="line">    successType: FETCH_POLLS_SUCCESS, <span class="comment">// dispatch this success act type</span></div><div class="line">    failType: FETCH_POLLS_FAILED, <span class="comment">// dispatch this failed action type</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// Omitting dispatch from the signature below makes the default for</span></div><div class="line">  <span class="comment">// dispatchReturn true allowing you to simply return obj, promise, obs</span></div><div class="line">  <span class="comment">// not needing to use dispatch directly</span></div><div class="line">  process(&#123; getState, action &#125;) &#123;</div><div class="line">    <span class="keyword">return</span> axios.get(<span class="string">'https://survey.codewinds.com/polls'</span>)</div><div class="line">      .then(<span class="function"><span class="params">resp</span> =&gt;</span> resp.data.polls);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>This is pretty nice leaving us with mainly our business logic code that could be easily extracted and called from here.</p>
<h2 id="Full-API"><a href="#Full-API" class="headerlink" title="Full API"></a>Full API</h2><p>See the <a href="./docs/api.md">docs for the full api</a></p>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><h3 id="JSFiddle-live-examples"><a href="#JSFiddle-live-examples" class="headerlink" title="JSFiddle live examples"></a>JSFiddle live examples</h3><ul>
<li><a href="https://jsfiddle.net/jeffbski/78vpf92k/" target="_blank" rel="external">search async axios fetch</a> - live search using debounce and take latest functionality with axios fetch</li>
<li><a href="https://jsfiddle.net/jeffbski/uLh2add5/" target="_blank" rel="external">search rxjs ajax fetch</a> - live search using debounce and take latest functionality with rxjs ajax fetch</li>
<li><a href="https://jsfiddle.net/jeffbski/rLz44jk9/" target="_blank" rel="external">search rxjs ajax fetch - using processOptions</a> - live search using debounce and take latest with rxjs ajax fetch using processOptions to streamline the code</li>
<li><a href="https://jsfiddle.net/jeffbski/954g5n7h/" target="_blank" rel="external">async axios fetch - single page</a> - displayed using React</li>
<li><a href="https://jsfiddle.net/jeffbski/0fu407na/" target="_blank" rel="external">async rxjs-ajax fetch</a> - async fetching using RxJS ajax which supports XHR abort for cancels</li>
<li><a href="https://jsfiddle.net/jeffbski/yzy8w4ve/" target="_blank" rel="external">async axios fetch - single page redux only</a> - just the redux and redux-logic code</li>
<li><a href="https://jsfiddle.net/jeffbski/oL6jmp52/" target="_blank" rel="external">async axios fetch - using processOptions</a> - using processOptions to streamline your code further with React</li>
<li><a href="https://jsfiddle.net/jeffbski/d4p6oo0d/" target="_blank" rel="external">async rxjs-ajax fetch - using processOptions</a> - async fetch using RxJS ajax (supporting XHR abort on cancel) and processOptions for clean code.</li>
<li><a href="https://jsfiddle.net/jeffbski/rfc7oz9p/" target="_blank" rel="external">async await - react</a> - using ES7 async functions (async/await) displaying with React</li>
<li><a href="https://jsfiddle.net/jeffbski/h485f6h5/" target="_blank" rel="external">async await - redux only</a> - using ES7 async functions (async/await) - just redux and redux-logic code</li>
<li><a href="https://jsfiddle.net/jeffbski/0rodyekn/" target="_blank" rel="external">async await - react processOptions</a> - using ES7 async functions (async/await) with processOptions, displayed with React</li>
</ul>
<h3 id="Full-examples"><a href="#Full-examples" class="headerlink" title="Full examples"></a>Full examples</h3><ul>
<li><a href="./examples/search-async-fetch">search-async-fetch</a> - search async fetch example using axios uses debouncing and take latest features</li>
<li><a href="./examples/async-fetch-vanilla">async-fetch-vanilla</a> - async fetch example using axios</li>
<li><a href="./examples/async-rxjs-ajax-fetch">async-rxjs-ajax-fetch</a> - async fetch example using RxJS ajax (supporting XHR abort on cancel) and redux-actions</li>
<li><a href="./examples/async-fetch-proc-options">async-fetch-proc-options</a> - async fetch example using axios and the new processOptions feature</li>
<li><a href="./examples/async-rxjs-ajax-proc-options">async-rxjs-ajax-proc-options</a> - async RxJS ajax (with XHR abort on cancel) fetch example using axios and the new processOptions feature</li>
<li><a href="./examples/async-await">async-await - ES7 async functions</a> - async fetch example using axios and ES7 async functions (async/await)</li>
<li><a href="./examples/async-await-proc-options">async-await - ES7 async functions with processOptions</a> - async fetch example using axios and ES7 async functions (async/await) and using the new processOptions feature</li>
<li><a href="./examples/countdown">countdown</a> - a countdown timer implemented with setInterval</li>
<li><a href="./examples/countdown-obs">countdown-obs</a> - a countdown timer implemented with Rx.Observable.interval</li>
<li><a href="./examples/form-validation">form-validation</a> - form validation and async post to server using axios, displays updated user list</li>
<li><a href="./examples/notification">notification</a> - notification message example showing at most N messages for X amount of time, rotating queued messages in as others expire</li>
<li><a href="./examples/single-file">search-single-file</a> - search async fetch example with all code in a single file and displayed with React</li>
<li><a href="./examples/single-file-redux">single-file-redux</a> - async fetch example with all code in a single file and appended to the container div. Only redux and redux-logic code.</li>
</ul>
<h2 id="Comparison-summaries"><a href="#Comparison-summaries" class="headerlink" title="Comparison summaries"></a>Comparison summaries</h2><p>Following are just short summaries to compare redux-logic to other approaches.</p>
<p>For a more detailed comparison with examples, see by article in docs, <a href="./docs/where-business-logic.md">Where do I put my business logic in a React-Redux application?</a>.</p>
<h3 id="Compared-to-fat-action-creators"><a href="#Compared-to-fat-action-creators" class="headerlink" title="Compared to fat action creators"></a>Compared to fat action creators</h3><ul>
<li>no easy way to cancel or do limiting like take latest with fat action creators</li>
<li>action creators would not have access to the full global state so you might have to pass down lots of extra data that isn’t needed for rendering. Every time business logic changes might require new data to be made available</li>
<li>no global interception using just action creators - applying logic or transformations across all or many actions</li>
<li>Testing components and fat action creators may require running the code (possibly mocked API calls).</li>
</ul>
<h3 id="Compared-to-redux-thunk"><a href="#Compared-to-redux-thunk" class="headerlink" title="Compared to redux-thunk"></a>Compared to redux-thunk</h3><ul>
<li>With thunks business logic is spread over action creators</li>
<li>With thunks there is not an easy way to cancel async work nor to perform (take latest) limiting</li>
<li>no global interception with thunks - applying logic or transformations across all or many actions</li>
<li>Testing components and thunked action creators may require running the code (possibly mocked API calls). When you have a thunk (function or promise) you don’t know what it does unless you execute it.</li>
</ul>
<h3 id="Compared-to-redux-observable"><a href="#Compared-to-redux-observable" class="headerlink" title="Compared to redux-observable"></a>Compared to redux-observable</h3><ul>
<li>redux-logic doesn’t require the developer to use rxjs observables. It uses observables under the covers to provide cancellation, throttling, etc. You simply configure these parameters to get this functionality. You can still use rxjs in your code if you want, but not a requirement.</li>
<li>redux-logic hooks in before the reducer stack like middleware allowing validation, verification, auth, tranformations. Allow, reject, tranform actions before they hit your reducers to update your state as well as accessing state after reducers have run. redux-observable hooks in after the reducers have updated state so they have no opportuntity to prevent the updates.</li>
</ul>
<h3 id="Compared-to-redux-saga"><a href="#Compared-to-redux-saga" class="headerlink" title="Compared to redux-saga"></a>Compared to redux-saga</h3><ul>
<li>redux-logic doesn’t require you to code with generators</li>
<li>redux-saga relies on pulling data (usually in a never ending loop) while redux-logic and logic are reactive, responding to data as it is available</li>
<li>redux-saga runs after reducers have been run, redux-logic can intercept and allow/reject/modify before reducers run also as well as after</li>
</ul>
<h3 id="Compared-to-custom-redux-middleware"><a href="#Compared-to-custom-redux-middleware" class="headerlink" title="Compared to custom redux middleware"></a>Compared to custom redux middleware</h3><ul>
<li>Both are fully featured to do any type of business logic (validations, tranformations, processing)</li>
<li>redux-logic already has built-in capabilities for some of the hard stuff like cancellation, limiting, dynamic loading of code. With custom middleware you have to implement all functionality.</li>
<li>No safety net, if things break it could stop all of your future actions</li>
<li>Testing requires some mocking or setup</li>
</ul>
<h3 id="Implementing-SAM-PAL-Pattern"><a href="#Implementing-SAM-PAL-Pattern" class="headerlink" title="Implementing SAM/PAL Pattern"></a>Implementing SAM/PAL Pattern</h3><p>The <a href="http://sam.js.org" target="_blank" rel="external">SAM (State-Action-Model) pattern</a> is a pattern introduced by Jean-Jacques Dubray. Also known as the PAL (proposer, acceptor, learner) pattern based on Paxos terminology.</p>
<p>A few of the challenging parts of implementing this with a React-Redux application are:</p>
<ol>
<li>where to perform the <code>accept</code> (interception) of the proposed action performing validation, verification, authentication against the current model state. Based on the current state, it might be appropriate to modify the action, dispatch a different action, or simply suppress the action.</li>
<li>how to trigger actions based on the state after the model has finished updating, referred to as the <code>NAP</code> (next-action-predicate).</li>
</ol>
<p>Custom Redux middleware can be introduced to perform this logic, but you’ll be implementing most everything on your own.</p>
<p>With <code>redux-logic</code> you can implement the SAM / PAL pattern easily in your React/Redux apps.</p>
<p>Namely you can separate out your business logic from your action creators and reducers keeping them thin. redux-logic provides a nice place to accept, reject, and transform actions before your reducers are run. You have access to the full state to make decisions and you can trigger actions based on the updated state as well.</p>
<p>Solving those SAM challenges previously identified using redux-logic:</p>
<ol>
<li>perform acceptance in redux-logic <code>validate</code> hooks, you have access to the full state (model) of the app to make decisions. You can perform synchronous or asynchronous logic to determine whether to accept the action and you may augment, modify, substitute actions, or suppress as desired.</li>
<li>Perform NAP processing in redux-logic <code>process</code> hooks. The process hook runs after the actions have been sent down to the reducers so you have access to the full model (state) after the updates where you can make decisions and dispatch additional actions based on the updated state.</li>
</ol>
<p><a name="other"></a></p>
<h2 id="Inspiration"><a href="#Inspiration" class="headerlink" title="Inspiration"></a>Inspiration</h2><p>redux-logic was inspired from these projects:</p>
<ul>
<li><a href="https://redux-observable.js.org" target="_blank" rel="external">redux-observable epics</a></li>
<li><a href="http://yelouafi.github.io/redux-saga/" target="_blank" rel="external">redux-saga</a></li>
<li><a href="http://redux.js.org/docs/advanced/Middleware.html" target="_blank" rel="external">redux middleware</a></li>
</ul>
<h2 id="Minimized-gzipped-size-with-all-deps"><a href="#Minimized-gzipped-size-with-all-deps" class="headerlink" title="Minimized/gzipped size with all deps"></a>Minimized/gzipped size with all deps</h2><p>(redux-logic only includes the modules of RxJS 5 that it uses)<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">redux-logic<span class="selector-class">.min</span><span class="selector-class">.js</span><span class="selector-class">.gz</span> <span class="number">11</span>KB</div></pre></td></tr></table></figure></p>
<p>Note: If you are already including RxJS 5 into your project then the resulting delta will be much smaller.</p>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul>
<li>add typescript support</li>
<li>more docs</li>
<li>more examples</li>
<li>evaulate additional features as outlined above</li>
</ul>
<h2 id="Get-involved"><a href="#Get-involved" class="headerlink" title="Get involved"></a>Get involved</h2><p>If you have input or ideas or would like to get involved, you may:</p>
<ul>
<li>contact me via twitter @jeffbski  - <a href="http://twitter.com/jeffbski" target="_blank" rel="external">http://twitter.com/jeffbski</a></li>
<li>open an issue on github to begin a discussion - <a href="https://github.com/jeffbski/redux-logic/issues" target="_blank" rel="external">https://github.com/jeffbski/redux-logic/issues</a></li>
<li>fork the repo and send a pull request (ideally with tests) - <a href="https://github.com/jeffbski/redux-logic" target="_blank" rel="external">https://github.com/jeffbski/redux-logic</a></li>
<li>See the <a href="http://github.com/jeffbski/redux-logic/raw/master/CONTRIBUTING.md" target="_blank" rel="external">contributing guide</a></li>
</ul>
<h2 id="Supporters"><a href="#Supporters" class="headerlink" title="Supporters"></a>Supporters</h2><p>This project is supported by <a href="https://codewinds.com/" target="_blank" rel="external">CodeWinds Training</a></p>
<p><a name="license"></a></p>
<h2 id="License-MIT"><a href="#License-MIT" class="headerlink" title="License - MIT"></a>License - MIT</h2><ul>
<li><a href="http://github.com/jeffbski/redux-logic/raw/master/LICENSE.md" target="_blank" rel="external">MIT license</a></li>
</ul>

            </article>
            
                <div class="share">
                    <!--开启分享-->
<div class="share-component" data-disabled="google,twitter,facebook" data-description=""></div>

<script src="/js/share.min.js"></script>

                </div>    
            

            
            
                
                    
<div class="comments">
	<div class="ds-thread" data-thread-key="redux-logic" data-title="redux-logic" data-url="http://yoursite.com/2017/03/08/redux-logic/"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"null"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0]
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
	</script>
</div>

                
            

        </div>
        <div class="column one-fourth">
            
                
                


<h3>Post Directory</h3>

<div id="post-directory-module">
	<section class="post-directory">
		<p><strong class="toc-title">文章目录</strong></p>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#redux-logic"><span class="toc-text">redux-logic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tl-dr"><span class="toc-text">tl;dr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Example"><span class="toc-text">Quick Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Table-of-contents"><span class="toc-text">Table of contents</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Goals"><span class="toc-text">Goals</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usage"><span class="toc-text">Usage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#processOptions-introduced-for-redux-logic-0-8-2-allowing-for-even-more-streamlined-code"><span class="toc-text">processOptions introduced for redux-logic@0.8.2 allowing for even more streamlined code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Full-API"><span class="toc-text">Full API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Examples"><span class="toc-text">Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSFiddle-live-examples"><span class="toc-text">JSFiddle live examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Full-examples"><span class="toc-text">Full examples</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Comparison-summaries"><span class="toc-text">Comparison summaries</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Compared-to-fat-action-creators"><span class="toc-text">Compared to fat action creators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compared-to-redux-thunk"><span class="toc-text">Compared to redux-thunk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compared-to-redux-observable"><span class="toc-text">Compared to redux-observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compared-to-redux-saga"><span class="toc-text">Compared to redux-saga</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compared-to-custom-redux-middleware"><span class="toc-text">Compared to custom redux middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementing-SAM-PAL-Pattern"><span class="toc-text">Implementing SAM/PAL Pattern</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inspiration"><span class="toc-text">Inspiration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Minimized-gzipped-size-with-all-deps"><span class="toc-text">Minimized/gzipped size with all deps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO"><span class="toc-text">TODO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Get-involved"><span class="toc-text">Get involved</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Supporters"><span class="toc-text">Supporters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#License-MIT"><span class="toc-text">License - MIT</span></a></li></ol></li></ol>
	</section>
</div>
            
        </div>
    </div>
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/category/" target="true" title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="开源项目">开源项目</a>
                  </li>
            
                  
                  <li>
                    <a href="/message/"  title="留言板">留言板</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		
			<script src="/js/toc.js"></script>
		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>