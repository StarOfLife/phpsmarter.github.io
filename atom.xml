<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>phpsmarter</title>
  <subtitle>A beginner of React-native</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://phpsmarter.github.com/"/>
  <updated>2017-04-16T06:26:00.000Z</updated>
  <id>https://phpsmarter.github.com/</id>
  
  <author>
    <name>phpsmarter</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç¿»è¯‘|A Dummyâ€™s Guide to Redux and Thunk in React</title>
    <link href="https://phpsmarter.github.com/2017/04/16/%E7%BF%BB%E8%AF%91-A-Dummy%E2%80%99s-Guide-to-Redux-and-Thunk-in-React/"/>
    <id>https://phpsmarter.github.com/2017/04/16/ç¿»è¯‘-A-Dummyâ€™s-Guide-to-Redux-and-Thunk-in-React/</id>
    <published>2017-04-15T21:36:07.000Z</published>
    <updated>2017-04-16T06:26:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹"><a href="#Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹" class="headerlink" title="Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹"></a>Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹</h1><blockquote>
<p><a href="https://medium.com/@stowball/a-dummys-guide-to-redux-and-thunk-in-react-d8904a7005d3" target="_blank" rel="external">åŸæ–‡å‚è§</a><br>  <a href="https://github.com/stowball/dummys-guide-to-redux-and-thunk-react" target="_blank" rel="external">Github repo</a><br>  å¼ºçƒˆæ¨èè¿™ç¯‡æ–‡ç« .</p>
</blockquote>
<p>  å¦‚æœä½ å’Œæˆ‘ä¸€æ ·,è¯»äº†Reduxçš„æ–‡æ¡£,çœ‹äº†Dançš„å½•åƒ,Wesçš„è¯¾ç¨‹,ä»ç„¶ä¸èƒ½æŠ“ä½æ€ä¹ˆä½¿ç”¨Reduxçš„æ ¸å¿ƒ,å¸Œæœ›è¿™ä¸ªå‚»ç“œæ•™ç¨‹èƒ½å¤Ÿå¸®åˆ°ä½ .<br>  åœ¨çœŸæ­£å®æ–½ä¹‹å‰,æˆ‘åšäº†ä¸€äº›å°è¯•,æ‰€ä»¥æˆ‘å†³å®šå†™ä¸€ç‚¹ä»å·²ç»å­˜åœ¨çš„ä½¿ç”¨fetch JSONæ•°æ®çš„appä¸€æ­¥æ­¥è½¬å˜ä¸ºä½¿ç”¨Reduxå’ŒRedux Thunkçš„app.å¦‚æœä½ ä¸çŸ¥é“Thunkæ˜¯ä»€ä¹ˆ,ä¹Ÿä¸è¦æ‹…å¿ƒ,æˆ‘ä»¬ä¼šåœ¨â€Redux ä¹‹è·¯â€éƒ¨åˆ†æ¥ä½¿ç”¨å®ƒæ‰§è¡Œå‡½æ•°çš„å¼‚æ­¥è°ƒç”¨.<br>  è¿™ä¸ªæ•™ç¨‹éœ€è¦ä½ å¯¹Reactå’ŒES6/2015æœ‰åŸºæœ¬çš„æŒæ¡.</p>
<h2 id="éReduxæ–¹æ³•"><a href="#éReduxæ–¹æ³•" class="headerlink" title="éReduxæ–¹æ³•"></a>éReduxæ–¹æ³•</h2><p>  åœ¨<code>components/ItemList.js</code>ä¸­åˆ›å»ºä¸€ä¸ªReactç»„ä»¶,ç”¨äºfetchå’Œæ˜¾ç¤ºitemsåˆ—è¡¨.</p>
<h2 id="ç½—åˆ—ä¸€ä¸‹åŸºç¡€ç»„ä»¶"><a href="#ç½—åˆ—ä¸€ä¸‹åŸºç¡€ç»„ä»¶" class="headerlink" title="ç½—åˆ—ä¸€ä¸‹åŸºç¡€ç»„ä»¶"></a>ç½—åˆ—ä¸€ä¸‹åŸºç¡€ç»„ä»¶</h2><p>  é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨åŒ…å«å„ç§itemsçš„stateé…ç½®ä¸€ä¸ªé™æ€çš„ç»„ä»¶,2 ä¸ªboolean stateåˆ†åˆ«ç”¨äºæ ¹æ®loadingå’Œerroræ¥æ¸²æŸ“å‡ºå„è‡ªçš„å•ç‹¬æ˜¾ç¤ºç»„ä»¶.</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ItemList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            <span class="attr">items</span>: [<span class="comment">//itemsåœ¨åˆ—è¡¨ä¸­ç°å®çš„å†…å®¹</span></div><div class="line">                &#123;</div><div class="line">                    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">                    <span class="attr">label</span>: <span class="string">'List item 1'</span></div><div class="line">                &#125;,</div><div class="line">                &#123;</div><div class="line">                    <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">                    <span class="attr">label</span>: <span class="string">'List item 2'</span></div><div class="line">                &#125;,</div><div class="line">                &#123;</div><div class="line">                    <span class="attr">id</span>: <span class="number">3</span>,</div><div class="line">                    <span class="attr">label</span>: <span class="string">'List item 3'</span></div><div class="line">                &#125;,</div><div class="line">                &#123;</div><div class="line">                    <span class="attr">id</span>: <span class="number">4</span>,</div><div class="line">                    <span class="attr">label</span>: <span class="string">'List item 4'</span></div><div class="line">                &#125;</div><div class="line">            ],</div><div class="line">            <span class="attr">hasErrored</span>: <span class="literal">false</span>, <span class="comment">//ç½‘ç»œè¯·æ±‚é”™è¯¯çš„çŠ¶æ€</span></div><div class="line">            isLoading: <span class="literal">false</span>   <span class="comment">//ç½‘ç»œè¯·æ±‚ä¸­çš„çŠ¶æ€</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasErrored) &#123;<span class="comment">//æ ¹æ®Erroredçš„çŠ¶æ€å†³</span></div><div class="line">        <span class="comment">//å®šæ˜¯å¦åŠ è½½è¿™ä¸ªç»„ä»¶,ç½‘ç»œè¯·æ±‚é”™è¯¯æ—¶,false=&gt;true</span></div><div class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Sorry! There was an error loading the items<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.state.isLoading) &#123;</div><div class="line">        <span class="comment">//ç½‘ç»œè¯·æ±‚ä¸­çš„ç»„ä»¶,å‘å‡ºè¯·æ±‚æ—¶,false=&gt;true</span></div><div class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Loadingâ€¦<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></div><div class="line">                &#123;this.state.items.map((item) =&gt; (</div><div class="line">                    <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></div><div class="line">                        &#123;item.label&#125;</div><div class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">                ))&#125;</div><div class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> ItemList;</div></pre></td></tr></table></figure>
<p>  å¯èƒ½çœ‹èµ·æ¥è¿˜ä¸æ˜¯ç‰¹åˆ«èƒ½è¯´æ˜é—®é¢˜,ä½†æ˜¯å·²ç»æ˜¯ä¸€ä¸ªå¥½çš„å¼€ç«¯äº†.<br>  æ¸²æŸ“çš„æ—¶å€™,ç»„ä»¶è¾“å‡ºå››ä¸ªitemsåˆ—è¡¨,ä½†æ˜¯å¦‚æœä½ æŠŠ<code>isLoading</code>å’Œ<code>hasError</code>çš„stateç”±falseæ”¹ä¸ºfalseçš„æ—¶å€™,å¯¹åº”çš„<code>&lt;p&gt;&lt;/p&gt;</code>å°±ä¼šæ˜¾ç¤ºå‡ºæ¥.(æ³¨æ„æ¯ä¸ªç»„ä»¶éƒ½æ˜¯returnå‡ºæ¥çš„,æ¯æ¬¡åªæ˜¾ç¤ºä¸€ä¸ª).</p>
<h2 id="æ”¹ä¸ºåŠ¨æ€å€¼"><a href="#æ”¹ä¸ºåŠ¨æ€å€¼" class="headerlink" title="æ”¹ä¸ºåŠ¨æ€å€¼"></a>æ”¹ä¸ºåŠ¨æ€å€¼</h2><p>  ç›´æ¥ç¼–ç itemså¯¹äºç»„ä»¶æ¥è¯´ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨,æ‰€ä»¥æœ€å¥½ä»JSON APIæ¥fetch <code>items</code>æ•°æ®,å¦‚æœè¿™æ ·åšçš„è¯,æˆ‘ä»¬å°±å¯ä»¥æŠŠ<code>isLoading</code>å’Œ<code>hasError</code>æ”¹ä¸ºåˆé€‚çš„çŠ¶æ€.<br>  å“åº”å€¼å’Œæˆ‘ä»¬ç›´æ¥ç¼–ç æ˜¯ä¸€æ ·,ä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ä¸­,ä½ å¯èƒ½ä¼šæ‹‰å›ä¸€ä¸ªå›¾ä¹¦ç•…é”€æ¦œçš„åˆ—è¡¨,æœ€æ–°çš„blogå¸–å­æˆ–è€…å…¶ä»–appä¸­éœ€è¦çš„å†…å®¹.<br>  ä¸ºäº†fetch items,æˆ‘ä»¬å°†ä½¿ç”¨åˆé€‚çš„Fetch API.Fetchä½¿å¾—æ‰§è¡Œè¯·æ±‚æ¯”ä¼ ç»Ÿçš„XMLHttpRequestæ›´å®¹æ˜“,å¹¶ä¸”è¿”å›çš„æ˜¯å“åº”å€¼çš„promiseå¯¹è±¡(è¿™ä¸€ç‚¹å¯¹äºThunkå¾ˆé‡è¦).Fetchå¹¶ä¸æ˜¯åœ¨æ‰€æœ‰çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥ä½¿ç”¨,æ‰€ä»¥ä½ éœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¾èµ–é¡¹.</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> whatwg-<span class="keyword">fetch</span> <span class="comment">--save</span></div></pre></td></tr></table></figure>
<p>  è½¬å˜å®é™…ä¸Šç›¸å½“ç®€å•.</p>
<ul>
<li>é¦–å…ˆæŠŠ<code>items</code>çš„åˆå§‹åŒ–stateè®¾ç½®ä¸ºç©ºæ•°ç»„</li>
<li><p>ç°åœ¨æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–¹æ³•fetchæ•°æ®,åŒæ—¶è¿˜è¦è®¾å®šloadingå’Œerrorçš„çŠ¶æ€.</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">  fetchData(url) &#123;<span class="regexp">//</span>fetchçš„åŒ…è£…æ–¹æ³•</div><div class="line">    <span class="regexp">//</span>è¿›å…¥å‡½æ•°é¦–å…ˆè®¾å®šisLoading state <span class="literal">false</span>=&gt;<span class="literal">true</span></div><div class="line">    <span class="keyword">this</span>.setState(&#123; isLoading: <span class="literal">true</span> &#125;);</div><div class="line">    fetch(url)</div><div class="line">        .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> &#123;<span class="regexp">//</span>è¿”å›promiseç‹¬äº«</div><div class="line">            <span class="keyword">if</span> (!response.ok) &#123;</div><div class="line">                <span class="keyword">throw</span> Error(response.statusText);</div><div class="line">            &#125;</div><div class="line">            <span class="regexp">//</span>ä¸ç®¡è¿”å›çš„æ•°æ®æ˜¯ä»€ä¹ˆ,åªè¦è¿”å›æ•°æ®</div><div class="line">            <span class="regexp">//</span>å°±ä¿®æ”¹isLoading state <span class="literal">true</span>=&gt;<span class="literal">false</span></div><div class="line">            <span class="keyword">this</span>.setState(&#123; isLoading: <span class="literal">false</span> &#125;);</div><div class="line">            <span class="keyword">return</span> response;</div><div class="line">        &#125;)</div><div class="line">        .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> response.json())</div><div class="line">        .<span class="keyword">then</span>(<span class="function"><span class="params">(items)</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123; items &#125;)) </div><div class="line">        <span class="regexp">//</span> ES6 property value shorthand <span class="keyword">for</span> &#123; items: items &#125;</div><div class="line">        .<span class="keyword">catch</span>(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123; hasErrored: <span class="literal">true</span> &#125;));<span class="regexp">//</span>è¿”å›æ•°æ®çš„è§£æä¸ºjson,å¦‚æœæ•è·åˆ°é”™è¯¯å°±hasErrored:</div><div class="line">        <span class="regexp">//</span> <span class="literal">false</span>=&gt;<span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å‡½æ•°å†™å®Œä»¥å,åœ¨ç»„ä»¶åŠ è½½çš„æ—¶å€™å°±è°ƒç”¨å‡½æ•°</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  componentDidMount() &#123;</div><div class="line">  <span class="keyword">this</span>.fetchData(<span class="string">'http://      5826ed963900d612000138bd.mockapi.io/items'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p> å®Œæˆä»¥å,ä»£ç å¦‚ä¸‹<br> <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">ItemList</span> <span class="keyword">extends</span> <span class="title">Component</span> &#123;</span></div><div class="line">    constructor() &#123;</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            items: [],</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">    fetchData(url) &#123;</div><div class="line">        <span class="keyword">this</span>.setState(&#123; isLoading: <span class="literal">true</span> &#125;);</div><div class="line">        fetch(url)</div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> &#123;</div><div class="line">                <span class="keyword">if</span> (!response.ok) &#123;</div><div class="line">                    <span class="keyword">throw</span> Error(response.statusText);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">this</span>.setState(&#123; isLoading: <span class="literal">false</span> &#125;);</div><div class="line">                <span class="keyword">return</span> response;</div><div class="line">            &#125;)</div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> response.json())</div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(items)</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123; items &#125;))</div><div class="line">            .<span class="keyword">catch</span>(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123; hasErrored: <span class="literal">true</span> &#125;));</div><div class="line">    &#125;</div><div class="line">    componentDidMount() &#123;</div><div class="line">        <span class="keyword">this</span>.fetchData(<span class="string">'http://5826ed963900d612000138bd.mockapi.io/items'</span>);</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> å·®ä¸å¤šäº†,ç»„ä»¶ç°åœ¨ä»REST API  fetch <code>items</code>æ•°æ®,åœ¨4ä¸ªitemsåˆ°è¾¾ä¹‹å‰,ä½ å¸Œæœ›çœ‹â€Loadingâ€¦â€å‡ºç°æç¤º.å¦‚æœURLä¸èƒ½è¿”å›æ•°æ®,ä½ åº”è¯¥çœ‹åˆ°error çš„ä¿¡æ¯.</p>
<p> ç„¶è€Œ(è¯‘æ³¨ï¼šè®¨åŒçš„ç„¶è€Œ),åœ¨ç°å®ä¸­,ç»„ä»¶ä¸åº”è¯¥åŒ…å«å…·ä½“çš„fetché€»è¾‘,dataä¹Ÿä¸åº”è¯¥å‚¨å­˜åœ¨ç»„ä»¶çš„stateä¸­,æ‰€ä»¥Reduxå®æ—¶çš„å‡ºç°äº†.</p>
<h2 id="è½¬å˜åˆ°Redux"><a href="#è½¬å˜åˆ°Redux" class="headerlink" title="è½¬å˜åˆ°Redux"></a>è½¬å˜åˆ°Redux</h2><p> éœ€è¦æ·»åŠ Redux, React Redux å’ŒRedux Thunkä½œä¸ºä¾èµ–é¡¹.</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> redux react-redux redux-thunk <span class="comment">--save</span></div></pre></td></tr></table></figure>
<h2 id="ç†è§£Redux"><a href="#ç†è§£Redux" class="headerlink" title="ç†è§£Redux"></a>ç†è§£Redux</h2><p> æœ‰å‡ ä¸ªReduxçš„æ ¸å¿ƒåŸç†,æˆ‘ä»¬å¿…é¡»è¦ç†è§£(è¯‘æ³¨ï¼šè¯å¾ˆç®€å•,ä½†æ˜¯è¦åœ¨å¤§è„‘é‡Œæ„å»ºå‡ºReduxçš„å·¥ä½œæµç¨‹æ˜¯æœ‰èŠ±å¾ˆå¤šæ—¶é—´çš„å’Œç²¾åŠ›çš„).</p>
<ol>
<li>Reduxä¸­æœ‰ä¸€ä¸ªå…¨å±€stateå¯¹è±¡æ¥ç®¡ç†æ•´ä¸ªåº”ç”¨çš„state.åœ¨ç¯‡æ–‡ç« ä¸­,å…¨å±€å¯¹è±¡å°±æ˜¯æˆ‘ä»¬ç»„ä»¶çš„åˆå§‹åŒ–å¯¹è±¡.</li>
<li>å”¯ä¸€èƒ½æ”¹å˜stateçš„æ˜¯è§¦å‘ä¸€ä¸ªaction,actionæ˜¯ä¸€ä¸ªæè¿°stateåº”è¯¥æ€ä¹ˆæ”¹å˜çš„å¯¹è±¡,Action Creatorså¯ä»¥è¢«<code>dispatch</code>edçš„å‡½æ•°,è§¦å‘ä¸€ä¸ªå˜åŒ–,æ‰§è¡Œçš„å†…å®¹æ˜¯è¿”å›ä¸€ä¸ªaction</li>
<li>å½“ä¸€ä¸ªactionè¢«dispatchä»¥å,Reduceræ‰§è¡Œæ ¹æ®actionçš„å†…å®¹å®é™…æ”¹å˜stateå¯¹è±¡,å¦‚æœactionæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹,å°±ä¼šè¿”å›é»˜è®¤çš„state.</li>
<li><code>Reducersæ˜¯çº¯å‡½æ•°,ä»–ä»¬ä¸èƒ½æœ‰ä»»ä½•çš„å¼‚æ­¥æ“ä½œå’Œmutate-å¿…é¡»è¦è¿”å›ä¸€ä¸ªä¿®æ”¹çš„copy</code>.</li>
<li>å•ä¸ªçš„Reducerå¯ä»¥è¢«combineä¸ºä¸€ä¸ªå•ä¸€çš„<code>rootReducer</code>,ä»è€Œåˆ›å»ºä¸€ä¸ªç¦»æ•£çš„stateèšåˆä½“.</li>
<li>Storeæ˜¯æŠŠactionå’Œreducerç»„ç»‡åˆ°ä¸€èµ·çš„å·¥å…·,ä»–åŒ…å«äº†<code>rootReducer</code>ä»£è¡¨çš„çŠ¶æ€,ä¸­é—´ä»¶,å…è®¸ä½ æ‰§è¡Œå®é™…çš„<code>dispatch</code>actions</li>
<li>ä¸ºäº†åœ¨Reactä¸­ä½¿ç”¨Redux,<code>&lt;Provider /&gt;</code>ç»„ä»¶åŒ…è£…æ•´ä¸ªåº”ç”¨,ä¼ é€’<code>store</code>åˆ°å­ä»£ç»„ä»¶ä»¬.</li>
</ol>
<h2 id="è®¾è®¡æˆ‘ä»¬çš„state"><a href="#è®¾è®¡æˆ‘ä»¬çš„state" class="headerlink" title="è®¾è®¡æˆ‘ä»¬çš„state"></a>è®¾è®¡æˆ‘ä»¬çš„state</h2><p>ä»æˆ‘ä»¬ç°åœ¨å·²æœ‰çš„ä»£ç é‡Œ,å¯ä»¥çŸ¥é“æˆ‘ä»¬çš„stateéœ€è¦3ä¸ªå±æ€§(properties)ï¼š<code>items</code>,<code>hasErrored</code>,<code>isLoading</code>,è¿™ä¸ªä¸‰ä¸ªå±æ€§ç›¸åº”çš„éœ€è¦ä¸‰ä¸ªç‹¬ç«‹çš„actions.</p>
<p>ç°åœ¨,è¿™é‡Œè®²è®²ä¸ºä»€ä¹ˆAction Creatorå’ŒActionæ˜¯ä¸åŒçš„,ä»–ä»¬ä¹Ÿä¸æ˜¯1ï¼š1çš„å…³ç³»:æˆ‘ä»¬éœ€è¦ç¬¬å››ä¸ªactiong creatoræ¥æ ¹æ®fetch dataçš„ä¸åŒçŠ¶æ€è°ƒç”¨å…¶ä»–ä¸‰ä¸ªaction(creators).è¿™ç¬¬å››ä¸ªaction creatorå‡ ä¹å’Œæˆ‘ä»¬åŸå…ˆçš„<code>fetchData()</code>ä¸€æ ·,ä½†æ˜¯å®ƒä¸ä¼šç›´æ¥çš„ä½¿ç”¨<code>this.setState({isLoading:true})</code>æ¥è®¾ç½®çŠ¶æ€,æˆ‘ä»¬å°†<code>dispatch</code>ä¸€ä¸ªactionå»åšåŒæ ·çš„äº‹æƒ…:<code>dispatch(isLoading(true))</code>.</p>
<h2 id="åˆ›å»ºactions"><a href="#åˆ›å»ºactions" class="headerlink" title="åˆ›å»ºactions"></a>åˆ›å»ºactions</h2><p>åœ¨actionsç›®å½•ä¸‹åˆ›å»ºitmes.jsæ–‡ä»¶,å…¶ä¸­åŒ…å«æˆ‘ä»¬çš„action creators.åˆ›å»ºä¸‰ä¸ªç®€å•çš„actions.<br> <figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">     export <span class="keyword">function</span> <span class="title">itemsHasErrored</span>(bool) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">&#123;</span></div><div class="line">        <span class="keyword">type</span>: <span class="symbol">'ITEMS_HAS_ERRORED</span>',</div><div class="line">        hasErrored: bool</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">export <span class="keyword">function</span> <span class="title">itemsIsLoading</span>(bool) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">&#123;</span></div><div class="line">        <span class="keyword">type</span>: <span class="symbol">'ITEMS_IS_LOADING</span>',</div><div class="line">        isLoading: bool</div><div class="line">    &#125;;</div><div class="line"> &#125;</div><div class="line">export <span class="keyword">function</span> <span class="title">itemsFetchDataSuccess</span>(items) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">&#123;</span></div><div class="line">        <span class="keyword">type</span>: <span class="symbol">'ITEMS_FETCH_DATA_SUCCESS</span>',</div><div class="line">        items</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> å¦‚å‰é¢æåˆ°çš„,action creatorsä¼¼èƒ½è¿”å›å‡½æ•°çš„å‡½æ•°,ä½¿ç”¨<code>export</code>è¾“å‡ºå•ä¸ªaction creators,ä¾¿äºåœ¨ä»£ç ä¸­ä½¿ç”¨.<br>    ç¬¬äºŒä¸ªaction creatorsæ¥å—ä¸€ä¸ªå¸ƒå°”å€¼(true/false)æœ€ä¸ºå‚æ•°,è¿”å›ä¸€ä¸ªæœ‰æ„ä¹‰çš„<code>type</code>å’Œå¸ƒå°”å€¼,åˆ†é…åˆé€‚çš„å±æ€§.<br>    ç¬¬ä¸‰ä¸ª,<code>itemsFetchSuccess()</code>,å½“æ•°æ®æˆåŠŸè¿”å›ä»¥å,ä¼ é€’æ•°æ®ä½œä¸º<code>items</code>å±æ€§çš„å€¼.é€šè¿‡ES6çš„é­”æœ¯å±æ€§ç¼©å†™,æˆ‘ä»¬èƒ½å¤Ÿè¿”å›ä¸€ä¸ªå¯¹è±¡å«æœ‰å±æ€§åå«åš<code>items</code>,ä»–çš„å€¼æ˜¯<code>items</code>çš„æ•°ç»„.</p>
<p>   ï¼ˆNote: that the value you use for type and the name of the other property that is returned is important, because you will re-use them in your reducersï¼‰è¿™ä¸€å¥ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘.<br>   ç°åœ¨,æˆ‘ä»¬æœ‰äº†ä¸‰ä¸ªactions,ä»£è¡¨æˆ‘ä»¬çš„çŠ¶æ€,æŠŠåŸæ¥çš„ç»„ä»¶æ–¹æ³•<code>fetchData</code>è¯¥ç»™<code>itemFetchDaga()</code>action creator.<br>   é»˜è®¤æƒ…å†µä¸‹,Redux action creatorsæ˜¯ä¸æ”¯æŒå¼‚æ­¥actionsçš„,åƒæ˜¯fetching dataçš„æ“ä½œ,æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Redux Thunk.Thunkå…è®¸ä½ åœ¨action creatoré‡Œè¿”å›ä¸€ä¸ªå‡½æ•°ä»£æ›¿å®é™…çš„action.å†…éƒ¨å‡½æ•°æ¥å—<code>dispatch</code>å’Œ<code>getState</code>ä½œä¸ºå‚æ•°,ä½†æ˜¯æˆ‘ä»¬ä»…ä»…ä½¿ç”¨<code>dispatch</code>.<br>   å®é™…çš„ç®€å•ä¾‹å­ä¸­äº”ç§’ä»¥åå°†ä¼šè§¦å‘<code>itemHasErrored()</code>å‡½æ•°.</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">errorAfterFiveSeconds</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// We return a function instead of an action object</span></div><div class="line">    <span class="comment">//dispatchä½œä¸ºå‚æ•°ä¼ é€’ç»™èƒ–ç®­å¤´å‡½æ•°</span></div><div class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="comment">// This function is able to dispatch other action creators</span></div><div class="line">            dispatch(itemsHasErrored(<span class="literal">true</span>));</div><div class="line">        &#125;, <span class="number">5000</span>);</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>   ç°åœ¨æˆ‘ä»¬çŸ¥é“thunkæ˜¯ä»€ä¹ˆäº†.ç¼–å†™<code>itemsFetchData()</code>.</p>
   <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">export</span> function itemsFetchData(url) &#123;</div><div class="line">    <span class="keyword">return</span> (dispatch) =&gt; &#123;</div><div class="line">        <span class="regexp">//</span>å·²è¿›å…¥fetchdata,æŒ‰é¡ºåºæŠŠisLoading state ç”±</div><div class="line">        <span class="regexp">//</span> <span class="literal">false</span>=&gt;<span class="literal">true</span></div><div class="line">        dispatch(itemsIsLoading(<span class="literal">true</span>));</div><div class="line">        <span class="regexp">//</span>fetchæ‰§è¡Œå®é™…çš„å¼‚æ­¥è¿œç¨‹è·å–æ•°æ®æ“ä½œ</div><div class="line">        fetch(url) </div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> &#123;</div><div class="line">                <span class="keyword">if</span> (!response.ok) &#123;<span class="regexp">//</span>æ ¹æ®çŠ¶æ€æŠ›å‡ºé”™è¯¯</div><div class="line">                    <span class="keyword">throw</span> Error(response.statusText);</div><div class="line">                &#125;</div><div class="line">                <span class="regexp">//i</span>sLoadingåˆæ”¹ä¸º<span class="literal">false</span>,åŠ è½½Loadingç»„ä»¶</div><div class="line">                dispatch(itemsIsLoading(<span class="literal">false</span>));</div><div class="line">                <span class="keyword">return</span> response;</div><div class="line">            &#125;)</div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(response)</span> =&gt;</span> response.json())</div><div class="line">            .<span class="keyword">then</span>(<span class="function"><span class="params">(items)</span> =&gt;</span> dispatch(itemsFetchDataSuccess(items)))</div><div class="line">            .<span class="keyword">catch</span>(<span class="function"><span class="params">()</span> =&gt;</span> </div><div class="line">            dispatch(itemsHasErrored(<span class="literal">true</span>)));</div><div class="line">            <span class="regexp">//</span>æ•è·é”™è¯¯ä»¥åHasErrorçš„çŠ¶æ€ <span class="literal">false</span>=&gt;<span class="literal">true</span></div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºæˆ‘ä»¬çš„reducers"><a href="#åˆ›å»ºæˆ‘ä»¬çš„reducers" class="headerlink" title="åˆ›å»ºæˆ‘ä»¬çš„reducers"></a>åˆ›å»ºæˆ‘ä»¬çš„reducers</h2><p> actionå®šä¹‰å¥½äº†ä»¥å,å¯ä»¥ç¼–å†™reducersæ¥å—actions,æ¥ç€è¿”å›applictionçš„æ–°çŠ¶æ€(è¯‘æ³¨ï¼šå®é™…ä¸Šstoreä¸­è¿”å›çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡,ä¸æ˜¯åŸå¯¹è±¡çš„å¼•ç”¨,è¿™ä¸ªå°±å«åšimmutable,facebookå®šä¹‰äº†ä¸€ä¸ªimmutable.jsçš„æŠ€æœ¯å®é™…æ˜¯ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡çš„ç¡¬æ‹·è´,ä½†æ˜¯åœ¨åŸå¯¹è±¡å’Œä¿®æ”¹å¯¹è±¡ä¹‹é—´å…±äº«äº†ä¸€éƒ¨åˆ†å†…å®¹,è¿™ä¸€ç‚¹æœ‰ç‚¹å¾®å¦™).<br> æ³¨æ„ï¼šåœ¨Reduxä¸­,æ‰€æœ‰çš„reducersä¸è€ƒè™‘action,éƒ½ä¼šè°ƒç”¨,æ‰€ä»¥å³å°±æ˜¯æ²¡æœ‰actionè¢«åº”ç”¨,ä½ ä¹Ÿå¿…é¡»è¦è¿”å›ä¸€ä¸ªåŸæ¥çš„å®šä¹‰çš„<code>state</code>.</p>
<p> æ¯ä¸€ä¸ªreduceræ¥æ”¶ä¸¤ä¸ªå‚æ•°,ä¹‹å‰çš„stateå’Œä¸€ä¸ª<code>action</code>å¯¹è±¡.ä¹Ÿå¯ä»¥ä½¿ç”¨ES6çš„å±æ€§æ¥è°ƒç”¨é»˜è®¤çš„å‚æ•°è®¾å®šåˆ°é»˜è®¤çš„<code>åˆå§‹åŒ–state</code>.</p>
<p> åœ¨æ¯ä¸ªreducerå†…éƒ¨,ä½¿ç”¨<code>switch</code>ç”³æ˜æ¥å†³å®šåˆ°åº•å“ªä¸ª<code>action.type</code>ç›¸åŒ¹é….å¦‚æœæ˜¯ç®€å•çš„reducer,å¯èƒ½æ²¡æœ‰å¿…è¦ä½¿ç”¨<code>switch</code>,ç†è®ºä¸Šä½¿ç”¨<code>if/else</code>å¯èƒ½æ›´å¿«ä¸€ç‚¹.</p>
<p> å¦‚æœ<code>action.type</code>ä¸€ç‚¹åŒ¹é…,ç„¶åä¼šè¿”å›å’Œ<code>action</code>ç›¸å…³çš„å±æ€§.å’Œå‰é¢æåˆ°çš„ä¸€æ ·,<code>type</code>å’Œ<code>action[å±æ€§å]</code>æ˜¯åœ¨action creatorsé‡Œå®šä¹‰çš„.</p>
<p> å¥½å•¦,äº†è§£åˆ°è¿™äº›å†…å®¹,åœ¨<code>reducers/item.js</code>ä¸­åˆ›å»ºitems reducers<br> <figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"> export function itemsHasErrored(<span class="keyword">state</span> = false, action) &#123;</div><div class="line">    switch (action.type) &#123;</div><div class="line">        case 'ITEMS_HAS_ERRORED':</div><div class="line">            return action.hasErrored;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            return <span class="keyword">state</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">export function itemsIsLoading(<span class="keyword">state</span> = false, action) &#123;</div><div class="line">    switch (action.type) &#123;</div><div class="line">        case 'ITEMS_IS_LOADING':</div><div class="line">            return action.isLoading;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            return <span class="keyword">state</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">export function items(<span class="keyword">state</span> = [], action) &#123;</div><div class="line">    switch (action.type) &#123;</div><div class="line">        case 'ITEMS_FETCH_DATA_SUCCESS':</div><div class="line">            return action.items;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            return <span class="keyword">state</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> æ³¨æ„reduceræ ¹æ®ç»“æœstoreçš„stateå±æ€§æ¥å‘½å,<code>action.type</code>æ²¡æœ‰å¿…è¦æƒ³å¯¹åº”.å‰ä¸¤ä¸ªè¡¨è¾¾å®Œæ•´çš„æ„æ€,ç¬¬ä¸‰ä¸ª<code>items()</code>å°±ç¨å¾®æœ‰ç‚¹ä¸åŒ.</p>
<p> è¿™æ˜¯å› ä¸º,å¯èƒ½ä¼šæœ‰å¾ˆå¤šæ¡ä»¶è¿”å›<code>items</code>æ•°ç»„:æœ‰å¯èƒ½è¿”å›æ‰€æœ‰çš„æ•°ç»„,æœ‰å¯èƒ½åœ¨åˆ é™¤dispatchä»¥åè¿”å›<code>items</code>çš„æ¬¡çº§ç»“æ„.æˆ–è€…æ‰€æœ‰çš„itemséƒ½è¢«åˆ é™¤äº†,ä¼šè¿”å›ä¸€ä¸ªç©ºæ•°ç»„.</p>
<p> ä¸ºäº†é‡æ–°éå†,æ¯ä¸€ä¸ªreduceréƒ½ä¼šè¿”å›ä¸€ä¸ªæˆªç„¶ä¸åŒçš„stateå±æ€§,ä¸éœ€è¦è€ƒè™‘reducerå†…éƒ¨çš„æ¡ä»¶åˆ°åº•æœ‰å¤šå°‘.åˆšå¼€å§‹èŠ±äº†æˆ‘å¾ˆé•¿æ—¶é—´æƒ³æ˜ç™½è¿™ä¸ªé—®é¢˜.<br> å•ä¸ªçš„reducersåˆ›å»ºå¥½äº†ä»¥å,æˆ‘ä»¬éœ€è¦æŠŠå•ä¸ªçš„reduceråˆå¹¶(combine)æˆä¸€ä¸ª<code>rootReducer</code>,åˆ›å»ºå•ä¸€å¯¹è±¡.</p>
<p> åˆ›å»ºæ–‡ä»¶<code>reducers/index.js</code></p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; items, itemsHasErrored, itemsIsLoading &#125; <span class="keyword">from</span> <span class="string">'./items'</span>;</div><div class="line"><span class="comment">//ç”±äºæ¯ä¸ªreducerè¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"><span class="comment">//æ‰€ä»¥è¿™é‡Œçš„æ“ä½œå°±æ˜¯åˆå¹¶å¯¹è±¡çš„æ“ä½œ,åœ¨underscoreå’Œloadsh</span></div><div class="line"><span class="comment">//é‡Œé¢å¯ä»¥æ‰¾åˆ°åˆå¹¶jså¯¹è±¡çš„ä»£ç </span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</div><div class="line">    items,</div><div class="line">    itemsHasErrored,</div><div class="line">    itemsIsLoading</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p> æˆ‘ä»¬ä»<code>items</code>é‡Œå¯¼å…¥æ¯ä¸ªreducers,ä½¿ç”¨reduxçš„<code>combineReducers()</code>å‡½æ•°æ¥åˆå¹¶è¾“å‡ºå•ä¸€å¯¹è±¡(è¯‘æ³¨:æ‰€ä»¥æ¯ä¸€ä¸ªreducerè¿”å›çš„å¯¹è±¡çš„å±æ€§ååº”è¯¥æ˜¯å”¯ä¸€çš„,å¦åˆ™å°±è¦†ç›–äº†,å‰é¢çš„å†…å®¹è¡¨è¾¾è¿‡è¿™ä¸ªæ„æ€)<br>å› ä¸ºæˆ‘ä»¬çš„reducerçš„åå­—å’Œåœ¨storeä¸­ä½¿ç”¨çš„å±æ€§åä¸€æ ·,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ES6çš„å¯¹è±¡å­—é¢é‡.</p>
<p>æ³¨æ„,æˆ‘æœ‰æ„æåˆ°äº†reducerçš„å‰ç¼€,æ‰€ä»¥å½“æˆ‘ä»¬çš„applicationå˜å¾—æ¯”è¾ƒå¤æ‚çš„æ—¶å€™,ä¸èƒ½å‡ºç°å…¨å±€æ€§çš„<code>hasErrored</code>å’Œ<code>isLoading</code>å±æ€§.å¯ä»¥ä½¿ç”¨ä¸åŒçš„errorå’Œloading state,æ‰€ä»¥å‰ç¼€å¯ä»¥ç»™ä½ å¾ˆå¤§çš„çµæ´»æ€§.ä¾‹å¦‚<br>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; items, itemsHasErrored, itemsIsLoading &#125; <span class="keyword">from</span> <span class="string">'./items'</span>;</div><div class="line"><span class="keyword">import</span> &#123; posts, postsHasErrored, postsIsLoading &#125; <span class="keyword">from</span> <span class="string">'./posts'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</div><div class="line">    items,</div><div class="line">    itemsHasErrored,</div><div class="line">    itemsIsLoading,</div><div class="line">    posts,</div><div class="line">    postsHasErrored,</div><div class="line">    postsIsLoading</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>   æ›¿ä»£æ–¹æ³•æ˜¯,å¯ä»¥åœ¨importçš„æ—¶å€™ä½¿ç”¨åˆ«å.ä½†æ˜¯æˆ‘æ›´æ„¿æ„ä½¿ç”¨ç‹¬ä¸€æ— äºŒçš„åå­—.</p>
<h2 id="é…ç½®store-æ³¨å…¥åˆ°ä½ çš„appä¸­"><a href="#é…ç½®store-æ³¨å…¥åˆ°ä½ çš„appä¸­" class="headerlink" title="é…ç½®store,æ³¨å…¥åˆ°ä½ çš„appä¸­"></a>é…ç½®store,æ³¨å…¥åˆ°ä½ çš„appä¸­</h2><p>æ“ä½œå¾ˆç›´æ¥,åˆ›å»º<code>store/configureStore.js</code></p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</div><div class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'../reducers'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">configureStore</span>(<span class="params">initialState</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> createStore(</div><div class="line">        rootReducer,</div><div class="line">        initialState,</div><div class="line">        applyMiddleware(thunk)</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  ç°åœ¨åœ¨index.jsä¸­åŒ…å«<code>&lt;Provider /&gt;</code>ç»„ä»¶,<code>configureStore</code>,é…ç½®<code>store</code>.åŒ…è£…app(<code>&lt;ItemList /&gt;</code>),ä¼ é€’è¿›å»<code>store</code>å’Œ<code>props</code>.</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> configureStore <span class="keyword">from</span> <span class="string">'./store/configureStore'</span>;</div><div class="line"><span class="keyword">import</span> ItemList <span class="keyword">from</span> <span class="string">'./components/ItemList'</span>;</div><div class="line"><span class="keyword">const</span> store = configureStore(); <span class="comment">// You can also pass in an initialState here</span></div><div class="line">render(</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">ItemList</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>  æˆ‘çŸ¥é“,å…¶å®èŠ±äº†å¾ˆå¤šåŠªåŠ›æ‰åˆ°äº†è¿™ä¸€æ­¥,ä½†æ˜¯éšç€è®¾ç½®çš„å®Œæˆ,æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é…ç½®æ¥æ“çºµæˆ‘ä»¬çš„ç»„ä»¶äº†(è¯‘æ³¨:è¿™é‡Œæ˜¯æ„è¯‘,ç»„ä»¶åˆç§°ä¸ºæœ¨å¶ç»„ä»¶,æ„æ€å¾ˆæ¸…æ¥šå§ï¼Ÿè°æ˜¯æ‹¿ç€åŠçº¿çš„äººå‘¢ï¼Ÿå°±æ˜¯redux).</p>
<h2 id="æŠŠç»„ä»¶è½¬åŒ–ä¸ºä½¿ç”¨Redux-storeå’Œæ–¹æ³•"><a href="#æŠŠç»„ä»¶è½¬åŒ–ä¸ºä½¿ç”¨Redux-storeå’Œæ–¹æ³•" class="headerlink" title="æŠŠç»„ä»¶è½¬åŒ–ä¸ºä½¿ç”¨Redux storeå’Œæ–¹æ³•"></a>æŠŠç»„ä»¶è½¬åŒ–ä¸ºä½¿ç”¨Redux storeå’Œæ–¹æ³•</h2><p>  è·³å›åˆ°<code>components/ItemList.js</code></p>
<p>  åœ¨é¡¶éƒ¨å¯¼å…¥éœ€è¦çš„éƒ¨åˆ†<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; itemsFetchData &#125; <span class="keyword">from</span> <span class="string">'../actions/items'</span>;</div></pre></td></tr></table></figure></p>
<p>  <code>connect</code>å¯ä»¥è®©ç»„ä»¶é“¾æ¥åˆ°Reduxçš„store,<code>itemsFetchData</code>æ˜¯åœ¨å¼€å§‹å†™çš„action creator.æˆ‘ä»¬ä»…ä»…éœ€è¦å¯¼å…¥actin creator.ä½¿ç”¨<code>dispatch</code>æ¥è§¦å‘actions.(è¯‘æ³¨:reduxé‡Œé¢æœ‰å¾ˆå¤šå†…å®¹å…¶å®æ˜¯å¾ˆåŸºç¡€çš„,ä¾‹å¦‚è¿™é‡Œ,javascriptçš„å‡½æ•°æ˜¯ä¸€ç±»å¯¹è±¡,åœ¨jsä¸­å‡½æ•°æ˜¯ä¼ å¼•ç”¨çš„,æ‰€ä»¥å‡½æ•°åå¯ä»¥ä½œä¸ºå‡½æ•°çš„å¼•ç”¨,é€šè¿‡å¦ä¸€å‡½æ•°çš„å‚æ•°æ¥ä¼ é€’. å‰å®³ ğŸ‘).<br>  åœ¨ç»„ä»¶ç±»å®šä¹‰å¥½äº†ä»¥å,æˆ‘ä»¬å¯ä»¥æŠŠReduxçš„stateå’Œaction creatorçš„dispatchæ˜ å°„åˆ°propsä¸Š.<br>  åˆ›å»ºä¸€ä¸ªå‡½æ•°,æ¥å—<code>state</code>è¿”å›ä¸€ä¸ªpropså¯¹è±¡.åœ¨ç®€å•çš„ç»„ä»¶ä¸­,å¯ä»¥æŠŠå‰ç¼€å»æ‰.</p>
  <figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">   const mapStateToProps = (<span class="keyword">state</span>) =&gt; &#123;</div><div class="line">    return &#123;</div><div class="line">        items: <span class="keyword">state</span>.items,</div><div class="line">        hasErrored: <span class="keyword">state</span>.itemsHasErrored,</div><div class="line">        isLoading: <span class="keyword">state</span>.itemsIsLoading</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p> æ¥ç€æˆ‘ä»¬éœ€è¦å¦ä¸€å‡½æ•°åœ¨propsä¸­<code>dispatch</code>æˆ‘ä»¬çš„<code>itemsFetchData()</code>å‡½æ•°.</p>
 <figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">  const mapDispatchToProps = (dispatch) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line"><span class="symbol">        fetchData:</span> (url) =&gt; dispatch(itemsFetchData(url))</div><div class="line">    &#125;<span class="comment">;</span></div><div class="line">&#125;<span class="comment">;</span></div><div class="line"> ``` </div><div class="line"> </div><div class="line"> è¿˜æ˜¯æŠŠ`item`å‰ç¼€å»æ‰.è¿™é‡Œçš„fetchDataå‡½æ•°æ¥å—ä¸€ä¸ª`url`å‚æ•°,è¿”å›</div><div class="line"> æ´¾å‘è°ƒç”¨`itemsFetchData(url)`æ“ä½œ.</div><div class="line"> </div><div class="line"> ç°åœ¨,`mapStatetoProps()`å’Œ`mapDispatchToProps()`è¿˜ä¸èƒ½åšä»€ä¹ˆäº‹æƒ…,éœ€è¦æ”¹å˜ä¸€ä¸‹ä»£ç </div></pre></td></tr></table></figure>
<p> export default connect(mapStateToProps, mapDispatchToProps)(ItemList);<br> <figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">`connect`å‡½æ•°æŠŠç»„ä»¶è¿æ¥åˆ°Redux,åŒæ—¶æ˜ å°„äº†éœ€è¦ç”¨åˆ°çš„props.</div><div class="line"></div><div class="line">æœ€åä¸€æ­¥æ˜¯ä½¿ç”¨propsæ›¿æ¢æ‰state.</div><div class="line"></div><div class="line">* åˆ æ‰`constructor()&#123;&#125;`å’Œ`fetchData()&#123;&#125;`</div><div class="line">* åœ¨`componentDidMount()`é‡ŒæŠŠ`this.fetchData()`æ”¹ä¸º`this.props.fetchData()`.</div><div class="line">* `this.state.x` ç»Ÿä¸€æ”¹ä¸º`this.props.X`.</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  ä½ çš„ç»„ä»¶çœ‹èµ·æ¥åº”è¯¥æ˜¯</div></pre></td></tr></table></figure></p>
<pre><code>    import React, { Component } from &apos;react&apos;;
  import { connect } from &apos;react-redux&apos;;
 import { itemsFetchData } from &apos;../actions/items&apos;;
 class ItemList extends Component {
componentDidMount() {
    this.props.fetchData(&apos;http://5826ed963900d612000138bd.mockapi.io/items&apos;);
}
render() {
    if (this.props.hasErrored) {
        return &lt;p&gt;Sorry! There was an error loading the items&lt;/p&gt;;
    }
    if (this.props.isLoading) {
        return &lt;p&gt;Loadingâ€¦&lt;/p&gt;;
    }
    return (
        &lt;ul&gt;
            {this.props.items.map((item) =&gt; (
                &lt;li key={item.id}&gt;
                    {item.label}
                &lt;/li&gt;
            ))}
        &lt;/ul&gt;
    );
}
}
 const mapStateToProps = (state) =&gt; {
return {
    items: state.items,
    hasErrored: state.itemsHasErrored,
    isLoading: state.itemsIsLoading
};
};
const mapDispatchToProps = (dispatch) =&gt; {
return {
    fetchData: (url) =&gt; dispatch(itemsFetchData(url))
};
};
 export default connect(mapStateToProps, mapDispatchToProps)(ItemList);
</code></pre><p>   ```</p>
<p>  å¥½äº†,applicationç°åœ¨ä½¿ç”¨Reduxå’ŒRedux thunkæ¥fetchå’Œæ˜¾ç¤ºæ•°æ®.</p>
<p>  ä¹Ÿä¸æ˜¯å¤ªå›°éš¾ï¼Œæ˜¯ä¸æ˜¯ï¼Ÿ</p>
<p>  ä½ ç°åœ¨ä¹Ÿæ˜¯Reduxå¤§å¸ˆäº† :D</p>
<h2 id="æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ"><a href="#æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ"></a>æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ</h2><p>  æˆ‘åœ¨githubæäº¤äº†æ¯ä¸€æ­¥çš„ä»£ç .æˆ‘å¸Œæœ›ä½ å…‹éš†å’Œç†è§£ä»–,ç„¶åæ·»åŠ æ ¹æ®itemsçš„idåˆ é™¤itemçš„åŠŸèƒ½.</p>
<p>  æˆ‘æ²¡æœ‰çœŸæ­£æåˆ°Reduxçš„å†…å®¹æ˜¯,stateæ˜¯immutable,æ„è¯†æ˜¯ä½ ä¸èƒ½ä¿®æ”¹ä»–.æ‰€ä»¥åœ¨reducersä¸­æ¯æ¬¡éƒ½è¦è¿”å›ä¸€ä¸ªæ–°çš„state,ä¸Šé¢çš„ä¸‰ä¸ªreducersæ¯”è¾ƒç®€å•,åˆšåˆšå¥½å¯ä»¥å·¥ä½œ.ä½†æ˜¯å¦‚æœæ˜¯ä»itemsçš„æ•°ç»„ä¸­åˆ é™¤æ“ä½œ,ä½ å¯èƒ½ä¸ç†Ÿæ‚‰.<br>  ä½ ä¸èƒ½å†ä½¿ç”¨<code>Array.protype.splice()</code>æ¥ä»æ•°ç»„ä¸­ç§»é™¤items.å› ä¸ºè¿™æ ·åšä¼šmutateä¹‹å‰çš„state.<a href="https://egghead.io/lessons/javascript-redux-avoiding-array-mutations-with-concat-slice-and-spread" target="_blank" rel="external">Danåœ¨è§†é¢‘ä¸­è®²è§£äº†æ€ä¹ˆä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ </a>.å¦‚æœä½ åšæŒè¦åš,å¯ä»¥çœ‹çœ‹<code>delete-items</code>åˆ†æ”¯,å¯ä»¥æ‰¾åˆ°è§£å†³åŠæ³•.</p>
<p>  æˆ‘çœŸåˆ‡çš„å¸Œæœ›è¿™ç¯‡æ–‡ç« è®²æ˜äº†Reduxå’ŒThunkçš„åŸç†ä»¥åŠæ€ä¹ˆæŠŠç°æœ‰çš„React applicationè½¬å˜åˆ°ä½¿ç”¨redux.å†™ä½œè¿‡ç¨‹å·©å›ºäº†æˆ‘å¯¹Reduxçš„ç†è§£(è¯‘æ³¨:ç¿»è¯‘è¿‡ç¨‹ä¹Ÿå·©å›ºäº†æˆ‘çš„ç†è§£),æ‰€ä»¥æˆ‘å¾ˆé«˜å…´è¿™ä¹ˆåš(è¯‘æ³¨ï¼šso do I ğŸ˜).</p>
<p>   ä¸‹é¢æœ‰ç‚¹ä¸ç¿»äº†ã€‚</p>
<blockquote>
<p>æˆ‘ä¸ªäººè§‰å¾—è¿™ç¯‡æ–‡ç« å´ä¼¼å†™çš„éå¸¸çš„å¥½.å¼ºçƒˆæ¨è.</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹&quot;&gt;&lt;a href=&quot;#Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹&quot;&gt;&lt;/a&gt;Reduxå’ŒThunkçš„ä½¿ç”¨å‚»ç“œæ•™ç¨‹&lt;/h1&gt;&lt;blockquo
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Using normalizr.js in a Redux store â€“ Farmdrop â€“ Medium</title>
    <link href="https://phpsmarter.github.com/2017/04/13/%E7%BF%BB%E8%AF%91-Using-normalizr-js-in-a-Redux-store-%E2%80%93-Farmdrop-%E2%80%93-Medium/"/>
    <id>https://phpsmarter.github.com/2017/04/13/ç¿»è¯‘-Using-normalizr-js-in-a-Redux-store-â€“-Farmdrop-â€“-Medium/</id>
    <published>2017-04-12T20:19:25.000Z</published>
    <updated>2017-04-13T21:49:57.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åŸæ–‡è¯·<a href="https://medium.com/farmdrop/using-normalizr-js-in-a-redux-store-96ab33991369" target="_blank" rel="external">å‚è§</a>,ç¨‹åºè®¾è®¡æˆ‘ç†è§£ç®€å•ä¸€å¥è¯å°±æ˜¯å¤„ç†æ•°æ®å’Œå±•ç°æ•°æ®.æ•°ç»„,å¯¹è±¡å’Œæ•°æ®åº“éƒ½æ˜¯å±•ç°æ•°æ®çš„ä¸åŒå½¢å¼.è‡ªä»æ„è¯†åˆ°è¿™ä¸€ç‚¹ä»¥å,å°±çªç„¶å†’å‡ºä¸€ä¸ªå¿µå¤´,Reactä¸­å¼•å…¥çš„Reduxå°±å¯ä»¥ä½œä¸ºä¸€ä¸ªæ•°æ®åº“æ¥æ€è€ƒå•Š,è‡³å°‘æ˜¯èƒ½ä½¿ç”¨å·²ç»å­¦è¿‡çš„å¼€å‘webæ¨¡å¼,æ¡†æ¶+æ•°æ®åº“çš„æ¦‚å¿µæ¥è¾…åŠ©ç†è§£.ä½†æ˜¯Reduxä¸­çš„stateè¿˜æ˜¾çš„å¾ˆç®€å•,æ‰€ä»¥æœ‰ç¨‹åºå‘˜å°±å¼•å…¥äº†normalizr.jsæ¥ç»§ç»­æ‰©å±•stateçš„èƒ½åŠ›,æœ€ç»ˆè¿™ç¯‡æ–‡ç« å°±ä¹Ÿæå‡ºäº†ç®€å•æ•°æ®åº“çš„æ¦‚å¿µ.æˆ‘å¯¹è¿™ä¸ªé—®é¢˜è¿˜ä¸æ˜¯å¤ªæ¸…æ¥š,å‰é¢çœ‹æ–‡æ¡£çš„æ—¶å€™å¹¶æ²¡æœ‰æ„è¯†åˆ°ä»–çš„ä»·å€¼,ç°åœ¨è¿”å›å¤´æ¥çœ‹,å‘ç°è¿™ä¸ªå¯èƒ½è¿˜æŒºæœ‰ç”¨çš„.åé¢ä¼šç»§ç»­å­¦ä¹ è¿™éƒ¨åˆ†çš„å†…å®¹.ç¿»è¯‘éƒ¨åˆ†å®Œæˆ,ä½†æ˜¯æœ‰äº›å†…å®¹ä¸ç†è§£.<strong>æ‰€ä»¥å†…å®¹ä»¥åŸæ–‡ä¸ºå‡†</strong></p>
</blockquote>
<h1 id="åœ¨Redux-storeä¸­ä½¿ç”¨normalizr-js"><a href="#åœ¨Redux-storeä¸­ä½¿ç”¨normalizr-js" class="headerlink" title="åœ¨Redux storeä¸­ä½¿ç”¨normalizr.js"></a>åœ¨Redux storeä¸­ä½¿ç”¨normalizr.js</h1><p>   æœ€è¿‘æˆ‘ä»¬åœ¨appä¸­å¼€å§‹ä½¿ç”¨React,ä½†æ˜¯æˆ‘ä»¬æ„è¯†åˆ°å½“appè§„æ¨¡æ‰©å¤§çš„æ—¶å€™,å•å‡­Propsæ¥ä¼ é€’æ•°æ®æ˜¯ä¸èƒ½é€‚åº”appçš„å¤§è§„æ¨¡ç»“æ„éœ€æ±‚.å•çº¯ä½¿ç”¨React,è¦ç»´æŠ¤å’Œæ·»åŠ é¢å¤–çš„åŠŸèƒ½æˆ–è€…é‡æ„(refactor,æ˜¯è¿™ä¹ˆç¿»è¯‘çš„å—ï¼Ÿ)éƒ½éå¸¸çš„å›°éš¾.å› æ­¤æˆ‘ä»¬å†³å®šåœ¨appä¸­æ•´åˆä½¿ç”¨Redux,æˆ‘ä»¬èŠ±è´¹äº†å¾ˆå¤šç²¾åŠ›æ¥é‡æ„ä»£ç ,ç”±æ­¤æˆ‘è§‰å¾—å¯ä»¥åˆ†äº«ä¸€ä¸‹æˆ‘å­¦åˆ°çš„ä¸œè¥¿.<code>ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ€ä¹ˆåœ¨Redux storeä¸­ç»„ç»‡æ•°æ®</code>.</p>
<h2 id="æå‡ºé—®é¢˜"><a href="#æå‡ºé—®é¢˜" class="headerlink" title="æå‡ºé—®é¢˜"></a>æå‡ºé—®é¢˜</h2><p>   æˆ‘ä»¬çš„appæ˜¯e-commerce,æ‰€ä»¥é‡Œé¢æœ‰è®¢å•å’Œå•†å“çš„æ¦‚å¿µ,æŠŠè®¢å•å’Œå•†å“è”ç³»èµ·æ¥çš„æ˜¯æ¯ä¸€æ¡ Line Items(è®¢å•é¡¹).ä¸€ä¸ª Line Itemè¿æ¥ä¸€ä¸ªäº§å“åˆ°è®¢å•,å¯ä»¥å‚¨å­˜å®¢æˆ·è®¢å•ä¸­æ¯ç§äº§å“çš„æ•°é‡.<br>   ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„appçš„æ€§èƒ½,æˆ‘æƒ³ç¡®è®¤åœ¨appè¿è¡Œä¸­æ²¡æœ‰å®ä½“(entities)åœ¨å†…å­˜ä¸­è¢«å¤åˆ¶.åœ¨æˆ‘ä»¬ä»¥å‰çš„Angular appä¸­,æˆ‘ä»¬åœ¨å†…ä»ä¸­å¤åˆ¶äº§å“ç±»ä¼¼ä¸‹é¢<br>   (è¯‘æ³¨:è¿™é‡Œçš„å¤åˆ¶çš„æ„æ€æ˜¯æœ‰æ²¡æœ‰å­˜åœ¨é‡å¤çš„é—®é¢˜)</p>
 <figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// BAD - notice how the 'Carrots' object is </span></div><div class="line">  <span class="selector-tag">duplicated</span>.</div><div class="line">  <span class="comment">//ä¸å¥½çš„æ–¹æ³•-æ³¨æ„Carrotså¯¹è±¡è¢«å¤åˆ¶</span></div><div class="line">&#123;</div><div class="line">  <span class="attribute">order</span>: &#123;</div><div class="line">    <span class="attribute">id</span>: <span class="number">10</span>,</div><div class="line">    <span class="attribute">line_items</span>: [</div><div class="line">      &#123; </div><div class="line">        <span class="attribute">id</span>: <span class="number">483</span>,</div><div class="line">        <span class="attribute">quantity</span>: <span class="number">2</span>,</div><div class="line">        <span class="attribute">product</span>: &#123;<span class="comment">//è¿™ä¸ªäº§å“å’Œä¸‹é¢çš„äº§å“æ˜¯é‡å¤çš„,æœ‰å†…å­˜æµªè´¹</span></div><div class="line">          <span class="attribute">id</span>: <span class="number">924</span>,</div><div class="line">          <span class="attribute">name</span>: <span class="string">'Carrots'</span>,</div><div class="line">          <span class="attribute">price</span>: <span class="string">'1.50'</span>,</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attribute">products</span>: [ <span class="comment">//è¿™é‡Œçš„äº§å“å’Œä¸Šé¢çš„æ˜¯ä¸€æ‘¸ä¸€æ ·çš„,ç”¨ä¸€ä¸ªå¼•ç”¨å°±å¯ä»¥</span></div><div class="line">    &#123;</div><div class="line">      <span class="attribute">id</span>: <span class="number">924</span>,</div><div class="line">      <span class="attribute">name</span>: <span class="string">'Carrots'</span>,</div><div class="line">      <span class="attribute">price</span>: <span class="string">'1.50'</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨Reduxçš„æ—¶å€™ä¹Ÿåº”è¯¥è¿™ä¹ˆåšå—?reducersåœ¨è¿™ç§æƒ…å†µä¸‹åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ(ä¸Šé¢çš„ä¸¤ä¸ªäº§å“çš„é‡å¤,æ€ä¹ˆåœ¨reducerä¸­æ¥å‡å°‘é‡å¤)</p>
<h2 id="åº”å¯¹å¯¹è±¡å†—ä½™å¤åˆ¶çš„è§£å†³åŠæ³•"><a href="#åº”å¯¹å¯¹è±¡å†—ä½™å¤åˆ¶çš„è§£å†³åŠæ³•" class="headerlink" title="åº”å¯¹å¯¹è±¡å†—ä½™å¤åˆ¶çš„è§£å†³åŠæ³•"></a>åº”å¯¹å¯¹è±¡å†—ä½™å¤åˆ¶çš„è§£å†³åŠæ³•</h2><p>åœ¨çœ‹äº†<a href="https://blog.risingstack.com/react-js-best-practices-for-2016" target="_blank" rel="external">è¿™ç¯‡ä¼Ÿå¤§çš„æ–‡ç« </a>å,æˆ‘æ„è¯†åˆ°normalizr.jsåº”è¯¥éå¸¸ç¬¦åˆæˆ‘çš„è¦æ±‚.ç®€æ˜æ‰¼è¦,normalizræ¥æ”¶ä¸€ä¸ªå·¢å¼(nested) javascirptå¯¹è±¡(ç±»ä¼¼ä¸Šé¢çš„è®¢å•),ç„¶åè¾“å‡ºæ‰å¹³åŒ–çš„å¯¹è±¡.åœ¨<a href="https://github.com/gaearon/normalizr" target="_blank" rel="external">Github repo</a>ä¸­æŸ¥çœ‹å®ƒçš„å…·ä½“å·¥ä½œåŸç†.</p>
<p>ä¸ºäº†è®©normalizræ­£å¸¸å·¥ä½œ,å¿…é¡»ä¸ºéœ€è¦å‚¨å­˜åœ¨storeä¸­çš„entityåˆ›å»ºä¸åŒçš„å›¾å¼(schema).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// schemas.js</span></div><div class="line"><span class="keyword">import</span> &#123; Schema, arrayOf &#125; <span class="keyword">from</span> <span class="string">'normalizr'</span>;</div><div class="line"><span class="keyword">const</span> orderSchema     = Schema(<span class="string">'orders'</span>);</div><div class="line"><span class="keyword">const</span> lineItemSchema  = Schema(<span class="string">'lineItems'</span>);</div><div class="line"><span class="keyword">const</span> productSchema   = Schema(<span class="string">'products'</span>);</div><div class="line"><span class="comment">// An Order has an array of line items</span></div><div class="line"><span class="comment">//è®¢å•å«æœ‰line itemsçš„æ•°ç»„</span></div><div class="line">orderSchema.define(&#123;</div><div class="line">  <span class="attr">lineItems</span>: arrayOf(lineItemSchema)</div><div class="line">&#125;);</div><div class="line"><span class="comment">// A Line Item has one product attached</span></div><div class="line"><span class="comment">//æ¯ä¸ªline itemæœ‰ä¸€ä¸ªäº§å“é™„ç€åˆ°ä¸Šé¢</span></div><div class="line">lineItems.define(&#123;</div><div class="line">  <span class="attr">product</span>: productSchema</div><div class="line">&#125;);</div><div class="line"><span class="keyword">export</span> &#123; orderSchema, lineItemSchema, productSchema &#125;;</div></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ªç®€å•çš„action,ç›®çš„æ˜¯å»åºåˆ—åŒ–æˆ‘ä»¬çš„è®¢å•,è¾“å…¥åˆ°redux storeä¸­.</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// shop_actions.js</span></div><div class="line">module.exports = &#123;</div><div class="line">  deserializeOrder: (<span class="keyword">order</span>) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="keyword">type</span>: <span class="string">'DESERIALIZE_ORDER'</span>,</div><div class="line">      <span class="keyword">order</span>: <span class="keyword">order</span>    </div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸€æ—¦ä½ å·²ç»æœ‰äº†schemaå’Œactions,reducerä¼šå˜å¾—å‡ºå¥‡çš„ç®€å•<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// shop_reducer.js</span></div><div class="line"><span class="keyword">import</span> &#123; normalize &#125; <span class="keyword">from</span> <span class="string">'normalizr'</span>;</div><div class="line"><span class="keyword">import</span> &#123; orderSchema &#125; <span class="keyword">from</span> <span class="string">'./schemas'</span>;</div><div class="line"><span class="comment">// We use seamless-immutable but thats for another time.</span></div><div class="line"><span class="comment">//è¿˜è¦ä¸¤ä¸ªæ¯”è¾ƒå¥½çš„immutable.jsçš„å®ç°æ–¹æ³•,å¯ä»¥åœ¨githubä¸­çœ‹çœ‹</span></div><div class="line"><span class="keyword">import</span> Immutable <span class="keyword">from</span> <span class="string">'seamless-immutable'</span>;</div><div class="line"><span class="keyword">const</span> defaultState = Immutable(&#123;</div><div class="line">  <span class="attr">order</span>: [],</div><div class="line">  <span class="attr">product</span>: [],</div><div class="line">  <span class="attr">lineItem</span>: []</div><div class="line">&#125;);</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">shopReducer</span>(<span class="params">state = defaultState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'DESERIALIZE_ORDER'</span>:</div><div class="line">      <span class="comment">// This is the magic part - the normalize method will flatten </span></div><div class="line">      <span class="comment">// my deeply nested order according to my schemas defined</span></div><div class="line">      <span class="comment">// above.</span></div><div class="line">      <span class="comment">//å·¢å¼ç»“æ„è¢«æ‰å¹³åŒ–</span></div><div class="line">      <span class="keyword">var</span> normalizedOrder = normalize(action, &#123; </div><div class="line">        <span class="attr">order</span>: orderSchema </div><div class="line">      &#125;);</div><div class="line">      <span class="comment">// Due to using seamless-immutable we have to merge the new</span></div><div class="line">      <span class="comment">// entities into the state.</span></div><div class="line">      <span class="keyword">return</span> state.merge(normalizedOrder.entities);</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> state;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨actionså’Œreducersä¸€èµ·å·¥ä½œæ—¶è¿›è¡Œæµ‹è¯•å·¥ä½œ.<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./path/to/reducer'</span>;</div><div class="line"><span class="keyword">import</span> actions <span class="keyword">from</span> <span class="string">'./path/to/actions'</span>;</div><div class="line">const fakeOrder = &#123;</div><div class="line">  id: <span class="number">10</span>,</div><div class="line">  lineItems: [</div><div class="line">    &#123;</div><div class="line">      id: <span class="number">483</span>,</div><div class="line">      quantity: <span class="number">2</span>,</div><div class="line">      product: &#123;</div><div class="line">        id: <span class="number">924</span>,</div><div class="line">        name: <span class="string">'Carrots'</span>,</div><div class="line">        price: <span class="number">1.50</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line">describe(<span class="string">'shopReducer'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  describe(<span class="string">'DESERIALIZE_ORDER'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    let state;</div><div class="line">    beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      state = reducer(</div><div class="line">        <span class="literal">undefined</span>, </div><div class="line">        actions.deserializeOrder(fakeOrder)</div><div class="line">      );</div><div class="line">    &#125;);    </div><div class="line">    </div><div class="line">    it(<span class="string">'should deserialize the order correctly'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      expect(state.orders[<span class="number">10</span>]).toEqual(&#123;</div><div class="line">        id: <span class="number">10</span>,</div><div class="line">        lineItems: [ <span class="number">483</span>]</div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    it(<span class="string">'should deserialize the lineItems correctly'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      expect(state.lineItems[<span class="number">483</span>]).toEqual(&#123;</div><div class="line">        id: <span class="number">483</span>,</div><div class="line">        quantity: <span class="number">2</span>,</div><div class="line">        product: <span class="number">924</span></div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">  </div><div class="line">    it(<span class="string">'should desialize the product correctly'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      expect(state.products[<span class="number">924</span>]).toEqual(&#123;</div><div class="line">        id: <span class="number">924</span>,</div><div class="line">        name: <span class="string">'Carrots'</span>,</div><div class="line">        price: <span class="number">1.50</span></div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥,ç°åœ¨å¦‚æœä½ åœ¨è®¢å•ä¸­ä¼ é€’æ–‡ç« å¼€å¤´çš„æ•°æ®,å»åºåˆ—åŒ–,redux storeçœ‹èµ·æ¥åƒè¿™æ ·</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;  </div><div class="line">  <span class="attribute">orders</span>: &#123;</div><div class="line">    <span class="number">10</span>: &#123;</div><div class="line">      <span class="attribute">id</span>: <span class="number">10</span>,</div><div class="line">      <span class="attribute">line_items</span>: [ <span class="number">483</span> ]<span class="comment">//å…³è”åˆ°lineItemsçš„483</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attribute">lineItems</span>: &#123;</div><div class="line">    <span class="number">483</span>: &#123;</div><div class="line">      <span class="attribute">id</span>: <span class="number">483</span>,</div><div class="line">      <span class="attribute">quantity</span>: <span class="number">2</span>,</div><div class="line">      <span class="attribute">product</span>: <span class="number">924</span> <span class="comment">//å…³è”åˆ°product 924</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attribute">products</span>: &#123;</div><div class="line">    <span class="number">924</span>: &#123;</div><div class="line">      <span class="attribute">id</span>: <span class="number">924</span>,</div><div class="line">      <span class="attribute">name</span>: <span class="string">'Carrots'</span>,</div><div class="line">      <span class="attribute">price</span>: <span class="number">1.50</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢æ‰€æœ‰åœ¨javascript storeä¸­çš„ç»“æœè¡¨ç°çš„åƒæ˜¯ä¸€ä¸ªç®€å•çš„æ•°æ®åº“.ç°åœ¨åªè¦æˆ‘ä»¬çŸ¥é“æ¯ä¸€ä¸ªæƒ³æ›´æ–°çš„entityçš„id,æˆ‘ä»¬å°±å¯ä»¥åœ¨storeä¸­å‘ç°ä»–.ä¾‹å¦‚,åœ¨æ–°storeä¸­,å¦‚æœæˆ‘ä»¬æƒ³æ›´æ–°line itemçš„æ•°é‡,æˆ‘ä»¬ä¸åœ¨éœ€è¦çŸ¥é“å’Œä»–ç›¸å…³è”çš„è®¢å•id.</p>
<p>è¿™ä¸€åˆ‡éƒ½éå¸¸çš„ç²¾å½©,ä½†æ˜¯å¦‚æœæˆ‘æƒ³åœ¨storeä¹‹å¤–é‡æ„ä¸€ä¸ªè®¢å•?æˆ‘ä»¬çš„è§£å†³åŠæ³•æ˜¯åˆ›å»ºä¸€äº›åŠ©æ‰‹ class(helper class).ä¸‹é¢çš„ä¾‹å­ç›¸å½“çš„ç®€å•,ä½†æ˜¯è¿™äº›classeså¯ä»¥å¸®åŠ©æ”¹è¿›ä¸€ä¸‹å¤æ‚çš„æ–¹æ³•.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">orderHelper</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(store) &#123;</div><div class="line">    <span class="keyword">this</span>.store = store;</div><div class="line">    <span class="comment">// We store the current order id on the store too</span></div><div class="line">    <span class="comment">//åœ¨storeä¸­å‚¨å­˜å½“å‰è®¢å•id   </span></div><div class="line">    <span class="keyword">this</span>.currentOrder = store.orders[store.currentOrderId];</div><div class="line">  &#125;</div><div class="line">  currentLineItems() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.currentOrder.lineItems.map(lineItemId =&gt;</div><div class="line">      <span class="keyword">return</span> (<span class="keyword">this</span>.store.lineItems[liId])</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬çœ‹çœ‹,å¦‚æœæˆ‘ä»¬æ„å»ºä¸€ä¸ªç»„ä»¶æ¥æ˜¾ç¤ºitemsçš„æ€»æ•°é‡,ä½ å¯ä»¥è¿™æ ·é…ç½®</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React       <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> OrderHelper <span class="keyword">from</span> <span class="string">'./path/to/orderHelper'</span>;</div><div class="line"><span class="comment">// First of all we create the React Component</span></div><div class="line"><span class="comment">//åˆ›å»ºReact ç»„ä»¶</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderCount</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> propTypes = &#123;</div><div class="line">    <span class="attr">lineItems</span>: React.PropTypes.array.isRequired,</div><div class="line">  &#125;</div><div class="line">  totalQuantity() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.lineItems.reduce(<span class="function">(<span class="params">total, lineItem</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> (total + lineItem.quantity);</div><div class="line">    &#125;, <span class="number">0</span>); </div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="comment">// We're using the jsx format</span></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.totalQuantity() &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// We now bind the component to the redux store</span></div><div class="line"><span class="comment">//è¿æ¥ç»„ä»¶åˆ°reduxçš„storeä¸­</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> helper = <span class="keyword">new</span> OrderHelper(state);</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">lineItems</span>: helper.currentLineItems(),</div><div class="line">  &#125;</div><div class="line">&#125;)(OrderCount);</div></pre></td></tr></table></figure>
<p>å¦‚æœå…¶ä»–çš„ç»„ä»¶æ›´æ–°äº†è”ç³»åˆ°è¿™ä¸ªstoreçš„line itemsæ—¶,è¿™ä¸ªç»„ä»¶å°†ä¼šæ›´æ–°.</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢,æˆ‘ä»¬å·²ç»å‘ç°è¿™ç§å½¢å¼ä½¿ç”¨èµ·æ¥éå¸¸çš„ç®€å•.æˆ‘ä»¬çš„reducersä»…ä»…å…³æ³¨storeä¸­çš„ç»“æ„æ•°æ®,éå¸¸å®¹æ˜“æµ‹è¯•,å› ä¸ºä»–ä»¬æ˜¯vanilla.js,ä¸å’ŒDomæˆ–å…¶ä»–å†…å®¹äº¤äº’.æˆ‘ä»¬å¯ä»¥æŠŠReactå˜ä¸ºå…¶ä»–çš„æ¡†æ¶,ä»ç„¶ä½¿ç”¨ç›¸åŒçš„reducerså’Œactions</p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>   åœ¨appä¸­æ”¹ç”¨Redux,ä½¿æˆ‘ä»¬æ€è€ƒappçš„ä¸åŒç»“æ„æ–¹å¼.ä»appå…¶ä»–éƒ¨åˆ†æŠŠRedux(è¿˜æœ‰ reducers,actions)åˆ†ç¦»å‡ºæ¥,è¿™ä¸ªè¿‡ç¨‹ç»™äº†æˆ‘ä»¬ç»§ç»­æ„å»ºçš„ä¿¡å¿ƒ,å³ä½¿ä¸ä½¿ç”¨React,æˆ‘ä»¬æ„å»ºçš„å•å…ƒæµ‹è¯•è®©äººæ„Ÿè§‰å¾ˆèˆ’æœ,ä½¿ç”¨normalizr.jsæ”¹è¿›äº†æˆ‘ä»¬ç»„ç»‡æ•°æ®çš„æ–¹å¼.<br>   è™½ç„¶è¿™ä¸ªé¡¹ç›®ç›®å‰è¿˜åœ¨ç»§ç»­è¿›å±•ä¸­,ä½†æ˜¯æˆªè‡³ç›®å‰æˆ‘ä»¬åšçš„å·²ç»å¤Ÿçš„ä¸Šç²¾å½©äº†.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŸæ–‡è¯·&lt;a href=&quot;https://medium.com/farmdrop/using-normalizr-js-in-a-redux-store-96ab33991369&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å‚è§&lt;
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Reduxå’ŒGraphQLå…¥é—¨</title>
    <link href="https://phpsmarter.github.com/2017/04/11/%E7%BF%BB%E8%AF%91-Redux%E5%92%8CGraphQL%E5%85%A5%E9%97%A8/"/>
    <id>https://phpsmarter.github.com/2017/04/11/ç¿»è¯‘-Reduxå’ŒGraphQLå…¥é—¨/</id>
    <published>2017-04-11T15:09:32.000Z</published>
    <updated>2017-04-11T16:20:13.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å½“GraphQLå‘å¸ƒä»¥æ¥,éå¸¸æ¸…æ¥šçš„æ˜¾ç¤ºå‡º,ä»–å°†ä¼šæˆä¸ºéå¸¸å¥½çš„æŠ€æœ¯.ç¤¾åŒºéƒ½åœ¨è€å¿ƒçš„ç­‰å¾…æŠ€æœ¯è¯„ä»·.<br>ä½†æ˜¯ä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·,å‘ç°æ–‡æ¡£æ¯”æˆ‘ä»¬æœŸå¾…çš„æ›´éš¾ç†è§£.å¯èƒ½çš„åŸå› æ˜¯ç”±äºGraphQLå’ŒRelayçš„è”åˆä½¿ç”¨.</p>
</blockquote>
<p>æˆ‘ä¹Ÿæ„Ÿè§‰åˆ°äº†ä½ çš„ç—›è‹¦.æˆ‘çš„å¤§è„‘éƒ½è¦èåŒ–æ‰äº†,æˆ‘å‘Šè¯‰æˆ‘è‡ªå·±æˆ‘å°†ä¼šå°è¯•åœ¨å…¶ä»–çš„æ¡†æ¶é‡Œæ˜¯ç”¨å®ƒ.æˆ‘åšåˆ°äº†!è¿™ä¸€æ¬¡æˆ‘ä»…ä»…æŠŠå…³æ³¨ç‚¹æ”¾åœ¨GraphQLè‡ªèº«,å…¶ä»–çš„åœ°æ–¹ä¿æŒå°½å¯èƒ½çš„ç®€å•.</p>
<h1 id="Sharing-is-Caring"><a href="#Sharing-is-Caring" class="headerlink" title="Sharing is Caring"></a>Sharing is Caring</h1><p>è¿™ä¸ªæ•™ç¨‹çš„é…ç½®éƒ¨åˆ†å°½å¯èƒ½çš„ç®€å•,ç»“åˆGraphQLå’ŒRedux.å‡å°‘å¤æ‚çš„éƒ¨åˆ†,æ‰€æœ‰çš„å†…å®¹ä½ å¯ä»¥ç›´æ¥ä»è¿™é‡Œçœ‹åˆ°(æŒ‡ä»£ç éƒ¨åˆ†).</p>
<p>æˆ‘ä»¬å°†ä½¿ç”¨Reduxæ¥ä»£æ›¿Relay,åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨es5è€Œä¸æ˜¯es6/babel-node.æ‰€æœ‰çš„GraphQLçš„ä¸œè¥¿éƒ½ä¿æŒå°½å¯èƒ½çš„ç®€å•.</p>
<p>ä¸‹é¢é…ç½®ä¸€ä¸‹é¡¹ç›®</p>
<h1 id="é¡¹ç›®æ–‡ä»¶é…ç½®"><a href="#é¡¹ç›®æ–‡ä»¶é…ç½®" class="headerlink" title="é¡¹ç›®æ–‡ä»¶é…ç½®"></a>é¡¹ç›®æ–‡ä»¶é…ç½®</h1><p>åˆ›å»ºæ–°æ–‡ä»¶ä»¶(graphql-app).<br>éœ€è¦ä¸€ä¸ªpackage.json.<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">npm</span> init</div></pre></td></tr></table></figure></p>
<p>éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ä¸€ä¸‹æ¨¡å—:graphql-js,express-graphql,express,webpackå’Œwebpack-dev-server.</p>
<p>ç¼–å†™æœåŠ¡å™¨çš„ç¼–ç ä½¿ç”¨es5,é¿å…ç¼–è¯‘è¿‡ç¨‹.</p>
<p>åˆ›å»º<code>sevsr.js</code>æ–‡ä»¶,å¯¼å…¥æˆ‘ä»¬å®‰è£…çš„æ¨¡å—<br><code>server.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> webpack = <span class="built_in">require</span>(â€˜webpackâ€™);</div><div class="line"><span class="keyword">var</span> WebpackDevServer = <span class="built_in">require</span>(â€˜webpack-dev-serverâ€™);</div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(â€˜expressâ€™);</div><div class="line"><span class="keyword">var</span> graphqlHTTP = <span class="built_in">require</span>(â€˜express-graphqlâ€™);</div><div class="line"><span class="keyword">var</span> graphql = <span class="built_in">require</span>(â€˜graphqlâ€™);</div><div class="line"><span class="comment">//ä¸‹é¢æ˜¯æœ‰å…³graphqlä½¿ç”¨çš„é…ç½®,æœ‰å¯¹è±¡å’Œç±»å‹</span></div><div class="line"><span class="keyword">var</span> GraphQLSchema = graphql.GraphQLSchema;</div><div class="line"><span class="keyword">var</span> GraphQLObjectType = graphql.GraphQLObjectType;</div><div class="line"><span class="keyword">var</span> GraphQLString = graphql.GraphQLString;</div><div class="line"><span class="keyword">var</span> GraphQLInt = graphql.GraphQLInt;</div></pre></td></tr></table></figure></p>
<p>ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»™graphQLçš„ç±»å‹å®šä¹‰äº†å˜é‡,åé¢æˆ‘ä»¬è¦ä½¿ç”¨è¿™äº›å˜é‡.</p>
<p>æ¥ç€æˆ‘ä»¬ä¸ºGraphQLåˆ›å»ºå¯ä»¥è·å–çš„æ•°æ®.è¿™é‡Œä½¿ç”¨<code>Goldbergs</code>çš„æ•°æ®ä½œä¸ºæ¥æº.</p>
<p>æˆ‘ä»¬çš„æ•°æ®</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"> var goldbergs = &#123;</div><div class="line"> <span class="number">1</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Beverly Goldberg"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"Wendi McLendon-Covey"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"matriarch"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"embarrassing, overprotective"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">1</span></div><div class="line"> &#125;,</div><div class="line"> <span class="number">2</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Murray Goldberg"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"Jeff Garlin"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"patriarch"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"gruff, lazy"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">2</span></div><div class="line"> &#125;,</div><div class="line"> <span class="number">3</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Erica Goldberg"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"Hayley Orrantia"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"oldest child"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"rebellious, nonchalant"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">3</span></div><div class="line"> &#125;,</div><div class="line"> <span class="number">4</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Barry Goldberg"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"Troy Gentile"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"middle child"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"dim-witted, untalented"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">4</span></div><div class="line"> &#125;,</div><div class="line"> <span class="number">5</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Adam Goldberg"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"Sean Giambrone"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"youngest child"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"geeky, pop-culture obsessed"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">5</span></div><div class="line"> &#125;,</div><div class="line"> <span class="number">6</span>: &#123;</div><div class="line"><span class="symbol">   character:</span> <span class="string">"Albert 'Pops' Solomon"</span>,</div><div class="line"><span class="symbol">   actor:</span> <span class="string">"George Segal"</span>,</div><div class="line"><span class="symbol">   role:</span> <span class="string">"grandfather"</span>,</div><div class="line"><span class="symbol">   traits:</span> <span class="string">"goofy, laid back"</span>,</div><div class="line"><span class="symbol">   id:</span> <span class="number">6</span></div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="GraophQL"><a href="#GraophQL" class="headerlink" title="GraophQL"></a>GraophQL</h1><p>GraphQLä»ç®€åŒ–çš„è§’åº¦è€ƒè™‘,æœ‰ä¸€ä¸ªç±»å‹ç³»ç»Ÿæ„æˆ-è¿™æ˜¯æˆ‘ä»¬ç”¨æ¥ç†è§£ä»–çš„å¿ƒç†æ¨¡å‹-æˆ‘ä»¬å°†çœ‹åˆ°è¿™é‡Œæœ‰ä¸‰ç§â€ç±»å‹â€.</p>
<ol>
<li>æ¨¡å‹çš„ç±»å‹</li>
<li>æŸ¥è¯¢çš„ç±»å‹</li>
<li>schemaçš„ç±»å‹</li>
</ol>
<p>åœ¨å®é™…çš„ç¼–ç ä¸­,ç±»å‹å¯èƒ½æ¯”è¿™ä¸ªç®€å•,è¿™é‡Œåªæ˜¯ä¸ºäº†åˆ°å…¥é—¨çš„ç›®çš„,æ‰€ä»¥æ¯”è¾ƒç®€å•</p>
<h1 id="æ¨¡å‹çš„ç±»å‹"><a href="#æ¨¡å‹çš„ç±»å‹" class="headerlink" title="æ¨¡å‹çš„ç±»å‹"></a>æ¨¡å‹çš„ç±»å‹</h1><p>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªâ€æ¨¡å‹ç±»å‹â€,å®é™…ç›¸å½“äºå®é™…çš„æ•°æ®çš„é•œåƒ.</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"> var goldbergType = new GraphQLObjectType(&#123;</div><div class="line"><span class="symbol">  name:</span> <span class="string">"Goldberg"</span>,</div><div class="line"><span class="symbol">  description:</span> <span class="string">"Member of The Goldbergs"</span>,</div><div class="line"><span class="symbol">  fields:</span> &#123;</div><div class="line"><span class="symbol">   character:</span> &#123;</div><div class="line"><span class="symbol">     type:</span> GraphQLString,</div><div class="line"><span class="symbol">     description:</span> <span class="string">"Name of the character"</span>,</div><div class="line">   &#125;,</div><div class="line"><span class="symbol">   actor:</span> &#123;</div><div class="line"><span class="symbol">     type:</span> GraphQLString,</div><div class="line"><span class="symbol">     description:</span> <span class="string">"Actor playing the character"</span>,</div><div class="line">   &#125;,</div><div class="line"><span class="symbol">   role:</span> &#123;</div><div class="line"><span class="symbol">     type:</span> GraphQLString,</div><div class="line"><span class="symbol">     description:</span> <span class="string">"Family role"</span></div><div class="line">   &#125;,</div><div class="line"><span class="symbol">   traits:</span> &#123;</div><div class="line"><span class="symbol">     type:</span> GraphQLString,</div><div class="line"><span class="symbol">     description:</span> <span class="string">"Traits this Goldberg is known for"</span></div><div class="line">   &#125;,</div><div class="line"><span class="symbol">   id:</span> &#123;</div><div class="line"><span class="symbol">     type:</span> GraphQLInt,</div><div class="line"><span class="symbol">     description:</span> <span class="string">"ID of this Goldberg"</span></div><div class="line">   &#125;</div><div class="line"> &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªGraphQLObjectTypeçš„å¯¹è±¡å®ä¾‹,å–åä¸ºâ€Goldbergâ€.<br>åœ¨â€œfieldsâ€ä¸‹,æ¯ä¸€ä¸ªâ€œtypeâ€è¡¨æ˜ä¸€ä¸ªæœŸå¾…çš„ç±»å‹.ä¾‹å¦‚ string(GraphQLString)æœ€ä¸ºæ¼”å‘˜è§’è‰²çš„ç±»å‹,int(GraphQLInt)ä½œä¸ºIdçš„ç±»å‹çº¦æŸ.</p>
<p>ä½ å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†â€descriptionâ€å­—æ®µ,GraphQLè‡ªå¸¦è¯´æ˜æ–‡æ¡£.å½“æˆ‘ä»¬ç»“åˆexpress-graphqlä½¿ç”¨GraphiQLçš„æ—¶å€™å¯ä»¥åœ¨actionä¸­åˆšçœ‹åˆ°è¿™ä¸ªæè¿°å†…å®¹.</p>
<h1 id="Query-Type"><a href="#Query-Type" class="headerlink" title="Query Type"></a>Query Type</h1><p>â€œQuery typeâ€å®šä¹‰äº†æˆ‘ä»¬æ€ä¹ˆæŸ¥è¯¢æˆ‘ä»¬çš„æ•°æ®<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var queryType = new GraphQLObjectType(&#123;</div><div class="line"><span class="symbol">  name:</span> <span class="string">"query"</span>,</div><div class="line"><span class="symbol">  description:</span> <span class="string">"Goldberg query"</span>,</div><div class="line"><span class="symbol">  fields:</span> &#123;</div><div class="line"><span class="symbol">    goldberg:</span> &#123;</div><div class="line"><span class="symbol">      type:</span> goldbergType,</div><div class="line"><span class="symbol">      args:</span> &#123;</div><div class="line"><span class="symbol">        id:</span> &#123;</div><div class="line"><span class="symbol">          type:</span> GraphQLInt</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line"><span class="symbol">      resolve:</span> function(_, args)&#123;</div><div class="line">        return getGoldberg(args.id)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>â€œquery typeâ€ä¹Ÿæ˜¯GraphQLObjectTypeçš„å®ä¾‹.åªæ˜¯ç”¨äºä¸åŒçš„ç›®çš„.<br>æˆ‘ä»¬åˆ›å»ºgoldbergè¿™ä¸ªæŸ¥è¯¢å­—æ®µ,è®¾å®šçš„ç±»å‹æ˜¯goldbergType.åœ¨args(å‚æ•°)ä¸‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–°çš„goldbergå­—æ®µ,å®ƒå°†æ¥å—idä½œä¸ºå‚æ•°.</p>
<p>ä½†æˆ‘ä»¬è§£ææŸ¥è¯¢çš„æ—¶å€™,æˆ‘ä»¬è¿”å›gegGoldberg()å‡½æ•°çš„è°ƒç”¨è¿”å›å€¼</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">function</span> <span class="title">getGoldberg</span>(id) &#123;</div><div class="line"> <span class="keyword">return</span> <span class="type">goldbergs[id]</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»æŸ¥è¯¢ä¸­çš„idä»dataä¸­è¿”å›å…¶ä¸­ä¸€ä¸ªGoldberg.</p>
<h1 id="Schema-type"><a href="#Schema-type" class="headerlink" title="Schema type"></a>Schema type</h1><p>æœ€ç»ˆâ€schema typeâ€æŠŠç±»å‹æ”¾åˆ°ä¸€èµ·.</p>
<h1 id="ä¸ºschemaæä¾›æœåŠ¡"><a href="#ä¸ºschemaæä¾›æœåŠ¡" class="headerlink" title="ä¸ºschemaæä¾›æœåŠ¡"></a>ä¸ºschemaæä¾›æœåŠ¡</h1><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨expresså’ŒgraphqlHTTP ä¸­é—´ä»¶æ¥æä¾›schmaæœåŠ¡.<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> var graphQLServer = express()<span class="comment">;</span></div><div class="line">graphQLServer.use(<span class="string">'/'</span>, graphqlHTTP(&#123; <span class="keyword">schema: </span><span class="keyword">schema, </span>graphiql: true &#125;))<span class="comment">;</span></div><div class="line">graphQLServer.listen(<span class="number">8080</span>)<span class="comment">;</span></div><div class="line">console.log(<span class="string">"The GraphQL Server is running."</span>)</div></pre></td></tr></table></figure></p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">node</span> <span class="title">server</span></div></pre></td></tr></table></figure>
<p>æµè§ˆå™¨æ‰“å¼€<a href="http://localhost:8080/" target="_blank" rel="external">http://localhost:8080/</a>.å¯ä»¥çœ‹åˆ°GraphiQL IDEå·¥ä½œäº†.<br>å¦‚æœæˆ‘ä»¬æ‰§è¡Œäº†æŸ¥è¯¢<br><figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> &#123; </div><div class="line"> goldberg(<span class="name">id:</span> <span class="number">2</span>) &#123; </div><div class="line">   id,</div><div class="line">   character</div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿”å›çš„ç»“æœæ˜¯<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line"> <span class="attr">"data"</span>: &#123;</div><div class="line">   <span class="attr">"goldberg"</span>: &#123;</div><div class="line">     <span class="attr">"id"</span>: <span class="number">2</span>,</div><div class="line">     <span class="attr">"character"</span>: <span class="string">"Murray Goldberg"</span></div><div class="line">   &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å†åšä¸€äº›å…¶ä»–æŸ¥è¯¢ä¹Ÿéå¸¸çš„æœ‰æ„æ€.</p>
<p><code>æç¤ºï¼š</code>åœ¨å±å¹•çš„é¡¶éƒ¨å³è¾¹ï¼Œæœ‰ä¸€ä¸ªæŒ‰é’®,æ ‡ç­¾ä¸ºâ€Docsâ€,å¦‚æœæˆ‘ä»¬ç‚¹å‡»æŒ‰é’®,å¯ä»¥çœ‹åˆ°ä¹‹å‰åœ¨â€descriptionâ€ä¸­æ·»åŠ çš„å­—æ®µå†…å®¹.å¯ä»¥æ¢ç´¢ä¸€ä¸‹æ–‡æ¡£.</p>
<h2 id="ä¸ºappæä¾›æœåŠ¡"><a href="#ä¸ºappæä¾›æœåŠ¡" class="headerlink" title="ä¸ºappæä¾›æœåŠ¡"></a>ä¸ºappæä¾›æœåŠ¡</h2><p>ä¸ºäº†åœ¨æˆ‘ä»¬appçš„å‰ç«¯ä½¿ç”¨GraphQL,éœ€è¦å®‰è£…babel,babel-loaderä»¥åŠä¸€ç»„babel-presetsçš„çº¦å®š.</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install </span>--save-dev <span class="keyword">babel-core </span><span class="keyword">babel-loader </span><span class="keyword">babel-preset-es2015 </span><span class="keyword">babel-preset-stage-0 </span><span class="keyword">babel-preset-react</span></div></pre></td></tr></table></figure>
<p>åˆ›å»ºæ–‡ä»¶<code>.babelrc</code>,è¿™ä¸ªæ–‡ä»¶å‘Šè¯‰babel,æˆ‘ä»¬çš„é¢„å…ˆè®¾å®š.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line"> <span class="attr">"presets"</span>: [<span class="string">"es2015"</span>, <span class="string">"stage-0"</span>, <span class="string">"react"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>index.js</code>æ–‡ä»¶.ç›®å‰è¿˜æ²¡æœ‰å†…å®¹.</p>
<p>åˆ›å»ºæ–°çš„æ–‡ä»¶å¤¹<code>static</code>,åœ¨æ–‡ä»¶å¤¹ä¸­æ·»åŠ <code>index.html</code>æ–‡ä»¶.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„çœ‹èµ·æ¥åƒè¿™æ ·<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">graphql-app</div><div class="line"><span class="string">| -- index.js</span></div><div class="line"><span class="string">| -- server.js</span></div><div class="line"><span class="string">| -- package.json</span></div><div class="line"><span class="string">| -- .babelrc</span></div><div class="line"><span class="string">| -- static</span></div><div class="line">   <span class="string">| -- index.hml</span></div></pre></td></tr></table></figure></p>
<p>åœ¨server.jsæ–‡ä»¶ä¸­,æˆ‘ä»¬éœ€è¦é…ç½®webpack,å€ŸåŠ©babelæ‰“åŒ…é¡¹ç›®çš„jsæ–‡ä»¶.</p>
<p>åœ¨graphQLServer.listen(8080)ä¸‹<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> var compiler = webpack(&#123;</div><div class="line"><span class="symbol">  entry:</span> <span class="string">"./index.js"</span>,</div><div class="line"><span class="symbol">  output:</span> &#123;</div><div class="line"><span class="symbol">    path:</span> __dirname,</div><div class="line"><span class="symbol">    filename:</span> <span class="string">"bundle.js"</span>,</div><div class="line"><span class="symbol">    publicPath:</span> <span class="string">"/static/"</span></div><div class="line">  &#125;,</div><div class="line"><span class="symbol">  module:</span> &#123;</div><div class="line"><span class="symbol">    loaders:</span> [</div><div class="line">      &#123; test: /\.js$/, </div><div class="line"><span class="symbol">        exclude:</span> /node_modules/, </div><div class="line"><span class="symbol">        loader:</span> <span class="string">"babel-loader"</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>Webpack å°†ä¼šæ¥å—index.jsæ–‡ä»¶ï¼Œç¼–è¯‘ä¸€ä¸ªestçš„ç‰ˆæœ¬åˆ°/static/bundle.jsæ–‡ä»¶.</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„WebpackDevServer æ¥æä¾›bundledçš„é¡¹ç›®.</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> <span class="keyword">app</span> = new WebpackDevServer(compiler, &#123;</div><div class="line"> contentBase: <span class="string">"/public/"</span>,</div><div class="line"> proxy: &#123;<span class="string">"/graphql"</span>: `http:<span class="comment">//localhost:$&#123;8080&#125;`&#125;,</span></div><div class="line"> publicPath: <span class="string">"/static/"</span>,</div><div class="line"> stats: &#123;colors: true&#125;</div><div class="line">&#125;);</div><div class="line"><span class="keyword">app</span>.<span class="keyword">use</span>(<span class="string">"/"</span>, express.static(<span class="string">"static"</span>));</div><div class="line"><span class="keyword">app</span>.listen(3000);</div><div class="line">console.<span class="built_in">log</span>(<span class="string">"The App Server is running."</span>)</div></pre></td></tr></table></figure>
<p>proxyå­—æ®µæ·»åŠ äº†æˆ‘ä»¬å·²ç»åˆ›å»ºçš„GraphQLæœåŠ¡åˆ°æˆ‘ä»¬çš„app server,è¿™å¯ä»¥ä½¿æˆ‘ä»¬ç›´æ¥åœ¨appå†…éƒ¨è¿›è¡ŒæŸ¥è¯¢,ä¸ä¼šæœ‰è·¨åŸŸé—®é¢˜.</p>
<p>å¯åŠ¨ä¸€ä¸‹<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">noder <span class="keyword">server</span></div></pre></td></tr></table></figure></p>
<p>æµè§ˆå™¨æ‰“å¼€<a href="http://localhost:3000" target="_blank" rel="external">http://localhost:3000</a>,æˆ‘ä»¬ä¼šçœ‹åˆ°â€hello worldâ€çš„æ¶ˆæ¯.<br>å†åˆ°<a href="http://localhost:3000/graphql" target="_blank" rel="external">http://localhost:3000/graphql</a>.</p>
<h1 id="Reactå’ŒRedux"><a href="#Reactå’ŒRedux" class="headerlink" title="Reactå’ŒRedux"></a>Reactå’ŒRedux</h1><p>ä¸ºäº†æ·»åŠ reactå’Œreact-redux,appéœ€è¦é¢å¤–çš„ç»„ä»¶:React,Redux,React-Redux,Redux-thunkå’ŒImmutable.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> <span class="comment">--save react react-dom redux react-redux redux-thunk immutable</span></div></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨babelé…ç½®äº†webpack,æˆ‘ä»¬å¯ä»¥åœ¨å‰ç«¯ä½¿ç”¨es6</p>
<p>ä»static/index.htmlæ–‡ä»¶ä¸­åˆ é™¤æ‰â€hello worldâ€,ä½¿ç”¨Reactæ·»åŠ æ–°çš„ä¿¡æ¯.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</div><div class="line"><span class="keyword">const</span> Main = React.createClass(&#123;</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello react!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">ReactDOM.render(</div><div class="line"> <span class="xml"><span class="tag">&lt;<span class="name">Main</span> /&gt;</span>,</span></div><div class="line"> document.getElementById("example")</div><div class="line">);</div></pre></td></tr></table></figure>
<p>é‡æ–°å¯åŠ¨<a href="http://localhost:3000" target="_blank" rel="external">localhost:300</a>,å¯ä»¥çœ‹åˆ°ä¿¡æ¯.</p>
<h1 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h1><p>æ·»åŠ æ–°çš„æ–‡ä»¶å¤¹,å–åâ€appâ€æœ€ä¸ºå­æ–‡ä»¶å¤¹<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">| -- app</span></div><div class="line">  <span class="string">| -- actions</span></div><div class="line">  <span class="string">| -- components</span></div><div class="line">  <span class="string">| -- reducers</span></div></pre></td></tr></table></figure></p>
<p>åœ¨reducerS æ–‡ä»¶å¤¹ä¸­åˆ›å»ºreducer.jsçš„æ–‡ä»¶,é‡Œé¢å°†æ‰§è¡Œæˆ‘ä»¬çš„reducerå‡½æ•°.</p>
<p>æˆ‘ä»¬ä¼šä½¿ç”¨åˆ©ç”¨Immuatableæ¨¡å—ä¸ºstateæœåŠ¡,ä»¥ä¾¿æˆ‘ä»¬å½¢æˆå¥½çš„ä¹ æƒ¯.<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> <span class="keyword">Immutable</span> <span class="keyword">from</span> <span class="string">"immutable"</span>;</div><div class="line">const immutableState = <span class="keyword">Immutable</span>.Map(&#123;</div><div class="line">  fetching: <span class="keyword">false</span>,</div><div class="line">  data: <span class="keyword">Immutable</span>.Map(&#123;&#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çš„stateæœ‰ä¸¤ä¸ªå­—æ®µ-ä¸€ä¸ªè®©æˆ‘ä»¬çŸ¥é“æ˜¯å¦åœ¨æŸ¥è¯¢/ç­‰å¾…å“åº”çš„ä¸­é—´é˜¶æ®µ,å¦ä¸€ä¸ªåŒ…å«ç€è¿”å›çš„å“åº”æ•°æ®.</p>
<p>ä¸‹ä¸€æ­¥æˆ‘ä¹ˆæŠŠImmutableStateæ·»åŠ åˆ°reducer å‡½æ•°ä¸­<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> export const queryReducer = (<span class="keyword">state</span> = immutableState, action) =&gt; &#123;</div><div class="line">  switch (action.type) &#123;</div><div class="line">    case <span class="string">"STARTING_REQUEST"</span>:</div><div class="line">      return <span class="keyword">state</span>.<span class="built_in">set</span>(<span class="string">"fetching"</span>, true);</div><div class="line">    case <span class="string">"FINISHED_REQUEST"</span>:</div><div class="line">      return <span class="keyword">state</span>.<span class="built_in">set</span>(<span class="string">"fetching"</span>, false)</div><div class="line">             .<span class="built_in">set</span>(<span class="string">"data"</span>, Immutable.Map(action.response.data.goldberg));</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      return <span class="keyword">state</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å½“æˆ‘ä»¬åœ¨æ‰§è¡Œâ€œSTARING_REQUESTâ€ actionçš„æ—¶å€™,åˆ†å‘çš„åŠ¨ä½œæ”¹å˜â€fecthingâ€çš„state ä¸ºtrue,è¡¨ç¤ºåœ¨è·å–æ•°æ®ä¸­.</p>
<p>å½“æ‰§è¡Œâ€œFINISHED_REQUESTâ€ actionçš„æ—¶å€™,åˆ†å‘çš„å·¥ä½œæ”¹å˜ â€œfechingâ€çš„stateä¸ºfalse,dataçš„stateè®¾å®šä¸ºæˆ‘ä»¬çš„å“åº”æ•°æ®.</p>
<h1 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h1><p>è¿”å›åˆ°index.jsæ–‡ä»¶,æˆ‘ä»¬æƒ³åœ¨reducerä¹‹å¤–åˆ›å»ºstore,storeæ¥å…¥åˆ°æˆ‘ä»¬çš„ä¸»ç»„ä»¶.æˆ‘ä»¬éœ€è¦å€ŸåŠ©reduxå’Œreact-reduxçš„åŠ©æ‰‹å‡½æ•°æ¥æŠŠåˆšåˆšåˆ›å»ºçš„reducerå¯¼å…¥store.</p>
<p>è¿˜éœ€è¦ä½¿ç”¨redux-thunk ä¸­é—´ä»¶æ¥ååŠ©åé¢çš„æ•°æ®è¯·æ±‚åŠ¨è¿‡.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">"redux"</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">"react-redux"</span>;</div><div class="line"><span class="keyword">import</span> &#123; queryReducer &#125; <span class="keyword">from</span> <span class="string">"./app/reducers/reducers.js"</span>;</div><div class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">"redux-thunk"</span>;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆæˆ‘ä»¬åº”ç”¨redux-thunkä¸­é—´ä»¶<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> const createStoreWithMiddleware = applyMiddleware(</div><div class="line">  <span class="name">thunkMiddleware</span></div><div class="line">)(<span class="name">createStore</span>)</div></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨Redux Providerä¸­åŒ…è£…æˆ‘ä»¬çš„ä¸»ç»„ä»¶,ä¼ é€’queryReduceråˆ°createStoreWithMiddleware.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ReactDOM.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;createStoreWithMiddleware(queryReducer)&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">Main</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"example"</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>å®Œæˆäº†ï¼åˆ›å»ºäº†store.</p>
<h1 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h1><p>åœ¨actionsæ–‡ä»¶å¤¹ä¸­åˆ›å»ºæ–°æ–‡ä»¶actions.js</p>
<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªactionæ¥åˆ†å‘åŠ¨ä½œåˆ°æˆ‘ä»¬çš„reducer,å…¶ä¸­ä¹‹ä¸€ä¸ºâ€œSTARTING_REQUESTâ€,å¦ä¸€ä¸ªä¸ºâ€FINISHED_REQUESâ€<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> startingRequest = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">"STARTING_REQUEST"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> finishedRequest = <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">"FINISHED_REQUEST"</span>,</div><div class="line">    <span class="attr">response</span>: response</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨storeä¸­ä¹‹å‰åº”ç”¨çš„ä¸­é—´ä»¶redux-thunkæ˜¯ä¸€ä»¶éå¸¸ä¼Ÿå¤§çš„äº‹æƒ…,å½“ä¸€ä¸ªactionè¿”å›ä¸€ä¸ªå‡½æ•°,è¿™ä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨dispatchæ¥æ³¨å…¥åˆ°reducer.(è¯‘æ³¨:å¯¹äºä¸€éƒ¨æ“ä½œ,è¿”å›å“åº”å€¼ä»¥å,å¯ä»¥åœ¨å‘èµ·ä¸€ä¸ªdispatchæ¥é€šçŸ¥reducerå¯¹stateåšå‡ºæ”¹å˜).</p>
<p>åœ¨ä¸€ä¸ªæ–°çš„getGraph actionä¸­,ä½¿ç”¨äº†ä¸¤æ¬¡dispatch()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getGraph = <span class="function">(<span class="params">payload</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</div><div class="line">    dispatch(startingRequest());</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">      <span class="keyword">let</span> request=<span class="keyword">new</span> XMLHttpRequest();</div><div class="line">      request.open(<span class="string">"POST"</span>, <span class="string">"/graphql"</span>, <span class="literal">true</span>);</div><div class="line">      request.setRequestHeader(<span class="string">"Content-Type"</span>,</div><div class="line">                               <span class="string">"application/graphql"</span>);</div><div class="line">      request.send(payload);</div><div class="line">      request.onreadystatechange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (request.readyState === <span class="number">4</span>) &#123;</div><div class="line">          resolve(request.responseText)</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;).then(<span class="function"><span class="params">response</span> =&gt;</span></div><div class="line">            dispatch(finishedRequest(<span class="built_in">JSON</span>.parse(response))))</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“getGraph()å‡½æ•°è°ƒç”¨çš„æ—¶å€™,æˆ‘ä»¬dispatch startingRequest(),è¡¨ç¤ºå¼€å§‹ä¸€ä¸ªæ–°çš„æŸ¥è¯¢.ç„¶åå¼€å§‹ä¸€ä¸ªå¼‚æ­¥çš„è¯·æ±‚(æç¤º:â€headerâ€ä¸­æœ‰application/graphqlçš„ç±»å‹).å½“æˆ‘ä»¬çš„æŸ¥è¯¢å®Œæˆçš„æ—¶å€™,æˆ‘ä»¬dispatch finishedRequest() actionï¼Œæä¾›æˆ‘ä»¬æŸ¥è¯¢çš„ç»“æœ.</p>
<h1 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h1><p>åœ¨â€componentâ€æ–‡ä»¶å¤¹ä¸­,æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶, Query.jsæ–‡ä»¶</p>
<p>æˆ‘ä»¬éœ€è¦å¯¼å…¥react,å‡ ä¸ªåŠ©æ‰‹å‡½æ•°,è¿˜æœ‰åˆšåˆšåˆ›å»ºçš„getGraphå‡½æ•°.</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> â€˜reactâ€™;</div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> â€˜react-reduxâ€™;</div><div class="line"><span class="keyword">import</span> &#123; getGraph &#125; <span class="keyword">from</span> â€˜../actions/actions.jsâ€™;</div></pre></td></tr></table></figure>
<p>ç›®å‰æˆ‘ä»¬åˆ›å»ºäº†ç©ºçš„å‡ºæŸ¥è¯¢ç»„ä»¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Query = React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬è¦åœ¨ç»„ä»¶ä¸­æŒ‚è½½æˆ‘ä»¬çš„storeå’Œdispatchæ–¹æ³•,æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºcontainerç»„ä»¶å’Œreact-redux connect()å‡½æ•°</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">const mapStateToProps = (<span class="keyword">state</span>) =&gt; &#123;</div><div class="line">  return &#123;</div><div class="line">    store: <span class="keyword">state</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line">export const QueryContainer = connect(</div><div class="line"> mapStateToProps</div><div class="line">)(Query);</div></pre></td></tr></table></figure>
<p>åœ¨æˆ‘ä»¬çš„Queryç»„ä»¶ä¸­,æˆ‘ä»¬éœ€è¦æ¥å…¥componentDidMount ç”Ÿå‘½å‘¨æœŸå‡½æ•°,ä»è€Œå¯ä»¥åœ¨ç»„ä»¶æŒ‚è½½çš„æ—¶å€™è·å–æ•°æ®.</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Query = React.createClass(&#123;</div><div class="line">  componentDidMount() &#123;</div><div class="line">    this.props.dispatch(</div><div class="line">      getGraph(<span class="string">"&#123;goldberg(id: 2) &#123;id, character, actor&#125;&#125;"</span>)</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬è¦æ·»åŠ ç»„ä»¶æ¥ç”¨äºå¡«å……è·å–çš„å“åº”çš„æ•°æ®,ä¸€ä¸ªæäº¤é¢å¤–æŸ¥è¯¢çš„æŒ‰é’®.æˆ‘ä»¬æƒ³çŸ¥é“åœ¨æ•°æ®æŸ¥è¯¢è¿‡ç¨‹ä¸­çš„çŠ¶æ€,å¹¶ä¸”æ˜¾ç¤ºåœ¨é¡µé¢ä¸­.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Query = React.createClass(&#123;</div><div class="line">  componentDidMount() &#123;</div><div class="line">    <span class="keyword">this</span>.props.dispatch(</div><div class="line">      getGraph(<span class="string">"&#123;goldberg(id: 2) &#123;id, character, actor&#125;&#125;"</span>)</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">let</span> dispatch = <span class="keyword">this</span>.props.dispatch;</div><div class="line">    <span class="keyword">let</span> fetchInProgress = <span class="built_in">String</span>(<span class="keyword">this</span>.props.store.get(<span class="string">'fetching'</span>));</div><div class="line">    <span class="keyword">let</span> queryText;</div><div class="line">    <span class="keyword">let</span> goldberg = <span class="keyword">this</span>.props.store.get(<span class="string">'data'</span>).toObject();</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Fetch in progress: &#123;fetchInProgress&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123; goldberg.character &#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; goldberg.actor &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; goldberg.role &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; goldberg.traits &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;node</span> =&gt;</span> &#123;queryText = node&#125;&#125;&gt;<span class="tag">&lt;/<span class="name">input</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</div><div class="line">          dispatch(getGraph(queryText.value))&#125;</div><div class="line">        &#125;&gt;</div><div class="line">          query</div><div class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸€æ­¥åšå®Œä»¥å,æœ€åä¸€ä»¶äº‹æƒ…å°±æ˜¯æŠŠQueryContainerç»„ä»¶æ·»åŠ åˆ°æˆ‘ä»¬çš„ä¸»ç»„ä»¶.</p>
<p><code>index.js</code><br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; QueryContainer &#125; <span class="keyword">from</span> â€œ.<span class="regexp">/app/</span>components<span class="regexp">/Query.jsâ€;</span></div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨QueryConatinerç»„ä»¶æ›¿ä»£â€hello reactâ€ç»„ä»¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> Main = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">QueryContainer</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>å®Œæˆ!ç°åœ¨è¿è¡Œç¼–åˆ¶å¥½çš„GraphQLæŸ¥è¯¢å°±å¯ä»¥è·å¾—æ ¸å¿ƒå†…å®¹.è¯•ç€æŸ¥è¯¢ï¼š{gold-berg(id:4)}{id,charactar,actor,traits},çœ‹çœ‹å¯ä»¥è·å¾—ä»€ä¹ˆç»“æœ.</p>
<h1 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h1><p>æ„Ÿè°¢é˜…è¯»,æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹ä½ æœ‰å¸®åŠ©.ä½ å¯ä»¥åœ¨<a href="https://github.com/thisbejim/getting-started-with-redux-and-graphql" target="_blank" rel="external">è¿™é‡Œ</a>æŸ¥çœ‹æºä»£ç .ç°åœ¨æˆ‘ä»¬ä½¿ç”¨Reduxå’ŒGraphQLæ„å»ºäº†éå¸¸å¥½çš„app.</p>
<p>å¦å¤–æ„Ÿè°¢Dan AbramovæŒ‡å‡ºæ•™ç¨‹ä¸­çš„ä¸€ä¸ªé”™è¯¯.</p>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å½“GraphQLå‘å¸ƒä»¥æ¥,éå¸¸æ¸…æ¥šçš„æ˜¾ç¤ºå‡º,ä»–å°†ä¼šæˆä¸ºéå¸¸å¥½çš„æŠ€æœ¯.ç¤¾åŒºéƒ½åœ¨è€å¿ƒçš„ç­‰å¾…æŠ€æœ¯è¯„ä»·.&lt;br&gt;ä½†æ˜¯ä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·,å‘ç°æ–‡æ¡£æ¯”æˆ‘ä»¬æœŸå¾…çš„æ›´éš¾ç†è§£.å¯èƒ½çš„åŸå› æ˜¯ç”±äºGraphQLå’ŒRelayçš„è”åˆä½¿ç”¨.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>normalizr-Redux state flatten</title>
    <link href="https://phpsmarter.github.com/2017/04/08/normalizr-Redux-state-flatten/"/>
    <id>https://phpsmarter.github.com/2017/04/08/normalizr-Redux-state-flatten/</id>
    <published>2017-04-08T14:37:17.000Z</published>
    <updated>2017-04-08T06:47:31.000Z</updated>
    
    <content type="html"><![CDATA[<p> Normalizr Guide</p>
<h1 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h1><p>Consider a typical blog post. The API response for a single post might look something like this:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"id"</span>: <span class="string">"123"</span>,</div><div class="line">  <span class="attr">"author"</span>: &#123;</div><div class="line">    <span class="attr">"id"</span>: <span class="string">"1"</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"Paul"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"title"</span>: <span class="string">"My awesome blog post"</span>,</div><div class="line">  <span class="attr">"comments"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"id"</span>: <span class="string">"324"</span>,</div><div class="line">      <span class="attr">"commenter"</span>: &#123;</div><div class="line">        <span class="attr">"id"</span>: <span class="string">"2"</span>,</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Nicole"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>We have two nested entity types within our <code>article</code>: <code>users</code> and <code>comments</code>. Using various <code>schema</code>, we can normalize all three entity types down:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; normalize, schema &#125; <span class="keyword">from</span> <span class="string">'normalizr'</span>;</div><div class="line"></div><div class="line"><span class="comment">// Define a users schema</span></div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Define your comments schema</span></div><div class="line"><span class="keyword">const</span> comment = <span class="keyword">new</span> schema.Entity(<span class="string">'comments'</span>, &#123;</div><div class="line">  <span class="attr">commenter</span>: user</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// Define your article </span></div><div class="line"><span class="keyword">const</span> article = <span class="keyword">new</span> schema.Entity(<span class="string">'articles'</span>, &#123; </div><div class="line">  <span class="attr">author</span>: user,</div><div class="line">  <span class="attr">comments</span>: [ comment ]</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(originalData, article);</div></pre></td></tr></table></figure>
<p>Now, <code>normalizedData</code> will be:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">result</span>: <span class="string">"123"</span>,</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="string">"articles"</span>: &#123; </div><div class="line">      <span class="string">"123"</span>: &#123; </div><div class="line">        <span class="attr">id</span>: <span class="string">"123"</span>,</div><div class="line">        <span class="attr">author</span>: <span class="string">"1"</span>,</div><div class="line">        <span class="attr">title</span>: <span class="string">"My awesome blog post"</span>,</div><div class="line">        <span class="attr">comments</span>: [ <span class="string">"324"</span> ]</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="string">"users"</span>: &#123;</div><div class="line">      <span class="string">"1"</span>: &#123; <span class="string">"id"</span>: <span class="string">"1"</span>, <span class="string">"name"</span>: <span class="string">"Paul"</span> &#125;,</div><div class="line">      <span class="string">"2"</span>: &#123; <span class="string">"id"</span>: <span class="string">"2"</span>, <span class="string">"name"</span>: <span class="string">"Nicole"</span> &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="string">"comments"</span>: &#123;</div><div class="line">      <span class="string">"324"</span>: &#123; <span class="attr">id</span>: <span class="string">"324"</span>, <span class="string">"commenter"</span>: <span class="string">"2"</span> &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>Many APIs, public or not, return JSON data that has deeply nested objects. Using data in this kind of structure is often <a href="https://groups.google.com/forum/#!topic/reactjs/jbh50-GJxpg" target="_blank" rel="external">very difficult</a> for JavaScript applications, especially those using <a href="http://facebook.github.io/flux/" target="_blank" rel="external">Flux</a> or <a href="http://redux.js.org/" target="_blank" rel="external">Redux</a>.</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Normalizr is a small, but powerful utility for taking JSON with a schema definition and returning nested entities with their IDs, gathered in dictionaries.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>The following nested object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[&#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">title</span>: <span class="string">'Some Article'</span>,</div><div class="line">  <span class="attr">author</span>: &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'Dan'</span></div><div class="line">  &#125;</div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">title</span>: <span class="string">'Other Article'</span>,</div><div class="line">  <span class="attr">author</span>: &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'Dan'</span></div><div class="line">  &#125;</div><div class="line">&#125;]</div></pre></td></tr></table></figure>
<p>Can be normalized to:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">result</span>: [<span class="number">1</span>, <span class="number">2</span>],</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">articles</span>: &#123;</div><div class="line">      <span class="number">1</span>: &#123;</div><div class="line">        <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">title</span>: <span class="string">'Some Article'</span>,</div><div class="line">        <span class="attr">author</span>: <span class="number">1</span></div><div class="line">      &#125;,</div><div class="line">      <span class="number">2</span>: &#123;</div><div class="line">        <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">        <span class="attr">title</span>: <span class="string">'Other Article'</span>,</div><div class="line">        <span class="attr">author</span>: <span class="number">1</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">users</span>: &#123;</div><div class="line">      <span class="number">1</span>: &#123;</div><div class="line">        <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">name</span>: <span class="string">'Dan'</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><ul>
<li><a href="#normalizedata-schema">normalize</a></li>
<li><a href="#denormalizeinput-schema-entities">denormalize</a></li>
<li><a href="#schema">schema</a><ul>
<li><a href="#arraydefinition-schemaattribute">Array</a></li>
<li><a href="#entitykey-definition---options--">Entity</a></li>
<li><a href="#objectdefinition">Object</a></li>
<li><a href="#uniondefinition-schemaattribute">Union</a></li>
<li><a href="#valuesdefinition-schemaattribute">Values</a></li>
</ul>
</li>
</ul>
<h2 id="normalize-data-schema"><a href="#normalize-data-schema" class="headerlink" title="normalize(data, schema)"></a><code>normalize(data, schema)</code></h2><p>Normalizes input data per the schema definition provided.</p>
<ul>
<li><code>data</code>: <strong>required</strong> Input JSON (or plain JS object) data that needs normalization.</li>
<li><code>schema</code>: <strong>required</strong> A schema definition</li>
</ul>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; normalize, schema &#125; <span class="keyword">from</span> <span class="string">'normalizr'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> myData = &#123; <span class="attr">users</span>: [ &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span> &#125; ] &#125;;</div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> mySchema = &#123; <span class="attr">users</span>: [ user ] &#125;</div><div class="line"><span class="keyword">const</span> normalizedData = normalize(myData, mySchema);</div></pre></td></tr></table></figure>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">result</span>: &#123; <span class="attr">users</span>: [ <span class="number">1</span>, <span class="number">2</span> ] &#125;,</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">users</span>: &#123;</div><div class="line">      <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;,</div><div class="line">      <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span> &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="denormalize-input-schema-entities"><a href="#denormalize-input-schema-entities" class="headerlink" title="denormalize(input, schema, entities)"></a><code>denormalize(input, schema, entities)</code></h2><p>Denormalizes an input based on schema and provided entities from a plain object or Immutable data. The reverse of <code>normalize</code>.</p>
<p><em>Special Note:</em> Be careful with denormalization. Prematurely reverting your data to large, nested objects could cause performance impacts in React (and other) applications.</p>
<p>If your schema and data have recursive references, only the first instance of an entity will be given. Subsequent references will be returned as the <code>id</code> provided.</p>
<ul>
<li><code>input</code>: <strong>required</strong> The normalized result that should be <em>de-normalized</em>. Usually the same value that was given in the <code>result</code> key of the output of <code>normalize</code>.</li>
<li><code>schema</code>: <strong>required</strong> A schema definition that was used to get the value for <code>input</code>.</li>
<li><code>entities</code>: <strong>required</strong> An object, keyed by entity schema names that may appear in the denormalized output. Also accepts an object with Immutable data.</li>
</ul>
<h3 id="Usage-1"><a href="#Usage-1" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; denormalize, schema &#125; <span class="keyword">from</span> <span class="string">'normalizr'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> mySchema = &#123; <span class="attr">users</span>: [ user ] &#125;</div><div class="line"><span class="keyword">const</span> entities = &#123; <span class="attr">users</span>: &#123; <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;, <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span> &#125; &#125; &#125;;</div><div class="line"><span class="keyword">const</span> denormalizedData = denormalize(&#123; <span class="attr">users</span>: [ <span class="number">1</span>, <span class="number">2</span> ] &#125;, mySchema, entities);</div></pre></td></tr></table></figure>
<h3 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">  <span class="attr">users</span>: [</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;,</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="schema"><a href="#schema" class="headerlink" title="schema"></a><code>schema</code></h2><h3 id="Array-definition-schemaAttribute"><a href="#Array-definition-schemaAttribute" class="headerlink" title="Array(definition, schemaAttribute)"></a><code>Array(definition, schemaAttribute)</code></h3><p>Creates a schema to normalize an array of entities. If the input value is an <code>Object</code> instead of an <code>Array</code>, the normalized result will be an <code>Array</code> of the <code>Object</code>â€˜s values. </p>
<p><em>Note: The same behavior can be defined with shorthand syntax: <code>[ mySchema ]</code></em></p>
<ul>
<li><code>definition</code>: <strong>required</strong> A singular schema that this array contains <em>or</em> a mapping of schema to attribute values.</li>
<li><code>schemaAttribute</code>: <em>optional</em> (required if <code>definition</code> is not a singular schema) The attribute on each entity found that defines what schema, per the definition mapping, to use when normalizing.<br>Can be a string or a function. If given a function, accepts the following arguments:  <ul>
<li><code>value</code>: The input value of the entity.</li>
<li><code>parent</code>: The parent object of the input array.</li>
<li><code>key</code>: The key at which the input array appears on the parent object.</li>
</ul>
</li>
</ul>
<h4 id="Instance-Methods"><a href="#Instance-Methods" class="headerlink" title="Instance Methods"></a>Instance Methods</h4><ul>
<li><code>define(definition)</code>: When used, the <code>definition</code> passed in will be merged with the original definition passed to the <code>Array</code> constructor. This method tends to be useful for creating circular references in schema.</li>
</ul>
<h4 id="Usage-2"><a href="#Usage-2" class="headerlink" title="Usage"></a>Usage</h4><p>To describe a simple array of a singular entity type:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = [ &#123; <span class="attr">id</span>: <span class="string">'123'</span>, <span class="attr">name</span>: <span class="string">'Jim'</span> &#125;, &#123; <span class="attr">id</span>: <span class="string">'456'</span>, <span class="attr">name</span>: <span class="string">'Jane'</span> &#125; ];</div><div class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> userListSchema = <span class="keyword">new</span> schema.Array(userSchema);</div><div class="line"><span class="comment">// or use shorthand syntax:</span></div><div class="line"><span class="keyword">const</span> userListSchema = [ userSchema ];</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, userListSchema);</div></pre></td></tr></table></figure>
<h4 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">users</span>: &#123;</div><div class="line">      <span class="string">'123'</span>: &#123; <span class="attr">id</span>: <span class="string">'123'</span>, <span class="attr">name</span>: <span class="string">'Jim'</span> &#125;,</div><div class="line">      <span class="string">'456'</span>: &#123; <span class="attr">id</span>: <span class="string">'456'</span>, <span class="attr">name</span>: <span class="string">'Jane'</span> &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: [ <span class="string">'123'</span>, <span class="string">'456'</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If your input data is an array of more than one type of entity, it is necessary to define a schema mapping. </p>
<p><em>Note: If your data returns an object that you did not provide a mapping for, the original object will be returned in the result and an entity will not be created.</em></p>
<p>For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = [ &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'admin'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">type</span>: <span class="string">'user'</span> &#125; ];</div><div class="line"></div><div class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> adminSchema = <span class="keyword">new</span> schema.Entity(<span class="string">'admins'</span>);</div><div class="line"><span class="keyword">const</span> myArray = <span class="keyword">new</span> schema.Array(&#123;</div><div class="line">  <span class="attr">admins</span>: adminSchema,</div><div class="line">  <span class="attr">users</span>: userSchema</div><div class="line">&#125;, (input, parent, key) =&gt; <span class="string">`<span class="subst">$&#123;input.type&#125;</span>s`</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, myArray);</div></pre></td></tr></table></figure>
<h4 id="Output-3"><a href="#Output-3" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">admins</span>: &#123; <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'admin'</span> &#125; &#125;,</div><div class="line">    <span class="attr">users</span>: &#123; <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">type</span>: <span class="string">'user'</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: [</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">schema</span>: <span class="string">'admins'</span> &#125;,</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">schema</span>: <span class="string">'users'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Entity-key-definition-options"><a href="#Entity-key-definition-options" class="headerlink" title="Entity(key, definition = {}, options = {})"></a><code>Entity(key, definition = {}, options = {})</code></h3><ul>
<li><code>key</code>: <strong>required</strong> The key name under which all entities of this type will be listed in the normalized response. Must be a string name.</li>
<li><code>definition</code>: A definition of the nested entities found within this entity. Defaults to empty object.<br>You <em>do not</em> need to define any keys in your entity other than those that hold nested entities. All other values will be copied to the normalized entityâ€™s output.</li>
<li><code>options</code>:<ul>
<li><code>idAttribute</code>: The attribute where unique IDs for each of this entity type can be found.<br>Accepts either a string key or a function. Defaults to <code>id</code>.<br>As a function, accepts the following arguments, in order: <ul>
<li><code>value</code>: The input value of the entity.</li>
<li><code>parent</code>: The parent object of the input array.</li>
<li><code>key</code>: The key at which the input array appears on the parent object.</li>
</ul>
</li>
<li><code>mergeStrategy(entityA, entityB)</code>: Strategy to use when merging two entities with the same <code>id</code> value. Defaults to merge the more recently found entity onto the previous.</li>
<li><code>processStrategy(value, parent, key)</code>: Strategy to use when pre-processing the entity. Use this method to add extra data, defaults, and/or completely change the entity before normalization is complete. Defaults to returning a shallow copy of the input entity.<br><em>Note: It is recommended to always return a copy of your input and not modify the original.</em><br>The function accepts the following arguments, in order: <ul>
<li><code>value</code>: The input value of the entity.</li>
<li><code>parent</code>: The parent object of the input array.</li>
<li><code>key</code>: The key at which the input array appears on the parent object.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="Instance-Methods-1"><a href="#Instance-Methods-1" class="headerlink" title="Instance Methods"></a>Instance Methods</h4><ul>
<li><code>define(definition)</code>: When used, the <code>definition</code> passed in will be merged with the original definition passed to the <code>Entity</code> constructor. This method tends to be useful for creating circular references in schema.</li>
<li><code>key</code>: Returns the key provided to the constructor.</li>
<li><code>idAttribute</code>: Returns the idAttribute provided to the constructor in options.</li>
</ul>
<h4 id="Usage-3"><a href="#Usage-3" class="headerlink" title="Usage"></a>Usage</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = &#123; <span class="attr">id_str</span>: <span class="string">'123'</span>, <span class="attr">url</span>: <span class="string">'https://twitter.com'</span>, <span class="attr">user</span>: &#123; <span class="attr">id_str</span>: <span class="string">'456'</span>, <span class="attr">name</span>: <span class="string">'Jimmy'</span> &#125; &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>, &#123;&#125;, &#123; <span class="attr">idAttribute</span>: <span class="string">'id_str'</span> &#125;);</div><div class="line"><span class="keyword">const</span> tweet = <span class="keyword">new</span> schema.Entity(<span class="string">'tweets'</span>, &#123; <span class="attr">user</span>: user &#125;, &#123; </div><div class="line">    <span class="attr">idAttribute</span>: <span class="string">'id_str'</span>,</div><div class="line">    <span class="comment">// Apply everything from entityB over entityA, except for "favorites"</span></div><div class="line">    mergeStrategy: <span class="function">(<span class="params">entityA, entityB</span>) =&gt;</span> (&#123;</div><div class="line">      ...entityA,</div><div class="line">      ...entityB,</div><div class="line">      <span class="attr">favorites</span>: entityA.favorites</div><div class="line">    &#125;),</div><div class="line">    <span class="comment">// Remove the URL field from the entity</span></div><div class="line">    processStrategy: <span class="function">(<span class="params">entity</span>) =&gt;</span> omit(entity, <span class="string">'url'</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, tweet);</div></pre></td></tr></table></figure>
<h4 id="Output-4"><a href="#Output-4" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">tweets</span>: &#123; <span class="string">'123'</span>: &#123; <span class="attr">id_str</span>: <span class="string">'123'</span>, <span class="attr">user</span>: <span class="string">'456'</span> &#125; &#125;,</div><div class="line">    <span class="attr">users</span>: &#123; <span class="string">'456'</span>: &#123; <span class="attr">id_str</span>: <span class="string">'456'</span>, <span class="attr">name</span>: <span class="string">'Jimmy'</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: <span class="string">'123'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Object-definition"><a href="#Object-definition" class="headerlink" title="Object(definition)"></a><code>Object(definition)</code></h3><p>Define a plain object mapping that has values needing to be normalized into Entities. <em>Note: The same behavior can be defined with shorthand syntax: <code>{ ... }</code></em></p>
<ul>
<li><code>definition</code>: <strong>required</strong> A definition of the nested entities found within this object. Defaults to empty object.<br>You <em>do not</em> need to define any keys in your object other than those that hold other entities. All other values will be copied to the normalized output.</li>
</ul>
<h4 id="Instance-Methods-2"><a href="#Instance-Methods-2" class="headerlink" title="Instance Methods"></a>Instance Methods</h4><ul>
<li><code>define(definition)</code>: When used, the <code>definition</code> passed in will be merged with the original definition passed to the <code>Object</code> constructor. This method tends to be useful for creating circular references in schema.</li>
</ul>
<h4 id="Usage-4"><a href="#Usage-4" class="headerlink" title="Usage"></a>Usage</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Example data response</span></div><div class="line"><span class="keyword">const</span> data = &#123; <span class="attr">users</span>: [ &#123; <span class="attr">id</span>: <span class="string">'123'</span>, <span class="attr">name</span>: <span class="string">'Beth'</span> &#125; ] &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> responseSchema = <span class="keyword">new</span> schema.Object(&#123; <span class="attr">users</span>: <span class="keyword">new</span> schema.Array(user) &#125;);</div><div class="line"><span class="comment">// or shorthand</span></div><div class="line"><span class="keyword">const</span> responseSchema = &#123; <span class="attr">users</span>: <span class="keyword">new</span> schema.Array(user) &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, responseSchema);</div></pre></td></tr></table></figure>
<h4 id="Output-5"><a href="#Output-5" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">users</span>: &#123; <span class="string">'123'</span>: &#123; <span class="attr">id_str</span>: <span class="string">'123'</span>, <span class="attr">name</span>: <span class="string">'Beth'</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: &#123; <span class="attr">users</span>: [ <span class="string">'123'</span> ] &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Union-definition-schemaAttribute"><a href="#Union-definition-schemaAttribute" class="headerlink" title="Union(definition, schemaAttribute)"></a><code>Union(definition, schemaAttribute)</code></h3><p>Describe a schema which is a union of multiple schemas. This is useful if you need the polymorphic behavior provided by <code>schema.Array</code> or <code>schema.Values</code> but for non-collection fields.</p>
<ul>
<li><code>definition</code>: <strong>required</strong> An object mapping the definition of the nested entities found within the input array</li>
<li><code>schemaAttribute</code>: <strong>required</strong> The attribute on each entity found that defines what schema, per the definition mapping, to use when normalizing.<br>Can be a string or a function. If given a function, accepts the following arguments:  <ul>
<li><code>value</code>: The input value of the entity.</li>
<li><code>parent</code>: The parent object of the input array.</li>
<li><code>key</code>: The key at which the input array appears on the parent object.</li>
</ul>
</li>
</ul>
<h4 id="Instance-Methods-3"><a href="#Instance-Methods-3" class="headerlink" title="Instance Methods"></a>Instance Methods</h4><ul>
<li><code>define(definition)</code>: When used, the <code>definition</code> passed in will be merged with the original definition passed to the <code>Union</code> constructor. This method tends to be useful for creating circular references in schema.</li>
</ul>
<h4 id="Usage-5"><a href="#Usage-5" class="headerlink" title="Usage"></a>Usage</h4><p><em>Note: If your data returns an object that you did not provide a mapping for, the original object will be returned in the result and an entity will not be created.</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = &#123; <span class="attr">owner</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'user'</span>, <span class="attr">name</span>: <span class="string">'Anne'</span> &#125; &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> group = <span class="keyword">new</span> schema.Entity(<span class="string">'groups'</span>);</div><div class="line"><span class="keyword">const</span> unionSchema = <span class="keyword">new</span> schema.Union(&#123;</div><div class="line">  <span class="attr">user</span>: user,</div><div class="line">  <span class="attr">group</span>: group</div><div class="line">&#125;, <span class="string">'type'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, &#123; <span class="attr">owner</span>: unionSchema &#125;);</div></pre></td></tr></table></figure>
<h4 id="Output-6"><a href="#Output-6" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">users</span>: &#123; <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'user'</span>, <span class="attr">name</span>: <span class="string">'Anne'</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: &#123; <span class="attr">owner</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">schema</span>: <span class="string">'user'</span> &#125; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Values-definition-schemaAttribute"><a href="#Values-definition-schemaAttribute" class="headerlink" title="Values(definition, schemaAttribute)"></a><code>Values(definition, schemaAttribute)</code></h3><p>Describes a map whose values follow the given schema.</p>
<ul>
<li><code>definition</code>: <strong>required</strong> A singular schema that this array contains <em>or</em> a mapping of schema to attribute values.</li>
<li><code>schemaAttribute</code>: <em>optional</em> (required if <code>definition</code> is not a singular schema) The attribute on each entity found that defines what schema, per the definition mapping, to use when normalizing.<br>Can be a string or a function. If given a function, accepts the following arguments:  <ul>
<li><code>value</code>: The input value of the entity.</li>
<li><code>parent</code>: The parent object of the input array.</li>
<li><code>key</code>: The key at which the input array appears on the parent object.</li>
</ul>
</li>
</ul>
<h4 id="Instance-Methods-4"><a href="#Instance-Methods-4" class="headerlink" title="Instance Methods"></a>Instance Methods</h4><ul>
<li><code>define(definition)</code>: When used, the <code>definition</code> passed in will be merged with the original definition passed to the <code>Values</code> constructor. This method tends to be useful for creating circular references in schema.</li>
</ul>
<h4 id="Usage-6"><a href="#Usage-6" class="headerlink" title="Usage"></a>Usage</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = &#123; <span class="attr">firstThing</span>: &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;, <span class="attr">secondThing</span>: &#123; <span class="attr">id</span>: <span class="number">2</span> &#125; &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> item = <span class="keyword">new</span> schema.Entity(<span class="string">'items'</span>);</div><div class="line"><span class="keyword">const</span> valuesSchema = <span class="keyword">new</span> schema.Values(item);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, valuesSchema);</div></pre></td></tr></table></figure>
<h4 id="Output-7"><a href="#Output-7" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">items</span>: &#123; <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;, <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: &#123; <span class="attr">firstThing</span>: <span class="number">1</span>, <span class="attr">secondThing</span>: <span class="number">2</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If your input data is an object that has values of more than one type of entity, but their schema is not easily defined by the key, you can use a mapping of schema, much like <code>schema.Union</code> and <code>schema.Array</code>.</p>
<p><em>Note: If your data returns an object that you did not provide a mapping for, the original object will be returned in the result and an entity will not be created.</em></p>
<p>For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = &#123;</div><div class="line">  <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'admin'</span> &#125;, </div><div class="line">  <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">type</span>: <span class="string">'user'</span> &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> schema.Entity(<span class="string">'users'</span>);</div><div class="line"><span class="keyword">const</span> adminSchema = <span class="keyword">new</span> schema.Entity(<span class="string">'admins'</span>);</div><div class="line"><span class="keyword">const</span> valuesSchema = <span class="keyword">new</span> schema.Values(&#123;</div><div class="line">  <span class="attr">admins</span>: adminSchema,</div><div class="line">  <span class="attr">users</span>: userSchema</div><div class="line">&#125;, (input, parent, key) =&gt; <span class="string">`<span class="subst">$&#123;input.type&#125;</span>s`</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> normalizedData = normalize(data, valuesSchema);</div></pre></td></tr></table></figure>
<h4 id="Output-8"><a href="#Output-8" class="headerlink" title="Output"></a>Output</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">entities</span>: &#123;</div><div class="line">    <span class="attr">admins</span>: &#123; <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">'admin'</span> &#125; &#125;,</div><div class="line">    <span class="attr">users</span>: &#123; <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">type</span>: <span class="string">'user'</span> &#125; &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">result</span>: &#123;</div><div class="line">    <span class="string">'1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">schema</span>: <span class="string">'admins'</span> &#125;,</div><div class="line">    <span class="string">'2'</span>: &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">schema</span>: <span class="string">'users'</span> &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt; Normalizr Guide&lt;/p&gt;
&lt;h1 id=&quot;Quick-Start&quot;&gt;&lt;a href=&quot;#Quick-Start&quot; class=&quot;headerlink&quot; title=&quot;Quick Start&quot;&gt;&lt;/a&gt;Quick Start&lt;/h1&gt;&lt;p&gt;Consider a
    
    </summary>
    
      <category term="Readme" scheme="https://phpsmarter.github.com/categories/Readme/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>airbnb-javascript-style</title>
    <link href="https://phpsmarter.github.com/2017/04/08/airbnb-javascript-style/"/>
    <id>https://phpsmarter.github.com/2017/04/08/airbnb-javascript-style/</id>
    <published>2017-04-08T01:52:26.000Z</published>
    <updated>2017-04-07T17:53:29.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Airbnb-JavaScript-Style-Guide"><a href="#Airbnb-JavaScript-Style-Guide" class="headerlink" title="Airbnb JavaScript Style Guide() {"></a>Airbnb JavaScript Style Guide() {</h1><p><em>ç”¨æ›´åˆç†çš„æ–¹å¼å†™ JavaScript</em></p>
<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a><a name="table-of-contents">ç›®å½•</a></h2><ol>
<li><a href="#types">ç±»å‹</a></li>
<li><a href="#objects">å¯¹è±¡</a></li>
<li><a href="#arrays">æ•°ç»„</a></li>
<li><a href="#strings">å­—ç¬¦ä¸²</a></li>
<li><a href="#functions">å‡½æ•°</a></li>
<li><a href="#properties">å±æ€§</a></li>
<li><a href="#variables">å˜é‡</a></li>
<li><a href="#hoisting">æå‡</a></li>
<li><a href="#comparison-operators--equality">æ¯”è¾ƒè¿ç®—ç¬¦ &amp; ç­‰å·</a></li>
<li><a href="#blocks">å—</a></li>
<li><a href="#comments">æ³¨é‡Š</a></li>
<li><a href="#whitespace">ç©ºç™½</a></li>
<li><a href="#commas">é€—å·</a></li>
<li><a href="#semicolons">åˆ†å·</a></li>
<li><a href="#type-casting--coercion">ç±»å‹è½¬åŒ–</a></li>
<li><a href="#naming-conventions">å‘½åè§„åˆ™</a></li>
<li><a href="#accessors">å­˜å–å™¨</a></li>
<li><a href="#constructors">æ„é€ å‡½æ•°</a></li>
<li><a href="#events">äº‹ä»¶</a></li>
<li><a href="#modules">æ¨¡å—</a></li>
<li><a href="#jquery">jQuery</a></li>
<li><a href="#ecmascript-5-compatibility">ECMAScript 5 å…¼å®¹æ€§</a></li>
<li><a href="#testing">æµ‹è¯•</a></li>
<li><a href="#performance">æ€§èƒ½</a></li>
<li><a href="#resources">èµ„æº</a></li>
<li><a href="#in-the-wild">è°åœ¨ä½¿ç”¨</a></li>
<li><a href="#translation">ç¿»è¯‘</a></li>
<li><a href="#the-javascript-style-guide-guide">JavaScript é£æ ¼æŒ‡å—è¯´æ˜</a></li>
<li><a href="#chat-with-us-about-javascript">ä¸æˆ‘ä»¬è®¨è®º JavaScript</a></li>
<li><a href="#contributors">è´¡çŒ®è€…</a></li>
<li><a href="#license">è®¸å¯</a></li>
</ol>
<h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a><a name="types">ç±»å‹</a></h2><ul>
<li><p><strong>åŸå§‹å€¼</strong>: å­˜å–ç›´æ¥ä½œç”¨äºå®ƒè‡ªèº«ã€‚</p>
<ul>
<li><code>string</code></li>
<li><code>number</code></li>
<li><code>boolean</code></li>
<li><code>null</code></li>
<li><code>undefined</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> bar = foo;</div><div class="line"></div><div class="line">bar = <span class="number">9</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(foo, bar); <span class="comment">// =&gt; 1, 9</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>å¤æ‚ç±»å‹</strong>: å­˜å–æ—¶ä½œç”¨äºå®ƒè‡ªèº«å€¼çš„å¼•ç”¨ã€‚</p>
<ul>
<li><code>object</code></li>
<li><code>array</code></li>
<li><code>function</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = [<span class="number">1</span>, <span class="number">2</span>];</div><div class="line"><span class="keyword">var</span> bar = foo;</div><div class="line"></div><div class="line">bar[<span class="number">0</span>] = <span class="number">9</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(foo[<span class="number">0</span>], bar[<span class="number">0</span>]); <span class="comment">// =&gt; 9, 9</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a><a name="objects">å¯¹è±¡</a></h2><ul>
<li><p>ä½¿ç”¨ç›´æ¥é‡åˆ›å»ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> item = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> item = &#123;&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦ä½¿ç”¨<a href="http://es5.github.io/#x7.6.1" target="_blank" rel="external">ä¿ç•™å­—</a>ä½œä¸ºé”®åï¼Œå®ƒä»¬åœ¨ IE8 ä¸‹ä¸å·¥ä½œã€‚<a href="https://github.com/airbnb/javascript/issues/61" target="_blank" rel="external">æ›´å¤šä¿¡æ¯</a>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> superman = &#123;</div><div class="line">  <span class="attr">default</span>: &#123; <span class="attr">clark</span>: <span class="string">'kent'</span> &#125;,</div><div class="line">  <span class="attr">private</span>: <span class="literal">true</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> superman = &#123;</div><div class="line">  <span class="attr">defaults</span>: &#123; <span class="attr">clark</span>: <span class="string">'kent'</span> &#125;,</div><div class="line">  <span class="attr">hidden</span>: <span class="literal">true</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨åŒä¹‰è¯æ›¿æ¢éœ€è¦ä½¿ç”¨çš„ä¿ç•™å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> superman = &#123;</div><div class="line">  <span class="attr">class</span>: <span class="string">'alien'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> superman = &#123;</div><div class="line">  <span class="attr">klass</span>: <span class="string">'alien'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> superman = &#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'alien'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a><a name="arrays">æ•°ç»„</a></h2><ul>
<li><p>ä½¿ç”¨ç›´æ¥é‡åˆ›å»ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> items = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> items = [];</div></pre></td></tr></table></figure>
</li>
<li><p>å‘æ•°ç»„å¢åŠ å…ƒç´ æ—¶ä½¿ç”¨ Array#push æ¥æ›¿ä»£ç›´æ¥èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> someStack = [];</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">someStack[someStack.length] = <span class="string">'abracadabra'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">someStack.push(<span class="string">'abracadabra'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>å½“ä½ éœ€è¦æ‹·è´æ•°ç»„æ—¶ï¼Œä½¿ç”¨ Array#sliceã€‚<a href="http://jsperf.com/converting-arguments-to-an-array/7" target="_blank" rel="external">jsPerf</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> len = items.length;</div><div class="line"><span class="keyword">var</span> itemsCopy = [];</div><div class="line"><span class="keyword">var</span> i;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">  itemsCopy[i] = items[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">itemsCopy = items.slice();</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ Array#slice å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢æˆæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a><a name="strings">å­—ç¬¦ä¸²</a></h2><ul>
<li><p>ä½¿ç”¨å•å¼•å· <code>&#39;&#39;</code> åŒ…è£¹å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> name = <span class="string">"Bob Parr"</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> name = <span class="string">'Bob Parr'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> fullName = <span class="string">"Bob "</span> + <span class="keyword">this</span>.lastName;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> fullName = <span class="string">'Bob '</span> + <span class="keyword">this</span>.lastName;</div></pre></td></tr></table></figure>
</li>
<li><p>è¶…è¿‡ 100 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²åº”è¯¥ä½¿ç”¨è¿æ¥ç¬¦å†™æˆå¤šè¡Œã€‚</p>
</li>
<li><p>æ³¨ï¼šè‹¥è¿‡åº¦ä½¿ç”¨ï¼Œé€šè¿‡è¿æ¥ç¬¦è¿æ¥çš„é•¿å­—ç¬¦ä¸²å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚<a href="http://jsperf.com/ya-string-concat" target="_blank" rel="external">jsPerf</a> &amp; <a href="https://github.com/airbnb/javascript/issues/40" target="_blank" rel="external">è®¨è®º</a>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that was thrown because of Batman. When you stop to think about how Batman had anything to do with this, you would get nowhere fast.'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that was thrown because \</span></div><div class="line">of Batman. When you stop to think about how Batman had anything to do \</div><div class="line">with this, you would get nowhere \</div><div class="line">fast.';</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that was thrown because '</span> +</div><div class="line">  <span class="string">'of Batman. When you stop to think about how Batman had anything to do '</span> +</div><div class="line">  <span class="string">'with this, you would get nowhere fast.'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>ç¨‹åºåŒ–ç”Ÿæˆçš„å­—ç¬¦ä¸²ä½¿ç”¨ Array#join è¿æ¥è€Œä¸æ˜¯ä½¿ç”¨è¿æ¥ç¬¦ã€‚å°¤å…¶æ˜¯ IE ä¸‹ï¼š<a href="http://jsperf.com/string-vs-array-concat/2" target="_blank" rel="external">jsPerf</a>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> items;</div><div class="line"><span class="keyword">var</span> messages;</div><div class="line"><span class="keyword">var</span> length;</div><div class="line"><span class="keyword">var</span> i;</div><div class="line"></div><div class="line">messages = [&#123;</div><div class="line">  <span class="attr">state</span>: <span class="string">'success'</span>,</div><div class="line">  <span class="attr">message</span>: <span class="string">'This one worked.'</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">state</span>: <span class="string">'success'</span>,</div><div class="line">  <span class="attr">message</span>: <span class="string">'This one worked as well.'</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">state</span>: <span class="string">'error'</span>,</div><div class="line">  <span class="attr">message</span>: <span class="string">'This one did not work.'</span></div><div class="line">&#125;];</div><div class="line"></div><div class="line">length = messages.length;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inbox</span>(<span class="params">messages</span>) </span>&#123;</div><div class="line">  items = <span class="string">'&lt;ul&gt;'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++) &#123;</div><div class="line">    items += <span class="string">'&lt;li&gt;'</span> + messages[i].message + <span class="string">'&lt;/li&gt;'</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> items + <span class="string">'&lt;/ul&gt;'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inbox</span>(<span class="params">messages</span>) </span>&#123;</div><div class="line">  items = [];</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++) &#123;</div><div class="line">    <span class="comment">// use direct assignment in this case because we're micro-optimizing.</span></div><div class="line">    items[i] = <span class="string">'&lt;li&gt;'</span> + messages[i].message + <span class="string">'&lt;/li&gt;'</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="string">'&lt;ul&gt;'</span> + items.join(<span class="string">''</span>) + <span class="string">'&lt;/ul&gt;'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a><a name="functions">å‡½æ•°</a></h2><ul>
<li><p>å‡½æ•°è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŒ¿åå‡½æ•°è¡¨è¾¾å¼</span></div><div class="line"><span class="keyword">var</span> anonymous = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// å‘½åå‡½æ•°è¡¨è¾¾å¼</span></div><div class="line"><span class="keyword">var</span> named = <span class="function"><span class="keyword">function</span> <span class="title">named</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Welcome to the Internet. Please follow me.'</span>);</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
</li>
<li><p>æ°¸è¿œä¸è¦åœ¨ä¸€ä¸ªéå‡½æ•°ä»£ç å—ï¼ˆifã€while ç­‰ï¼‰ä¸­å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠé‚£ä¸ªå‡½æ•°èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚æµè§ˆå™¨å…è®¸ä½ è¿™ä¹ˆåšï¼Œä½†å®ƒä»¬çš„è§£æè¡¨ç°ä¸ä¸€è‡´ã€‚</p>
</li>
<li><p><strong>æ³¨ï¼š</strong> ECMA-262 æŠŠ <code>å—</code> å®šä¹‰ä¸ºä¸€ç»„è¯­å¥ã€‚å‡½æ•°å£°æ˜ä¸æ˜¯è¯­å¥ã€‚<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf#page=97" target="_blank" rel="external">é˜…è¯»å¯¹ ECMA-262 è¿™ä¸ªé—®é¢˜çš„è¯´æ˜</a>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (currentUser) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Nope.'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> test;</div><div class="line"><span class="keyword">if</span> (currentUser) &#123;</div><div class="line">  test = <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Yup.'</span>);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>æ°¸è¿œä¸è¦æŠŠå‚æ•°å‘½åä¸º <code>arguments</code>ã€‚è¿™å°†å–ä»£å‡½æ•°ä½œç”¨åŸŸå†…çš„ <code>arguments</code> å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">nope</span>(<span class="params">name, options, arguments</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">yup</span>(<span class="params">name, options, args</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a><a name="properties">å±æ€§</a></h2><ul>
<li><p>ä½¿ç”¨ <code>.</code> æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> luke = &#123;</div><div class="line">  <span class="attr">jedi</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">28</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> isJedi = luke[<span class="string">'jedi'</span>];</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> isJedi = luke.jedi;</div></pre></td></tr></table></figure>
</li>
<li><p>å½“é€šè¿‡å˜é‡è®¿é—®å±æ€§æ—¶ä½¿ç”¨ä¸­æ‹¬å· <code>[]</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> luke = &#123;</div><div class="line">  <span class="attr">jedi</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">28</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProp</span>(<span class="params">prop</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> luke[prop];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> isJedi = getProp(<span class="string">'jedi'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a><a name="variables">å˜é‡</a></h2><ul>
<li><p>æ€»æ˜¯ä½¿ç”¨ <code>var</code> æ¥å£°æ˜å˜é‡ã€‚ä¸è¿™ä¹ˆåšå°†å¯¼è‡´äº§ç”Ÿå…¨å±€å˜é‡ã€‚æˆ‘ä»¬è¦é¿å…æ±¡æŸ“å…¨å±€å‘½åç©ºé—´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">superPower = <span class="keyword">new</span> SuperPower();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> superPower = <span class="keyword">new</span> SuperPower();</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>var</code> å£°æ˜æ¯ä¸€ä¸ªå˜é‡ã€‚<br>è¿™æ ·åšçš„å¥½å¤„æ˜¯å¢åŠ æ–°å˜é‡å°†å˜çš„æ›´åŠ å®¹æ˜“ï¼Œè€Œä¸”ä½ æ°¸è¿œä¸ç”¨å†æ‹…å¿ƒè°ƒæ¢é”™ <code>;</code> è·Ÿ <code>,</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> items = getItems(),</div><div class="line">    goSportsTeam = <span class="literal">true</span>,</div><div class="line">    dragonball = <span class="string">'z'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="comment">// ï¼ˆè·Ÿä¸Šé¢çš„ä»£ç æ¯”è¾ƒä¸€ä¸‹ï¼Œçœ‹çœ‹å“ªé‡Œé”™äº†ï¼‰</span></div><div class="line"><span class="keyword">var</span> items = getItems(),</div><div class="line">    goSportsTeam = <span class="literal">true</span>;</div><div class="line">    dragonball = <span class="string">'z'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> items = getItems();</div><div class="line"><span class="keyword">var</span> goSportsTeam = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> dragonball = <span class="string">'z'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>æœ€åå†å£°æ˜æœªèµ‹å€¼çš„å˜é‡ã€‚å½“ä½ éœ€è¦å¼•ç”¨å‰é¢çš„å˜é‡èµ‹å€¼æ—¶è¿™å°†å˜çš„å¾ˆæœ‰ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> i, len, dragonball,</div><div class="line">    items = getItems(),</div><div class="line">    goSportsTeam = <span class="literal">true</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> i;</div><div class="line"><span class="keyword">var</span> items = getItems();</div><div class="line"><span class="keyword">var</span> dragonball;</div><div class="line"><span class="keyword">var</span> goSportsTeam = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> len;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> items = getItems();</div><div class="line"><span class="keyword">var</span> goSportsTeam = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> dragonball;</div><div class="line"><span class="keyword">var</span> length;</div><div class="line"><span class="keyword">var</span> i;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ä½œç”¨åŸŸé¡¶éƒ¨å£°æ˜å˜é‡ã€‚è¿™å°†å¸®ä½ é¿å…å˜é‡å£°æ˜æå‡ç›¸å…³çš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  test();</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'doing stuff..'</span>);</div><div class="line"></div><div class="line">  <span class="comment">//..other stuff..</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> name = getName();</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (name === <span class="string">'test'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name = getName();</div><div class="line"></div><div class="line">  test();</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'doing stuff..'</span>);</div><div class="line"></div><div class="line">  <span class="comment">//..other stuff..</span></div><div class="line"></div><div class="line">  <span class="keyword">if</span> (name === <span class="string">'test'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad - ä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name = getName();</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (!<span class="built_in">arguments</span>.length) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.setFirstName(name);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (!<span class="built_in">arguments</span>.length) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  name = getName();</div><div class="line">  <span class="keyword">this</span>.setFirstName(name);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æå‡"><a href="#æå‡" class="headerlink" title="æå‡"></a><a name="hoisting">æå‡</a></h2><ul>
<li><p>å˜é‡å£°æ˜ä¼šæå‡è‡³ä½œç”¨åŸŸé¡¶éƒ¨ï¼Œä½†èµ‹å€¼ä¸ä¼šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æˆ‘ä»¬çŸ¥é“è¿™æ ·ä¸èƒ½æ­£å¸¸å·¥ä½œï¼ˆå‡è®¾è¿™é‡Œæ²¡æœ‰åä¸º notDefined çš„å…¨å±€å˜é‡ï¼‰</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(notDefined); <span class="comment">// =&gt; throws a ReferenceError</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä½†ç”±äºå˜é‡å£°æ˜æå‡çš„åŸå› ï¼Œåœ¨ä¸€ä¸ªå˜é‡å¼•ç”¨åå†åˆ›å»ºå®ƒçš„å˜é‡å£°æ˜å°†å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</span></div><div class="line"><span class="comment">// æ³¨ï¼šå˜é‡èµ‹å€¼ä¸º `true` ä¸ä¼šæå‡ã€‚</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(declaredButNotAssigned); <span class="comment">// =&gt; undefined</span></div><div class="line">  <span class="keyword">var</span> declaredButNotAssigned = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è§£é‡Šå™¨ä¼šæŠŠå˜é‡å£°æ˜æå‡åˆ°ä½œç”¨åŸŸé¡¶éƒ¨ï¼Œæ„å‘³ç€æˆ‘ä»¬çš„ä¾‹å­å°†è¢«é‡å†™æˆï¼š</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> declaredButNotAssigned;</div><div class="line">  <span class="built_in">console</span>.log(declaredButNotAssigned); <span class="comment">// =&gt; undefined</span></div><div class="line">  declaredButNotAssigned = <span class="literal">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åŒ¿åå‡½æ•°è¡¨è¾¾å¼ä¼šæå‡å®ƒä»¬çš„å˜é‡åï¼Œä½†ä¸ä¼šæå‡å‡½æ•°çš„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(anonymous); <span class="comment">// =&gt; undefined</span></div><div class="line"></div><div class="line">  anonymous(); <span class="comment">// =&gt; TypeError anonymous is not a function</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> anonymous = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'anonymous function expression'</span>);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å‘½åå‡½æ•°è¡¨è¾¾å¼ä¼šæå‡å˜é‡åï¼Œä½†ä¸ä¼šæå‡å‡½æ•°åæˆ–å‡½æ•°ä½“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(named); <span class="comment">// =&gt; undefined</span></div><div class="line"></div><div class="line">  named(); <span class="comment">// =&gt; TypeError named is not a function</span></div><div class="line"></div><div class="line">  superPower(); <span class="comment">// =&gt; ReferenceError superPower is not defined</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> named = <span class="function"><span class="keyword">function</span> <span class="title">superPower</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Flying'</span>);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å½“å‡½æ•°åè·Ÿå˜é‡åä¸€æ ·æ—¶ï¼Œè¡¨ç°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(named); <span class="comment">// =&gt; undefined</span></div><div class="line"></div><div class="line">  named(); <span class="comment">// =&gt; TypeError named is not a function</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> named = <span class="function"><span class="keyword">function</span> <span class="title">named</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'named'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å‡½æ•°å£°æ˜æå‡å®ƒä»¬çš„åå­—å’Œå‡½æ•°ä½“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  superPower(); <span class="comment">// =&gt; Flying</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">superPower</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Flying'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>äº†è§£æ›´å¤šä¿¡æ¯åœ¨ <a href="http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting" target="_blank" rel="external">JavaScript Scoping &amp; Hoisting</a> by <a href="http://www.adequatelygood.com/" target="_blank" rel="external">Ben Cherry</a>.</p>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æ¯”è¾ƒè¿ç®—ç¬¦-amp-ç­‰å·"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦-amp-ç­‰å·" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦ &amp; ç­‰å·"></a><a name="comparison-operators--equality">æ¯”è¾ƒè¿ç®—ç¬¦ &amp; ç­‰å·</a></h2><ul>
<li>ä¼˜å…ˆä½¿ç”¨ <code>===</code> å’Œ <code>!==</code> è€Œä¸æ˜¯ <code>==</code> å’Œ <code>!=</code>.</li>
<li><p>æ¡ä»¶è¡¨è¾¾å¼ä¾‹å¦‚ <code>if</code> è¯­å¥é€šè¿‡æŠ½è±¡æ–¹æ³• <code>ToBoolean</code> å¼ºåˆ¶è®¡ç®—å®ƒä»¬çš„è¡¨è¾¾å¼å¹¶ä¸”æ€»æ˜¯éµå®ˆä¸‹é¢çš„è§„åˆ™ï¼š</p>
<ul>
<li><strong>å¯¹è±¡</strong> è¢«è®¡ç®—ä¸º <strong>true</strong></li>
<li><strong>Undefined</strong> è¢«è®¡ç®—ä¸º <strong>false</strong></li>
<li><strong>Null</strong> è¢«è®¡ç®—ä¸º <strong>false</strong></li>
<li><strong>å¸ƒå°”å€¼</strong> è¢«è®¡ç®—ä¸º <strong>å¸ƒå°”çš„å€¼</strong></li>
<li><strong>æ•°å­—</strong> å¦‚æœæ˜¯ <strong>+0ã€-0 æˆ– NaN</strong> è¢«è®¡ç®—ä¸º <strong>false</strong>ï¼Œå¦åˆ™ä¸º <strong>true</strong></li>
<li><strong>å­—ç¬¦ä¸²</strong> å¦‚æœæ˜¯ç©ºå­—ç¬¦ä¸² <code>&#39;&#39;</code> è¢«è®¡ç®—ä¸º <strong>false</strong>ï¼Œå¦åˆ™ä¸º <strong>true</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="number">0</span>]) &#123;</div><div class="line">  <span class="comment">// true</span></div><div class="line">  <span class="comment">// ä¸€ä¸ªæ•°ç»„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡è¢«è®¡ç®—ä¸º true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨å¿«æ·æ–¹å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (name !== <span class="string">''</span>) &#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (name) &#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (collection.length &gt; <span class="number">0</span>) &#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (collection.length) &#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>äº†è§£æ›´å¤šä¿¡æ¯åœ¨ <a href="http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/#more-2108" target="_blank" rel="external">Truth Equality and JavaScript</a> by Angus Croll.</p>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å—"><a href="#å—" class="headerlink" title="å—"></a><a name="blocks">å—</a></h2><ul>
<li><p>ä½¿ç”¨å¤§æ‹¬å·åŒ…è£¹æ‰€æœ‰çš„å¤šè¡Œä»£ç å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (test)</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (test) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (test) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœé€šè¿‡ <code>if</code> å’Œ <code>else</code> ä½¿ç”¨å¤šè¡Œä»£ç å—ï¼ŒæŠŠ <code>else</code> æ”¾åœ¨ <code>if</code> ä»£ç å—å…³é—­æ‹¬å·çš„åŒä¸€è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (test) &#123;</div><div class="line">  thing1();</div><div class="line">  thing2();</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">  thing3();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (test) &#123;</div><div class="line">  thing1();</div><div class="line">  thing2();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  thing3();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a><a name="comments">æ³¨é‡Š</a></h2><ul>
<li><p>ä½¿ç”¨ <code>/** ... */</code> ä½œä¸ºå¤šè¡Œæ³¨é‡Šã€‚åŒ…å«æè¿°ã€æŒ‡å®šæ‰€æœ‰å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹å’Œå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="comment">// make() returns a new element</span></div><div class="line"><span class="comment">// based on the passed in tag name</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// @param &#123;String&#125; tag</span></div><div class="line"><span class="comment">// @return &#123;Element&#125; element</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">tag</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span> element;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * make() returns a new element</div><div class="line"> * based on the passed in tag name</div><div class="line"> *</div><div class="line"> * @param &#123;String&#125; tag</div><div class="line"> * @return &#123;Element&#125; element</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">tag</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span> element;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>//</code> ä½œä¸ºå•è¡Œæ³¨é‡Šã€‚åœ¨è¯„è®ºå¯¹è±¡ä¸Šé¢å¦èµ·ä¸€è¡Œä½¿ç”¨å•è¡Œæ³¨é‡Šã€‚åœ¨æ³¨é‡Šå‰æ’å…¥ç©ºè¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> active = <span class="literal">true</span>;  <span class="comment">// is current tab</span></div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="comment">// is current tab</span></div><div class="line"><span class="keyword">var</span> active = <span class="literal">true</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getType</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'fetching type...'</span>);</div><div class="line">  <span class="comment">// set the default type to 'no type'</span></div><div class="line">  <span class="keyword">var</span> type = <span class="keyword">this</span>.type || <span class="string">'no type'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getType</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'fetching type...'</span>);</div><div class="line"></div><div class="line">  <span class="comment">// set the default type to 'no type'</span></div><div class="line">  <span class="keyword">var</span> type = <span class="keyword">this</span>.type || <span class="string">'no type'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> type;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ç»™æ³¨é‡Šå¢åŠ  <code>FIXME</code> æˆ– <code>TODO</code> çš„å‰ç¼€å¯ä»¥å¸®åŠ©å…¶ä»–å¼€å‘è€…å¿«é€Ÿäº†è§£è¿™æ˜¯ä¸€ä¸ªéœ€è¦å¤æŸ¥çš„é—®é¢˜ï¼Œæˆ–æ˜¯ç»™éœ€è¦å®ç°çš„åŠŸèƒ½æä¾›ä¸€ä¸ªè§£å†³æ–¹å¼ã€‚è¿™å°†æœ‰åˆ«äºå¸¸è§çš„æ³¨é‡Šï¼Œå› ä¸ºå®ƒä»¬æ˜¯å¯æ“ä½œçš„ã€‚ä½¿ç”¨ <code>FIXME -- need to figure this out</code> æˆ–è€… <code>TODO -- need to implement</code>ã€‚</p>
</li>
<li><p>ä½¿ç”¨ <code>// FIXME:</code> æ ‡æ³¨é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Calculator</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// <span class="doctag">FIXME:</span> shouldn't use a global here</span></div><div class="line">  total = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>// TODO:</code> æ ‡æ³¨é—®é¢˜çš„è§£å†³æ–¹å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Calculator</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// <span class="doctag">TODO:</span> total should be configurable by an options param</span></div><div class="line">  <span class="keyword">this</span>.total = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="ç©ºç™½"><a href="#ç©ºç™½" class="headerlink" title="ç©ºç™½"></a><a name="whitespace">ç©ºç™½</a></h2><ul>
<li><p>ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ä½œä¸ºç¼©è¿›ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">âˆ™âˆ™âˆ™âˆ™<span class="keyword">var</span> name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">âˆ™<span class="keyword">var</span> name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">âˆ™âˆ™<span class="keyword">var</span> name;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨å¤§æ‹¬å·å‰æ”¾ä¸€ä¸ªç©ºæ ¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'test'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'test'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">dog.set(<span class="string">'attr'</span>,&#123;</div><div class="line">  <span class="attr">age</span>: <span class="string">'1 year'</span>,</div><div class="line">  <span class="attr">breed</span>: <span class="string">'Bernese Mountain Dog'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">dog.set(<span class="string">'attr'</span>, &#123;</div><div class="line">  <span class="attr">age</span>: <span class="string">'1 year'</span>,</div><div class="line">  <span class="attr">breed</span>: <span class="string">'Bernese Mountain Dog'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æ§åˆ¶è¯­å¥ï¼ˆ<code>if</code>ã€<code>while</code> ç­‰ï¼‰çš„å°æ‹¬å·å‰æ”¾ä¸€ä¸ªç©ºæ ¼ã€‚åœ¨å‡½æ•°è°ƒç”¨åŠå£°æ˜ä¸­ï¼Œä¸åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨å‰åŠ ç©ºæ ¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span>(isJedi) &#123;</div><div class="line">  fight ();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (isJedi) &#123;</div><div class="line">  fight();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fight</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log (<span class="string">'Swooosh!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fight</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Swooosh!'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ç©ºæ ¼æŠŠè¿ç®—ç¬¦éš”å¼€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> x=y+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> x = y + <span class="number">5</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªç©ºè¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;)(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;)(<span class="keyword">this</span>);â†µ</div><div class="line">â†µ</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// good</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;)(<span class="keyword">this</span>);â†µ</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ä½¿ç”¨é•¿æ–¹æ³•é“¾æ—¶è¿›è¡Œç¼©è¿›ã€‚ä½¿ç”¨å‰é¢çš„ç‚¹ <code>.</code> å¼ºè°ƒè¿™æ˜¯æ–¹æ³•è°ƒç”¨è€Œä¸æ˜¯æ–°è¯­å¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">$(<span class="string">'#items'</span>).find(<span class="string">'.selected'</span>).highlight().end().find(<span class="string">'.open'</span>).updateCount();</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">$(<span class="string">'#items'</span>).</div><div class="line">  find(<span class="string">'.selected'</span>).</div><div class="line">    highlight().</div><div class="line">    end().</div><div class="line">  find(<span class="string">'.open'</span>).</div><div class="line">    updateCount();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">$(<span class="string">'#items'</span>)</div><div class="line">  .find(<span class="string">'.selected'</span>)</div><div class="line">    .highlight()</div><div class="line">    .end()</div><div class="line">  .find(<span class="string">'.open'</span>)</div><div class="line">    .updateCount();</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> leds = stage.selectAll(<span class="string">'.led'</span>).data(data).enter().append(<span class="string">'svg:svg'</span>).classed(<span class="string">'led'</span>, <span class="literal">true</span>)</div><div class="line">    .attr(<span class="string">'width'</span>, (radius + margin) * <span class="number">2</span>).append(<span class="string">'svg:g'</span>)</div><div class="line">    .attr(<span class="string">'transform'</span>, <span class="string">'translate('</span> + (radius + margin) + <span class="string">','</span> + (radius + margin) + <span class="string">')'</span>)</div><div class="line">    .call(tron.led);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> leds = stage.selectAll(<span class="string">'.led'</span>)</div><div class="line">    .data(data)</div><div class="line">  .enter().append(<span class="string">'svg:svg'</span>)</div><div class="line">    .classed(<span class="string">'led'</span>, <span class="literal">true</span>)</div><div class="line">    .attr(<span class="string">'width'</span>, (radius + margin) * <span class="number">2</span>)</div><div class="line">  .append(<span class="string">'svg:g'</span>)</div><div class="line">    .attr(<span class="string">'transform'</span>, <span class="string">'translate('</span> + (radius + margin) + <span class="string">','</span> + (radius + margin) + <span class="string">')'</span>)</div><div class="line">    .call(tron.led);</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨å—æœ«å’Œæ–°è¯­å¥å‰æ’å…¥ç©ºè¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (foo) &#123;</div><div class="line">  <span class="keyword">return</span> bar;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> baz;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (foo) &#123;</div><div class="line">  <span class="keyword">return</span> bar;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> baz;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">bar</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">return</span> obj;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">bar</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">return</span> obj;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="é€—å·"><a href="#é€—å·" class="headerlink" title="é€—å·"></a><a name="commas">é€—å·</a></h2><ul>
<li><p>è¡Œé¦–é€—å·: <strong>ä¸éœ€è¦</strong>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> story = [</div><div class="line">    once</div><div class="line">  , upon</div><div class="line">  , aTime</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> story = [</div><div class="line">  once,</div><div class="line">  upon,</div><div class="line">  aTime</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> hero = &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Bob'</span></div><div class="line">  , <span class="attr">lastName</span>: <span class="string">'Parr'</span></div><div class="line">  , <span class="attr">heroName</span>: <span class="string">'Mr. Incredible'</span></div><div class="line">  , <span class="attr">superPower</span>: <span class="string">'strength'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> hero = &#123;</div><div class="line">  <span class="attr">firstName</span>: <span class="string">'Bob'</span>,</div><div class="line">  <span class="attr">lastName</span>: <span class="string">'Parr'</span>,</div><div class="line">  <span class="attr">heroName</span>: <span class="string">'Mr. Incredible'</span>,</div><div class="line">  <span class="attr">superPower</span>: <span class="string">'strength'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>é¢å¤–çš„è¡Œæœ«é€—å·ï¼š<strong>ä¸éœ€è¦</strong>ã€‚è¿™æ ·åšä¼šåœ¨ IE6/7 å’Œ IE9 æ€ªå¼‚æ¨¡å¼ä¸‹å¼•èµ·é—®é¢˜ã€‚åŒæ ·ï¼Œå¤šä½™çš„é€—å·åœ¨æŸäº› ES3 çš„å®ç°é‡Œä¼šå¢åŠ æ•°ç»„çš„é•¿åº¦ã€‚åœ¨ ES5 ä¸­å·²ç»æ¾„æ¸…äº† (<a href="http://es5.github.io/#D" target="_blank" rel="external">source</a>)ï¼š</p>
<blockquote>
<p>Edition 5 clarifies the fact that a trailing comma at the end of an ArrayInitialiser does not add to the length of the array. This is not a semantic change from Edition 3 but some implementations may have previously misinterpreted this.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> hero = &#123;</div><div class="line">  <span class="attr">firstName</span>: <span class="string">'Kevin'</span>,</div><div class="line">  <span class="attr">lastName</span>: <span class="string">'Flynn'</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> heroes = [</div><div class="line">  <span class="string">'Batman'</span>,</div><div class="line">  <span class="string">'Superman'</span>,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> hero = &#123;</div><div class="line">  <span class="attr">firstName</span>: <span class="string">'Kevin'</span>,</div><div class="line">  <span class="attr">lastName</span>: <span class="string">'Flynn'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> heroes = [</div><div class="line">  <span class="string">'Batman'</span>,</div><div class="line">  <span class="string">'Superman'</span></div><div class="line">];</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="åˆ†å·"><a href="#åˆ†å·" class="headerlink" title="åˆ†å·"></a><a name="semicolons">åˆ†å·</a></h2><ul>
<li><p><strong>ä½¿ç”¨åˆ†å·ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name = <span class="string">'Skywalker'</span></div><div class="line">  <span class="keyword">return</span> name</div><div class="line">&#125;)()</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name = <span class="string">'Skywalker'</span>;</div><div class="line">  <span class="keyword">return</span> name;</div><div class="line">&#125;)();</div><div class="line"></div><div class="line"><span class="comment">// good (é˜²æ­¢å‡½æ•°åœ¨ä¸¤ä¸ª IIFE åˆå¹¶æ—¶è¢«å½“æˆä¸€ä¸ªå‚æ•°</span></div><div class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> name = <span class="string">'Skywalker'</span>;</div><div class="line">  <span class="keyword">return</span> name;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p><a href="http://stackoverflow.com/a/7365214/1712802" target="_blank" rel="external">äº†è§£æ›´å¤š</a>.</p>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a><a name="type-casting--coercion">ç±»å‹è½¬æ¢</a></h2><ul>
<li>åœ¨è¯­å¥å¼€å§‹æ—¶æ‰§è¡Œç±»å‹è½¬æ¢ã€‚</li>
<li><p>å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  =&gt; this.reviewScore = 9;</span></div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> totalScore = <span class="keyword">this</span>.reviewScore + <span class="string">''</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> totalScore = <span class="string">''</span> + <span class="keyword">this</span>.reviewScore;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> totalScore = <span class="string">''</span> + <span class="keyword">this</span>.reviewScore + <span class="string">' total score'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> totalScore = <span class="keyword">this</span>.reviewScore + <span class="string">' total score'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>parseInt</code> è½¬æ¢æ•°å­—æ—¶æ€»æ˜¯å¸¦ä¸Šç±»å‹è½¬æ¢çš„åŸºæ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> inputValue = <span class="string">'4'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> val = <span class="keyword">new</span> <span class="built_in">Number</span>(inputValue);</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> val = +inputValue;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> val = inputValue &gt;&gt; <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> val = <span class="built_in">parseInt</span>(inputValue);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> val = <span class="built_in">Number</span>(inputValue);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> val = <span class="built_in">parseInt</span>(inputValue, <span class="number">10</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœå› ä¸ºæŸäº›åŸå›  <code>parseInt</code> æˆä¸ºä½ æ‰€åšçš„äº‹çš„ç“¶é¢ˆè€Œéœ€è¦ä½¿ç”¨ä½æ“ä½œè§£å†³<a href="http://jsperf.com/coercion-vs-casting/3" target="_blank" rel="external">æ€§èƒ½é—®é¢˜</a>æ—¶ï¼Œç•™ä¸ªæ³¨é‡Šè¯´æ¸…æ¥šåŸå› å’Œä½ çš„ç›®çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// good</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * parseInt was the reason my code was slow.</div><div class="line"> * Bitshifting the String to coerce it to a</div><div class="line"> * Number made it a lot faster.</div><div class="line"> */</div><div class="line"><span class="keyword">var</span> val = inputValue &gt;&gt; <span class="number">0</span>;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>æ³¨ï¼š</strong> å°å¿ƒä½¿ç”¨ä½æ“ä½œè¿ç®—ç¬¦ã€‚æ•°å­—ä¼šè¢«å½“æˆ <a href="http://es5.github.io/#x4.3.19" target="_blank" rel="external">64 ä½å€¼</a>ï¼Œä½†æ˜¯ä½æ“ä½œè¿ç®—ç¬¦æ€»æ˜¯è¿”å› 32 ä½çš„æ•´æ•°ï¼ˆ<a href="http://es5.github.io/#x11.7" target="_blank" rel="external">source</a>ï¼‰ã€‚ä½æ“ä½œå¤„ç†å¤§äº 32 ä½çš„æ•´æ•°å€¼æ—¶è¿˜ä¼šå¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚<a href="https://github.com/airbnb/javascript/issues/109" target="_blank" rel="external">è®¨è®º</a>ã€‚æœ€å¤§çš„ 32 ä½æ•´æ•°æ˜¯ 2,147,483,647ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">2147483647</span> &gt;&gt; <span class="number">0</span> <span class="comment">//=&gt; 2147483647</span></div><div class="line"><span class="number">2147483648</span> &gt;&gt; <span class="number">0</span> <span class="comment">//=&gt; -2147483648</span></div><div class="line"><span class="number">2147483649</span> &gt;&gt; <span class="number">0</span> <span class="comment">//=&gt; -2147483647</span></div></pre></td></tr></table></figure>
</li>
<li><p>å¸ƒå°”:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> age = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> hasAge = <span class="keyword">new</span> <span class="built_in">Boolean</span>(age);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> hasAge = <span class="built_in">Boolean</span>(age);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> hasAge = !!age;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å‘½åè§„åˆ™"><a href="#å‘½åè§„åˆ™" class="headerlink" title="å‘½åè§„åˆ™"></a><a name="naming-conventions">å‘½åè§„åˆ™</a></h2><ul>
<li><p>é¿å…å•å­—æ¯å‘½åã€‚å‘½ååº”å…·å¤‡æè¿°æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">q</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ..stuff..</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨é©¼å³°å¼å‘½åå¯¹è±¡ã€å‡½æ•°å’Œå®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> OBJEcttsssss = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> this_is_my_object = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> o = &#123;&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> thisIsMyObject = &#123;&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">thisIsMyFunction</span>(<span class="params"></span>) </span>&#123;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨å¸•æ–¯å¡å¼å‘½åæ„é€ å‡½æ•°æˆ–ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">user</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = options.name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bad = <span class="keyword">new</span> user(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'nope'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">User</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = options.name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> good = <span class="keyword">new</span> User(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'yup'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿å‰/åç¼€ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆï¼ŸJavaScript å¹¶æ²¡æœ‰ç§æœ‰å±æ€§æˆ–ç§æœ‰æ–¹æ³•çš„æ¦‚å¿µã€‚è™½ç„¶ä½¿ç”¨ä¸‹åˆ’çº¿æ˜¯è¡¨ç¤ºã€Œç§æœ‰ã€çš„ä¸€ç§å…±è¯†ï¼Œä½†å®é™…ä¸Šè¿™äº›å±æ€§æ˜¯å®Œå…¨å…¬å¼€çš„ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä½ å…¬å…±æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§ä¹ æƒ¯æˆ–è®¸ä¼šå¯¼è‡´å¼€å‘è€…é”™è¯¯çš„è®¤ä¸ºæ”¹åŠ¨å®ƒä¸ä¼šé€ æˆç ´åæˆ–è€…ä¸éœ€è¦å»æµ‹è¯•ã€‚é•¿è¯çŸ­è¯´ï¼šå¦‚æœä½ æƒ³è¦æŸå¤„ä¸ºã€Œç§æœ‰ã€ï¼Œå®ƒå¿…é¡»ä¸èƒ½æ˜¯æ˜¾å¼æå‡ºçš„ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">this</span>.__firstName__ = <span class="string">'Panda'</span>;</div><div class="line"><span class="keyword">this</span>.firstName_ = <span class="string">'Panda'</span>;</div><div class="line"><span class="keyword">this</span>._firstName = <span class="string">'Panda'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">this</span>.firstName = <span class="string">'Panda'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦ä¿å­˜ <code>this</code> çš„å¼•ç”¨ã€‚ä½¿ç”¨ Function#bindã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(self);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(that);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(_this);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">  &#125;.bind(<span class="keyword">this</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ç»™å‡½æ•°å‘½åã€‚è¿™åœ¨åšå †æ ˆè½¨è¿¹æ—¶å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(msg);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">msg</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(msg);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>æ³¨ï¼š</strong> IE8 åŠä»¥ä¸‹ç‰ˆæœ¬å¯¹å‘½åå‡½æ•°è¡¨è¾¾å¼çš„å¤„ç†æœ‰äº›æ€ªå¼‚ã€‚äº†è§£æ›´å¤šä¿¡æ¯åˆ° <a href="http://kangax.github.io/nfe/" target="_blank" rel="external">http://kangax.github.io/nfe/</a>ã€‚</p>
</li>
<li><p>å¦‚æœä½ çš„æ–‡ä»¶å¯¼å‡ºä¸€ä¸ªç±»ï¼Œä½ çš„æ–‡ä»¶ååº”è¯¥ä¸ç±»åå®Œå…¨ç›¸åŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// file contents</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckBox</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = CheckBox;</div><div class="line"></div><div class="line"><span class="comment">// in some other file</span></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./checkBox'</span>);</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./check_box'</span>);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./CheckBox'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="å­˜å–å™¨"><a href="#å­˜å–å™¨" class="headerlink" title="å­˜å–å™¨"></a><a name="accessors">å­˜å–å™¨</a></h2><ul>
<li>å±æ€§çš„å­˜å–å‡½æ•°ä¸æ˜¯å¿…é¡»çš„ã€‚</li>
<li><p>å¦‚æœä½ éœ€è¦å­˜å–å‡½æ•°æ—¶ä½¿ç”¨ <code>getVal()</code> å’Œ <code>setVal(&#39;hello&#39;)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">dragon.age();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">dragon.getAge();</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">dragon.age(<span class="number">25</span>);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">dragon.setAge(<span class="number">25</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœå±æ€§æ˜¯å¸ƒå°”å€¼ï¼Œä½¿ç”¨ <code>isVal()</code> æˆ– <code>hasVal()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">if</span> (!dragon.age()) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">if</span> (!dragon.hasAge()) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»º get() å’Œ set() å‡½æ•°æ˜¯å¯ä»¥çš„ï¼Œä½†è¦ä¿æŒä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Jedi</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">  options || (options = &#123;&#125;);</div><div class="line">  <span class="keyword">var</span> lightsaber = options.lightsaber || <span class="string">'blue'</span>;</div><div class="line">  <span class="keyword">this</span>.set(<span class="string">'lightsaber'</span>, lightsaber);</div><div class="line">&#125;</div><div class="line"></div><div class="line">Jedi.prototype.set = <span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">key, val</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>[key] = val;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Jedi.prototype.get = <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">key</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>[key];</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a><a name="constructors">æ„é€ å‡½æ•°</a></h2><ul>
<li><p>ç»™å¯¹è±¡åŸå‹åˆ†é…æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸€ä¸ªæ–°å¯¹è±¡è¦†ç›–åŸå‹ã€‚è¦†ç›–åŸå‹å°†å¯¼è‡´ç»§æ‰¿å‡ºç°é—®é¢˜ï¼šé‡è®¾åŸå‹å°†è¦†ç›–åŸæœ‰åŸå‹ï¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Jedi</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'new jedi'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">Jedi.prototype = &#123;</div><div class="line">  <span class="attr">fight</span>: <span class="function"><span class="keyword">function</span> <span class="title">fight</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'fighting'</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">block</span>: <span class="function"><span class="keyword">function</span> <span class="title">block</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'blocking'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">Jedi.prototype.fight = <span class="function"><span class="keyword">function</span> <span class="title">fight</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'fighting'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Jedi.prototype.block = <span class="function"><span class="keyword">function</span> <span class="title">block</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'blocking'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>æ–¹æ³•å¯ä»¥è¿”å› <code>this</code> æ¥å®ç°æ–¹æ³•é“¾å¼ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">Jedi.prototype.jump = <span class="function"><span class="keyword">function</span> <span class="title">jump</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.jumping = <span class="literal">true</span>;</div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Jedi.prototype.setHeight = <span class="function"><span class="keyword">function</span> <span class="title">setHeight</span>(<span class="params">height</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.height = height;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> luke = <span class="keyword">new</span> Jedi();</div><div class="line">luke.jump(); <span class="comment">// =&gt; true</span></div><div class="line">luke.setHeight(<span class="number">20</span>); <span class="comment">// =&gt; undefined</span></div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">Jedi.prototype.jump = <span class="function"><span class="keyword">function</span> <span class="title">jump</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.jumping = <span class="literal">true</span>;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Jedi.prototype.setHeight = <span class="function"><span class="keyword">function</span> <span class="title">setHeight</span>(<span class="params">height</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.height = height;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> luke = <span class="keyword">new</span> Jedi();</div><div class="line"></div><div class="line">luke.jump()</div><div class="line">  .setHeight(<span class="number">20</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>toString()</code> æ–¹æ³•æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç¡®ä¿å®ƒå¯ä»¥æ­£å¸¸å·¥ä½œä¸”ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Jedi</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">  options || (options = &#123;&#125;);</div><div class="line">  <span class="keyword">this</span>.name = options.name || <span class="string">'no name'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Jedi.prototype.getName = <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Jedi.prototype.toString = <span class="function"><span class="keyword">function</span> <span class="title">toString</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'Jedi - '</span> + <span class="keyword">this</span>.getName();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a><a name="events">äº‹ä»¶</a></h2><ul>
<li><p>å½“ç»™äº‹ä»¶é™„åŠ æ•°æ®æ—¶ï¼ˆæ— è®ºæ˜¯ DOM äº‹ä»¶è¿˜æ˜¯ç§æœ‰äº‹ä»¶ï¼‰ï¼Œä¼ å…¥ä¸€ä¸ªå“ˆå¸Œè€Œä¸æ˜¯åŸå§‹å€¼ã€‚è¿™æ ·å¯ä»¥è®©åé¢çš„è´¡çŒ®è€…å¢åŠ æ›´å¤šæ•°æ®åˆ°äº‹ä»¶æ•°æ®è€Œæ— éœ€æ‰¾å‡ºå¹¶æ›´æ–°äº‹ä»¶çš„æ¯ä¸€ä¸ªå¤„ç†å™¨ã€‚ä¾‹å¦‚ï¼Œä¸å¥½çš„å†™æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">$(<span class="keyword">this</span>).trigger(<span class="string">'listingUpdated'</span>, listing.id);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">$(<span class="keyword">this</span>).on(<span class="string">'listingUpdated'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e, listingId</span>) </span>&#123;</div><div class="line">  <span class="comment">// do something with listingId</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ›´å¥½çš„å†™æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// good</span></div><div class="line">$(<span class="keyword">this</span>).trigger(<span class="string">'listingUpdated'</span>, &#123; <span class="attr">listingId</span> : listing.id &#125;);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">$(<span class="keyword">this</span>).on(<span class="string">'listingUpdated'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e, data</span>) </span>&#123;</div><div class="line">  <span class="comment">// do something with data.listingId</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
</li>
</ul>
<h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a><a name="modules">æ¨¡å—</a></h2><ul>
<li>æ¨¡å—åº”è¯¥ä»¥ <code>!</code> å¼€å§‹ã€‚è¿™æ ·ç¡®ä¿äº†å½“ä¸€ä¸ªä¸å¥½çš„æ¨¡å—å¿˜è®°åŒ…å«æœ€åçš„åˆ†å·æ—¶ï¼Œåœ¨åˆå¹¶ä»£ç åˆ°ç”Ÿäº§ç¯å¢ƒåä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚<a href="https://github.com/airbnb/javascript/issues/44#issuecomment-13063933" target="_blank" rel="external">è¯¦ç»†è¯´æ˜</a></li>
<li>æ–‡ä»¶åº”è¯¥ä»¥é©¼å³°å¼å‘½åï¼Œå¹¶æ”¾åœ¨åŒåçš„æ–‡ä»¶å¤¹é‡Œï¼Œä¸”ä¸å¯¼å‡ºçš„åå­—ä¸€è‡´ã€‚</li>
<li>å¢åŠ ä¸€ä¸ªåä¸º <code>noConflict()</code> çš„æ–¹æ³•æ¥è®¾ç½®å¯¼å‡ºçš„æ¨¡å—ä¸ºå‰ä¸€ä¸ªç‰ˆæœ¬å¹¶è¿”å›å®ƒã€‚</li>
<li><p>æ°¸è¿œåœ¨æ¨¡å—é¡¶éƒ¨å£°æ˜ <code>&#39;use strict&#39;;</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// fancyInput/fancyInput.js</span></div><div class="line"></div><div class="line">!<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> previousFancyInput = global.FancyInput;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">FancyInput</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.options = options || &#123;&#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  FancyInput.noConflict = <span class="function"><span class="keyword">function</span> <span class="title">noConflict</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    global.FancyInput = previousFancyInput;</div><div class="line">    <span class="keyword">return</span> FancyInput;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  global.FancyInput = FancyInput;</div><div class="line">&#125;(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a><a name="jquery">jQuery</a></h2><ul>
<li><p>ä½¿ç”¨ <code>$</code> ä½œä¸ºå­˜å‚¨ jQuery å¯¹è±¡çš„å˜é‡åå‰ç¼€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> sidebar = $(<span class="string">'.sidebar'</span>);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">var</span> $sidebar = $(<span class="string">'.sidebar'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>ç¼“å­˜ jQuery æŸ¥è¯¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setSidebar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  $(<span class="string">'.sidebar'</span>).hide();</div><div class="line"></div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line"></div><div class="line">  $(<span class="string">'.sidebar'</span>).css(&#123;</div><div class="line">    <span class="string">'background-color'</span>: <span class="string">'pink'</span></div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setSidebar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> $sidebar = $(<span class="string">'.sidebar'</span>);</div><div class="line">  $sidebar.hide();</div><div class="line"></div><div class="line">  <span class="comment">// ...stuff...</span></div><div class="line"></div><div class="line">  $sidebar.css(&#123;</div><div class="line">    <span class="string">'background-color'</span>: <span class="string">'pink'</span></div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å¯¹ DOM æŸ¥è¯¢ä½¿ç”¨å±‚å  <code>$(&#39;.sidebar ul&#39;)</code> æˆ– çˆ¶å…ƒç´  &gt; å­å…ƒç´  <code>$(&#39;.sidebar &gt; ul&#39;)</code>ã€‚ <a href="http://jsperf.com/jquery-find-vs-context-sel/16" target="_blank" rel="external">jsPerf</a></p>
</li>
<li><p>å¯¹æœ‰ä½œç”¨åŸŸçš„ jQuery å¯¹è±¡æŸ¥è¯¢ä½¿ç”¨ <code>find</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">$(<span class="string">'ul'</span>, <span class="string">'.sidebar'</span>).hide();</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">$(<span class="string">'.sidebar'</span>).find(<span class="string">'ul'</span>).hide();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">$(<span class="string">'.sidebar ul'</span>).hide();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">$(<span class="string">'.sidebar &gt; ul'</span>).hide();</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">$sidebar.find(<span class="string">'ul'</span>).hide();</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="ECMAScript-5-å…¼å®¹æ€§"><a href="#ECMAScript-5-å…¼å®¹æ€§" class="headerlink" title="ECMAScript 5 å…¼å®¹æ€§"></a><a name="ecmascript-5-compatibility">ECMAScript 5 å…¼å®¹æ€§</a></h2><ul>
<li>å‚è€ƒ <a href="https://twitter.com/kangax/" target="_blank" rel="external">Kangax</a> çš„ ES5 <a href="http://kangax.github.com/es5-compat-table/" target="_blank" rel="external">å…¼å®¹è¡¨</a>.</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a><a name="testing">æµ‹è¯•</a></h2><ul>
<li><p><strong>Yup.</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a><a name="performance">æ€§èƒ½</a></h2><ul>
<li><a href="http://kellegous.com/j/2013/01/26/layout-performance/" target="_blank" rel="external">On Layout &amp; Web Performance</a></li>
<li><a href="http://jsperf.com/string-vs-array-concat/2" target="_blank" rel="external">String vs Array Concat</a></li>
<li><a href="http://jsperf.com/try-catch-in-loop-cost" target="_blank" rel="external">Try/Catch Cost In a Loop</a></li>
<li><a href="http://jsperf.com/bang-function" target="_blank" rel="external">Bang Function</a></li>
<li><a href="http://jsperf.com/jquery-find-vs-context-sel/13" target="_blank" rel="external">jQuery Find vs Context, Selector</a></li>
<li><a href="http://jsperf.com/innerhtml-vs-textcontent-for-script-text" target="_blank" rel="external">innerHTML vs textContent for script text</a></li>
<li><a href="http://jsperf.com/ya-string-concat" target="_blank" rel="external">Long String Concatenation</a></li>
<li>Loadingâ€¦</li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a><a name="resources">èµ„æº</a></h2><p><strong>æ¨èé˜…è¯»</strong></p>
<ul>
<li><a href="http://es5.github.com/" target="_blank" rel="external">Annotated ECMAScript 5.1</a></li>
</ul>
<p><strong>å·¥å…·</strong></p>
<ul>
<li>Code Style Linters<ul>
<li><a href="http://www.jshint.com/" target="_blank" rel="external">JSHint</a> - <a href="https://github.com/airbnb/javascript/blob/master/linters/.jshintrc" target="_blank" rel="external">Airbnb Style .jshintrc</a></li>
<li><a href="https://github.com/jscs-dev/node-jscs" target="_blank" rel="external">JSCS</a> - <a href="https://github.com/jscs-dev/node-jscs/blob/master/presets/airbnb.json" target="_blank" rel="external">Airbnb Style Preset</a></li>
</ul>
</li>
</ul>
<p><strong>å…¶å®ƒé£æ ¼æŒ‡å—</strong></p>
<ul>
<li><a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml" target="_blank" rel="external">Google JavaScript Style Guide</a></li>
<li><a href="http://docs.jquery.com/JQuery_Core_Style_Guidelines" target="_blank" rel="external">jQuery Core Style Guidelines</a></li>
<li><a href="https://github.com/rwldrn/idiomatic.js/" target="_blank" rel="external">Principles of Writing Consistent, Idiomatic JavaScript</a></li>
<li><a href="https://github.com/feross/standard" target="_blank" rel="external">JavaScript Standard Style</a></li>
</ul>
<p><strong>å…¶å®ƒé£æ ¼</strong></p>
<ul>
<li><a href="https://gist.github.com/4135065" target="_blank" rel="external">Naming this in nested functions</a> - Christian Johansen</li>
<li><a href="https://github.com/airbnb/javascript/issues/52" target="_blank" rel="external">Conditional Callbacks</a> - Ross Allen</li>
<li><a href="http://sideeffect.kr/popularconvention/#javascript" target="_blank" rel="external">Popular JavaScript Coding Conventions on Github</a> - JeongHoon Byun</li>
<li><a href="http://benalman.com/news/2012/05/multiple-var-statements-javascript/" target="_blank" rel="external">Multiple var statements in JavaScript, not superfluous</a> - Ben Alman</li>
</ul>
<p><strong>è¿›ä¸€æ­¥é˜…è¯»</strong></p>
<ul>
<li><a href="http://javascriptweblog.wordpress.com/2010/10/25/understanding-javascript-closures/" target="_blank" rel="external">Understanding JavaScript Closures</a> - Angus Croll</li>
<li><a href="http://www.2ality.com/2013/06/basic-javascript.html" target="_blank" rel="external">Basic JavaScript for the impatient programmer</a> - Dr. Axel Rauschmayer</li>
<li><a href="http://youmightnotneedjquery.com/" target="_blank" rel="external">You Might Not Need jQuery</a> - Zack Bloom &amp; Adam Schwartz</li>
<li><a href="https://github.com/lukehoban/es6features" target="_blank" rel="external">ES6 Features</a> - Luke Hoban</li>
<li><a href="https://github.com/bendc/frontend-guidelines" target="_blank" rel="external">Frontend Guidelines</a> - Benjamin De Cock</li>
</ul>
<p><strong>ä¹¦ç±</strong></p>
<ul>
<li><a href="http://www.amazon.com/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742" target="_blank" rel="external">JavaScript: The Good Parts</a> - Douglas Crockford</li>
<li><a href="http://www.amazon.com/JavaScript-Patterns-Stoyan-Stefanov/dp/0596806752" target="_blank" rel="external">JavaScript Patterns</a> - Stoyan Stefanov</li>
<li><a href="http://www.amazon.com/JavaScript-Design-Patterns-Recipes-Problem-Solution/dp/159059908X" target="_blank" rel="external">Pro JavaScript Design Patterns</a>  - Ross Harmes and Dustin Diaz</li>
<li><a href="http://www.amazon.com/High-Performance-Web-Sites-Essential/dp/0596529309" target="_blank" rel="external">High Performance Web Sites: Essential Knowledge for Front-End Engineers</a> - Steve Souders</li>
<li><a href="http://www.amazon.com/Maintainable-JavaScript-Nicholas-C-Zakas/dp/1449327680" target="_blank" rel="external">Maintainable JavaScript</a> - Nicholas C. Zakas</li>
<li><a href="http://www.amazon.com/JavaScript-Web-Applications-Alex-MacCaw/dp/144930351X" target="_blank" rel="external">JavaScript Web Applications</a> - Alex MacCaw</li>
<li><a href="http://www.amazon.com/Pro-JavaScript-Techniques-John-Resig/dp/1590597273" target="_blank" rel="external">Pro JavaScript Techniques</a> - John Resig</li>
<li><a href="http://www.amazon.com/Smashing-Node-js-JavaScript-Everywhere-Magazine/dp/1119962595" target="_blank" rel="external">Smashing Node.js: JavaScript Everywhere</a> - Guillermo Rauch</li>
<li><a href="http://www.amazon.com/Secrets-JavaScript-Ninja-John-Resig/dp/193398869X" target="_blank" rel="external">Secrets of the JavaScript Ninja</a> - John Resig and Bear Bibeault</li>
<li><a href="http://humanjavascript.com/" target="_blank" rel="external">Human JavaScript</a> - Henrik Joreteg</li>
<li><a href="http://superherojs.com/" target="_blank" rel="external">Superhero.js</a> - Kim Joar Bekkelund, Mads MobÃ¦k, &amp; Olav Bjorkoy</li>
<li><a href="http://jsbooks.revolunet.com/" target="_blank" rel="external">JSBooks</a> - Julien Bouquillon</li>
<li><a href="http://manning.com/vinegar/" target="_blank" rel="external">Third Party JavaScript</a> - Ben Vinegar and Anton Kovalyov</li>
<li><a href="http://amzn.com/0321812182" target="_blank" rel="external">Effective JavaScript: 68 Specific Ways to Harness the Power of JavaScript</a> - David Herman</li>
<li><a href="http://eloquentjavascript.net" target="_blank" rel="external">Eloquent JavaScript</a> - Marijn Haverbeke</li>
<li><a href="https://github.com/getify/You-Dont-Know-JS" target="_blank" rel="external">You Donâ€™t Know JS</a> - Kyle Simpson</li>
</ul>
<p><strong>åšå®¢</strong></p>
<ul>
<li><a href="http://dailyjs.com/" target="_blank" rel="external">DailyJS</a></li>
<li><a href="http://javascriptweekly.com/" target="_blank" rel="external">JavaScript Weekly</a></li>
<li><a href="http://javascriptweblog.wordpress.com/" target="_blank" rel="external">JavaScript, JavaScriptâ€¦</a></li>
<li><a href="http://weblog.bocoup.com/" target="_blank" rel="external">Bocoup Weblog</a></li>
<li><a href="http://www.adequatelygood.com/" target="_blank" rel="external">Adequately Good</a></li>
<li><a href="http://www.nczonline.net/" target="_blank" rel="external">NCZOnline</a></li>
<li><a href="http://perfectionkills.com/" target="_blank" rel="external">Perfection Kills</a></li>
<li><a href="http://benalman.com/" target="_blank" rel="external">Ben Alman</a></li>
<li><a href="http://dmitry.baranovskiy.com/" target="_blank" rel="external">Dmitry Baranovskiy</a></li>
<li><a href="http://dustindiaz.com/" target="_blank" rel="external">Dustin Diaz</a></li>
<li><a href="http://net.tutsplus.com/?s=javascript" target="_blank" rel="external">nettuts</a></li>
</ul>
<p><strong>æ’­å®¢</strong></p>
<ul>
<li><a href="http://devchat.tv/js-jabber/" target="_blank" rel="external">JavaScript Jabber</a></li>
</ul>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h2 id="è°åœ¨ä½¿ç”¨"><a href="#è°åœ¨ä½¿ç”¨" class="headerlink" title="è°åœ¨ä½¿ç”¨"></a><a name="in-the-wild">è°åœ¨ä½¿ç”¨</a></h2><p>  è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨æœ¬é£æ ¼æŒ‡å—çš„ç»„ç»‡åˆ—è¡¨ã€‚ç»™æˆ‘ä»¬å‘ pull request æˆ–å¼€ä¸€ä¸ª issue è®©æˆ‘ä»¬å°†ä½ å¢åŠ åˆ°åˆ—è¡¨ä¸Šã€‚</p>
<ul>
<li><strong>Aan Zee</strong>: <a href="https://github.com/AanZee/javascript" target="_blank" rel="external">AanZee/javascript</a></li>
<li><strong>Adult Swim</strong>: <a href="https://github.com/adult-swim/javascript" target="_blank" rel="external">adult-swim/javascript</a></li>
<li><strong>Airbnb</strong>: <a href="https://github.com/airbnb/javascript" target="_blank" rel="external">airbnb/javascript</a></li>
<li><strong>Apartmint</strong>: <a href="https://github.com/apartmint/javascript" target="_blank" rel="external">apartmint/javascript</a></li>
<li><strong>Avalara</strong>: <a href="https://github.com/avalara/javascript" target="_blank" rel="external">avalara/javascript</a></li>
<li><strong>Billabong</strong>: <a href="https://github.com/billabong/javascript" target="_blank" rel="external">billabong/javascript</a></li>
<li><strong>Compass Learning</strong>: <a href="https://github.com/compasslearning/javascript-style-guide" target="_blank" rel="external">compasslearning/javascript-style-guide</a></li>
<li><strong>DailyMotion</strong>: <a href="https://github.com/dailymotion/javascript" target="_blank" rel="external">dailymotion/javascript</a></li>
<li><strong>Digitpaint</strong> <a href="https://github.com/digitpaint/javascript" target="_blank" rel="external">digitpaint/javascript</a></li>
<li><strong>Evernote</strong>: <a href="https://github.com/evernote/javascript-style-guide" target="_blank" rel="external">evernote/javascript-style-guide</a></li>
<li><strong>ExactTarget</strong>: <a href="https://github.com/ExactTarget/javascript" target="_blank" rel="external">ExactTarget/javascript</a></li>
<li><strong>Flexberry</strong>: <a href="https://github.com/Flexberry/javascript-style-guide" target="_blank" rel="external">Flexberry/javascript-style-guide</a></li>
<li><strong>Gawker Media</strong>: <a href="https://github.com/gawkermedia/javascript" target="_blank" rel="external">gawkermedia/javascript</a></li>
<li><strong>General Electric</strong>: <a href="https://github.com/GeneralElectric/javascript" target="_blank" rel="external">GeneralElectric/javascript</a></li>
<li><strong>GoodData</strong>: <a href="https://github.com/gooddata/gdc-js-style" target="_blank" rel="external">gooddata/gdc-js-style</a></li>
<li><strong>Grooveshark</strong>: <a href="https://github.com/grooveshark/javascript" target="_blank" rel="external">grooveshark/javascript</a></li>
<li><strong>How About We</strong>: <a href="https://github.com/howaboutwe/javascript" target="_blank" rel="external">howaboutwe/javascript</a></li>
<li><strong>InfoJobs</strong>: <a href="https://github.com/InfoJobs/JavaScript-Style-Guide" target="_blank" rel="external">InfoJobs/JavaScript-Style-Guide</a></li>
<li><strong>Intent Media</strong>: <a href="https://github.com/intentmedia/javascript" target="_blank" rel="external">intentmedia/javascript</a></li>
<li><strong>Jam3</strong>: <a href="https://github.com/Jam3/Javascript-Code-Conventions" target="_blank" rel="external">Jam3/Javascript-Code-Conventions</a></li>
<li><strong>JSSolutions</strong>: <a href="https://github.com/JSSolutions/javascript" target="_blank" rel="external">JSSolutions/javascript</a></li>
<li><strong>Kinetica Solutions</strong>: <a href="https://github.com/kinetica/javascript" target="_blank" rel="external">kinetica/javascript</a></li>
<li><strong>Mighty Spring</strong>: <a href="https://github.com/mightyspring/javascript" target="_blank" rel="external">mightyspring/javascript</a></li>
<li><strong>MinnPost</strong>: <a href="https://github.com/MinnPost/javascript" target="_blank" rel="external">MinnPost/javascript</a></li>
<li><strong>ModCloth</strong>: <a href="https://github.com/modcloth/javascript" target="_blank" rel="external">modcloth/javascript</a></li>
<li><strong>Money Advice Service</strong>: <a href="https://github.com/moneyadviceservice/javascript" target="_blank" rel="external">moneyadviceservice/javascript</a></li>
<li><strong>Muber</strong>: <a href="https://github.com/muber/javascript" target="_blank" rel="external">muber/javascript</a></li>
<li><strong>National Geographic</strong>: <a href="https://github.com/natgeo/javascript" target="_blank" rel="external">natgeo/javascript</a></li>
<li><strong>National Park Service</strong>: <a href="https://github.com/nationalparkservice/javascript" target="_blank" rel="external">nationalparkservice/javascript</a></li>
<li><strong>Nimbl3</strong>: <a href="https://github.com/nimbl3/javascript" target="_blank" rel="external">nimbl3/javascript</a></li>
<li><strong>Nordic Venture Family</strong>: <a href="https://github.com/CodeDistillery/javascript" target="_blank" rel="external">CodeDistillery/javascript</a></li>
<li><strong>Orion Health</strong>: <a href="https://github.com/orionhealth/javascript" target="_blank" rel="external">orionhealth/javascript</a></li>
<li><strong>Peerby</strong>: <a href="https://github.com/Peerby/javascript" target="_blank" rel="external">Peerby/javascript</a></li>
<li><strong>Razorfish</strong>: <a href="https://github.com/razorfish/javascript-style-guide" target="_blank" rel="external">razorfish/javascript-style-guide</a></li>
<li><strong>reddit</strong>: <a href="https://github.com/reddit/styleguide/tree/master/javascript" target="_blank" rel="external">reddit/styleguide/javascript</a></li>
<li><strong>REI</strong>: <a href="https://github.com/reidev/js-style-guide" target="_blank" rel="external">reidev/js-style-guide</a></li>
<li><strong>Ripple</strong>: <a href="https://github.com/ripple/javascript-style-guide" target="_blank" rel="external">ripple/javascript-style-guide</a></li>
<li><strong>SeekingAlpha</strong>: <a href="https://github.com/seekingalpha/javascript-style-guide" target="_blank" rel="external">seekingalpha/javascript-style-guide</a></li>
<li><strong>Shutterfly</strong>: <a href="https://github.com/shutterfly/javascript" target="_blank" rel="external">shutterfly/javascript</a></li>
<li><strong>StudentSphere</strong>: <a href="https://github.com/studentsphere/javascript" target="_blank" rel="external">studentsphere/javascript</a></li>
<li><strong>Super</strong>: <a href="https://github.com/SuperJobs/javascript" target="_blank" rel="external">SuperJobs/javascript</a></li>
<li><strong>SysGarage</strong>: <a href="https://github.com/sysgarage/javascript-style-guide" target="_blank" rel="external">sysgarage/javascript-style-guide</a></li>
<li><strong>Target</strong>: <a href="https://github.com/target/javascript" target="_blank" rel="external">target/javascript</a></li>
<li><strong>TheLadders</strong>: <a href="https://github.com/TheLadders/javascript" target="_blank" rel="external">TheLadders/javascript</a></li>
<li><strong>T4R Technology</strong>: <a href="https://github.com/T4R-Technology/javascript" target="_blank" rel="external">T4R-Technology/javascript</a></li>
<li><strong>VoxFeed</strong>: <a href="https://github.com/VoxFeed/javascript-style-guide" target="_blank" rel="external">VoxFeed/javascript-style-guide</a></li>
<li><strong>Weggo</strong>: <a href="https://github.com/Weggo/javascript" target="_blank" rel="external">Weggo/javascript</a></li>
<li><strong>Zillow</strong>: <a href="https://github.com/zillow/javascript" target="_blank" rel="external">zillow/javascript</a></li>
<li><strong>ZocDoc</strong>: <a href="https://github.com/ZocDoc/javascript" target="_blank" rel="external">ZocDoc/javascript</a></li>
</ul>
<h2 id="ç¿»è¯‘"><a href="#ç¿»è¯‘" class="headerlink" title="ç¿»è¯‘"></a><a name="translation">ç¿»è¯‘</a></h2><p>  è¿™ä»½é£æ ¼æŒ‡å—ä¹Ÿæä¾›äº†å…¶å®ƒè¯­è¨€çš„ç‰ˆæœ¬ï¼š</p>
<ul>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Brazil.png" alt="br"> <strong>Brazilian Portuguese</strong>: <a href="https://github.com/armoucar/javascript-style-guide" target="_blank" rel="external">armoucar/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Bulgaria.png" alt="bg"> <strong>Bulgarian</strong>: <a href="https://github.com/borislavvv/javascript" target="_blank" rel="external">borislavvv/javascript</a></li>
<li><img src="https://raw.githubusercontent.com/fpmweb/javascript-style-guide/master/img/catala.png" alt="ca"> <strong>Catalan</strong>: <a href="https://github.com/fpmweb/javascript-style-guide" target="_blank" rel="external">fpmweb/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Taiwan.png" alt="tw"> <strong>Chinese(Traditional)</strong>: <a href="https://github.com/jigsawye/javascript" target="_blank" rel="external">jigsawye/javascript</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/China.png" alt="cn"> <strong>Chinese(Simplified)</strong>: <a href="https://github.com/sivan/javascript" target="_blank" rel="external">sivan/javascript</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/France.png" alt="fr"> <strong>French</strong>: <a href="https://github.com/nmussy/javascript-style-guide" target="_blank" rel="external">nmussy/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Germany.png" alt="de"> <strong>German</strong>: <a href="https://github.com/timofurrer/javascript-style-guide" target="_blank" rel="external">timofurrer/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Italy.png" alt="it"> <strong>Italian</strong>: <a href="https://github.com/sinkswim/javascript-style-guide" target="_blank" rel="external">sinkswim/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Japan.png" alt="jp"> <strong>Japanese</strong>: <a href="https://github.com/mitsuruog/javacript-style-guide" target="_blank" rel="external">mitsuruog/javacript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/South-Korea.png" alt="kr"> <strong>Korean</strong>: <a href="https://github.com/tipjs/javascript-style-guide" target="_blank" rel="external">tipjs/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Poland.png" alt="pl"> <strong>Polish</strong>: <a href="https://github.com/mjurczyk/javascript" target="_blank" rel="external">mjurczyk/javascript</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Russia.png" alt="ru"> <strong>Russian</strong>: <a href="https://github.com/uprock/javascript" target="_blank" rel="external">uprock/javascript</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Spain.png" alt="es"> <strong>Spanish</strong>: <a href="https://github.com/paolocarrasco/javascript-style-guide" target="_blank" rel="external">paolocarrasco/javascript-style-guide</a></li>
<li><img src="https://raw.githubusercontent.com/gosquared/flags/master/flags/flags/shiny/24/Thailand.png" alt="th"> <strong>Thai</strong>: <a href="https://github.com/lvarayut/javascript-style-guide" target="_blank" rel="external">lvarayut/javascript-style-guide</a></li>
</ul>
<h2 id="JavaScript-é£æ ¼æŒ‡å—è¯´æ˜"><a href="#JavaScript-é£æ ¼æŒ‡å—è¯´æ˜" class="headerlink" title="JavaScript é£æ ¼æŒ‡å—è¯´æ˜"></a><a name="the-javascript-style-guide-guide">JavaScript é£æ ¼æŒ‡å—è¯´æ˜</a></h2><ul>
<li><a href="https://github.com/airbnb/javascript/wiki/The-JavaScript-Style-Guide-Guide" target="_blank" rel="external">Reference</a></li>
</ul>
<h2 id="ä¸æˆ‘ä»¬è®¨è®º-JavaScript"><a href="#ä¸æˆ‘ä»¬è®¨è®º-JavaScript" class="headerlink" title="ä¸æˆ‘ä»¬è®¨è®º JavaScript"></a><a name="chat-with-us-about-javascript">ä¸æˆ‘ä»¬è®¨è®º JavaScript</a></h2><ul>
<li>Find us on <a href="https://gitter.im/airbnb/javascript" target="_blank" rel="external">gitter</a>.</li>
</ul>
<h2 id="è´¡çŒ®è€…"><a href="#è´¡çŒ®è€…" class="headerlink" title="è´¡çŒ®è€…"></a><a name="contributors">è´¡çŒ®è€…</a></h2><ul>
<li><a href="https://github.com/airbnb/javascript/graphs/contributors" target="_blank" rel="external">View Contributors</a></li>
</ul>
<h2 id="è®¸å¯"><a href="#è®¸å¯" class="headerlink" title="è®¸å¯"></a><a name="license">è®¸å¯</a></h2><p>(The MIT License)</p>
<p>Copyright (c) 2014 Airbnb</p>
<p>Permission is hereby granted, free of charge, to any person obtaining<br>a copy of this software and associated documentation files (the<br>â€˜Softwareâ€™), to deal in the Software without restriction, including<br>without limitation the rights to use, copy, modify, merge, publish,<br>distribute, sublicense, and/or sell copies of the Software, and to<br>permit persons to whom the Software is furnished to do so, subject to<br>the following conditions:</p>
<p>The above copyright notice and this permission notice shall be<br>included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED â€˜AS ISâ€™, WITHOUT WARRANTY OF ANY KIND,<br>EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF<br>MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.<br>IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY<br>CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,<br>TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE<br>SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<p><strong><a href="#table-of-contents">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
<h1 id=""><a href="#" class="headerlink" title="};"></a>};</h1>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Airbnb-JavaScript-Style-Guide&quot;&gt;&lt;a href=&quot;#Airbnb-JavaScript-Style-Guide&quot; class=&quot;headerlink&quot; title=&quot;Airbnb JavaScript Style Guide() {&quot;
    
    </summary>
    
      <category term="Readme" scheme="https://phpsmarter.github.com/categories/Readme/"/>
    
    
      <category term="javascript" scheme="https://phpsmarter.github.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>React-native-tween-mixin</title>
    <link href="https://phpsmarter.github.com/2017/04/08/React-native-tween-mixin/"/>
    <id>https://phpsmarter.github.com/2017/04/08/React-native-tween-mixin/</id>
    <published>2017-04-07T18:03:58.000Z</published>
    <updated>2017-04-07T10:14:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="React-Tween-State"><a href="#React-Tween-State" class="headerlink" title="React Tween State"></a><a href="http://facebook.github.io/react/" target="_blank" rel="external">React</a> Tween State</h1><p>For React 0.13+ users: see the subtle differences [here] vs 0.12.</p>
<p>The equivalent of Reactâ€™s <code>this.setState</code>, but for animated tweening: <code>this.tweenState</code>.</p>
<p><a href="https://rawgit.com/chenglou/react-tween-state/master/examples/index.html" target="_blank" rel="external">Live demo</a> and <a href="https://github.com/chenglou/react-tween-state/tree/master/examples" target="_blank" rel="external">source</a>.</p>
<p>Npm:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install react-tween-state</div></pre></td></tr></table></figure></p>
<p>Bower:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bower install react-tween-state</div></pre></td></tr></table></figure></p>
<p><em>For Bower</em>: the single source file is <code>index-bower.js</code>.</p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p>Example usage:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tweenState = <span class="built_in">require</span>(<span class="string">'react-tween-state'</span>);</div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> App = React.createClass(&#123;</div><div class="line">  <span class="attr">mixins</span>: [tweenState.Mixin],</div><div class="line">  <span class="attr">getInitialState</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;<span class="attr">left</span>: <span class="number">0</span>&#125;;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">handleClick</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.tweenState(<span class="string">'left'</span>, &#123;</div><div class="line">      <span class="attr">easing</span>: tweenState.easingTypes.easeInOutQuad,</div><div class="line">      <span class="attr">duration</span>: <span class="number">500</span>,</div><div class="line">      <span class="attr">endValue</span>: <span class="keyword">this</span>.state.left === <span class="number">0</span> ? <span class="number">400</span> : <span class="number">0</span></div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> style = &#123;</div><div class="line">      <span class="attr">position</span>: <span class="string">'absolute'</span>,</div><div class="line">      <span class="attr">width</span>: <span class="number">50</span>,</div><div class="line">      <span class="attr">height</span>: <span class="number">50</span>,</div><div class="line">      <span class="attr">backgroundColor</span>: <span class="string">'lightblue'</span>,</div><div class="line">      <span class="attr">left</span>: <span class="keyword">this</span>.getTweeningValue(<span class="string">'left'</span>)</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span> /&gt;</span>;</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="General"><a href="#General" class="headerlink" title="General"></a>General</h3><h4 id="this-tweenState-stateNameString-configurationObject"><a href="#this-tweenState-stateNameString-configurationObject" class="headerlink" title="this.tweenState(stateNameString, configurationObject)"></a><code>this.tweenState(stateNameString, configurationObject)</code></h4><p>This immediately calls <code>setState</code> on your state name under the hood, and also creates a virtual â€œlayerâ€, in which your state didnâ€™t jump straight to the final value: rather, it is being tweened. <code>this.getTweeningValue(stateNameString)</code> lets you access the tweening value on that layer. Formal API below.</p>
<p><code>stateNameString</code> is the name of the state you want to tween.</p>
<p><code>configurationObject</code> is an object of the following format:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">easing</span>: easingFunction,</div><div class="line">  <span class="attr">duration</span>: timeInMilliseconds,</div><div class="line">  <span class="attr">delay</span>: timeInMilliseconds,</div><div class="line">  <span class="attr">beginValue</span>: aNumber,</div><div class="line">  <span class="attr">endValue</span>: aNumber,</div><div class="line">  <span class="attr">onEnd</span>: endCallback,</div><div class="line">  <span class="attr">stackBehavior</span>: behaviorOption</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><code>easing</code> (default: <code>tweenState.easingTypes.easeInOutQuad</code>): the interpolation function used. react-tween-state provides <a href="https://github.com/chenglou/react-tween-state/blob/master/easingTypes.js" target="_blank" rel="external">frequently used interpolation</a> (all exposed inside <code>tweenState.easingTypes</code>). In case you ever create your own, the function signature is: <code>(currentTime: Number, beginValue: Number, endValue: Number, totalDuration: Number): Number</code>.</li>
<li><code>duration</code> (default: <code>300</code>).</li>
<li><code>delay</code> (default: <code>0</code>). *</li>
<li><code>beginValue</code> (default: the current value the state being tweened, <code>this.state[stateNameString]</code>).</li>
<li><code>endValue</code>.</li>
<li><code>onEnd</code>: the callback to trigger when the animationâ€™s done. **</li>
<li><code>stackBehavior</code> (default: <code>tweenState.stackBehavior.ADDITIVE</code>). Subsequent tweening to the same state value will be stacked (added together). This gives a smooth tweening effect that is iOS 8â€™s new default. <a href="http://ronnqvi.st/multiple-animations/" target="_blank" rel="external">This blog post</a> describes it well. The other option is <code>tweenState.stackBehavior.DESTRUCTIVE</code>, which replaces all current animations of that state value by this new one.</li>
</ul>
<p>* For a destructive animation, starting the next one with a delay still immediately kills the previous tween. If thatâ€™s not your intention, try <code>setTimeout</code> or additive animation. <code>DESTRUCTIVE</code> + <code>duration</code> 0 effectively cancels all in-flight animations.</p>
<p>** For an additive animation, since the tweens stack and never get destroyed, the end callback is effectively fired at the end of <code>duration</code>.</p>
<h4 id="this-getTweeningValue-stateNameString"><a href="#this-getTweeningValue-stateNameString" class="headerlink" title="this.getTweeningValue(stateNameString)"></a><code>this.getTweeningValue(stateNameString)</code></h4><p>After you call <code>this.tweenState(...)</code>, the state value is set just like after a normal <code>setState()</code>. To actually get the current, tweening value of that state, youâ€™d use <code>this.getTweeningValue(stateNameString)</code> (typically used in <code>render</code>).</p>
<h3 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h3><h4 id="this-tweenState-stateRefFunction-stateNameString-configurationObject"><a href="#this-tweenState-stateRefFunction-stateNameString-configurationObject" class="headerlink" title="this.tweenState(stateRefFunction, stateNameString, configurationObject)"></a><code>this.tweenState(stateRefFunction, stateNameString, configurationObject)</code></h4><p>Sometimes, you want to tween not <code>this.state.myValue</code>, but the value in <code>this.state.myObject.myArray[4]</code>, in which case passing only a string of the state name isnâ€™t enough. The second form of <code>tweenState()</code> accepts a function and expects you to return the state path of the value you tween, like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">rectangles</span>: [</div><div class="line">      &#123;<span class="attr">x</span>: <span class="number">10</span>, <span class="attr">y</span>: <span class="number">20</span>&#125;,</div><div class="line">      &#123;<span class="attr">x</span>: <span class="number">10</span>, <span class="attr">y</span>: <span class="number">40</span>&#125;</div><div class="line">    ]</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ... tween this.state.rectangles[0].x</span></div><div class="line"><span class="keyword">this</span>.tweenState(<span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;<span class="keyword">return</span> state.rectangles[<span class="number">0</span>]&#125;, <span class="string">'x'</span>, configurationObject);</div></pre></td></tr></table></figure>
<p><code>configurationObject</code> is the same.</p>
<h4 id="this-getTweeningValue-stateRefFunction-stateNameString"><a href="#this-getTweeningValue-stateRefFunction-stateNameString" class="headerlink" title="this.getTweeningValue(stateRefFunction, stateNameString)"></a><code>this.getTweeningValue(stateRefFunction, stateNameString)</code></h4><p>See above. Usage: <code>this.getTweeningValue(function(state) {return state.rectangles[0]}, &#39;x&#39;)</code>.</p>
<h2 id="Goal-of-this-library"><a href="#Goal-of-this-library" class="headerlink" title="Goal of this library"></a>Goal of this library</h2><p>Reactâ€™s powerful model allows us to build apps the functional way. Having a sensible API for animation is a less explored area. This library leverages Reactâ€™s concept of state and render to let you specify transitions declaratively. If everything goes alright, we can make React expose powerful hooks to make this even better.</p>
<p>Part of a few animation API experimentations.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>BSD.</p>
<h2 id="tweençš„å®é™…ä»£ç "><a href="#tweençš„å®é™…ä»£ç " class="headerlink" title="tweençš„å®é™…ä»£ç "></a>tweençš„å®é™…ä»£ç </h2><h3 id="tweenå‡½æ•°"><a href="#tweenå‡½æ•°" class="headerlink" title="tweenå‡½æ•°"></a>tweenå‡½æ•°</h3><p><code>tweenå‡½æ•°çš„å®é™…ä»£ç </code><br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div></pre></td><td class="code"><pre><div class="line">use strict';</div><div class="line"></div><div class="line">var easingTypes = require('tween-functions');</div><div class="line"></div><div class="line">// additive is the new iOS <span class="number">8</span> <span class="keyword">default</span>. In most cases it simulates a physics-</div><div class="line">// looking overshoot behavior (especially with easeInOut. You can test that <span class="keyword">in</span></div><div class="line">// the example</div><div class="line">var DEFAULT_STACK_BEHAVIOR = 'ADDITIVE';</div><div class="line">var DEFAULT_EASING = easingTypes.easeInOutQuad;</div><div class="line">var DEFAULT_DURATION = <span class="number">300</span>;</div><div class="line">var DEFAULT_DELAY = <span class="number">0</span>;</div><div class="line"></div><div class="line">// see usage below</div><div class="line">function returnState(<span class="keyword">state</span>) &#123;</div><div class="line">  return <span class="keyword">state</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var tweenState = &#123;</div><div class="line">  easingTypes: easingTypes,</div><div class="line">  stackBehavior: &#123;</div><div class="line">    ADDITIVE: 'ADDITIVE',</div><div class="line">    DESTRUCTIVE: 'DESTRUCTIVE',</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">tweenState.Mixin = &#123;</div><div class="line">  getInitialState: function() &#123;</div><div class="line">    return &#123;</div><div class="line">      tweenQueue: [],</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  tweenState: function(a, b, c) &#123;</div><div class="line">    // tweenState(<span class="keyword">state</span>NameString, config)</div><div class="line">    // tweenState(<span class="keyword">state</span>RefFunc, <span class="keyword">state</span>NameString, config)</div><div class="line"></div><div class="line">    // passing a <span class="keyword">state</span> name string and retrieving it later <span class="keyword">from</span> this.<span class="keyword">state</span></div><div class="line">    // doesn't work <span class="keyword">for</span> values <span class="keyword">in</span> deeply nested collections (unless you design</div><div class="line">    // the API <span class="keyword">to</span> be able <span class="keyword">to</span> parse 'this.<span class="keyword">state</span>.my.nested[<span class="number">1</span>]', meh). Passing a</div><div class="line">    // direct, resolved reference wouldn't work either, since that reference</div><div class="line">    // points <span class="keyword">to</span> the old <span class="keyword">state</span> rather than the subsequent new ones.</div><div class="line">    if (typeof a === 'string') &#123;</div><div class="line">      c = b;</div><div class="line">      b = a;</div><div class="line">      a = returnState;</div><div class="line">    &#125;</div><div class="line">    this._tweenState(a, b, c);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _tweenState: function(<span class="keyword">state</span>RefFunc, <span class="keyword">state</span>Name, config) &#123;</div><div class="line">    // _pendingState doesn't exist <span class="keyword">in</span> React <span class="number">0.13</span> anymore. No harm leaving it</div><div class="line">    // here <span class="keyword">for</span> backward compat</div><div class="line">    var <span class="keyword">state</span> = this._pendingState || this.<span class="keyword">state</span>;</div><div class="line">    var <span class="keyword">state</span>Ref = <span class="keyword">state</span>RefFunc(<span class="keyword">state</span>);</div><div class="line"></div><div class="line">    // see the reasoning <span class="keyword">for</span> these defaults at the top</div><div class="line">    var newConfig = &#123;</div><div class="line">      easing: config.easing || DEFAULT_EASING,</div><div class="line">      duration: config.duration == null ? DEFAULT_DURATION : config.duration,</div><div class="line">      delay: config.delay == null ? DEFAULT_DELAY : config.delay,</div><div class="line">      beginValue: config.beginValue == null ? <span class="keyword">state</span>Ref[<span class="keyword">state</span>Name] : config.beginValue,</div><div class="line">      endValue: config.endValue,</div><div class="line">      <span class="keyword">on</span>End: config.<span class="keyword">on</span>End,</div><div class="line">      stackBehavior: config.stackBehavior || DEFAULT_STACK_BEHAVIOR,</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    var newTweenQueue = <span class="keyword">state</span>.tweenQueue;</div><div class="line">    if (newConfig.stackBehavior === tweenState.stackBehavior.DESTRUCTIVE) &#123;</div><div class="line">      newTweenQueue = <span class="keyword">state</span>.tweenQueue.filter(function(item) &#123;</div><div class="line">        return item.<span class="keyword">state</span>Name !== <span class="keyword">state</span>Name || item.<span class="keyword">state</span>RefFunc(<span class="keyword">state</span>) !== <span class="keyword">state</span>Ref;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    newTweenQueue.push(&#123;</div><div class="line">      <span class="keyword">state</span>RefFunc: <span class="keyword">state</span>RefFunc,</div><div class="line">      <span class="keyword">state</span>Name: <span class="keyword">state</span>Name,</div><div class="line">      config: newConfig,</div><div class="line">      initTime: Date.now() + newConfig.delay,</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    // tweenState calls <span class="built_in">set</span>State</div><div class="line">    // sorry <span class="keyword">for</span> mutating. No idea where <span class="keyword">in</span> the <span class="keyword">state</span> the value is</div><div class="line">    <span class="keyword">state</span>Ref[<span class="keyword">state</span>Name] = newConfig.endValue;</div><div class="line">    // this will also include the above update</div><div class="line">    this.<span class="built_in">set</span>State(&#123;tweenQueue: newTweenQueue&#125;);</div><div class="line"></div><div class="line">    if (newTweenQueue.length === <span class="number">1</span>) &#123;</div><div class="line">      this.startRaf();</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getTweeningValue: function(a, b) &#123;</div><div class="line">    // see tweenState API</div><div class="line">    if (typeof a === 'string') &#123;</div><div class="line">      b = a;</div><div class="line">      a = returnState;</div><div class="line">    &#125;</div><div class="line">    return this._getTweeningValue(a, b);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _getTweeningValue: function(<span class="keyword">state</span>RefFunc, <span class="keyword">state</span>Name) &#123;</div><div class="line">    var <span class="keyword">state</span> = this.<span class="keyword">state</span>;</div><div class="line">    var <span class="keyword">state</span>Ref = <span class="keyword">state</span>RefFunc(<span class="keyword">state</span>);</div><div class="line">    var tweeningValue = <span class="keyword">state</span>Ref[<span class="keyword">state</span>Name];</div><div class="line">    var now = Date.now();</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (var i = <span class="number">0</span>; i <span class="variable">&lt; state.tweenQueue.length; i++) &#123;</span></div><div class="line">      var item = state.tweenQueue[i];</div><div class="line">      var itemStateRef = item.stateRefFunc(state);</div><div class="line">      if (item.stateName !== stateName || itemStateRef !== stateRef) &#123;</div><div class="line">        continue;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      var progressTime = now - item.initTime &gt; item.config.duration ?</div><div class="line">        item.config.duration :</div><div class="line">        Math.<span class="keyword">max</span>(<span class="number">0</span>, now - item.initTime);</div><div class="line">      // `now - item.initTime` can be negative if initTime is scheduled <span class="keyword">in</span> the</div><div class="line">      // future by a delay. In this case we take <span class="number">0</span></div><div class="line"></div><div class="line">      var contrib = -item.config.endValue + item.config.easing(</div><div class="line">        progressTime,</div><div class="line">        item.config.beginValue,</div><div class="line">        item.config.endValue,</div><div class="line">        item.config.duration</div><div class="line">        // TODO: some funcs accept a <span class="number">5</span>th param</div><div class="line">      );</div><div class="line">      tweeningValue += contrib;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return tweeningValue;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _rafCb: function() &#123;</div><div class="line">    var <span class="keyword">state</span> = this.<span class="keyword">state</span>;</div><div class="line">    if (<span class="keyword">state</span>.tweenQueue.length === <span class="number">0</span>) &#123;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    var now = Date.now();</div><div class="line">    var newTweenQueue = [];</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (var i = <span class="number">0</span>; i <span class="variable">&lt; state.tweenQueue.length; i++) &#123;</span></div><div class="line">      var item = state.tweenQueue[i];</div><div class="line">      if (now - item.initTime &lt; item.config.duration) &#123;</div><div class="line">        newTweenQueue.push(item);</div><div class="line">      &#125; else &#123;</div><div class="line">        item.config.onEnd &amp;&amp; item.config.onEnd();</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // onEnd might trigger a parent callback that removes this component</div><div class="line">    if (!this.isMounted()) &#123;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    this.setState(&#123;</div><div class="line">      tweenQueue: newTweenQueue,</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    requestAnimationFrame(this._rafCb);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  startRaf: function() &#123;</div><div class="line">    requestAnimationFrame(this._rafCb);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line">module.exports = tweenState;</div></pre></td></tr></table></figure></p>
<h3 id="ease-type"><a href="#ease-type" class="headerlink" title="ease type"></a>ease type</h3><p><code>ease typeçš„å‡½æ•°</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="comment">// t: current time, b: beginning value, _c: final value, d: total duration</span></div><div class="line"><span class="keyword">var</span> tweenFunctions = &#123;</div><div class="line">  <span class="attr">linear</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * t / d + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInQuad</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * (t /= d) * t + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutQuad</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> -c * (t /= d) * (t - <span class="number">2</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutQuad</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * t * t + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> -c / <span class="number">2</span> * ((--t) * (t - <span class="number">2</span>) - <span class="number">1</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInCubic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * (t /= d) * t * t + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutCubic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * ((t = t / d - <span class="number">1</span>) * t * t + <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutCubic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * t * t * t + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * ((t -= <span class="number">2</span>) * t * t + <span class="number">2</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInQuart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * (t /= d) * t * t * t + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutQuart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> -c * ((t = t / d - <span class="number">1</span>) * t * t * t - <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutQuart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * t * t * t * t + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> -c / <span class="number">2</span> * ((t -= <span class="number">2</span>) * t * t * t - <span class="number">2</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInQuint</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * (t /= d) * t * t * t * t + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutQuint</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * ((t = t / d - <span class="number">1</span>) * t * t * t * t + <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutQuint</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * t * t * t * t * t + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * ((t -= <span class="number">2</span>) * t * t * t * t + <span class="number">2</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInSine</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> -c * <span class="built_in">Math</span>.cos(t / d * (<span class="built_in">Math</span>.PI / <span class="number">2</span>)) + c + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutSine</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * <span class="built_in">Math</span>.sin(t / d * (<span class="built_in">Math</span>.PI / <span class="number">2</span>)) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutSine</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> -c / <span class="number">2</span> * (<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI * t / d) - <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInExpo</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> _ref;</div><div class="line">    <span class="keyword">return</span> (_ref = t === <span class="number">0</span>) !== <span class="literal">null</span> ? _ref : &#123;</div><div class="line">      <span class="attr">b</span>: c * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">10</span> * (t / d - <span class="number">1</span>)) + b</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutExpo</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> _ref;</div><div class="line">    <span class="keyword">return</span> (_ref = t === d) !== <span class="literal">null</span> ? _ref : b + &#123;</div><div class="line">      <span class="attr">c</span>: c * (-<span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">-10</span> * t / d) + <span class="number">1</span>) + b</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutExpo</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> (t === <span class="number">0</span>) &#123;</div><div class="line">      b;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (t === d) &#123;</div><div class="line">      b + c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">10</span> * (t - <span class="number">1</span>)) + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * (-<span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">-10</span> * --t) + <span class="number">2</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInCirc</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> -c * (<span class="built_in">Math</span>.sqrt(<span class="number">1</span> - (t /= d) * t) - <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutCirc</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">return</span> c * <span class="built_in">Math</span>.sqrt(<span class="number">1</span> - (t = t / d - <span class="number">1</span>) * t) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutCirc</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> -c / <span class="number">2</span> * (<span class="built_in">Math</span>.sqrt(<span class="number">1</span> - t * t) - <span class="number">1</span>) + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * (<span class="built_in">Math</span>.sqrt(<span class="number">1</span> - (t -= <span class="number">2</span>) * t) + <span class="number">1</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInElastic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> a, p, s;</div><div class="line">    s = <span class="number">1.70158</span>;</div><div class="line">    p = <span class="number">0</span>;</div><div class="line">    a = c;</div><div class="line">    <span class="keyword">if</span> (t === <span class="number">0</span>) &#123;</div><div class="line">      b;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((t /= d) === <span class="number">1</span>) &#123;</div><div class="line">      b + c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!p) &#123;</div><div class="line">      p = d * <span class="number">0.3</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (a &lt; <span class="built_in">Math</span>.abs(c)) &#123;</div><div class="line">      a = c;</div><div class="line">      s = p / <span class="number">4</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      s = p / (<span class="number">2</span> * <span class="built_in">Math</span>.PI) * <span class="built_in">Math</span>.asin(c / a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -(a * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">10</span> * (t -= <span class="number">1</span>)) * <span class="built_in">Math</span>.sin((t * d - s) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI) / p)) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutElastic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> a, p, s;</div><div class="line">    s = <span class="number">1.70158</span>;</div><div class="line">    p = <span class="number">0</span>;</div><div class="line">    a = c;</div><div class="line">    <span class="keyword">if</span> (t === <span class="number">0</span>) &#123;</div><div class="line">      b;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((t /= d) === <span class="number">1</span>) &#123;</div><div class="line">      b + c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!p) &#123;</div><div class="line">      p = d * <span class="number">0.3</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (a &lt; <span class="built_in">Math</span>.abs(c)) &#123;</div><div class="line">      a = c;</div><div class="line">      s = p / <span class="number">4</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      s = p / (<span class="number">2</span> * <span class="built_in">Math</span>.PI) * <span class="built_in">Math</span>.asin(c / a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">-10</span> * t) * <span class="built_in">Math</span>.sin((t * d - s) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI) / p) + c + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutElastic</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> a, p, s;</div><div class="line">    s = <span class="number">1.70158</span>;</div><div class="line">    p = <span class="number">0</span>;</div><div class="line">    a = c;</div><div class="line">    <span class="keyword">if</span> (t === <span class="number">0</span>) &#123;</div><div class="line">      b;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) === <span class="number">2</span>) &#123;</div><div class="line">      b + c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!p) &#123;</div><div class="line">      p = d * (<span class="number">0.3</span> * <span class="number">1.5</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (a &lt; <span class="built_in">Math</span>.abs(c)) &#123;</div><div class="line">      a = c;</div><div class="line">      s = p / <span class="number">4</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      s = p / (<span class="number">2</span> * <span class="built_in">Math</span>.PI) * <span class="built_in">Math</span>.asin(c / a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (t &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="number">-0.5</span> * (a * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">10</span> * (t -= <span class="number">1</span>)) * <span class="built_in">Math</span>.sin((t * d - s) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI) / p)) + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> a * <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">-10</span> * (t -= <span class="number">1</span>)) * <span class="built_in">Math</span>.sin((t * d - s) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI) / p) * <span class="number">0.5</span> + c + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInBack</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d, s</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> (s === <span class="keyword">void</span> <span class="number">0</span>) &#123;</div><div class="line">      s = <span class="number">1.70158</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> c * (t /= d) * t * ((s + <span class="number">1</span>) * t - s) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutBack</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d, s</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> (s === <span class="keyword">void</span> <span class="number">0</span>) &#123;</div><div class="line">      s = <span class="number">1.70158</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> c * ((t = t / d - <span class="number">1</span>) * t * ((s + <span class="number">1</span>) * t + s) + <span class="number">1</span>) + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutBack</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d, s</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> (s === <span class="keyword">void</span> <span class="number">0</span>) &#123;</div><div class="line">      s = <span class="number">1.70158</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ((t /= d / <span class="number">2</span>) &lt; <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * (t * t * (((s *= <span class="number">1.525</span>) + <span class="number">1</span>) * t - s)) + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c / <span class="number">2</span> * ((t -= <span class="number">2</span>) * t * (((s *= <span class="number">1.525</span>) + <span class="number">1</span>) * t + s) + <span class="number">2</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInBounce</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> v;</div><div class="line">    v = tweenFunctions.easeOutBounce(d - t, <span class="number">0</span>, c, d);</div><div class="line">    <span class="keyword">return</span> c - v + b;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeOutBounce</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">if</span> ((t /= d) &lt; <span class="number">1</span> / <span class="number">2.75</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c * (<span class="number">7.5625</span> * t * t) + b;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t &lt; <span class="number">2</span> / <span class="number">2.75</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c * (<span class="number">7.5625</span> * (t -= <span class="number">1.5</span> / <span class="number">2.75</span>) * t + <span class="number">0.75</span>) + b;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t &lt; <span class="number">2.5</span> / <span class="number">2.75</span>) &#123;</div><div class="line">      <span class="keyword">return</span> c * (<span class="number">7.5625</span> * (t -= <span class="number">2.25</span> / <span class="number">2.75</span>) * t + <span class="number">0.9375</span>) + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> c * (<span class="number">7.5625</span> * (t -= <span class="number">2.625</span> / <span class="number">2.75</span>) * t + <span class="number">0.984375</span>) + b;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">easeInOutBounce</span>: <span class="function"><span class="keyword">function</span>(<span class="params">t, b, _c, d</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> c = _c - b;</div><div class="line">    <span class="keyword">var</span> v;</div><div class="line">    <span class="keyword">if</span> (t &lt; d / <span class="number">2</span>) &#123;</div><div class="line">      v = tweenFunctions.easeInBounce(t * <span class="number">2</span>, <span class="number">0</span>, c, d);</div><div class="line">      <span class="keyword">return</span> v * <span class="number">0.5</span> + b;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      v = tweenFunctions.easeOutBounce(t * <span class="number">2</span> - d, <span class="number">0</span>, c, d);</div><div class="line">      <span class="keyword">return</span> v * <span class="number">0.5</span> + c * <span class="number">0.5</span> + b;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = tweenFunctions;</div><div class="line">s</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;React-Tween-State&quot;&gt;&lt;a href=&quot;#React-Tween-State&quot; class=&quot;headerlink&quot; title=&quot;React Tween State&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://facebook.github.io/
    
    </summary>
    
      <category term="Readme" scheme="https://phpsmarter.github.com/categories/Readme/"/>
    
    
      <category term="React-native" scheme="https://phpsmarter.github.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼|javascriptç¼“å­˜å‡½æ•°</title>
    <link href="https://phpsmarter.github.com/2017/04/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-javascript%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0/"/>
    <id>https://phpsmarter.github.com/2017/04/07/è®¾è®¡æ¨¡å¼-javascriptç¼“å­˜å‡½æ•°/</id>
    <published>2017-04-07T09:42:46.000Z</published>
    <updated>2017-04-07T01:45:09.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p><code>vscodeçš„ä»£ç å—</code></p>
<hr>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> functionName = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> funcMemoized = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> cacheKey = <span class="built_in">JSON</span>.stringify(<span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>));</div><div class="line">    <span class="keyword">var</span> result;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!funcMemoized.cache.hasOwnProperty(cacheKey)) &#123;</div><div class="line">        <span class="comment">// your expensive computation goes here</span></div><div class="line">        <span class="comment">// to reference the paramaters passed, use arguments[n]</span></div><div class="line">        <span class="comment">// eg.: result = arguments[0] + arguments[1];</span></div><div class="line">        funcMemoized.cache[cacheKey] = result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> funcMemoized.cache[cacheKey];</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  funcMemoized.cache = &#123;&#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> funcMemoized;</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;vscodeçš„ä»£ç å—&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://phpsmarter.github.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="javascript" scheme="https://phpsmarter.github.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>redux-logger</title>
    <link href="https://phpsmarter.github.com/2017/04/07/redux-logger/"/>
    <id>https://phpsmarter.github.com/2017/04/07/redux-logger/</id>
    <published>2017-04-07T00:57:13.000Z</published>
    <updated>2017-04-06T17:38:40.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Logger-for-Redux"><a href="#Logger-for-Redux" class="headerlink" title="Logger for Redux"></a>Logger for Redux</h1><p><a href="https://www.npmjs.com/package/redux-logger" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-logger.svg?maxAge=2592000?style=plastic" alt="npm"></a><br><a href="https://www.npmjs.com/package/redux-logger" target="_blank" rel="external"><img src="https://img.shields.io/npm/dm/redux-logger.svg?maxAge=2592000?style=plastic" alt="npm"></a><br><a href="https://travis-ci.org/evgenyrodionov/redux-logger" target="_blank" rel="external"><img src="https://travis-ci.org/evgenyrodionov/redux-logger.svg?branch=master" alt="Build Status"></a></p>
<p><img src="http://i.imgur.com/CgAuHlE.png" alt="redux-logger"></p>
<h2 id="Table-of-contents"><a href="#Table-of-contents" class="headerlink" title="Table of contents"></a>Table of contents</h2><ul>
<li><a href="#install">Install</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#options">Options</a></li>
<li><a href="#recipes">Recipes</a><ul>
<li><a href="#log-only-in-development">Log only in development</a></li>
<li><a href="#log-everything-except-actions-with-certain-type">Log everything except actions with certain type</a></li>
<li><a href="#collapse-actions-with-certain-type">Collapse actions with certain type</a></li>
<li><a href="#transform-immutable-without-combinereducers">Transform Immutable (without <code>combineReducers</code>)</a></li>
<li><a href="#transform-immutable-with-combinereducers">Transform Immutable (with <code>combineReducers</code>)</a></li>
<li><a href="#log-batched-actions">Log batched actions</a></li>
</ul>
</li>
<li><a href="#to-do">To Do</a></li>
<li><a href="#known-issues">Known issues</a> (with <code>react-native</code> only at this moment)</li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p><code>npm i --save redux-logger</code></p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; applyMiddleware, createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="comment">// Logger with default options</span></div><div class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span></div><div class="line"><span class="keyword">const</span> store = createStore(</div><div class="line">  reducer,</div><div class="line">  applyMiddleware(logger)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// Note passing middleware as the third argument requires redux@&gt;=3.1.0</span></div></pre></td></tr></table></figure>
<p>Or you can create your own logger with custom <a href="https://github.com/evgenyrodionov/redux-logger#options" target="_blank" rel="external">options</a>:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; applyMiddleware, createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createLogger &#125; <span class="keyword">from</span> <span class="string">'redux-logger'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> logger = createLogger(&#123;</div><div class="line">  <span class="comment">// ...options</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(</div><div class="line">  reducer,</div><div class="line">  applyMiddleware(logger)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>Note: logger <strong>must be</strong> the last middleware in chain, otherwise it will log thunk and promise, not actual actions (<a href="https://github.com/evgenyrodionov/redux-logger/issues/20" target="_blank" rel="external">#20</a>).</p>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  predicate, <span class="comment">// if specified this function will be called before each action is processed with this middleware.</span></div><div class="line">  collapsed, <span class="comment">// takes a Boolean or optionally a Function that receives `getState` function for accessing current store state and `action` object as parameters. Returns `true` if the log group should be collapsed, `false` otherwise.</span></div><div class="line">  duration = <span class="literal">false</span>: <span class="built_in">Boolean</span>, <span class="comment">// print the duration of each action?</span></div><div class="line">  timestamp = <span class="literal">true</span>: <span class="built_in">Boolean</span>, <span class="comment">// print the timestamp with each action?</span></div><div class="line"></div><div class="line">  level = <span class="string">'log'</span>: <span class="string">'log'</span> | <span class="string">'console'</span> | <span class="string">'warn'</span> | <span class="string">'error'</span> | <span class="string">'info'</span>, <span class="comment">// console's level</span></div><div class="line">  colors: ColorsObject, <span class="comment">// colors for title, prev state, action and next state: https://github.com/evgenyrodionov/redux-logger/blob/master/src/defaults.js#L12-L18</span></div><div class="line">  titleFormatter, <span class="comment">// Format the title used when logging actions.</span></div><div class="line"></div><div class="line">  stateTransformer, <span class="comment">// Transform state before print. Eg. convert Immutable object to plain JSON.</span></div><div class="line">  actionTransformer, <span class="comment">// Transform action before print. Eg. convert Immutable object to plain JSON.</span></div><div class="line">  errorTransformer, <span class="comment">// Transform error before print. Eg. convert Immutable object to plain JSON.</span></div><div class="line"></div><div class="line">  logger = <span class="built_in">console</span>: LoggerObject, <span class="comment">// implementation of the `console` API.</span></div><div class="line">  logErrors = <span class="literal">true</span>: <span class="built_in">Boolean</span>, <span class="comment">// should the logger catch, log, and re-throw errors?</span></div><div class="line"></div><div class="line">  diff = <span class="literal">false</span>: <span class="built_in">Boolean</span>, <span class="comment">// (alpha) show diff between states?</span></div><div class="line">  diffPredicate <span class="comment">// (alpha) filter function for showing states diff, similar to `predicate`</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Options-description"><a href="#Options-description" class="headerlink" title="Options description"></a>Options description</h3><h4 id="level-String-Function-Object"><a href="#level-String-Function-Object" class="headerlink" title="level (String | Function | Object)"></a><strong>level (String | Function | Object)</strong></h4><p>Level of <code>console</code>. <code>warn</code>, <code>error</code>, <code>info</code> or <a href="https://developer.mozilla.org/en/docs/Web/API/console" target="_blank" rel="external">else</a>.</p>
<p>It can be a function <code>(action: Object) =&gt; level: String</code>.</p>
<p>It can be an object with level string for: <code>prevState</code>, <code>action</code>, <code>nextState</code>, <code>error</code></p>
<p>It can be an object with getter functions: <code>prevState</code>, <code>action</code>, <code>nextState</code>, <code>error</code>. Useful if you want to print<br>message based on specific state or action. Set any of them to <code>false</code> if you want to hide it.</p>
<ul>
<li><code>prevState(prevState: Object) =&gt; level: String</code></li>
<li><code>action(action: Object) =&gt; level: String</code></li>
<li><code>nextState(nextState: Object) =&gt; level: String</code></li>
<li><code>error(error: Any, prevState: Object) =&gt; level: String</code></li>
</ul>
<p><em>Default: <code>log</code></em></p>
<h4 id="duration-Boolean"><a href="#duration-Boolean" class="headerlink" title="duration (Boolean)"></a><strong>duration (Boolean)</strong></h4><p>Print duration of each action?</p>
<p><em>Default: <code>false</code></em></p>
<h4 id="timestamp-Boolean"><a href="#timestamp-Boolean" class="headerlink" title="timestamp (Boolean)"></a><strong>timestamp (Boolean)</strong></h4><p>Print timestamp with each action?</p>
<p><em>Default: <code>true</code></em></p>
<h4 id="colors-Object"><a href="#colors-Object" class="headerlink" title="colors (Object)"></a><strong>colors (Object)</strong></h4><p>Object with color getter functions: <code>title</code>, <code>prevState</code>, <code>action</code>, <code>nextState</code>, <code>error</code>. Useful if you want to paint<br>message based on specific state or action. Set any of them to <code>false</code> if you want to show plain message without colors.</p>
<ul>
<li><code>title(action: Object) =&gt; color: String</code></li>
<li><code>prevState(prevState: Object) =&gt; color: String</code></li>
<li><code>action(action: Object) =&gt; color: String</code></li>
<li><code>nextState(nextState: Object) =&gt; color: String</code></li>
<li><code>error(error: Any, prevState: Object) =&gt; color: String</code></li>
</ul>
<h4 id="logger-Object"><a href="#logger-Object" class="headerlink" title="logger (Object)"></a><strong>logger (Object)</strong></h4><p>Implementation of the <code>console</code> API. Useful if you are using a custom, wrapped version of <code>console</code>.</p>
<p><em>Default: <code>console</code></em></p>
<h4 id="logErrors-Boolean"><a href="#logErrors-Boolean" class="headerlink" title="logErrors (Boolean)"></a><strong>logErrors (Boolean)</strong></h4><p>Should the logger catch, log, and re-throw errors? This makes it clear which action triggered the error but makes â€œbreak<br>on errorâ€ in dev tools harder to use, as it breaks on re-throw rather than the original throw location.</p>
<p><em>Default: <code>true</code></em></p>
<h4 id="collapsed-getState-Function-action-Object-logEntry-Object-gt-Boolean"><a href="#collapsed-getState-Function-action-Object-logEntry-Object-gt-Boolean" class="headerlink" title="collapsed = (getState: Function, action: Object, logEntry: Object) =&gt; Boolean"></a><strong>collapsed = (getState: Function, action: Object, logEntry: Object) =&gt; Boolean</strong></h4><p>Takes a boolean or optionally a function that receives <code>getState</code> function for accessing current store state and <code>action</code> object as parameters. Returns <code>true</code> if the log group should be collapsed, <code>false</code> otherwise.</p>
<p><em>Default: <code>false</code></em></p>
<h4 id="predicate-getState-Function-action-Object-gt-Boolean"><a href="#predicate-getState-Function-action-Object-gt-Boolean" class="headerlink" title="predicate = (getState: Function, action: Object) =&gt; Boolean"></a><strong>predicate = (getState: Function, action: Object) =&gt; Boolean</strong></h4><p>If specified this function will be called before each action is processed with this middleware.<br>Receives <code>getState</code> function for  accessing current store state and <code>action</code> object as parameters. Returns <code>true</code> if action should be logged, <code>false</code> otherwise.</p>
<p><em>Default: <code>null</code> (always log)</em></p>
<h4 id="stateTransformer-state-Object-gt-state"><a href="#stateTransformer-state-Object-gt-state" class="headerlink" title="stateTransformer = (state: Object) =&gt; state"></a><strong>stateTransformer = (state: Object) =&gt; state</strong></h4><p>Transform state before print. Eg. convert Immutable object to plain JSON.</p>
<p><em>Default: identity function</em></p>
<h4 id="actionTransformer-action-Object-gt-action"><a href="#actionTransformer-action-Object-gt-action" class="headerlink" title="actionTransformer = (action: Object) =&gt; action"></a><strong>actionTransformer = (action: Object) =&gt; action</strong></h4><p>Transform action before print. Eg. convert Immutable object to plain JSON.</p>
<p><em>Default: identity function</em></p>
<h4 id="errorTransformer-error-Any-gt-error"><a href="#errorTransformer-error-Any-gt-error" class="headerlink" title="errorTransformer = (error: Any) =&gt; error"></a><strong>errorTransformer = (error: Any) =&gt; error</strong></h4><p>Transform error before print.</p>
<p><em>Default: identity function</em></p>
<h4 id="titleFormatter-action-Object-time-String-took-Number-gt-title"><a href="#titleFormatter-action-Object-time-String-took-Number-gt-title" class="headerlink" title="titleFormatter = (action: Object, time: String?, took: Number?) =&gt; title"></a><strong>titleFormatter = (action: Object, time: String?, took: Number?) =&gt; title</strong></h4><p>Format the title used for each action.</p>
<p><em>Default: prints something like <code>action @ ${time} ${action.type} (in ${took.toFixed(2)} ms)</code></em></p>
<h4 id="diff-Boolean"><a href="#diff-Boolean" class="headerlink" title="diff (Boolean)"></a><strong>diff (Boolean)</strong></h4><p>Show states diff.</p>
<p><em>Default: <code>false</code></em></p>
<h4 id="diffPredicate-getState-Function-action-Object-gt-Boolean"><a href="#diffPredicate-getState-Function-action-Object-gt-Boolean" class="headerlink" title="diffPredicate = (getState: Function, action: Object) =&gt; Boolean"></a><strong>diffPredicate = (getState: Function, action: Object) =&gt; Boolean</strong></h4><p>Filter states diff for certain cases.</p>
<p><em>Default: <code>undefined</code></em></p>
<h2 id="Using-redux-presist"><a href="#Using-redux-presist" class="headerlink" title="Using redux-presist"></a>Using redux-presist</h2><p>add some extra code<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; compose,applyMiddleware, createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;autoRehydrate&#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span>;</div><div class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span>;</div><div class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'../reducers'</span>;</div><div class="line"><span class="built_in">console</span>.log(logger);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">configureStore</span>(<span class="params">initialState</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> createStore(</div><div class="line">    rootReducer,</div><div class="line">    initialState,</div><div class="line">    compose(</div><div class="line">    applyMiddleware(logger),</div><div class="line">    autoRehydrate()</div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//using compose function</span></div></pre></td></tr></table></figure></p>
<h2 id="Recipes"><a href="#Recipes" class="headerlink" title="Recipes"></a>Recipes</h2><h3 id="Log-only-in-development"><a href="#Log-only-in-development" class="headerlink" title="Log only in development"></a>Log only in development</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> middlewares = [];</div><div class="line"></div><div class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">`development`</span>) &#123;</div><div class="line">  <span class="keyword">const</span> &#123; logger &#125; = <span class="built_in">require</span>(<span class="string">`redux-logger`</span>);</div><div class="line"></div><div class="line">  middlewares.push(logger);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = compose(applyMiddleware(...middlewares))(createStore)(reducer);</div></pre></td></tr></table></figure>
<h3 id="Log-everything-except-actions-with-certain-type"><a href="#Log-everything-except-actions-with-certain-type" class="headerlink" title="Log everything except actions with certain type"></a>Log everything except actions with certain type</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">createLogger(&#123;</div><div class="line">  <span class="attr">predicate</span>: <span class="function">(<span class="params">getState, action</span>) =&gt;</span> action.type !== AUTH_REMOVE_TOKEN</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Collapse-actions-with-certain-type"><a href="#Collapse-actions-with-certain-type" class="headerlink" title="Collapse actions with certain type"></a>Collapse actions with certain type</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">createLogger(&#123;</div><div class="line">  <span class="attr">collapsed</span>: <span class="function">(<span class="params">getState, action</span>) =&gt;</span> action.type === FORM_CHANGE</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Collapse-actions-that-donâ€™t-have-errors"><a href="#Collapse-actions-that-donâ€™t-have-errors" class="headerlink" title="Collapse actions that donâ€™t have errors"></a>Collapse actions that donâ€™t have errors</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">createLogger(&#123;</div><div class="line">  <span class="attr">collapsed</span>: <span class="function">(<span class="params">getState, action, logEntry</span>) =&gt;</span> !logEntry.error</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Transform-Immutable-without-combineReducers"><a href="#Transform-Immutable-without-combineReducers" class="headerlink" title="Transform Immutable (without combineReducers)"></a>Transform Immutable (without <code>combineReducers</code>)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Iterable &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> stateTransformer = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (Iterable.isIterable(state)) <span class="keyword">return</span> state.toJS();</div><div class="line">  <span class="keyword">else</span> <span class="keyword">return</span> state;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> logger = createLogger(&#123;</div><div class="line">  stateTransformer,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Transform-Immutable-with-combineReducers"><a href="#Transform-Immutable-with-combineReducers" class="headerlink" title="Transform Immutable (with combineReducers)"></a>Transform Immutable (with <code>combineReducers</code>)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> logger = createLogger(&#123;</div><div class="line">  <span class="attr">stateTransformer</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> newState = &#123;&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">of</span> <span class="built_in">Object</span>.keys(state)) &#123;</div><div class="line">      <span class="keyword">if</span> (Immutable.Iterable.isIterable(state[i])) &#123;</div><div class="line">        newState[i] = state[i].toJS();</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        newState[i] = state[i];</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> newState;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Log-batched-actions"><a href="#Log-batched-actions" class="headerlink" title="Log batched actions"></a>Log batched actions</h3><p>Thanks to <a href="https://github.com/smashercosmo" target="_blank" rel="external">@smashercosmo</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> createLogger <span class="keyword">from</span> <span class="string">'redux-logger'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> actionTransformer = <span class="function"><span class="params">action</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'BATCHING_REDUCER.BATCH'</span>) &#123;</div><div class="line">    action.payload.type = action.payload.map(<span class="function"><span class="params">next</span> =&gt;</span> next.type).join(<span class="string">' =&gt; '</span>);</div><div class="line">    <span class="keyword">return</span> action.payload;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> action;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> level = <span class="string">'info'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> logger = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">const</span> method <span class="keyword">in</span> <span class="built_in">console</span>) &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">console</span>[method] === <span class="string">'function'</span>) &#123;</div><div class="line">    logger[method] = <span class="built_in">console</span>[method].bind(<span class="built_in">console</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">logger[level] = <span class="function"><span class="keyword">function</span> <span class="title">levelFn</span>(<span class="params">...args</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> lastArg = args.pop();</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(lastArg)) &#123;</div><div class="line">    <span class="keyword">return</span> lastArg.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>[level].apply(<span class="built_in">console</span>, [...args, item]);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="built_in">console</span>[level].apply(<span class="built_in">console</span>, <span class="built_in">arguments</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> createLogger(&#123;</div><div class="line">  level,</div><div class="line">  actionTransformer,</div><div class="line">  logger</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="To-Do"><a href="#To-Do" class="headerlink" title="To Do"></a>To Do</h2><ul>
<li>[x] Update eslint config to <a href="https://www.npmjs.com/package/eslint-config-airbnb" target="_blank" rel="external">airbnbâ€™s</a></li>
<li>[ ] Clean up code, because itâ€™s very messy, to be honest</li>
<li>[ ] Write tests</li>
<li>[ ] Node.js support</li>
<li>[ ] React-native support</li>
</ul>
<p>Feel free to create PR for any of those tasks!</p>
<h2 id="Known-issues"><a href="#Known-issues" class="headerlink" title="Known issues"></a>Known issues</h2><ul>
<li>Performance issues in react-native (<a href="https://github.com/evgenyrodionov/redux-logger/issues/32" target="_blank" rel="external">#32</a>)</li>
</ul>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Logger-for-Redux&quot;&gt;&lt;a href=&quot;#Logger-for-Redux&quot; class=&quot;headerlink&quot; title=&quot;Logger for Redux&quot;&gt;&lt;/a&gt;Logger for Redux&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https
    
    </summary>
    
      <category term="Readme" scheme="https://phpsmarter.github.com/categories/Readme/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼,è¿”ç’å½’çœŸF8(2)</title>
    <link href="https://phpsmarter.github.com/2017/04/06/%E4%B9%B1%E8%8A%B1%E6%B8%90%E6%AC%B2%E8%BF%B7%E4%BA%BA%E7%9C%BC-%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9FF8-2/"/>
    <id>https://phpsmarter.github.com/2017/04/06/ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼-è¿”ç’å½’çœŸF8-2/</id>
    <published>2017-04-06T10:45:08.000Z</published>
    <updated>2017-04-06T12:29:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…¥å£å’Œé…ç½®æ–‡ä»¶"><a href="#å…¥å£å’Œé…ç½®æ–‡ä»¶" class="headerlink" title="å…¥å£å’Œé…ç½®æ–‡ä»¶"></a>å…¥å£å’Œé…ç½®æ–‡ä»¶</h1><h2 id="F8APP-js-setup-jsæ–‡ä»¶"><a href="#F8APP-js-setup-jsæ–‡ä»¶" class="headerlink" title="./F8APP/js/setup.jsæ–‡ä»¶"></a>./F8APP/js/setup.jsæ–‡ä»¶</h2><blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ä»index.ios.jsæ–‡ä»¶é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°äº†</p>
</blockquote>
<p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1fed886n41zj306g0ac74b.jpg" alt=""><br><code>setup.js</code>æ–‡ä»¶<br><code>./F8APP/js/setup.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> F8App = <span class="built_in">require</span>(<span class="string">'F8App'</span>);<span class="comment">//ä¸»ç¨‹åºæ–‡ä»¶çš„å…¥å£</span></div><div class="line"><span class="keyword">var</span> FacebookSDK = <span class="built_in">require</span>(<span class="string">'FacebookSDK'</span>);<span class="comment">//å¤„ç†facebookç™»å½•å’Œå¥½å‹çš„API</span></div><div class="line"><span class="keyword">var</span> Parse = <span class="built_in">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//parseçš„å®¢æˆ·ç«¯</span></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</div><div class="line"><span class="keyword">var</span> Relay = <span class="built_in">require</span>(<span class="string">'react-relay'</span>);<span class="comment">//reactç¨‹åºçš„ç»„ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨Relayçš„æ•°æ®å±‚,è¿™ä¸ªåœ¨infoè¿™ä¸ªç»„ä»¶ä¸­ä½¿ç”¨</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; Provider &#125; = <span class="built_in">require</span>(<span class="string">'react-redux'</span>);<span class="comment">//Reduxçš„åŒ…è£…å™¨</span></div><div class="line"><span class="keyword">var</span> configureStore = <span class="built_in">require</span>(<span class="string">'./store/configureStore'</span>);<span class="comment">//store</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;serverURL&#125; = <span class="built_in">require</span>(<span class="string">'./env'</span>);<span class="comment">//ç¯å¢ƒé…ç½®ï¼Œæ˜¯parseseverçš„é…ç½®åœ°å€</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>): <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="built_in">console</span>.disableYellowBox = <span class="literal">true</span>;</div><div class="line">  <span class="comment">//parseServeråé¢ä¼šç»“åˆleancloudæ¥çœ‹çœ‹ä»£ç ,ä¸¤è€…çš„APIæ˜¯ä¸€æ ·çš„</span></div><div class="line">  Parse.initialize(<span class="string">'oss-f8-app-2016'</span>);<span class="comment">//åˆå§‹åŒ–ä¸€ä¸ªparse</span></div><div class="line">  Parse.serverURL = <span class="string">`<span class="subst">$&#123;serverURL&#125;</span>/parse`</span>;<span class="comment">//parseçš„urlåœ°å€</span></div><div class="line"></div><div class="line">  FacebookSDK.init();<span class="comment">//åˆå§‹åŒ–Facebookçš„é…ç½®</span></div><div class="line">  Parse.FacebookUtils.init();</div><div class="line">  Relay.injectNetworkLayer(<span class="comment">//Realyæ•°æ®å±‚çš„é…ç½®</span></div><div class="line">    <span class="keyword">new</span> Relay.DefaultNetworkLayer(<span class="string">`<span class="subst">$&#123;serverURL&#125;</span>/graphql`</span>, &#123;</div><div class="line">      <span class="attr">fetchTimeout</span>: <span class="number">30000</span>,</div><div class="line">      <span class="attr">retryDelays</span>: [<span class="number">5000</span>, <span class="number">10000</span>],</div><div class="line">    &#125;)</div><div class="line">  );</div><div class="line"></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Root</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">      <span class="keyword">super</span>();</div><div class="line">      <span class="keyword">this</span>.state = &#123;<span class="comment">//åˆå§‹åŒ–state</span></div><div class="line">        isLoading: <span class="literal">true</span>,</div><div class="line">        <span class="attr">store</span>: configureStore(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123;<span class="attr">isLoading</span>: <span class="literal">false</span>&#125;)),</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.state.isLoading) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> (<span class="comment">//æ³¨å…¥storeç»™uiç»„ä»¶ä½¿ç”¨</span></div><div class="line">        &lt;Provider store=&#123;<span class="keyword">this</span>.state.store&#125;&gt;</div><div class="line">          <span class="xml"><span class="tag">&lt;<span class="name">F8App</span> /&gt;</span></span></div><div class="line">        <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Root;</div><div class="line">&#125;</div><div class="line"></div><div class="line">global.LOG = <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'/------------------------------\\'</span>);</div><div class="line">  <span class="built_in">console</span>.log(...args);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'\\------------------------------/'</span>);</div><div class="line">  <span class="keyword">return</span> args[args.length - <span class="number">1</span>];</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = setup;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªæ–‡ä»¶åœ¨å»å¹´é˜…è¯»çš„æ—¶å€™ç›´æ¥å¿½ç•¥äº†.æœ€è¿‘ç ”ç©¶äº†parseServerçš„æœ¬åœ°éƒ¨ç½²å’Œç›¸å…³çš„graphqlçš„ä½¿ç”¨ä»¥åŠleancloudçš„ä½¿ç”¨,æ‰å‘ç°è¿™ä¸ªéƒ¨åˆ†çœŸçš„æ˜¯éå¸¸ä¾¿åˆ©.åªè¦æ˜¯æœ‰äº†æ•°æ®å¯¹è±¡æœ€å¥½è¿˜èƒ½æœ‰schema,model.åå°åŸºæœ¬éƒ½ä¸éœ€è¦äº†.å½“ç„¶ä¸å¯èƒ½æ˜¯å®Œå…¨æ›¿ä»£æœåŠ¡å™¨çš„æ‰€æœ‰åŠŸèƒ½.è¿™ä¸ªåˆ°äº†ç›¸åº”çš„åœ°æ–¹å†è¯´.</p>
<p>æ¥ä¸‹æ¥æ˜¯F8APPçš„å…¥å£æ–‡ä»¶</p>
<h2 id="F8APP-js-F8App-js"><a href="#F8APP-js-F8App-js" class="headerlink" title="./F8APP/js/F8App.js"></a>./F8APP/js/F8App.js</h2><p><code>./F8APP/js/F8App.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> </span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</div><div class="line"><span class="keyword">var</span> AppState = <span class="built_in">require</span>(<span class="string">'AppState'</span>);</div><div class="line"><span class="keyword">var</span> LoginScreen = <span class="built_in">require</span>(<span class="string">'./login/LoginScreen'</span>);<span class="comment">//ç™»å½•ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> PushNotificationsController = <span class="built_in">require</span>(<span class="string">'./PushNotificationsController'</span>);<span class="comment">//æ¨é€ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> StyleSheet = <span class="built_in">require</span>(<span class="string">'StyleSheet'</span>);</div><div class="line"><span class="keyword">var</span> F8Navigator = <span class="built_in">require</span>(<span class="string">'F8Navigator'</span>);<span class="comment">//å¯¼èˆªç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> CodePush = <span class="built_in">require</span>(<span class="string">'react-native-code-push'</span>);<span class="comment">//çƒ­æ›´æ–°ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> View = <span class="built_in">require</span>(<span class="string">'View'</span>);</div><div class="line"><span class="keyword">var</span> StatusBar = <span class="built_in">require</span>(<span class="string">'StatusBar'</span>);<span class="comment">//çŠ¶æ€æ ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> &#123;<span class="comment">//è¿™é‡Œçš„æ¯ä¸€actionæœ€ç»ˆéƒ½ä¼šå½¢æˆstateè¿™æ£µæ ‘ä¸‹çš„æ¬¡çº§åˆ†æ</span></div><div class="line">  <span class="comment">//åå­—éƒ½éå¸¸çš„é†’ç›®å’Œç›´æ¥,æˆ‘ä»¬å¯ä»¥ç›´æ¥å…ˆçœ‹actionå’Œreduceréƒ½å¹²äº†äº›ä»€ä¹ˆå·¥ä½œ</span></div><div class="line">  loadConfig,</div><div class="line">  loadMaps,</div><div class="line">  loadNotifications,</div><div class="line">  loadSessions,</div><div class="line">  loadFriendsSchedules,</div><div class="line">  loadSurveys,</div><div class="line">&#125; = <span class="built_in">require</span>(<span class="string">'./actions'</span>);<span class="comment">//åŠ è½½åˆå§‹åŒ–é…ç½®çš„action</span></div><div class="line"><span class="comment">//è¿™ä¸ªåœ°æ–¹çš„åˆå§‹åŒ–çš„ä¸€äº›stateæ˜¯åœ¨è¿™é‡ŒåŠ è½½çš„,å¯¹æ¯”ireadingè½¯ä»¶çš„//å†…å®¹åŠ è½½æ˜¯åœ¨ç»„ä»¶ä¸­çš„componentdidMountåŠ è½½çš„,æ”¾åœ¨è¿™é‡Œæ€§èƒ½æ˜¯ä¸//æ˜¯æœ‰äº›ä¼˜åŒ–,</span></div><div class="line"><span class="keyword">var</span> &#123; updateInstallation &#125; = <span class="built_in">require</span>(<span class="string">'./actions/installation'</span>);</div><div class="line"><span class="keyword">var</span> &#123; connect &#125; = <span class="built_in">require</span>(<span class="string">'react-redux'</span>);<span class="comment">//connectå‡½æ•°</span></div><div class="line"><span class="comment">//æ²¡æƒ³åˆ°åœ¨è¿™é‡Œä¹Ÿæ˜¯å¯ä»¥ç”¨çš„,åœ¨f8appä¸­é‚£ä¸ªç»„ä»¶è¦ä½¿ç”¨stateå’Œdispatchå°±åœ¨å“ªé‡Œå¯¼å…¥connectå‡½æ•°.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">'./env.js'</span>);<span class="comment">//è·å–å½“å‰ç‰ˆæœ¬å·ç </span></div><div class="line"></div><div class="line"><span class="keyword">var</span> F8App = React.createClass(&#123;</div><div class="line">  <span class="attr">componentDidMount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="comment">//ç›‘å¬changeäº‹ä»¶</span></div><div class="line">    AppState.addEventListener(<span class="string">'change'</span>, <span class="keyword">this</span>.handleAppStateChange);</div><div class="line"></div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> Make this list smaller, we basically download the whole internet</span></div><div class="line">    <span class="comment">//è¿™ä¸ªåœ°æ–¹åœ¨å…ˆäºUIç»„ä»¶ä¹‹å‰åŠ è½½äº†æ‰€æœ‰çš„stateï¼Œ</span></div><div class="line">    <span class="comment">//æ ¹æ®UIå¯¼èˆªçš„é»˜è®¤é¡¹æ˜¯sessionï¼Œæˆ‘è§‰å¾—è¿™é‡Œå¯ä»¥å…ˆåŠ è½½//sessionè¿™ä¸ªstateï¼Œåœ¨é¦–é¡µåŠ è½½çš„æ—¶å€™é€Ÿåº¦å°±å¿«äº†,å…¶ä»–çš„//stateåœ¨åˆ‡æ¢åˆ°éœ€è¦æŸéƒ¨åˆ†çš„stateçš„æ—¶å€™åœ¨åŠ è½½</span></div><div class="line">    <span class="comment">//æ˜¯ä¸æ˜¯æƒ°æ€§åŠ è½½çš„æ„æ€ï¼Ÿ</span></div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadNotifications());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadMaps());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadConfig());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadSessions());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadFriendsSchedules());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadSurveys());</div><div class="line"></div><div class="line">    updateInstallation(&#123;version&#125;);<span class="comment">//çƒ­æ›´æ–°ç‰ˆæœ¬.</span></div><div class="line">    CodePush.sync(&#123;<span class="attr">installMode</span>: CodePush.InstallMode.ON_NEXT_RESUME&#125;);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">componentWillUnmount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="comment">//ç§»é™¤changeäº‹ä»¶</span></div><div class="line">    AppState.removeEventListener(<span class="string">'change'</span>, <span class="keyword">this</span>.handleAppStateChange);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">handleAppStateChange</span>: <span class="function"><span class="keyword">function</span>(<span class="params">appState</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (appState === <span class="string">'active'</span>) &#123;<span class="comment">//åœ¨çº¿å°±åˆ†å‘åŠ¨ä½œ</span></div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadSessions());</div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadNotifications());</div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadSurveys());</div><div class="line">      CodePush.sync(&#123;<span class="attr">installMode</span>: CodePush.InstallMode.ON_NEXT_RESUME&#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//ä¸‹é¢è¿™ä¸ªåœ°æ–¹å¯¹äºåˆå­¦reduxçš„å°±æœ‰ç‚¹ç»•äº†</span></div><div class="line">    <span class="comment">//åœ¨reducer/user.jsä¸­å®šä¹‰äº†åˆå§‹åŒ–çš„state,isLoggedIn</span></div><div class="line">    <span class="comment">//å°±æ˜¯falseï¼Œæ‰€ä»¥åˆæ¬¡åŠ è½½çš„æ—¶å€™å°±ä¼šæ˜¾ç¤ºç™»å½•æŒ‰é’®äº†</span></div><div class="line">    <span class="comment">//å¦‚æœç™»å½•äº†ä»¥åæ ¹æ®ç™»å½•å›è°ƒå‡½æ•°çš„è¿”å›å€¼æ¥ä¿®æ”¹isLoggedInçš„stateä¸º//trueï¼ŒåŒæ—¶ç”±äºè¿˜ä½¿ç”¨äº†redux-presistçš„ç»„ä»¶æŒä¹…åŒ–stateï¼Œåœ¨ä¸‹ä¸€//æ¬¡æ‰“å¼€çš„æ—¶å€™å°±ä¸ä¼šæ˜¾ç¤ºç™»å½•æŒ‰é’®äº†</span></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.props.isLoggedIn) &#123;</div><div class="line">      <span class="keyword">return</span> &lt;LoginScreen /&gt;;</div><div class="line">    &#125;</div><div class="line">    return (//å¦‚æœå·²ç»ç™»å½•è¿‡å°±ç›´æ¥æ˜¾ç¤ºå¯¼èˆªç•Œé¢äº†.</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;StatusBar</div><div class="line">          translucent=&#123;true&#125;</div><div class="line">          backgroundColor="rgba(0, 0, 0, 0.2)"</div><div class="line">          barStyle="light-content"</div><div class="line">         /&gt;</div><div class="line">        &lt;F8Navigator /&gt;</div><div class="line">        &lt;PushNotificationsController /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">var styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: 1,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">function select(store) &#123;//è¿™é‡Œåªéœ€è¦è·å–æ˜¯å¦ç™»å½•çš„stateå°±å¯ä»¥äº†</div><div class="line">  //selectå‡½æ•°æˆªå–å’Œæ˜ å°„ç»„ä»¶éœ€è¦çš„é‚£éƒ¨åˆ†stateï¼Œè¿™å’Œæ•°æ®åº“æ˜¯ä¸€æ ·çš„</div><div class="line">  //select * from è·å–æ‰€æœ‰çš„æ•°æ®, åŠ äº†whereæ¡ä»¶å°±ä¼šè¿”å›ä¸€éƒ¨åˆ†æ•°æ®</div><div class="line">  return &#123;</div><div class="line">    isLoggedIn: store.user.isLoggedIn || store.user.hasSkippedLogin,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">module.exports = connect(select)(F8App);</div></pre></td></tr></table></figure>
<h2 id="connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™"><a href="#connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™" class="headerlink" title="connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™"></a>connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™</h2><p>å¦‚æœä½ å¯¹äºreact-reduxæœ‰äº†ä¸€å®šäº†è§£,ä¼šåœ¨connect()ä¸­æ‰¾dispatchåœ¨å“ªé‡Œï¼Ÿå®é™…ä¸Šå¦‚æœæ²¡æœ‰<code>mapDiaptchToProps</code>ä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„,åœ¨<code>node_modules/react-redux/commponents/connect.js</code><br><code>connect.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//éƒ¨åˆ†ä»£ç </span></div><div class="line"> <span class="keyword">const</span> defaultMapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> (&#123; dispatch &#125;)<span class="comment">//ä¸ä¼ é€’ä¹Ÿæ˜¯å¯ä»¥çš„</span></div><div class="line"> </div><div class="line"> <span class="keyword">let</span> mapDispatch</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> mapDispatchToProps === <span class="string">'function'</span>) &#123;</div><div class="line">    mapDispatch = mapDispatchToProps</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!mapDispatchToProps) &#123;<span class="comment">//å¦‚æœæ²¡ä¼ dispatchå‡½æ•°</span></div><div class="line">  <span class="comment">//å°±æ˜¯é»˜è®¤çš„å‚æ•°,è¿˜æ˜¯dispatch</span></div><div class="line">    mapDispatch = defaultMapDispatchToProps</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    mapDispatch = wrapActionCreators(mapDispatchToProps)</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>å…¥å£æ–‡ä»¶å’Œåˆå§‹åŒ–é…ç½®å’ŒåŠ è½½é¡¹å°±çœ‹è¿™ä¹ˆå¤š,ä¸‹é¢æˆ‘ä»¬ç›´æ¥å…ˆè·³åˆ°reducerç›®å½•<br>çœ‹çœ‹æ•°æ®stateæ˜¯æ€ä¹ˆç»„ç»‡çš„.</p>
<h1 id="Reduceræ–‡ä»¶å¤¹çš„å†…å®¹"><a href="#Reduceræ–‡ä»¶å¤¹çš„å†…å®¹" class="headerlink" title="Reduceræ–‡ä»¶å¤¹çš„å†…å®¹"></a>Reduceræ–‡ä»¶å¤¹çš„å†…å®¹</h1><p><img src="https://ww4.sinaimg.cn/large/006tNc79ly1fed889pmbej305509z0sn.jpg" alt="å›¾ç‰‡2 reducerçš„ç»“æ„ç›®å½•"><br>é™¤äº†æµ‹è¯•æ–‡ä»¶å¤¹å’Œå‡æ•°æ®æ–‡ä»¶å¤¹å’ŒcreateParseReducer.jsæ–‡ä»¶,å…¶ä»–çš„æ–‡ä»¶éƒ½å¯¼å…¥åˆ°index.jsæ–‡ä»¶</p>
<h2 id="F8App-reducers-index-js"><a href="#F8App-reducers-index-js" class="headerlink" title="./F8App/reducers/index.js"></a><code>./F8App/reducers/index.js</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; combineReducers &#125; = <span class="built_in">require</span>(<span class="string">'redux'</span>);</div><div class="line"><span class="comment">//æ¯ä¸ªå¯¼å…¥çš„æ–‡ä»¶éƒ½æ˜¯å¯¹è±¡,combinReducerså‡½æ•°è´Ÿè´£æŠŠå°å¯¹è±¡åˆæˆä¸€ä¸ªå¤§çš„å•ä¸€å¯¹è±¡.</span></div><div class="line"><span class="comment">//å¦‚æœæ˜¯å¤šäººå¼€å‘æˆ‘è§‰å¾—å¯ä»¥æ¯ä¸ªå¼€å‘è€…ï¼šä¸€ä¸ªç»„ä»¶-ä¸€ç»„ç›¸å…³çš„actions-</span></div><div class="line"><span class="comment">//-ä¸€ä¸ªå•ä¸€çš„reducer,å¦‚æœæ¯”å–»çš„è¯åƒæ˜¯ä¸€æ ¹ç²—ç»³å­,å®é™…æ˜¯æœ‰å°è‚¡çš„ç»³å­æ‹§åœ¨</span></div><div class="line"><span class="comment">//ä¸€èµ·å½¢æˆçš„,å„è‡ªåœ¨å‡ºåŠ›,æ—è¾¹çš„å°è‚¡å¦‚æœå‡ºé—®é¢˜äº†ä¸å½±å“å…¶ä»–éƒ¨åˆ†.</span></div><div class="line"><span class="built_in">module</span>.exports = combineReducers(&#123;</div><div class="line">  <span class="attr">config</span>: <span class="built_in">require</span>(<span class="string">'./config'</span>),</div><div class="line">  <span class="attr">notifications</span>: <span class="built_in">require</span>(<span class="string">'./notifications'</span>),</div><div class="line">  <span class="attr">maps</span>: <span class="built_in">require</span>(<span class="string">'./maps'</span>),</div><div class="line">  <span class="attr">sessions</span>: <span class="built_in">require</span>(<span class="string">'./sessions'</span>),</div><div class="line">  <span class="attr">user</span>: <span class="built_in">require</span>(<span class="string">'./user'</span>),</div><div class="line">  <span class="attr">schedule</span>: <span class="built_in">require</span>(<span class="string">'./schedule'</span>),</div><div class="line">  <span class="attr">topics</span>: <span class="built_in">require</span>(<span class="string">'./topics'</span>),</div><div class="line">  <span class="attr">filter</span>: <span class="built_in">require</span>(<span class="string">'./filter'</span>),</div><div class="line">  <span class="attr">navigation</span>: <span class="built_in">require</span>(<span class="string">'./navigation'</span>),</div><div class="line">  <span class="attr">friendsSchedules</span>: <span class="built_in">require</span>(<span class="string">'./friendsSchedules'</span>),</div><div class="line">  <span class="attr">surveys</span>: <span class="built_in">require</span>(<span class="string">'./surveys'</span>),</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//ç°åœ¨åœ¨æˆ‘çœ¼é‡Œï¼Œindex.jså°±æ˜¯ä¸€ä¸ªæ•°æ®åº“,å…¶ä¸­çš„æ¯ä¸€ä¸ªreducerå°±æ˜¯ä¸€å¼ ã€æ•°</span></div><div class="line"><span class="comment">//æ®è¡¨,è¿™ä¹ˆæ¯”å–»æˆ‘è§‰å¾—è¿˜æ˜¯å¯ä»¥æ¥å—çš„,æœ‰åŠ©äºæ¦‚å¿µçš„ç†è§£</span></div></pre></td></tr></table></figure>
<ul>
<li>åœ¨æ•°æ®åº“ä¸­æ•°æ®åº“çš„åå­—åªæ˜¯ä¸€ä¸ªæ ‡ç¤º,çœŸæ­£å®ç°å…·ä½“å†…å®¹çš„æ˜¯æ¯å¼ è¡¨çš„å†…å®¹,æ‰€ä»¥è¦å…·ä½“çœ‹çœ‹æ¯ä¸ª<code>è¡¨(state)</code>éƒ½æ˜¯æœ‰å“ªäº›å†…å®¹.çŸ¥é“äº†è¡¨é‡Œçš„å†…å®¹,å°±å¯ä»¥ç›¸åº”çš„ç†è§£å¯¹äºè¡¨çš„æ“ä½œæ–¹æ³•(action).</li>
<li><p>combinReducersçš„æºç å®é™…å°±æ˜¯åˆå¹¶å¯¹è±¡çš„,å¦‚æœæ˜¯ç®€å•çš„å¯¹è±¡è¿˜å¥½å¤„ç†ï¼Œå¤æ‚åœ¨ä¸Šé¢çš„<code>æ¯ä¸€ä¸ªreducer</code>å®é™…è¿˜å¯ä»¥åˆå¹¶<code>æ›´å°çš„reducer</code>,è¿™å¯¹äºå¤§å‹é¡¹ç›®çš„stateç»“æ„æœ‰å¥½å¤„,ä½†æ˜¯æºç ä¸å¤ªå¥½ç†è§£,æˆ‘æ²¡ææ‡‚,è€Œä¸”æ›´å¤§å‹çš„stateçš„ç»„ç»‡å½¢å¼è¿˜æ²¡æœ‰çœ‹åˆ°é‚£ä¸ªæºç ä½¿ç”¨,åŠè·¯å‡ºå®¶çš„åŸºç¡€è–„å¼±,è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹å…ä¸ºå…¶éš¾äº†,ä¸è¿‡æ€ä¹ˆåšåº”è¯¥æ˜¯å¾ˆå¥½æ“ä½œçš„.ä»¥ååŠªåŠ›ç†Ÿæ‚‰è¿™ä¸ªæ–¹é¢çš„å†…å®¹.è¿™ä¸ªæ˜¯stateçš„ç»„ç»‡å½¢å¼.åœ¨reduxå’Œreact-reduxä¸­åˆ°å¤„å¼¥æ¼«ç€å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³,å¯æƒœé“è¡Œä¸æ·±,æ— æ³•å®Œå…¨ç†è§£.ç•™å¾…æ—¥åå†è¯´O(âˆ©_âˆ©)O~.</p>
</li>
<li><p>å•ç‹¬çœ‹æ¯ä¸ªå¯¼å…¥çš„reducerå°±æ¶‰åŠåˆ°äº†å…·ä½“çš„é€»è¾‘äº†.è¿™éƒ¨åˆ†çš„reducerçš„æ–‡ä»¶åå’Œactionä¸­çš„æ–‡ä»¶åæ˜¯å¯¹åº”çš„.æ‰€ä»¥åœ¨çœ‹è¿™éƒ¨åˆ†çš„æ—¶å€™è¦ä¸¤ä¸ªæ–‡ä»¶ä¸€èµ·æ‰“å¼€çœ‹.æˆ‘åœ¨macä¸Šä½¿ç”¨äº†sizeUPè½¯ä»¶,ç‚¹å‡»ä¸¤ä¸ªæ–‡ä»¶ä»¥å,é€‰leftæˆ–è€…rightå°±å¯ä»¥æŠŠä¸¤ä¸ªæ–‡ä»¶è§†å›¾å¹³åˆ†åˆ°å±å¹•ä¸Š,ä¸ç”¨æ‰‹åŠ¨å»æ‹‰è§†çª—å¤§å°,éå¸¸æ–¹ä¾¿.</p>
</li>
</ul>
<h1 id="actionå’Œreduceré…å¯¹å‡ºç°"><a href="#actionå’Œreduceré…å¯¹å‡ºç°" class="headerlink" title="actionå’Œreduceré…å¯¹å‡ºç°"></a>actionå’Œreduceré…å¯¹å‡ºç°</h1><h2 id="login-js-actionå’Œuser-js-reducer"><a href="#login-js-actionå’Œuser-js-reducer" class="headerlink" title="login.js actionå’Œuser.js reducer"></a>login.js actionå’Œuser.js reducer</h2><p><code>user.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> type &#123;Action&#125; <span class="keyword">from</span> <span class="string">'../actions/types'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> type State = &#123;<span class="comment">//ç±»å‹çº¦æŸ</span></div><div class="line">  isLoggedIn: boolean;</div><div class="line">  hasSkippedLogin: boolean;</div><div class="line">  sharedSchedule: ?boolean;</div><div class="line">  id: ?string;</div><div class="line">  name: ?string;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = &#123;<span class="comment">//åˆå§‹åŒ–çš„state</span></div><div class="line">  isLoggedIn: <span class="literal">false</span>,</div><div class="line">  <span class="attr">hasSkippedLogin</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">sharedSchedule</span>: <span class="literal">null</span>,</div><div class="line">  <span class="attr">id</span>: <span class="literal">null</span>,</div><div class="line">  <span class="attr">name</span>: <span class="literal">null</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">user</span>(<span class="params">state: State = initialState, action: Action</span>): <span class="title">State</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'LOGGED_IN'</span>) &#123;å¤„ç†ç™»å½•çš„action</div><div class="line">    <span class="comment">//è·å–actionçš„è´Ÿè½½å†…å®¹</span></div><div class="line">    <span class="keyword">let</span> &#123;id, name, sharedSchedule&#125; = action.data;</div><div class="line">    <span class="keyword">if</span> (sharedSchedule === <span class="literal">undefined</span>) &#123;</div><div class="line">      sharedSchedule = <span class="literal">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">isLoggedIn</span>: <span class="literal">true</span>, <span class="comment">//æ ¹æ®è¿™ä¸ªå±æ€§å°±å¯ä»¥åœ¨UIä¸­åšå‡ºç›¸åº”çš„æ”¹å˜äº†</span></div><div class="line">      hasSkippedLogin: <span class="literal">false</span>,</div><div class="line">      sharedSchedule,</div><div class="line">      id,<span class="comment">//ä¸‹é¢è¿™ä¸¤ä¸ªå‚æ•°è¦åœ¨åˆ°è¾¾reducerä¹‹å‰è·å¾—,æ‰€ä»¥åœ¨actionä¸­</span></div><div class="line">      <span class="comment">//æ‰§è¡Œè¿œç¨‹æ•°æ®çš„è·å–</span></div><div class="line">      name,</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'SKIPPED_LOGIN'</span>) &#123;<span class="comment">//è·³è¿‡ç™»å½•çš„action</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">isLoggedIn</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">hasSkippedLogin</span>: <span class="literal">true</span>,<span class="comment">//æ”¹å˜è¿™ä¸ªå±æ€§</span></div><div class="line">      sharedSchedule: <span class="literal">null</span>,</div><div class="line">      <span class="attr">id</span>: <span class="literal">null</span>,</div><div class="line">      <span class="attr">name</span>: <span class="literal">null</span>,</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'LOGGED_OUT'</span>) &#123;<span class="comment">//å¤„ç†ç™»å‡ºçš„action</span></div><div class="line">    <span class="keyword">return</span> initialState;<span class="comment">//è¿”å›åˆå§‹å€¼å°±å¯ä»¥äº†</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'SET_SHARING'</span>) &#123;<span class="comment">//è®¾ç½®åˆ†äº«çš„action</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      ...state,</div><div class="line">      <span class="attr">sharedSchedule</span>: action.enabled,<span class="comment">//ç»„ä»¶æ ¹æ®è¿™ä¸ªstateå°±//å¯ä»¥å†³å®šæ˜¯å¯ä»¥åˆ†äº«è¿˜æ˜¯ä¸å¯ä»¥åˆ†äº«</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'RESET_NUXES'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> &#123;...state, <span class="attr">sharedSchedule</span>: <span class="literal">null</span>&#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = user;</div></pre></td></tr></table></figure></p>
<p>userçš„reducerè¿˜æ¯”è¾ƒç®€å•,æœ€åä¸€å¥<code>module.expors=user;</code>ä½¿ç”¨äº†javascriptä¸­å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å¯¹è±¡çš„å®šä¹‰,useræ˜¯è¿™ä¸ª<code>å‡½æ•°å¯¹è±¡çš„å¼•ç”¨</code><br>é‚£ä¹ˆuserå¯¹è±¡ä¸­æ˜¯ä»€ä¹ˆå‘¢ï¼ŸğŸ˜,é‡Œé¢æ˜¯<code>é—­åŒ…</code>å•Š! è¦ä¸ç„¶combineReducersé‡Œé¢è°ƒç”¨userå‡½æ•°çš„æ—¶å€™stateèƒ½è®°ä½æ”¹å˜çš„å†…å®¹å‘¢ï¼Ÿè¦ç†è§£è¿™äº›æ¦‚å¿µ,å¯¹javascriptçš„é—­åŒ…çš„ç†è§£æ˜¯ä¸å¯å°‘çš„. </p>
<p><code>login.js</code><br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">use</span> <span class="title">strict</span>';</div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="keyword">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//è¿æ¥parseçš„å®¢æˆ·ç«¯åŒ…</span></div><div class="line"><span class="keyword">const</span> FacebookSDK = <span class="keyword">require</span>(<span class="string">'FacebookSDK'</span>);</div><div class="line"><span class="keyword">const</span> ActionSheetIOS = <span class="keyword">require</span>(<span class="string">'ActionSheetIOS'</span>);<span class="comment">//ä¸Šæ‹‰ç»„ä»¶</span></div><div class="line"><span class="keyword">const</span> &#123;Platform&#125; = <span class="keyword">require</span>(<span class="string">'react-native'</span>);<span class="comment">//</span></div><div class="line"><span class="keyword">const</span> Alert = <span class="keyword">require</span>(<span class="string">'Alert'</span>);</div><div class="line"><span class="keyword">const</span> &#123;restoreSchedule, loadFriendsSchedules&#125; = <span class="keyword">require</span>(<span class="string">'./schedule'</span>);</div><div class="line"><span class="keyword">const</span> &#123;updateInstallation&#125; = <span class="keyword">require</span>(<span class="string">'./installation'</span>);</div><div class="line"><span class="keyword">const</span> &#123;loadSurveys&#125; = <span class="keyword">require</span>(<span class="string">'./surveys'</span>);</div><div class="line"></div><div class="line">import type &#123; Action, ThunkAction &#125; from <span class="string">'./types'</span>;</div><div class="line"><span class="comment">//ä¸‹é¢ä¸¤ä¸ªå‡½æ•°æ˜¯ä½¿ç”¨ParseFacebookç™»å½•çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">ParseFacebookLogin</span><span class="params">(scope)</span>: <span class="title">Promise</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise((resolve, reject) =&gt; &#123;</div><div class="line">    Parse.FacebookUtils.logIn(scope, &#123;</div><div class="line">      success: resolve,</div><div class="line">      error: (user, error) =&gt; reject(error &amp;&amp; error.error || error),</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">queryFacebookAPI</span><span class="params">(path, ...args)</span>: <span class="title">Promise</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise((resolve, reject) =&gt; &#123;</div><div class="line">    FacebookSDK.api(path, ...args, (response) =&gt; &#123;</div><div class="line">      <span class="keyword">if</span> (response &amp;&amp; !response.error) &#123;</div><div class="line">        resolve(response);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        reject(response &amp;&amp; response.error);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">_logInWithFacebook</span><span class="params">(source: ?string)</span>: <span class="title">Promise</span>&lt;<span class="title">Array</span>&lt;<span class="title">Action</span>&gt;&gt; </span>&#123;</div><div class="line">  await ParseFacebookLogin(<span class="string">'public_profile,email,user_friends'</span>);<span class="comment">//es7çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">  <span class="keyword">const</span> profile = await queryFacebookAPI(<span class="string">'/me'</span>, &#123;fields: <span class="string">'name,email'</span>&#125;);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> user = await Parse.User.currentAsync();</div><div class="line">  user.set(<span class="string">'facebook_id'</span>, profile.id);</div><div class="line">  user.set(<span class="string">'name'</span>, profile.name);</div><div class="line">  user.set(<span class="string">'email'</span>, profile.email);</div><div class="line">  await user.save();</div><div class="line">  await updateInstallation(&#123;user&#125;);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> action = &#123;<span class="comment">//é…ç½®actionå¯¹è±¡</span></div><div class="line">    type: <span class="string">'LOGGED_IN'</span>, <span class="comment">//ä¼ åˆ°reducerçš„actioType</span></div><div class="line">    source,</div><div class="line">    data: &#123;</div><div class="line">      id: profile.id,</div><div class="line">      name: profile.name,</div><div class="line">      sharedSchedule: user.get(<span class="string">'sharedSchedule'</span>),</div><div class="line">    &#125;,</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Promise.all([</div><div class="line">    Promise.resolve(action),</div><div class="line">    restoreSchedule(),</div><div class="line">  ]);</div><div class="line">&#125;</div><div class="line"><span class="comment">//è¿™ä¸€æ­¥å°±æœ‰ç‚¹ç»•äº†,ç”±äºæ˜¯è¿œç¨‹æ“ä½œ,éœ€è¦å¼‚æ­¥å¤„ç†,ç­‰å¾…ç»“æœä»¥åæ‰èƒ½dispatch</span></div><div class="line"><span class="comment">//è·å–çš„ç»“æœ,</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logInWithFacebook</span><span class="params">(source: ?string)</span>: <span class="title">ThunkAction</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> (dispatch) =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> login = _logInWithFacebook(source);<span class="comment">//è¿”å›çš„å°±æ˜¯ä¸Šé¢çš„const action</span></div><div class="line">    </div><div class="line">    <span class="comment">// Loading friends schedules shouldn't block the login process</span></div><div class="line">    login.then(</div><div class="line">      (result) =&gt; &#123;</div><div class="line">        dispatch(result);</div><div class="line">        dispatch(loadFriendsSchedules());</div><div class="line">        dispatch(loadSurveys());</div><div class="line">      &#125;</div><div class="line">    );</div><div class="line">    <span class="keyword">return</span> login;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">skipLogin</span><span class="params">()</span>: <span class="title">Action</span> </span>&#123;<span class="comment">//è·³è¿‡ç™»å½•çš„action</span></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    type: <span class="string">'SKIPPED_LOGIN'</span>,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logOut</span><span class="params">()</span>: <span class="title">ThunkAction</span> </span>&#123;<span class="comment">//ç™»å‡ºä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œ,ç­‰å¾…ä¸¤ä¸ªè¿œç¨‹æ•°æ®çš„ç›¸åº”ç»“æœ</span></div><div class="line">  <span class="keyword">return</span> (dispatch) =&gt; &#123;</div><div class="line">    Parse.User.logOut();</div><div class="line">    FacebookSDK.logout();</div><div class="line">    updateInstallation(&#123;user: <span class="keyword">null</span>, channels: []&#125;);</div><div class="line"></div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> Make sure reducers clear their state</span></div><div class="line">    <span class="keyword">return</span> dispatch(&#123;</div><div class="line">      type: <span class="string">'LOGGED_OUT'</span>,</div><div class="line">    &#125;);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logOutWithPrompt</span><span class="params">()</span>: <span class="title">ThunkAction</span> </span>&#123;<span class="comment">//å¯¹è¯æ¡†é€€å‡º,ä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œ</span></div><div class="line">  <span class="comment">//ç¡®è®¤ä»¥åå†dispatchä¸€ä¸ªaction</span></div><div class="line">  <span class="keyword">return</span> (dispatch, getState) =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> name = getState().user.name || <span class="string">'there'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (Platform.OS === <span class="string">'ios'</span>) &#123;</div><div class="line">      ActionSheetIOS.showActionSheetWithOptions(</div><div class="line">        &#123;</div><div class="line">          title: `Hi, $&#123;name&#125;`,</div><div class="line">          options: [<span class="string">'Log out'</span>, <span class="string">'Cancel'</span>],</div><div class="line">          destructiveButtonIndex: <span class="number">0</span>,</div><div class="line">          cancelButtonIndex: <span class="number">1</span>,</div><div class="line">        &#125;,</div><div class="line">        (buttonIndex) =&gt; &#123;</div><div class="line">          <span class="keyword">if</span> (buttonIndex === <span class="number">0</span>) &#123;<span class="comment">//æ ¹æ®é€»è¾‘åˆ¤dispatché€€å‡ºæ“ä½œ</span></div><div class="line">            dispatch(logOut());</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      );</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      Alert.alert(<span class="comment">//andoidå¼¹å‡ºå¯¹è¯æ¡†</span></div><div class="line">        `Hi, $&#123;name&#125;`,</div><div class="line">        <span class="string">'Log out from F8?'</span>,</div><div class="line">        [</div><div class="line">          &#123; text: <span class="string">'Cancel'</span> &#125;,</div><div class="line">          &#123; text: <span class="string">'Log out'</span>, onPress: () =&gt; dispatch(logOut()) &#125;,</div><div class="line">        ]</div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="comment">//åˆçœ‹ä»£ç logInWithFacebookè¿™ä¸ªactionæ˜¯æ²¡æœ‰åœ¨ationTypeä¸­çš„,ä½†æ˜¯å…¶å®</span></div><div class="line"><span class="comment">//è¿™ä¸ªå‡½æ•°æœ‰è¿”å›äº†LoginedInå¯¹è±¡,è¿™ä¸€ç‚¹æœ‰ä»”ç»†çœ‹çœ‹</span></div><div class="line">module.exports = &#123;logInWithFacebook, skipLogin, logOut, logOutWithPrompt&#125;;</div></pre></td></tr></table></figure></p>
<p>ç™»å½•çš„å…·ä½“é€»è¾‘å’Œå®ç°å°±æ˜¯è¿™äº›.UIç»„ä»¶è¦æ€ä¹ˆåšå‘¢ï¼Ÿå¥½äº†æˆ‘è¿™é‡Œåœ¨ä¸¾ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­æ¥è¯´æ˜.è¿™ä¸ªæ€æƒ³ä»æˆ‘çš„ç”µç¯æ¨¡å‹å¼€å§‹æ¼”åŒ–æˆä¸ºäº†è‡ªåŠ¨è´©å–æœºæ¨¡å‹æˆ–è€…ATMæœºæ¨¡å‹äº†. æˆ‘ä»¬å§‘ä¸”ç§°ä¸ºATMæœºæ¨¡å‹å¥½äº†.å›æƒ³ä½ å»ATMå–é’±,è¾“å…¥å¯†ç ,è¾“å…¥é’±çš„æ•°ç›®.ä½ æ˜¯å¤§æ¬¾ä¸€æ¬¡æƒ³å–åä¸‡å—,ç‚¹å‡»æŒ‰é”®æˆ–è€…è§¦æ‘¸å±è¾“å…¥åä¸‡å—,å¯æƒœATMçš„é’±ç®±æ²¡æœ‰è£…é‚£ä¹ˆå¤š,å‘Šè¯‰ä½ ATMæœºæ²¡æœ‰è¿™ä¹ˆå¤šé’±ï¼Œè¿™ä¸ªæ¶ˆæ¯ååº”çš„ATMé’±ç®±çš„<code>state</code>æ˜¯æ²¡æœ‰åä¸‡.äºæ˜¯ä½ æŒ‰é”®æˆ–è€…è§¦æ‘¸æ“ä½œè¾“å…¥1000å—,äºæ˜¯ä¹ATMæœºå™¨ç»™ä½ åå‡ºäº†1000å—.ä½ çš„è´¦æˆ·çš„ä½™é¢<code>state</code>å‡æ‰äº†1000å—.è¿™ä¸ªè¿‡ç¨‹å±…ç„¶å’Œcounterçš„è¿‡ç¨‹æ˜¯ä¸€æ ·çš„.é‚£ä¹ˆä¸ºä»€ä¹ˆè¦ä»‹ç»è¿™ä¸ªæ¨¡å‹å‘¢ï¼Ÿæˆ‘ä»¬æŒ‰é”®æˆ–è€…è§¦æ‘¸æ“ä½œ,å¹¶æ²¡æœ‰åœ¨å±å¹•ä¸Šå®ç°å…·ä½“çš„æ“ä½œ,é’ç¥¨çš„åˆ¶ä½œ,é’±ç®±çš„æ‰“å¼€,é’ç¥¨çš„æ•°é‡è®¡ç®—éƒ½æ˜¯æœ‰æœºå™¨æ¥å®Œæˆçš„.æˆ‘ä»¬ç‚¹å‡»çš„å±å¹•å’ŒæŒ‰é”®å…¶å®å°±æ˜¯UIç”¨æˆ·ç•Œé¢,ç•Œé¢ä¸Šçš„æŒ‰é”®å…¶å®åªæ˜¯å®é™…æ“ä½œçš„ä»£ç†.javacriptçš„å‡½æ•°å¯ä»¥<code>ä¼ å¼•ç”¨èµ‹å€¼</code>,æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å‡½æ•°åå­—æ¥è°ƒç”¨å®é™…çš„å‡½æ•°å…·ä½“æ“ä½œ.å°½ç®¡å±å¹•ä¸Šæ²¡æœ‰é’±ç®±,ä½†æ˜¯æˆ‘ä»¬å´å¯ä»¥å–åˆ°é’±.ä»è¿™ä¸ªä¾‹å­çœ‹,reduxæ˜¯å¤šä¹ˆçš„ç®€å•.ä½†æ˜¯ç¢ç£¨å‡ºè¿™ä¸ªåŸç†ä¹Ÿæ˜¯èŠ±äº†å¾ˆé•¿æ—¶é—´çš„.è¿™å®é™…å°±æ˜¯ä¸­ä»‹è€…æ¨¡å¼.<br>å“ˆå“ˆé‚£ä¸ªé’±ç®±å°±æ˜¯ä¸€ä¸ª<code>é—­åŒ…</code>,ä½ çœ‹çœ‹æ˜¯ä¸æ˜¯ï¼Ÿ</p>
<h2 id="Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse-js"><a href="#Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse-js" class="headerlink" title="Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse.js"></a>Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse.js</h2><p><code>parse.js</code></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"></div><div class="line"><span class="javascript"><span class="meta">'use strict'</span>;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="built_in">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//parseServerçš„å®¢æˆ·ç«¯</span></div><div class="line"><span class="keyword">const</span> logError = <span class="built_in">require</span>(<span class="string">'logError'</span>);</div><div class="line"><span class="keyword">const</span> InteractionManager = <span class="built_in">require</span>(<span class="string">'InteractionManager'</span>);</div><div class="line"></div><div class="line"><span class="keyword">import</span> type &#123; ThunkAction &#125; <span class="keyword">from</span> <span class="string">'./types'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Maps = Parse.Object.extend(<span class="string">'Maps'</span>);<span class="comment">//ParseServerçš„å¯¹è±¡</span></div><div class="line"><span class="comment">//å¯ä»¥å‚çœ‹ireading app feedbackæ¨¡å—é‡Œçš„åé¦ˆæ„è§çš„è¿œç¨‹å­˜å‚¨,ä½¿ç”¨çš„æ˜¯leancloud</span></div><div class="line"><span class="comment">//ä½†æ˜¯APIæ˜¯å®Œå…¨ä¸€æ ·çš„.</span></div><div class="line"><span class="keyword">const</span> Notification = Parse.Object.extend(<span class="string">'Notification'</span>);</div><div class="line"><span class="comment">//æ€»çš„ParseQueryæŸ¥è¯¢å‡½æ•°,æ ¹æ®typeå’ŒæŸ¥è¯¢ç­›é€‰ç»“æœåŠ¨æ€dispatch action</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadParseQuery</span>(<span class="params">type: string, query: Parse.Query</span>): <span class="title">ThunkAction</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> query.find(&#123;</div><div class="line">      <span class="attr">success</span>: <span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// We don't want data loading to interfere with smooth animations</span></div><div class="line">        InteractionManager.runAfterInteractions(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">          <span class="comment">// Flow can't guarantee &#123;type, list&#125; is a valid action</span></div><div class="line">          dispatch((&#123;type, list&#125;: any));</div><div class="line">        &#125;);</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">error</span>: logError,</div><div class="line">    &#125;);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line"><span class="comment">//loadå°±æ˜¯tabbaré»˜è®¤tabåŠ è½½çš„ä¼šè®®æ—¥ç¨‹state</span></div><div class="line">  loadSessions: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//åŠ è½½ä¼šè®®æ—¥ç¨‹,è¿™é‡Œä¸æ˜¯æµè§ˆå™¨çš„sessionï¼Œæ˜ å°„</span></div><div class="line">    loadParseQuery(</div><div class="line">      <span class="string">'LOADED_SESSIONS'</span>,</div><div class="line">      <span class="keyword">new</span> Parse.Query(<span class="string">'Agenda'</span>)</div><div class="line">        .include(<span class="string">'speakers'</span>)</div><div class="line">        .ascending(<span class="string">'startTime'</span>)</div><div class="line">    ),</div><div class="line"></div><div class="line">  <span class="attr">loadMaps</span>: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//æ˜ å°„</span></div><div class="line">    loadParseQuery(<span class="string">'LOADED_MAPS'</span>, <span class="keyword">new</span> Parse.Query(Maps)),</div><div class="line"></div><div class="line">  <span class="attr">loadNotifications</span>: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//æ˜ å°„å¯¹è±¡</span></div><div class="line">    loadParseQuery(<span class="string">'LOADED_NOTIFICATIONS'</span>, <span class="keyword">new</span> Parse.Query(Notification)),</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="actions-config-js"><a href="#actions-config-js" class="headerlink" title="actions/config.js"></a>actions/config.js</h2><p><code>config.js</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">strict</span>';</div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="keyword">require</span>(<span class="string">'parse/react-native'</span>);</div><div class="line"><span class="keyword">const</span> InteractionManager = <span class="keyword">require</span>(<span class="string">'InteractionManager'</span>);</div><div class="line"></div><div class="line">import type &#123; Action &#125; from <span class="string">'./types'</span>; <span class="comment">//è·å¾—æ‰€æœ‰çš„type</span></div><div class="line"></div><div class="line"><span class="comment">//è·å–é…ç½®æ–‡ä»¶çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">loadConfig</span><span class="params">()</span>: <span class="title">Promise</span>&lt;<span class="title">Action</span>&gt; </span>&#123;</div><div class="line">  <span class="keyword">const</span> config = await Parse.Config.get();<span class="comment">//Â ä»parseæœåŠ¡å™¨è·å–é…ç½®æ•°æ®</span></div><div class="line">  await InteractionManager.runAfterInteractions();</div><div class="line">  <span class="keyword">return</span> &#123;<span class="comment">//æ“ä½œé€»è¾‘åœ¨è¿™é‡Œè¿”å›configæ•°æ®ç„¶åæ‹·è´åˆ°state</span></div><div class="line">    type: <span class="string">'LOADED_CONFIG'</span>,</div><div class="line">    config,<span class="comment">//é…ç½®è´Ÿè½½æˆ–è€…è½½è·</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">module.exports = &#123;loadConfig&#125;;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å…¥å£å’Œé…ç½®æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#å…¥å£å’Œé…ç½®æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;å…¥å£å’Œé…ç½®æ–‡ä»¶&quot;&gt;&lt;/a&gt;å…¥å£å’Œé…ç½®æ–‡ä»¶&lt;/h1&gt;&lt;h2 id=&quot;F8APP-js-setup-jsæ–‡ä»¶&quot;&gt;&lt;a href=&quot;#F8APP-js-setup
    
    </summary>
    
      <category term="F8Appæºç é˜…è¯»" scheme="https://phpsmarter.github.com/categories/F8App%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
    
      <category term="React-native" scheme="https://phpsmarter.github.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼,è¿”ç’å½’çœŸF8(1)</title>
    <link href="https://phpsmarter.github.com/2017/04/05/%E4%B9%B1%E8%8A%B1%E6%B8%90%E6%AC%B2%E8%BF%B7%E4%BA%BA%E7%9C%BC-%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9F-1/"/>
    <id>https://phpsmarter.github.com/2017/04/05/ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼-è¿”ç’å½’çœŸ-1/</id>
    <published>2017-04-05T10:00:23.000Z</published>
    <updated>2017-04-05T18:28:31.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å»å¹´å†™äº†å‡ ç¯‡f8appçš„ä»£ç é˜…è¯»,åŸºæœ¬æ˜¯ç«™åœ¨UIç»„ä»¶çš„è§’åº¦æ¥çš„,éšç€å­¦ä¹ çš„æ·±å…¥,å¯¹å…¶ä¸­çš„ä»£ç æœ‰äº†æ›´æ·±çš„ä½“ä¼š,ç°åœ¨æœ‰å¾ˆå¤šå¼€æºçš„RNé¡¹ç›®å¯ä»¥ä¾›å‚è€ƒ,ä½†æ˜¯æœ‰ä¸€äº›éƒ½å­˜åœ¨æŸäº›é—®é¢˜.ç»†èŠ‚è€ƒè™‘çš„ä¸å‘¨åˆ°,å­¦ä¹ çš„æ„ä¹‰æ‰“äº†æŠ˜æ‰£.F8APPæ˜¯facebookçš„äº²å„¿å­ï¼Œæ‰€ä»¥å¼€å‘è€…çš„æ°´å¹³æ˜¯å¾ˆé«˜çš„,å‰é¢é˜…è¯»çš„æ—¶å€™è§‰å¾—æ€ä¹ˆå†™çš„å¾ˆéš¾æ‡‚,ç”šè‡³è¿˜æœ‰äº›åœ°æ–¹å¯¹Reduxçš„å®ç°éƒ½æ„Ÿè§‰ä¸å¤ªæ ‡å‡†,è¿™ä¸¤å¤©åœ¨å›å¤´çœ‹çš„æ—¶å€™,ä¸å¾—ä¸ä½©æœäººå®¶çš„å¼€å‘æ°´å¹³.ä»£ç é‡Œå¯¹äºç»„ä»¶çš„å®ç°,Reduxçš„æ¸—é€,å¤šæ•°æ®æºçš„æ¥å…¥,ä»£ç ç»„ç»‡æ–¹é¢éƒ½æ˜¯ç‹¬å±…åŒ å¿ƒçš„.æˆ‘è‡ªä»é‡æ–°é˜…è¯»äº†ä»¥å,æ„Ÿè§‰å†™ä»£ç å½“å¦‚æ­¤å•Š. </p>
</blockquote>
<p>ä½†æ˜¯åˆ°äº†ç°åœ¨çš„è¿™ä¸ªè§‰æ‚Ÿå¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„.ç»è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ ,å­¦ä¹ å·¥å…·ç®±é‡Œå°±æœ‰ä¸€äº›å·¥å…·äº†.</p>
<ul>
<li>å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³,javascripté‡Œçš„å‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡,å…¶å®æ„æ€æ˜¯å‡½æ•°å’Œå¯¹è±¡åœ¨javascriptä¸­éƒ½æ˜¯<code>å¼•ç”¨èµ‹å€¼çš„</code>,<strong>è¿™ä¸€ç‚¹éå¸¸çš„éå¸¸çš„å…³é”®</strong>.è¿™å¹¶éå±è¨€è€¸å¬,ä¸€æ—¦ä½ åœ¨è¯»ä»£ç ä¸­æœ‰äº†è¿™ä¸ªè§‰æ‚Ÿçš„è¯,javascriptçš„åŠŸåŠ›ä¼šå¤§å¢çš„.æˆ‘ä»¬éšæ—¶å¯ä»¥æŠŠä¸€ä¸ªå‡½æ•°æ˜ å°„åˆ°ä¸€ä¸ªå˜é‡ä¸Š,è¿™å°±æ˜¯å¼•ç”¨èµ‹å€¼,ä¸€æ—¦è¿™æ ·åšä»¥å,å‡½æ•°å¯ä»¥ä½¿ç”¨è¿™ä¸ªå˜é‡åœ¨ä»£ç ä¸­ä¼ æ¥ä¼ å»,çµæ´»æ€§å¤§å¢.æœ‰æ²¡æœ‰æ€è€ƒè¿‡React/Reduxä¸­ç»„ä»¶dispatchä¸€ä¸ªactionåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?bindActionCreatoræ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿè¿™è¿˜æ²¡å®Œ,ç»§ç»­æŒ–æ˜å‡½æ•°ç¼–ç¨‹æ˜¯æ€ä¹ˆåœ¨f8é‡Œå®ç°çš„</li>
<li>æ¨¡å¼è®¾è®¡çš„æ€æƒ³ï¼šä¸­ä»‹è€…æ¨¡å¼,å‘å¸ƒè®¢é˜…è€…æ¨¡å¼,ç­‰ç­‰æ¨¡å¼,åœ¨è¿™é¢ä¹Ÿå¾ˆå¥½çš„å®ç°äº†ã€‚è¦æœ‰ä¸€ç‚¹æ¨¡å¼è®¾è®¡çš„çŸ¥è¯†</li>
<li>React-nativeè·¨å¹³å°å¼€å‘çš„ä»£ç å¤ç”¨é—®é¢˜,åŠŸèƒ½,é€»è¾‘å’Œè¡¨ç°å½¢å¼çš„ç»“åˆæ€è€ƒã€‚å…ˆé€»è¾‘åè¡¨ç°ã€‚</li>
<li>ä¸´æœºåº”å˜,åˆšå¼€å§‹çœ‹f8appçš„ä»£ç çš„æ—¶å€™çœ‹ä¸ä¸‹å»,å°¤å…¶æ˜¯åœ¨å¯¹reduxæœ‰äº†åˆæ­¥çš„äº†è§£,äº§ç”Ÿç›²ç›®å´‡æ‹œä»¥å,åœ¨Reactä¸­å¿…é¡»è¦æ‰¾åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹åœ¨æ‰èƒ½æ˜¯æ ¹æ­£è‹—çº¢çš„Reduxåº”ç”¨.äºæ˜¯åœ¨é‡Œé¢æ‰¾,è¿™é‡Œé¢æ›´æœ¬å°±æ²¡æœ‰containeræ–‡ä»¶å¤¹ä¹ˆï¼Ÿæ€ä¹ˆåŠï¼Ÿå…¶å®åœ¨containeræ–‡ä»¶ä¸­ä¹Ÿåªæ˜¯ç”¨connectå¯¹è±¡æ³¨å…¥äº†ç»„ä»¶æ˜¯ç»„ä»¶è®¢é˜…äº†éœ€è¦çš„propsï¼Œå…·æœ‰äº†dispatchæ–¹æ³•.ä»…æ­¤è€Œå·².æ‰€ä»¥åœ¨f8appä¸­ç›´æ¥åœ¨UIç»„ä»¶ä¸­ä½¿ç”¨äº†connectå¯¹è±¡.è¿™æ ·å¯¹äºç¼–ç å®é™…æ›´å¥½æ“ä½œï¼Œæ›´ç›´è§‚.å¦å¤–å¸¦æ¥çš„å¥½å¤„æ˜¯,ç»„ä»·å…¶å®ä¸ä¸€å®šéè¦ç”¨reduxæ¥å¤„ç†,å¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ¡†æ¶æ¥å¤„ç†.infoè¿™ä¸ªæ¨¡å—å°±æ²¡æœ‰é‡‡ç”¨reduxçš„æ¡†æ¶.è¦ä»åŠŸèƒ½ä¸Šçµæ´»å¤„ç†ã€‚èƒ½è¾¾åˆ°éšæœºåº”å˜è¦å¯¹åŠŸèƒ½çš„å®ç°æœ‰æ·±åˆ»çš„è®¤è¯†ã€‚</li>
<li>å¯¹äºstateçš„æ€è€ƒ,åé¢å¦‚æœè¦ç»§ç»­æé«˜RNçš„ç¼–ç¨‹èƒ½åŠ›,è¦ä¸æ–­çš„æ€è€ƒstateçš„é—®é¢˜.ç›®å‰çœ‹åˆ°çš„ä¸¤ä¸ªå¤§å‹ç¨‹åºçš„stateï¼Œä¸€ä¸ªæ˜¯f8çš„ï¼Œä¸€ä¸ªæ˜¯cnodeçš„state.<br>æˆ‘å‰é¢å†™è¿‡æ–‡ç« æŠŠstateçœ‹æˆæ˜¯å†…å­˜çš„æ•°æ®åº“,å›´ç»•ç€stateåšå¢åˆ æ”¹æŸ¥å·¥ä½œï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ªæ„æ€å‘¢ï¼Ÿf8ä¸­çš„stateå®ç°æ˜¯ä¸€é¢—å€’ç«‹çš„æ ‘,ä¸ºä»€ä¹ˆæ˜¯æ ‘å‘¢ï¼Ÿè¿™æ˜¯ç›¸å¯¹äºç½‘çŠ¶ç»“æ„æ¥çš„,stateä¸­æ˜¯æ²¡æœ‰ä¹‹é—´çš„è¿æ¥å…³ç³»çš„.æ•°æ®ä»¥èŠ‚ç‚¹æ¥ç»„ç»‡.çœ‹åˆ°f8appä¸­combineReducerä¸­çš„æ˜ å°„çš„æ—¶å€™ï¼Œé‚£æ„Ÿè§‰çœŸçˆ½å•Šã€‚ç¼–ç¨‹çœŸæœ‰æ„æ€.å›å¤´çœ‹ä»£ç åœ¨è§£é‡Š.</li>
<li>parse-serverå’Œgraghqlçš„é—®é¢˜,</li>
<li><p>è§‚å¯Ÿçš„è§†ç‚¹é€‰æ‹©é—®é¢˜,å¦‚æœä¼šä½ çœ‹è¿‡<a href="https://medium.com/@rajaraodv/step-by-step-guide-to-building-react-redux-apps-using-mocks-48ca0f47f9a" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>,<a href="https://wenku.baidu.com/view/881a48f8aaea998fcd220ea5.html?from=search" target="_blank" rel="external">ä¸­æ–‡ç¿»è¯‘ç‰ˆ</a>çš„è¯,è¿™ç¯‡æ–‡ç« å®é™…æ˜¯ä»UIç»„ä»¶çš„è§’åº¦æ¥æ‰¾è§†ç‚¹çš„,å¯¹äºåˆå­¦è€…ä¿©è¯´,è¿™ç¯‡æ–‡ç« çš„ç¡®æ˜¯å¾ˆå¥½çš„,ä½†æ˜¯å¯¹äºF8appè¿™æ ·çš„å¤§å‹app,ä»è§†å›¾å°±æœ‰ç‚¹å–§å®¾å¤ºä¸»äº†.åœ¨f8appä¸­stateå’ŒActionsçš„å¤æ‚ç¨‹åº¦æ›´é«˜,ä»ç»„ä»¶ä¸Šé¢å»å­¦ä¹ å°±æœ‰ç‚¹éº»çƒ¦,å°¤å…¶æ˜¯è¿™é‡Œé¢æœ‰å‡ ä¸ªåœ°æ–¹çš„ç»„ä»¶ç»„åˆçœŸçš„æ˜¯å¤ªå‰å®³äº†ï¼Œçœ‹å®Œç»„ä»¶çš„ç»„åˆå…³ç³»å°±å·²ç»æ²¡è€å¿ƒäº†.ä»actionå’Œstateå¼€å§‹è¯»ä¼¼ä¹æ˜¯å¯è¡Œçš„.å½“ç„¶å› äººè€Œå¼‚.æˆ‘æå‡ºè¿™ä¸ªè§‚ç‚¹è‡³å°‘æ˜¯è¯´æ˜æˆ‘æ€è€ƒè¿‡è¿™ä¸ªé—®é¢˜.</p>
</li>
<li><p>è´ªå¿ƒåŸç† f8APPä¸­å·²ç»åŒ…å«å’Œäº†å¾ˆå¤šç»„ä»¶å’Œä¸­é—´ä»¶äº†,å¤šå­¦å‡ éå°±å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹ç”¨äº†.å¤ªå¥½äº†.</p>
</li>
</ul>
<blockquote>
<p>æ—¶é—´å¤ªæ™šäº†ï¼Œæœ‰äº›åœ°æ–¹ç™½å¤©æƒ³æ˜ç™½äº†,ç°åœ¨åˆå¿˜äº†.å…ˆå†™è¿™ä¹ˆå¤š.</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å»å¹´å†™äº†å‡ ç¯‡f8appçš„ä»£ç é˜…è¯»,åŸºæœ¬æ˜¯ç«™åœ¨UIç»„ä»¶çš„è§’åº¦æ¥çš„,éšç€å­¦ä¹ çš„æ·±å…¥,å¯¹å…¶ä¸­çš„ä»£ç æœ‰äº†æ›´æ·±çš„ä½“ä¼š,ç°åœ¨æœ‰å¾ˆå¤šå¼€æºçš„RNé¡¹ç›®å¯ä»¥ä¾›å‚è€ƒ,ä½†æ˜¯æœ‰ä¸€äº›éƒ½å­˜åœ¨æŸäº›é—®é¢˜.ç»†èŠ‚è€ƒè™‘çš„ä¸å‘¨åˆ°,å­¦ä¹ çš„æ„ä¹‰æ‰“äº†æŠ˜æ‰£.F8APPæ˜¯facebookçš„äº²å„¿å­ï¼Œæ‰€
    
    </summary>
    
      <category term="F8Appæºç é˜…è¯»" scheme="https://phpsmarter.github.com/categories/F8App%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
    
      <category term="React-native" scheme="https://phpsmarter.github.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|redux undo/redo reducerå¢å¼ºç»„ä»¶</title>
    <link href="https://phpsmarter.github.com/2017/04/04/%E7%BF%BB%E8%AF%91-redux-undo-redo-reucer%E5%A2%9E%E5%BC%BA%E7%BB%84%E4%BB%B6/"/>
    <id>https://phpsmarter.github.com/2017/04/04/ç¿»è¯‘-redux-undo-redo-reucerå¢å¼ºç»„ä»¶/</id>
    <published>2017-04-04T13:18:28.000Z</published>
    <updated>2017-04-04T15:36:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Reduxçš„æ–‡æ¡£ä¸­æä¾›ä¸€ä¸ªå¯ä»¥åšundo/redoçš„è§£å†³åŠæ³•,å®é™…æ˜¯æœ‰previous,current,prewçš„å¯¹è±¡,å›´ç»•è¿™æ•°æ®çš„å‹å…¥å’Œå¼¹å‡ºæ¥å®ç°æ“ä½œæ­¥éª¤çš„è®°å¿†,ç»“åˆpersistå°±å¯ä»¥å®ç°æ›´å¼ºå¤§çš„è®°å¿†åŠŸèƒ½.ä»Šå¤©çš„è¿™ä¸ªå¢å¼ºç»„ä»¶å®é™…æŠŠè¿™ä¸ªåŠŸèƒ½ç»™åŒ…è£…äº†ä¸€ä¸‹,å†…éƒ¨å®ç°ç»†èŠ‚ä»ç„¶æ²¡æœ‰å˜.åªéœ€è¦æŠŠreducerç”¨è¿™ä¸ªå¢å¼ºç»„ä»¶åŒ…è£…ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†.</p>
<hr>
</blockquote>
<h1 id="redux-undo-redo"><a href="#redux-undo-redo" class="headerlink" title="redux undo/redo"></a>redux undo/redo</h1><p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1feb2dpdu5xg30eo01k0t1.gif" alt=""></p>
<p>æç¤º:ä½ å¯ä»¥ä½¿ç”¨<a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external">redux-undo-boilerplate</a>æ¥å¼€å§‹é¡¹ç›®.</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p><code>npm install --save redux-undo</code></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div><div class="line">undoable(reducer)</div><div class="line">undoable(reducer, config)</div></pre></td></tr></table></figure>
<h2 id="è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš"><a href="#è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš" class="headerlink" title="è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš"></a>è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš</h2><p><code>redux-undo</code>æ˜¯ä¸€ä¸ªreducerå¢å¼ºç»„ä»¶,å®ƒæä¾›äº†<code>undoable</code>å‡½æ•°,è¿™ä¸ªå‡½æ•°æ¥æ”¶å·²ç»å­˜åœ¨çš„reducerå’Œé…ç½®å¯¹è±¡,ä½¿ç”¨undoå‡½æ•°å¢å¼ºå·²ç»å­˜åœ¨çš„reducer.</p>
<p><strong>æ³¨æ„ï¼š</strong>å¦‚æœåœ¨<code>state.counter</code>ä¹‹å‰æ¥å…¥,ä½ å¿…é¡»è¦åœ¨åŒ…è£…<code>reducer</code>ä¹‹åæ¥å…¥<code>state.coutner.present</code>.</p>
<p>é¦–å…ˆå¯¼å…¥<code>redux-undo</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// Redux utility functions </span></div><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="comment">// redux-undo higher-order reducer </span></div><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>æ¥ç€,æ·»åŠ <code>undoable</code>åˆ°ä½ çš„reducer<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">combineReducers</span>(&#123;</div><div class="line">  <span class="attribute">counter</span>: <span class="built_in">undoable</span>(counter)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><code>é…ç½®é¡¹</code>æƒ³è¿™æ ·ä¼ é€’<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">combineReducers</span>(&#123;</div><div class="line">  <span class="attribute">counter</span>: <span class="built_in">undoable</span>(counter, &#123;</div><div class="line">    limit: 10 // set a limit for the history </div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="å†å²API"><a href="#å†å²API" class="headerlink" title="å†å²API"></a>å†å²API</h2><p>ä½¿ç”¨reduceråŒ…è£…ä½ çš„reduceræƒ³è¿™æ ·<br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  past: [...pastStatesHere...],</div><div class="line">  present: <span class="meta">&#123;...currentStateHere...&#125;</span>,</div><div class="line">  future: [...futureStatesHere...]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨<code>state.present</code>è·å–å½“å‰çš„state<br>è·å–æ‰€æœ‰è¿‡å»çš„stateä½¿ç”¨<code>state.past</code>.</p>
<h2 id="Undo-Redo-Actions"><a href="#Undo-Redo-Actions" class="headerlink" title="Undo/Redo Actions"></a>Undo/Redo Actions</h2><p>é¦–å…ˆå¯¼å…¥undo/redo action creators<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>ç„¶åå°±å¯ä»¥ä½¿ç”¨<code>store.dispatch()</code>å’Œundo/redo action creatorsæ¥æ‰§è¡Œundo/redoæ“ä½œ.<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">store.dispatch<span class="comment">(ActionCreators.undo()</span>) <span class="comment">// undo the last action </span></div><div class="line">store.dispatch<span class="comment">(ActionCreators.redo()</span>) <span class="comment">// redo the last action </span></div><div class="line"> </div><div class="line">store.dispatch<span class="comment">(ActionCreators.jumpToPast(index)</span>) <span class="comment">// jump to requested index in the past[] array </span></div><div class="line">store.dispatch<span class="comment">(ActionCreators.jumpToFuture(index)</span>) <span class="comment">// jump to requested index in the future[] array</span></div></pre></td></tr></table></figure></p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é…ç½®å¯¹è±¡ä¼ é€’ç»™<code>undoable()</code>(å€¼æ˜¯é»˜è®¤å€¼)</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  limi<span class="variable">t:</span> false, // <span class="keyword">set</span> <span class="keyword">to</span> <span class="keyword">a</span> <span class="keyword">number</span> <span class="keyword">to</span> turn <span class="keyword">on</span> <span class="keyword">a</span> limit <span class="keyword">for</span> the <span class="keyword">history</span> </div><div class="line"> </div><div class="line">  <span class="built_in">filter</span>: () =&gt; true, // see `Filtering Actions` section </div><div class="line"> </div><div class="line">  undoType: ActionTypes.UNDO, // define <span class="keyword">a</span> custom action <span class="built_in">type</span> <span class="keyword">for</span> this <span class="keyword">undo</span> action </div><div class="line">  redoType: ActionTypes.REDO, // define <span class="keyword">a</span> custom action <span class="built_in">type</span> <span class="keyword">for</span> this <span class="keyword">redo</span> action </div><div class="line"> </div><div class="line">  jumpToPastType: ActionTypes.JUMP_TO_PAST, // define custom action <span class="built_in">type</span> <span class="keyword">for</span> this jumpToPast action </div><div class="line">  jumpToFutureType: ActionTypes.JUMP_TO_FUTURE, // define custom action <span class="built_in">type</span> <span class="keyword">for</span> this jumpToFuture action </div><div class="line"> </div><div class="line">  initialState: undefined, // initial state (<span class="keyword">e</span>.g. <span class="keyword">for</span> loading) </div><div class="line">  initType<span class="variable">s:</span> [<span class="string">'@@redux/INIT'</span>, <span class="string">'@@INIT'</span>] // <span class="keyword">history</span> will <span class="keyword">be</span> (re)<span class="keyword">set</span> upon init action <span class="built_in">type</span> </div><div class="line">  initialHistory: &#123; // initial <span class="keyword">history</span> (<span class="keyword">e</span>.g. <span class="keyword">for</span> loading) </div><div class="line">    pas<span class="variable">t:</span> [],</div><div class="line">    presen<span class="variable">t:</span> config.initialState,</div><div class="line">    future: []</div><div class="line">  &#125;,</div><div class="line"> </div><div class="line">  debu<span class="variable">g:</span> false, // <span class="keyword">set</span> <span class="keyword">to</span> `true` <span class="keyword">to</span> turn <span class="keyword">on</span> debugging </div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="è¿‡æ»¤Actions"><a href="#è¿‡æ»¤Actions" class="headerlink" title="è¿‡æ»¤Actions"></a>è¿‡æ»¤Actions</h2><p>å¦‚æœä½ ä¸æƒ³åŒ…å«æ¯ä¸€æ­¥çš„action,å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°åˆ°<code>undoable</code><br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, <span class="keyword">function</span> <span class="title">filterActions</span>(action, currentState, previousState) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="type">action.type</span> === SOME_ACTION; // only add to history <span class="keyword">if</span> action <span class="keyword">is</span> SOME_ACTIONåªæœ‰some_actionçš„actionæ‰èƒ½è®°å½• </div><div class="line">&#125;)</div><div class="line"> </div><div class="line">// <span class="keyword">or</span> you could <span class="keyword">do</span>... </div><div class="line"> </div><div class="line">undoable(reducer, <span class="keyword">function</span> <span class="title">filterState</span>(action, currentState, previousState) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="type">currentState</span> !== previousState; // only add to history <span class="keyword">if</span> state changedåªæœ‰stateå˜åŒ–çš„æ‰èƒ½è®°å½•é‡åš </div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨<code>distinctState</code>,<code>includeAction</code>,<code>excludeAction</code>åŠ©æ‰‹å‡½æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123; distinctState, includeAction, excludeAction &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨åŠ©æ‰‹å‡½æ•°äº†,ç›¸å½“ç®€å•<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: includeAction(SOME_ACTION)</span></span> &#125;)</div><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: excludeAction(SOME_ACTION)</span></span> &#125;)</div><div class="line"> </div><div class="line"><span class="comment">// or you could do... </span></div><div class="line"> </div><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: distinctState()</span></span> &#125;)</div></pre></td></tr></table></figure></p>
<p>ç”šè‡³è¿˜æ”¯æŒæ•°ç»„<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">undoable</span>(<span class="selector-tag">reducer</span>, &#123; <span class="attribute">filter</span>: <span class="built_in">includeAction</span>([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div><div class="line"><span class="selector-tag">undoable</span>(<span class="selector-tag">reducer</span>, &#123; <span class="attribute">filter</span>: <span class="built_in">excludeAction</span>([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div></pre></td></tr></table></figure></p>
<h2 id="æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„"><a href="#æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„" class="headerlink" title="æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„"></a>æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„</h2><p>Reduxæ–‡æ¡£ä¸­çš„<a href="https://rackt.github.io/redux/docs/recipes/ImplementingUndoHistory.html" target="_blank" rel="external"><code>å®ç°Undoå†å²çš„æ–¹æ¡ˆ</code></a>è§£é‡Šäº†redux-undoå·¥ä½œçš„å…·ä½“ç»†èŠ‚.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Reduxçš„æ–‡æ¡£ä¸­æä¾›ä¸€ä¸ªå¯ä»¥åšundo/redoçš„è§£å†³åŠæ³•,å®é™…æ˜¯æœ‰previous,current,prewçš„å¯¹è±¡,å›´ç»•è¿™æ•°æ®çš„å‹å…¥å’Œå¼¹å‡ºæ¥å®ç°æ“ä½œæ­¥éª¤çš„è®°å¿†,ç»“åˆpersistå°±å¯ä»¥å®ç°æ›´å¼ºå¤§çš„è®°å¿†åŠŸèƒ½.ä»Šå¤©çš„è¿™ä¸ªå¢å¼ºç»„ä»¶å®é™…æŠŠè¿™ä¸ªåŠŸèƒ½ç»™åŒ…è£…
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Immutable Data Structures and JavaScript</title>
    <link href="https://phpsmarter.github.com/2017/04/04/%E7%BF%BB%E8%AF%91-Immutable-Data-Structures-and-JavaScript/"/>
    <id>https://phpsmarter.github.com/2017/04/04/ç¿»è¯‘-Immutable-Data-Structures-and-JavaScript/</id>
    <published>2017-04-04T12:28:01.000Z</published>
    <updated>2017-04-04T05:08:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ä¹…ä»¥å‰æˆ‘ç®€å•çš„è°ˆäº†è°ˆæˆ‘çš„æƒ³æ³•,æŠŠæœ€æ–°çš„blogé‡å†™ä¸€ä¸‹,å‘èª“è¦æ¶‰åŠä¸€äº›å­¦åˆ°çš„æœ‰æ·±åº¦çš„ä¸œè¥¿.ç°åœ¨æˆ‘è¦è°ˆè°ˆjavascriptä¸­çš„immutableæ•°æ®ç»“æ„,å°¤å…¶æ˜¯ä¸¤ä¸ªåº“<a href="https://github.com/facebook/immutable-js" target="_blank" rel="external">immutable.js</a>å’Œ<a href="https://github.com/rtfeldman/seamless-immutable" target="_blank" rel="external">seamliess-immutable</a>.è¿˜æœ‰å…¶ä»–çš„åº“,ä½†æ˜¯é€‰æ‹©æ ‡æ ‡å‡†æ˜¯çœŸæ­£çš„æŒä¹…æ•°æ®ç»“æ„æˆ–è€…æ‹·è´javascriptå¯¹è±¡çš„æ¦‚å¿µåŒºåˆ«.æ¯”è¾ƒè¿™ä¸¤ä¸ªé‡ç‚¹,ä¸è¦ç®¡åˆ°åº•æ˜¯é€‰æ‹©ä»€ä¹ˆåº“.æˆ‘è¿˜è¦è°ˆä¸€ç‚¹<a href="https://github.com/cognitect/transit-js" target="_blank" rel="external">transit-js</a>ï¼Œå®ƒåœ¨åšæ•°æ®çš„åºåˆ—åŒ–æ–¹é¢å¾ˆå¥½.</p>
<p>æœ‰å…³Reduxçš„åº”ç”¨è°ˆçš„å°‘ä¸€ç‚¹.å¤§ä½“æ˜¯è°ˆè°ˆimmutableæ•°æ®ç»“æ„çš„ä½¿ç”¨,ä½†æ˜¯ä¹Ÿæä¾›ä¸€äº›åœ¨Reduxä¸­ä½¿ç”¨çš„ç‰¹æ®Šç‚¹.åœ¨Reduxä¸­,ä½ æœ‰å•ä¸ªçš„stateå¯¹è±¡,å¹¶ä¸”ä¸å¤åˆ¶ä»–,æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„,æ¯ä¸€ä¸ªéƒ½æœ‰æ‰€æƒè¡¡.æˆ‘ä¼šåœ¨åœ¨ä¸‹é¢æ¢ç´¢ä¸€ä¸‹.</p>
<p>åœ¨Reduxä¸­æœ‰ä¸€ä»¶äº‹æ˜¯è¦è€ƒè™‘æ€ä¹ˆèšåˆreducersæ¥å½¢æˆå•ä¸ªçš„app stateåŸå­.Reduxé»˜è®¤æä¾›çš„æ–¹å¼(combineReducers)å‡å®šä½ æŠŠå¤šä¸ªå€¼åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„javascriptå¯¹è±¡.å¦‚æœä½ æƒ³æŠŠä»–ä»¬åˆå¹¶æˆä¸€ä¸ªImmutable.jså¯¹è±¡,ä¾‹å¦‚ä½ å¯èƒ½éœ€è¦ç¼–å†™ä½ è‡ªå·±çš„<em>combinReducers</em>æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„.è¿™ä¸€ç‚¹å¯èƒ½ä¼šéå¸¸æœ‰å¿…è¦å¦‚æœä½ éœ€è¦åºåˆ—åŒ–ä½ çš„app state,å¹¶ä¸”ä½ è®¾å®šstateæ•´ä¸ªéƒ½æ˜¯ç”±Immutable.jså¯¹è±¡ç»„æˆçš„.</p>
<p>å¤§å¤šæ•°è¿™ç§åº”ç”¨ä¸€èˆ¬éƒ½ä½¿ç”¨immutableå¯¹è±¡.æœ‰æ—¶å€™æœ‰ç‚¹å°´å°¬,å› ä¸ºä½ è¦å’Œé»˜è®¤çš„è¯­æ³•æ–—äº‰,è¿™æ„Ÿè§‰å°±åƒä½ åœ¨ç”¨typesç©æ‚è€.ç„¶è€Œ,æ ¹æ®ä½ çš„appå’Œä½ çš„é…ç½®,ä½ å¯ä»¥ä»ä¸­è·³å‡ºæ¥.</p>
<p>ç›®å‰,æœ‰ä¸€ä¸ªä¸ºåŸç”ŸJavascriptåº”ç”¨æ·»åŠ immutableæ•°æ®ç»“æ„çš„<a href="https://github.com/sebmarkbage/ecmascript-immutable-data-structures" target="_blank" rel="external">å»ºè®®</a></p>
<h2 id="Immutable-js"><a href="#Immutable-js" class="headerlink" title="Immutable.js"></a>Immutable.js</h2><p>Immutable.jsæ¥è‡ªFacebook,å®ƒæ˜¯å®ç°immutableæ•°æ®ç»“æ„æœ€æµè¡Œçš„æ–¹æ³•.è§„æ¨¡å¾ˆåºå¤§,ä½¿ç”¨ç±»ä¼¼<code>tries</code>çš„é«˜çº§æ–¹æ³•å®ç°ç»“æ„åŒ–å…±äº«,å®ç°æ•´ä¸ªæ•°æ®çš„æŒä¹…åŒ–.æ‰€æœ‰çš„æ›´æ–°éƒ½è¿”å›æ–°å€¼,ä½†æ˜¯å†…éƒ¨ç»“æ„æ˜¯å…±äº«çš„,è¿™ä¸€ç‚¹å¤§å¤§çš„é™ä½äº†å†…å­˜çš„ä½¿ç”¨(GC thrashing).è¿™å°±æ„å‘³ç€å¦‚æœä½ åº”ç”¨ä¸€ä¸ªæœ‰1000ä¸ªå…ƒç´ çš„çŸ¢é‡,ä»–ä¸ä¼šå®é™…åˆ›å»ºä¸€ä¸ªæœ‰1001ä¸ªå…ƒç´ çš„æ–°çŸ¢é‡.å¤§å¤šæ•°æƒ…å†µä¸‹,å†…éƒ¨ä»…ä»…æœ‰ä¸€äº›å°çš„å¯¹è±¡è¢«åˆ†é….</p>
<p>æ•°æ®ç»“æ„å…±äº«çš„å…ˆè¿›æ€§,å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ç”±Okasakiçš„å¼€åˆ›æ€§å·¥ä½œå¯å‘çš„,</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ä¹…ä»¥å‰æˆ‘ç®€å•çš„è°ˆäº†è°ˆæˆ‘çš„æƒ³æ³•,æŠŠæœ€æ–°çš„blogé‡å†™ä¸€ä¸‹,å‘èª“è¦æ¶‰åŠä¸€äº›å­¦åˆ°çš„æœ‰æ·±åº¦çš„ä¸œè¥¿.ç°åœ¨æˆ‘è¦è°ˆè°ˆjavascriptä¸­çš„immutableæ•°æ®ç»“æ„,å°¤å…¶æ˜¯ä¸¤ä¸ªåº“&lt;a href=&quot;https://github.com/facebook/immutable-js&quot; ta
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="javascript" scheme="https://phpsmarter.github.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>Redux undo/redo</title>
    <link href="https://phpsmarter.github.com/2017/04/04/Redux-undo-redo/"/>
    <id>https://phpsmarter.github.com/2017/04/04/Redux-undo-redo/</id>
    <published>2017-04-04T00:18:11.000Z</published>
    <updated>2017-04-03T16:20:20.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="redux-undo-redo"><a href="#redux-undo-redo" class="headerlink" title="redux undo/redo"></a>redux undo/redo</h1><blockquote>
<p>è¿™æ˜¯æŠŠredux undoçš„å †æ ˆæ“ä½œæœ‰åŒ…è£…äº†ä¸€ä¸‹</p>
</blockquote>
<p><a href="https://www.npmjs.com/package/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-undo.svg?style=flat-square" alt="NPM version (&gt;=0.4)"></a> <a href="https://www.npmjs.com/package/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/npm/dm/redux-undo.svg?style=flat-square" alt="NPM Downloads"></a> <a href="https://coveralls.io/r/omnidan/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/coveralls/omnidan/redux-undo.svg?style=flat-square" alt="Coverage Status"></a> <a href="https://david-dm.org/omnidan/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/david/omnidan/redux-undo.svg?style=flat-square" alt="Dependencies"></a> <a href="http://standardjs.com/" target="_blank" rel="external"><img src="https://img.shields.io/badge/code%20style-standard-brightgreen.svg?style=flat-square" alt="js-standard-style"></a> <a href="https://raw.githubusercontent.com/omnidan/redux-undo/master/LICENSE.md" target="_blank" rel="external"><img src="https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square" alt="GitHub license"></a></p>
<p><em>simple undo/redo functionality for redux state containers</em></p>
<p><a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external"><img src="https://i.imgur.com/M2KR4uo.gif" alt="https://i.imgur.com/M2KR4uo.gif"></a></p>
<p><strong>Protip:</strong> Check out the <a href="https://github.com/omnidan/redux-undo/tree/master/examples/todos-with-undo" target="_blank" rel="external">todos-with-undo example</a> or the <a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external">redux-undo-boilerplate</a> to quickly get started with <code>redux-undo</code>.</p>
<p><strong>Switching from 0.x to 1.0 (beta):</strong> Make sure to update your programs to the <a href="#history-api">latest History API</a>.</p>
<hr>
<p><strong>This README is about the new 1.0-beta branch of redux-undo, if you are using<br>or plan on using 0.6, check out <a href="https://github.com/omnidan/redux-undo/tree/0.6" target="_blank" rel="external">the <code>0.6</code> branch</a></strong></p>
<hr>
<h2 id="Note-on-1-0-0-beta7"><a href="#Note-on-1-0-0-beta7" class="headerlink" title="Note on 1.0.0-beta7"></a>Note on 1.0.0-beta7</h2><p>If you use Redux Undo in CommonJS environment, <strong>donâ€™t forget to add <code>.default</code> to your import</strong>.</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="deletion">- var ReduxUndo = require('redux-undo')</span></div><div class="line"><span class="addition">+ var ReduxUndo = require('redux-undo').default</span></div></pre></td></tr></table></figure>
<p>If your environment support es modules just go by:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ReduxUndo <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>We are also supporting UMD build:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ReduxUndo = <span class="built_in">window</span>.ReduxUndo.default;</div></pre></td></tr></table></figure>
<p><strong>once again <code>.default</code> is required.</strong></p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">npm</span> install --save redux-undo@beta</div></pre></td></tr></table></figure>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div><div class="line">undoable(reducer)</div><div class="line">undoable(reducer, config)</div></pre></td></tr></table></figure>
<h2 id="Making-your-reducers-undoable"><a href="#Making-your-reducers-undoable" class="headerlink" title="Making your reducers undoable"></a>Making your reducers undoable</h2><p><code>redux-undo</code> is a reducer enhancer (higher-order reducer), it provides the <code>undoable</code> function, which<br>takes an existing reducer and a configuration object and enhances your existing<br>reducer with undo functionality.</p>
<p><strong>Note:</strong> If you were accessing <code>state.counter</code> before, you have to access<br><code>state.counter.present</code> after wrapping your reducer with <code>undoable</code>.</p>
<p>To install, firstly import <code>redux-undo</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Redux utility functions</span></div><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="comment">// redux-undo higher-order reducer</span></div><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Then, add <code>undoable</code> to your reducer(s) like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">combineReducers(&#123;</div><div class="line">  <span class="attr">counter</span>: undoable(counter)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>A <a href="#configuration">configuration</a> can be passed like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">combineReducers(&#123;</div><div class="line">  <span class="attr">counter</span>: undoable(counter, &#123;</div><div class="line">    <span class="attr">limit</span>: <span class="number">10</span> <span class="comment">// set a limit for the history</span></div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="History-API"><a href="#History-API" class="headerlink" title="History API"></a>History API</h2><p>Wrapping your reducer with <code>undoable</code> makes the state look like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">past</span>: [...pastStatesHere...],</div><div class="line">  <span class="attr">present</span>: &#123;...currentStateHere...&#125;,</div><div class="line">  <span class="attr">future</span>: [...futureStatesHere...]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now you can get your current state like this: <code>state.present</code></p>
<p>And you can access all past states (e.g. to show a history) like this: <code>state.past</code></p>
<h2 id="Undo-Redo-Actions"><a href="#Undo-Redo-Actions" class="headerlink" title="Undo/Redo Actions"></a>Undo/Redo Actions</h2><p>Firstly, import the undo/redo action creators:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Then, you can use <code>store.dispatch()</code> and the undo/redo action creators to<br>perform undo/redo operations on your state:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">store.dispatch(ActionCreators.undo()) <span class="comment">// undo the last action</span></div><div class="line">store.dispatch(ActionCreators.redo()) <span class="comment">// redo the last action</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.jump(<span class="number">-2</span>)) <span class="comment">// undo 2 steps</span></div><div class="line">store.dispatch(ActionCreators.jump(<span class="number">5</span>)) <span class="comment">// redo 5 steps</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.jumpToPast(index)) <span class="comment">// jump to requested index in the past[] array</span></div><div class="line">store.dispatch(ActionCreators.jumpToFuture(index)) <span class="comment">// jump to requested index in the future[] array</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.clearHistory()) <span class="comment">// [beta only] Remove all items from past[] and future[] arrays</span></div></pre></td></tr></table></figure>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>A configuration object can be passed to <code>undoable()</code> like this (values shown<br>are default values):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">limit</span>: <span class="literal">false</span>, <span class="comment">// set to a number to turn on a limit for the history</span></div><div class="line"></div><div class="line">  filter: <span class="function"><span class="params">()</span> =&gt;</span> <span class="literal">true</span>, <span class="comment">// see `Filtering Actions` section</span></div><div class="line"></div><div class="line">  undoType: ActionTypes.UNDO, <span class="comment">// define a custom action type for this undo action</span></div><div class="line">  redoType: ActionTypes.REDO, <span class="comment">// define a custom action type for this redo action</span></div><div class="line"></div><div class="line">  jumpType: ActionTypes.JUMP, <span class="comment">// define custom action type for this jump action</span></div><div class="line"></div><div class="line">  jumpToPastType: ActionTypes.JUMP_TO_PAST, <span class="comment">// define custom action type for this jumpToPast action</span></div><div class="line">  jumpToFutureType: ActionTypes.JUMP_TO_FUTURE, <span class="comment">// define custom action type for this jumpToFuture action</span></div><div class="line"></div><div class="line">  clearHistoryType: ActionTypes.CLEAR_HISTORY, <span class="comment">// [beta only] define custom action type for this clearHistory action</span></div><div class="line">  <span class="comment">// you can also pass an array of strings to define several action types that would clear the history</span></div><div class="line">  <span class="comment">// beware: those actions will not be passed down to the wrapped reducers</span></div><div class="line"></div><div class="line">  initTypes: [<span class="string">'@@redux-undo/INIT'</span>] <span class="comment">// history will be (re)set upon init action type</span></div><div class="line">  <span class="comment">// beware: those actions will not be passed down to the wrapped reducers</span></div><div class="line"></div><div class="line">  debug: <span class="literal">false</span>, <span class="comment">// set to `true` to turn on debugging</span></div><div class="line"></div><div class="line">  neverSkipReducer: <span class="literal">false</span>, <span class="comment">// prevent undoable from skipping the reducer on undo/redo and clearHistoryType actions</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p><strong>Note:</strong> If you want to use just the <code>initTypes</code> functionality, but not import<br>the whole redux-undo library, use <a href="https://github.com/omnidan/redux-recycle" target="_blank" rel="external">redux-recycle</a>!</p>
<h4 id="Initial-State-and-History"><a href="#Initial-State-and-History" class="headerlink" title="Initial State and History"></a>Initial State and History</h4><p>You can use your redux store to set an initial history for your undoable reducers:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> initialHistory = &#123;</div><div class="line">  <span class="attr">past</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">  <span class="attr">present</span>: <span class="number">4</span>,</div><div class="line">  <span class="attr">future</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(undoable(counter), initialHistory);</div></pre></td></tr></table></figure>
<p>Or just set the current state like youâ€™re used to with Redux. Redux-undo will create the history for you:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(undoable(counter), &#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">// will make the state look like this:</span></div><div class="line">&#123;</div><div class="line">  <span class="attr">past</span>: [],</div><div class="line">  <span class="attr">present</span>: &#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;,</div><div class="line">  <span class="attr">future</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Filtering-Actions"><a href="#Filtering-Actions" class="headerlink" title="Filtering Actions"></a>Filtering Actions</h3><p>If you donâ€™t want to include every action in the undo/redo history, you can<br>add a <code>filter</code> function to <code>undoable</code>. <code>redux-undo</code> provides you with the<br><code>includeAction</code> and <code>excludeAction</code> helpers for basic filtering.</p>
<p>They should be imported like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123; includeAction, excludeAction &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Now you can use the helper functions:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: includeAction(SOME_ACTION) &#125;)</div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: excludeAction(SOME_ACTION) &#125;)</div><div class="line"></div><div class="line"><span class="comment">// they even support Arrays:</span></div><div class="line"></div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: includeAction([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: excludeAction([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div></pre></td></tr></table></figure>
<p><strong>Note:</strong> Since <a href="https://github.com/omnidan/redux-undo/releases/tag/beta4" target="_blank" rel="external"><code>beta4</code></a>,<br>          only actions resulting in a new state are recorded. This means the<br>          (now deprecated) <code>distinctState()</code> filter is auto-applied.</p>
<h4 id="Custom-filters"><a href="#Custom-filters" class="headerlink" title="Custom filters"></a>Custom filters</h4><p>If you want to create your own filter, pass in a function with the signature<br><code>(action, currentState, previousHistory)</code>. For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: <span class="function"><span class="keyword">function</span> <span class="title">filterActions</span>(<span class="params">action, currentState, previousHistory</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> action.type === SOME_ACTION; <span class="comment">// only add to history if action is SOME_ACTION</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// The entire `history` state is available to your filter, so you can make</span></div><div class="line"><span class="comment">// decisions based on past or future states:</span></div><div class="line"></div><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: <span class="function"><span class="keyword">function</span> <span class="title">filterState</span>(<span class="params">action, currentState, previousHistory</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> &#123; past, present, future &#125; = previousHistory;</div><div class="line">    <span class="keyword">return</span> future.length === <span class="number">0</span>; <span class="comment">// only add to history if future is empty</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Combining-Filters"><a href="#Combining-Filters" class="headerlink" title="Combining Filters"></a>Combining Filters</h3><p>You can also use our helper to combine filters.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123;combineFilters&#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isActionSelfExcluded</span>(<span class="params">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> action.wouldLikeToBeInHistory</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">areWeRecording</span>(<span class="params">action, state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.recording</div><div class="line">&#125;</div><div class="line"></div><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: combineFilters(isActionSelfExcluded, areWeRecording)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Ignoring-Actions"><a href="#Ignoring-Actions" class="headerlink" title="Ignoring Actions"></a>Ignoring Actions</h3><p>When implementing a filter function, it only prevents the old state from being<br>stored in the history. <strong><code>filter</code> does not prevent the present state from being<br>updated.</strong></p>
<p>If you want to ignore an action completely, as in, not even update the present<br>state, you can make use of <a href="https://github.com/omnidan/redux-ignore" target="_blank" rel="external">redux-ignore</a>.</p>
<p>It can be used like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ignoreActions &#125; <span class="keyword">from</span> <span class="string">'redux-ignore'</span></div><div class="line"></div><div class="line">ignoreActions(</div><div class="line">  undoable(reducer),</div><div class="line">  [IGNORED_ACTION, ANOTHER_IGNORED_ACTION]</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// or define your own function:</span></div><div class="line"></div><div class="line">ignoreActions(</div><div class="line">  undoable(reducer),</div><div class="line">  (action) =&gt; action.type === SOME_ACTION <span class="comment">// only add to history if action is SOME_ACTION</span></div><div class="line">)</div></pre></td></tr></table></figure>
<h2 id="What-is-this-magic-How-does-it-work"><a href="#What-is-this-magic-How-does-it-work" class="headerlink" title="What is this magic? How does it work?"></a>What is this magic? How does it work?</h2><p>Have a read of the <a href="http://redux.js.org/docs/recipes/ImplementingUndoHistory.html" target="_blank" rel="external">Implementing Undo History recipe</a> in the Redux documents, which explains in detail how redux-undo works.</p>
<h2 id="Gitter-Chat-Support"><a href="#Gitter-Chat-Support" class="headerlink" title="Gitter Chat / Support"></a>Gitter Chat / Support</h2><p>If you have a question or just want to discuss something with other redux-undo users/maintainers, <a href="https://gitter.im/omnidan/redux-undo" target="_blank" rel="external">chat with the community on gitter.im/omnidan/redux-undo</a></p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT, see <code>LICENSE.md</code> for more information.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;redux-undo-redo&quot;&gt;&lt;a href=&quot;#redux-undo-redo&quot; class=&quot;headerlink&quot; title=&quot;redux undo/redo&quot;&gt;&lt;/a&gt;redux undo/redo&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯æŠŠre
    
    </summary>
    
      <category term="Readme" scheme="https://phpsmarter.github.com/categories/Readme/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Simple React Native forms with redux-form, immutable.js and styled-components - Esben Petersen</title>
    <link href="https://phpsmarter.github.com/2017/04/04/%E7%BF%BB%E8%AF%91-Simple-React-Native-forms-with-redux-form-immutable-js-and-styled-components-Esben-Petersen/"/>
    <id>https://phpsmarter.github.com/2017/04/04/ç¿»è¯‘-Simple-React-Native-forms-with-redux-form-immutable-js-and-styled-components-Esben-Petersen/</id>
    <published>2017-04-03T16:07:15.000Z</published>
    <updated>2017-04-03T12:09:10.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åœ¨Reactä¸­å¤„ç†è¡¨å•è¿˜ä¸æ€ä¹ˆå¥½å¼„,çœ‹çœ‹è¿™ç¯‡æ–‡ç« è®²çš„æŒºå¥½çš„çœ‹çœ‹,è¯•ç€ç¿»è¯‘ä¸€ä¸‹<br>  <a href="http://esbenp.github.io/2017/01/06/react-native-redux-form-immutable-styled-components/" target="_blank" rel="external">åŸæ–‡å‚çœ‹</a></p>
</blockquote>
<h1 id="start"><a href="#start" class="headerlink" title="start"></a>start</h1><p>å¦‚æœä½ æƒ³çœ‹çœ‹æ€ä¹ˆåœ¨react-native æƒ³ä½¿ç”¨redux-formå’Œimmutable.js.ä½ çœ‹å¯ä»¥çœ‹çœ‹<a href="https://github.com/esbenp/react-native-redux-form-example" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« çš„ä»£ç </a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>åœ¨<code>Traede</code>,æˆ‘ä½¿ç”¨reduxæ•´åˆredux-formæ¥åˆ›å»ºè¡¨å•.redux-formæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„åº“,ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆå¥½çš„ç¤ºä¾‹ä»£ç ä»‹ç»æ€ä¹ˆå’ŒReact-nativeé…åˆä½¿ç”¨.æ‰€ä»¥å½“æˆ‘å¼€å§‹åœ¨React-Natvieä¸­ä½¿ç”¨redux-formçš„æ—¶å€™,å‘ç°è¿˜æ˜¯æœ‰ä¸€ç‚¹éš¾åº¦çš„.å¤§å¤šæ•°çš„æƒ…å†µéƒ½å› ä¸ºæˆ‘å‘ç°åœ¨React-Nativeä¸­ä½¿ç”¨Immutable.jsçš„æ—¶å€™ä¼šä¸­æ–­redux-formè¿è¡Œçš„bug.Redux-formä¸»ç‰ˆæœ¬å·å·²ç»åˆ°äº†6.4.2äº†.æ‰€ä»¥æˆ‘è€ƒè™‘å¯ä»¥æ ¹æ®æˆ‘çš„å­¦ä¹ è¿‡ç¨‹æ¥å†™ä¸€ç‚¹æ€ä¹ˆåœ¨åº”ç”¨ä¸­åŒæ—¶ä½¿ç”¨redux-formå’ŒImmutable.jsçš„æ–‡æ¡£.</p>
<h2 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h2><p>å¤§ä½“çš„æ­¥éª¤æ˜¯:</p>
<ol>
<li>çœ‹çœ‹redux-formåœ¨nativeå’Œwebä¹‹é—´çš„å·®å¼‚ç‚¹</li>
<li>çœ‹çœ‹æ€ä¹ˆä½¿redux-formå’ŒImmutable.jsä¸€èµ·ä½¿ç”¨</li>
<li>ä½¿ç”¨react-native-clean-formçš„å®Œæ•´å®ä¾‹</li>
</ol>
<p>é¸¡å†»ä¸ï¼Ÿå¥½äº†,å¼€å§‹äº†</p>
<h2 id="åœ¨React-nativeä¸­ä½¿ç”¨redux-form"><a href="#åœ¨React-nativeä¸­ä½¿ç”¨redux-form" class="headerlink" title="åœ¨React-nativeä¸­ä½¿ç”¨redux-form"></a>åœ¨React-nativeä¸­ä½¿ç”¨redux-form</h2><p>å¦‚æœä½ ä¸å¤ªç†Ÿæ‚‰redux-form,æˆ‘å»ºè®®ä½ çœ‹çœ‹<a href="http://redux-form.com/6.4.3/docs/GettingStarted.md/" target="_blank" rel="external">redux-formç®€å•æ–‡æ¡£</a><br>.<em>æ³¨æ„ï¼šè¿™ä¸ªæŒ‡å—å‡å®šä½ ä½¿ç”¨çš„redux-formçš„ç‰ˆæœ¬å¤§äº6.4.2</em>.å¦‚æœä¸æ˜¯è¿™ä¸ªç‰ˆæœ¬,å¹¶ä¸”è¿˜åœ¨ä½¿ç”¨Immutable.js,é‚£ä¹ˆè¦çœ‹çœ‹è¿™ä¸ª<a href="https://github.com/erikras/redux-form/pull/2336" target="_blank" rel="external">issue</a>.åˆ›å»ºä¸€ä¸ªè¡¨å•åŸºç¡€çš„ä¸‰ä¸ªæ­¥éª¤æ˜¯:</p>
<ol>
<li>åœ¨ä½ çš„redux storeä¸­åŠ å…¥redux-form reducer</li>
<li>ä½¿ç”¨<code>reduxForm</code>åŒ…è£…å™¨æŠŠä½ çš„è¡¨å•è¿æ¥åˆ°store</li>
<li>ä½¿ç”¨<code>Field</code>åŒ…è£…å™¨æŠŠç‰¹å®šçš„è¡¨å•å­—æ®µè¿æ¥åˆ°Store</li>
</ol>
<h3 id="0-åˆ›å»ºReact-Native-é¡¹ç›®"><a href="#0-åˆ›å»ºReact-Native-é¡¹ç›®" class="headerlink" title="0. åˆ›å»ºReact Native é¡¹ç›®"></a>0. åˆ›å»ºReact Native é¡¹ç›®</h3><p>å‡è®¾ä½ å·²ç»æœ‰äº†å¯ä»¥è¿è¡Œçš„React Nativeé¡¹ç›®.å¦‚æœæ²¡æœ‰,ä½¿ç”¨<code>react-native init MyReduxFormProjct</code>ç»ˆç«¯å‘½ä»¤è¡Œå‘½ä»¤ä¹Ÿå¾ˆå®¹æ˜“åˆ›å»ºé¡¹ç›®.</p>
<h3 id="1-æŠŠredux-form-reduceræ·»åŠ åˆ°ä½ çš„redux-store"><a href="#1-æŠŠredux-form-reduceræ·»åŠ åˆ°ä½ çš„redux-store" class="headerlink" title="1.æŠŠredux-form reduceræ·»åŠ åˆ°ä½ çš„redux store"></a>1.æŠŠredux-form reduceræ·»åŠ åˆ°ä½ çš„redux store</h3><p>åšè¿™ä¸€æ­¥,è¯·å‚è€ƒ<a href="http://redux-form.com/6.4.3/docs/GettingStarted.md/" target="_blank" rel="external">redux-formæ–‡æ¡£</a></p>
<h3 id="2-ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store"><a href="#2-ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store" class="headerlink" title="2.ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store"></a>2.ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store</h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„è¡¨å•æ¥å¼€å§‹å·¥ä½œ.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  TextInput,</div><div class="line">  TouchableOpacity,</div><div class="line">  View</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Form = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TextInput</span> <span class="attr">style</span>=<span class="string">&#123;styles.input&#125;</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.button&#125;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default Form</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  button: &#123;</div><div class="line">    backgroundColor: 'blue',</div><div class="line">    color: 'white',</div><div class="line">    height: 30,</div><div class="line">    lineHeight: 30,</div><div class="line">    marginTop: 10,</div><div class="line">    textAlign: 'center',</div><div class="line">    width: 250</div><div class="line">  &#125;,</div><div class="line">  container: &#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  input: &#123;</div><div class="line">    borderColor: 'black',</div><div class="line">    borderWidth: 1,</div><div class="line">    height: 37,</div><div class="line">    width: 250</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcly1fe9qllp362j30680b4743.jpg" alt=""></p>
<p>å¥½äº†,æˆ‘ä»¬å·²ç»æœ‰äº†è¡¨å•,çœ‹èµ·æ¥å’Œåäº¿ç¾å…ƒçº§åˆ«çš„appå·®ä¸å¤š.ä¸‹é¢æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>reduxForm</code>åŒ…è£…å™¨æŠŠè¡¨å•è¿æ¥åˆ°redux formä¸Š.è¿™æ˜¯å› ä¸ºåœ¨è¡¨å•ä¸­çš„æ¯ä¸€ä¸ªæŒ‰é”®æ“ä½œéƒ½ä¼šå‘é€è¾“å…¥å­—æ®µçš„å€¼åˆ°store.å½“æˆ‘ä»¬æŒ‰ä¸‹æäº¤æŒ‰é’®,redux-formå°†ä¼šä»storeä¸­è·å–ä¿å­˜çš„å€¼å‘é€åˆ°ä¸€ä¸ªæˆ‘ä»¬å®šåˆ¶çš„å›è°ƒå‡½æ•°.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; reduxForm &#125; <span class="keyword">from</span> <span class="string">'redux-form'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> submit = <span class="function"><span class="params">values</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'submitting form'</span>, values)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Form = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> &#123; handleSubmit &#125; = props</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TextInput</span> <span class="attr">style</span>=<span class="string">&#123;styles.input&#125;</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;handleSubmit(submit)&#125;</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.button&#125;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(&#123;</div><div class="line">  form: 'test'</div><div class="line">&#125;)(Form)</div></pre></td></tr></table></figure>
<p><em>æ³¨é‡Šï¼šä¸ºäº†ç®€å•,çœç•¥äº†æ ·å¼å’Œå¯¹è±¡çš„å¯¼å…¥ä»£ç </em></p>
<p>å¥½äº†,é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>reduxForm</code>åŒ…è£…formå¹¶è¿æ¥åˆ°store.è¿™æ˜¯<code>react-redux</code>çš„åŸºç¡€ç‰ˆæœ¬ä¹‹ä¸Šçš„ä¸€ç‚¹ä¿®æ”¹,å¯èƒ½ä½ æ¯”è¾ƒç†Ÿæ‚‰äº†.</p>
<p>æ¥ç€,æˆ‘ä»¬ä½¿ç”¨äº†redux-formçš„<code>handleSubmit</code>(è¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡<code>redux-Formæ³¨å…¥åˆ°ç»„ä»¶ä¸­çš„</code>).submitå‡½æ•°é™„åŠ åˆ°æˆ‘ä»¬çš„submitæŒ‰é’®ä¸Š,æ‰€ä»¥ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™,è¡¨å•ä¼šè¢«æäº¤.è¿™ä¸€ç‚¹å’Œwebå¼€å‘çš„submitå‡½æ•°æ˜¯ä¸åŒçš„,webå¼€å‘ä¸­è¿™ä¸ªå‡½æ•°é™„åŠ åˆ°formå…ƒç´ ä¸Š.åœ¨ç§»åŠ¨å¹³å°ä¸Šæ²¡æœ‰formå…ƒç´ ,æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠå®ƒæ·»åŠ åˆ°buttonä¸Š,æˆ–è€…<code>TouchableOpaticy</code>.å°±æ˜¯è¿™ä¹ˆå›äº‹.</p>
<p>åˆ°äº†è¿™ä¸€æ­¥,å¯ä»¥ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œä»£ç è¯•è¯•.æˆ‘é«˜åº¦æ¨è<code>react-native-debugger</code>ä½œä¸ºDebugger.ä½ å¯ä»¥çœ‹çœ‹<a href="https://facebook.github.io/react-native/docs/debugging.html" target="_blank" rel="external">React Native æœ‰å…³deguggingæ–‡æ¡£</a>çš„å»ºè®®.</p>
<p>å½“ä½ åœ¨æ¨¡æ‹Ÿå™¨ä¸­è¯•ç€ç‚¹å‡»æäº¤è¡¨å•æ—¶,ä½ å¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°è¿”å›äº†ç©ºå€¼.</p>
<p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fe9qmb54t8j31aq0e0dh3.jpg" alt=""></p>
<p>å€¼åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<h3 id="3-ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store"><a href="#3-ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store" class="headerlink" title="3.ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store"></a>3.ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store</h3><p>æ‰€ä»¥è¯´,redux-formè¦å·¥ä½œ,ä½ å¿…é¡»è¦ä½¿ç”¨<code>Field</code>åŒ…è£…å™¨æŠŠæ¯ä¸€ä¸ªfieldè¿æ¥åˆ°store.</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="xml"> import </span><span class="template-variable">&#123; Field, reduxForm &#125;</span><span class="xml"> from 'redux-form'</span></div><div class="line"></div><div class="line">const submit = values =&gt; <span class="template-variable">&#123;</span></div><div class="line">  console.log('submitting form', values)</div><div class="line">&#125;<span class="xml"></span></div><div class="line"></div><div class="line">const renderInput = (<span class="template-variable">&#123; input: &#123; onChange, ...restInput &#125;</span><span class="xml">&#125;) =&gt; </span><span class="template-variable">&#123;</span></div><div class="line">  return &lt;TextInput style=&#123;styles.input&#125;<span class="xml"> onChangeText=</span><span class="template-variable">&#123;onChange&#125;</span><span class="xml"> </span><span class="template-variable">&#123;...restInput&#125;</span><span class="xml"> /&gt;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">const Form = props =&gt; <span class="template-variable">&#123;</span></div><div class="line">  const &#123; handleSubmit &#125;<span class="xml"> = props</span></div><div class="line"></div><div class="line">  return (</div><div class="line">    <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.container&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">component</span>=</span><span class="template-variable">&#123;renderInput&#125;</span><span class="xml"><span class="tag"> /&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=</span><span class="template-variable">&#123;handleSubmit(submit)&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.button&#125;</span><span class="xml"><span class="tag">&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(<span class="template-variable">&#123;</span></div><div class="line">  form: 'test'</div><div class="line">&#125;<span class="xml">)(Form)</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„,æˆ‘ä»¬æ·»åŠ äº†<code>Field</code>ç»„ä»¶,ç»™å®šäº†nameå±æ€§,å’Œwebå¼€å‘ä¸­çš„<code>input</code>fieldå·¥ä½œæ˜¯ç±»ä¼¼çš„.æˆ‘ä»¬ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ¸²æŸ“å‡½æ•°å‘Šè¯‰reduxForm,è¿™ä¸ªå­—æ®µåº”è¯¥æ€ä¹ˆæ¸²æŸ“.(åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ª<code>TextInput</code>ç»„ä»¶).</p>
<p><em>ç°åœ¨</em>è¿™é‡Œæœ‰äº›å°æŠ€å·§,å¾ˆå¤šäººå¯èƒ½ä¼šå‡ºé”™.<strong>æ‰€ä»¥ç•™å¿ƒä¸€ä¸‹</strong>.åœ¨web Reacä¸­<code>input</code>ç»„ä»¶ä¸­,å½“fieldçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶,è§¦å‘ä¸€ä¸ª<code>onChange</code>å›è°ƒå‡½æ•°.åœ¨React Nativeä¸­<code>TextInput</code>ç»„ä»¶è§¦å‘çš„æ˜¯<code>onChangeText</code>å›è°ƒå‡½æ•°.ä¸ºäº†åº”å¯¹è¿™ä¸ªé—®é¢˜,æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ å˜åŒ–çš„å¥æŸ„<code>onChangeText={onChange}</code>.</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcly1fe9qmuwabmj31ao0cmdh6.jpg" alt=""><br>ç°åœ¨å½“æˆ‘ä»¬æäº¤çš„æ—¶å€™,è¡¨å•å·¥ä½œäº†.</p>
<h2 id="ä½¿ç”¨Immutable-jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ"><a href="#ä½¿ç”¨Immutable-jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ" class="headerlink" title="ä½¿ç”¨Immutable.jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ"></a>ä½¿ç”¨Immutable.jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ</h2><p>å¦‚æœä½ æƒ³åœ¨stateçš„ç®¡ç†ä¸­ä½¿ç”¨immutable.js,é‚£ä¹ˆéœ€è¦ä¸€äº›é¢å¤–çš„æ­¥éª¤äº†é…åˆredux-formå·¥ä½œ.æˆ‘å»ºè®®ä½ è¯»è¯»<a href="http://redux-form.com/6.4.3/examples/immutable/" target="_blank" rel="external">ä½¿ç”¨immutable.jså’Œredux-formçš„å®˜æ–¹æ–‡æ¡£</a>.ä½†æ˜¯æˆ‘ä»¬é€šè¿‡ä¸€äº›æ­¥éª¤é©¬ä¸Šå¼€å§‹.</p>
<h3 id="1-ä½¿ç”¨redux-immutablejs-combineReducerså’Œredux-form-reducerçš„immutableç‰ˆæœ¬"><a href="#1-ä½¿ç”¨redux-immutablejs-combineReducerså’Œredux-form-reducerçš„immutableç‰ˆæœ¬" class="headerlink" title="1.ä½¿ç”¨redux-immutablejs combineReducerså’Œredux-form reducerçš„immutableç‰ˆæœ¬"></a>1.ä½¿ç”¨redux-immutablejs combineReducerså’Œredux-form reducerçš„immutableç‰ˆæœ¬</h3><p>æ‰¾åˆ°ä½ ç©¿ä»¶redux storeçš„ä»£ç å¤„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux-immutablejs'</span></div><div class="line"><span class="keyword">import</span> &#123; reducer <span class="keyword">as</span> form &#125; <span class="keyword">from</span> <span class="string">'redux-form/immutable'</span> <span class="comment">// &lt;--- immutable import</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> reducer = combineReducers(&#123; form &#125;)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸¤ä»¶äº‹:(1)ä½ å¿…é¡»ä½¿ç”¨ä»redux-immutableæˆ–è€…redux-immutablejsæ³¨å…¥<code>combineReducers</code>æ–¹æ³•.é‡è¦çš„æ˜¯è¾“å…¥çš„reduceræ˜¯ä»<code>redux-form/immutable</code>.<strong>å¹¶ä¸æ˜¯redux-form</strong>.</p>
<h3 id="2-ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬"><a href="#2-ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬" class="headerlink" title="2.ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬"></a>2.ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬</h3><p>è¿™ä¸€æ­¥å’Œç¬¬ä¸€æ­¥å®é™…æœ‰ç‚¹ç±»ä¼¼.å½“ä½ åœ¨<code>reduxForm</code>ä¸­åŒ…è£…ä¸€ä¸ªè¡¨å•è¿æ¥åˆ°redux storeçš„æ—¶å€™,ç¡®ä¿æ˜¯ä»<code>redux-form/immutable</code>å¯¼å…¥çš„.ç±»ä¼¼<br><code>Field</code>ä¹Ÿæ˜¯ä»è¿™é‡Œå¯¼å…¥çš„.<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="xml">import </span><span class="template-variable">&#123; Field, reduxForm &#125;</span><span class="xml"> from 'redux-form/immutable' // <span class="tag">&lt;<span class="name">----</span> <span class="attr">LOOK</span> <span class="attr">HERE</span></span></span></div><div class="line"></div><div class="line"><span class="attr">const</span> <span class="attr">submit</span> = <span class="string">values</span> =&gt; <span class="template-variable">&#123;</span></div><div class="line">  console.log('submitting form', values.toJS()) &lt;--- use toJS() to cast to plain object</div><div class="line">&#125;<span class="xml"></span></div><div class="line"></div><div class="line">const renderInput = (<span class="template-variable">&#123; input: &#123; onChange, ...restInput &#125;</span><span class="xml">&#125;) =&gt; </span><span class="template-variable">&#123;</span></div><div class="line">  return &lt;TextInput style=&#123;styles.input&#125;<span class="xml"> onChangeText=</span><span class="template-variable">&#123;onChange&#125;</span><span class="xml"> </span><span class="template-variable">&#123;...restInput&#125;</span><span class="xml"> /&gt;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">const Form = props =&gt; <span class="template-variable">&#123;</span></div><div class="line">  const &#123; handleSubmit &#125;<span class="xml"> = props</span></div><div class="line"></div><div class="line">  return (</div><div class="line">    <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.container&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">component</span>=</span><span class="template-variable">&#123;renderInput&#125;</span><span class="xml"><span class="tag"> /&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=</span><span class="template-variable">&#123;handleSubmit(submit)&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.button&#125;</span><span class="xml"><span class="tag">&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(<span class="template-variable">&#123;</span></div><div class="line">  form: 'test'</div><div class="line">&#125;<span class="xml">)(Form)</span></div></pre></td></tr></table></figure></p>
<h3 id="3-å®Œæˆäº†"><a href="#3-å®Œæˆäº†" class="headerlink" title="3.å®Œæˆäº†"></a>3.å®Œæˆäº†</h3><p>å°±è¿™äº›å†…å®¹,æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ</p>
<h2 id="åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app"><a href="#åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app" class="headerlink" title="åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app"></a>åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app</h2><p>ä½¿ç”¨ç»å¯¹é…·ç‚«çš„Reactæ ·å¼åº“<a href="https://github.com/styled-components/styled-components" target="_blank" rel="external">styled-components</a> .<br>çœ‹çœ‹æºä»£ç <a href="https://github.com/esbenp/react-native-clean-form" target="_blank" rel="external">esbenp/react-native-clean-form</a></p>
<h3 id="ç¬¬ä¸€æ­¥-å®‰è£…react-native-clean-form"><a href="#ç¬¬ä¸€æ­¥-å®‰è£…react-native-clean-form" class="headerlink" title="ç¬¬ä¸€æ­¥:å®‰è£…react-native-clean-form"></a>ç¬¬ä¸€æ­¥:å®‰è£…react-native-clean-form</h3><p>ä½¿ç”¨<code>npm install â€”save react-native-clean-form</code>å®‰è£…formå…ƒç´ .<br>ä¹Ÿéœ€è¦vector icon fonts.<a href="https://github.com/esbenp/react-native-clean-form#installation" target="_blank" rel="external">Readme</a></p>
<h3 id="ç¬¬äºŒæ­¥-è®¾è®¡é…·ç‚«çš„è¡¨å•"><a href="#ç¬¬äºŒæ­¥-è®¾è®¡é…·ç‚«çš„è¡¨å•" class="headerlink" title="ç¬¬äºŒæ­¥:è®¾è®¡é…·ç‚«çš„è¡¨å•"></a>ç¬¬äºŒæ­¥:è®¾è®¡é…·ç‚«çš„è¡¨å•</h3><p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fe9qnc5uf1j30ku0cdaag.jpg" alt=""></p>
<p>çœ‹çœ‹ä»£ç </p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="xml"> import React, </span><span class="template-variable">&#123; Component &#125;</span><span class="xml"> from 'react'</span></div><div class="line">import <span class="template-variable">&#123;</span></div><div class="line">  ActionsContainer,</div><div class="line">  Button,</div><div class="line">  FieldsContainer,</div><div class="line">  Fieldset,</div><div class="line">  Form,</div><div class="line">  FormGroup,</div><div class="line">  Label,</div><div class="line">  Input,</div><div class="line">  <span class="keyword">Select</span>,</div><div class="line">  Switch</div><div class="line">&#125;<span class="xml"> from 'react-native-clean-form'</span></div><div class="line"></div><div class="line">const countryOptions = [</div><div class="line">  <span class="template-variable">&#123;label: 'Denmark', value: 'DK'&#125;</span><span class="xml">,</span></div><div class="line">  <span class="template-variable">&#123;label: 'Germany', value: 'DE'&#125;</span><span class="xml">,</span></div><div class="line">  <span class="template-variable">&#123;label: 'United State', value: 'US'&#125;</span><span class="xml"></span></div><div class="line">]</div><div class="line"></div><div class="line">const FormView = props =&gt; (</div><div class="line">  <span class="tag">&lt;<span class="name">Form</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">FieldsContainer</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Fieldset</span> <span class="attr">label</span>=<span class="string">"Contact details"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"John"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Last name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Doe"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Phone<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"+45 88 88 88 88"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"John"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">Fieldset</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Fieldset</span> <span class="attr">label</span>=<span class="string">"Shipping details"</span> <span class="attr">last</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Address<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Hejrevej 33"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>City<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Copenhagen"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>ZIP Code<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"2400"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Country<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Select</span></span></div><div class="line">              <span class="attr">name</span>=<span class="string">"country"</span></div><div class="line">              <span class="attr">label</span>=<span class="string">"Country"</span></div><div class="line">              <span class="attr">options</span>=<span class="template-variable">&#123;countryOptions&#125;</span><span class="xml"><span class="tag"></span></span></div><div class="line">              <span class="attr">placeholder</span>=<span class="string">"Denmark"</span></div><div class="line">          /&gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span> <span class="attr">border</span>=</span><span class="template-variable">&#123;false&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Save my details<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Switch</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">Fieldset</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">FieldsContainer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ActionsContainer</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">icon</span>=<span class="string">"md-checkmark"</span> <span class="attr">iconPlacement</span>=<span class="string">"right"</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ActionsContainer</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></div><div class="line">)</div><div class="line"></div><div class="line">export default FormView</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æ¯”è¾ƒç†Ÿæ‚‰Twitter Bootstrapä½ å¯ä»¥ä»react-native-clean-formä¸­çœ‹åˆ°ç±»ä¼¼çš„å¥æ³•.å¥½äº†è¾“å…¥<code>Input</code>,<code>Select</code>å’Œ<code>Switch</code>.è¿™é‡Œçš„å…ƒç´ å·²ç»è¢«åŒ…è£…åœ¨<code>FromGroup</code>å’Œ<code>Label</code>.æ­¤å¤–æˆ‘ä»¬ä¹Ÿæ”¯æŒéªŒè¯</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123; reduxForm &#125; <span class="keyword">from</span> <span class="string">'redux-form/immutable'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  ActionsContainer,</div><div class="line">  Button,</div><div class="line">  FieldsContainer,</div><div class="line">  Fieldset,</div><div class="line">  Form</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native-clean-form'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  Input,</div><div class="line">  Select,</div><div class="line">  Switch</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native-clean-form/redux-form-immutable'</span></div><div class="line"><span class="keyword">import</span> &#123; View,Text &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></div><div class="line"></div><div class="line">const onSubmit = <span class="function"><span class="params">(values, dispatch)</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve)</span> =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(values.toJS())</div><div class="line">      resolve()</div><div class="line">    &#125;, <span class="number">1500</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">const countryOptions = [</div><div class="line">  &#123;label: <span class="string">'Denmark'</span>, value: <span class="string">'DK'</span>&#125;,</div><div class="line">  &#123;label: <span class="string">'Germany'</span>, value: <span class="string">'DE'</span>&#125;,</div><div class="line">  &#123;label: <span class="string">'United State'</span>, value: <span class="string">'US'</span>&#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormView</span> <span class="keyword">extends</span> <span class="title">Component</span> &#123;</span></div><div class="line">  render() &#123;</div><div class="line">    const &#123; handleSubmit, submitting &#125; = <span class="keyword">this</span>.props</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Form&gt;</div><div class="line">        &lt;FieldsContainer&gt;</div><div class="line">          &lt;Fieldset label=<span class="string">"Contact details"</span>&gt;</div><div class="line">            &lt;Input name=<span class="string">"first_name"</span> label=<span class="string">"First name"</span> placeholder=<span class="string">"John"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"last_name"</span> label=<span class="string">"Last name"</span> placeholder=<span class="string">"Doe"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"email"</span> label=<span class="string">"Email"</span> placeholder=<span class="string">"something@domain.com"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"telephone"</span> label=<span class="string">"Phone"</span> placeholder=<span class="string">"+45 88 88 88 88"</span> /&gt;</div><div class="line">          &lt;/Fieldset&gt;</div><div class="line">          &lt;Fieldset label=<span class="string">"Shipping details"</span> last&gt;</div><div class="line">            &lt;Input name=<span class="string">"address"</span> label=<span class="string">"Address"</span> placeholder=<span class="string">"Hejrevej 33"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"city"</span> label=<span class="string">"City"</span> placeholder=<span class="string">"Copenhagen"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"zip"</span> label=<span class="string">"ZIP Code"</span> placeholder=<span class="string">"2400"</span> /&gt;</div><div class="line">            &lt;Select</div><div class="line">              name=<span class="string">"country"</span></div><div class="line">              label=<span class="string">"Country"</span></div><div class="line">              options=&#123;countryOptions&#125;</div><div class="line">              placeholder=<span class="string">"Denmark"</span></div><div class="line">            /&gt;</div><div class="line">            &lt;Switch label=<span class="string">"Save my details"</span> border=&#123;<span class="literal">false</span>&#125; name=<span class="string">"save_details"</span> /&gt;</div><div class="line">          &lt;/Fieldset&gt;</div><div class="line">        &lt;/FieldsContainer&gt;</div><div class="line">        &lt;ActionsContainer&gt;</div><div class="line">          &lt;Button icon=<span class="string">"md-checkmark"</span> iconPlacement=<span class="string">"right"</span> onPress=&#123;handleSubmit(onSubmit)&#125; submitting=&#123;submitting&#125;&gt;Save&lt;/Button&gt;</div><div class="line">        &lt;/ActionsContainer&gt;</div><div class="line">      &lt;/Form&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> reduxForm(&#123;</div><div class="line">  form: <span class="string">'Form'</span>,</div><div class="line">  validate: values =&gt; &#123;</div><div class="line">    const errors = &#123;&#125;</div><div class="line"></div><div class="line">    values = values.toJS()</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.first_name) &#123;</div><div class="line">      errors.first_name = <span class="string">'First name is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.last_name) &#123;</div><div class="line">      errors.last_name = <span class="string">'Last name is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.email) &#123;</div><div class="line">      errors.email = <span class="string">'Email is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> errors</div><div class="line">  &#125;</div><div class="line">&#125;)(FormView)</div></pre></td></tr></table></figure>
<p>å¾ˆç®€å•ï¼Œæ˜¯å—ï¼Ÿç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªè¿æ¥åˆ°storeçš„å¥½çœ‹çš„è¡¨å•,è¿˜èƒ½æ”¯æŒæ•°æ®éªŒè¯,å¼‚æ­¥çš„æŒ‰é’®åé¦ˆ.ä½ å¯ä»¥åœ¨<a href="https://github.com/esbenp/react-native-clean-form" target="_blank" rel="external">repositoryæŸ¥çœ‹æ›´å¤šç‰¹æ€§</a>.</p>
<h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨Reactä¸­å¤„ç†è¡¨å•è¿˜ä¸æ€ä¹ˆå¥½å¼„,çœ‹çœ‹è¿™ç¯‡æ–‡ç« è®²çš„æŒºå¥½çš„çœ‹çœ‹,è¯•ç€ç¿»è¯‘ä¸€ä¸‹&lt;br&gt;  &lt;a href=&quot;http://esbenp.github.io/2017/01/06/react-native-redux-form-immutable-st
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="https://phpsmarter.github.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(8)-Views</title>
    <link href="https://phpsmarter.github.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-8-Views/"/>
    <id>https://phpsmarter.github.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-8-Views/</id>
    <published>2017-03-30T14:04:48.000Z</published>
    <updated>2017-03-30T10:31:07.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Views"><a href="#Views" class="headerlink" title="Views"></a>Views</h1><p>Navigation è§†å›¾æ˜¯æ¥å—<code>router</code>å’Œ<code>navigaion</code> çš„propçš„è¡¨å¾ç»„ä»¶,é€šè¿‡<code>navigation.state</code>çš„è®¾å®š,å¯ä»¥æ˜¾ç¤ºå‡ ä¸ªscreens.<br>Navigation viewæ˜¯è¢«æ§åˆ¶çš„Reactç»„ä»¶,è¡¨å¾å½“å‰çš„navigation state.ä»–ä»¬ç®¡ç†screenä¹‹é—´çš„åˆ‡æ¢,åŠ¨ç”»å’Œæ‰‹åŠ¿.ä»–ä»¬ä¹ŸæŒä¹…åŒ–navigation viewä¾‹å¦‚tab barså’Œheaders</p>
<h2 id="å†…å»ºçš„Views"><a href="#å†…å»ºçš„Views" class="headerlink" title="å†…å»ºçš„Views"></a>å†…å»ºçš„Views</h2><ul>
<li><p>CardStack-ä»£è¡¨stackåœ¨ä»»ä½•å¹³å°ä¸Šéƒ½åŒ¹é…</p>
<ul>
<li>ä»£è¡¨ä¸€ä¸ªä»Card stackæ¥çš„card.</li>
<li>Header-card stackçš„header view</li>
</ul>
</li>
<li><p>Tabs-tabåˆ‡æ¢å™¨/é¡µé¢çš„é…ç½®</p>
</li>
<li>Drawer-ä»å·¦ä¾§æ»‘å‡ºçš„Drawerçš„view</li>
</ul>
<h1 id="Transitioner"><a href="#Transitioner" class="headerlink" title="Transitioner"></a>Transitioner</h1><p><code>transitioner</code>æ˜¯ä¸€ä¸ªReact ç»„ä»¶å¸®åŠ©ç®¡ç†å¤æ‚åŠ¨ç”»ç»„ä»¶ä¹‹é—´æ¼”å˜çš„å·¥å…·.å®ƒç®¡ç†åŠ¨ç”»çš„æ—¶é—´è°ƒåº¦,ä¿ç•™å„ç§screençš„è¿›å…¥ç¦»å¼€çš„è®°å½•,ä½†æ˜¯å®ƒä¸çŸ¥é“å…·ä½“çš„äº‹ä»¶æ˜¯ä»€ä¹ˆ,åº”ä¸ºå…·ä½“çš„æ¸²æŸ“è¿‡ç¨‹å§”æ‰˜ç»™äº†å¼€å‘è€….<br>åœ¨å†…éƒ¨,<code>Transitioner</code>è¢«ç”¨æ¥å®æ–½<code>CardStack</code>,å› æ­¤æ˜¯<code>StackNavigator</code>.<br><code>Transiioner</code>æœ€æœ‰ç”¨çš„ç”¨é€”æ˜¯æ¥å—å½“å‰navigationçš„state.å½“routesä»navigation stateç§»é™¤çš„æ—¶å€™,<code>Transitioner</code></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyNavView</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  ...</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Transitioner</span></div><div class="line">        configureTransition=&#123;<span class="keyword">this</span>._configureTransition&#125;</div><div class="line">        navigation=&#123;<span class="keyword">this</span>.props.navigation&#125;</div><div class="line">        render=&#123;<span class="keyword">this</span>._render&#125;</div><div class="line">        onTransitionStart=&#123;<span class="keyword">this</span>.onTransitionStart&#125;</div><div class="line">        onTransitionEnd=&#123;<span class="keyword">this</span>.onTransitionEnd&#125;</div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h2><h3 id="configureTransitionfunction"><a href="#configureTransitionfunction" class="headerlink" title="configureTransitionfunction"></a><code>configureTransition</code>function</h3><p>è¢«<code>Transitioner.componentWillReceiveProps</code>,è¿™ä¸ªå‡½æ•°å…è®¸å®šåˆ¶åŠ¨ç”»çš„å‚æ•°,ä¾‹å¦‚<code>å»¶ç»­æ—¶é—´</code>.è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼å°†ä¼šä¼ é€’è¿›å…¥æ—¶é—´åºåˆ—å‡½æ•°,é»˜è®¤æ˜¯<code>Animated.timing()</code>.</p>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="title">_configureTransition</span>(transitionProps, prevTransitionProps) &#123;</div><div class="line">  return &#123;</div><div class="line">    // duration <span class="keyword">in</span> milliseconds, <span class="keyword">default</span>: 250</div><div class="line">    duration: <span class="number">500</span>,</div><div class="line">    // <span class="type">An</span> easing function from `<span class="type">Easing</span>`, <span class="keyword">default</span>: <span class="type">Easing</span>.inOut(<span class="type">Easing</span>.<span class="title">ease</span>)</div><div class="line">    easing: <span class="type">Easing</span>.bounce,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:<code>duration</code>å’Œ<code>easing</code>åªç”¨å½“æ—¶é—´åºåˆ—å‡½æ•°æ˜¯<code>Animated.timing</code>çš„æ—¶å€™æ‰å¯ä»¥åº”ç”¨.æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„configå‚æ•°æ¥ä½¿ç”¨ä¸åŒçš„æ—¶é—´å‡½æ•°.<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> _configureTransition(transitionProps, prevTransitionProps) &#123;</div><div class="line">  <span class="class">return </span>&#123;</div><div class="line">    <span class="comment">// A timing function, default: Animated.timing.</span></div><div class="line"><span class="symbol">    timing:</span> Animated.spring,</div><div class="line">    <span class="comment">// Some parameters relevant to Animated.spring</span></div><div class="line"><span class="symbol">    friction:</span> <span class="number">1</span>,</div><div class="line"><span class="symbol">    tension:</span> <span class="number">0.5</span>,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Flow-definition"><a href="#Flow-definition" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">configureTransition:</span> (</div><div class="line"><span class="symbol">    transitionProps:</span> NavigationTransitionProps,</div><div class="line"><span class="symbol">    prevTransitionProps:</span> ?NavigationTransitionProps,</div><div class="line">  ) =&gt; NavigationTransitionSpec,</div></pre></td></tr></table></figure>
<h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h3><ul>
<li><code>transitionProps</code>:æœ‰å½“å‰çš„navigation stateå’Œpropsåˆ›å»ºçš„å½“å‰<code>NavigationTransitionProps</code></li>
<li><code>prevTransitionProps</code>:ä»å‰ä¸€ä¸ªnavigation staeå’Œpropsåˆ›å»ºçš„å‰ä¸€ä¸ªNavigationTransitionProps</li>
</ul>
<h3 id="Returns"><a href="#Returns" class="headerlink" title="Returns"></a>Returns</h3><ul>
<li>NavigationTransitionSpecç±»å‹çš„å¯¹è±¡,ä½œä¸ºå‚æ•°ä¼ é€’è¿›åŠ¨ç”»æ—¶é—´åºåˆ—å‡½æ•°</li>
</ul>
<p><code>navigationState</code>å¯¹è±¡<br>ä»£è¡¨navigation stateçš„ç®€å•å¯¹è±¡</p>
<h3 id="å®ä¾‹å€¼"><a href="#å®ä¾‹å€¼" class="headerlink" title="å®ä¾‹å€¼"></a>å®ä¾‹å€¼</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   <span class="comment">// Index refers to the active child route in the routes array.</span></div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>,</div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'DF2FGWGAS-12'</span>, <span class="attribute">routeName</span>: <span class="string">'ContactHome'</span> &#125;,</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'DF2FGWGAS-13'</span>, <span class="attribute">routeName</span>: <span class="string">'ContactDetail'</span>, <span class="attribute">params</span>: &#123; <span class="attribute">personId</span>: <span class="number">123</span> &#125; &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Flow-definition-1"><a href="#Flow-definition-1" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="class"><span class="keyword">type</span> <span class="type">NavigationState</span> = &#123;</span></div><div class="line">  <span class="title">index</span>: <span class="title">number</span>,</div><div class="line">  <span class="title">routes</span>: <span class="type">Array</span>&lt;<span class="type">NavigationRoute</span>&gt;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>äº†è§£æ›´å¤šçš„<code>NavigationRoute</code>çš„ç±»å‹,æŸ¥çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/src/TypeDefinition.js#L32" target="_blank" rel="external">flow definition</a></p>
<h2 id="renderå‡½æ•°"><a href="#renderå‡½æ•°" class="headerlink" title="renderå‡½æ•°"></a><code>render</code>å‡½æ•°</h2><p>ç”±<code>Transition.render()</code>è°ƒç”¨.è¿™ä¸ªå‡½æ•°ä»£ç†äº†<code>Transitioner</code>çš„å®é™…æ¸²æŸ“åŠŸèƒ½.åœ¨è¿™ä¸ªå‡½æ•°ä¸­,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ…å«åœ¨<code>transitionProps</code>å’Œ<code>prevTransitionProps</code>ä¸­çš„å‚æ•°æ¥æ¸²æŸ“scene,åˆ›å»ºåŠ¨ç”»å’Œå¤„ç†æ‰‹åŠ¿æ“ä½œ.</p>
<p><code>transitionProps</code>å’Œ<code>prevTransitionProps</code>æœ‰ä¸€äº›é‡è¦çš„å±æ€§å¯¹äºä¸Šé¢æåˆ°çš„ä¸€äº›ä»»åŠ¡æ˜¯ååˆ†æœ‰ç”¨çš„.</p>
<ul>
<li><code>scenes:Array&lt;NavigationScene&gt;</code>-å¯ä»¥ä½¿ç”¨çš„scenesçš„åˆ—è¡¨</li>
<li><code>position:NavigationAnimation</code>- transitionerçš„navigation  stateçš„è¿›åº¦ç´¢å¼•</li>
<li><code>progress:NavigationAnimationedValue</code>-å½“navigation stateä»ä¸€ä¸ªè½¬å˜åˆ°å¦ä¸€çš„æ—¶å€™,è¿™ä¸ªå€¼ä»£è¡¨äº†æ¼”å˜çš„è¿›åº¦.ä»0-1çš„æ•°å€¼</li>
</ul>
<p>æŸ¥çœ‹å®Œæ•´çš„<code>NavigationTransitionProps</code>çš„å±æ€§åˆ—è¡¨.æŸ¥çœ‹çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/src/TypeDefinition.js#L273" target="_blank" rel="external">flow definition</a></p>
<h3 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p><code>transitionProps.scenes</code>æ˜¯å¯ä»¥ä½¿ç”¨çš„scenesçš„åˆ—è¡¨.è¿™ä¸ªåˆ—è¡¨ä¾èµ–äºå®æ–½è€…å‡†å¤‡æ€ä¹ˆæ¥åˆ—å‡ºscreen.ä¾‹å¦‚,å¯ä»¥åƒä¸‹é¢çš„ä»£ç æ¥æ¸²æŸ“cardsçš„å †æ ˆ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> _render(transitionProps, prevTransitionProps) &#123;</div><div class="line">  <span class="keyword">const</span> scenes = transitionProps.scenes.map(<span class="function"><span class="params">scene</span> =&gt;</span> <span class="keyword">this</span>._renderScene(transitionProps, scene));</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.stack&#125;</span>&gt;</span></span></div><div class="line">      &#123;scenes&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Animated.View</code>å»æ‰§è¡Œæ¼”å˜åŠ¨ç”».ä¸ºäº†åˆ›å»ºå¿…è¦çš„åŠ¨ç”»æ ·å¼å±æ€§,ä¾‹å¦‚<code>é€æ˜åº¦</code>,æˆ‘ä»¬å¯ä»¥åœ¨<code>position</code>å’Œ<code>progress</code>ä¸­åˆ©ç”¨<code>transitionProps</code>æ¥æ’å€¼.</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> _renderScene(transitionProps, <span class="built_in">scene</span>) &#123;</div><div class="line">  const &#123; <span class="built_in">position</span> &#125; = transitionProps;</div><div class="line">  const &#123; index &#125; = <span class="built_in">scene</span>;</div><div class="line">  const <span class="built_in">opacity</span> = <span class="built_in">position</span>.interpolate(&#123;</div><div class="line">    inputRange: [index-<span class="number">1</span>, index, index+<span class="number">1</span>],</div><div class="line">    outputRange: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</div><div class="line">  &#125;);</div><div class="line">  // The prop `router` <span class="built_in">is</span> populated when we call `createNavigator`.</div><div class="line">  const Scene = this.<span class="built_in">props</span>.router.getComponent(<span class="built_in">scene</span>.route.routeName);</div><div class="line">  <span class="built_in">return</span> (</div><div class="line">    &lt;Animated.View <span class="built_in">style</span>=&#123;&#123; <span class="built_in">opacity</span> &#125;&#125;&gt;</div><div class="line">      &#123; Scene &#125;</div><div class="line">    &lt;/Animated.View&gt;</div><div class="line">  )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç åˆ›å»ºäº¤å‰æ¸éšçš„åŠ¨ç”».<br>æ·±å…¥ç†è§£å¦‚ä½•åˆ›å»ºå®šåˆ¶çš„transitions,çœ‹çœ‹è¿™ä¸ª<a href="http://www.reactnativediary.com/2016/12/20/navigation-experimental-custom-transition-1.html" target="_blank" rel="external">åšå®¢å¸–å­</a></p>
<h3 id="Flow-definition-2"><a href="#Flow-definition-2" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">render: <span class="function"><span class="params">(transitionProps: NavigationTransitionProps, prevTransitionProps: ?NavigationTransitionProps)</span> =&gt;</span> React.Element&lt;*&gt;,</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><ul>
<li><code>transitionProps</code>:ä»å½“å‰stateå’Œpropsåˆ›å»ºçš„NavigationTransitionProps.</li>
<li><code>prevTransitionProps</code>:ä»ä¹‹å‰çš„stateå’Œpropsåˆ›å»ºçš„å…ˆå‰<code>NavigationTransitionProps</code></li>
</ul>
<h3 id="Returns-1"><a href="#Returns-1" class="headerlink" title="Returns"></a>Returns</h3><ul>
<li>Reactå…ƒç´ ,ç”¨æ¥æ¸²æŸ“Transitioner ç»„ä»¶</li>
</ul>
<h2 id="onTransitionEndå‡½æ•°"><a href="#onTransitionEndå‡½æ•°" class="headerlink" title="onTransitionEndå‡½æ•°"></a><code>onTransitionEnd</code>å‡½æ•°</h2><p>åŠ¨ç”»æ¼”å˜å®Œæˆåè°ƒç”¨ä¸€æ¬¡.</p>
<h3 id="Flow-definition-3"><a href="#Flow-definition-3" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">onTransitionEnd: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">void</span></div></pre></td></tr></table></figure>
<h3 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><ul>
<li>none<h3 id="Returns-2"><a href="#Returns-2" class="headerlink" title="Returns"></a>Returns</h3></li>
<li>none</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Views&quot;&gt;&lt;a href=&quot;#Views&quot; class=&quot;headerlink&quot; title=&quot;Views&quot;&gt;&lt;/a&gt;Views&lt;/h1&gt;&lt;p&gt;Navigation è§†å›¾æ˜¯æ¥å—&lt;code&gt;router&lt;/code&gt;å’Œ&lt;code&gt;navigaion&lt;/code&gt;
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="https://phpsmarter.github.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(7)-Router</title>
    <link href="https://phpsmarter.github.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-7-Router/"/>
    <id>https://phpsmarter.github.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-7-Router/</id>
    <published>2017-03-30T09:57:00.000Z</published>
    <updated>2017-03-30T06:04:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Routers"><a href="#Routers" class="headerlink" title="Routers"></a>Routers</h1><blockquote>
<p>Routerå®šä¹‰ä¸€ä¸ªç»„ä»¶çš„navigation state,å…è®¸å¼€å‘è€…å®šä¹‰è·¯å¾„å’Œå¯ä»¥æ“ä½œçš„actions.</p>
<h2 id="å†…å»ºçš„Routers"><a href="#å†…å»ºçš„Routers" class="headerlink" title="å†…å»ºçš„Routers"></a>å†…å»ºçš„Routers</h2><ul>
<li>StackRouter</li>
<li>TabRouter</li>
</ul>
</blockquote>
<h2 id="ä½¿ç”¨Routers"><a href="#ä½¿ç”¨Routers" class="headerlink" title="ä½¿ç”¨Routers"></a>ä½¿ç”¨Routers</h2><p>ä¸ºäº†æ‰‹åŠ¨å®šåˆ¶ä¸€ä¸ªnavigator,åœ¨ç»„ä»¶é‡Œå¯ä»¥æ”¾ä¸€ä¸ªé™æ€çš„<code>router</code>.(ä½¿ç”¨å†…å»ºçš„ç»„ä»¶å¿«é€Ÿçš„å®šåˆ¶ä¸€ä¸ªnavigator,ä½¿ç”¨<a href="https://reactnavigation.org/docs/navigators" target="_blank" rel="external">Navigator Factory</a>æ›´å®¹æ˜“å®ç°).</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyNavigator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    static router = <span class="type">StackRouter</span>(routes, config);</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥æŠŠè¿™ä¸ªç»„ä»¶ä½œä¸ºå¦ä¸€ä¸ªnavigatorçš„<code>screen</code>å¯¹å¾…,<code>MyNavigator</code>çš„å¯¼èˆªé€»è¾‘åœ¨<code>StackRouter</code>ä¸­å®šä¹‰.</p>
<h2 id="å®šåˆ¶åŒ–Router"><a href="#å®šåˆ¶åŒ–Router" class="headerlink" title="å®šåˆ¶åŒ–Router"></a>å®šåˆ¶åŒ–Router</h2><p>çœ‹çœ‹<code>[å®šåˆ¶Router API éƒ¨åˆ†](https://reactnavigation.org/docs/routers/api)</code>å­¦ä¹ <code>StackRouter</code>å’Œ<code>TabRouter</code>çš„API.<br>åªè¦ä½ æ„¿æ„ä¹Ÿå¯ä»¥é‡å†™routerçš„å‡½æ•°.</p>
<h2 id="å®šåˆ¶Navigationçš„Actions"><a href="#å®šåˆ¶Navigationçš„Actions" class="headerlink" title="å®šåˆ¶Navigationçš„Actions"></a>å®šåˆ¶Navigationçš„Actions</h2><p>ä¸ºäº†é‡å†™navigationçš„è¡Œä¸º,ä½ å¯ä»¥åœ¨<code>getStateForAction</code>ä¸­é‡å†™navigation stateçš„é€»è¾‘,ä»è€Œæ‰‹åŠ¨å¤„ç†<code>routes</code>å’Œ<code>index</code>.</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"> const MyApp = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: 'Home',</div><div class="line">&#125;)</div><div class="line">MyApp.router = &#123;</div><div class="line">  ...MyApp.router,</div><div class="line">  getStateForAction(action, <span class="keyword">state</span>) &#123;</div><div class="line">    if (<span class="keyword">state</span> &amp;&amp; action.type === 'PushTwoProfiles') &#123;</div><div class="line">      const routes = [</div><div class="line">        ...<span class="keyword">state</span>.routes,</div><div class="line">        &#123;key: 'A', routeName: 'Profile', params: &#123; name: action.name1 &#125;&#125;,</div><div class="line">        &#123;key: 'B', routeName: 'Profile', params: &#123; name: action.name2 &#125;&#125;,</div><div class="line">      ];</div><div class="line">      return &#123;</div><div class="line">        ...<span class="keyword">state</span>,</div><div class="line">        routes,</div><div class="line">        index: routes.length - <span class="number">1</span>,</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">    return MyApp.router.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="é˜»æ­¢æŸäº›Navigationçš„Actions"><a href="#é˜»æ­¢æŸäº›Navigationçš„Actions" class="headerlink" title="é˜»æ­¢æŸäº›Navigationçš„Actions"></a>é˜»æ­¢æŸäº›Navigationçš„Actions</h2><p>æœ‰æ—¶å€™æ ¹æ®ä½ çš„route,éœ€è¦é˜»æ­¢æŸäº›navigationçš„æ´»åŠ¨</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"> const MyStackRouter = StackRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: 'Home',</div><div class="line">&#125;)</div><div class="line">const MyAppRouter = &#123;</div><div class="line">  ...MyStackRouter,</div><div class="line">  getStateForAction(action, <span class="keyword">state</span>) &#123;</div><div class="line">    if (</div><div class="line">      <span class="keyword">state</span> &amp;&amp;</div><div class="line">      action.type === NavigationActions.BACK &amp;&amp;</div><div class="line">      <span class="keyword">state</span>.routes[<span class="keyword">state</span>.index].params.isEditing</div><div class="line">    ) &#123;</div><div class="line">      // Returning null <span class="keyword">from</span> getStateForAction means that the action</div><div class="line">      // has been handled/blocked, but there is not a new <span class="keyword">state</span></div><div class="line">      return null;</div><div class="line">    &#125;</div><div class="line">    return MyStackRouter.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="æ“ä½œå®šåˆ¶URIs"><a href="#æ“ä½œå®šåˆ¶URIs" class="headerlink" title="æ“ä½œå®šåˆ¶URIs"></a>æ“ä½œå®šåˆ¶URIs</h2><p>æˆ–è®¸ä½ çš„appæœ‰ä¸€ä¸ªç‹¬ç‰¹çš„URI,å†…å»ºçš„routerså¤„ç†ä¸äº†.ä½ å¯ä»¥é€šè¿‡<code>getActionForPathAndParams</code>æ¥æ‰©å±•router.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"> import &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> MyApp = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div><div class="line"><span class="keyword">const</span> previousGetActionForPathAndParams = MyApp.router.getActionForPathAndParams</div><div class="line">Object.assign(MyApp.router, &#123;</div><div class="line">  getActionForPathAndParams(path, <span class="keyword">params</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (</div><div class="line">      path === <span class="string">'my/custom/path'</span> &amp;&amp;</div><div class="line">      <span class="keyword">params</span>.magic === <span class="string">'yes'</span></div><div class="line">    ) &#123;</div><div class="line">      <span class="comment">// returns a profile navigate action for /my/custom/path?magic=yes</span></div><div class="line">      <span class="keyword">return</span> NavigationActions.navigate(&#123;</div><div class="line">        routeName: <span class="string">'Profile'</span>,</div><div class="line">        action: NavigationActions.navigate(&#123;</div><div class="line">          <span class="comment">// This child action will get passed to the child router</span></div><div class="line">          <span class="comment">// ProfileScreen.router.getStateForAction to get the child</span></div><div class="line">          <span class="comment">// navigation state.</span></div><div class="line">          routeName: <span class="string">'Friends'</span>,</div><div class="line">        &#125;),</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> previousGetActionForPathAndParams(path, <span class="keyword">params</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="å®šåˆ¶Router-API"><a href="#å®šåˆ¶Router-API" class="headerlink" title="å®šåˆ¶Router API"></a>å®šåˆ¶Router API</h2><p>ä½ å¯ä»¥ç«¥å·¥ä¸‹é¢çš„å‡½æ•°æ¥æ„å»ºè‡ªå·±çš„routerå¯¹è±¡,</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> const MyRouter = &#123;</div><div class="line">  getStateForAction: <span class="function"><span class="params">(action, state)</span> =&gt;</span> (&#123;&#125;),</div><div class="line">  getActionForPathAndParams: <span class="function"><span class="params">(path, params)</span> =&gt;</span> <span class="literal">null</span>,</div><div class="line">  getPathAndParamsForState: <span class="function"><span class="params">(state)</span> =&gt;</span> <span class="literal">null</span>,</div><div class="line">  getComponentForState: <span class="function"><span class="params">(state)</span> =&gt;</span> MyScreen,</div><div class="line">  getComponentForRouteName: <span class="function"><span class="params">(routeName)</span> =&gt;</span> MyScreen,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="regexp">//</span> Now, you can make a navigator <span class="keyword">by</span> putting the router <span class="literal">on</span> it:</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNavigator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> &#123;</span></div><div class="line">  static router = MyRouter;</div><div class="line">  render() &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe4np8ce9xj313l0v9jss.jpg" alt=""></p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getStateForAction(action,<span class="keyword">state</span>)</div></pre></td></tr></table></figure>
<p> æ ¹æ®ç»™å®šçš„actionæ¥å®šä¹‰è¿”å›çš„navigation sate.å½“ä¸€ä¸ªactioné€šè¿‡<code>props.navigation.dispatch()</code>ä¼ é€’,æˆ–è€…ä»»ä½•å…¶ä»–çš„åŠ©æ‰‹å‡½æ•°è¢«è°ƒç”¨,ä¾‹å¦‚<code>navigation.navitate()</code>çš„æ—¶å€™,è¿™ä¸ªå‡½æ•°å°†ä¼šè¿è¡Œ.</p>
<p> é€šå¸¸è¿™ä¸ªå‡½æ•°å°†ä¼šä»¥ä¸‹é¢çš„å½¢å¼è¿”å›navitaion state.</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>, <span class="comment">// identifies which route in the routes array is active</span></div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="comment">// Each route needs a name to identify the type.</span></div><div class="line">      <span class="attribute">routeName</span>: <span class="string">'MyRouteName'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// A unique identifier for this route in the routes array:</span></div><div class="line">      <span class="attribute">key</span>: <span class="string">'myroute-123'</span>,</div><div class="line">      <span class="comment">// (used to specify the re-ordering of routes)</span></div><div class="line"></div><div class="line">      <span class="comment">// Routes can have any data, as long as key and routeName are correct</span></div><div class="line">      ...randomRouteData,</div><div class="line">    &#125;,</div><div class="line">    ..<span class="selector-class">.moreRoutes</span>,</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœrouterå·²ç»åœ¨å¤–éƒ¨å¤„ç†äº†acion,æˆ–è€…æƒ³ä¸æ”¹å˜ä»»ä½•çš„navigation stateå°±æ¶ˆåŒ–å®ƒ,è¿™ä¸ªå‡½æ•°å°±è¿”å›<code>null</code>.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">getComponentForRouterName</span><span class="params">(routeName)</span></span></div></pre></td></tr></table></figure>
<p>ä¸ºç»™å®šçš„route nameè¿”å›å­ç»„ä»¶æˆ–è€…navigator.<br>åƒè¿™æ ·å£°æ˜ä¸€ä¸ªrouter<code>getStateForAction</code>è¾“å‡ºçš„state.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>,</div><div class="line">  routes: [</div><div class="line">    &#123; key: <span class="string">'A'</span>, routeName: <span class="string">'Foo'</span> &#125;,</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'B'</span>, routeName: <span class="string">'Bar'</span> &#125;,</div><div class="line">  ],</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŸºäºstateä¸­çš„é¢routeName,routerå°†ä¼šè°ƒç”¨<code>router.getComponentForRouteName(&#39;Foo&#39;)</code>æˆ–<code>router.getComponentForRouteName(&#39;Bar&#39;)</code>æ¥è¿”å›å¯¹åº”çš„æœ‰æ•ˆç»„ä»¶.</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getComponentForState(<span class="keyword">state</span>)</div></pre></td></tr></table></figure>
<p>ä»æ·±åº¦åµŒå¥—navigation stateè¿”å›æ¿€æ´»çš„ç»„ä»¶</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getActionForPathAndParams</span></div></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªå¯é€‰é…ç½®çš„navigation action,åœ¨ç”¨æˆ·å¯¼èˆªåˆ°è¿™ä¸ªè·¯å¾„å¹¶ä¸”æœ‰å¯é€‰çš„æŸ¥è¯¢å‚æ•°çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªaction.</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getPathAndParamsForState</span></div></pre></td></tr></table></figure>
<p>ç”¨æˆ·åœ¨appä¸­è¿”å›åŒä¸€ä¸ªURLé“¾æ¥çš„ç‚¹æ—¶,è¿™ä¸ªå‡½æ•°è¿”å›è·¯å¾„å’Œå‚æ•°.<br>ä»è¿™ä¸ªå‡½æ•°è¿”å›çš„è·¯å¾„å’Œå‚æ•°åº”è¯¥æ˜¯ä»ä¸€ä¸ªactionè·å¾—çš„,è¿™ä¸ªactionæ˜¯é‡ä¼ è¿›å…¥routerçš„<code>getActionForPathAndParams</code>çš„.è¿™ä¸ªactionä¸€æ—¦é€šè¿‡<code>getStateForAction</code>ä¼ é€’,ä¼šç»™ä½ è¿”å›å½¢ä¼¼çš„state.</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getScreenConfig</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°ä»ä¸€ä¸ªrouteè·å–navigationçš„å¯é€‰é¡¹.å¿…é¡»è¦æä¾›screençš„å½“å‰navigation propå’Œè¢«è¿”å›çš„é€‰é¡¹çš„åå­—.</p>
<ul>
<li><code>navigation</code>-è¿™æ˜¯screenå°†ä¼šä½¿ç”¨çš„navigation prop,å¯¹åº”åœ¨screençš„routeå’Œstate.Dispatchå°†ä¼šæ ¹æ®screençš„ä¸Šä¸‹æ–‡æ¥è§¦å‘actions.</li>
<li><code>optionName</code>-è¢«è·å–çš„é€‰é¡¹çš„åå­—,ä¾‹å¦‚â€™titleâ€™</li>
</ul>
<p>åœ¨å®ä¾‹çš„è§†å›¾å†…,æˆ–è®¸ä½ éœ€è¦è¿œç¨‹è·å–é…ç½®çš„æ ‡é¢˜</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> // First, prepare a navigation prop <span class="keyword">for</span> your child, or re-use one if already available.</div><div class="line">const childNavigation = addNavigationHelpers(&#123;</div><div class="line">  // In this case we use navigation.<span class="keyword">state</span>.index because we want the title <span class="keyword">for</span> the active route.</div><div class="line">  <span class="keyword">state</span>: navigation.<span class="keyword">state</span>.routes[navigation.<span class="keyword">state</span>.index],</div><div class="line">  dispatch: navigation.dispatch,</div><div class="line">&#125;)</div><div class="line">const screenTitle = this.props.router.getScreenConfig(childNavigation, 'title');</div></pre></td></tr></table></figure>
<h1 id="StackRouter"><a href="#StackRouter" class="headerlink" title="StackRouter"></a>StackRouter</h1><p>ç®¡ç†navigationå †æ ˆçš„é€»è¾‘,åŒ…æ‹¬å…¥æ ˆ,å‡ºæ ˆ,æ“ä½œè·¯å¾„è§£æåˆ›å»ºæ·±å±‚æ¬¡çš„å †æ ˆ.</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ç®€å•çš„stack router<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> const MyApp = StackRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="RouteConfig"><a href="#RouteConfig" class="headerlink" title="RouteConfig"></a>RouteConfig</h2><p>æœ€ç®€å•çš„stack routeræœŸå¾…çš„å‚æ•°æ˜¯ä¸€ä¸ªconfigå¯¹è±¡,è¿™é‡Œæ˜¯ç¤ºä¾‹é…ç½®<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = StackRouter(&#123; <span class="comment">// This is the RouteConfig:</span></div><div class="line">  Home: &#123;</div><div class="line">    <span class="attr">screen</span>: HomeScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">''</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">Profile</span>: &#123;</div><div class="line">    <span class="attr">screen</span>: ProfileScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">'profile/:name'</span>,</div><div class="line">  &#125;,</div><div class="line">  Settings &#123;</div><div class="line">    <span class="comment">// This can be handy to lazily require a screen:</span></div><div class="line">    getScreen: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">require</span>(<span class="string">'Settings'</span>).default,</div><div class="line">    <span class="comment">// Note: Child navigators cannot be configured using getScreen because</span></div><div class="line">    <span class="comment">// the router will not be accessible. Navigators must be configured</span></div><div class="line">    <span class="comment">// using `screen: MyNavigator`</span></div><div class="line">    path: <span class="string">'settings'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ¯ä¸€ä¸ªåœ¨configä¸­çš„æ¡ç›®æœ‰å¦‚ä¸‹å†…å®¹</p>
<ul>
<li><code>path</code>-è®¾å®šæ¡ç›®çš„è·¯å¾„å’Œå‚æ•°å¯ä»¥åœ¨stackä¸­è¢«è§£æ</li>
<li><code>screen</code>-è®¾å®šscreenç»„ä»¶æˆ–è€…å­navigator</li>
<li><code>getScreen</code>-ä¸ºscreenç»„ä»¶è®¾å®šæƒ°æ€§åŠ è½½çš„è®¾å®š</li>
</ul>
<h2 id="StackConfig"><a href="#StackConfig" class="headerlink" title="StackConfig"></a>StackConfig</h2><p>é…ç½®çš„é€‰é¡¹ä¹Ÿè¢«ä¼ é€’è¿›å…¥stack router.</p>
<ul>
<li><code>initalRouteName</code>-stacké¦–æ¬¡åŠ è½½çš„é»˜è®¤è·¯ç”±çš„routeName</li>
<li><code>initialRouteParams</code>-åˆå§‹åŒ–routeçš„é»˜è®¤å‚æ•°</li>
<li><code>paths</code>-æä¾›routeNameåˆ°pathé…ç½®çš„æ˜ å°„,å°†ä¼šé‡å†™routeConfigsé‡Œçš„pathè®¾ç½®</li>
</ul>
<h2 id="Supported-Actions"><a href="#Supported-Actions" class="headerlink" title="Supported Actions"></a>Supported Actions</h2><p>stack routerå¯ä»¥å¯¹ä¸‹é¢çš„å¯¼èˆªactionsä½œä¸ºå“åº”.å¦‚æœæœ‰å¯èƒ½,routerå°†ä¼šä»£ç†åˆ°å­ä»£routerçš„actionæ“ä½œ.</p>
<ul>
<li>Navigate-å¦‚æœrouteNameå’Œrouterçš„routerConfigså…¶ä¸­ä¹‹ä¸€åŒ¹é…,å°†ä¼špushä¸€ä¸ªæ–°çš„routeåˆ°å †æ ˆ.</li>
<li>Back-è¿”å›(props)</li>
<li>Reset-æ¸…é™¤å †æ ˆ,æä¾›ä¸€ä¸ªæ–°çš„actionsåˆ›å»ºæ–°çš„navigation state</li>
<li>SetParams-screen dispatchä¸€ä¸ªactionå»æ”¹å˜å½“å‰routeçš„å‚æ•°</li>
</ul>
<h1 id="TabRouter"><a href="#TabRouter" class="headerlink" title="TabRouter"></a>TabRouter</h1><p>ç®¡ç†åº”ç”¨ä¸­çš„ä¸€å¥—tabs,å¤„ç†tabsä¹‹é—´çš„è·³è½¬,å¤„ç†backé”®çš„æ“ä½œè¿”å›åˆ°åˆå§‹åŒ–çš„tab.<br>çœ‹çœ‹ç®€å•çš„tabs router<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> const MyApp = TabRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Settings: &#123; screen: SettingsScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="RouteConfig-1"><a href="#RouteConfig-1" class="headerlink" title="RouteConfig"></a>RouteConfig</h2><p>tabs routeræœ‰ä¸ºæ¯ä¸€ä¸ªtabçš„routeConfig<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = TabRouter(&#123; <span class="comment">// This is the RouteConfig:</span></div><div class="line">  Home: &#123;</div><div class="line">    <span class="attr">screen</span>: HomeScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">'main'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">Settings</span>: &#123;</div><div class="line">    <span class="comment">// This can be handy to lazily require a tab:</span></div><div class="line">    getScreen: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">require</span>(<span class="string">'./SettingsScreen'</span>).default,</div><div class="line">    <span class="comment">// Note: Child navigators cannot be configured using getScreen because</span></div><div class="line">    <span class="comment">// the router will not be accessible. Navigators must be configured</span></div><div class="line">    <span class="comment">// using `screen: MyNavigator`</span></div><div class="line">    path: <span class="string">'settings'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>configä¸­çš„æ¯ä¸€ä¸ªconfigå¯èƒ½æœ‰</p>
<ul>
<li><code>config</code>-æ¯ä¸€ä¸ªtabçš„path</li>
<li><code>screen</code>-å®šåˆ¶screenç»„ä»¶æˆ–è€…å­ä»£navigator</li>
<li><code>getScreen</code>-ä¸ºä¸€ä¸ªscreenç»„ä»¶è®¾å®šæƒ°æ€§åŠ è½½çš„è®¾ç½®(navigatoræ²¡æœ‰è¿™æ ·çš„é…ç½®)</li>
</ul>
<h2 id="Tab-Router-Config"><a href="#Tab-Router-Config" class="headerlink" title="Tab Router Config"></a>Tab Router Config</h2><p>è¢«ä¼ é€’åˆ°routerçš„å¯é…ç½®é€‰é¡¹</p>
<ul>
<li><code>initialRouteName</code>-é¦–æ¬¡åŠ è½½çš„tabçš„routeName</li>
<li><code>order</code>-tabsçš„é¡ºåº</li>
<li><code>path</code>-æä¾›routeNameåˆ°path configçš„æ˜ å°„,æ˜ å°„é‡å†™routeConfigä¸­çš„pathè®¾å®š</li>
<li><code>backBehavior</code>-ç‚¹å‡»backæŒ‰é’®åº”è¯¥è¿”å›åˆ°åˆå§‹åŒ–çš„tabå—ï¼Ÿå¦‚æœæ˜¯çš„è¯,è®¾ç½®<code>initialRoute</code>,å¦åˆ™å°±æ˜¯<code>none</code>,é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.</li>
</ul>
<h2 id="Support-Actions"><a href="#Support-Actions" class="headerlink" title="Support Actions"></a>Support Actions</h2><p>tabs routerä¼šå¯¹ä¸‹é¢çš„navigation actionsåšå‡ºå“åº”.å¦‚æœæœ‰å¯èƒ½,routerå°†ä»£ç†åˆ°å­ä»£routerçš„action.</p>
<ul>
<li>Navigate-å¦‚æœå’Œtabçš„routeNameåŒ¹é…,å°±ä¼šè·³è½¬åˆ°å¯¹åº”çš„tab</li>
<li>Back-å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªé»˜è®¤çš„tab,å°±è·³è½¬åˆ°ç¬¬ä¸€ä¸ªtab</li>
<li>SetParams-screen dispatchä¸€ä¸ªActionæ¥æ”¹å˜å½“å‰routeçš„state</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Routers&quot;&gt;&lt;a href=&quot;#Routers&quot; class=&quot;headerlink&quot; title=&quot;Routers&quot;&gt;&lt;/a&gt;Routers&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Routerå®šä¹‰ä¸€ä¸ªç»„ä»¶çš„navigation state,å…è®¸å¼€å‘è€…å®šä¹‰
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="https://phpsmarter.github.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(6)-Reduxçš„æ•´åˆå®ä¾‹</title>
    <link href="https://phpsmarter.github.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-6-Redux%E7%9A%84%E6%95%B4%E5%90%88%E5%AE%9E%E4%BE%8B/"/>
    <id>https://phpsmarter.github.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-6-Reduxçš„æ•´åˆå®ä¾‹/</id>
    <published>2017-03-29T23:42:14.000Z</published>
    <updated>2017-03-29T16:30:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†"><a href="#æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†" class="headerlink" title="æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹,githubçš„ä¾‹å­,ä»£ç å°±æ¯”è¾ƒå…¨äº†."></a>æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹,<a href="https://github.com/react-community/react-navigation/blob/master/examples/ReduxExample/index.js" target="_blank" rel="external">githubçš„ä¾‹å­</a>,ä»£ç å°±æ¯”è¾ƒå…¨äº†.</h1><p>å¯¹Reduxçš„æ¦‚å¿µç†è§£äº†è¿™ä¸ªçœ‹èµ·æ¥å°±ç®€å•ä¸€ç‚¹.å¦‚æœå¯¹äºReduxçš„æ¦‚å¿µä¸ç†è§£,å¯ä»¥çœ‹æˆ‘çš„å‡ ç¯‡ç¿»è¯‘æ–‡ç« å’Œå‰é¢å†™çš„Reduxçš„ç†è§£æ–‡ç« .<br>ç®€ä¹¦æ²¡æœ‰ç›®å½•å¯¼èˆª,ä¸æ˜¯å¤ªå¥½çœ‹.å¯ä»¥çœ‹çœ‹æˆ‘çš„<a href="https://phpsmarter.github.io" target="_blank" rel="external">åšå®¢</a>ï¼Œé‡Œé¢æœ‰ç›®å½•ç»“æ„.<br>æˆ‘ç†è§£å…¶ä¸­çš„æµç¨‹å°±æ˜¯,</p>
<ol>
<li>Reactç»„ä»¶æ¥å—propsï¼Œè·å–stateå’Œdispatch.</li>
<li>ç»„ä»¶dispatch actionæ”¹å˜navigationçš„state.<br>3.æ ¹æ®stateçš„ç›¸åº”å˜åŒ–åŠ è½½å¯¹åº”çš„screen.<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @flow</div><div class="line"> */</div><div class="line"></div><div class="line">import React <span class="keyword">from</span> 'react';</div><div class="line">import &#123;</div><div class="line">  AppRegistry,</div><div class="line">  AsyncStorage,</div><div class="line">  Button,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> 'react-native';</div><div class="line">import &#123;</div><div class="line">  NavigationActions,</div><div class="line">  addNavigationHelpers,</div><div class="line">  StackNavigator,</div><div class="line">&#125; <span class="keyword">from</span> 'react-navigation';</div><div class="line">import &#123;</div><div class="line">  Provider,</div><div class="line">  connect,//redux,connectå‡½æ•°,è´Ÿè´£å‘å±•ç¤ºç»„ä»¶æ³¨å…¥<span class="keyword">state</span>å’Œdispatch</div><div class="line">&#125; <span class="keyword">from</span> 'react-redux';</div><div class="line">import &#123;</div><div class="line">  createStore,</div><div class="line">  combineReducers,</div><div class="line">&#125; <span class="keyword">from</span> 'redux';</div><div class="line">import &#123;</div><div class="line">  persistStore,</div><div class="line">  autoRehydrate,</div><div class="line">&#125; <span class="keyword">from</span> 'redux-persist';//redux <span class="keyword">state</span>æŒä¹…åŒ–çš„ä¸­é—´ä»¶</div><div class="line"></div><div class="line">const ProfileScreen = (&#123; navigation &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">      Profile Screen</div><div class="line">    &lt;/Text&gt;</div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">ProfileScreen.navigationOptions = &#123;</div><div class="line">  title: 'Profile',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const LoginScreen = (&#123; navigation &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">      Screen A</div><div class="line">    &lt;/Text&gt;</div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.instructions&#125;&gt;</span></div><div class="line">      This is great</div><div class="line">    &lt;/Text&gt;</div><div class="line">    <span class="variable">&lt;Button</span></div><div class="line">      onPress=&#123;() =&gt; navigation.dispatch(&#123; type: 'Login' &#125;)&#125;</div><div class="line">      title=<span class="string">"Log in"</span></div><div class="line">    /&gt;</div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">LoginScreen.navigationOptions = &#123;</div><div class="line">  title: 'Log In',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">//connect æ³¨å…¥<span class="keyword">state</span>å’Œdispatch</div><div class="line">const LoginStatusMessage = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  isLoggedIn: <span class="keyword">state</span>.auth.isLoggedIn,</div><div class="line">&#125;))((&#123; isLoggedIn, dispatch &#125;) =&gt; &#123;</div><div class="line">  if (!isLoggedIn) &#123;</div><div class="line">    return <span class="variable">&lt;Text&gt;</span>Please <span class="keyword">log</span> in&lt;/Text&gt;;</div><div class="line">  &#125;</div><div class="line">  return (</div><div class="line">    <span class="variable">&lt;View&gt;</span></div><div class="line">      <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">        &#123;'You are <span class="string">"logged in"</span> right now'&#125;</div><div class="line">      &lt;/Text&gt;</div><div class="line">      <span class="variable">&lt;Button</span></div><div class="line">        onPress=&#123;() =&gt; dispatch(NavigationActions.navigate(&#123; routeName: 'Profile' &#125;))&#125;</div><div class="line">        title=<span class="string">"Profile"</span></div><div class="line">      /&gt;</div><div class="line">    &lt;/View&gt;</div><div class="line">  );</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const AuthButton = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  isLoggedIn: <span class="keyword">state</span>.auth.isLoggedIn,</div><div class="line">&#125;), dispatch =&gt; (&#123;</div><div class="line">  logout: () =&gt; dispatch(&#123; type: 'Logout' &#125;),</div><div class="line">  login: () =&gt; dispatch(NavigationActions.navigate(&#123; routeName: 'Login' &#125;)),</div><div class="line">&#125;))((&#123; logout, login, isLoggedIn &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;Button</span></div><div class="line">    title=&#123;isLoggedIn ? 'Log Out' : 'Log In'&#125;</div><div class="line">    onPress=&#123;isLoggedIn ? logout : login&#125;</div><div class="line">  /&gt;</div><div class="line">));</div><div class="line"></div><div class="line">const MainScreen = () =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;LoginStatusMessage /&gt;</span></div><div class="line">    <span class="variable">&lt;AuthButton /&gt;</span></div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">MainScreen.navigationOptions = &#123;</div><div class="line">  title: 'Home Screen',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const AppNavigator = StackNavigator(&#123;</div><div class="line">  Login: &#123; screen: LoginScreen &#125;,</div><div class="line">  Main: &#123; screen: MainScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const AppWithNavigationState = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  nav: <span class="keyword">state</span>.nav,</div><div class="line">&#125;))((&#123; dispatch, nav &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;AppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch, state: nav &#125;)&#125; /&gt;</span></div><div class="line">));</div><div class="line"></div><div class="line">const initialNavState = &#123;</div><div class="line">  index: <span class="number">1</span>,</div><div class="line">  routes: [</div><div class="line">    &#123; key: 'InitA', routeName: 'Main' &#125;,</div><div class="line">    &#123; key: 'InitB', routeName: 'Login' &#125;,</div><div class="line">  ],</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const initialAuthState = &#123; isLoggedIn: false &#125;;</div><div class="line"></div><div class="line">const AppReducer = combineReducers(&#123;</div><div class="line">  nav: (<span class="keyword">state</span> = initialNavState, action) =&gt; &#123;</div><div class="line">    if (action.type === 'Login') &#123;</div><div class="line">      return AppNavigator.router.getStateForAction(NavigationActions.back(), <span class="keyword">state</span>);</div><div class="line">    &#125;</div><div class="line">    if (action.type === 'Logout') &#123;</div><div class="line">      return AppNavigator.router.getStateForAction(NavigationActions.navigate(&#123; routeName: 'Login' &#125;), <span class="keyword">state</span>);</div><div class="line">    &#125;</div><div class="line">    return AppNavigator.router.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">  auth: (<span class="keyword">state</span> = initialAuthState, action) =&gt; &#123;</div><div class="line">    if (action.type === 'Login') &#123;</div><div class="line">      return &#123; ...<span class="keyword">state</span>, isLoggedIn: true &#125;;</div><div class="line">    &#125;</div><div class="line">    if (action.type === 'Logout') &#123;</div><div class="line">      return &#123; ...<span class="keyword">state</span>, isLoggedIn: false &#125;;</div><div class="line">    &#125;</div><div class="line">    return <span class="keyword">state</span>;</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">class ReduxExampleApp extends React.Component &#123;</div><div class="line">  store = createStore(AppReducer, undefined, autoRehydrate());</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    persistStore(this.store, &#123; storage: AsyncStorage &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    return (</div><div class="line">      <span class="variable">&lt;Provider store=&#123;this.store&#125;&gt;</span></div><div class="line">        <span class="variable">&lt;AppWithNavigationState /&gt;</span></div><div class="line">      &lt;/Provider&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: <span class="number">1</span>,</div><div class="line">    justifyContent: 'center',</div><div class="line">    alignItems: 'center',</div><div class="line">    backgroundColor: '<span class="comment">#F5FCFF',</span></div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: <span class="number">20</span>,</div><div class="line">    textAlign: 'center',</div><div class="line">    margin: <span class="number">10</span>,</div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: 'center',</div><div class="line">    color: '<span class="comment">#333333',</span></div><div class="line">    marginBottom: <span class="number">5</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">AppRegistry.registerComponent('ReduxExample', () =&gt; ReduxExampleApp);</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†&quot;&gt;&lt;a href=&quot;#æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†&quot; class=&quot;hea
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="https://phpsmarter.github.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(5)-é«˜çº§æŒ‡å—</title>
    <link href="https://phpsmarter.github.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-5-%E9%AB%98%E7%BA%A7%E6%8C%87%E5%8D%97/"/>
    <id>https://phpsmarter.github.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-5-é«˜çº§æŒ‡å—/</id>
    <published>2017-03-29T16:41:19.000Z</published>
    <updated>2017-03-29T15:56:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redux-Intergration"><a href="#Redux-Intergration" class="headerlink" title="Redux Intergration"></a>Redux Intergration</h1><p>ä¸ºäº†åœ¨reduxä¸­å¤„ç†appçš„navigation state,ä½ å¯ä»¥ä¼ é€’ä½ è‡ªå·±çš„<code>navigation</code> propåˆ°ä¸€ä¸ªnavigator.ä½ çš„navigation propå¿…é¡»æä¾›å½“å‰çš„state,è¿˜æœ‰å°±æ˜¯å¤„ç†navigationé…ç½®é¡¹çš„dispatcher.</p>
<p>ä½¿ç”¨redux,ä½ çš„app stateç”±reduceræ¥å®šä¹‰.æ¯ä¸€ä¸ªnavigation routeréƒ½æœ‰ä¸€ä¸ªreducer,å«åš<code>getStateForAction</code>.ä¸‹é¢æ˜¯ä¸€åœ¨reduxåº”ç”¨ä¸­ä½¿ç”¨navigatorsçš„ç®€å•å®ä¾‹:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; addNavigationHelpers &#125; from <span class="symbol">'react</span>-navigation';</div><div class="line"></div><div class="line">const <span class="type">AppNavigator</span> = <span class="type">StackNavigator</span>(<span class="type">AppRouteConfigs</span>);</div><div class="line"></div><div class="line">const navReducer = (state, action) =&gt; &#123;</div><div class="line">  const newState = <span class="type">AppNavigator</span>.router.getStateForAction(action, state);</div><div class="line">  <span class="keyword">return</span> newState || state;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const appReducer = combineReducers(&#123;</div><div class="line">  nav: navReducer,</div><div class="line">  ...</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="meta">@connect</span>(state =&gt; (&#123;</div><div class="line">  nav: state.nav,</div><div class="line">&#125;))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppWithNavigationState</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">AppNavigator</span> navigation=&#123;addNavigationHelpers(&#123;</div><div class="line">        dispatch: <span class="keyword">this</span>.props.dispatch,</div><div class="line">        state: <span class="keyword">this</span>.props.nav,</div><div class="line">      &#125;)&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const store = createStore(appReducer);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Provider</span> store=&#123;store&#125;&gt;</div><div class="line">        &lt;<span class="type">AppWithNavigationState</span> /&gt;</div><div class="line">      &lt;/<span class="type">Provider</span>&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€æ—¦æŒ‰ç…§å®ä¾‹æ“ä½œ,navigation stateå°±å­˜å‚¨åœ¨reduxçš„storeä¸­,è¿™æ ·å°±å¯ä»¥ä½¿ç”¨reduxçš„dispatchå‡½æ•°æ¥å‘èµ·navigationçš„actions.</p>
<p>ç‰¢è®°åœ¨å¿ƒ,å½“ä¸€ä¸ªnavigatorç»™å®šä¸€ä¸ª<code>navigation</code>prop,ä»–å°†å¤±å»å†…éƒ¨stateçš„æ§åˆ¶æƒ.è¿™æ„å‘³ç€ç°åœ¨ä½ æ¥è´Ÿè´£stateçš„æŒä¹…åŒ–,å¤„ç†ä»»ä½•çš„æ·±åº¦é“¾æ¥,æ•´åˆBackæŒ‰é’®ç­‰æ“ä½œ.</p>
<p>å½“ä½ çš„navigatoræ˜¯å·¢å¼çš„æ—¶å€™,Navigation stateè‡ªåŠ¨ä»ä¸€ä¸ªnavigatorä¼ é€’åˆ°å¦ä¸€ä¸ªnavigator.æ³¨æ„,ä¸ºäº†è®©å­ä»£navigatorå¯ä»¥ä»çˆ¶ä»£navigatoræ¥æ”¶state,å®ƒåº”è¯¥å®šä¹‰ä¸ºä¸€ä¸ª<code>screen</code>.</p>
<p>å¯¹åº”ä¸Šé¢çš„å®ä¾‹,ä½ å¯ä»¥å®šä¹‰<code>AppNavigator</code>åŒ…å«ä¸€ä¸ªå·¢å¼çš„<code>TabNavigator</code>:</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute"> const AppNavigator</span> = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: MyTabNavigator &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªå®ä¾‹ä¸­,ä¸€æ—¦ä½ åœ¨<code>AppWithNavigationState</code>ä¸­<code>connect</code> <code>AppNavigator</code>åˆ°Redux,<code>MyTabNavigation</code>å°†ä¼šè‡ªåŠ¨æ¥å…¥åˆ°navigation state ä½œä¸º<code>navigtion</code>çš„prop.</p>
<h1 id="Web-Integration"><a href="#Web-Integration" class="headerlink" title="Web Integration"></a>Web Integration</h1><p>React Navigation routerså·¥ä½œåœ¨webç¯å¢ƒä¸‹å…è®¸ä½ å’ŒåŸç”Ÿappå…±äº«å¯¼èˆªçš„é€»è¾‘.ç»‘å®šåœ¨<code>react-navigation</code>çš„è§†å›¾ç›®å‰åªèƒ½å·¥ä½œåœ¨React Nativeä¸‹,ä½†æ˜¯åœ¨react-primitivesé¡¹ç›®ä¸­å¯èƒ½ä¼šæœ‰æ‰€æ”¹å˜.</p>
<h2 id="ç¤ºä¾‹ç¨‹åº"><a href="#ç¤ºä¾‹ç¨‹åº" class="headerlink" title="ç¤ºä¾‹ç¨‹åº"></a>ç¤ºä¾‹ç¨‹åº</h2><p><a href="https://reactnavigation.org/" target="_blank" rel="external">è¿™ä¸ªç½‘ç«™</a>ç”±React Navigationæ„å»º,ä½¿ç”¨äº†<code>createNavigation</code>å’Œ<code>TabRouter</code>.<br>çœ‹çœ‹ç½‘ç«™çš„æºä»£ç <a href="https://github.com/react-community/react-navigation/blob/master/website/src/App.js" target="_blank" rel="external">app.js</a></p>
<p>appå¦‚ä½•è·å¾—æ¸²æŸ“å‚çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/website/src/Server.js" target="_blank" rel="external">server.js</a>.åœ¨æµè§ˆå™¨ä¸­,ä½¿ç”¨[BrowserAppContainer.js]æ¥å”¤é†’å’Œè·å¾—æ¸²æŸ“.</p>
<p>##æ›´å¤šå†…å®¹,å¾ˆå¿«å‘ˆç°<br>ä¸ä¹…ä¼šæœ‰è¯¦ç»†çš„æ•™ç¨‹.</p>
<h1 id="Deep-Linking"><a href="#Deep-Linking" class="headerlink" title="Deep Linking"></a>Deep Linking</h1><p>è¿™ä¸€éƒ¨åˆ†æŒ‡å—ä¸­,æˆ‘ä»¬å°†è®¾ç½®appæ¥å¤„ç†å¤–éƒ¨URIs.è®©æˆ‘ä»¬ä»SimpleAppå¼€å§‹<br><a href="https://reactnavigation.org/docs/intro" target="_blank" rel="external">getting startçš„æŒ‡å—</a></p>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­,æˆ‘ä»¬æƒ³ä½¿ç”¨ç±»ä¼¼<code>mychat://chat/Taylor</code>çš„URIæ¥æ‰“å¼€æˆ‘ä»¬çš„app,ç›´æ¥è¿æ¥åˆ°Taylorçš„chat page.</p>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>åœ¨å‰é¢æˆ‘ä»¬å®šä¹‰äº†navigatoræƒ³ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="symbol">  Home:</span> &#123; <span class="keyword">screen: </span>HomeScreen &#125;,</div><div class="line"><span class="symbol">  Chat:</span> &#123; <span class="keyword">screen: </span>ChatScreen &#125;,</div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æƒ³è®©pathç±»ä¼¼<code>chat/Taylor</code>é“¾æ¥åˆ°â€œChatâ€screen,ä¼ é€’<code>user</code>ä½œä¸ºå‚æ•°.æˆ‘ä»¬é‡æ–°å®šä¹‰æˆ‘ä»¬çš„chat screenä½¿ç”¨ä¸€ä¸ª<code>path</code>æ¥å‘Šè¯‰routeréœ€è¦åŒ¹é…çš„pathå’Œéœ€è¦æå–çš„å‚æ•°.è¿™ä¸ªè·¯å¾„é…ç½®ä¸º<code>chat/:user</code>.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="attr">  Home:</span> &#123; screen: HomeScreen &#125;,</div><div class="line"><span class="attr">  Chat:</span> &#123;</div><div class="line"><span class="attr">    screen:</span> ChatScreen,</div><div class="line"><span class="attr">    path:</span> <span class="string">'chat/:user'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="URIçš„å‰ç¼€"><a href="#URIçš„å‰ç¼€" class="headerlink" title="URIçš„å‰ç¼€"></a>URIçš„å‰ç¼€</h2><p>ä¸‹é¢é…ç½®navigation containeræ¥æå–appçš„path.å½“é…ç½®åœ¨é¡¶å±‚navigatorä¸Šçš„æ—¶å€™,æˆ‘ä»¬æä¾›<code>containerOperations</code>,</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> SimpleApp = StackNavigator(&#123;</div><div class="line">  ...</div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">containerOptions</span>: &#123;</div><div class="line">    <span class="comment">// on Android, the URI prefix typically contains a host in addition to scheme</span></div><div class="line">    URIPrefix: Platform.OS == <span class="string">'android'</span> ? <span class="string">'mychat://mychat/'</span> : <span class="string">'mychat://'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h2><p>åŸºäº<code>mychat://</code>URIå›¾å¼é…ç½®åŸç”Ÿçš„iOS app.<br>åœ¨<code>SimpleApp/ios/SimpleApp/AppleDelegate.m</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// Add the header at the top of the file:</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;React/RCTLinkingManager.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// Add this above the `@end`:</span></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url</div><div class="line">  sourceApplication:(<span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation</div><div class="line">&#123;</div><div class="line">  <span class="keyword">return</span> [RCTLinkingManager application:application openURL:url</div><div class="line">                      sourceApplication:sourceApplication annotation:annotation];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨Xcodeé‡Œ,æ‰“å¼€é¡¹ç›®çš„<code>simpleApp/ios/SimpleApp.xcodeproj</code>.åœ¨è¾¹æ ä¸­é€‰æ‹©é¡¹ç›®å¯¼èˆªåˆ°info tab.å‘ä¸‹æ»‘åŠ¨åˆ°â€œURL Typesâ€å¹¶ä¸”æ·»åŠ ä¸€ä¸ª.åœ¨æ–°çš„URL type,è®¾å®šåç§°å’Œurlå›¾å¼å¯¹åº”æƒ³å¯¼èˆªåˆ°çš„urlå›¾å¼.<br><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fe3z3gaupxj30ui0fk74v.jpg" alt=""></p>
<p>ç°åœ¨å¯ä»¥åœ¨Xcodeä¸­ç‚¹å‡»play,æˆ–è€…åœ¨å‘½ä»¤è¡Œè¿è¡Œ<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native <span class="keyword">run</span><span class="bash">-ios</span></div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†åœ¨iOSä¸­æµ‹è¯•URI,åœ¨safariä¸­æ‰“å¼€<code>mychat://chat/Taylor</code></p>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><p>ä¸ºäº†åœ¨Andoridä¸­é“¾æ¥å¤–é“¾,å¯ä»¥åœ¨manifestä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„intent.<br>åœ¨<code>SimpleApp/android/app/src/main/AndroidManifest.xml</code>ä¸­<code>MainActivity</code>å†…æ·»åŠ æ–°çš„<code>VIEW</code>type<code>intent-filter</code>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.VIEW"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.BROWSABLE"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:scheme</span>=<span class="string">"mychat"</span></span></div><div class="line">          <span class="attr">android:host</span>=<span class="string">"mychat"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ç°åœ¨,é‡æ–°è¿è¡Œ:<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native <span class="keyword">run</span><span class="bash">-android</span></div></pre></td></tr></table></figure></p>
<p>åœ¨Androidä¸­æµ‹è¯•intentæ“ä½œ,è¿è¡Œ<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb shell am start -W -<span class="selector-tag">a</span> android<span class="selector-class">.intent</span><span class="selector-class">.action</span><span class="selector-class">.VIEW</span> -d <span class="string">"mychat://mychat/chat/Taylor"</span> com.simpleapp</div></pre></td></tr></table></figure></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe3zdd1q9gg307i0dc17p.gif" alt=""></p>
<h1 id="Screen-tracking-and-analytics"><a href="#Screen-tracking-and-analytics" class="headerlink" title="Screen tracking and analytics"></a>Screen tracking and analytics</h1><p>è¿™ä¸ªå®ä¾‹ä¸­å±•ç¤ºæ€ä¹ˆåšå±å¹•è¿½è¸ªå¹¶ä¸”å‘åˆ°Google Analytics.è¿™ä¸ªæ–¹æ³•åº”ç”¨åœ¨å…¶ä»–çš„ç§»åŠ¨åˆ†æSDKä¹Ÿæ˜¯å¯ä»¥çš„.</p>
<h2 id="Screen-tracking"><a href="#Screen-tracking" class="headerlink" title="Screen tracking"></a>Screen tracking</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨å†…å»ºçš„navigation container,æˆ‘ä»¬ä½¿ç”¨<code>onNavigationStateChange</code>æ¥è¿½è¸ªscreen.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"> import &#123; GoogleAnalyticsTracker &#125; from <span class="string">'react-native-google-analytics-bridge'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</div><div class="line"></div><div class="line"><span class="comment">// gets the current screen from navigation state</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentRouteName</span><span class="params">(navigationState)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!navigationState) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">const</span> route = navigationState.routes[navigationState.index];</div><div class="line">  <span class="comment">// dive into nested navigators</span></div><div class="line">  <span class="keyword">if</span> (route.routes) &#123;</div><div class="line">    <span class="keyword">return</span> getCurrentRouteName(route);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> route.routeName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> AppNavigator = StackNavigator(AppRouteConfigs);</div><div class="line"></div><div class="line">export <span class="keyword">default</span> () =&gt; (</div><div class="line">  &lt;AppNavigator</div><div class="line">    onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123;</div><div class="line">      <span class="keyword">const</span> currentScreen = getCurrentRouteName(currentState);</div><div class="line">      <span class="keyword">const</span> prevScreen = getCurrentRouteName(prevState);</div><div class="line"></div><div class="line">      <span class="keyword">if</span> (prevScreen !== currentScreen) &#123;</div><div class="line">        <span class="comment">// the line below uses the Google Analytics tracker</span></div><div class="line">        <span class="comment">// change the tracker here to use other Mobile analytics SDK.</span></div><div class="line">        tracker.trackScreenView(currentScreen);</div><div class="line">      &#125;</div><div class="line">    &#125;&#125;</div><div class="line">  /&gt;</div><div class="line">);</div></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨ReduxåšScreen-tracking"><a href="#ä½¿ç”¨ReduxåšScreen-tracking" class="headerlink" title="ä½¿ç”¨ReduxåšScreen tracking"></a>ä½¿ç”¨ReduxåšScreen tracking</h2><p>ä½¿ç”¨Reduxçš„æ—¶å€™,æˆ‘ä»¬å¯ä»¥å†™Redux ä¸­é—´ä»¶æ¥track screen.ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„,æˆ‘ä»¬ä»å‰é¢çš„éƒ¨åˆ†é‡æ–°ä½¿ç”¨<code>getCurrenRouteName</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span>;</div><div class="line"><span class="keyword">import</span> &#123; GoogleAnalyticsTracker &#125; <span class="keyword">from</span> <span class="string">'react-native-google-analytics-bridge'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</div><div class="line"></div><div class="line"><span class="keyword">const</span> screenTracking = <span class="function">(<span class="params">&#123; getState &#125;</span>) =&gt;</span> next =&gt; <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (</div><div class="line">    action.type !== NavigationActions.NAVIGATE</div><div class="line">    &amp;&amp; action.type !== NavigationActions.BACK</div><div class="line">  ) &#123;</div><div class="line">    <span class="keyword">return</span> next(action);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> currentScreen = getCurrentRouteName(getState().navigation);</div><div class="line">  <span class="keyword">const</span> result = next(action);</div><div class="line">  <span class="keyword">const</span> nextScreen = getCurrentRouteName(getState().navigation);</div><div class="line">  <span class="keyword">if</span> (nextScreen !== currentScreen) &#123;</div><div class="line">    <span class="comment">// the line below uses the Google Analytics tracker</span></div><div class="line">    <span class="comment">// change the tracker here to use other Mobile analytics SDK.</span></div><div class="line">    tracker.trackScreenView(nextScreen);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> screenTracking;</div></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºRedux-storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶"><a href="#åˆ›å»ºRedux-storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶" class="headerlink" title="åˆ›å»ºRedux storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶"></a>åˆ›å»ºRedux storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶</h2><p>åœ¨åˆ›å»ºstoreçš„æ—¶å€™åº”ç”¨è¿™ä¸ª<code>screenTracking</code>çš„ä¸­é—´ä»¶.çœ‹çœ‹Redux Integrationäº†è§£ç»†èŠ‚.<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> const store = createStore(</div><div class="line">  <span class="name">combineReducers</span>(&#123;</div><div class="line">    navigation: navigationReducer,</div><div class="line">    ...</div><div class="line">  &#125;),</div><div class="line">  applyMiddleware(</div><div class="line">    <span class="name">screenTracking</span>,</div><div class="line">    ...</div><div class="line">    ),</div><div class="line">)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Redux-Intergration&quot;&gt;&lt;a href=&quot;#Redux-Intergration&quot; class=&quot;headerlink&quot; title=&quot;Redux Intergration&quot;&gt;&lt;/a&gt;Redux Intergration&lt;/h1&gt;&lt;p&gt;ä¸ºäº†åœ¨red
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="https://phpsmarter.github.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(4)</title>
    <link href="https://phpsmarter.github.com/2017/03/29/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-4/"/>
    <id>https://phpsmarter.github.com/2017/03/29/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-4/</id>
    <published>2017-03-29T07:16:17.000Z</published>
    <updated>2017-03-29T16:34:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Navigation-Actions"><a href="#Navigation-Actions" class="headerlink" title="Navigation Actions"></a>Navigation Actions</h1><p>æ‰€æœ‰çš„Navigation Actionséƒ½ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡,è¿™ä¸ªå¯¹è±¡å¯ä»¥ä½¿ç”¨<code>navigation.dispatch</code>æ–¹æ³•ä¼ é€’åˆ°router.<br><em>æ³¨æ„</em>ï¼šå¦‚æœä½ æƒ³dispatch react-navigation,ä½ åº”è¯¥ä½¿ç”¨è¿™ä¸ªåº“æä¾›çš„action creators.</p>
<p>ä¸‹é¢çš„actionsæ˜¯å¯ä»¥ä½¿ç”¨çš„:</p>
<ul>
<li><code>Navigate</code>-å¯¼èˆªåˆ°å…¶ä»–çš„route</li>
<li><code>Reset</code>-ä½¿ç”¨æ–°çš„stateä»£æ›¿ç›®å‰çš„state</li>
<li><code>Back</code>-è¿”å›ä¸Šä¸€ä¸ªstate</li>
<li><code>Set Params</code>-ç»™å®šçš„routeè®¾ç½®å‚æ•°</li>
<li><code>Init</code>-å¦‚æœstateæ²¡æœ‰å®šä¹‰,ç”¨æ¥åˆå§‹åŒ–ç¬¬ä¸€ä¸ªstate</li>
</ul>
<h2 id="Navigate"><a href="#Navigate" class="headerlink" title="Navigate"></a>Navigate</h2><p><code>Navigatie action</code>ä¼šä½¿ç”¨<code>Navigate action</code>çš„ç»“æœæ¥æ›´æ–°å½“å‰çš„state.</p>
<ul>
<li><code>routeName</code>-å­—ç¬¦ä¸²-å¿…é€‰é¡¹,åœ¨appçš„routeré‡Œæ³¨å†Œçš„å¯¼èˆªç›®çš„åœ°çš„routeName.</li>
<li><code>params</code>-å¯¹è±¡-å¯é€‰é¡¹-èåˆè¿›ç›®çš„åœ°routeçš„å‚æ•°</li>
<li><code>actions</code>-å¯¹è±¡-å¯é€‰é¡¹-(é«˜çº§)-å¦‚æœscreenä¹Ÿæ˜¯ä¸€ä¸ªnavigator,æ¬¡çº§actionå¯ä»¥åœ¨å­routerä¸­è¿è¡Œ.åœ¨æ–‡æ¡£ä¸­æè¿°çš„ä»»ä½•actionséƒ½å¯ä»¥ä½œä¸ºæ¬¡çº§action.</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; from <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line">const navigateAction = NavigationActions.navigate(&#123;</div><div class="line"></div><div class="line">  routeName: <span class="string">'Profile'</span>,</div><div class="line"></div><div class="line">  params: &#123;&#125;,</div><div class="line"></div><div class="line">  action: NavigationActions.navigate(&#123; routeName: <span class="string">'SubProfileRoute'</span>&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">this.props.navigation.dispatch(navigateAction)</div></pre></td></tr></table></figure>
<h2 id="Reset"><a href="#Reset" class="headerlink" title="Reset"></a>Reset</h2><p><code>Reset</code>actionåˆ æ‰æ‰€æœ‰çš„navigation stateå¹¶ä¸”ä½¿ç”¨å‡ ä¸ªactionsçš„ç»“æœæ¥ä»£æ›¿.</p>
<ul>
<li><code>index</code>â€”æ•°ç»„-å¿…é€‰-navigation <code>state</code>ä¸­<code>route</code>æ•°ç»„ä¸­æ¿€æ´»routeçš„index.</li>
<li><code>actions</code>-æ•°ç»„-å¿…é€‰é¡¹-Navigation Actionsæ•°ç»„,å°†ä¼šæ›¿ä»£navigation state</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> resetAction = NavigationActions.reset(&#123;</div><div class="line">  <span class="attr">index</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">actions</span>: [</div><div class="line">    NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'Profile'</span>&#125;)</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(resetAction)</div></pre></td></tr></table></figure>
<h2 id="æ€ä¹ˆä½¿ç”¨indexå‚æ•°"><a href="#æ€ä¹ˆä½¿ç”¨indexå‚æ•°" class="headerlink" title="æ€ä¹ˆä½¿ç”¨indexå‚æ•°"></a>æ€ä¹ˆä½¿ç”¨<code>index</code>å‚æ•°</h2><p><code>index</code>å‚æ•°è¢«ç”¨æ¥å®šåˆ¶åŒ–å½“å‰æ¿€æ´»çš„route<br>ä¾‹å¦‚ï¼šä½¿ç”¨ä¸¤ä¸ªroutes <code>Profile</code>å’Œ<code>Settings</code>ç»™ä¸€ä¸ªåŸºç¡€çš„stakc navigationè®¾ç½®.ä¸ºäº†é‡ç½®routeåˆ°ç»è¿‡<code>Settings</code>çš„æ¿€æ´»screené‚£ä¸€ç‚¹,ä½†æ˜¯åœ¨å †æ ˆä¸­ä»–åˆå­˜æ”¾åœ¨<code>Setting</code>screenä¹‹ä¸Š,ä½ å¯ä»¥è¿™ä¹ˆåš:</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; from <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line">const resetAction = NavigationActions.reset(&#123;</div><div class="line">  index: <span class="number">1</span>,</div><div class="line">  actions: [</div><div class="line">    NavigationActions.navigate(&#123; routeName: <span class="string">'Profile'</span>&#125;),</div><div class="line">    NavigationActions.navigate(&#123; routeName: <span class="string">'Settings'</span>&#125;)</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line">this.props.navigation.dispatch(resetAction)</div></pre></td></tr></table></figure>
<h2 id="Back"><a href="#Back" class="headerlink" title="Back"></a>Back</h2><p>è¿”å›åˆ°å‰ä¸€ä¸ªscreenå¹¶ä¸”å…³é—­å½“å‰screen.<code>back</code>action creatoræ¥å—ä¸€ä¸ªå¯é€‰çš„å‚æ•°:</p>
<ul>
<li><code>key</code>-å­—ç¬¦ä¸²æˆ–è€…ç©º-å¯é€‰é¡¹-å¦‚æœè®¾å®šäº†,navigationå°†ä¼šä»è®¾å®šçš„keyè¿”å›.å¦‚æœæ˜¯null,navigationå°†è¿”å›åˆ°ä»»ä½•åœ°æ–¹.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> backAction = NavigationActions.back(&#123;</div><div class="line">  <span class="attr">key</span>: <span class="string">'Profile'</span></div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(backAction)</div></pre></td></tr></table></figure>
<h2 id="SetParams"><a href="#SetParams" class="headerlink" title="SetParams"></a>SetParams</h2><p>å½“dispatching <code>setParamsçš„æ—¶å€™</code>,routerå°†ä¼šäº§å‡ºä¸€ä¸ªæ–°çš„state,è¿™ä¸ªstateæ˜¯å·²ç»æ”¹å˜äº†ç‰¹å®šrouteçš„å‚æ•°,ä»¥keyä½œä¸ºèº«ä»½éªŒè¯</p>
<ul>
<li><code>params</code>-å¯¹è±¡-å¿…é€‰å‚æ•°-èåˆè¿›å·²ç»å­˜åœ¨çš„routeå‚æ•°ä¸­çš„æ–°å‚æ•°</li>
<li><code>key</code>-å­—ç¬¦ä¸²-å¿…é€‰å‚æ•°-Routeçš„key,åº”è¯¥åˆ†é…ç»™æ–°çš„å‚æ•°</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> setParamsAction = NavigationActions.setParams(&#123;</div><div class="line">  <span class="attr">params</span>: &#123; <span class="attr">title</span>: <span class="string">'Hello'</span> &#125;,</div><div class="line">  <span class="attr">key</span>: <span class="string">'screen-123'</span>,</div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(setParamsAction)</div></pre></td></tr></table></figure>
<h1 id="Screen-Navigation-Options"><a href="#Screen-Navigation-Options" class="headerlink" title="Screen Navigation Options"></a>Screen Navigation Options</h1><p>æ¯ä¸ªscreenéƒ½å¯ä»¥é…ç½®å‡ ä¸ªæ–¹é¢çš„å†…å®¹,è¿™äº›å†…å®¹å½±å“åˆ°åœ¨çˆ¶navigatorsä¸­æ€ä¹ˆå¾—åˆ°å±•ç¤º.</p>
<h2 id="å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•"><a href="#å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•"></a>å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•</h2><p><em>é™æ€é…ç½®æ–¹æ³•</em>:æ¯ä¸€ä¸ªnavigation å¯é€‰é¡¹éƒ½å¯ä»¥è¢«ç›´æ¥è®¾å®š:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: <span class="symbol">'Grea</span>t',</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<p><em>åŠ¨æ€é…ç½®æ–¹æ³•</em><br>è¦ä¹ˆå°±é‡‡ç”¨å‡½æ•°å¼çš„æ–¹æ³•,æ¥å—å‚æ•°,ç„¶åè¿”å›å¯é€‰é¡¹çš„å€¼.</p>
<ul>
<li><code>navigation</code>-screençš„navigation propå’Œ<code>navigation.state</code>ä¸­screençš„route</li>
<li><code>childRouter</code>-å¦‚æœscreenæ˜¯ä¸€ä¸ªnavigator,è¿™ä¸ªå‚æ•°å°±æ˜¯å­ä»£router.</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: (navigation, childRouter) =&gt; &#123;</div><div class="line">     <span class="keyword">return</span> navigation.state.params.name + <span class="string">"'s Profile!"</span>;</div><div class="line">   &#125;,</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<h2 id="é€šç”¨çš„Navigation-Options"><a href="#é€šç”¨çš„Navigation-Options" class="headerlink" title="é€šç”¨çš„Navigation Options"></a>é€šç”¨çš„Navigation Options</h2><p>navigationçš„å¯é€‰é¡¹<code>title</code>åœ¨æ¯ä¸€ä¸ªnavigatorä¹‹é—´æ˜¯é€šç”¨çš„,ç”¨æ¥è®¾å®šæ¯ä¸€ä¸ªscreençš„æ ‡é¢˜å­—ç¬¦ä¸².</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: <span class="symbol">'Grea</span>t',</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<p>ä¸åƒå…¶ä»–çš„navigationçš„å¯é…ç½®é¡¹ä»…ä»…ç”±navigator viewæ¥ä½¿ç”¨,title é€‰é¡¹å¯ä»¥è¢«ç¯å¢ƒå˜é‡ä½¿ç”¨æ¥æ›´æ–°æµè§ˆå™¨çš„æ ‡é¢˜æˆ–è€…appåˆ‡æ¢æ—¶å€™çš„æ ‡é¢˜.</p>
<h2 id="é»˜è®¤çš„Navigationé€‰é¡¹"><a href="#é»˜è®¤çš„Navigationé€‰é¡¹" class="headerlink" title="é»˜è®¤çš„Navigationé€‰é¡¹"></a>é»˜è®¤çš„Navigationé€‰é¡¹</h2><p>åœ¨screenä¸­å®šä¹‰<code>navigationOption</code>éå¸¸æ™®é,ä½†æ˜¯æœ‰æ—¶å€™åœ¨navigatorä¸­å®šä¹‰<code>navitationOptions</code>ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨</p>
<p>æƒ³è±¡ä¸‹é¢çš„åœºæ™¯:ä½ çš„<code>TabNavigator</code>ä»£è¡¨appä¸­çš„ä¸€ä¸ªscreen.ä»–åœ¨é¡¶å±‚<code>StackNavigator</code>ä¹‹å†…:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">StackNavigator:</span></div><div class="line"> - <span class="string">route1:</span> A screen</div><div class="line"> - <span class="string">route2:</span> A TabNavigator</div></pre></td></tr></table></figure>
<p>ç°åœ¨<code>route2</code>æ˜¯æ¿€æ´»çš„,ä½ å¯èƒ½ä¼šéšè—header,éšè—<code>route1</code>çš„headeréå¸¸å®¹æ˜“,<code>route2</code>çš„headeråº”è¯¥ä¹Ÿå¾ˆå®¹æ˜“éšè—.è¿™å°±æ˜¯é»˜è®¤Navigation Option è¦åšçš„.å¯ä»¥åœ¨<code>navigationOptions</code>ä¸­è®¾å®š:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">TabNavigator</span>(&#123;</div><div class="line">  <span class="attribute">profile</span>: ProfileScreen,</div><div class="line">  ...</div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attribute">navigationOptions</span>: &#123;</div><div class="line">     header: &#123;</div><div class="line">       visible: false,</div><div class="line">     &#125;,</div><div class="line">   &#125;,</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p>æç¤º:ä½ ä»ç„¶å¯ä»¥åœ¨å­ä»£å¯¼èˆªscreenä¸Šå®šåˆ¶<code>navigationOptions</code>.-ä¾‹å¦‚,ä¸Šé¢çš„<code>ProfileScreen</code>.ä»screenè·å¾—çš„<code>navigationOptions</code>ä¼šå’Œä»navigatoræ¥çš„é…ç½®æŒ‰ç…§é”®-é”®çš„æ–¹å¼èåˆåœ¨ä¸€èµ·.æ— è®ºåœ¨ä»€ä¹ˆè€Œæ—¶é—´,navigatorå’Œscreenå®šä¹‰ç›¸åŒçš„é…ç½®(ä¾‹å¦‚:<code>header</code>),screenä¼šä¼˜å…ˆä½¿ç”¨.å› æ­¤,å½“<code>ProfileScreen</code>æ¿€æ´»çš„æ—¶å€™,ä½ å¯ä»¥ä½¿headerå†æ¬¡å¯è§.</p>
<p><em>æ‰©å±•é»˜è®¤é…ç½®</em>:ä¸ºäº†ä½¿ç”¨screenç‰¹å®šçš„propertiesæ‰©å±•é»˜è®¤é…ç½®,è€Œä¸æ˜¯é‡å†™å®ƒ,ä½ å¯ä»¥åƒä¸‹é¢ä¸€æ ·é…ç½®é€‰é¡¹:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    header: (navigation, defaultHeader) =&gt; (&#123;</div><div class="line">      ...defaultHeader,</div><div class="line">      visible: <span class="literal">true</span>,</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¼ é€’åˆ°å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºåœ¨navigatorä¸­å®šä¹‰çš„<code>header</code>çš„é»˜è®¤å€¼.</p>
<h2 id="Tab-Navigation-Options"><a href="#Tab-Navigation-Options" class="headerlink" title="Tab Navigation Options"></a>Tab Navigation Options</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TabScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: (&#123; state &#125;) =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Tab</span> <span class="type">Label</span>',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./tab-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">      visible: <span class="literal">true</span></div><div class="line">    &#125;),</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><code>label</code>-å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯Reactç»„ä»¶</li>
<li><code>icon</code>-å‡½æ•°è¿”å›iconç»„ä»¶</li>
<li><code>visible</code>-trueæˆ–è€…false,æ˜¾ç¤ºæˆ–è€…éšè—tab bar,é»˜è®¤æ˜¯true</li>
</ul>
<h1 id="Custom-Navigation"><a href="#Custom-Navigation" class="headerlink" title="Custom Navigation"></a>Custom Navigation</h1><p>ä¸€ä¸ªnavigatoræ˜¯ä»»ä½•åŒ…å«routerçš„Reactç»„ä»¶.è¿™é‡Œæ˜¯ä¸€ä¸ªåŸºæœ¬navigator,ä½¿ç”¨routerçš„APIå»è·å¾—æ¿€æ´»ç»„ä»¶æ¥æ¸²æŸ“<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"> class MyNavigator extends React.Component &#123;</div><div class="line">  static router = MyRouter;</div><div class="line">  render() &#123;</div><div class="line">    const &#123; <span class="keyword">state</span>, dispatch &#125; = this.props.navigation;</div><div class="line">    const &#123; routes, index &#125; = <span class="keyword">state</span>;</div><div class="line"></div><div class="line">    // Figure <span class="keyword">out</span> what <span class="keyword">to</span> render based <span class="keyword">on</span> the navigation <span class="keyword">state</span> and the router:</div><div class="line">    const Component = MyRouter.getComponentForState(<span class="keyword">state</span>);</div><div class="line"></div><div class="line">    // The <span class="keyword">state</span> of the active child screen can be found at routes[index]</div><div class="line">    let childNavigation = &#123; dispatch, <span class="keyword">state</span>: routes[index] &#125;;</div><div class="line">    // If we want, we can also tinker with the dispatch function here, <span class="keyword">to</span> <span class="keyword">limit</span></div><div class="line">    // or augment our children's actions</div><div class="line"></div><div class="line">    // Assuming our children want the convenience of calling .navigate() and so <span class="keyword">on</span>,</div><div class="line">    // we should call addNavigationHelpers <span class="keyword">to</span> augment our navigation prop:</div><div class="line">    childNavigation = addNavigationHelpers(childNavigation);</div><div class="line"></div><div class="line">    return <span class="variable">&lt;Component navigation=&#123;childNavigation&#125; /&gt;</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Navigation-Prop"><a href="#Navigation-Prop" class="headerlink" title="Navigation Prop"></a>Navigation Prop</h2><p>navigation propä¼ é€’ç»™navigatorçš„ä»…ä»…åŒ…å«<code>state</code>å’Œ<code>dispatch</code>,è¿™æ˜¯å½“å‰çš„navigatorçš„state,ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªäº‹ä»¶é¢‘é“ç”¨æ¥å‘é€action request.<br>æ‰€æœ‰çš„navigatorséƒ½æ˜¯å—æ§ç»„ä»¶:ä»–ä»¬æ€»æ˜¯æ˜¾ç¤ºæ ¹æ®<code>props.navigation.state</code>æ¥æ˜¾ç¤º,ä»–ä»¬è¦æ”¹å˜state,å”¯ä¸€çš„åŠæ³•æ˜¯å‘é€actionsåˆ°<code>props.navigation.dispatch</code>.<br>Navigatorså¯ä»¥é€šè¿‡å®šåˆ¶ä»–ä»¬çš„routeræ¥æ”¹å˜çˆ¶navigatorsçš„è¡Œä¸º.ä¾‹å¦‚,å½“actionåº”è¯¥ä»<code>router.getStateForAction</code>è¿”å›nullæ¥é˜»æ­¢å…¶è¿è¡Œçš„æ—¶å€™.æˆ–è€…ä¸€ä¸ªnavigatorå¯ä»¥ä¸ºäº†å®šåˆ¶URIçš„æ“ä½œè€Œæ”¹å†™<code>router.getActionForPathParams</code>,ä¸ºäº†è¾“å‡ºç›¸å¯¹navigation actionä»¥åŠæ“ä½œ<code>router.getStateForAction</code>çš„action.</p>
<h2 id="Navigation-State"><a href="#Navigation-State" class="headerlink" title="Navigation State"></a>Navigation State</h2><p>ä¼ é€’åˆ°<code>props.navigation.state</code>çš„navigation stateæœ‰ä¸‹é¢çš„ç»“æ„:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>, <span class="comment">// identifies which route in the routes array is active</span></div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="comment">// Each route needs a name, which routers will use to associate each route</span></div><div class="line">      <span class="comment">// with a react component</span></div><div class="line">      <span class="attribute">routeName</span>: <span class="string">'MyRouteName'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// A unique id for this route, used to keep order in the routes array:</span></div><div class="line">      <span class="attribute">key</span>: <span class="string">'myroute-123'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// Routes can have any additional data. The included routers have `params`</span></div><div class="line">      ...customRouteData,</div><div class="line">    &#125;,</div><div class="line">    ..<span class="selector-class">.moreRoutes</span>,</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Navigation-Dispatchers"><a href="#Navigation-Dispatchers" class="headerlink" title="Navigation Dispatchers"></a>Navigation Dispatchers</h2><p>navigatorå¯ä»¥dispatch navigation actions,ä¾‹å¦‚Go to URI,Go back.<br>å¦‚æœactionè¢«æˆåŠŸæ“ä½œäº†,dispatcherå°†ä¼šè¿”å›true,å¦åˆ™å°±æ˜¯false</p>
<h2 id="æ„å»ºå®šåˆ¶navigatorsçš„API"><a href="#æ„å»ºå®šåˆ¶navigatorsçš„API" class="headerlink" title="æ„å»ºå®šåˆ¶navigatorsçš„API"></a>æ„å»ºå®šåˆ¶navigatorsçš„API</h2><p>ä¸ºäº†å¸®åŠ©å¼€å‘è€…å®æ–½å®šåˆ¶navigators,React Navigationæä¾›äº†ä¸‹é¢çš„å·¥å…·<br><code>createNavigator</code><br>è¿™ä¸ªå·¥å…·ä½¿ç”¨æ ‡å‡†æ–¹æ³•æŠŠrouterå’Œnavigation viewåˆå¹¶åœ¨ä¸€èµ·.<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">const MyApp = createNavigator(<span class="name">MyRouter</span>)(<span class="name">MyView</span>)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>å¹•åæ‰€åšçš„æ˜¯:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = <span class="function">(<span class="params">&#123; navigation &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">MyView</span> <span class="attr">router</span>=<span class="string">&#123;MyRouter&#125;</span> <span class="attr">navigation</span>=<span class="string">&#123;navigation&#125;</span> /&gt;</span></span></div><div class="line">);</div><div class="line">MyApp.router = MyRouter;</div></pre></td></tr></table></figure>
<p><code>addNavigationHelpers</code><br>æ¥æ”¶ä¸€ä¸ªæ‹¥æœ‰<code>state</code>å’Œ<code>dispatch</code>çš„çº¯navigatorçš„prop,ä¼ é€’çš„å‚æ•°æ˜¯åœ¨screen navigation propä¸­çš„å„ç§å‡½æ•°,ä¾‹å¦‚<code>navigation.navigate()</code>å’Œ<code>navigation.goBack()</code>.è¿™äº›å‡½æ•°æ˜¯ç®€å•çš„åŠ©æ‰‹å‡½æ•°å¸®åŠ©åˆ›å»ºactionå¹¶ä¸”å‘é€åˆ°<code>dispatch</code>.</p>
<p><code>createNavigationContainer</code></p>
<p>å¦‚æœä½ æƒ³è®©ä½ çš„navigatorä½œä¸ºé¡¶å±‚ç»„ä»¶ä½¿ç”¨(æ²¡æœ‰navigation propä¼ å…¥),ä½ å¯ä»¥ä½¿ç”¨<code>createNavigationContainer</code>.å½“ç¼ºå°‘navigtion propçš„æ—¶å€™,è¿™ä¸ªå·¥å…·ä½¿ä½ çš„navigatorçœ‹èµ·æ¥åƒä¸€ä¸ªé¡¶å±‚çš„å¯¼èˆªç»„ä»¶.å®ƒå°†ç®¡ç†appçš„state,å’Œappçº§åˆ«çš„å¯¼èˆªç‰¹æ€§æ•´åˆåœ¨ä¸€èµ·,ä¾‹å¦‚æ“ä½œè¿›å‡ºçš„é“¾æ¥å’Œandroidçš„è¿”å›æŒ‰é’®è¡Œä¸º.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Navigation-Actions&quot;&gt;&lt;a href=&quot;#Navigation-Actions&quot; class=&quot;headerlink&quot; title=&quot;Navigation Actions&quot;&gt;&lt;/a&gt;Navigation Actions&lt;/h1&gt;&lt;p&gt;æ‰€æœ‰çš„Nav
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="https://phpsmarter.github.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(3)</title>
    <link href="https://phpsmarter.github.com/2017/03/28/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-3/"/>
    <id>https://phpsmarter.github.com/2017/03/28/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-3/</id>
    <published>2017-03-28T07:48:36.000Z</published>
    <updated>2017-03-28T22:59:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Navigators"><a href="#Navigators" class="headerlink" title="Navigators"></a>Navigators</h1><p>Navigatorså…è®¸ä½ å®šä¹‰ä½ çš„å¯¼èˆªç»“æ„.Navigatorsä¹Ÿå¯ä»¥æ¸²æŸ“æ™®é€šçš„å…ƒç´ ,ä¾‹å¦‚ä½ é…ç½®å¥½çš„headerå’Œtab bar.<br>navigatorså¯ä»¥æ˜¯å•çº¯çš„Reactç»„ä»¶.</p>
<h2 id="å†…å»ºçš„Navigators"><a href="#å†…å»ºçš„Navigators" class="headerlink" title="å†…å»ºçš„Navigators"></a>å†…å»ºçš„Navigators</h2><p><code>react-navigation</code>åŒ…å«ä¸‹é¢çš„å‡ ä¸ªå‡½æ•°å¸®åŠ©ä½ åˆ›å»ºnavigatorsï¼š</p>
<ul>
<li><code>StackNavigator</code>-ä¸€æ¬¡æ¸²æŸ“ä¸€ä¸ªscreen,åœ¨screenä¹‹é—´åˆ‡æ¢.å½“ä¸€ä¸ªæ–°çš„screenè¢«æ‰“å¼€çš„æ—¶å€™,ä»–è¢«æ”¾åœ¨æ ˆé¡¶.</li>
<li><code>TabNavigator</code>-æ¸²æŸ“å‡ºä¸€ä¸ªtab barè®©ç”¨æˆ·å¯ä»¥åœ¨å¤šä¸ªscreenä¹‹é—´åˆ‡æ¢.</li>
<li><code>DrawNavigator</code>-æ¸²æŸ“ä¸€ä¸ªæŠ½å±‰,å¯ä»¥ä»å±å¹•å·¦è¾¹ä¾§æ»‘å‡º.</li>
</ul>
<h2 id="ä½¿ç”¨Navigatorsæ¸²æŸ“screen"><a href="#ä½¿ç”¨Navigatorsæ¸²æŸ“screen" class="headerlink" title="ä½¿ç”¨Navigatorsæ¸²æŸ“screen"></a>ä½¿ç”¨Navigatorsæ¸²æŸ“screen</h2><p>navigatorså®é™…æ¸²æŸ“çš„å°±æ˜¯Reactç»„ä»¶<br>äº†è§£æ€ä¹ˆåˆ›å»ºscreen,è¯»è¯»ä¸€ä¸‹å†…å®¹:</p>
<ul>
<li>Screen<code>navigation</code>propså…è®¸screenåˆ†å‘navigationåŠ¨ä½œ,ä¾‹å¦‚æ“ä½œå¦å¤–ä¸€ä¸ªscreen.</li>
<li>Screen <code>navigationOptions</code>å®šåˆ¶screençš„å±•ç¤ºæ–¹å¼(ä¾‹å¦‚ï¼šheader title,tab label)<h2 id="åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª"><a href="#åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª" class="headerlink" title="åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª"></a>åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª</h2>ä¸‡ä¸€ä½ æƒ³åœ¨åŒä¸€çº§åˆ«çš„Navigation screenä¹‹é—´ä½¿ç”¨Navigator,ä½ å¯ä»¥ä½¿ç”¨reactçš„<code>ref</code>é€‰é¡¹:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">   const <span class="type">AppNavigator</span> = <span class="type">StackNavigator</span>(<span class="type">SomeAppRouteConfigs</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  someEvent() &#123;</div><div class="line">    <span class="comment">// call navigate for AppNavigator here:</span></div><div class="line">    <span class="keyword">this</span>.navigator &amp;&amp; <span class="keyword">this</span>.navigator.dispatch(&#123; <span class="class"><span class="keyword">type</span></span>: <span class="symbol">'Navigat</span>e', routeName, params &#125;);</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">AppNavigator</span> ref=&#123;nav =&gt; &#123; <span class="keyword">this</span>.navigator = nav; &#125;&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:è¿™ä¸ªè§£å†³åŠæ³•åªèƒ½ç”¨åœ¨é¡¶å±‚navigatorä¸Š.</p>
<h2 id="Navigation-Containers"><a href="#Navigation-Containers" class="headerlink" title="Navigation Containers"></a>Navigation Containers</h2><p>å¦‚æœnavigatorsæ²¡æœ‰propsçš„è¯,ä»–å°±ä¼šè¡¨ç°ä¸ºé¡¶å±‚navigators.è¿™ä¸ªæ–¹å¼æä¾›äº†ä¸€ä¸ªé€æ˜çš„navigator container,è¿™æ˜¯é¡¶å±‚å¯¼èˆªpropsçš„æ¥æº.<br>å½“æ¸²æŸ“å…¶ä¸­ä¸€ä¸ªnavigatorsçš„æ—¶å€™,navigation propæ˜¯å¯é€‰çš„.å¦‚æœæ²¡æœ‰navigation prop,containerå°†ä¼šç®¡ç†è‡ªå·±çš„å¯¼èˆªstate.ä»–ä¹Ÿå¯ä»¥ä½¿ç”¨URLs,å¤–éƒ¨é“¾æ¥ä»¥åŠæ•´åˆandroidçš„back button.</p>
<p>ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿,åœ¨å¹•åå†…å»ºçš„navigatorsæœ‰è¿™ä¸ªèƒ½åŠ›,å› ä¸ºåœ¨å¹•åä»–ä»¬ä½¿ç”¨äº†<code>createNavigationContainer</code>.é€šå¸¸,navigatorséœ€è¦ä¸€ä¸ªnavigation propæ¥æ‰§è¡Œä¸€å®šçš„åŠŸèƒ½.<br><code>onNavigationStateChange(prevState, newState)</code></p>
<p>å½“navigation stateç”±é¡¶å±‚navigatorå˜åŒ–ç®¡ç†çš„æ—¶å€™,è¿™ä¸€ç‚¹éå¸¸æœ‰ç”¨.ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„,è¿™ä¸ªå‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šä½¿ç”¨å¯¼èˆªä¹‹å‰çš„stateå’Œå¯¼èˆªä¹‹åçš„æ–°stateä½œä¸ºå‚æ•°.</p>
<p><code>containerOptions</code><br>å½“ä¸€ä¸ªnavigatoråœ¨é¡¶å±‚è¢«ä½¿ç”¨çš„æ—¶å€™,è¿™äº›é€‰é¡¹å¯ä»¥æ¥é…ç½®è¿™ä¸ªnavigator.<br>å¦‚æœä¸€ä¸ªnavigatoré…ç½®äº†<code>containerOptions</code>,ä½†æ˜¯ä¹Ÿæ¥å—äº†<code>navigation</code>prop,ä¼šæŠ›å‡ºé”™è¯¯.å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹,navigatoræœ‰ä¸¤ç§é€‰æ‹©,å®ƒå°±ä¸çŸ¥é“æ€ä¹ˆåšäº†.</p>
<ul>
<li><code>URIPrefic</code>-appå¯ä»¥å¤„ç†çš„URIå‰ç¼€.åœ¨å¤„ç†<code>deep link</code>çš„æ—¶å€™ï¼Œå¯ä»¥æå–è·¯å¾„,å¹¶ä¸”ä¼ é€’åˆ°router.</li>
</ul>
<h1 id="StackNavigator"><a href="#StackNavigator" class="headerlink" title="StackNavigator"></a>StackNavigator</h1><p>ç»™ä½ çš„appæä¾›screenä¹‹é—´è½¬å˜çš„æ–¹æ³•,æ¯ä¸ªè½¬å˜åˆ°çš„screenä¼šå­˜æ”¾åœ¨å †æ ˆçš„æ ˆé¡¶.<br>é»˜è®¤æƒ…å†µä¸‹,StackNavigatoré…ç½®æœ‰iOSå’Œandroidçš„å¤–è§‚å’Œæ„Ÿè§‰:åœ¨iOSä¸‹,æ–°çš„screenä»å±å¹•çš„å³ä¾§æ»‘å…¥,åœ¨androidä¸‹,æ–°çš„screenä»åº•éƒ¨æ·¡å…¥.iOSä¸‹ä¹Ÿå¯ä»¥é…ç½®ä¸ºä»å±å¹•åº•éƒ¨æ»‘å…¥.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Hom</span>e',</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Profil</span>e', &#123;name: <span class="symbol">'Luc</span>y'&#125;)&#125;</div><div class="line">        title=<span class="string">"Go to Lucy's profile"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const <span class="type">ModalStack</span> = <span class="type">StackNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Profile</span>: &#123;</div><div class="line">    path: <span class="symbol">'people</span>/:name',</div><div class="line">    screen: <span class="type">MyProfileScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="å®šä¹‰API"><a href="#å®šä¹‰API" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><p><code>StackNavigator(Routeconfigs,StackNavigatorConfig)</code></p>
<h2 id="RouteConfigs"><a href="#RouteConfigs" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>routeçš„é…ç½®å¯¹è±¡æ˜¯route nameåˆ°route configçš„æ˜ å°„(è¯‘è€…:è¿™æ‰æ˜¯é‡ç‚¹),é…ç½®å¯¹è±¡å‘Šè¯‰navigatorä»€ä¹ˆæ¥ä»£è¡¨route.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">StackNavigator(&#123;</div><div class="line"></div><div class="line">  <span class="comment">// For each screen that you can navigate to, create a new entry like this:</span></div><div class="line">  Profile: &#123;</div><div class="line"></div><div class="line">    <span class="comment">// `ProfileScreen` is a React component that will be the main content of the screen.</span></div><div class="line">    screen: ProfileScreen,</div><div class="line">    <span class="comment">// When `ProfileScreen` is loaded by the StackNavigator, it will be given a `navigation` prop.</span></div><div class="line"></div><div class="line">    <span class="comment">// Optional: When deep linking or using react-navigation in a web app, this path is used:</span></div><div class="line">    path: <span class="string">'people/:username'</span>,</div><div class="line">    <span class="comment">// The action and route params are extracted from the path.</span></div><div class="line"></div><div class="line">    <span class="comment">// Optional: Override the `navigationOptions` for the screen</span></div><div class="line">    navigationOptions: &#123;</div><div class="line">      <span class="attr">title</span>: <span class="function">(<span class="params">&#123;state&#125;</span>) =&gt;</span> <span class="string">`<span class="subst">$&#123;state.params.username&#125;</span>'s Profile'`</span>,</div><div class="line">    &#125;,</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  ...MyOtherRoutes,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="StackNavigatorConfi"><a href="#StackNavigatorConfi" class="headerlink" title="StackNavigatorConfi"></a>StackNavigatorConfi</h2><p>Routerçš„Options:</p>
<ul>
<li><code>initialRouteName</code>-è®¾å®šé»˜è®¤çš„å †æ ˆçš„screen.éœ€è¦å’Œroute configçš„é”®ä¹‹ä¸€ç›¸åŒ.</li>
<li><code>initalRouteParams</code>-åˆå§‹åŒ–routeçš„å‚æ•°</li>
<li><code>navigationOptions</code>-é»˜è®¤éœ€è¦ä½¿ç”¨çš„å¯é€‰å‚æ•°</li>
<li><code>path</code>-è¦†ç›–route configsçš„è·¯å¾„è®¾ç½®</li>
</ul>
<p>å¯è§†åŒ–é€‰é¡¹:</p>
<ul>
<li><code>mode</code>-å®šä¹‰æ¸²æŸ“å’Œåˆ‡æ¢ä¹‹é—´çš„æ ·å¼:<ul>
<li><code>card</code>-ä½¿ç”¨iOSå’Œandroidæ ‡å‡†çš„åˆ‡æ¢æ–¹æ³•.é»˜è®¤å€¼</li>
<li><code>modal</code>-ä½¿screenä»åº•éƒ¨æ»‘åŠ¨æ˜¾ç¤º.ä»…ä»…åœ¨iOSä¸‹ä½¿ç”¨,Andoridä¸‹æ²¡æœ‰æ•ˆæœ</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>headerMode</code>-å®šåˆ¶headeræ¸²æŸ“çš„æ–¹æ³•</p>
<ul>
<li><code>float</code>-åˆ‡æ¢ç•Œé¢çš„æ—¶å€™,ç”¨åŠ¨ç”»æ•ˆæœåœ¨screençš„é¡¶éƒ¨æ¸²æŸ“header</li>
<li><code>screen</code>-æ¯ä¸€ä¸ªscreenéƒ½æœ‰ä¸€ä¸ªheaderé™„ç€åˆ°å¤´éƒ¨,åˆ‡æ¢çš„æ—¶å€™æœ‰æ·¡å…¥å’Œæ·¡å‡ºçš„æ•ˆæœ.andoridçš„åŸºæœ¬æ¨¡å¼</li>
<li><code>none</code>-æ²¡æœ‰headerçš„æ¸²æŸ“.</li>
</ul>
</li>
<li><p><code>cardStyle</code>-ä½¿ç”¨è¿™ä¸ªpropæ¥é‡å†™æˆ–è€…æ‰©å±•å•ä¸ªcardçš„é»˜è®¤style</p>
</li>
<li><code>onTransitionStart</code>-å½“cardå¼€å§‹åˆ‡æ¢åŠ¨ç”»çš„æ—¶å€™,è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨</li>
<li><code>onTransitionEnd</code>-å½“åˆ‡æ¢åŠ¨ç”»å®Œæˆçš„æ—¶å€™,è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨</li>
</ul>
<h2 id="Screen-Navigation-Options"><a href="#Screen-Navigation-Options" class="headerlink" title="Screen Navigation Options"></a>Screen Navigation Options</h2><p>é€šå¸¸åœ¨screenç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.ä¾‹å¦‚:<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">class ProfileScreen extends React.Component &#123;</div><div class="line"></div><div class="line">  static navigationOptions = &#123;</div><div class="line"></div><div class="line">    title: (&#123; <span class="keyword">state</span> &#125;) =&gt; `$&#123;<span class="keyword">state</span>.params.name&#125;'s Profile!`,</div><div class="line"></div><div class="line">    header: (&#123; <span class="keyword">state</span>, <span class="built_in">set</span>Params &#125;) =&gt; (&#123;</div><div class="line">      // Render a button <span class="keyword">on</span> the right side of the header</div><div class="line">      // When pressed switches the screen <span class="keyword">to</span> edit mode.</div><div class="line">      right: (</div><div class="line">        <span class="variable">&lt;Button</span></div><div class="line">          title=&#123;state.params.editing ? 'Done' : 'Edit'&#125;</div><div class="line">          onPress=&#123;() =&gt; <span class="built_in">set</span>Params(&#123;editing: <span class="keyword">state</span>.params.editing ? false : true&#125;)&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;;</div><div class="line">  ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰çš„<code>stackNavigator</code>çš„<code>navigationOptions</code>:</p>
<ul>
<li><code>title</code>-sceneçš„æ ‡é¢˜(å­—ç¬¦ä¸²)</li>
<li><code>header</code>-header barçš„é…ç½®å¯¹è±¡<ul>
<li><code>visible</code>-headerå¯è§†æ€§çš„åˆ‡æ¢.åªæœ‰å½“<code>headerMode</code>æ˜¯<code>screen</code>çš„æ—¶å€™æ‰å¯ä»¥å·¥ä½œ</li>
<li><code>title</code>-headerå¯ä»¥ä½¿ç”¨çš„å­—ç¬¦ä¸²æˆ–è€…Reactç»„ä»¶,é»˜è®¤æ˜¯sceneçš„<code>title</code></li>
<li><code>backTitle</code>-iOS backæŒ‰é’®çš„titleå­—ç¬¦ä¸²æˆ–è€…<code>null</code>åˆ°disableæ ‡ç­¾,é»˜è®¤è®¾å®šåˆ°sceneçš„<code>title</code>.</li>
<li><code>right</code>-æ˜¾ç¤ºåœ¨headerå³ä¾§çš„Reactç»„ä»¶</li>
<li><code>left</code>-åŒä¸Š,å·¦ä¾§</li>
<li><code>style</code>-headerçš„Styleå¯¹è±¡</li>
<li><code>titleStyle</code>-titleç»„å»ºçš„Styleå¯¹è±¡</li>
<li><code>tintColor</code>-headerçš„ç€è‰²</li>
</ul>
</li>
<li><code>cardStack</code>-card stackçš„é…ç½®å¯¹è±¡<ul>
<li><code>gesturesEnabled</code>-ä¸ç®¡ä½ æ˜¯ä¸æ˜¯ç”¨æ‰‹åŠ¿,åœ¨iOSä¸Šæ˜¯true,åœ¨androidé‡Œæ˜¯false.<h2 id="Navigator-Props"><a href="#Navigator-Props" class="headerlink" title="Navigator Props"></a>Navigator Props</h2>ç”±<code>StackNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥æ”¶ä¸¤ä¸ªprops:<br><code>screenProps</code>-å‘ä¸‹ä¼ é€’åˆ°å­screen,ä¾‹å¦‚:</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> SomeStack = StackNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;SomeStack</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><p>çœ‹çœ‹å®ä¾‹<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground/js/SimpleStack.js" target="_blank" rel="external">SimpleStack.js</a>å’Œ<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground/js/ModalStack.js" target="_blank" rel="external">ModalStack.js</a>,å¯ä»¥åœ¨æœ¬åœ°çš„<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground" target="_blank" rel="external">NavigationPlayground</a>appä¸­è¿è¡Œ.</p>
<h1 id="TabNavigator"><a href="#TabNavigator" class="headerlink" title="TabNavigator"></a>TabNavigator</h1><p>é€šå¸¸å¾ˆå®¹æ˜“ä½¿ç”¨TabRouteræ¥åˆ›å»ºæœ‰å‡ ä¸ªtabsçš„screen.<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: &#123;</div><div class="line">      label: <span class="symbol">'Hom</span>e',</div><div class="line">      <span class="comment">// Note: By default the icon is only shown on iOS. Search the showIcon option below.</span></div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./chats-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Notification</span>s')&#125;</div><div class="line">        title=<span class="string">"Go to notifications"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNotificationsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: &#123;</div><div class="line">      label: <span class="symbol">'Notification</span>s',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./notif-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.goBack()&#125;</div><div class="line">        title=<span class="string">"Go back home"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = <span class="type">StyleSheet</span>.create(&#123;</div><div class="line">  icon: &#123;</div><div class="line">    width: <span class="number">26</span>,</div><div class="line">    height: <span class="number">26</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const <span class="type">MyApp</span> = <span class="type">TabNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Notifications</span>: &#123;</div><div class="line">    screen: <span class="type">MyNotificationsScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  tabBarOptions: &#123;</div><div class="line">    activeTintColor: '#e91e63',</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="å®šä¹‰API-1"><a href="#å®šä¹‰API-1" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><p><code>TabNavigator(RouteConfigs,TabNavigator)</code></p>
<h2 id="RouteConfigs-1"><a href="#RouteConfigs-1" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>routeçš„é…ç½®å¯¹è±¡æ˜¯route nameåˆ°route configçš„æ˜ å°„(è¯‘è€…:è¿™æ‰æ˜¯é‡ç‚¹),é…ç½®å¯¹è±¡å‘Šè¯‰navigatorä»€ä¹ˆæ¥ä»£è¡¨route.</p>
<h2 id="TabNavigatorConfig"><a href="#TabNavigatorConfig" class="headerlink" title="TabNavigatorConfig"></a>TabNavigatorConfig</h2><ul>
<li><code>tabBarComponent</code>-ä½œä¸ºtab barçš„ç»„ä»¶.ä¾‹å¦‚,<code>TabView.TabBarBottom</code>(iosçš„é»˜è®¤é…ç½®),<code>TabView.TabBarTop</code>(androidçš„é»˜è®¤é…ç½®)</li>
<li><code>tabBarPosition</code>-tab barçš„ä½ç½®,å¯ä»¥æ˜¯<code>top</code>å’Œ<code>bottom</code></li>
<li><code>swipeEnabled</code>-æ˜¯å¦åœ¨tabä¹‹é—´æ»‘åŠ¨</li>
<li><code>animationEnabled</code>-å˜æ¢tabsçš„æ—¶å€™æ˜¯å¦å¼€å¯åŠ¨ç”»æ•ˆæœ</li>
<li><code>lazyLoad</code>-æ˜¯å¦åœ¨éœ€è¦çš„æ—¶å€™æ‰æƒ°æ€§åŠ è½½tabs,ä»£æ›¿é¢„æ¸²æŸ“</li>
<li><code>tabBarOption</code>-é…ç½®tab bar,çœ‹ä¸‹é¢<br>å‡ ä¸ªOptionså¯ä»¥ä¼ é€’åˆ°æ½œåœ¨çš„çš„router,ä¿®æ”¹å¯¼èˆªçš„é€»è¾‘</li>
<li><code>initialRouteName</code>-åˆå§‹åŒ–æ—¶åŠ è½½çš„tab route</li>
<li><code>order</code>-å®šä¹‰tabsé¡ºåºçš„routeNameçš„æ•°ç»„</li>
<li><code>paths</code>-æä¾›routeNameåˆ°pathé…ç½®çš„æ˜ å°„,é‡å†™routeConfigsé‡Œçš„pathsè®¾ç½®</li>
<li><code>backBehavior</code>-back buttonæ˜¯ä¸æ˜¯åº”è¯¥å¯¼è‡´tabåˆ‡æ¢åˆ°åˆå§‹çš„tabï¼Ÿå…¥å¦‚æœæ˜¯çš„è¯,è®¾å®š<code>initialRoute</code>,å¦åˆ™å°±æ˜¯<code>none</code>.é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.</li>
</ul>
<p><code>TabBarTop</code>çš„<code>tabBarOptions</code>è®¾ç½®(androidé»˜è®¤çš„tab bar)</p>
<ul>
<li><code>activeTintColor</code>-æ¿€æ´»tabçš„æ ‡ç­¾å’Œiconçš„é¢œè‰²</li>
<li><code>inactiveTintColor</code>-æœªæ¿€æ´»tabçš„æ ‡ç­¾å’Œiconçš„é¢œè‰²</li>
<li><code>showIcon</code>-æ˜¯å¦åœ¨tabä¸­æ˜¾ç¤ºicon,é»˜è®¤æ˜¯false</li>
<li><code>showLabel</code>-æ˜¯å¦åœ¨tabæ˜¾ç¤ºlabel,é»˜è®¤æ˜¯true</li>
<li><code>upperCaseLabel</code>-tabçš„labelæ˜¯å¦æ˜¯å¤§å†™,é»˜è®¤æ˜¯true</li>
<li><code>pressColor</code>-materialæ¶Ÿæ¼ªæ•ˆæœçš„é¢œè‰²(Android&gt;=5.0)</li>
<li><code>pressOpacity</code>-æŒ‰ä¸‹tabçš„é€æ˜åº¦å˜åŒ–(iOSå’ŒAndroid&lt;5.0)</li>
<li><code>scrollEnabled</code>-æ˜¯å¦æ˜¯æ»‘åŠ¨å¼tabs.</li>
<li><code>tabStyle</code>-tabçš„æ ·å¼é…ç½®å¯¹è±¡</li>
<li><code>indicatorStyle</code>-tabæŒ‡ç¤ºå™¨çš„æ ·å¼å¯¹è±¡(tabåº•éƒ¨çš„åˆ’çº¿)</li>
<li><code>labelStyle</code>-tab labelçš„æ ·å¼å¯¹è±¡</li>
<li><code>style</code>-tab barçš„æ ·å¼å¯¹è±¡</li>
</ul>
<p>å®ä¾‹:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">tabBarOptions</span>: &#123;</div><div class="line">  <span class="attribute">labelStyle</span>: &#123;</div><div class="line">    fontSize: <span class="number">12</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="selector-tag">style</span>: &#123;</div><div class="line">    <span class="attribute">backgroundColor</span>: <span class="string">'blue'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Screenå¯¼èˆªçš„é€‰é¡¹"><a href="#Screenå¯¼èˆªçš„é€‰é¡¹" class="headerlink" title="Screenå¯¼èˆªçš„é€‰é¡¹"></a>Screenå¯¼èˆªçš„é€‰é¡¹</h2><p>é€šå¸¸åœ¨screenç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.ä¾‹å¦‚:<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">class ProfileScreen extends React.Component &#123;</div><div class="line"></div><div class="line"> static navigationOptions = &#123;</div><div class="line"></div><div class="line">   title: (&#123; <span class="keyword">state</span> &#125;) =&gt; `$&#123;<span class="keyword">state</span>.params.name&#125;'s Profile!`,</div><div class="line"></div><div class="line">   tabBar: (&#123; <span class="keyword">state</span>, <span class="built_in">set</span>Params &#125;) =&gt; (&#123;</div><div class="line">     icon: (</div><div class="line">       <span class="variable">&lt;Image src=&#123;require('./my-icon.png')&#125; /&gt;</span></div><div class="line">     ),</div><div class="line">   &#125;),</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰<code>TabNavigator</code>çš„<code>navigationOption</code>:</p>
<ul>
<li><code>title</code>-sceneçš„title(å­—ç¬¦ä¸²)</li>
<li><code>tabBar</code>-tab barçš„configå¯¹è±¡:<ul>
<li><code>visible</code>-tab barçš„å¯è§æ€§çš„åˆ‡æ¢</li>
<li><code>icon</code>-Reactç»„ä»¶æˆ–è€…å‡½æ•°ç»™å‡º<code>{focused:boolean,tintColor:string}</code>,è¿”å›ä¸€ä¸ªReactç»„ä»¶,æ˜¾ç¤ºåœ¨tab bar</li>
<li><code>label</code>-æ˜¾ç¤ºåœ¨tab barä¸­çš„tabçš„åå­—.å¦‚æœå®šä¹‰ä¸ºundefined,sceneçš„<code>title</code>ä¼šè¢«ä½¿ç”¨.å¦‚æœè¦éšè—,çœ‹å‰é¢éƒ¨åˆ†çš„<code>tabBarOption.showLabel</code>.<h2 id="Navigator-Props-1"><a href="#Navigator-Props-1" class="headerlink" title="Navigator Props"></a>Navigator Props</h2>ç”±<code>TabNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥æ”¶ä¸‹é¢çš„props:</li>
</ul>
</li>
<li><code>screenProps</code>-å‘ä¸‹ä¼ é€’é¢å¤–çš„optionsç»™å­screen,ä¾‹å¦‚:</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> TabNav = TabNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;TabNav</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h1 id="æŠ½å±‰å¼å¯¼èˆª"><a href="#æŠ½å±‰å¼å¯¼èˆª" class="headerlink" title="æŠ½å±‰å¼å¯¼èˆª"></a>æŠ½å±‰å¼å¯¼èˆª</h1><p>ç”¨æ¥æ„å»ºæŠ½å±‰å¼å¯¼èˆª<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    drawer: () =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Hom</span>e',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./chats-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Notification</span>s')&#125;</div><div class="line">        title=<span class="string">"Go to notifications"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNotificationsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    drawer: () =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Notification</span>s',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./notif-icon.png')&#125;</div><div class="line">          style=&#123;[styles.tabIcon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.goBack()&#125;</div><div class="line">        title=<span class="string">"Go back home"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = <span class="type">StyleSheet</span>.create(&#123;</div><div class="line">  icon: &#123;</div><div class="line">    width: <span class="number">24</span>,</div><div class="line">    height: <span class="number">24</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const <span class="type">MyApp</span> = <span class="type">DrawerNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Notifications</span>: &#123;</div><div class="line">    screen: <span class="type">MyNotificationsScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ‰“å¼€æŠ½å±‰æˆ–è€…å…³é—­æŠ½å±‰,åˆ†åˆ«å¯¼èˆªåˆ°<code>DrawerOpen</code>å’Œ<code>Drawerclose</code>.<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerOpen'</span>); <span class="comment">// open drawer</span></div><div class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerClose'</span>); <span class="comment">// close drawer</span></div></pre></td></tr></table></figure></p>
<h2 id="å®šä¹‰API-2"><a href="#å®šä¹‰API-2" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">DrawerNavigator</span><span class="params">(RouteConfigs, DrawerNavigatorConfig)</span></span></div></pre></td></tr></table></figure>
<h2 id="RouteConfigs-2"><a href="#RouteConfigs-2" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>å‚çœ‹å‰é¢çš„å†…å®¹</p>
<h2 id="DrawerNavigatonConfig"><a href="#DrawerNavigatonConfig" class="headerlink" title="DrawerNavigatonConfig"></a>DrawerNavigatonConfig</h2><ul>
<li><code>drawerWidth</code>-æŠ½å±‰çš„å®½åº¦</li>
<li><code>drawerPosition</code>-é€‰é¡¹æ˜¯<code>left</code>å’Œ<code>right</code>.é»˜è®¤æ˜¯<code>left</code>.</li>
<li><code>contentComponent</code>-ç”¨æ¥æ¸²æŸ“æŠ½å±‰å†…å®¹çš„ç»„ä»¶,ä¾‹å¦‚,navigation item.æ¥æ”¶<code>navigation</code>prop.é»˜è®¤æ˜¯<code>DrawerView.Items</code>.äº†è§£æ›´å¤šå†…å®¹çœ‹ä¸‹é¢å†…å®¹.</li>
<li><code>contentOptions</code>-é…ç½®drawerçš„å†…å®¹,çœ‹ä¸‹é¢å†…å®¹<br>å‡ ä¸ªé€‰é¡¹ä¼ é€’ç»™æ½œåœ¨çš„router,ç”¨æ¥ä¿®æ”¹navigationçš„é€»è¾‘:</li>
<li><code>initialRouteName</code>-åˆå§‹åŒ–routeçš„routeName</li>
<li><code>order</code>-å®šä¹‰drawer itemé¡ºåºçš„routeNameæ•°ç»„</li>
<li><code>path</code>-æä¾›ä¸€ä¸ªrouteNameåˆ°path configçš„æ˜ å°„,é‡å†™æ‰routeConfigsä¸­çš„pathé…ç½®</li>
<li><code>backBehavior</code>-backæŒ‰é’®ä¸€å®šè¦è¿”å›åˆ°åˆå§‹åŒ–çš„routeå—ï¼Ÿå¦‚æœæ˜¯çš„è¯,è®¾ç½®åˆ°<code>initialRoute</code>,å¦åˆ™å°±ç”¨<code>none</code>.é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.<h2 id="æä¾›å®šåˆ¶åŒ–çš„contentComponent"><a href="#æä¾›å®šåˆ¶åŒ–çš„contentComponent" class="headerlink" title="æä¾›å®šåˆ¶åŒ–çš„contentComponent"></a>æä¾›å®šåˆ¶åŒ–çš„<em>contentComponent</em></h2>å¯ä»¥ä½¿ç”¨<code>react-navigation</code>é‡å†™é»˜è®¤çš„ç»„ä»¶.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> CustomDrawerContentComponent = <span class="function">(<span class="params">props</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;style.container&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">DrawerView.Items</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">);</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  container : &#123;</div><div class="line">    flex : 1,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>DrawerView.Item</code>çš„<code>contentOptions</code>é…ç½®</p>
<ul>
<li><code>activeTintColor</code>-æ¿€æ´»çš„æ ‡ç­¾çš„labelå’Œiconçš„é¢œè‰²</li>
<li><code>activeBackgroundColor</code>-æ¿€æ´»çš„æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</li>
<li><code>inactiveTintColor</code>-æœªæ¿€æ´»çš„æ ‡ç­¾çš„labelå’Œiconçš„é¢œè‰²</li>
<li><code>inactiveBackgroundColor</code>-æœªæ¿€æ´»çš„æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</li>
<li><code>style</code>-å†…å®¹éƒ¨åˆ†çš„æ ·å¼å¯¹è±¡</li>
</ul>
<p>ç¤ºä¾‹:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">contentOptions</span>: &#123;</div><div class="line">  <span class="attribute">activeTintColor</span>: <span class="string">'#e91e63'</span>,</div><div class="line">  style: &#123;</div><div class="line">    marginVertical: <span class="number">0</span>,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Screenå¯¼èˆªçš„é€‰é¡¹-1"><a href="#Screenå¯¼èˆªçš„é€‰é¡¹-1" class="headerlink" title="Screenå¯¼èˆªçš„é€‰é¡¹"></a>Screenå¯¼èˆªçš„é€‰é¡¹</h2><p>é€šå¸¸åœ¨ç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line"> static navigationOptions = &#123;</div><div class="line"></div><div class="line">   title: (&#123; state &#125;) =&gt; `$&#123;state.params.name&#125;<span class="symbol">'s</span> <span class="type">Profile</span>!`,</div><div class="line"></div><div class="line">   drawer: &#123;</div><div class="line">     icon: (</div><div class="line">       &lt;<span class="type">Image</span> src=&#123;require('./my-icon.png')&#125; /&gt;</div><div class="line">     ),</div><div class="line">   &#125;,</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰çš„<code>DrawerNavigation</code> <code>navigationOption</code>é…ç½®é¡¹</p>
<ul>
<li><code>title</code>-sceneçš„æ ‡é¢˜</li>
<li><code>drawer</code>-drawerçš„é…ç½®å¯¹è±¡<ul>
<li><code>label</code>-å­—ç¬¦ä¸²,Reactç»„ä»¶æˆ–è€…å‡½æ•°è¢«è®¾å®š<code>{fcoused:boolean,tinColor:string}</code>è¿”å›ä¸€ä¸ªReactç»„ä»¶,æ˜¾ç¤ºåœ¨drawerçš„è¾¹æ ä¸Š.å½“labelå®šä¹‰ä¸ºundefinedæ—¶,sceneçš„``titleè¢«ä½¿ç”¨.</li>
<li><code>icon</code>-Reactç»„ä»¶æˆ–è€…å‡½æ•°è¢«è®¾å®šä¸º<code>{fcoused:boolean,tintColor:string}</code>è¿”å›ä¸€ä¸ªReactå…ƒç´ ,æ˜¾ç¤ºåœ¨drawerçš„è¾¹æ ä¸Š.</li>
</ul>
</li>
</ul>
<h2 id="Navigator-çš„Props"><a href="#Navigator-çš„Props" class="headerlink" title="Navigator çš„Props"></a>Navigator çš„Props</h2><p>ç”±<code>DrawerNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥å—ä¸‹é¢çš„props:</p>
<ul>
<li><code>screenProps</code>-å‘ä¸‹ä¼ é€’é¢å¤–çš„optionsåˆ°å­screen,ä¾‹å¦‚:</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> DrawerNav = DrawerNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;DrawerNav</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h1 id="Screen-Navigation-Prop"><a href="#Screen-Navigation-Prop" class="headerlink" title="Screen Navigation Prop"></a>Screen Navigation Prop</h1><p>appä¸­çš„æ¯ä¸ªscreenéƒ½æ¥æ”¶navigation prop åŒ…å«ä¸‹é¢çš„å†…å®¹:</p>
<ul>
<li><code>navigate</code>-(helper)é“¾æ¥çš„å…¶ä»–çš„screens</li>
<li><code>state</code>-screençš„å½“å‰stateå’Œroutes</li>
<li><code>setParam</code>-(helper)æ”¹å˜routeçš„å‚æ•°</li>
<li><code>goBack</code>-(helper)å…³é—­æ¿€æ´»çš„screenå¹¶ä¸”è¿”å›</li>
<li><code>dispatch</code>-å‘é€ä¸€ä¸ªactionåˆ°router</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Navigators&quot;&gt;&lt;a href=&quot;#Navigators&quot; class=&quot;headerlink&quot; title=&quot;Navigators&quot;&gt;&lt;/a&gt;Navigators&lt;/h1&gt;&lt;p&gt;Navigatorså…è®¸ä½ å®šä¹‰ä½ çš„å¯¼èˆªç»“æ„.Navigatorsä¹Ÿå¯ä»¥æ¸²æŸ“æ™®
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="https://phpsmarter.github.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-native" scheme="https://phpsmarter.github.com/tags/React-native/"/>
    
  </entry>
  
</feed>
