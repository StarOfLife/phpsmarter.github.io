<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>phpsmarter</title>
  <subtitle>A beginner of React-native</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-04-06T08:47:57.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>phpsmarter</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼,è¿”ç’å½’çœŸF8(2)</title>
    <link href="http://yoursite.com/2017/04/06/%E4%B9%B1%E8%8A%B1%E6%B8%90%E6%AC%B2%E8%BF%B7%E4%BA%BA%E7%9C%BC-%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9FF8-2/"/>
    <id>http://yoursite.com/2017/04/06/ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼-è¿”ç’å½’çœŸF8-2/</id>
    <published>2017-04-06T10:45:08.000Z</published>
    <updated>2017-04-06T08:47:57.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…¥å£å’Œé…ç½®æ–‡ä»¶"><a href="#å…¥å£å’Œé…ç½®æ–‡ä»¶" class="headerlink" title="å…¥å£å’Œé…ç½®æ–‡ä»¶"></a>å…¥å£å’Œé…ç½®æ–‡ä»¶</h1><h2 id="F8APP-js-setup-jsæ–‡ä»¶"><a href="#F8APP-js-setup-jsæ–‡ä»¶" class="headerlink" title="./F8APP/js/setup.jsæ–‡ä»¶"></a>./F8APP/js/setup.jsæ–‡ä»¶</h2><blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ä»index.ios.jsæ–‡ä»¶é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°äº†<code>setup.js</code>æ–‡ä»¶<br><code>./F8APP/js/setup.js</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> F8App = <span class="built_in">require</span>(<span class="string">'F8App'</span>);<span class="comment">//ä¸»ç¨‹åºæ–‡ä»¶çš„å…¥å£</span></div><div class="line"><span class="keyword">var</span> FacebookSDK = <span class="built_in">require</span>(<span class="string">'FacebookSDK'</span>);<span class="comment">//å¤„ç†facebookç™»å½•å’Œå¥½å‹çš„API</span></div><div class="line"><span class="keyword">var</span> Parse = <span class="built_in">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//parseçš„å®¢æˆ·ç«¯</span></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</div><div class="line"><span class="keyword">var</span> Relay = <span class="built_in">require</span>(<span class="string">'react-relay'</span>);<span class="comment">//reactç¨‹åºçš„ç»„ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨Relayçš„æ•°æ®å±‚,è¿™ä¸ªåœ¨infoè¿™ä¸ªç»„ä»¶ä¸­ä½¿ç”¨</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; Provider &#125; = <span class="built_in">require</span>(<span class="string">'react-redux'</span>);<span class="comment">//Reduxçš„åŒ…è£…å™¨</span></div><div class="line"><span class="keyword">var</span> configureStore = <span class="built_in">require</span>(<span class="string">'./store/configureStore'</span>);<span class="comment">//store</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;serverURL&#125; = <span class="built_in">require</span>(<span class="string">'./env'</span>);<span class="comment">//ç¯å¢ƒé…ç½®ï¼Œæ˜¯parseseverçš„é…ç½®åœ°å€</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setup</span>(<span class="params"></span>): <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="built_in">console</span>.disableYellowBox = <span class="literal">true</span>;</div><div class="line">  <span class="comment">//parseServeråé¢ä¼šç»“åˆleancloudæ¥çœ‹çœ‹ä»£ç ,ä¸¤è€…çš„APIæ˜¯ä¸€æ ·çš„</span></div><div class="line">  Parse.initialize(<span class="string">'oss-f8-app-2016'</span>);<span class="comment">//åˆå§‹åŒ–ä¸€ä¸ªparse</span></div><div class="line">  Parse.serverURL = <span class="string">`<span class="subst">$&#123;serverURL&#125;</span>/parse`</span>;<span class="comment">//parseçš„urlåœ°å€</span></div><div class="line"></div><div class="line">  FacebookSDK.init();<span class="comment">//åˆå§‹åŒ–Facebookçš„é…ç½®</span></div><div class="line">  Parse.FacebookUtils.init();</div><div class="line">  Relay.injectNetworkLayer(<span class="comment">//Realyæ•°æ®å±‚çš„é…ç½®</span></div><div class="line">    <span class="keyword">new</span> Relay.DefaultNetworkLayer(<span class="string">`<span class="subst">$&#123;serverURL&#125;</span>/graphql`</span>, &#123;</div><div class="line">      <span class="attr">fetchTimeout</span>: <span class="number">30000</span>,</div><div class="line">      <span class="attr">retryDelays</span>: [<span class="number">5000</span>, <span class="number">10000</span>],</div><div class="line">    &#125;)</div><div class="line">  );</div><div class="line"></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Root</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">      <span class="keyword">super</span>();</div><div class="line">      <span class="keyword">this</span>.state = &#123;<span class="comment">//åˆå§‹åŒ–state</span></div><div class="line">        isLoading: <span class="literal">true</span>,</div><div class="line">        <span class="attr">store</span>: configureStore(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123;<span class="attr">isLoading</span>: <span class="literal">false</span>&#125;)),</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.state.isLoading) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> (<span class="comment">//æ³¨å…¥storeç»™uiç»„ä»¶ä½¿ç”¨</span></div><div class="line">        &lt;Provider store=&#123;<span class="keyword">this</span>.state.store&#125;&gt;</div><div class="line">          <span class="xml"><span class="tag">&lt;<span class="name">F8App</span> /&gt;</span></span></div><div class="line">        <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Root;</div><div class="line">&#125;</div><div class="line"></div><div class="line">global.LOG = <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'/------------------------------\\'</span>);</div><div class="line">  <span class="built_in">console</span>.log(...args);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'\\------------------------------/'</span>);</div><div class="line">  <span class="keyword">return</span> args[args.length - <span class="number">1</span>];</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = setup;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–‡ä»¶åœ¨å»å¹´é˜…è¯»çš„æ—¶å€™ç›´æ¥å¿½ç•¥äº†.æœ€è¿‘ç ”ç©¶äº†parseServerçš„æœ¬åœ°éƒ¨ç½²å’Œç›¸å…³çš„graphqlçš„ä½¿ç”¨ä»¥åŠleancloudçš„ä½¿ç”¨,æ‰å‘ç°è¿™ä¸ªéƒ¨åˆ†çœŸçš„æ˜¯éå¸¸ä¾¿åˆ©.åªè¦æ˜¯æœ‰äº†æ•°æ®å¯¹è±¡æœ€å¥½è¿˜èƒ½æœ‰schema,model.åå°åŸºæœ¬éƒ½ä¸éœ€è¦äº†.å½“ç„¶ä¸å¯èƒ½æ˜¯å®Œå…¨æ›¿ä»£æœåŠ¡å™¨çš„æ‰€æœ‰åŠŸèƒ½.è¿™ä¸ªåˆ°äº†ç›¸åº”çš„åœ°æ–¹å†è¯´.</p>
<p>æ¥ä¸‹æ¥æ˜¯F8APPçš„å…¥å£æ–‡ä»¶</p>
<h2 id="F8APP-js-F8App-js"><a href="#F8APP-js-F8App-js" class="headerlink" title="./F8APP/js/F8App.js"></a>./F8APP/js/F8App.js</h2><p><code>./F8APP/js/F8App.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> </span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'React'</span>);</div><div class="line"><span class="keyword">var</span> AppState = <span class="built_in">require</span>(<span class="string">'AppState'</span>);</div><div class="line"><span class="keyword">var</span> LoginScreen = <span class="built_in">require</span>(<span class="string">'./login/LoginScreen'</span>);<span class="comment">//ç™»å½•ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> PushNotificationsController = <span class="built_in">require</span>(<span class="string">'./PushNotificationsController'</span>);<span class="comment">//æ¨é€ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> StyleSheet = <span class="built_in">require</span>(<span class="string">'StyleSheet'</span>);</div><div class="line"><span class="keyword">var</span> F8Navigator = <span class="built_in">require</span>(<span class="string">'F8Navigator'</span>);<span class="comment">//å¯¼èˆªç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> CodePush = <span class="built_in">require</span>(<span class="string">'react-native-code-push'</span>);<span class="comment">//çƒ­æ›´æ–°ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> View = <span class="built_in">require</span>(<span class="string">'View'</span>);</div><div class="line"><span class="keyword">var</span> StatusBar = <span class="built_in">require</span>(<span class="string">'StatusBar'</span>);<span class="comment">//çŠ¶æ€æ ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> &#123;<span class="comment">//è¿™é‡Œçš„æ¯ä¸€actionæœ€ç»ˆéƒ½ä¼šå½¢æˆstateè¿™æ£µæ ‘ä¸‹çš„æ¬¡çº§åˆ†æ</span></div><div class="line">  <span class="comment">//åå­—éƒ½éå¸¸çš„é†’ç›®å’Œç›´æ¥,æˆ‘ä»¬å¯ä»¥ç›´æ¥å…ˆçœ‹actionå’Œreduceréƒ½å¹²äº†äº›ä»€ä¹ˆå·¥ä½œ</span></div><div class="line">  loadConfig,</div><div class="line">  loadMaps,</div><div class="line">  loadNotifications,</div><div class="line">  loadSessions,</div><div class="line">  loadFriendsSchedules,</div><div class="line">  loadSurveys,</div><div class="line">&#125; = <span class="built_in">require</span>(<span class="string">'./actions'</span>);<span class="comment">//åŠ è½½åˆå§‹åŒ–é…ç½®çš„action</span></div><div class="line"><span class="comment">//è¿™ä¸ªåœ°æ–¹çš„åˆå§‹åŒ–çš„ä¸€äº›stateæ˜¯åœ¨è¿™é‡ŒåŠ è½½çš„,å¯¹æ¯”ireadingè½¯ä»¶çš„//å†…å®¹åŠ è½½æ˜¯åœ¨ç»„ä»¶ä¸­çš„componentdidMountåŠ è½½çš„,æ”¾åœ¨è¿™é‡Œæ€§èƒ½æ˜¯ä¸//æ˜¯æœ‰äº›ä¼˜åŒ–,</span></div><div class="line"><span class="keyword">var</span> &#123; updateInstallation &#125; = <span class="built_in">require</span>(<span class="string">'./actions/installation'</span>);</div><div class="line"><span class="keyword">var</span> &#123; connect &#125; = <span class="built_in">require</span>(<span class="string">'react-redux'</span>);<span class="comment">//connectå‡½æ•°</span></div><div class="line"><span class="comment">//æ²¡æƒ³åˆ°åœ¨è¿™é‡Œä¹Ÿæ˜¯å¯ä»¥ç”¨çš„,åœ¨f8appä¸­é‚£ä¸ªç»„ä»¶è¦ä½¿ç”¨stateå’Œdispatchå°±åœ¨å“ªé‡Œå¯¼å…¥connectå‡½æ•°.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">'./env.js'</span>);<span class="comment">//è·å–å½“å‰ç‰ˆæœ¬å·ç </span></div><div class="line"></div><div class="line"><span class="keyword">var</span> F8App = React.createClass(&#123;</div><div class="line">  <span class="attr">componentDidMount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="comment">//ç›‘å¬changeäº‹ä»¶</span></div><div class="line">    AppState.addEventListener(<span class="string">'change'</span>, <span class="keyword">this</span>.handleAppStateChange);</div><div class="line"></div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> Make this list smaller, we basically download the whole internet</span></div><div class="line">    <span class="comment">//è¿™ä¸ªåœ°æ–¹åœ¨å…ˆäºUIç»„ä»¶ä¹‹å‰åŠ è½½äº†æ‰€æœ‰çš„stateï¼Œ</span></div><div class="line">    <span class="comment">//æ ¹æ®UIå¯¼èˆªçš„é»˜è®¤é¡¹æ˜¯sessionï¼Œæˆ‘è§‰å¾—è¿™é‡Œå¯ä»¥å…ˆåŠ è½½//sessionè¿™ä¸ªstateï¼Œåœ¨é¦–é¡µåŠ è½½çš„æ—¶å€™é€Ÿåº¦å°±å¿«äº†,å…¶ä»–çš„//stateåœ¨åˆ‡æ¢åˆ°éœ€è¦æŸéƒ¨åˆ†çš„stateçš„æ—¶å€™åœ¨åŠ è½½</span></div><div class="line">    <span class="comment">//æ˜¯ä¸æ˜¯æƒ°æ€§åŠ è½½çš„æ„æ€ï¼Ÿ</span></div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadNotifications());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadMaps());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadConfig());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadSessions());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadFriendsSchedules());</div><div class="line">    <span class="keyword">this</span>.props.dispatch(loadSurveys());</div><div class="line"></div><div class="line">    updateInstallation(&#123;version&#125;);<span class="comment">//çƒ­æ›´æ–°ç‰ˆæœ¬.</span></div><div class="line">    CodePush.sync(&#123;<span class="attr">installMode</span>: CodePush.InstallMode.ON_NEXT_RESUME&#125;);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">componentWillUnmount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="comment">//ç§»é™¤changeäº‹ä»¶</span></div><div class="line">    AppState.removeEventListener(<span class="string">'change'</span>, <span class="keyword">this</span>.handleAppStateChange);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">handleAppStateChange</span>: <span class="function"><span class="keyword">function</span>(<span class="params">appState</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (appState === <span class="string">'active'</span>) &#123;<span class="comment">//åœ¨çº¿å°±åˆ†å‘åŠ¨ä½œ</span></div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadSessions());</div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadNotifications());</div><div class="line">      <span class="keyword">this</span>.props.dispatch(loadSurveys());</div><div class="line">      CodePush.sync(&#123;<span class="attr">installMode</span>: CodePush.InstallMode.ON_NEXT_RESUME&#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//ä¸‹é¢è¿™ä¸ªåœ°æ–¹å¯¹äºåˆå­¦reduxçš„å°±æœ‰ç‚¹ç»•äº†</span></div><div class="line">    <span class="comment">//åœ¨reducer/user.jsä¸­å®šä¹‰äº†åˆå§‹åŒ–çš„state,isLoggedIn</span></div><div class="line">    <span class="comment">//å°±æ˜¯falseï¼Œæ‰€ä»¥åˆæ¬¡åŠ è½½çš„æ—¶å€™å°±ä¼šæ˜¾ç¤ºç™»å½•æŒ‰é’®äº†</span></div><div class="line">    <span class="comment">//å¦‚æœç™»å½•äº†ä»¥åæ ¹æ®ç™»å½•å›è°ƒå‡½æ•°çš„è¿”å›å€¼æ¥ä¿®æ”¹isLoggedInçš„stateä¸º//trueï¼ŒåŒæ—¶ç”±äºè¿˜ä½¿ç”¨äº†redux-presistçš„ç»„ä»¶æŒä¹…åŒ–stateï¼Œåœ¨ä¸‹ä¸€//æ¬¡æ‰“å¼€çš„æ—¶å€™å°±ä¸ä¼šæ˜¾ç¤ºç™»å½•æŒ‰é’®äº†</span></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.props.isLoggedIn) &#123;</div><div class="line">      <span class="keyword">return</span> &lt;LoginScreen /&gt;;</div><div class="line">    &#125;</div><div class="line">    return (//å¦‚æœå·²ç»ç™»å½•è¿‡å°±ç›´æ¥æ˜¾ç¤ºå¯¼èˆªç•Œé¢äº†.</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;StatusBar</div><div class="line">          translucent=&#123;true&#125;</div><div class="line">          backgroundColor="rgba(0, 0, 0, 0.2)"</div><div class="line">          barStyle="light-content"</div><div class="line">         /&gt;</div><div class="line">        &lt;F8Navigator /&gt;</div><div class="line">        &lt;PushNotificationsController /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">var styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: 1,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">function select(store) &#123;//è¿™é‡Œåªéœ€è¦è·å–æ˜¯å¦ç™»å½•çš„stateå°±å¯ä»¥äº†</div><div class="line">  //selectå‡½æ•°æˆªå–å’Œæ˜ å°„ç»„ä»¶éœ€è¦çš„é‚£éƒ¨åˆ†stateï¼Œè¿™å’Œæ•°æ®åº“æ˜¯ä¸€æ ·çš„</div><div class="line">  //select * from è·å–æ‰€æœ‰çš„æ•°æ®, åŠ äº†whereæ¡ä»¶å°±ä¼šè¿”å›ä¸€éƒ¨åˆ†æ•°æ®</div><div class="line">  return &#123;</div><div class="line">    isLoggedIn: store.user.isLoggedIn || store.user.hasSkippedLogin,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">module.exports = connect(select)(F8App);</div></pre></td></tr></table></figure>
<h2 id="connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™"><a href="#connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™" class="headerlink" title="connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™"></a>connectæ–‡ä»¶çš„æºç çš„ä¸€ç‚¹ç ”ç©¶-å‡½æ•°å¼ç¼–ç¨‹çš„å¯è’™</h2><p>å¦‚æœä½ å¯¹äºreact-reduxæœ‰äº†ä¸€å®šäº†è§£,ä¼šåœ¨connect()ä¸­æ‰¾dispatchåœ¨å“ªé‡Œï¼Ÿå®é™…ä¸Šå¦‚æœæ²¡æœ‰<code>mapDiaptchToProps</code>ä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„,åœ¨<code>node_modules/react-redux/commponents/connect.js</code><br><code>connect.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//éƒ¨åˆ†ä»£ç </span></div><div class="line"> <span class="keyword">const</span> defaultMapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> (&#123; dispatch &#125;)<span class="comment">//ä¸ä¼ é€’ä¹Ÿæ˜¯å¯ä»¥çš„</span></div><div class="line"> </div><div class="line"> <span class="keyword">let</span> mapDispatch</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> mapDispatchToProps === <span class="string">'function'</span>) &#123;</div><div class="line">    mapDispatch = mapDispatchToProps</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!mapDispatchToProps) &#123;<span class="comment">//å¦‚æœæ²¡ä¼ dispatchå‡½æ•°</span></div><div class="line">  <span class="comment">//å°±æ˜¯é»˜è®¤çš„å‚æ•°,è¿˜æ˜¯dispatch</span></div><div class="line">    mapDispatch = defaultMapDispatchToProps</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    mapDispatch = wrapActionCreators(mapDispatchToProps)</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>å…¥å£æ–‡ä»¶å’Œåˆå§‹åŒ–é…ç½®å’ŒåŠ è½½é¡¹å°±çœ‹è¿™ä¹ˆå¤š,ä¸‹é¢æˆ‘ä»¬ç›´æ¥å…ˆè·³åˆ°reducerç›®å½•<br>çœ‹çœ‹æ•°æ®stateæ˜¯æ€ä¹ˆç»„ç»‡çš„.</p>
<h1 id="Reduceræ–‡ä»¶å¤¹çš„å†…å®¹"><a href="#Reduceræ–‡ä»¶å¤¹çš„å†…å®¹" class="headerlink" title="Reduceræ–‡ä»¶å¤¹çš„å†…å®¹"></a>Reduceræ–‡ä»¶å¤¹çš„å†…å®¹</h1><p>å›¾ç‰‡2 reducerçš„ç»“æ„ç›®å½•<br>é™¤äº†æµ‹è¯•æ–‡ä»¶å¤¹å’Œå‡æ•°æ®æ–‡ä»¶å¤¹å’ŒcreateParseReducer.jsæ–‡ä»¶,å…¶ä»–çš„æ–‡ä»¶éƒ½å¯¼å…¥åˆ°index.jsæ–‡ä»¶</p>
<h2 id="F8App-reducers-index-js"><a href="#F8App-reducers-index-js" class="headerlink" title="./F8App/reducers/index.js"></a><code>./F8App/reducers/index.js</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; combineReducers &#125; = <span class="built_in">require</span>(<span class="string">'redux'</span>);</div><div class="line"><span class="comment">//æ¯ä¸ªå¯¼å…¥çš„æ–‡ä»¶éƒ½æ˜¯å¯¹è±¡,combinReducerså‡½æ•°è´Ÿè´£æŠŠå°å¯¹è±¡åˆæˆä¸€ä¸ªå¤§çš„å•ä¸€å¯¹è±¡.</span></div><div class="line"><span class="comment">//å¦‚æœæ˜¯å¤šäººå¼€å‘æˆ‘è§‰å¾—å¯ä»¥æ¯ä¸ªå¼€å‘è€…ï¼šä¸€ä¸ªç»„ä»¶-ä¸€ç»„ç›¸å…³çš„actions-</span></div><div class="line"><span class="comment">//-ä¸€ä¸ªå•ä¸€çš„reducer,å¦‚æœæ¯”å–»çš„è¯åƒæ˜¯ä¸€æ ¹ç²—ç»³å­,å®é™…æ˜¯æœ‰å°è‚¡çš„ç»³å­æ‹§åœ¨//ä¸€èµ·å½¢æˆçš„,å„è‡ªåœ¨å‡ºåŠ›,æ—è¾¹çš„å°è‚¡å¦‚æœå‡ºé—®é¢˜äº†ä¸å½±å“å…¶ä»–éƒ¨åˆ†.</span></div><div class="line"><span class="built_in">module</span>.exports = combineReducers(&#123;</div><div class="line">  <span class="attr">config</span>: <span class="built_in">require</span>(<span class="string">'./config'</span>),</div><div class="line">  <span class="attr">notifications</span>: <span class="built_in">require</span>(<span class="string">'./notifications'</span>),</div><div class="line">  <span class="attr">maps</span>: <span class="built_in">require</span>(<span class="string">'./maps'</span>),</div><div class="line">  <span class="attr">sessions</span>: <span class="built_in">require</span>(<span class="string">'./sessions'</span>),</div><div class="line">  <span class="attr">user</span>: <span class="built_in">require</span>(<span class="string">'./user'</span>),</div><div class="line">  <span class="attr">schedule</span>: <span class="built_in">require</span>(<span class="string">'./schedule'</span>),</div><div class="line">  <span class="attr">topics</span>: <span class="built_in">require</span>(<span class="string">'./topics'</span>),</div><div class="line">  <span class="attr">filter</span>: <span class="built_in">require</span>(<span class="string">'./filter'</span>),</div><div class="line">  <span class="attr">navigation</span>: <span class="built_in">require</span>(<span class="string">'./navigation'</span>),</div><div class="line">  <span class="attr">friendsSchedules</span>: <span class="built_in">require</span>(<span class="string">'./friendsSchedules'</span>),</div><div class="line">  <span class="attr">surveys</span>: <span class="built_in">require</span>(<span class="string">'./surveys'</span>),</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//ç°åœ¨åœ¨æˆ‘çœ¼é‡Œï¼Œindex.jså°±æ˜¯ä¸€ä¸ªæ•°æ®åº“,å…¶ä¸­çš„æ¯ä¸€ä¸ªreducerå°±æ˜¯ä¸€å¼ ã€æ•°</span></div><div class="line"><span class="comment">//æ®è¡¨,è¿™ä¹ˆæ¯”å–»æˆ‘è§‰å¾—è¿˜æ˜¯å¯ä»¥æ¥å—çš„,æœ‰åŠ©äºæ¦‚å¿µçš„ç†è§£</span></div></pre></td></tr></table></figure>
<ul>
<li>åœ¨æ•°æ®åº“ä¸­æ•°æ®åº“çš„åå­—åªæ˜¯ä¸€ä¸ªæ ‡ç¤º,çœŸæ­£å®ç°å…·ä½“å†…å®¹çš„æ˜¯æ¯å¼ è¡¨çš„å†…å®¹,æ‰€ä»¥è¦å…·ä½“çœ‹çœ‹æ¯ä¸ª<code>è¡¨(state)</code>éƒ½æ˜¯æœ‰å“ªäº›å†…å®¹.çŸ¥é“äº†è¡¨é‡Œçš„å†…å®¹,å°±å¯ä»¥ç›¸åº”çš„ç†è§£å¯¹äºè¡¨çš„æ“ä½œæ–¹æ³•(action).</li>
<li><p>combinReducersçš„æºç å®é™…å°±æ˜¯åˆå¹¶å¯¹è±¡çš„,å¦‚æœæ˜¯ç®€å•çš„å¯¹è±¡è¿˜å¥½å¤„ç†ï¼Œå¤æ‚åœ¨ä¸Šé¢çš„<code>æ¯ä¸€ä¸ªreducer</code>å®é™…è¿˜å¯ä»¥åˆå¹¶<code>æ›´å°çš„reducer</code>,è¿™å¯¹äºå¤§å‹é¡¹ç›®çš„stateç»“æ„æœ‰å¥½å¤„,ä½†æ˜¯æºç ä¸å¤ªå¥½ç†è§£,æˆ‘æ²¡ææ‡‚,è€Œä¸”æ›´å¤§å‹çš„stateçš„ç»„ç»‡å½¢å¼è¿˜æ²¡æœ‰çœ‹åˆ°é‚£ä¸ªæºç ä½¿ç”¨,åŠè·¯å‡ºå®¶çš„åŸºç¡€è–„å¼±,è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹å…ä¸ºå…¶éš¾äº†,ä¸è¿‡æ€ä¹ˆåšåº”è¯¥æ˜¯å¾ˆå¥½æ“ä½œçš„.ä»¥ååŠªåŠ›ç†Ÿæ‚‰è¿™ä¸ªæ–¹é¢çš„å†…å®¹.è¿™ä¸ªæ˜¯stateçš„ç»„ç»‡å½¢å¼.åœ¨reduxå’Œreact-reduxä¸­åˆ°å¤„å¼¥æ¼«ç€å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³,å¯æƒœé“è¡Œä¸æ·±,æ— æ³•å®Œå…¨ç†è§£.ç•™å¾…æ—¥åå†è¯´O(âˆ©_âˆ©)O~.</p>
</li>
<li><p>å•ç‹¬çœ‹æ¯ä¸ªå¯¼å…¥çš„reducerå°±æ¶‰åŠåˆ°äº†å…·ä½“çš„é€»è¾‘äº†.è¿™éƒ¨åˆ†çš„reducerçš„æ–‡ä»¶åå’Œactionä¸­çš„æ–‡ä»¶åæ˜¯å¯¹åº”çš„.æ‰€ä»¥åœ¨çœ‹è¿™éƒ¨åˆ†çš„æ—¶å€™è¦ä¸¤ä¸ªæ–‡ä»¶ä¸€èµ·æ‰“å¼€çœ‹.æˆ‘åœ¨macä¸Šä½¿ç”¨äº†sizeUPè½¯ä»¶,ç‚¹å‡»ä¸¤ä¸ªæ–‡ä»¶ä»¥å,é€‰leftæˆ–è€…rightå°±å¯ä»¥æŠŠä¸¤ä¸ªæ–‡ä»¶è§†å›¾å¹³åˆ†åˆ°å±å¹•ä¸Š,ä¸ç”¨æ‰‹åŠ¨å»æ‹‰è§†çª—å¤§å°,éå¸¸æ–¹ä¾¿.</p>
</li>
</ul>
<h1 id="actionå’Œreduceré…å¯¹å‡ºç°"><a href="#actionå’Œreduceré…å¯¹å‡ºç°" class="headerlink" title="actionå’Œreduceré…å¯¹å‡ºç°"></a>actionå’Œreduceré…å¯¹å‡ºç°</h1><h2 id="login-js-actionå’Œuser-js-reducer"><a href="#login-js-actionå’Œuser-js-reducer" class="headerlink" title="login.js actionå’Œuser.js reducer"></a>login.js actionå’Œuser.js reducer</h2><p><code>user.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta"> 'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> type &#123;Action&#125; <span class="keyword">from</span> <span class="string">'../actions/types'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> type State = &#123;<span class="comment">//ç±»å‹çº¦æŸ</span></div><div class="line">  isLoggedIn: boolean;</div><div class="line">  hasSkippedLogin: boolean;</div><div class="line">  sharedSchedule: ?boolean;</div><div class="line">  id: ?string;</div><div class="line">  name: ?string;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = &#123;<span class="comment">//åˆå§‹åŒ–çš„state</span></div><div class="line">  isLoggedIn: <span class="literal">false</span>,</div><div class="line">  <span class="attr">hasSkippedLogin</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">sharedSchedule</span>: <span class="literal">null</span>,</div><div class="line">  <span class="attr">id</span>: <span class="literal">null</span>,</div><div class="line">  <span class="attr">name</span>: <span class="literal">null</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">user</span>(<span class="params">state: State = initialState, action: Action</span>): <span class="title">State</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'LOGGED_IN'</span>) &#123;å¤„ç†ç™»å½•çš„action</div><div class="line">    <span class="comment">//è·å–actionçš„è´Ÿè½½å†…å®¹</span></div><div class="line">    <span class="keyword">let</span> &#123;id, name, sharedSchedule&#125; = action.data;</div><div class="line">    <span class="keyword">if</span> (sharedSchedule === <span class="literal">undefined</span>) &#123;</div><div class="line">      sharedSchedule = <span class="literal">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">isLoggedIn</span>: <span class="literal">true</span>, <span class="comment">//æ ¹æ®è¿™ä¸ªå±æ€§å°±å¯ä»¥åœ¨UIä¸­åšå‡ºç›¸åº”çš„æ”¹å˜äº†</span></div><div class="line">      hasSkippedLogin: <span class="literal">false</span>,</div><div class="line">      sharedSchedule,</div><div class="line">      id,<span class="comment">//ä¸‹é¢è¿™ä¸¤ä¸ªå‚æ•°è¦åœ¨åˆ°è¾¾reducerä¹‹å‰è·å¾—,æ‰€ä»¥åœ¨actionä¸­</span></div><div class="line">      <span class="comment">//æ‰§è¡Œè¿œç¨‹æ•°æ®çš„è·å–</span></div><div class="line">      name,</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'SKIPPED_LOGIN'</span>) &#123;<span class="comment">//è·³è¿‡ç™»å½•çš„action</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">isLoggedIn</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">hasSkippedLogin</span>: <span class="literal">true</span>,<span class="comment">//æ”¹å˜è¿™ä¸ªå±æ€§</span></div><div class="line">      sharedSchedule: <span class="literal">null</span>,</div><div class="line">      <span class="attr">id</span>: <span class="literal">null</span>,</div><div class="line">      <span class="attr">name</span>: <span class="literal">null</span>,</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'LOGGED_OUT'</span>) &#123;<span class="comment">//å¤„ç†ç™»å‡ºçš„action</span></div><div class="line">    <span class="keyword">return</span> initialState;<span class="comment">//è¿”å›åˆå§‹å€¼å°±å¯ä»¥äº†</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'SET_SHARING'</span>) &#123;<span class="comment">//è®¾ç½®åˆ†äº«çš„action</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      ...state,</div><div class="line">      <span class="attr">sharedSchedule</span>: action.enabled,<span class="comment">//ç»„ä»¶æ ¹æ®è¿™ä¸ªstateå°±//å¯ä»¥å†³å®šæ˜¯å¯ä»¥åˆ†äº«è¿˜æ˜¯ä¸å¯ä»¥åˆ†äº«</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (action.type === <span class="string">'RESET_NUXES'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> &#123;...state, <span class="attr">sharedSchedule</span>: <span class="literal">null</span>&#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = user;</div></pre></td></tr></table></figure></p>
<p>userçš„reducerè¿˜æ¯”è¾ƒç®€å•,æœ€åä¸€å¥<code>module.expors=user;</code>ä½¿ç”¨äº†javascriptä¸­å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å¯¹è±¡çš„å®šä¹‰,useræ˜¯è¿™ä¸ª<code>å‡½æ•°å¯¹è±¡çš„å¼•ç”¨</code><br>é‚£ä¹ˆuserå¯¹è±¡ä¸­æ˜¯ä»€ä¹ˆå‘¢ï¼ŸğŸ˜,é‡Œé¢æ˜¯<code>é—­åŒ…</code>å•Š! è¦ä¸ç„¶combineReducersé‡Œé¢è°ƒç”¨userå‡½æ•°çš„æ—¶å€™stateèƒ½è®°ä½æ”¹å˜çš„å†…å®¹å‘¢ï¼Ÿè¦ç†è§£è¿™äº›æ¦‚å¿µ,å¯¹javascriptçš„é—­åŒ…çš„ç†è§£æ˜¯ä¸å¯å°‘çš„. </p>
<p><code>login.js</code><br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">use</span> <span class="title">strict</span>';</div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="keyword">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//è¿æ¥parseçš„å®¢æˆ·ç«¯åŒ…</span></div><div class="line"><span class="keyword">const</span> FacebookSDK = <span class="keyword">require</span>(<span class="string">'FacebookSDK'</span>);</div><div class="line"><span class="keyword">const</span> ActionSheetIOS = <span class="keyword">require</span>(<span class="string">'ActionSheetIOS'</span>);<span class="comment">//ä¸Šæ‹‰ç»„ä»¶</span></div><div class="line"><span class="keyword">const</span> &#123;Platform&#125; = <span class="keyword">require</span>(<span class="string">'react-native'</span>);<span class="comment">//</span></div><div class="line"><span class="keyword">const</span> Alert = <span class="keyword">require</span>(<span class="string">'Alert'</span>);</div><div class="line"><span class="keyword">const</span> &#123;restoreSchedule, loadFriendsSchedules&#125; = <span class="keyword">require</span>(<span class="string">'./schedule'</span>);</div><div class="line"><span class="keyword">const</span> &#123;updateInstallation&#125; = <span class="keyword">require</span>(<span class="string">'./installation'</span>);</div><div class="line"><span class="keyword">const</span> &#123;loadSurveys&#125; = <span class="keyword">require</span>(<span class="string">'./surveys'</span>);</div><div class="line"></div><div class="line">import type &#123; Action, ThunkAction &#125; from <span class="string">'./types'</span>;</div><div class="line"><span class="comment">//ä¸‹é¢ä¸¤ä¸ªå‡½æ•°æ˜¯ä½¿ç”¨ParseFacebookç™»å½•çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">ParseFacebookLogin</span><span class="params">(scope)</span>: <span class="title">Promise</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise((resolve, reject) =&gt; &#123;</div><div class="line">    Parse.FacebookUtils.logIn(scope, &#123;</div><div class="line">      success: resolve,</div><div class="line">      error: (user, error) =&gt; reject(error &amp;&amp; error.error || error),</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">queryFacebookAPI</span><span class="params">(path, ...args)</span>: <span class="title">Promise</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise((resolve, reject) =&gt; &#123;</div><div class="line">    FacebookSDK.api(path, ...args, (response) =&gt; &#123;</div><div class="line">      <span class="keyword">if</span> (response &amp;&amp; !response.error) &#123;</div><div class="line">        resolve(response);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        reject(response &amp;&amp; response.error);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">_logInWithFacebook</span><span class="params">(source: ?string)</span>: <span class="title">Promise</span>&lt;<span class="title">Array</span>&lt;<span class="title">Action</span>&gt;&gt; </span>&#123;</div><div class="line">  await ParseFacebookLogin(<span class="string">'public_profile,email,user_friends'</span>);<span class="comment">//es7çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">  <span class="keyword">const</span> profile = await queryFacebookAPI(<span class="string">'/me'</span>, &#123;fields: <span class="string">'name,email'</span>&#125;);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> user = await Parse.User.currentAsync();</div><div class="line">  user.set(<span class="string">'facebook_id'</span>, profile.id);</div><div class="line">  user.set(<span class="string">'name'</span>, profile.name);</div><div class="line">  user.set(<span class="string">'email'</span>, profile.email);</div><div class="line">  await user.save();</div><div class="line">  await updateInstallation(&#123;user&#125;);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> action = &#123;<span class="comment">//é…ç½®actionå¯¹è±¡</span></div><div class="line">    type: <span class="string">'LOGGED_IN'</span>, <span class="comment">//ä¼ åˆ°reducerçš„actioType</span></div><div class="line">    source,</div><div class="line">    data: &#123;</div><div class="line">      id: profile.id,</div><div class="line">      name: profile.name,</div><div class="line">      sharedSchedule: user.get(<span class="string">'sharedSchedule'</span>),</div><div class="line">    &#125;,</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Promise.all([</div><div class="line">    Promise.resolve(action),</div><div class="line">    restoreSchedule(),</div><div class="line">  ]);</div><div class="line">&#125;</div><div class="line"><span class="comment">//è¿™ä¸€æ­¥å°±æœ‰ç‚¹ç»•äº†,ç”±äºæ˜¯è¿œç¨‹æ“ä½œ,éœ€è¦å¼‚æ­¥å¤„ç†,ç­‰å¾…ç»“æœä»¥åæ‰èƒ½dispatch</span></div><div class="line"><span class="comment">//è·å–çš„ç»“æœ,</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logInWithFacebook</span><span class="params">(source: ?string)</span>: <span class="title">ThunkAction</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> (dispatch) =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> login = _logInWithFacebook(source);<span class="comment">//è¿”å›çš„å°±æ˜¯ä¸Šé¢çš„const action</span></div><div class="line">    </div><div class="line">    <span class="comment">// Loading friends schedules shouldn't block the login process</span></div><div class="line">    login.then(</div><div class="line">      (result) =&gt; &#123;</div><div class="line">        dispatch(result);</div><div class="line">        dispatch(loadFriendsSchedules());</div><div class="line">        dispatch(loadSurveys());</div><div class="line">      &#125;</div><div class="line">    );</div><div class="line">    <span class="keyword">return</span> login;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">skipLogin</span><span class="params">()</span>: <span class="title">Action</span> </span>&#123;<span class="comment">//è·³è¿‡ç™»å½•çš„action</span></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    type: <span class="string">'SKIPPED_LOGIN'</span>,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logOut</span><span class="params">()</span>: <span class="title">ThunkAction</span> </span>&#123;<span class="comment">//ç™»å‡ºä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œ,ç­‰å¾…ä¸¤ä¸ªè¿œç¨‹æ•°æ®çš„ç›¸åº”ç»“æœ</span></div><div class="line">  <span class="keyword">return</span> (dispatch) =&gt; &#123;</div><div class="line">    Parse.User.logOut();</div><div class="line">    FacebookSDK.logout();</div><div class="line">    updateInstallation(&#123;user: <span class="keyword">null</span>, channels: []&#125;);</div><div class="line"></div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> Make sure reducers clear their state</span></div><div class="line">    <span class="keyword">return</span> dispatch(&#123;</div><div class="line">      type: <span class="string">'LOGGED_OUT'</span>,</div><div class="line">    &#125;);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logOutWithPrompt</span><span class="params">()</span>: <span class="title">ThunkAction</span> </span>&#123;<span class="comment">//å¯¹è¯æ¡†é€€å‡º,ä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œ</span></div><div class="line">  <span class="comment">//ç¡®è®¤ä»¥åå†dispatchä¸€ä¸ªaction</span></div><div class="line">  <span class="keyword">return</span> (dispatch, getState) =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> name = getState().user.name || <span class="string">'there'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (Platform.OS === <span class="string">'ios'</span>) &#123;</div><div class="line">      ActionSheetIOS.showActionSheetWithOptions(</div><div class="line">        &#123;</div><div class="line">          title: `Hi, $&#123;name&#125;`,</div><div class="line">          options: [<span class="string">'Log out'</span>, <span class="string">'Cancel'</span>],</div><div class="line">          destructiveButtonIndex: <span class="number">0</span>,</div><div class="line">          cancelButtonIndex: <span class="number">1</span>,</div><div class="line">        &#125;,</div><div class="line">        (buttonIndex) =&gt; &#123;</div><div class="line">          <span class="keyword">if</span> (buttonIndex === <span class="number">0</span>) &#123;<span class="comment">//æ ¹æ®é€»è¾‘åˆ¤dispatché€€å‡ºæ“ä½œ</span></div><div class="line">            dispatch(logOut());</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      );</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      Alert.alert(<span class="comment">//andoidå¼¹å‡ºå¯¹è¯æ¡†</span></div><div class="line">        `Hi, $&#123;name&#125;`,</div><div class="line">        <span class="string">'Log out from F8?'</span>,</div><div class="line">        [</div><div class="line">          &#123; text: <span class="string">'Cancel'</span> &#125;,</div><div class="line">          &#123; text: <span class="string">'Log out'</span>, onPress: () =&gt; dispatch(logOut()) &#125;,</div><div class="line">        ]</div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="comment">//åˆçœ‹ä»£ç logInWithFacebookè¿™ä¸ªactionæ˜¯æ²¡æœ‰åœ¨ationTypeä¸­çš„,ä½†æ˜¯å…¶å®</span></div><div class="line"><span class="comment">//è¿™ä¸ªå‡½æ•°æœ‰è¿”å›äº†LoginedInå¯¹è±¡,è¿™ä¸€ç‚¹æœ‰ä»”ç»†çœ‹çœ‹</span></div><div class="line">module.exports = &#123;logInWithFacebook, skipLogin, logOut, logOutWithPrompt&#125;;</div></pre></td></tr></table></figure></p>
<p>ç™»å½•çš„å…·ä½“é€»è¾‘å’Œå®ç°å°±æ˜¯è¿™äº›.UIç»„ä»¶è¦æ€ä¹ˆåšå‘¢ï¼Ÿå¥½äº†æˆ‘è¿™é‡Œåœ¨ä¸¾ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­æ¥è¯´æ˜.è¿™ä¸ªæ€æƒ³ä»æˆ‘çš„ç”µç¯æ¨¡å‹å¼€å§‹æ¼”åŒ–æˆä¸ºäº†è‡ªåŠ¨è´©å–æœºæ¨¡å‹æˆ–è€…ATMæœºæ¨¡å‹äº†. æˆ‘ä»¬å§‘ä¸”ç§°ä¸ºATMæœºæ¨¡å‹å¥½äº†.å›æƒ³ä½ å»ATMå–é’±,è¾“å…¥å¯†ç ,è¾“å…¥é’±çš„æ•°ç›®.ä½ æ˜¯å¤§æ¬¾ä¸€æ¬¡æƒ³å–åä¸‡å—,ç‚¹å‡»æŒ‰é”®æˆ–è€…è§¦æ‘¸å±è¾“å…¥åä¸‡å—,å¯æƒœATMçš„é’±ç®±æ²¡æœ‰è£…é‚£ä¹ˆå¤š,å‘Šè¯‰ä½ ATMæœºæ²¡æœ‰è¿™ä¹ˆå¤šé’±ï¼Œè¿™ä¸ªæ¶ˆæ¯ååº”çš„ATMé’±ç®±çš„<code>state</code>æ˜¯æ²¡æœ‰åä¸‡.äºæ˜¯ä½ æŒ‰é”®æˆ–è€…è§¦æ‘¸æ“ä½œè¾“å…¥1000å—,äºæ˜¯ä¹ATMæœºå™¨ç»™ä½ åå‡ºäº†1000å—.ä½ çš„è´¦æˆ·çš„ä½™é¢<code>state</code>å‡æ‰äº†1000å—.è¿™ä¸ªè¿‡ç¨‹å±…ç„¶å’Œcounterçš„è¿‡ç¨‹æ˜¯ä¸€æ ·çš„.é‚£ä¹ˆä¸ºä»€ä¹ˆè¦ä»‹ç»è¿™ä¸ªæ¨¡å‹å‘¢ï¼Ÿæˆ‘ä»¬æŒ‰é”®æˆ–è€…è§¦æ‘¸æ“ä½œ,å¹¶æ²¡æœ‰åœ¨å±å¹•ä¸Šå®ç°å…·ä½“çš„æ“ä½œ,é’ç¥¨çš„åˆ¶ä½œ,é’±ç®±çš„æ‰“å¼€,é’ç¥¨çš„æ•°é‡è®¡ç®—éƒ½æ˜¯æœ‰æœºå™¨æ¥å®Œæˆçš„.æˆ‘ä»¬ç‚¹å‡»çš„å±å¹•å’ŒæŒ‰é”®å…¶å®å°±æ˜¯UIç”¨æˆ·ç•Œé¢,ç•Œé¢ä¸Šçš„æŒ‰é”®å…¶å®åªæ˜¯å®é™…æ“ä½œçš„ä»£ç†.javacriptçš„å‡½æ•°å¯ä»¥<code>ä¼ å¼•ç”¨èµ‹å€¼</code>,æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å‡½æ•°åå­—æ¥è°ƒç”¨å®é™…çš„å‡½æ•°å…·ä½“æ“ä½œ.å°½ç®¡å±å¹•ä¸Šæ²¡æœ‰é’±ç®±,ä½†æ˜¯æˆ‘ä»¬å´å¯ä»¥å–åˆ°é’±.ä»è¿™ä¸ªä¾‹å­çœ‹,reduxæ˜¯å¤šä¹ˆçš„ç®€å•.ä½†æ˜¯ç¢ç£¨å‡ºè¿™ä¸ªåŸç†ä¹Ÿæ˜¯èŠ±äº†å¾ˆé•¿æ—¶é—´çš„.è¿™å®é™…å°±æ˜¯ä¸­ä»‹è€…æ¨¡å¼.<br>å“ˆå“ˆé‚£ä¸ªé’±ç®±å°±æ˜¯ä¸€ä¸ª<code>é—­åŒ…</code>,ä½ çœ‹çœ‹æ˜¯ä¸æ˜¯ï¼Ÿ</p>
<h2 id="Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse-js"><a href="#Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse-js" class="headerlink" title="Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse.js"></a>Actionsæ–‡ä»¶å¤¹ä¸­çš„å·¥å…·æ–‡ä»¶parse.js</h2><p><code>parse.js</code></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"></div><div class="line"><span class="javascript"><span class="meta">'use strict'</span>;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="built_in">require</span>(<span class="string">'parse/react-native'</span>);<span class="comment">//parseServerçš„å®¢æˆ·ç«¯</span></div><div class="line"><span class="keyword">const</span> logError = <span class="built_in">require</span>(<span class="string">'logError'</span>);</div><div class="line"><span class="keyword">const</span> InteractionManager = <span class="built_in">require</span>(<span class="string">'InteractionManager'</span>);</div><div class="line"></div><div class="line"><span class="keyword">import</span> type &#123; ThunkAction &#125; <span class="keyword">from</span> <span class="string">'./types'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Maps = Parse.Object.extend(<span class="string">'Maps'</span>);<span class="comment">//ParseServerçš„å¯¹è±¡</span></div><div class="line"><span class="comment">//å¯ä»¥å‚çœ‹ireading app feedbackæ¨¡å—é‡Œçš„åé¦ˆæ„è§çš„è¿œç¨‹å­˜å‚¨,ä½¿ç”¨çš„æ˜¯leancloud</span></div><div class="line"><span class="comment">//ä½†æ˜¯APIæ˜¯å®Œå…¨ä¸€æ ·çš„.</span></div><div class="line"><span class="keyword">const</span> Notification = Parse.Object.extend(<span class="string">'Notification'</span>);</div><div class="line"><span class="comment">//æ€»çš„ParseQueryæŸ¥è¯¢å‡½æ•°,æ ¹æ®typeå’ŒæŸ¥è¯¢ç­›é€‰ç»“æœåŠ¨æ€dispatch action</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadParseQuery</span>(<span class="params">type: string, query: Parse.Query</span>): <span class="title">ThunkAction</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> query.find(&#123;</div><div class="line">      <span class="attr">success</span>: <span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// We don't want data loading to interfere with smooth animations</span></div><div class="line">        InteractionManager.runAfterInteractions(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">          <span class="comment">// Flow can't guarantee &#123;type, list&#125; is a valid action</span></div><div class="line">          dispatch((&#123;type, list&#125;: any));</div><div class="line">        &#125;);</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">error</span>: logError,</div><div class="line">    &#125;);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line"><span class="comment">//loadå°±æ˜¯tabbaré»˜è®¤tabåŠ è½½çš„ä¼šè®®æ—¥ç¨‹state</span></div><div class="line">  loadSessions: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//åŠ è½½ä¼šè®®æ—¥ç¨‹,è¿™é‡Œä¸æ˜¯æµè§ˆå™¨çš„sessionï¼Œæ˜ å°„</span></div><div class="line">    loadParseQuery(</div><div class="line">      <span class="string">'LOADED_SESSIONS'</span>,</div><div class="line">      <span class="keyword">new</span> Parse.Query(<span class="string">'Agenda'</span>)</div><div class="line">        .include(<span class="string">'speakers'</span>)</div><div class="line">        .ascending(<span class="string">'startTime'</span>)</div><div class="line">    ),</div><div class="line"></div><div class="line">  <span class="attr">loadMaps</span>: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//æ˜ å°„</span></div><div class="line">    loadParseQuery(<span class="string">'LOADED_MAPS'</span>, <span class="keyword">new</span> Parse.Query(Maps)),</div><div class="line"></div><div class="line">  <span class="attr">loadNotifications</span>: (): <span class="function"><span class="params">ThunkAction</span> =&gt;</span><span class="comment">//æ˜ å°„å¯¹è±¡</span></div><div class="line">    loadParseQuery(<span class="string">'LOADED_NOTIFICATIONS'</span>, <span class="keyword">new</span> Parse.Query(Notification)),</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="actions-config-js"><a href="#actions-config-js" class="headerlink" title="actions/config.js"></a>actions/config.js</h2><p><code>config.js</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">strict</span>';</div><div class="line"></div><div class="line"><span class="keyword">const</span> Parse = <span class="keyword">require</span>(<span class="string">'parse/react-native'</span>);</div><div class="line"><span class="keyword">const</span> InteractionManager = <span class="keyword">require</span>(<span class="string">'InteractionManager'</span>);</div><div class="line"></div><div class="line">import type &#123; Action &#125; from <span class="string">'./types'</span>; <span class="comment">//è·å¾—æ‰€æœ‰çš„type</span></div><div class="line"></div><div class="line"><span class="comment">//è·å–é…ç½®æ–‡ä»¶çš„å¼‚æ­¥æ“ä½œ</span></div><div class="line">async <span class="function"><span class="keyword">function</span> <span class="title">loadConfig</span><span class="params">()</span>: <span class="title">Promise</span>&lt;<span class="title">Action</span>&gt; </span>&#123;</div><div class="line">  <span class="keyword">const</span> config = await Parse.Config.get();<span class="comment">//Â ä»parseæœåŠ¡å™¨è·å–é…ç½®æ•°æ®</span></div><div class="line">  await InteractionManager.runAfterInteractions();</div><div class="line">  <span class="keyword">return</span> &#123;<span class="comment">//æ“ä½œé€»è¾‘åœ¨è¿™é‡Œè¿”å›configæ•°æ®ç„¶åæ‹·è´åˆ°state</span></div><div class="line">    type: <span class="string">'LOADED_CONFIG'</span>,</div><div class="line">    config,<span class="comment">//é…ç½®è´Ÿè½½æˆ–è€…è½½è·</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">module.exports = &#123;loadConfig&#125;;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å…¥å£å’Œé…ç½®æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#å…¥å£å’Œé…ç½®æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;å…¥å£å’Œé…ç½®æ–‡ä»¶&quot;&gt;&lt;/a&gt;å…¥å£å’Œé…ç½®æ–‡ä»¶&lt;/h1&gt;&lt;h2 id=&quot;F8APP-js-setup-jsæ–‡ä»¶&quot;&gt;&lt;a href=&quot;#F8APP-js-setup
    
    </summary>
    
      <category term="F8Appæºç é˜…è¯»" scheme="http://yoursite.com/categories/F8App%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
    
      <category term="React-native" scheme="http://yoursite.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼,è¿”ç’å½’çœŸF8(1)</title>
    <link href="http://yoursite.com/2017/04/05/%E4%B9%B1%E8%8A%B1%E6%B8%90%E6%AC%B2%E8%BF%B7%E4%BA%BA%E7%9C%BC-%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9F-1/"/>
    <id>http://yoursite.com/2017/04/05/ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼-è¿”ç’å½’çœŸ-1/</id>
    <published>2017-04-05T10:00:23.000Z</published>
    <updated>2017-04-05T18:28:31.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å»å¹´å†™äº†å‡ ç¯‡f8appçš„ä»£ç é˜…è¯»,åŸºæœ¬æ˜¯ç«™åœ¨UIç»„ä»¶çš„è§’åº¦æ¥çš„,éšç€å­¦ä¹ çš„æ·±å…¥,å¯¹å…¶ä¸­çš„ä»£ç æœ‰äº†æ›´æ·±çš„ä½“ä¼š,ç°åœ¨æœ‰å¾ˆå¤šå¼€æºçš„RNé¡¹ç›®å¯ä»¥ä¾›å‚è€ƒ,ä½†æ˜¯æœ‰ä¸€äº›éƒ½å­˜åœ¨æŸäº›é—®é¢˜.ç»†èŠ‚è€ƒè™‘çš„ä¸å‘¨åˆ°,å­¦ä¹ çš„æ„ä¹‰æ‰“äº†æŠ˜æ‰£.F8APPæ˜¯facebookçš„äº²å„¿å­ï¼Œæ‰€ä»¥å¼€å‘è€…çš„æ°´å¹³æ˜¯å¾ˆé«˜çš„,å‰é¢é˜…è¯»çš„æ—¶å€™è§‰å¾—æ€ä¹ˆå†™çš„å¾ˆéš¾æ‡‚,ç”šè‡³è¿˜æœ‰äº›åœ°æ–¹å¯¹Reduxçš„å®ç°éƒ½æ„Ÿè§‰ä¸å¤ªæ ‡å‡†,è¿™ä¸¤å¤©åœ¨å›å¤´çœ‹çš„æ—¶å€™,ä¸å¾—ä¸ä½©æœäººå®¶çš„å¼€å‘æ°´å¹³.ä»£ç é‡Œå¯¹äºç»„ä»¶çš„å®ç°,Reduxçš„æ¸—é€,å¤šæ•°æ®æºçš„æ¥å…¥,ä»£ç ç»„ç»‡æ–¹é¢éƒ½æ˜¯ç‹¬å±…åŒ å¿ƒçš„.æˆ‘è‡ªä»é‡æ–°é˜…è¯»äº†ä»¥å,æ„Ÿè§‰å†™ä»£ç å½“å¦‚æ­¤å•Š. </p>
</blockquote>
<p>ä½†æ˜¯åˆ°äº†ç°åœ¨çš„è¿™ä¸ªè§‰æ‚Ÿå¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„.ç»è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ ,å­¦ä¹ å·¥å…·ç®±é‡Œå°±æœ‰ä¸€äº›å·¥å…·äº†.</p>
<ul>
<li>å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³,javascripté‡Œçš„å‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡,å…¶å®æ„æ€æ˜¯å‡½æ•°å’Œå¯¹è±¡åœ¨javascriptä¸­éƒ½æ˜¯<code>å¼•ç”¨èµ‹å€¼çš„</code>,<strong>è¿™ä¸€ç‚¹éå¸¸çš„éå¸¸çš„å…³é”®</strong>.è¿™å¹¶éå±è¨€è€¸å¬,ä¸€æ—¦ä½ åœ¨è¯»ä»£ç ä¸­æœ‰äº†è¿™ä¸ªè§‰æ‚Ÿçš„è¯,javascriptçš„åŠŸåŠ›ä¼šå¤§å¢çš„.æˆ‘ä»¬éšæ—¶å¯ä»¥æŠŠä¸€ä¸ªå‡½æ•°æ˜ å°„åˆ°ä¸€ä¸ªå˜é‡ä¸Š,è¿™å°±æ˜¯å¼•ç”¨èµ‹å€¼,ä¸€æ—¦è¿™æ ·åšä»¥å,å‡½æ•°å¯ä»¥ä½¿ç”¨è¿™ä¸ªå˜é‡åœ¨ä»£ç ä¸­ä¼ æ¥ä¼ å»,çµæ´»æ€§å¤§å¢.æœ‰æ²¡æœ‰æ€è€ƒè¿‡React/Reduxä¸­ç»„ä»¶dispatchä¸€ä¸ªactionåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?bindActionCreatoræ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿè¿™è¿˜æ²¡å®Œ,ç»§ç»­æŒ–æ˜å‡½æ•°ç¼–ç¨‹æ˜¯æ€ä¹ˆåœ¨f8é‡Œå®ç°çš„</li>
<li>æ¨¡å¼è®¾è®¡çš„æ€æƒ³ï¼šä¸­ä»‹è€…æ¨¡å¼,å‘å¸ƒè®¢é˜…è€…æ¨¡å¼,ç­‰ç­‰æ¨¡å¼,åœ¨è¿™é¢ä¹Ÿå¾ˆå¥½çš„å®ç°äº†ã€‚è¦æœ‰ä¸€ç‚¹æ¨¡å¼è®¾è®¡çš„çŸ¥è¯†</li>
<li>React-nativeè·¨å¹³å°å¼€å‘çš„ä»£ç å¤ç”¨é—®é¢˜,åŠŸèƒ½,é€»è¾‘å’Œè¡¨ç°å½¢å¼çš„ç»“åˆæ€è€ƒã€‚å…ˆé€»è¾‘åè¡¨ç°ã€‚</li>
<li>ä¸´æœºåº”å˜,åˆšå¼€å§‹çœ‹f8appçš„ä»£ç çš„æ—¶å€™çœ‹ä¸ä¸‹å»,å°¤å…¶æ˜¯åœ¨å¯¹reduxæœ‰äº†åˆæ­¥çš„äº†è§£,äº§ç”Ÿç›²ç›®å´‡æ‹œä»¥å,åœ¨Reactä¸­å¿…é¡»è¦æ‰¾åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹åœ¨æ‰èƒ½æ˜¯æ ¹æ­£è‹—çº¢çš„Reduxåº”ç”¨.äºæ˜¯åœ¨é‡Œé¢æ‰¾,è¿™é‡Œé¢æ›´æœ¬å°±æ²¡æœ‰containeræ–‡ä»¶å¤¹ä¹ˆï¼Ÿæ€ä¹ˆåŠï¼Ÿå…¶å®åœ¨containeræ–‡ä»¶ä¸­ä¹Ÿåªæ˜¯ç”¨connectå¯¹è±¡æ³¨å…¥äº†ç»„ä»¶æ˜¯ç»„ä»¶è®¢é˜…äº†éœ€è¦çš„propsï¼Œå…·æœ‰äº†dispatchæ–¹æ³•.ä»…æ­¤è€Œå·².æ‰€ä»¥åœ¨f8appä¸­ç›´æ¥åœ¨UIç»„ä»¶ä¸­ä½¿ç”¨äº†connectå¯¹è±¡.è¿™æ ·å¯¹äºç¼–ç å®é™…æ›´å¥½æ“ä½œï¼Œæ›´ç›´è§‚.å¦å¤–å¸¦æ¥çš„å¥½å¤„æ˜¯,ç»„ä»·å…¶å®ä¸ä¸€å®šéè¦ç”¨reduxæ¥å¤„ç†,å¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ¡†æ¶æ¥å¤„ç†.infoè¿™ä¸ªæ¨¡å—å°±æ²¡æœ‰é‡‡ç”¨reduxçš„æ¡†æ¶.è¦ä»åŠŸèƒ½ä¸Šçµæ´»å¤„ç†ã€‚èƒ½è¾¾åˆ°éšæœºåº”å˜è¦å¯¹åŠŸèƒ½çš„å®ç°æœ‰æ·±åˆ»çš„è®¤è¯†ã€‚</li>
<li>å¯¹äºstateçš„æ€è€ƒ,åé¢å¦‚æœè¦ç»§ç»­æé«˜RNçš„ç¼–ç¨‹èƒ½åŠ›,è¦ä¸æ–­çš„æ€è€ƒstateçš„é—®é¢˜.ç›®å‰çœ‹åˆ°çš„ä¸¤ä¸ªå¤§å‹ç¨‹åºçš„stateï¼Œä¸€ä¸ªæ˜¯f8çš„ï¼Œä¸€ä¸ªæ˜¯cnodeçš„state.<br>æˆ‘å‰é¢å†™è¿‡æ–‡ç« æŠŠstateçœ‹æˆæ˜¯å†…å­˜çš„æ•°æ®åº“,å›´ç»•ç€stateåšå¢åˆ æ”¹æŸ¥å·¥ä½œï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ªæ„æ€å‘¢ï¼Ÿf8ä¸­çš„stateå®ç°æ˜¯ä¸€é¢—å€’ç«‹çš„æ ‘,ä¸ºä»€ä¹ˆæ˜¯æ ‘å‘¢ï¼Ÿè¿™æ˜¯ç›¸å¯¹äºç½‘çŠ¶ç»“æ„æ¥çš„,stateä¸­æ˜¯æ²¡æœ‰ä¹‹é—´çš„è¿æ¥å…³ç³»çš„.æ•°æ®ä»¥èŠ‚ç‚¹æ¥ç»„ç»‡.çœ‹åˆ°f8appä¸­combineReducerä¸­çš„æ˜ å°„çš„æ—¶å€™ï¼Œé‚£æ„Ÿè§‰çœŸçˆ½å•Šã€‚ç¼–ç¨‹çœŸæœ‰æ„æ€.å›å¤´çœ‹ä»£ç åœ¨è§£é‡Š.</li>
<li>parse-serverå’Œgraghqlçš„é—®é¢˜,</li>
<li><p>è§‚å¯Ÿçš„è§†ç‚¹é€‰æ‹©é—®é¢˜,å¦‚æœä¼šä½ çœ‹è¿‡<a href="https://medium.com/@rajaraodv/step-by-step-guide-to-building-react-redux-apps-using-mocks-48ca0f47f9a" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>,<a href="https://wenku.baidu.com/view/881a48f8aaea998fcd220ea5.html?from=search" target="_blank" rel="external">ä¸­æ–‡ç¿»è¯‘ç‰ˆ</a>çš„è¯,è¿™ç¯‡æ–‡ç« å®é™…æ˜¯ä»UIç»„ä»¶çš„è§’åº¦æ¥æ‰¾è§†ç‚¹çš„,å¯¹äºåˆå­¦è€…ä¿©è¯´,è¿™ç¯‡æ–‡ç« çš„ç¡®æ˜¯å¾ˆå¥½çš„,ä½†æ˜¯å¯¹äºF8appè¿™æ ·çš„å¤§å‹app,ä»è§†å›¾å°±æœ‰ç‚¹å–§å®¾å¤ºä¸»äº†.åœ¨f8appä¸­stateå’ŒActionsçš„å¤æ‚ç¨‹åº¦æ›´é«˜,ä»ç»„ä»¶ä¸Šé¢å»å­¦ä¹ å°±æœ‰ç‚¹éº»çƒ¦,å°¤å…¶æ˜¯è¿™é‡Œé¢æœ‰å‡ ä¸ªåœ°æ–¹çš„ç»„ä»¶ç»„åˆçœŸçš„æ˜¯å¤ªå‰å®³äº†ï¼Œçœ‹å®Œç»„ä»¶çš„ç»„åˆå…³ç³»å°±å·²ç»æ²¡è€å¿ƒäº†.ä»actionå’Œstateå¼€å§‹è¯»ä¼¼ä¹æ˜¯å¯è¡Œçš„.å½“ç„¶å› äººè€Œå¼‚.æˆ‘æå‡ºè¿™ä¸ªè§‚ç‚¹è‡³å°‘æ˜¯è¯´æ˜æˆ‘æ€è€ƒè¿‡è¿™ä¸ªé—®é¢˜.</p>
</li>
<li><p>è´ªå¿ƒåŸç† f8APPä¸­å·²ç»åŒ…å«å’Œäº†å¾ˆå¤šç»„ä»¶å’Œä¸­é—´ä»¶äº†,å¤šå­¦å‡ éå°±å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹ç”¨äº†.å¤ªå¥½äº†.</p>
</li>
</ul>
<blockquote>
<p>æ—¶é—´å¤ªæ™šäº†ï¼Œæœ‰äº›åœ°æ–¹ç™½å¤©æƒ³æ˜ç™½äº†,ç°åœ¨åˆå¿˜äº†.å…ˆå†™è¿™ä¹ˆå¤š.</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å»å¹´å†™äº†å‡ ç¯‡f8appçš„ä»£ç é˜…è¯»,åŸºæœ¬æ˜¯ç«™åœ¨UIç»„ä»¶çš„è§’åº¦æ¥çš„,éšç€å­¦ä¹ çš„æ·±å…¥,å¯¹å…¶ä¸­çš„ä»£ç æœ‰äº†æ›´æ·±çš„ä½“ä¼š,ç°åœ¨æœ‰å¾ˆå¤šå¼€æºçš„RNé¡¹ç›®å¯ä»¥ä¾›å‚è€ƒ,ä½†æ˜¯æœ‰ä¸€äº›éƒ½å­˜åœ¨æŸäº›é—®é¢˜.ç»†èŠ‚è€ƒè™‘çš„ä¸å‘¨åˆ°,å­¦ä¹ çš„æ„ä¹‰æ‰“äº†æŠ˜æ‰£.F8APPæ˜¯facebookçš„äº²å„¿å­ï¼Œæ‰€
    
    </summary>
    
      <category term="F8Appæºç é˜…è¯»" scheme="http://yoursite.com/categories/F8App%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
    
      <category term="React-native" scheme="http://yoursite.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|redux undo/redo reducerå¢å¼ºç»„ä»¶</title>
    <link href="http://yoursite.com/2017/04/04/%E7%BF%BB%E8%AF%91-redux-undo-redo-reucer%E5%A2%9E%E5%BC%BA%E7%BB%84%E4%BB%B6/"/>
    <id>http://yoursite.com/2017/04/04/ç¿»è¯‘-redux-undo-redo-reucerå¢å¼ºç»„ä»¶/</id>
    <published>2017-04-04T13:18:28.000Z</published>
    <updated>2017-04-04T15:36:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Reduxçš„æ–‡æ¡£ä¸­æä¾›ä¸€ä¸ªå¯ä»¥åšundo/redoçš„è§£å†³åŠæ³•,å®é™…æ˜¯æœ‰previous,current,prewçš„å¯¹è±¡,å›´ç»•è¿™æ•°æ®çš„å‹å…¥å’Œå¼¹å‡ºæ¥å®ç°æ“ä½œæ­¥éª¤çš„è®°å¿†,ç»“åˆpersistå°±å¯ä»¥å®ç°æ›´å¼ºå¤§çš„è®°å¿†åŠŸèƒ½.ä»Šå¤©çš„è¿™ä¸ªå¢å¼ºç»„ä»¶å®é™…æŠŠè¿™ä¸ªåŠŸèƒ½ç»™åŒ…è£…äº†ä¸€ä¸‹,å†…éƒ¨å®ç°ç»†èŠ‚ä»ç„¶æ²¡æœ‰å˜.åªéœ€è¦æŠŠreducerç”¨è¿™ä¸ªå¢å¼ºç»„ä»¶åŒ…è£…ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†.</p>
<hr>
</blockquote>
<h1 id="redux-undo-redo"><a href="#redux-undo-redo" class="headerlink" title="redux undo/redo"></a>redux undo/redo</h1><p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1feb2dpdu5xg30eo01k0t1.gif" alt=""></p>
<p>æç¤º:ä½ å¯ä»¥ä½¿ç”¨<a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external">redux-undo-boilerplate</a>æ¥å¼€å§‹é¡¹ç›®.</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p><code>npm install --save redux-undo</code></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div><div class="line">undoable(reducer)</div><div class="line">undoable(reducer, config)</div></pre></td></tr></table></figure>
<h2 id="è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš"><a href="#è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš" class="headerlink" title="è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš"></a>è®©ä½ çš„reducerså˜å¾—å¯ä»¥é‡åš</h2><p><code>redux-undo</code>æ˜¯ä¸€ä¸ªreducerå¢å¼ºç»„ä»¶,å®ƒæä¾›äº†<code>undoable</code>å‡½æ•°,è¿™ä¸ªå‡½æ•°æ¥æ”¶å·²ç»å­˜åœ¨çš„reducerå’Œé…ç½®å¯¹è±¡,ä½¿ç”¨undoå‡½æ•°å¢å¼ºå·²ç»å­˜åœ¨çš„reducer.</p>
<p><strong>æ³¨æ„ï¼š</strong>å¦‚æœåœ¨<code>state.counter</code>ä¹‹å‰æ¥å…¥,ä½ å¿…é¡»è¦åœ¨åŒ…è£…<code>reducer</code>ä¹‹åæ¥å…¥<code>state.coutner.present</code>.</p>
<p>é¦–å…ˆå¯¼å…¥<code>redux-undo</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// Redux utility functions </span></div><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="comment">// redux-undo higher-order reducer </span></div><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>æ¥ç€,æ·»åŠ <code>undoable</code>åˆ°ä½ çš„reducer<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">combineReducers</span>(&#123;</div><div class="line">  <span class="attribute">counter</span>: <span class="built_in">undoable</span>(counter)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><code>é…ç½®é¡¹</code>æƒ³è¿™æ ·ä¼ é€’<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">combineReducers</span>(&#123;</div><div class="line">  <span class="attribute">counter</span>: <span class="built_in">undoable</span>(counter, &#123;</div><div class="line">    limit: 10 // set a limit for the history </div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="å†å²API"><a href="#å†å²API" class="headerlink" title="å†å²API"></a>å†å²API</h2><p>ä½¿ç”¨reduceråŒ…è£…ä½ çš„reduceræƒ³è¿™æ ·<br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  past: [...pastStatesHere...],</div><div class="line">  present: <span class="meta">&#123;...currentStateHere...&#125;</span>,</div><div class="line">  future: [...futureStatesHere...]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨<code>state.present</code>è·å–å½“å‰çš„state<br>è·å–æ‰€æœ‰è¿‡å»çš„stateä½¿ç”¨<code>state.past</code>.</p>
<h2 id="Undo-Redo-Actions"><a href="#Undo-Redo-Actions" class="headerlink" title="Undo/Redo Actions"></a>Undo/Redo Actions</h2><p>é¦–å…ˆå¯¼å…¥undo/redo action creators<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>ç„¶åå°±å¯ä»¥ä½¿ç”¨<code>store.dispatch()</code>å’Œundo/redo action creatorsæ¥æ‰§è¡Œundo/redoæ“ä½œ.<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">store.dispatch<span class="comment">(ActionCreators.undo()</span>) <span class="comment">// undo the last action </span></div><div class="line">store.dispatch<span class="comment">(ActionCreators.redo()</span>) <span class="comment">// redo the last action </span></div><div class="line"> </div><div class="line">store.dispatch<span class="comment">(ActionCreators.jumpToPast(index)</span>) <span class="comment">// jump to requested index in the past[] array </span></div><div class="line">store.dispatch<span class="comment">(ActionCreators.jumpToFuture(index)</span>) <span class="comment">// jump to requested index in the future[] array</span></div></pre></td></tr></table></figure></p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é…ç½®å¯¹è±¡ä¼ é€’ç»™<code>undoable()</code>(å€¼æ˜¯é»˜è®¤å€¼)</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  limi<span class="variable">t:</span> false, // <span class="keyword">set</span> <span class="keyword">to</span> <span class="keyword">a</span> <span class="keyword">number</span> <span class="keyword">to</span> turn <span class="keyword">on</span> <span class="keyword">a</span> limit <span class="keyword">for</span> the <span class="keyword">history</span> </div><div class="line"> </div><div class="line">  <span class="built_in">filter</span>: () =&gt; true, // see `Filtering Actions` section </div><div class="line"> </div><div class="line">  undoType: ActionTypes.UNDO, // define <span class="keyword">a</span> custom action <span class="built_in">type</span> <span class="keyword">for</span> this <span class="keyword">undo</span> action </div><div class="line">  redoType: ActionTypes.REDO, // define <span class="keyword">a</span> custom action <span class="built_in">type</span> <span class="keyword">for</span> this <span class="keyword">redo</span> action </div><div class="line"> </div><div class="line">  jumpToPastType: ActionTypes.JUMP_TO_PAST, // define custom action <span class="built_in">type</span> <span class="keyword">for</span> this jumpToPast action </div><div class="line">  jumpToFutureType: ActionTypes.JUMP_TO_FUTURE, // define custom action <span class="built_in">type</span> <span class="keyword">for</span> this jumpToFuture action </div><div class="line"> </div><div class="line">  initialState: undefined, // initial state (<span class="keyword">e</span>.g. <span class="keyword">for</span> loading) </div><div class="line">  initType<span class="variable">s:</span> [<span class="string">'@@redux/INIT'</span>, <span class="string">'@@INIT'</span>] // <span class="keyword">history</span> will <span class="keyword">be</span> (re)<span class="keyword">set</span> upon init action <span class="built_in">type</span> </div><div class="line">  initialHistory: &#123; // initial <span class="keyword">history</span> (<span class="keyword">e</span>.g. <span class="keyword">for</span> loading) </div><div class="line">    pas<span class="variable">t:</span> [],</div><div class="line">    presen<span class="variable">t:</span> config.initialState,</div><div class="line">    future: []</div><div class="line">  &#125;,</div><div class="line"> </div><div class="line">  debu<span class="variable">g:</span> false, // <span class="keyword">set</span> <span class="keyword">to</span> `true` <span class="keyword">to</span> turn <span class="keyword">on</span> debugging </div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="è¿‡æ»¤Actions"><a href="#è¿‡æ»¤Actions" class="headerlink" title="è¿‡æ»¤Actions"></a>è¿‡æ»¤Actions</h2><p>å¦‚æœä½ ä¸æƒ³åŒ…å«æ¯ä¸€æ­¥çš„action,å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°åˆ°<code>undoable</code><br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, <span class="keyword">function</span> <span class="title">filterActions</span>(action, currentState, previousState) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="type">action.type</span> === SOME_ACTION; // only add to history <span class="keyword">if</span> action <span class="keyword">is</span> SOME_ACTIONåªæœ‰some_actionçš„actionæ‰èƒ½è®°å½• </div><div class="line">&#125;)</div><div class="line"> </div><div class="line">// <span class="keyword">or</span> you could <span class="keyword">do</span>... </div><div class="line"> </div><div class="line">undoable(reducer, <span class="keyword">function</span> <span class="title">filterState</span>(action, currentState, previousState) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="type">currentState</span> !== previousState; // only add to history <span class="keyword">if</span> state changedåªæœ‰stateå˜åŒ–çš„æ‰èƒ½è®°å½•é‡åš </div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨<code>distinctState</code>,<code>includeAction</code>,<code>excludeAction</code>åŠ©æ‰‹å‡½æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123; distinctState, includeAction, excludeAction &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨åŠ©æ‰‹å‡½æ•°äº†,ç›¸å½“ç®€å•<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: includeAction(SOME_ACTION)</span></span> &#125;)</div><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: excludeAction(SOME_ACTION)</span></span> &#125;)</div><div class="line"> </div><div class="line"><span class="comment">// or you could do... </span></div><div class="line"> </div><div class="line"><span class="function"><span class="title">undoable</span><span class="params">(reducer, &#123; filter: distinctState()</span></span> &#125;)</div></pre></td></tr></table></figure></p>
<p>ç”šè‡³è¿˜æ”¯æŒæ•°ç»„<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">undoable</span>(<span class="selector-tag">reducer</span>, &#123; <span class="attribute">filter</span>: <span class="built_in">includeAction</span>([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div><div class="line"><span class="selector-tag">undoable</span>(<span class="selector-tag">reducer</span>, &#123; <span class="attribute">filter</span>: <span class="built_in">excludeAction</span>([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div></pre></td></tr></table></figure></p>
<h2 id="æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„"><a href="#æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„" class="headerlink" title="æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„"></a>æœ‰ä»€ä¹ˆé­”æ³•ï¼Ÿæ€ä¹ˆå·¥ä½œçš„</h2><p>Reduxæ–‡æ¡£ä¸­çš„<a href="https://rackt.github.io/redux/docs/recipes/ImplementingUndoHistory.html" target="_blank" rel="external"><code>å®ç°Undoå†å²çš„æ–¹æ¡ˆ</code></a>è§£é‡Šäº†redux-undoå·¥ä½œçš„å…·ä½“ç»†èŠ‚.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Reduxçš„æ–‡æ¡£ä¸­æä¾›ä¸€ä¸ªå¯ä»¥åšundo/redoçš„è§£å†³åŠæ³•,å®é™…æ˜¯æœ‰previous,current,prewçš„å¯¹è±¡,å›´ç»•è¿™æ•°æ®çš„å‹å…¥å’Œå¼¹å‡ºæ¥å®ç°æ“ä½œæ­¥éª¤çš„è®°å¿†,ç»“åˆpersistå°±å¯ä»¥å®ç°æ›´å¼ºå¤§çš„è®°å¿†åŠŸèƒ½.ä»Šå¤©çš„è¿™ä¸ªå¢å¼ºç»„ä»¶å®é™…æŠŠè¿™ä¸ªåŠŸèƒ½ç»™åŒ…è£…
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="http://yoursite.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Immutable Data Structures and JavaScript</title>
    <link href="http://yoursite.com/2017/04/04/%E7%BF%BB%E8%AF%91-Immutable-Data-Structures-and-JavaScript/"/>
    <id>http://yoursite.com/2017/04/04/ç¿»è¯‘-Immutable-Data-Structures-and-JavaScript/</id>
    <published>2017-04-04T12:28:01.000Z</published>
    <updated>2017-04-04T05:08:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ä¹…ä»¥å‰æˆ‘ç®€å•çš„è°ˆäº†è°ˆæˆ‘çš„æƒ³æ³•,æŠŠæœ€æ–°çš„blogé‡å†™ä¸€ä¸‹,å‘èª“è¦æ¶‰åŠä¸€äº›å­¦åˆ°çš„æœ‰æ·±åº¦çš„ä¸œè¥¿.ç°åœ¨æˆ‘è¦è°ˆè°ˆjavascriptä¸­çš„immutableæ•°æ®ç»“æ„,å°¤å…¶æ˜¯ä¸¤ä¸ªåº“<a href="https://github.com/facebook/immutable-js" target="_blank" rel="external">immutable.js</a>å’Œ<a href="https://github.com/rtfeldman/seamless-immutable" target="_blank" rel="external">seamliess-immutable</a>.è¿˜æœ‰å…¶ä»–çš„åº“,ä½†æ˜¯é€‰æ‹©æ ‡æ ‡å‡†æ˜¯çœŸæ­£çš„æŒä¹…æ•°æ®ç»“æ„æˆ–è€…æ‹·è´javascriptå¯¹è±¡çš„æ¦‚å¿µåŒºåˆ«.æ¯”è¾ƒè¿™ä¸¤ä¸ªé‡ç‚¹,ä¸è¦ç®¡åˆ°åº•æ˜¯é€‰æ‹©ä»€ä¹ˆåº“.æˆ‘è¿˜è¦è°ˆä¸€ç‚¹<a href="https://github.com/cognitect/transit-js" target="_blank" rel="external">transit-js</a>ï¼Œå®ƒåœ¨åšæ•°æ®çš„åºåˆ—åŒ–æ–¹é¢å¾ˆå¥½.</p>
<p>æœ‰å…³Reduxçš„åº”ç”¨è°ˆçš„å°‘ä¸€ç‚¹.å¤§ä½“æ˜¯è°ˆè°ˆimmutableæ•°æ®ç»“æ„çš„ä½¿ç”¨,ä½†æ˜¯ä¹Ÿæä¾›ä¸€äº›åœ¨Reduxä¸­ä½¿ç”¨çš„ç‰¹æ®Šç‚¹.åœ¨Reduxä¸­,ä½ æœ‰å•ä¸ªçš„stateå¯¹è±¡,å¹¶ä¸”ä¸å¤åˆ¶ä»–,æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„,æ¯ä¸€ä¸ªéƒ½æœ‰æ‰€æƒè¡¡.æˆ‘ä¼šåœ¨åœ¨ä¸‹é¢æ¢ç´¢ä¸€ä¸‹.</p>
<p>åœ¨Reduxä¸­æœ‰ä¸€ä»¶äº‹æ˜¯è¦è€ƒè™‘æ€ä¹ˆèšåˆreducersæ¥å½¢æˆå•ä¸ªçš„app stateåŸå­.Reduxé»˜è®¤æä¾›çš„æ–¹å¼(combineReducers)å‡å®šä½ æŠŠå¤šä¸ªå€¼åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„javascriptå¯¹è±¡.å¦‚æœä½ æƒ³æŠŠä»–ä»¬åˆå¹¶æˆä¸€ä¸ªImmutable.jså¯¹è±¡,ä¾‹å¦‚ä½ å¯èƒ½éœ€è¦ç¼–å†™ä½ è‡ªå·±çš„<em>combinReducers</em>æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„.è¿™ä¸€ç‚¹å¯èƒ½ä¼šéå¸¸æœ‰å¿…è¦å¦‚æœä½ éœ€è¦åºåˆ—åŒ–ä½ çš„app state,å¹¶ä¸”ä½ è®¾å®šstateæ•´ä¸ªéƒ½æ˜¯ç”±Immutable.jså¯¹è±¡ç»„æˆçš„.</p>
<p>å¤§å¤šæ•°è¿™ç§åº”ç”¨ä¸€èˆ¬éƒ½ä½¿ç”¨immutableå¯¹è±¡.æœ‰æ—¶å€™æœ‰ç‚¹å°´å°¬,å› ä¸ºä½ è¦å’Œé»˜è®¤çš„è¯­æ³•æ–—äº‰,è¿™æ„Ÿè§‰å°±åƒä½ åœ¨ç”¨typesç©æ‚è€.ç„¶è€Œ,æ ¹æ®ä½ çš„appå’Œä½ çš„é…ç½®,ä½ å¯ä»¥ä»ä¸­è·³å‡ºæ¥.</p>
<p>ç›®å‰,æœ‰ä¸€ä¸ªä¸ºåŸç”ŸJavascriptåº”ç”¨æ·»åŠ immutableæ•°æ®ç»“æ„çš„<a href="https://github.com/sebmarkbage/ecmascript-immutable-data-structures" target="_blank" rel="external">å»ºè®®</a></p>
<h2 id="Immutable-js"><a href="#Immutable-js" class="headerlink" title="Immutable.js"></a>Immutable.js</h2><p>Immutable.jsæ¥è‡ªFacebook,å®ƒæ˜¯å®ç°immutableæ•°æ®ç»“æ„æœ€æµè¡Œçš„æ–¹æ³•.è§„æ¨¡å¾ˆåºå¤§,ä½¿ç”¨ç±»ä¼¼<code>tries</code>çš„é«˜çº§æ–¹æ³•å®ç°ç»“æ„åŒ–å…±äº«,å®ç°æ•´ä¸ªæ•°æ®çš„æŒä¹…åŒ–.æ‰€æœ‰çš„æ›´æ–°éƒ½è¿”å›æ–°å€¼,ä½†æ˜¯å†…éƒ¨ç»“æ„æ˜¯å…±äº«çš„,è¿™ä¸€ç‚¹å¤§å¤§çš„é™ä½äº†å†…å­˜çš„ä½¿ç”¨(GC thrashing).è¿™å°±æ„å‘³ç€å¦‚æœä½ åº”ç”¨ä¸€ä¸ªæœ‰1000ä¸ªå…ƒç´ çš„çŸ¢é‡,ä»–ä¸ä¼šå®é™…åˆ›å»ºä¸€ä¸ªæœ‰1001ä¸ªå…ƒç´ çš„æ–°çŸ¢é‡.å¤§å¤šæ•°æƒ…å†µä¸‹,å†…éƒ¨ä»…ä»…æœ‰ä¸€äº›å°çš„å¯¹è±¡è¢«åˆ†é….</p>
<p>æ•°æ®ç»“æ„å…±äº«çš„å…ˆè¿›æ€§,å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ç”±Okasakiçš„å¼€åˆ›æ€§å·¥ä½œå¯å‘çš„,</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ä¹…ä»¥å‰æˆ‘ç®€å•çš„è°ˆäº†è°ˆæˆ‘çš„æƒ³æ³•,æŠŠæœ€æ–°çš„blogé‡å†™ä¸€ä¸‹,å‘èª“è¦æ¶‰åŠä¸€äº›å­¦åˆ°çš„æœ‰æ·±åº¦çš„ä¸œè¥¿.ç°åœ¨æˆ‘è¦è°ˆè°ˆjavascriptä¸­çš„immutableæ•°æ®ç»“æ„,å°¤å…¶æ˜¯ä¸¤ä¸ªåº“&lt;a href=&quot;https://github.com/facebook/immutable-js&quot; ta
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>Redux undo/redo</title>
    <link href="http://yoursite.com/2017/04/04/Redux-undo-redo/"/>
    <id>http://yoursite.com/2017/04/04/Redux-undo-redo/</id>
    <published>2017-04-04T00:18:11.000Z</published>
    <updated>2017-04-03T16:20:20.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="redux-undo-redo"><a href="#redux-undo-redo" class="headerlink" title="redux undo/redo"></a>redux undo/redo</h1><blockquote>
<p>è¿™æ˜¯æŠŠredux undoçš„å †æ ˆæ“ä½œæœ‰åŒ…è£…äº†ä¸€ä¸‹</p>
</blockquote>
<p><a href="https://www.npmjs.com/package/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-undo.svg?style=flat-square" alt="NPM version (&gt;=0.4)"></a> <a href="https://www.npmjs.com/package/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/npm/dm/redux-undo.svg?style=flat-square" alt="NPM Downloads"></a> <a href="https://coveralls.io/r/omnidan/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/coveralls/omnidan/redux-undo.svg?style=flat-square" alt="Coverage Status"></a> <a href="https://david-dm.org/omnidan/redux-undo" target="_blank" rel="external"><img src="https://img.shields.io/david/omnidan/redux-undo.svg?style=flat-square" alt="Dependencies"></a> <a href="http://standardjs.com/" target="_blank" rel="external"><img src="https://img.shields.io/badge/code%20style-standard-brightgreen.svg?style=flat-square" alt="js-standard-style"></a> <a href="https://raw.githubusercontent.com/omnidan/redux-undo/master/LICENSE.md" target="_blank" rel="external"><img src="https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square" alt="GitHub license"></a></p>
<p><em>simple undo/redo functionality for redux state containers</em></p>
<p><a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external"><img src="https://i.imgur.com/M2KR4uo.gif" alt="https://i.imgur.com/M2KR4uo.gif"></a></p>
<p><strong>Protip:</strong> Check out the <a href="https://github.com/omnidan/redux-undo/tree/master/examples/todos-with-undo" target="_blank" rel="external">todos-with-undo example</a> or the <a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external">redux-undo-boilerplate</a> to quickly get started with <code>redux-undo</code>.</p>
<p><strong>Switching from 0.x to 1.0 (beta):</strong> Make sure to update your programs to the <a href="#history-api">latest History API</a>.</p>
<hr>
<p><strong>This README is about the new 1.0-beta branch of redux-undo, if you are using<br>or plan on using 0.6, check out <a href="https://github.com/omnidan/redux-undo/tree/0.6" target="_blank" rel="external">the <code>0.6</code> branch</a></strong></p>
<hr>
<h2 id="Note-on-1-0-0-beta7"><a href="#Note-on-1-0-0-beta7" class="headerlink" title="Note on 1.0.0-beta7"></a>Note on 1.0.0-beta7</h2><p>If you use Redux Undo in CommonJS environment, <strong>donâ€™t forget to add <code>.default</code> to your import</strong>.</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="deletion">- var ReduxUndo = require('redux-undo')</span></div><div class="line"><span class="addition">+ var ReduxUndo = require('redux-undo').default</span></div></pre></td></tr></table></figure>
<p>If your environment support es modules just go by:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ReduxUndo <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>We are also supporting UMD build:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ReduxUndo = <span class="built_in">window</span>.ReduxUndo.default;</div></pre></td></tr></table></figure>
<p><strong>once again <code>.default</code> is required.</strong></p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">npm</span> install --save redux-undo@beta</div></pre></td></tr></table></figure>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div><div class="line">undoable(reducer)</div><div class="line">undoable(reducer, config)</div></pre></td></tr></table></figure>
<h2 id="Making-your-reducers-undoable"><a href="#Making-your-reducers-undoable" class="headerlink" title="Making your reducers undoable"></a>Making your reducers undoable</h2><p><code>redux-undo</code> is a reducer enhancer (higher-order reducer), it provides the <code>undoable</code> function, which<br>takes an existing reducer and a configuration object and enhances your existing<br>reducer with undo functionality.</p>
<p><strong>Note:</strong> If you were accessing <code>state.counter</code> before, you have to access<br><code>state.counter.present</code> after wrapping your reducer with <code>undoable</code>.</p>
<p>To install, firstly import <code>redux-undo</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Redux utility functions</span></div><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="comment">// redux-undo higher-order reducer</span></div><div class="line"><span class="keyword">import</span> undoable <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Then, add <code>undoable</code> to your reducer(s) like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">combineReducers(&#123;</div><div class="line">  <span class="attr">counter</span>: undoable(counter)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>A <a href="#configuration">configuration</a> can be passed like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">combineReducers(&#123;</div><div class="line">  <span class="attr">counter</span>: undoable(counter, &#123;</div><div class="line">    <span class="attr">limit</span>: <span class="number">10</span> <span class="comment">// set a limit for the history</span></div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="History-API"><a href="#History-API" class="headerlink" title="History API"></a>History API</h2><p>Wrapping your reducer with <code>undoable</code> makes the state look like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">past</span>: [...pastStatesHere...],</div><div class="line">  <span class="attr">present</span>: &#123;...currentStateHere...&#125;,</div><div class="line">  <span class="attr">future</span>: [...futureStatesHere...]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now you can get your current state like this: <code>state.present</code></p>
<p>And you can access all past states (e.g. to show a history) like this: <code>state.past</code></p>
<h2 id="Undo-Redo-Actions"><a href="#Undo-Redo-Actions" class="headerlink" title="Undo/Redo Actions"></a>Undo/Redo Actions</h2><p>Firstly, import the undo/redo action creators:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Then, you can use <code>store.dispatch()</code> and the undo/redo action creators to<br>perform undo/redo operations on your state:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">store.dispatch(ActionCreators.undo()) <span class="comment">// undo the last action</span></div><div class="line">store.dispatch(ActionCreators.redo()) <span class="comment">// redo the last action</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.jump(<span class="number">-2</span>)) <span class="comment">// undo 2 steps</span></div><div class="line">store.dispatch(ActionCreators.jump(<span class="number">5</span>)) <span class="comment">// redo 5 steps</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.jumpToPast(index)) <span class="comment">// jump to requested index in the past[] array</span></div><div class="line">store.dispatch(ActionCreators.jumpToFuture(index)) <span class="comment">// jump to requested index in the future[] array</span></div><div class="line"></div><div class="line">store.dispatch(ActionCreators.clearHistory()) <span class="comment">// [beta only] Remove all items from past[] and future[] arrays</span></div></pre></td></tr></table></figure>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>A configuration object can be passed to <code>undoable()</code> like this (values shown<br>are default values):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">limit</span>: <span class="literal">false</span>, <span class="comment">// set to a number to turn on a limit for the history</span></div><div class="line"></div><div class="line">  filter: <span class="function"><span class="params">()</span> =&gt;</span> <span class="literal">true</span>, <span class="comment">// see `Filtering Actions` section</span></div><div class="line"></div><div class="line">  undoType: ActionTypes.UNDO, <span class="comment">// define a custom action type for this undo action</span></div><div class="line">  redoType: ActionTypes.REDO, <span class="comment">// define a custom action type for this redo action</span></div><div class="line"></div><div class="line">  jumpType: ActionTypes.JUMP, <span class="comment">// define custom action type for this jump action</span></div><div class="line"></div><div class="line">  jumpToPastType: ActionTypes.JUMP_TO_PAST, <span class="comment">// define custom action type for this jumpToPast action</span></div><div class="line">  jumpToFutureType: ActionTypes.JUMP_TO_FUTURE, <span class="comment">// define custom action type for this jumpToFuture action</span></div><div class="line"></div><div class="line">  clearHistoryType: ActionTypes.CLEAR_HISTORY, <span class="comment">// [beta only] define custom action type for this clearHistory action</span></div><div class="line">  <span class="comment">// you can also pass an array of strings to define several action types that would clear the history</span></div><div class="line">  <span class="comment">// beware: those actions will not be passed down to the wrapped reducers</span></div><div class="line"></div><div class="line">  initTypes: [<span class="string">'@@redux-undo/INIT'</span>] <span class="comment">// history will be (re)set upon init action type</span></div><div class="line">  <span class="comment">// beware: those actions will not be passed down to the wrapped reducers</span></div><div class="line"></div><div class="line">  debug: <span class="literal">false</span>, <span class="comment">// set to `true` to turn on debugging</span></div><div class="line"></div><div class="line">  neverSkipReducer: <span class="literal">false</span>, <span class="comment">// prevent undoable from skipping the reducer on undo/redo and clearHistoryType actions</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p><strong>Note:</strong> If you want to use just the <code>initTypes</code> functionality, but not import<br>the whole redux-undo library, use <a href="https://github.com/omnidan/redux-recycle" target="_blank" rel="external">redux-recycle</a>!</p>
<h4 id="Initial-State-and-History"><a href="#Initial-State-and-History" class="headerlink" title="Initial State and History"></a>Initial State and History</h4><p>You can use your redux store to set an initial history for your undoable reducers:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> initialHistory = &#123;</div><div class="line">  <span class="attr">past</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">  <span class="attr">present</span>: <span class="number">4</span>,</div><div class="line">  <span class="attr">future</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(undoable(counter), initialHistory);</div></pre></td></tr></table></figure>
<p>Or just set the current state like youâ€™re used to with Redux. Redux-undo will create the history for you:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(undoable(counter), &#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">// will make the state look like this:</span></div><div class="line">&#123;</div><div class="line">  <span class="attr">past</span>: [],</div><div class="line">  <span class="attr">present</span>: &#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;,</div><div class="line">  <span class="attr">future</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Filtering-Actions"><a href="#Filtering-Actions" class="headerlink" title="Filtering Actions"></a>Filtering Actions</h3><p>If you donâ€™t want to include every action in the undo/redo history, you can<br>add a <code>filter</code> function to <code>undoable</code>. <code>redux-undo</code> provides you with the<br><code>includeAction</code> and <code>excludeAction</code> helpers for basic filtering.</p>
<p>They should be imported like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123; includeAction, excludeAction &#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span>;</div></pre></td></tr></table></figure>
<p>Now you can use the helper functions:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: includeAction(SOME_ACTION) &#125;)</div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: excludeAction(SOME_ACTION) &#125;)</div><div class="line"></div><div class="line"><span class="comment">// they even support Arrays:</span></div><div class="line"></div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: includeAction([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div><div class="line">undoable(reducer, &#123; <span class="attr">filter</span>: excludeAction([SOME_ACTION, SOME_OTHER_ACTION]) &#125;)</div></pre></td></tr></table></figure>
<p><strong>Note:</strong> Since <a href="https://github.com/omnidan/redux-undo/releases/tag/beta4" target="_blank" rel="external"><code>beta4</code></a>,<br>          only actions resulting in a new state are recorded. This means the<br>          (now deprecated) <code>distinctState()</code> filter is auto-applied.</p>
<h4 id="Custom-filters"><a href="#Custom-filters" class="headerlink" title="Custom filters"></a>Custom filters</h4><p>If you want to create your own filter, pass in a function with the signature<br><code>(action, currentState, previousHistory)</code>. For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: <span class="function"><span class="keyword">function</span> <span class="title">filterActions</span>(<span class="params">action, currentState, previousHistory</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> action.type === SOME_ACTION; <span class="comment">// only add to history if action is SOME_ACTION</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// The entire `history` state is available to your filter, so you can make</span></div><div class="line"><span class="comment">// decisions based on past or future states:</span></div><div class="line"></div><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: <span class="function"><span class="keyword">function</span> <span class="title">filterState</span>(<span class="params">action, currentState, previousHistory</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> &#123; past, present, future &#125; = previousHistory;</div><div class="line">    <span class="keyword">return</span> future.length === <span class="number">0</span>; <span class="comment">// only add to history if future is empty</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Combining-Filters"><a href="#Combining-Filters" class="headerlink" title="Combining Filters"></a>Combining Filters</h3><p>You can also use our helper to combine filters.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> undoable, &#123;combineFilters&#125; <span class="keyword">from</span> <span class="string">'redux-undo'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isActionSelfExcluded</span>(<span class="params">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> action.wouldLikeToBeInHistory</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">areWeRecording</span>(<span class="params">action, state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.recording</div><div class="line">&#125;</div><div class="line"></div><div class="line">undoable(reducer, &#123;</div><div class="line">  <span class="attr">filter</span>: combineFilters(isActionSelfExcluded, areWeRecording)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Ignoring-Actions"><a href="#Ignoring-Actions" class="headerlink" title="Ignoring Actions"></a>Ignoring Actions</h3><p>When implementing a filter function, it only prevents the old state from being<br>stored in the history. <strong><code>filter</code> does not prevent the present state from being<br>updated.</strong></p>
<p>If you want to ignore an action completely, as in, not even update the present<br>state, you can make use of <a href="https://github.com/omnidan/redux-ignore" target="_blank" rel="external">redux-ignore</a>.</p>
<p>It can be used like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; ignoreActions &#125; <span class="keyword">from</span> <span class="string">'redux-ignore'</span></div><div class="line"></div><div class="line">ignoreActions(</div><div class="line">  undoable(reducer),</div><div class="line">  [IGNORED_ACTION, ANOTHER_IGNORED_ACTION]</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// or define your own function:</span></div><div class="line"></div><div class="line">ignoreActions(</div><div class="line">  undoable(reducer),</div><div class="line">  (action) =&gt; action.type === SOME_ACTION <span class="comment">// only add to history if action is SOME_ACTION</span></div><div class="line">)</div></pre></td></tr></table></figure>
<h2 id="What-is-this-magic-How-does-it-work"><a href="#What-is-this-magic-How-does-it-work" class="headerlink" title="What is this magic? How does it work?"></a>What is this magic? How does it work?</h2><p>Have a read of the <a href="http://redux.js.org/docs/recipes/ImplementingUndoHistory.html" target="_blank" rel="external">Implementing Undo History recipe</a> in the Redux documents, which explains in detail how redux-undo works.</p>
<h2 id="Gitter-Chat-Support"><a href="#Gitter-Chat-Support" class="headerlink" title="Gitter Chat / Support"></a>Gitter Chat / Support</h2><p>If you have a question or just want to discuss something with other redux-undo users/maintainers, <a href="https://gitter.im/omnidan/redux-undo" target="_blank" rel="external">chat with the community on gitter.im/omnidan/redux-undo</a></p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT, see <code>LICENSE.md</code> for more information.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;redux-undo-redo&quot;&gt;&lt;a href=&quot;#redux-undo-redo&quot; class=&quot;headerlink&quot; title=&quot;redux undo/redo&quot;&gt;&lt;/a&gt;redux undo/redo&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯æŠŠre
    
    </summary>
    
      <category term="Readme" scheme="http://yoursite.com/categories/Readme/"/>
    
    
      <category term="Redux" scheme="http://yoursite.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|Simple React Native forms with redux-form, immutable.js and styled-components - Esben Petersen</title>
    <link href="http://yoursite.com/2017/04/04/%E7%BF%BB%E8%AF%91-Simple-React-Native-forms-with-redux-form-immutable-js-and-styled-components-Esben-Petersen/"/>
    <id>http://yoursite.com/2017/04/04/ç¿»è¯‘-Simple-React-Native-forms-with-redux-form-immutable-js-and-styled-components-Esben-Petersen/</id>
    <published>2017-04-03T16:07:15.000Z</published>
    <updated>2017-04-03T12:09:10.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åœ¨Reactä¸­å¤„ç†è¡¨å•è¿˜ä¸æ€ä¹ˆå¥½å¼„,çœ‹çœ‹è¿™ç¯‡æ–‡ç« è®²çš„æŒºå¥½çš„çœ‹çœ‹,è¯•ç€ç¿»è¯‘ä¸€ä¸‹<br>  <a href="http://esbenp.github.io/2017/01/06/react-native-redux-form-immutable-styled-components/" target="_blank" rel="external">åŸæ–‡å‚çœ‹</a></p>
</blockquote>
<h1 id="start"><a href="#start" class="headerlink" title="start"></a>start</h1><p>å¦‚æœä½ æƒ³çœ‹çœ‹æ€ä¹ˆåœ¨react-native æƒ³ä½¿ç”¨redux-formå’Œimmutable.js.ä½ çœ‹å¯ä»¥çœ‹çœ‹<a href="https://github.com/esbenp/react-native-redux-form-example" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« çš„ä»£ç </a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>åœ¨<code>Traede</code>,æˆ‘ä½¿ç”¨reduxæ•´åˆredux-formæ¥åˆ›å»ºè¡¨å•.redux-formæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„åº“,ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆå¥½çš„ç¤ºä¾‹ä»£ç ä»‹ç»æ€ä¹ˆå’ŒReact-nativeé…åˆä½¿ç”¨.æ‰€ä»¥å½“æˆ‘å¼€å§‹åœ¨React-Natvieä¸­ä½¿ç”¨redux-formçš„æ—¶å€™,å‘ç°è¿˜æ˜¯æœ‰ä¸€ç‚¹éš¾åº¦çš„.å¤§å¤šæ•°çš„æƒ…å†µéƒ½å› ä¸ºæˆ‘å‘ç°åœ¨React-Nativeä¸­ä½¿ç”¨Immutable.jsçš„æ—¶å€™ä¼šä¸­æ–­redux-formè¿è¡Œçš„bug.Redux-formä¸»ç‰ˆæœ¬å·å·²ç»åˆ°äº†6.4.2äº†.æ‰€ä»¥æˆ‘è€ƒè™‘å¯ä»¥æ ¹æ®æˆ‘çš„å­¦ä¹ è¿‡ç¨‹æ¥å†™ä¸€ç‚¹æ€ä¹ˆåœ¨åº”ç”¨ä¸­åŒæ—¶ä½¿ç”¨redux-formå’ŒImmutable.jsçš„æ–‡æ¡£.</p>
<h2 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h2><p>å¤§ä½“çš„æ­¥éª¤æ˜¯:</p>
<ol>
<li>çœ‹çœ‹redux-formåœ¨nativeå’Œwebä¹‹é—´çš„å·®å¼‚ç‚¹</li>
<li>çœ‹çœ‹æ€ä¹ˆä½¿redux-formå’ŒImmutable.jsä¸€èµ·ä½¿ç”¨</li>
<li>ä½¿ç”¨react-native-clean-formçš„å®Œæ•´å®ä¾‹</li>
</ol>
<p>é¸¡å†»ä¸ï¼Ÿå¥½äº†,å¼€å§‹äº†</p>
<h2 id="åœ¨React-nativeä¸­ä½¿ç”¨redux-form"><a href="#åœ¨React-nativeä¸­ä½¿ç”¨redux-form" class="headerlink" title="åœ¨React-nativeä¸­ä½¿ç”¨redux-form"></a>åœ¨React-nativeä¸­ä½¿ç”¨redux-form</h2><p>å¦‚æœä½ ä¸å¤ªç†Ÿæ‚‰redux-form,æˆ‘å»ºè®®ä½ çœ‹çœ‹<a href="http://redux-form.com/6.4.3/docs/GettingStarted.md/" target="_blank" rel="external">redux-formç®€å•æ–‡æ¡£</a><br>.<em>æ³¨æ„ï¼šè¿™ä¸ªæŒ‡å—å‡å®šä½ ä½¿ç”¨çš„redux-formçš„ç‰ˆæœ¬å¤§äº6.4.2</em>.å¦‚æœä¸æ˜¯è¿™ä¸ªç‰ˆæœ¬,å¹¶ä¸”è¿˜åœ¨ä½¿ç”¨Immutable.js,é‚£ä¹ˆè¦çœ‹çœ‹è¿™ä¸ª<a href="https://github.com/erikras/redux-form/pull/2336" target="_blank" rel="external">issue</a>.åˆ›å»ºä¸€ä¸ªè¡¨å•åŸºç¡€çš„ä¸‰ä¸ªæ­¥éª¤æ˜¯:</p>
<ol>
<li>åœ¨ä½ çš„redux storeä¸­åŠ å…¥redux-form reducer</li>
<li>ä½¿ç”¨<code>reduxForm</code>åŒ…è£…å™¨æŠŠä½ çš„è¡¨å•è¿æ¥åˆ°store</li>
<li>ä½¿ç”¨<code>Field</code>åŒ…è£…å™¨æŠŠç‰¹å®šçš„è¡¨å•å­—æ®µè¿æ¥åˆ°Store</li>
</ol>
<h3 id="0-åˆ›å»ºReact-Native-é¡¹ç›®"><a href="#0-åˆ›å»ºReact-Native-é¡¹ç›®" class="headerlink" title="0. åˆ›å»ºReact Native é¡¹ç›®"></a>0. åˆ›å»ºReact Native é¡¹ç›®</h3><p>å‡è®¾ä½ å·²ç»æœ‰äº†å¯ä»¥è¿è¡Œçš„React Nativeé¡¹ç›®.å¦‚æœæ²¡æœ‰,ä½¿ç”¨<code>react-native init MyReduxFormProjct</code>ç»ˆç«¯å‘½ä»¤è¡Œå‘½ä»¤ä¹Ÿå¾ˆå®¹æ˜“åˆ›å»ºé¡¹ç›®.</p>
<h3 id="1-æŠŠredux-form-reduceræ·»åŠ åˆ°ä½ çš„redux-store"><a href="#1-æŠŠredux-form-reduceræ·»åŠ åˆ°ä½ çš„redux-store" class="headerlink" title="1.æŠŠredux-form reduceræ·»åŠ åˆ°ä½ çš„redux store"></a>1.æŠŠredux-form reduceræ·»åŠ åˆ°ä½ çš„redux store</h3><p>åšè¿™ä¸€æ­¥,è¯·å‚è€ƒ<a href="http://redux-form.com/6.4.3/docs/GettingStarted.md/" target="_blank" rel="external">redux-formæ–‡æ¡£</a></p>
<h3 id="2-ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store"><a href="#2-ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store" class="headerlink" title="2.ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store"></a>2.ä½¿ç”¨redux-formåŒ…è£…å™¨æŠŠä½ çš„formè¿æ¥åˆ°store</h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„è¡¨å•æ¥å¼€å§‹å·¥ä½œ.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  TextInput,</div><div class="line">  TouchableOpacity,</div><div class="line">  View</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Form = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TextInput</span> <span class="attr">style</span>=<span class="string">&#123;styles.input&#125;</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.button&#125;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default Form</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  button: &#123;</div><div class="line">    backgroundColor: 'blue',</div><div class="line">    color: 'white',</div><div class="line">    height: 30,</div><div class="line">    lineHeight: 30,</div><div class="line">    marginTop: 10,</div><div class="line">    textAlign: 'center',</div><div class="line">    width: 250</div><div class="line">  &#125;,</div><div class="line">  container: &#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  input: &#123;</div><div class="line">    borderColor: 'black',</div><div class="line">    borderWidth: 1,</div><div class="line">    height: 37,</div><div class="line">    width: 250</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcly1fe9qllp362j30680b4743.jpg" alt=""></p>
<p>å¥½äº†,æˆ‘ä»¬å·²ç»æœ‰äº†è¡¨å•,çœ‹èµ·æ¥å’Œåäº¿ç¾å…ƒçº§åˆ«çš„appå·®ä¸å¤š.ä¸‹é¢æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>reduxForm</code>åŒ…è£…å™¨æŠŠè¡¨å•è¿æ¥åˆ°redux formä¸Š.è¿™æ˜¯å› ä¸ºåœ¨è¡¨å•ä¸­çš„æ¯ä¸€ä¸ªæŒ‰é”®æ“ä½œéƒ½ä¼šå‘é€è¾“å…¥å­—æ®µçš„å€¼åˆ°store.å½“æˆ‘ä»¬æŒ‰ä¸‹æäº¤æŒ‰é’®,redux-formå°†ä¼šä»storeä¸­è·å–ä¿å­˜çš„å€¼å‘é€åˆ°ä¸€ä¸ªæˆ‘ä»¬å®šåˆ¶çš„å›è°ƒå‡½æ•°.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; reduxForm &#125; <span class="keyword">from</span> <span class="string">'redux-form'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> submit = <span class="function"><span class="params">values</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'submitting form'</span>, values)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Form = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> &#123; handleSubmit &#125; = props</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TextInput</span> <span class="attr">style</span>=<span class="string">&#123;styles.input&#125;</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;handleSubmit(submit)&#125;</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.button&#125;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(&#123;</div><div class="line">  form: 'test'</div><div class="line">&#125;)(Form)</div></pre></td></tr></table></figure>
<p><em>æ³¨é‡Šï¼šä¸ºäº†ç®€å•,çœç•¥äº†æ ·å¼å’Œå¯¹è±¡çš„å¯¼å…¥ä»£ç </em></p>
<p>å¥½äº†,é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>reduxForm</code>åŒ…è£…formå¹¶è¿æ¥åˆ°store.è¿™æ˜¯<code>react-redux</code>çš„åŸºç¡€ç‰ˆæœ¬ä¹‹ä¸Šçš„ä¸€ç‚¹ä¿®æ”¹,å¯èƒ½ä½ æ¯”è¾ƒç†Ÿæ‚‰äº†.</p>
<p>æ¥ç€,æˆ‘ä»¬ä½¿ç”¨äº†redux-formçš„<code>handleSubmit</code>(è¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡<code>redux-Formæ³¨å…¥åˆ°ç»„ä»¶ä¸­çš„</code>).submitå‡½æ•°é™„åŠ åˆ°æˆ‘ä»¬çš„submitæŒ‰é’®ä¸Š,æ‰€ä»¥ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™,è¡¨å•ä¼šè¢«æäº¤.è¿™ä¸€ç‚¹å’Œwebå¼€å‘çš„submitå‡½æ•°æ˜¯ä¸åŒçš„,webå¼€å‘ä¸­è¿™ä¸ªå‡½æ•°é™„åŠ åˆ°formå…ƒç´ ä¸Š.åœ¨ç§»åŠ¨å¹³å°ä¸Šæ²¡æœ‰formå…ƒç´ ,æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠå®ƒæ·»åŠ åˆ°buttonä¸Š,æˆ–è€…<code>TouchableOpaticy</code>.å°±æ˜¯è¿™ä¹ˆå›äº‹.</p>
<p>åˆ°äº†è¿™ä¸€æ­¥,å¯ä»¥ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œä»£ç è¯•è¯•.æˆ‘é«˜åº¦æ¨è<code>react-native-debugger</code>ä½œä¸ºDebugger.ä½ å¯ä»¥çœ‹çœ‹<a href="https://facebook.github.io/react-native/docs/debugging.html" target="_blank" rel="external">React Native æœ‰å…³deguggingæ–‡æ¡£</a>çš„å»ºè®®.</p>
<p>å½“ä½ åœ¨æ¨¡æ‹Ÿå™¨ä¸­è¯•ç€ç‚¹å‡»æäº¤è¡¨å•æ—¶,ä½ å¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°è¿”å›äº†ç©ºå€¼.</p>
<p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fe9qmb54t8j31aq0e0dh3.jpg" alt=""></p>
<p>å€¼åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<h3 id="3-ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store"><a href="#3-ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store" class="headerlink" title="3.ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store"></a>3.ä½¿ç”¨FieldåŒ…è£…å™¨æŠŠfieldsè¿æ¥åˆ°store</h3><p>æ‰€ä»¥è¯´,redux-formè¦å·¥ä½œ,ä½ å¿…é¡»è¦ä½¿ç”¨<code>Field</code>åŒ…è£…å™¨æŠŠæ¯ä¸€ä¸ªfieldè¿æ¥åˆ°store.</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="xml"> import </span><span class="template-variable">&#123; Field, reduxForm &#125;</span><span class="xml"> from 'redux-form'</span></div><div class="line"></div><div class="line">const submit = values =&gt; <span class="template-variable">&#123;</span></div><div class="line">  console.log('submitting form', values)</div><div class="line">&#125;<span class="xml"></span></div><div class="line"></div><div class="line">const renderInput = (<span class="template-variable">&#123; input: &#123; onChange, ...restInput &#125;</span><span class="xml">&#125;) =&gt; </span><span class="template-variable">&#123;</span></div><div class="line">  return &lt;TextInput style=&#123;styles.input&#125;<span class="xml"> onChangeText=</span><span class="template-variable">&#123;onChange&#125;</span><span class="xml"> </span><span class="template-variable">&#123;...restInput&#125;</span><span class="xml"> /&gt;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">const Form = props =&gt; <span class="template-variable">&#123;</span></div><div class="line">  const &#123; handleSubmit &#125;<span class="xml"> = props</span></div><div class="line"></div><div class="line">  return (</div><div class="line">    <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.container&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">component</span>=</span><span class="template-variable">&#123;renderInput&#125;</span><span class="xml"><span class="tag"> /&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=</span><span class="template-variable">&#123;handleSubmit(submit)&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.button&#125;</span><span class="xml"><span class="tag">&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(<span class="template-variable">&#123;</span></div><div class="line">  form: 'test'</div><div class="line">&#125;<span class="xml">)(Form)</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„,æˆ‘ä»¬æ·»åŠ äº†<code>Field</code>ç»„ä»¶,ç»™å®šäº†nameå±æ€§,å’Œwebå¼€å‘ä¸­çš„<code>input</code>fieldå·¥ä½œæ˜¯ç±»ä¼¼çš„.æˆ‘ä»¬ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ¸²æŸ“å‡½æ•°å‘Šè¯‰reduxForm,è¿™ä¸ªå­—æ®µåº”è¯¥æ€ä¹ˆæ¸²æŸ“.(åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ª<code>TextInput</code>ç»„ä»¶).</p>
<p><em>ç°åœ¨</em>è¿™é‡Œæœ‰äº›å°æŠ€å·§,å¾ˆå¤šäººå¯èƒ½ä¼šå‡ºé”™.<strong>æ‰€ä»¥ç•™å¿ƒä¸€ä¸‹</strong>.åœ¨web Reacä¸­<code>input</code>ç»„ä»¶ä¸­,å½“fieldçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶,è§¦å‘ä¸€ä¸ª<code>onChange</code>å›è°ƒå‡½æ•°.åœ¨React Nativeä¸­<code>TextInput</code>ç»„ä»¶è§¦å‘çš„æ˜¯<code>onChangeText</code>å›è°ƒå‡½æ•°.ä¸ºäº†åº”å¯¹è¿™ä¸ªé—®é¢˜,æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ å˜åŒ–çš„å¥æŸ„<code>onChangeText={onChange}</code>.</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcly1fe9qmuwabmj31ao0cmdh6.jpg" alt=""><br>ç°åœ¨å½“æˆ‘ä»¬æäº¤çš„æ—¶å€™,è¡¨å•å·¥ä½œäº†.</p>
<h2 id="ä½¿ç”¨Immutable-jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ"><a href="#ä½¿ç”¨Immutable-jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ" class="headerlink" title="ä½¿ç”¨Immutable.jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ"></a>ä½¿ç”¨Immutable.jsæ—¶å€™ä¹Ÿå¯ä»¥å·¥ä½œ</h2><p>å¦‚æœä½ æƒ³åœ¨stateçš„ç®¡ç†ä¸­ä½¿ç”¨immutable.js,é‚£ä¹ˆéœ€è¦ä¸€äº›é¢å¤–çš„æ­¥éª¤äº†é…åˆredux-formå·¥ä½œ.æˆ‘å»ºè®®ä½ è¯»è¯»<a href="http://redux-form.com/6.4.3/examples/immutable/" target="_blank" rel="external">ä½¿ç”¨immutable.jså’Œredux-formçš„å®˜æ–¹æ–‡æ¡£</a>.ä½†æ˜¯æˆ‘ä»¬é€šè¿‡ä¸€äº›æ­¥éª¤é©¬ä¸Šå¼€å§‹.</p>
<h3 id="1-ä½¿ç”¨redux-immutablejs-combineReducerså’Œredux-form-reducerçš„immutableç‰ˆæœ¬"><a href="#1-ä½¿ç”¨redux-immutablejs-combineReducerså’Œredux-form-reducerçš„immutableç‰ˆæœ¬" class="headerlink" title="1.ä½¿ç”¨redux-immutablejs combineReducerså’Œredux-form reducerçš„immutableç‰ˆæœ¬"></a>1.ä½¿ç”¨redux-immutablejs combineReducerså’Œredux-form reducerçš„immutableç‰ˆæœ¬</h3><p>æ‰¾åˆ°ä½ ç©¿ä»¶redux storeçš„ä»£ç å¤„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux-immutablejs'</span></div><div class="line"><span class="keyword">import</span> &#123; reducer <span class="keyword">as</span> form &#125; <span class="keyword">from</span> <span class="string">'redux-form/immutable'</span> <span class="comment">// &lt;--- immutable import</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> reducer = combineReducers(&#123; form &#125;)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸¤ä»¶äº‹:(1)ä½ å¿…é¡»ä½¿ç”¨ä»redux-immutableæˆ–è€…redux-immutablejsæ³¨å…¥<code>combineReducers</code>æ–¹æ³•.é‡è¦çš„æ˜¯è¾“å…¥çš„reduceræ˜¯ä»<code>redux-form/immutable</code>.<strong>å¹¶ä¸æ˜¯redux-form</strong>.</p>
<h3 id="2-ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬"><a href="#2-ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬" class="headerlink" title="2.ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬"></a>2.ä½¿ç”¨reduxFormåŒ…è£…å™¨å’ŒFieldçš„immutableç‰ˆæœ¬</h3><p>è¿™ä¸€æ­¥å’Œç¬¬ä¸€æ­¥å®é™…æœ‰ç‚¹ç±»ä¼¼.å½“ä½ åœ¨<code>reduxForm</code>ä¸­åŒ…è£…ä¸€ä¸ªè¡¨å•è¿æ¥åˆ°redux storeçš„æ—¶å€™,ç¡®ä¿æ˜¯ä»<code>redux-form/immutable</code>å¯¼å…¥çš„.ç±»ä¼¼<br><code>Field</code>ä¹Ÿæ˜¯ä»è¿™é‡Œå¯¼å…¥çš„.<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="xml">import </span><span class="template-variable">&#123; Field, reduxForm &#125;</span><span class="xml"> from 'redux-form/immutable' // <span class="tag">&lt;<span class="name">----</span> <span class="attr">LOOK</span> <span class="attr">HERE</span></span></span></div><div class="line"></div><div class="line"><span class="attr">const</span> <span class="attr">submit</span> = <span class="string">values</span> =&gt; <span class="template-variable">&#123;</span></div><div class="line">  console.log('submitting form', values.toJS()) &lt;--- use toJS() to cast to plain object</div><div class="line">&#125;<span class="xml"></span></div><div class="line"></div><div class="line">const renderInput = (<span class="template-variable">&#123; input: &#123; onChange, ...restInput &#125;</span><span class="xml">&#125;) =&gt; </span><span class="template-variable">&#123;</span></div><div class="line">  return &lt;TextInput style=&#123;styles.input&#125;<span class="xml"> onChangeText=</span><span class="template-variable">&#123;onChange&#125;</span><span class="xml"> </span><span class="template-variable">&#123;...restInput&#125;</span><span class="xml"> /&gt;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">const Form = props =&gt; <span class="template-variable">&#123;</span></div><div class="line">  const &#123; handleSubmit &#125;<span class="xml"> = props</span></div><div class="line"></div><div class="line">  return (</div><div class="line">    <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.container&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">component</span>=</span><span class="template-variable">&#123;renderInput&#125;</span><span class="xml"><span class="tag"> /&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=</span><span class="template-variable">&#123;handleSubmit(submit)&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=</span><span class="template-variable">&#123;styles.button&#125;</span><span class="xml"><span class="tag">&gt;</span>Submit<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default reduxForm(<span class="template-variable">&#123;</span></div><div class="line">  form: 'test'</div><div class="line">&#125;<span class="xml">)(Form)</span></div></pre></td></tr></table></figure></p>
<h3 id="3-å®Œæˆäº†"><a href="#3-å®Œæˆäº†" class="headerlink" title="3.å®Œæˆäº†"></a>3.å®Œæˆäº†</h3><p>å°±è¿™äº›å†…å®¹,æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ</p>
<h2 id="åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app"><a href="#åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app" class="headerlink" title="åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app"></a>åŠ ç‚¹æ ·å¼ç»„ä»¶è®©æˆ‘ä»¬çš„appçœ‹èµ·æ¥åƒåäº¿ç¾å…ƒçº§åˆ«çš„app</h2><p>ä½¿ç”¨ç»å¯¹é…·ç‚«çš„Reactæ ·å¼åº“<a href="https://github.com/styled-components/styled-components" target="_blank" rel="external">styled-components</a> .<br>çœ‹çœ‹æºä»£ç <a href="https://github.com/esbenp/react-native-clean-form" target="_blank" rel="external">esbenp/react-native-clean-form</a></p>
<h3 id="ç¬¬ä¸€æ­¥-å®‰è£…react-native-clean-form"><a href="#ç¬¬ä¸€æ­¥-å®‰è£…react-native-clean-form" class="headerlink" title="ç¬¬ä¸€æ­¥:å®‰è£…react-native-clean-form"></a>ç¬¬ä¸€æ­¥:å®‰è£…react-native-clean-form</h3><p>ä½¿ç”¨<code>npm install â€”save react-native-clean-form</code>å®‰è£…formå…ƒç´ .<br>ä¹Ÿéœ€è¦vector icon fonts.<a href="https://github.com/esbenp/react-native-clean-form#installation" target="_blank" rel="external">Readme</a></p>
<h3 id="ç¬¬äºŒæ­¥-è®¾è®¡é…·ç‚«çš„è¡¨å•"><a href="#ç¬¬äºŒæ­¥-è®¾è®¡é…·ç‚«çš„è¡¨å•" class="headerlink" title="ç¬¬äºŒæ­¥:è®¾è®¡é…·ç‚«çš„è¡¨å•"></a>ç¬¬äºŒæ­¥:è®¾è®¡é…·ç‚«çš„è¡¨å•</h3><p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fe9qnc5uf1j30ku0cdaag.jpg" alt=""></p>
<p>çœ‹çœ‹ä»£ç </p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="xml"> import React, </span><span class="template-variable">&#123; Component &#125;</span><span class="xml"> from 'react'</span></div><div class="line">import <span class="template-variable">&#123;</span></div><div class="line">  ActionsContainer,</div><div class="line">  Button,</div><div class="line">  FieldsContainer,</div><div class="line">  Fieldset,</div><div class="line">  Form,</div><div class="line">  FormGroup,</div><div class="line">  Label,</div><div class="line">  Input,</div><div class="line">  <span class="keyword">Select</span>,</div><div class="line">  Switch</div><div class="line">&#125;<span class="xml"> from 'react-native-clean-form'</span></div><div class="line"></div><div class="line">const countryOptions = [</div><div class="line">  <span class="template-variable">&#123;label: 'Denmark', value: 'DK'&#125;</span><span class="xml">,</span></div><div class="line">  <span class="template-variable">&#123;label: 'Germany', value: 'DE'&#125;</span><span class="xml">,</span></div><div class="line">  <span class="template-variable">&#123;label: 'United State', value: 'US'&#125;</span><span class="xml"></span></div><div class="line">]</div><div class="line"></div><div class="line">const FormView = props =&gt; (</div><div class="line">  <span class="tag">&lt;<span class="name">Form</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">FieldsContainer</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Fieldset</span> <span class="attr">label</span>=<span class="string">"Contact details"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"John"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Last name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Doe"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Phone<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"+45 88 88 88 88"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"John"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">Fieldset</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Fieldset</span> <span class="attr">label</span>=<span class="string">"Shipping details"</span> <span class="attr">last</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Address<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Hejrevej 33"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>City<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"Copenhagen"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>ZIP Code<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"2400"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Country<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Select</span></span></div><div class="line">              <span class="attr">name</span>=<span class="string">"country"</span></div><div class="line">              <span class="attr">label</span>=<span class="string">"Country"</span></div><div class="line">              <span class="attr">options</span>=<span class="template-variable">&#123;countryOptions&#125;</span><span class="xml"><span class="tag"></span></span></div><div class="line">              <span class="attr">placeholder</span>=<span class="string">"Denmark"</span></div><div class="line">          /&gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">FormGroup</span> <span class="attr">border</span>=</span><span class="template-variable">&#123;false&#125;</span><span class="xml"><span class="tag">&gt;</span></span></div><div class="line">          <span class="tag">&lt;<span class="name">Label</span>&gt;</span>Save my details<span class="tag">&lt;/<span class="name">Label</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">Switch</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">FormGroup</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">Fieldset</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">FieldsContainer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ActionsContainer</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">icon</span>=<span class="string">"md-checkmark"</span> <span class="attr">iconPlacement</span>=<span class="string">"right"</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ActionsContainer</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></div><div class="line">)</div><div class="line"></div><div class="line">export default FormView</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æ¯”è¾ƒç†Ÿæ‚‰Twitter Bootstrapä½ å¯ä»¥ä»react-native-clean-formä¸­çœ‹åˆ°ç±»ä¼¼çš„å¥æ³•.å¥½äº†è¾“å…¥<code>Input</code>,<code>Select</code>å’Œ<code>Switch</code>.è¿™é‡Œçš„å…ƒç´ å·²ç»è¢«åŒ…è£…åœ¨<code>FromGroup</code>å’Œ<code>Label</code>.æ­¤å¤–æˆ‘ä»¬ä¹Ÿæ”¯æŒéªŒè¯</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123; reduxForm &#125; <span class="keyword">from</span> <span class="string">'redux-form/immutable'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  ActionsContainer,</div><div class="line">  Button,</div><div class="line">  FieldsContainer,</div><div class="line">  Fieldset,</div><div class="line">  Form</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native-clean-form'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  Input,</div><div class="line">  Select,</div><div class="line">  Switch</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native-clean-form/redux-form-immutable'</span></div><div class="line"><span class="keyword">import</span> &#123; View,Text &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></div><div class="line"></div><div class="line">const onSubmit = <span class="function"><span class="params">(values, dispatch)</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve)</span> =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(values.toJS())</div><div class="line">      resolve()</div><div class="line">    &#125;, <span class="number">1500</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">const countryOptions = [</div><div class="line">  &#123;label: <span class="string">'Denmark'</span>, value: <span class="string">'DK'</span>&#125;,</div><div class="line">  &#123;label: <span class="string">'Germany'</span>, value: <span class="string">'DE'</span>&#125;,</div><div class="line">  &#123;label: <span class="string">'United State'</span>, value: <span class="string">'US'</span>&#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormView</span> <span class="keyword">extends</span> <span class="title">Component</span> &#123;</span></div><div class="line">  render() &#123;</div><div class="line">    const &#123; handleSubmit, submitting &#125; = <span class="keyword">this</span>.props</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Form&gt;</div><div class="line">        &lt;FieldsContainer&gt;</div><div class="line">          &lt;Fieldset label=<span class="string">"Contact details"</span>&gt;</div><div class="line">            &lt;Input name=<span class="string">"first_name"</span> label=<span class="string">"First name"</span> placeholder=<span class="string">"John"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"last_name"</span> label=<span class="string">"Last name"</span> placeholder=<span class="string">"Doe"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"email"</span> label=<span class="string">"Email"</span> placeholder=<span class="string">"something@domain.com"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"telephone"</span> label=<span class="string">"Phone"</span> placeholder=<span class="string">"+45 88 88 88 88"</span> /&gt;</div><div class="line">          &lt;/Fieldset&gt;</div><div class="line">          &lt;Fieldset label=<span class="string">"Shipping details"</span> last&gt;</div><div class="line">            &lt;Input name=<span class="string">"address"</span> label=<span class="string">"Address"</span> placeholder=<span class="string">"Hejrevej 33"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"city"</span> label=<span class="string">"City"</span> placeholder=<span class="string">"Copenhagen"</span> /&gt;</div><div class="line">            &lt;Input name=<span class="string">"zip"</span> label=<span class="string">"ZIP Code"</span> placeholder=<span class="string">"2400"</span> /&gt;</div><div class="line">            &lt;Select</div><div class="line">              name=<span class="string">"country"</span></div><div class="line">              label=<span class="string">"Country"</span></div><div class="line">              options=&#123;countryOptions&#125;</div><div class="line">              placeholder=<span class="string">"Denmark"</span></div><div class="line">            /&gt;</div><div class="line">            &lt;Switch label=<span class="string">"Save my details"</span> border=&#123;<span class="literal">false</span>&#125; name=<span class="string">"save_details"</span> /&gt;</div><div class="line">          &lt;/Fieldset&gt;</div><div class="line">        &lt;/FieldsContainer&gt;</div><div class="line">        &lt;ActionsContainer&gt;</div><div class="line">          &lt;Button icon=<span class="string">"md-checkmark"</span> iconPlacement=<span class="string">"right"</span> onPress=&#123;handleSubmit(onSubmit)&#125; submitting=&#123;submitting&#125;&gt;Save&lt;/Button&gt;</div><div class="line">        &lt;/ActionsContainer&gt;</div><div class="line">      &lt;/Form&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> reduxForm(&#123;</div><div class="line">  form: <span class="string">'Form'</span>,</div><div class="line">  validate: values =&gt; &#123;</div><div class="line">    const errors = &#123;&#125;</div><div class="line"></div><div class="line">    values = values.toJS()</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.first_name) &#123;</div><div class="line">      errors.first_name = <span class="string">'First name is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.last_name) &#123;</div><div class="line">      errors.last_name = <span class="string">'Last name is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!values.email) &#123;</div><div class="line">      errors.email = <span class="string">'Email is required.'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> errors</div><div class="line">  &#125;</div><div class="line">&#125;)(FormView)</div></pre></td></tr></table></figure>
<p>å¾ˆç®€å•ï¼Œæ˜¯å—ï¼Ÿç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªè¿æ¥åˆ°storeçš„å¥½çœ‹çš„è¡¨å•,è¿˜èƒ½æ”¯æŒæ•°æ®éªŒè¯,å¼‚æ­¥çš„æŒ‰é’®åé¦ˆ.ä½ å¯ä»¥åœ¨<a href="https://github.com/esbenp/react-native-clean-form" target="_blank" rel="external">repositoryæŸ¥çœ‹æ›´å¤šç‰¹æ€§</a>.</p>
<h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨Reactä¸­å¤„ç†è¡¨å•è¿˜ä¸æ€ä¹ˆå¥½å¼„,çœ‹çœ‹è¿™ç¯‡æ–‡ç« è®²çš„æŒºå¥½çš„çœ‹çœ‹,è¯•ç€ç¿»è¯‘ä¸€ä¸‹&lt;br&gt;  &lt;a href=&quot;http://esbenp.github.io/2017/01/06/react-native-redux-form-immutable-st
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="Redux" scheme="http://yoursite.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(8)-Views</title>
    <link href="http://yoursite.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-8-Views/"/>
    <id>http://yoursite.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-8-Views/</id>
    <published>2017-03-30T14:04:48.000Z</published>
    <updated>2017-03-30T10:31:07.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Views"><a href="#Views" class="headerlink" title="Views"></a>Views</h1><p>Navigation è§†å›¾æ˜¯æ¥å—<code>router</code>å’Œ<code>navigaion</code> çš„propçš„è¡¨å¾ç»„ä»¶,é€šè¿‡<code>navigation.state</code>çš„è®¾å®š,å¯ä»¥æ˜¾ç¤ºå‡ ä¸ªscreens.<br>Navigation viewæ˜¯è¢«æ§åˆ¶çš„Reactç»„ä»¶,è¡¨å¾å½“å‰çš„navigation state.ä»–ä»¬ç®¡ç†screenä¹‹é—´çš„åˆ‡æ¢,åŠ¨ç”»å’Œæ‰‹åŠ¿.ä»–ä»¬ä¹ŸæŒä¹…åŒ–navigation viewä¾‹å¦‚tab barså’Œheaders</p>
<h2 id="å†…å»ºçš„Views"><a href="#å†…å»ºçš„Views" class="headerlink" title="å†…å»ºçš„Views"></a>å†…å»ºçš„Views</h2><ul>
<li><p>CardStack-ä»£è¡¨stackåœ¨ä»»ä½•å¹³å°ä¸Šéƒ½åŒ¹é…</p>
<ul>
<li>ä»£è¡¨ä¸€ä¸ªä»Card stackæ¥çš„card.</li>
<li>Header-card stackçš„header view</li>
</ul>
</li>
<li><p>Tabs-tabåˆ‡æ¢å™¨/é¡µé¢çš„é…ç½®</p>
</li>
<li>Drawer-ä»å·¦ä¾§æ»‘å‡ºçš„Drawerçš„view</li>
</ul>
<h1 id="Transitioner"><a href="#Transitioner" class="headerlink" title="Transitioner"></a>Transitioner</h1><p><code>transitioner</code>æ˜¯ä¸€ä¸ªReact ç»„ä»¶å¸®åŠ©ç®¡ç†å¤æ‚åŠ¨ç”»ç»„ä»¶ä¹‹é—´æ¼”å˜çš„å·¥å…·.å®ƒç®¡ç†åŠ¨ç”»çš„æ—¶é—´è°ƒåº¦,ä¿ç•™å„ç§screençš„è¿›å…¥ç¦»å¼€çš„è®°å½•,ä½†æ˜¯å®ƒä¸çŸ¥é“å…·ä½“çš„äº‹ä»¶æ˜¯ä»€ä¹ˆ,åº”ä¸ºå…·ä½“çš„æ¸²æŸ“è¿‡ç¨‹å§”æ‰˜ç»™äº†å¼€å‘è€….<br>åœ¨å†…éƒ¨,<code>Transitioner</code>è¢«ç”¨æ¥å®æ–½<code>CardStack</code>,å› æ­¤æ˜¯<code>StackNavigator</code>.<br><code>Transiioner</code>æœ€æœ‰ç”¨çš„ç”¨é€”æ˜¯æ¥å—å½“å‰navigationçš„state.å½“routesä»navigation stateç§»é™¤çš„æ—¶å€™,<code>Transitioner</code></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyNavView</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  ...</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Transitioner</span></div><div class="line">        configureTransition=&#123;<span class="keyword">this</span>._configureTransition&#125;</div><div class="line">        navigation=&#123;<span class="keyword">this</span>.props.navigation&#125;</div><div class="line">        render=&#123;<span class="keyword">this</span>._render&#125;</div><div class="line">        onTransitionStart=&#123;<span class="keyword">this</span>.onTransitionStart&#125;</div><div class="line">        onTransitionEnd=&#123;<span class="keyword">this</span>.onTransitionEnd&#125;</div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h2><h3 id="configureTransitionfunction"><a href="#configureTransitionfunction" class="headerlink" title="configureTransitionfunction"></a><code>configureTransition</code>function</h3><p>è¢«<code>Transitioner.componentWillReceiveProps</code>,è¿™ä¸ªå‡½æ•°å…è®¸å®šåˆ¶åŠ¨ç”»çš„å‚æ•°,ä¾‹å¦‚<code>å»¶ç»­æ—¶é—´</code>.è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼å°†ä¼šä¼ é€’è¿›å…¥æ—¶é—´åºåˆ—å‡½æ•°,é»˜è®¤æ˜¯<code>Animated.timing()</code>.</p>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="title">_configureTransition</span>(transitionProps, prevTransitionProps) &#123;</div><div class="line">  return &#123;</div><div class="line">    // duration <span class="keyword">in</span> milliseconds, <span class="keyword">default</span>: 250</div><div class="line">    duration: <span class="number">500</span>,</div><div class="line">    // <span class="type">An</span> easing function from `<span class="type">Easing</span>`, <span class="keyword">default</span>: <span class="type">Easing</span>.inOut(<span class="type">Easing</span>.<span class="title">ease</span>)</div><div class="line">    easing: <span class="type">Easing</span>.bounce,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:<code>duration</code>å’Œ<code>easing</code>åªç”¨å½“æ—¶é—´åºåˆ—å‡½æ•°æ˜¯<code>Animated.timing</code>çš„æ—¶å€™æ‰å¯ä»¥åº”ç”¨.æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„configå‚æ•°æ¥ä½¿ç”¨ä¸åŒçš„æ—¶é—´å‡½æ•°.<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> _configureTransition(transitionProps, prevTransitionProps) &#123;</div><div class="line">  <span class="class">return </span>&#123;</div><div class="line">    <span class="comment">// A timing function, default: Animated.timing.</span></div><div class="line"><span class="symbol">    timing:</span> Animated.spring,</div><div class="line">    <span class="comment">// Some parameters relevant to Animated.spring</span></div><div class="line"><span class="symbol">    friction:</span> <span class="number">1</span>,</div><div class="line"><span class="symbol">    tension:</span> <span class="number">0.5</span>,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Flow-definition"><a href="#Flow-definition" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">configureTransition:</span> (</div><div class="line"><span class="symbol">    transitionProps:</span> NavigationTransitionProps,</div><div class="line"><span class="symbol">    prevTransitionProps:</span> ?NavigationTransitionProps,</div><div class="line">  ) =&gt; NavigationTransitionSpec,</div></pre></td></tr></table></figure>
<h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h3><ul>
<li><code>transitionProps</code>:æœ‰å½“å‰çš„navigation stateå’Œpropsåˆ›å»ºçš„å½“å‰<code>NavigationTransitionProps</code></li>
<li><code>prevTransitionProps</code>:ä»å‰ä¸€ä¸ªnavigation staeå’Œpropsåˆ›å»ºçš„å‰ä¸€ä¸ªNavigationTransitionProps</li>
</ul>
<h3 id="Returns"><a href="#Returns" class="headerlink" title="Returns"></a>Returns</h3><ul>
<li>NavigationTransitionSpecç±»å‹çš„å¯¹è±¡,ä½œä¸ºå‚æ•°ä¼ é€’è¿›åŠ¨ç”»æ—¶é—´åºåˆ—å‡½æ•°</li>
</ul>
<p><code>navigationState</code>å¯¹è±¡<br>ä»£è¡¨navigation stateçš„ç®€å•å¯¹è±¡</p>
<h3 id="å®ä¾‹å€¼"><a href="#å®ä¾‹å€¼" class="headerlink" title="å®ä¾‹å€¼"></a>å®ä¾‹å€¼</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   <span class="comment">// Index refers to the active child route in the routes array.</span></div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>,</div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'DF2FGWGAS-12'</span>, <span class="attribute">routeName</span>: <span class="string">'ContactHome'</span> &#125;,</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'DF2FGWGAS-13'</span>, <span class="attribute">routeName</span>: <span class="string">'ContactDetail'</span>, <span class="attribute">params</span>: &#123; <span class="attribute">personId</span>: <span class="number">123</span> &#125; &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Flow-definition-1"><a href="#Flow-definition-1" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="class"><span class="keyword">type</span> <span class="type">NavigationState</span> = &#123;</span></div><div class="line">  <span class="title">index</span>: <span class="title">number</span>,</div><div class="line">  <span class="title">routes</span>: <span class="type">Array</span>&lt;<span class="type">NavigationRoute</span>&gt;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>äº†è§£æ›´å¤šçš„<code>NavigationRoute</code>çš„ç±»å‹,æŸ¥çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/src/TypeDefinition.js#L32" target="_blank" rel="external">flow definition</a></p>
<h2 id="renderå‡½æ•°"><a href="#renderå‡½æ•°" class="headerlink" title="renderå‡½æ•°"></a><code>render</code>å‡½æ•°</h2><p>ç”±<code>Transition.render()</code>è°ƒç”¨.è¿™ä¸ªå‡½æ•°ä»£ç†äº†<code>Transitioner</code>çš„å®é™…æ¸²æŸ“åŠŸèƒ½.åœ¨è¿™ä¸ªå‡½æ•°ä¸­,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ…å«åœ¨<code>transitionProps</code>å’Œ<code>prevTransitionProps</code>ä¸­çš„å‚æ•°æ¥æ¸²æŸ“scene,åˆ›å»ºåŠ¨ç”»å’Œå¤„ç†æ‰‹åŠ¿æ“ä½œ.</p>
<p><code>transitionProps</code>å’Œ<code>prevTransitionProps</code>æœ‰ä¸€äº›é‡è¦çš„å±æ€§å¯¹äºä¸Šé¢æåˆ°çš„ä¸€äº›ä»»åŠ¡æ˜¯ååˆ†æœ‰ç”¨çš„.</p>
<ul>
<li><code>scenes:Array&lt;NavigationScene&gt;</code>-å¯ä»¥ä½¿ç”¨çš„scenesçš„åˆ—è¡¨</li>
<li><code>position:NavigationAnimation</code>- transitionerçš„navigation  stateçš„è¿›åº¦ç´¢å¼•</li>
<li><code>progress:NavigationAnimationedValue</code>-å½“navigation stateä»ä¸€ä¸ªè½¬å˜åˆ°å¦ä¸€çš„æ—¶å€™,è¿™ä¸ªå€¼ä»£è¡¨äº†æ¼”å˜çš„è¿›åº¦.ä»0-1çš„æ•°å€¼</li>
</ul>
<p>æŸ¥çœ‹å®Œæ•´çš„<code>NavigationTransitionProps</code>çš„å±æ€§åˆ—è¡¨.æŸ¥çœ‹çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/src/TypeDefinition.js#L273" target="_blank" rel="external">flow definition</a></p>
<h3 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p><code>transitionProps.scenes</code>æ˜¯å¯ä»¥ä½¿ç”¨çš„scenesçš„åˆ—è¡¨.è¿™ä¸ªåˆ—è¡¨ä¾èµ–äºå®æ–½è€…å‡†å¤‡æ€ä¹ˆæ¥åˆ—å‡ºscreen.ä¾‹å¦‚,å¯ä»¥åƒä¸‹é¢çš„ä»£ç æ¥æ¸²æŸ“cardsçš„å †æ ˆ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> _render(transitionProps, prevTransitionProps) &#123;</div><div class="line">  <span class="keyword">const</span> scenes = transitionProps.scenes.map(<span class="function"><span class="params">scene</span> =&gt;</span> <span class="keyword">this</span>._renderScene(transitionProps, scene));</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.stack&#125;</span>&gt;</span></span></div><div class="line">      &#123;scenes&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Animated.View</code>å»æ‰§è¡Œæ¼”å˜åŠ¨ç”».ä¸ºäº†åˆ›å»ºå¿…è¦çš„åŠ¨ç”»æ ·å¼å±æ€§,ä¾‹å¦‚<code>é€æ˜åº¦</code>,æˆ‘ä»¬å¯ä»¥åœ¨<code>position</code>å’Œ<code>progress</code>ä¸­åˆ©ç”¨<code>transitionProps</code>æ¥æ’å€¼.</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> _renderScene(transitionProps, <span class="built_in">scene</span>) &#123;</div><div class="line">  const &#123; <span class="built_in">position</span> &#125; = transitionProps;</div><div class="line">  const &#123; index &#125; = <span class="built_in">scene</span>;</div><div class="line">  const <span class="built_in">opacity</span> = <span class="built_in">position</span>.interpolate(&#123;</div><div class="line">    inputRange: [index-<span class="number">1</span>, index, index+<span class="number">1</span>],</div><div class="line">    outputRange: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</div><div class="line">  &#125;);</div><div class="line">  // The prop `router` <span class="built_in">is</span> populated when we call `createNavigator`.</div><div class="line">  const Scene = this.<span class="built_in">props</span>.router.getComponent(<span class="built_in">scene</span>.route.routeName);</div><div class="line">  <span class="built_in">return</span> (</div><div class="line">    &lt;Animated.View <span class="built_in">style</span>=&#123;&#123; <span class="built_in">opacity</span> &#125;&#125;&gt;</div><div class="line">      &#123; Scene &#125;</div><div class="line">    &lt;/Animated.View&gt;</div><div class="line">  )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç åˆ›å»ºäº¤å‰æ¸éšçš„åŠ¨ç”».<br>æ·±å…¥ç†è§£å¦‚ä½•åˆ›å»ºå®šåˆ¶çš„transitions,çœ‹çœ‹è¿™ä¸ª<a href="http://www.reactnativediary.com/2016/12/20/navigation-experimental-custom-transition-1.html" target="_blank" rel="external">åšå®¢å¸–å­</a></p>
<h3 id="Flow-definition-2"><a href="#Flow-definition-2" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">render: <span class="function"><span class="params">(transitionProps: NavigationTransitionProps, prevTransitionProps: ?NavigationTransitionProps)</span> =&gt;</span> React.Element&lt;*&gt;,</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><ul>
<li><code>transitionProps</code>:ä»å½“å‰stateå’Œpropsåˆ›å»ºçš„NavigationTransitionProps.</li>
<li><code>prevTransitionProps</code>:ä»ä¹‹å‰çš„stateå’Œpropsåˆ›å»ºçš„å…ˆå‰<code>NavigationTransitionProps</code></li>
</ul>
<h3 id="Returns-1"><a href="#Returns-1" class="headerlink" title="Returns"></a>Returns</h3><ul>
<li>Reactå…ƒç´ ,ç”¨æ¥æ¸²æŸ“Transitioner ç»„ä»¶</li>
</ul>
<h2 id="onTransitionEndå‡½æ•°"><a href="#onTransitionEndå‡½æ•°" class="headerlink" title="onTransitionEndå‡½æ•°"></a><code>onTransitionEnd</code>å‡½æ•°</h2><p>åŠ¨ç”»æ¼”å˜å®Œæˆåè°ƒç”¨ä¸€æ¬¡.</p>
<h3 id="Flow-definition-3"><a href="#Flow-definition-3" class="headerlink" title="Flow definition"></a>Flow definition</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">onTransitionEnd: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">void</span></div></pre></td></tr></table></figure>
<h3 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><ul>
<li>none<h3 id="Returns-2"><a href="#Returns-2" class="headerlink" title="Returns"></a>Returns</h3></li>
<li>none</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Views&quot;&gt;&lt;a href=&quot;#Views&quot; class=&quot;headerlink&quot; title=&quot;Views&quot;&gt;&lt;/a&gt;Views&lt;/h1&gt;&lt;p&gt;Navigation è§†å›¾æ˜¯æ¥å—&lt;code&gt;router&lt;/code&gt;å’Œ&lt;code&gt;navigaion&lt;/code&gt;
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="http://yoursite.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(7)-Router</title>
    <link href="http://yoursite.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-7-Router/"/>
    <id>http://yoursite.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-7-Router/</id>
    <published>2017-03-30T09:57:00.000Z</published>
    <updated>2017-03-30T06:04:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Routers"><a href="#Routers" class="headerlink" title="Routers"></a>Routers</h1><blockquote>
<p>Routerå®šä¹‰ä¸€ä¸ªç»„ä»¶çš„navigation state,å…è®¸å¼€å‘è€…å®šä¹‰è·¯å¾„å’Œå¯ä»¥æ“ä½œçš„actions.</p>
<h2 id="å†…å»ºçš„Routers"><a href="#å†…å»ºçš„Routers" class="headerlink" title="å†…å»ºçš„Routers"></a>å†…å»ºçš„Routers</h2><ul>
<li>StackRouter</li>
<li>TabRouter</li>
</ul>
</blockquote>
<h2 id="ä½¿ç”¨Routers"><a href="#ä½¿ç”¨Routers" class="headerlink" title="ä½¿ç”¨Routers"></a>ä½¿ç”¨Routers</h2><p>ä¸ºäº†æ‰‹åŠ¨å®šåˆ¶ä¸€ä¸ªnavigator,åœ¨ç»„ä»¶é‡Œå¯ä»¥æ”¾ä¸€ä¸ªé™æ€çš„<code>router</code>.(ä½¿ç”¨å†…å»ºçš„ç»„ä»¶å¿«é€Ÿçš„å®šåˆ¶ä¸€ä¸ªnavigator,ä½¿ç”¨<a href="https://reactnavigation.org/docs/navigators" target="_blank" rel="external">Navigator Factory</a>æ›´å®¹æ˜“å®ç°).</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyNavigator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    static router = <span class="type">StackRouter</span>(routes, config);</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥æŠŠè¿™ä¸ªç»„ä»¶ä½œä¸ºå¦ä¸€ä¸ªnavigatorçš„<code>screen</code>å¯¹å¾…,<code>MyNavigator</code>çš„å¯¼èˆªé€»è¾‘åœ¨<code>StackRouter</code>ä¸­å®šä¹‰.</p>
<h2 id="å®šåˆ¶åŒ–Router"><a href="#å®šåˆ¶åŒ–Router" class="headerlink" title="å®šåˆ¶åŒ–Router"></a>å®šåˆ¶åŒ–Router</h2><p>çœ‹çœ‹<code>[å®šåˆ¶Router API éƒ¨åˆ†](https://reactnavigation.org/docs/routers/api)</code>å­¦ä¹ <code>StackRouter</code>å’Œ<code>TabRouter</code>çš„API.<br>åªè¦ä½ æ„¿æ„ä¹Ÿå¯ä»¥é‡å†™routerçš„å‡½æ•°.</p>
<h2 id="å®šåˆ¶Navigationçš„Actions"><a href="#å®šåˆ¶Navigationçš„Actions" class="headerlink" title="å®šåˆ¶Navigationçš„Actions"></a>å®šåˆ¶Navigationçš„Actions</h2><p>ä¸ºäº†é‡å†™navigationçš„è¡Œä¸º,ä½ å¯ä»¥åœ¨<code>getStateForAction</code>ä¸­é‡å†™navigation stateçš„é€»è¾‘,ä»è€Œæ‰‹åŠ¨å¤„ç†<code>routes</code>å’Œ<code>index</code>.</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"> const MyApp = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: 'Home',</div><div class="line">&#125;)</div><div class="line">MyApp.router = &#123;</div><div class="line">  ...MyApp.router,</div><div class="line">  getStateForAction(action, <span class="keyword">state</span>) &#123;</div><div class="line">    if (<span class="keyword">state</span> &amp;&amp; action.type === 'PushTwoProfiles') &#123;</div><div class="line">      const routes = [</div><div class="line">        ...<span class="keyword">state</span>.routes,</div><div class="line">        &#123;key: 'A', routeName: 'Profile', params: &#123; name: action.name1 &#125;&#125;,</div><div class="line">        &#123;key: 'B', routeName: 'Profile', params: &#123; name: action.name2 &#125;&#125;,</div><div class="line">      ];</div><div class="line">      return &#123;</div><div class="line">        ...<span class="keyword">state</span>,</div><div class="line">        routes,</div><div class="line">        index: routes.length - <span class="number">1</span>,</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">    return MyApp.router.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="é˜»æ­¢æŸäº›Navigationçš„Actions"><a href="#é˜»æ­¢æŸäº›Navigationçš„Actions" class="headerlink" title="é˜»æ­¢æŸäº›Navigationçš„Actions"></a>é˜»æ­¢æŸäº›Navigationçš„Actions</h2><p>æœ‰æ—¶å€™æ ¹æ®ä½ çš„route,éœ€è¦é˜»æ­¢æŸäº›navigationçš„æ´»åŠ¨</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"> const MyStackRouter = StackRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: 'Home',</div><div class="line">&#125;)</div><div class="line">const MyAppRouter = &#123;</div><div class="line">  ...MyStackRouter,</div><div class="line">  getStateForAction(action, <span class="keyword">state</span>) &#123;</div><div class="line">    if (</div><div class="line">      <span class="keyword">state</span> &amp;&amp;</div><div class="line">      action.type === NavigationActions.BACK &amp;&amp;</div><div class="line">      <span class="keyword">state</span>.routes[<span class="keyword">state</span>.index].params.isEditing</div><div class="line">    ) &#123;</div><div class="line">      // Returning null <span class="keyword">from</span> getStateForAction means that the action</div><div class="line">      // has been handled/blocked, but there is not a new <span class="keyword">state</span></div><div class="line">      return null;</div><div class="line">    &#125;</div><div class="line">    return MyStackRouter.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="æ“ä½œå®šåˆ¶URIs"><a href="#æ“ä½œå®šåˆ¶URIs" class="headerlink" title="æ“ä½œå®šåˆ¶URIs"></a>æ“ä½œå®šåˆ¶URIs</h2><p>æˆ–è®¸ä½ çš„appæœ‰ä¸€ä¸ªç‹¬ç‰¹çš„URI,å†…å»ºçš„routerså¤„ç†ä¸äº†.ä½ å¯ä»¥é€šè¿‡<code>getActionForPathAndParams</code>æ¥æ‰©å±•router.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"> import &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> MyApp = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div><div class="line"><span class="keyword">const</span> previousGetActionForPathAndParams = MyApp.router.getActionForPathAndParams</div><div class="line">Object.assign(MyApp.router, &#123;</div><div class="line">  getActionForPathAndParams(path, <span class="keyword">params</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (</div><div class="line">      path === <span class="string">'my/custom/path'</span> &amp;&amp;</div><div class="line">      <span class="keyword">params</span>.magic === <span class="string">'yes'</span></div><div class="line">    ) &#123;</div><div class="line">      <span class="comment">// returns a profile navigate action for /my/custom/path?magic=yes</span></div><div class="line">      <span class="keyword">return</span> NavigationActions.navigate(&#123;</div><div class="line">        routeName: <span class="string">'Profile'</span>,</div><div class="line">        action: NavigationActions.navigate(&#123;</div><div class="line">          <span class="comment">// This child action will get passed to the child router</span></div><div class="line">          <span class="comment">// ProfileScreen.router.getStateForAction to get the child</span></div><div class="line">          <span class="comment">// navigation state.</span></div><div class="line">          routeName: <span class="string">'Friends'</span>,</div><div class="line">        &#125;),</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> previousGetActionForPathAndParams(path, <span class="keyword">params</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="å®šåˆ¶Router-API"><a href="#å®šåˆ¶Router-API" class="headerlink" title="å®šåˆ¶Router API"></a>å®šåˆ¶Router API</h2><p>ä½ å¯ä»¥ç«¥å·¥ä¸‹é¢çš„å‡½æ•°æ¥æ„å»ºè‡ªå·±çš„routerå¯¹è±¡,</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> const MyRouter = &#123;</div><div class="line">  getStateForAction: <span class="function"><span class="params">(action, state)</span> =&gt;</span> (&#123;&#125;),</div><div class="line">  getActionForPathAndParams: <span class="function"><span class="params">(path, params)</span> =&gt;</span> <span class="literal">null</span>,</div><div class="line">  getPathAndParamsForState: <span class="function"><span class="params">(state)</span> =&gt;</span> <span class="literal">null</span>,</div><div class="line">  getComponentForState: <span class="function"><span class="params">(state)</span> =&gt;</span> MyScreen,</div><div class="line">  getComponentForRouteName: <span class="function"><span class="params">(routeName)</span> =&gt;</span> MyScreen,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="regexp">//</span> Now, you can make a navigator <span class="keyword">by</span> putting the router <span class="literal">on</span> it:</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNavigator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> &#123;</span></div><div class="line">  static router = MyRouter;</div><div class="line">  render() &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe4np8ce9xj313l0v9jss.jpg" alt=""></p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getStateForAction(action,<span class="keyword">state</span>)</div></pre></td></tr></table></figure>
<p> æ ¹æ®ç»™å®šçš„actionæ¥å®šä¹‰è¿”å›çš„navigation sate.å½“ä¸€ä¸ªactioné€šè¿‡<code>props.navigation.dispatch()</code>ä¼ é€’,æˆ–è€…ä»»ä½•å…¶ä»–çš„åŠ©æ‰‹å‡½æ•°è¢«è°ƒç”¨,ä¾‹å¦‚<code>navigation.navitate()</code>çš„æ—¶å€™,è¿™ä¸ªå‡½æ•°å°†ä¼šè¿è¡Œ.</p>
<p> é€šå¸¸è¿™ä¸ªå‡½æ•°å°†ä¼šä»¥ä¸‹é¢çš„å½¢å¼è¿”å›navitaion state.</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>, <span class="comment">// identifies which route in the routes array is active</span></div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="comment">// Each route needs a name to identify the type.</span></div><div class="line">      <span class="attribute">routeName</span>: <span class="string">'MyRouteName'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// A unique identifier for this route in the routes array:</span></div><div class="line">      <span class="attribute">key</span>: <span class="string">'myroute-123'</span>,</div><div class="line">      <span class="comment">// (used to specify the re-ordering of routes)</span></div><div class="line"></div><div class="line">      <span class="comment">// Routes can have any data, as long as key and routeName are correct</span></div><div class="line">      ...randomRouteData,</div><div class="line">    &#125;,</div><div class="line">    ..<span class="selector-class">.moreRoutes</span>,</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœrouterå·²ç»åœ¨å¤–éƒ¨å¤„ç†äº†acion,æˆ–è€…æƒ³ä¸æ”¹å˜ä»»ä½•çš„navigation stateå°±æ¶ˆåŒ–å®ƒ,è¿™ä¸ªå‡½æ•°å°±è¿”å›<code>null</code>.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">getComponentForRouterName</span><span class="params">(routeName)</span></span></div></pre></td></tr></table></figure>
<p>ä¸ºç»™å®šçš„route nameè¿”å›å­ç»„ä»¶æˆ–è€…navigator.<br>åƒè¿™æ ·å£°æ˜ä¸€ä¸ªrouter<code>getStateForAction</code>è¾“å‡ºçš„state.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>,</div><div class="line">  routes: [</div><div class="line">    &#123; key: <span class="string">'A'</span>, routeName: <span class="string">'Foo'</span> &#125;,</div><div class="line">    &#123; <span class="attribute">key</span>: <span class="string">'B'</span>, routeName: <span class="string">'Bar'</span> &#125;,</div><div class="line">  ],</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŸºäºstateä¸­çš„é¢routeName,routerå°†ä¼šè°ƒç”¨<code>router.getComponentForRouteName(&#39;Foo&#39;)</code>æˆ–<code>router.getComponentForRouteName(&#39;Bar&#39;)</code>æ¥è¿”å›å¯¹åº”çš„æœ‰æ•ˆç»„ä»¶.</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getComponentForState(<span class="keyword">state</span>)</div></pre></td></tr></table></figure>
<p>ä»æ·±åº¦åµŒå¥—navigation stateè¿”å›æ¿€æ´»çš„ç»„ä»¶</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getActionForPathAndParams</span></div></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªå¯é€‰é…ç½®çš„navigation action,åœ¨ç”¨æˆ·å¯¼èˆªåˆ°è¿™ä¸ªè·¯å¾„å¹¶ä¸”æœ‰å¯é€‰çš„æŸ¥è¯¢å‚æ•°çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªaction.</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getPathAndParamsForState</span></div></pre></td></tr></table></figure>
<p>ç”¨æˆ·åœ¨appä¸­è¿”å›åŒä¸€ä¸ªURLé“¾æ¥çš„ç‚¹æ—¶,è¿™ä¸ªå‡½æ•°è¿”å›è·¯å¾„å’Œå‚æ•°.<br>ä»è¿™ä¸ªå‡½æ•°è¿”å›çš„è·¯å¾„å’Œå‚æ•°åº”è¯¥æ˜¯ä»ä¸€ä¸ªactionè·å¾—çš„,è¿™ä¸ªactionæ˜¯é‡ä¼ è¿›å…¥routerçš„<code>getActionForPathAndParams</code>çš„.è¿™ä¸ªactionä¸€æ—¦é€šè¿‡<code>getStateForAction</code>ä¼ é€’,ä¼šç»™ä½ è¿”å›å½¢ä¼¼çš„state.</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">getScreenConfig</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°ä»ä¸€ä¸ªrouteè·å–navigationçš„å¯é€‰é¡¹.å¿…é¡»è¦æä¾›screençš„å½“å‰navigation propå’Œè¢«è¿”å›çš„é€‰é¡¹çš„åå­—.</p>
<ul>
<li><code>navigation</code>-è¿™æ˜¯screenå°†ä¼šä½¿ç”¨çš„navigation prop,å¯¹åº”åœ¨screençš„routeå’Œstate.Dispatchå°†ä¼šæ ¹æ®screençš„ä¸Šä¸‹æ–‡æ¥è§¦å‘actions.</li>
<li><code>optionName</code>-è¢«è·å–çš„é€‰é¡¹çš„åå­—,ä¾‹å¦‚â€™titleâ€™</li>
</ul>
<p>åœ¨å®ä¾‹çš„è§†å›¾å†…,æˆ–è®¸ä½ éœ€è¦è¿œç¨‹è·å–é…ç½®çš„æ ‡é¢˜</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> // First, prepare a navigation prop <span class="keyword">for</span> your child, or re-use one if already available.</div><div class="line">const childNavigation = addNavigationHelpers(&#123;</div><div class="line">  // In this case we use navigation.<span class="keyword">state</span>.index because we want the title <span class="keyword">for</span> the active route.</div><div class="line">  <span class="keyword">state</span>: navigation.<span class="keyword">state</span>.routes[navigation.<span class="keyword">state</span>.index],</div><div class="line">  dispatch: navigation.dispatch,</div><div class="line">&#125;)</div><div class="line">const screenTitle = this.props.router.getScreenConfig(childNavigation, 'title');</div></pre></td></tr></table></figure>
<h1 id="StackRouter"><a href="#StackRouter" class="headerlink" title="StackRouter"></a>StackRouter</h1><p>ç®¡ç†navigationå †æ ˆçš„é€»è¾‘,åŒ…æ‹¬å…¥æ ˆ,å‡ºæ ˆ,æ“ä½œè·¯å¾„è§£æåˆ›å»ºæ·±å±‚æ¬¡çš„å †æ ˆ.</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ç®€å•çš„stack router<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> const MyApp = StackRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="RouteConfig"><a href="#RouteConfig" class="headerlink" title="RouteConfig"></a>RouteConfig</h2><p>æœ€ç®€å•çš„stack routeræœŸå¾…çš„å‚æ•°æ˜¯ä¸€ä¸ªconfigå¯¹è±¡,è¿™é‡Œæ˜¯ç¤ºä¾‹é…ç½®<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = StackRouter(&#123; <span class="comment">// This is the RouteConfig:</span></div><div class="line">  Home: &#123;</div><div class="line">    <span class="attr">screen</span>: HomeScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">''</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">Profile</span>: &#123;</div><div class="line">    <span class="attr">screen</span>: ProfileScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">'profile/:name'</span>,</div><div class="line">  &#125;,</div><div class="line">  Settings &#123;</div><div class="line">    <span class="comment">// This can be handy to lazily require a screen:</span></div><div class="line">    getScreen: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">require</span>(<span class="string">'Settings'</span>).default,</div><div class="line">    <span class="comment">// Note: Child navigators cannot be configured using getScreen because</span></div><div class="line">    <span class="comment">// the router will not be accessible. Navigators must be configured</span></div><div class="line">    <span class="comment">// using `screen: MyNavigator`</span></div><div class="line">    path: <span class="string">'settings'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ¯ä¸€ä¸ªåœ¨configä¸­çš„æ¡ç›®æœ‰å¦‚ä¸‹å†…å®¹</p>
<ul>
<li><code>path</code>-è®¾å®šæ¡ç›®çš„è·¯å¾„å’Œå‚æ•°å¯ä»¥åœ¨stackä¸­è¢«è§£æ</li>
<li><code>screen</code>-è®¾å®šscreenç»„ä»¶æˆ–è€…å­navigator</li>
<li><code>getScreen</code>-ä¸ºscreenç»„ä»¶è®¾å®šæƒ°æ€§åŠ è½½çš„è®¾å®š</li>
</ul>
<h2 id="StackConfig"><a href="#StackConfig" class="headerlink" title="StackConfig"></a>StackConfig</h2><p>é…ç½®çš„é€‰é¡¹ä¹Ÿè¢«ä¼ é€’è¿›å…¥stack router.</p>
<ul>
<li><code>initalRouteName</code>-stacké¦–æ¬¡åŠ è½½çš„é»˜è®¤è·¯ç”±çš„routeName</li>
<li><code>initialRouteParams</code>-åˆå§‹åŒ–routeçš„é»˜è®¤å‚æ•°</li>
<li><code>paths</code>-æä¾›routeNameåˆ°pathé…ç½®çš„æ˜ å°„,å°†ä¼šé‡å†™routeConfigsé‡Œçš„pathè®¾ç½®</li>
</ul>
<h2 id="Supported-Actions"><a href="#Supported-Actions" class="headerlink" title="Supported Actions"></a>Supported Actions</h2><p>stack routerå¯ä»¥å¯¹ä¸‹é¢çš„å¯¼èˆªactionsä½œä¸ºå“åº”.å¦‚æœæœ‰å¯èƒ½,routerå°†ä¼šä»£ç†åˆ°å­ä»£routerçš„actionæ“ä½œ.</p>
<ul>
<li>Navigate-å¦‚æœrouteNameå’Œrouterçš„routerConfigså…¶ä¸­ä¹‹ä¸€åŒ¹é…,å°†ä¼špushä¸€ä¸ªæ–°çš„routeåˆ°å †æ ˆ.</li>
<li>Back-è¿”å›(props)</li>
<li>Reset-æ¸…é™¤å †æ ˆ,æä¾›ä¸€ä¸ªæ–°çš„actionsåˆ›å»ºæ–°çš„navigation state</li>
<li>SetParams-screen dispatchä¸€ä¸ªactionå»æ”¹å˜å½“å‰routeçš„å‚æ•°</li>
</ul>
<h1 id="TabRouter"><a href="#TabRouter" class="headerlink" title="TabRouter"></a>TabRouter</h1><p>ç®¡ç†åº”ç”¨ä¸­çš„ä¸€å¥—tabs,å¤„ç†tabsä¹‹é—´çš„è·³è½¬,å¤„ç†backé”®çš„æ“ä½œè¿”å›åˆ°åˆå§‹åŒ–çš„tab.<br>çœ‹çœ‹ç®€å•çš„tabs router<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> const MyApp = TabRouter(&#123;</div><div class="line">  Home: &#123; screen: HomeScreen &#125;,</div><div class="line">  Settings: &#123; screen: SettingsScreen &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  initialRouteName: <span class="string">'Home'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="RouteConfig-1"><a href="#RouteConfig-1" class="headerlink" title="RouteConfig"></a>RouteConfig</h2><p>tabs routeræœ‰ä¸ºæ¯ä¸€ä¸ªtabçš„routeConfig<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = TabRouter(&#123; <span class="comment">// This is the RouteConfig:</span></div><div class="line">  Home: &#123;</div><div class="line">    <span class="attr">screen</span>: HomeScreen,</div><div class="line">    <span class="attr">path</span>: <span class="string">'main'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">Settings</span>: &#123;</div><div class="line">    <span class="comment">// This can be handy to lazily require a tab:</span></div><div class="line">    getScreen: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">require</span>(<span class="string">'./SettingsScreen'</span>).default,</div><div class="line">    <span class="comment">// Note: Child navigators cannot be configured using getScreen because</span></div><div class="line">    <span class="comment">// the router will not be accessible. Navigators must be configured</span></div><div class="line">    <span class="comment">// using `screen: MyNavigator`</span></div><div class="line">    path: <span class="string">'settings'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>configä¸­çš„æ¯ä¸€ä¸ªconfigå¯èƒ½æœ‰</p>
<ul>
<li><code>config</code>-æ¯ä¸€ä¸ªtabçš„path</li>
<li><code>screen</code>-å®šåˆ¶screenç»„ä»¶æˆ–è€…å­ä»£navigator</li>
<li><code>getScreen</code>-ä¸ºä¸€ä¸ªscreenç»„ä»¶è®¾å®šæƒ°æ€§åŠ è½½çš„è®¾ç½®(navigatoræ²¡æœ‰è¿™æ ·çš„é…ç½®)</li>
</ul>
<h2 id="Tab-Router-Config"><a href="#Tab-Router-Config" class="headerlink" title="Tab Router Config"></a>Tab Router Config</h2><p>è¢«ä¼ é€’åˆ°routerçš„å¯é…ç½®é€‰é¡¹</p>
<ul>
<li><code>initialRouteName</code>-é¦–æ¬¡åŠ è½½çš„tabçš„routeName</li>
<li><code>order</code>-tabsçš„é¡ºåº</li>
<li><code>path</code>-æä¾›routeNameåˆ°path configçš„æ˜ å°„,æ˜ å°„é‡å†™routeConfigä¸­çš„pathè®¾å®š</li>
<li><code>backBehavior</code>-ç‚¹å‡»backæŒ‰é’®åº”è¯¥è¿”å›åˆ°åˆå§‹åŒ–çš„tabå—ï¼Ÿå¦‚æœæ˜¯çš„è¯,è®¾ç½®<code>initialRoute</code>,å¦åˆ™å°±æ˜¯<code>none</code>,é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.</li>
</ul>
<h2 id="Support-Actions"><a href="#Support-Actions" class="headerlink" title="Support Actions"></a>Support Actions</h2><p>tabs routerä¼šå¯¹ä¸‹é¢çš„navigation actionsåšå‡ºå“åº”.å¦‚æœæœ‰å¯èƒ½,routerå°†ä»£ç†åˆ°å­ä»£routerçš„action.</p>
<ul>
<li>Navigate-å¦‚æœå’Œtabçš„routeNameåŒ¹é…,å°±ä¼šè·³è½¬åˆ°å¯¹åº”çš„tab</li>
<li>Back-å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªé»˜è®¤çš„tab,å°±è·³è½¬åˆ°ç¬¬ä¸€ä¸ªtab</li>
<li>SetParams-screen dispatchä¸€ä¸ªActionæ¥æ”¹å˜å½“å‰routeçš„state</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Routers&quot;&gt;&lt;a href=&quot;#Routers&quot; class=&quot;headerlink&quot; title=&quot;Routers&quot;&gt;&lt;/a&gt;Routers&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Routerå®šä¹‰ä¸€ä¸ªç»„ä»¶çš„navigation state,å…è®¸å¼€å‘è€…å®šä¹‰
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="http://yoursite.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(6)-Reduxçš„æ•´åˆå®ä¾‹</title>
    <link href="http://yoursite.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-6-Redux%E7%9A%84%E6%95%B4%E5%90%88%E5%AE%9E%E4%BE%8B/"/>
    <id>http://yoursite.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-6-Reduxçš„æ•´åˆå®ä¾‹/</id>
    <published>2017-03-29T23:42:14.000Z</published>
    <updated>2017-03-29T16:30:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†"><a href="#æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†" class="headerlink" title="æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹,githubçš„ä¾‹å­,ä»£ç å°±æ¯”è¾ƒå…¨äº†."></a>æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹,<a href="https://github.com/react-community/react-navigation/blob/master/examples/ReduxExample/index.js" target="_blank" rel="external">githubçš„ä¾‹å­</a>,ä»£ç å°±æ¯”è¾ƒå…¨äº†.</h1><p>å¯¹Reduxçš„æ¦‚å¿µç†è§£äº†è¿™ä¸ªçœ‹èµ·æ¥å°±ç®€å•ä¸€ç‚¹.å¦‚æœå¯¹äºReduxçš„æ¦‚å¿µä¸ç†è§£,å¯ä»¥çœ‹æˆ‘çš„å‡ ç¯‡ç¿»è¯‘æ–‡ç« å’Œå‰é¢å†™çš„Reduxçš„ç†è§£æ–‡ç« .<br>ç®€ä¹¦æ²¡æœ‰ç›®å½•å¯¼èˆª,ä¸æ˜¯å¤ªå¥½çœ‹.å¯ä»¥çœ‹çœ‹æˆ‘çš„<a href="https://phpsmarter.github.io" target="_blank" rel="external">åšå®¢</a>ï¼Œé‡Œé¢æœ‰ç›®å½•ç»“æ„.<br>æˆ‘ç†è§£å…¶ä¸­çš„æµç¨‹å°±æ˜¯,</p>
<ol>
<li>Reactç»„ä»¶æ¥å—propsï¼Œè·å–stateå’Œdispatch.</li>
<li>ç»„ä»¶dispatch actionæ”¹å˜navigationçš„state.<br>3.æ ¹æ®stateçš„ç›¸åº”å˜åŒ–åŠ è½½å¯¹åº”çš„screen.<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @flow</div><div class="line"> */</div><div class="line"></div><div class="line">import React <span class="keyword">from</span> 'react';</div><div class="line">import &#123;</div><div class="line">  AppRegistry,</div><div class="line">  AsyncStorage,</div><div class="line">  Button,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> 'react-native';</div><div class="line">import &#123;</div><div class="line">  NavigationActions,</div><div class="line">  addNavigationHelpers,</div><div class="line">  StackNavigator,</div><div class="line">&#125; <span class="keyword">from</span> 'react-navigation';</div><div class="line">import &#123;</div><div class="line">  Provider,</div><div class="line">  connect,//redux,connectå‡½æ•°,è´Ÿè´£å‘å±•ç¤ºç»„ä»¶æ³¨å…¥<span class="keyword">state</span>å’Œdispatch</div><div class="line">&#125; <span class="keyword">from</span> 'react-redux';</div><div class="line">import &#123;</div><div class="line">  createStore,</div><div class="line">  combineReducers,</div><div class="line">&#125; <span class="keyword">from</span> 'redux';</div><div class="line">import &#123;</div><div class="line">  persistStore,</div><div class="line">  autoRehydrate,</div><div class="line">&#125; <span class="keyword">from</span> 'redux-persist';//redux <span class="keyword">state</span>æŒä¹…åŒ–çš„ä¸­é—´ä»¶</div><div class="line"></div><div class="line">const ProfileScreen = (&#123; navigation &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">      Profile Screen</div><div class="line">    &lt;/Text&gt;</div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">ProfileScreen.navigationOptions = &#123;</div><div class="line">  title: 'Profile',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const LoginScreen = (&#123; navigation &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">      Screen A</div><div class="line">    &lt;/Text&gt;</div><div class="line">    <span class="variable">&lt;Text style=&#123;styles.instructions&#125;&gt;</span></div><div class="line">      This is great</div><div class="line">    &lt;/Text&gt;</div><div class="line">    <span class="variable">&lt;Button</span></div><div class="line">      onPress=&#123;() =&gt; navigation.dispatch(&#123; type: 'Login' &#125;)&#125;</div><div class="line">      title=<span class="string">"Log in"</span></div><div class="line">    /&gt;</div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">LoginScreen.navigationOptions = &#123;</div><div class="line">  title: 'Log In',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">//connect æ³¨å…¥<span class="keyword">state</span>å’Œdispatch</div><div class="line">const LoginStatusMessage = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  isLoggedIn: <span class="keyword">state</span>.auth.isLoggedIn,</div><div class="line">&#125;))((&#123; isLoggedIn, dispatch &#125;) =&gt; &#123;</div><div class="line">  if (!isLoggedIn) &#123;</div><div class="line">    return <span class="variable">&lt;Text&gt;</span>Please <span class="keyword">log</span> in&lt;/Text&gt;;</div><div class="line">  &#125;</div><div class="line">  return (</div><div class="line">    <span class="variable">&lt;View&gt;</span></div><div class="line">      <span class="variable">&lt;Text style=&#123;styles.welcome&#125;&gt;</span></div><div class="line">        &#123;'You are <span class="string">"logged in"</span> right now'&#125;</div><div class="line">      &lt;/Text&gt;</div><div class="line">      <span class="variable">&lt;Button</span></div><div class="line">        onPress=&#123;() =&gt; dispatch(NavigationActions.navigate(&#123; routeName: 'Profile' &#125;))&#125;</div><div class="line">        title=<span class="string">"Profile"</span></div><div class="line">      /&gt;</div><div class="line">    &lt;/View&gt;</div><div class="line">  );</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const AuthButton = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  isLoggedIn: <span class="keyword">state</span>.auth.isLoggedIn,</div><div class="line">&#125;), dispatch =&gt; (&#123;</div><div class="line">  logout: () =&gt; dispatch(&#123; type: 'Logout' &#125;),</div><div class="line">  login: () =&gt; dispatch(NavigationActions.navigate(&#123; routeName: 'Login' &#125;)),</div><div class="line">&#125;))((&#123; logout, login, isLoggedIn &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;Button</span></div><div class="line">    title=&#123;isLoggedIn ? 'Log Out' : 'Log In'&#125;</div><div class="line">    onPress=&#123;isLoggedIn ? logout : login&#125;</div><div class="line">  /&gt;</div><div class="line">));</div><div class="line"></div><div class="line">const MainScreen = () =&gt; (</div><div class="line">  <span class="variable">&lt;View style=&#123;styles.container&#125;&gt;</span></div><div class="line">    <span class="variable">&lt;LoginStatusMessage /&gt;</span></div><div class="line">    <span class="variable">&lt;AuthButton /&gt;</span></div><div class="line">  &lt;/View&gt;</div><div class="line">);</div><div class="line">MainScreen.navigationOptions = &#123;</div><div class="line">  title: 'Home Screen',</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const AppNavigator = StackNavigator(&#123;</div><div class="line">  Login: &#123; screen: LoginScreen &#125;,</div><div class="line">  Main: &#123; screen: MainScreen &#125;,</div><div class="line">  Profile: &#123; screen: ProfileScreen &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const AppWithNavigationState = connect(<span class="keyword">state</span> =&gt; (&#123;</div><div class="line">  nav: <span class="keyword">state</span>.nav,</div><div class="line">&#125;))((&#123; dispatch, nav &#125;) =&gt; (</div><div class="line">  <span class="variable">&lt;AppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch, state: nav &#125;)&#125; /&gt;</span></div><div class="line">));</div><div class="line"></div><div class="line">const initialNavState = &#123;</div><div class="line">  index: <span class="number">1</span>,</div><div class="line">  routes: [</div><div class="line">    &#123; key: 'InitA', routeName: 'Main' &#125;,</div><div class="line">    &#123; key: 'InitB', routeName: 'Login' &#125;,</div><div class="line">  ],</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const initialAuthState = &#123; isLoggedIn: false &#125;;</div><div class="line"></div><div class="line">const AppReducer = combineReducers(&#123;</div><div class="line">  nav: (<span class="keyword">state</span> = initialNavState, action) =&gt; &#123;</div><div class="line">    if (action.type === 'Login') &#123;</div><div class="line">      return AppNavigator.router.getStateForAction(NavigationActions.back(), <span class="keyword">state</span>);</div><div class="line">    &#125;</div><div class="line">    if (action.type === 'Logout') &#123;</div><div class="line">      return AppNavigator.router.getStateForAction(NavigationActions.navigate(&#123; routeName: 'Login' &#125;), <span class="keyword">state</span>);</div><div class="line">    &#125;</div><div class="line">    return AppNavigator.router.getStateForAction(action, <span class="keyword">state</span>);</div><div class="line">  &#125;,</div><div class="line">  auth: (<span class="keyword">state</span> = initialAuthState, action) =&gt; &#123;</div><div class="line">    if (action.type === 'Login') &#123;</div><div class="line">      return &#123; ...<span class="keyword">state</span>, isLoggedIn: true &#125;;</div><div class="line">    &#125;</div><div class="line">    if (action.type === 'Logout') &#123;</div><div class="line">      return &#123; ...<span class="keyword">state</span>, isLoggedIn: false &#125;;</div><div class="line">    &#125;</div><div class="line">    return <span class="keyword">state</span>;</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">class ReduxExampleApp extends React.Component &#123;</div><div class="line">  store = createStore(AppReducer, undefined, autoRehydrate());</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    persistStore(this.store, &#123; storage: AsyncStorage &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    return (</div><div class="line">      <span class="variable">&lt;Provider store=&#123;this.store&#125;&gt;</span></div><div class="line">        <span class="variable">&lt;AppWithNavigationState /&gt;</span></div><div class="line">      &lt;/Provider&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: <span class="number">1</span>,</div><div class="line">    justifyContent: 'center',</div><div class="line">    alignItems: 'center',</div><div class="line">    backgroundColor: '<span class="comment">#F5FCFF',</span></div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: <span class="number">20</span>,</div><div class="line">    textAlign: 'center',</div><div class="line">    margin: <span class="number">10</span>,</div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: 'center',</div><div class="line">    color: '<span class="comment">#333333',</span></div><div class="line">    marginBottom: <span class="number">5</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">AppRegistry.registerComponent('ReduxExample', () =&gt; ReduxExampleApp);</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†&quot;&gt;&lt;a href=&quot;#æ•´åˆå®ä¾‹ï¼Œå…¶å®è¿™å®Œå…¨æ˜¯Reduxçš„ä½¿ç”¨ï¼Œæ–‡æ¡£é‡Œçš„ä¾‹å­æ²¡æœ‰å†™å…¨æ‰€ä»¥ä¸å¤ªå¥½çœ‹-githubçš„ä¾‹å­-ä»£ç å°±æ¯”è¾ƒå…¨äº†&quot; class=&quot;hea
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="http://yoursite.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(5)-é«˜çº§æŒ‡å—</title>
    <link href="http://yoursite.com/2017/03/30/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-5-%E9%AB%98%E7%BA%A7%E6%8C%87%E5%8D%97/"/>
    <id>http://yoursite.com/2017/03/30/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-5-é«˜çº§æŒ‡å—/</id>
    <published>2017-03-29T16:41:19.000Z</published>
    <updated>2017-03-29T15:56:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redux-Intergration"><a href="#Redux-Intergration" class="headerlink" title="Redux Intergration"></a>Redux Intergration</h1><p>ä¸ºäº†åœ¨reduxä¸­å¤„ç†appçš„navigation state,ä½ å¯ä»¥ä¼ é€’ä½ è‡ªå·±çš„<code>navigation</code> propåˆ°ä¸€ä¸ªnavigator.ä½ çš„navigation propå¿…é¡»æä¾›å½“å‰çš„state,è¿˜æœ‰å°±æ˜¯å¤„ç†navigationé…ç½®é¡¹çš„dispatcher.</p>
<p>ä½¿ç”¨redux,ä½ çš„app stateç”±reduceræ¥å®šä¹‰.æ¯ä¸€ä¸ªnavigation routeréƒ½æœ‰ä¸€ä¸ªreducer,å«åš<code>getStateForAction</code>.ä¸‹é¢æ˜¯ä¸€åœ¨reduxåº”ç”¨ä¸­ä½¿ç”¨navigatorsçš„ç®€å•å®ä¾‹:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; addNavigationHelpers &#125; from <span class="symbol">'react</span>-navigation';</div><div class="line"></div><div class="line">const <span class="type">AppNavigator</span> = <span class="type">StackNavigator</span>(<span class="type">AppRouteConfigs</span>);</div><div class="line"></div><div class="line">const navReducer = (state, action) =&gt; &#123;</div><div class="line">  const newState = <span class="type">AppNavigator</span>.router.getStateForAction(action, state);</div><div class="line">  <span class="keyword">return</span> newState || state;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const appReducer = combineReducers(&#123;</div><div class="line">  nav: navReducer,</div><div class="line">  ...</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="meta">@connect</span>(state =&gt; (&#123;</div><div class="line">  nav: state.nav,</div><div class="line">&#125;))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppWithNavigationState</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">AppNavigator</span> navigation=&#123;addNavigationHelpers(&#123;</div><div class="line">        dispatch: <span class="keyword">this</span>.props.dispatch,</div><div class="line">        state: <span class="keyword">this</span>.props.nav,</div><div class="line">      &#125;)&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const store = createStore(appReducer);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Provider</span> store=&#123;store&#125;&gt;</div><div class="line">        &lt;<span class="type">AppWithNavigationState</span> /&gt;</div><div class="line">      &lt;/<span class="type">Provider</span>&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€æ—¦æŒ‰ç…§å®ä¾‹æ“ä½œ,navigation stateå°±å­˜å‚¨åœ¨reduxçš„storeä¸­,è¿™æ ·å°±å¯ä»¥ä½¿ç”¨reduxçš„dispatchå‡½æ•°æ¥å‘èµ·navigationçš„actions.</p>
<p>ç‰¢è®°åœ¨å¿ƒ,å½“ä¸€ä¸ªnavigatorç»™å®šä¸€ä¸ª<code>navigation</code>prop,ä»–å°†å¤±å»å†…éƒ¨stateçš„æ§åˆ¶æƒ.è¿™æ„å‘³ç€ç°åœ¨ä½ æ¥è´Ÿè´£stateçš„æŒä¹…åŒ–,å¤„ç†ä»»ä½•çš„æ·±åº¦é“¾æ¥,æ•´åˆBackæŒ‰é’®ç­‰æ“ä½œ.</p>
<p>å½“ä½ çš„navigatoræ˜¯å·¢å¼çš„æ—¶å€™,Navigation stateè‡ªåŠ¨ä»ä¸€ä¸ªnavigatorä¼ é€’åˆ°å¦ä¸€ä¸ªnavigator.æ³¨æ„,ä¸ºäº†è®©å­ä»£navigatorå¯ä»¥ä»çˆ¶ä»£navigatoræ¥æ”¶state,å®ƒåº”è¯¥å®šä¹‰ä¸ºä¸€ä¸ª<code>screen</code>.</p>
<p>å¯¹åº”ä¸Šé¢çš„å®ä¾‹,ä½ å¯ä»¥å®šä¹‰<code>AppNavigator</code>åŒ…å«ä¸€ä¸ªå·¢å¼çš„<code>TabNavigator</code>:</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute"> const AppNavigator</span> = StackNavigator(&#123;</div><div class="line">  Home: &#123; screen: MyTabNavigator &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªå®ä¾‹ä¸­,ä¸€æ—¦ä½ åœ¨<code>AppWithNavigationState</code>ä¸­<code>connect</code> <code>AppNavigator</code>åˆ°Redux,<code>MyTabNavigation</code>å°†ä¼šè‡ªåŠ¨æ¥å…¥åˆ°navigation state ä½œä¸º<code>navigtion</code>çš„prop.</p>
<h1 id="Web-Integration"><a href="#Web-Integration" class="headerlink" title="Web Integration"></a>Web Integration</h1><p>React Navigation routerså·¥ä½œåœ¨webç¯å¢ƒä¸‹å…è®¸ä½ å’ŒåŸç”Ÿappå…±äº«å¯¼èˆªçš„é€»è¾‘.ç»‘å®šåœ¨<code>react-navigation</code>çš„è§†å›¾ç›®å‰åªèƒ½å·¥ä½œåœ¨React Nativeä¸‹,ä½†æ˜¯åœ¨react-primitivesé¡¹ç›®ä¸­å¯èƒ½ä¼šæœ‰æ‰€æ”¹å˜.</p>
<h2 id="ç¤ºä¾‹ç¨‹åº"><a href="#ç¤ºä¾‹ç¨‹åº" class="headerlink" title="ç¤ºä¾‹ç¨‹åº"></a>ç¤ºä¾‹ç¨‹åº</h2><p><a href="https://reactnavigation.org/" target="_blank" rel="external">è¿™ä¸ªç½‘ç«™</a>ç”±React Navigationæ„å»º,ä½¿ç”¨äº†<code>createNavigation</code>å’Œ<code>TabRouter</code>.<br>çœ‹çœ‹ç½‘ç«™çš„æºä»£ç <a href="https://github.com/react-community/react-navigation/blob/master/website/src/App.js" target="_blank" rel="external">app.js</a></p>
<p>appå¦‚ä½•è·å¾—æ¸²æŸ“å‚çœ‹<a href="https://github.com/react-community/react-navigation/blob/master/website/src/Server.js" target="_blank" rel="external">server.js</a>.åœ¨æµè§ˆå™¨ä¸­,ä½¿ç”¨[BrowserAppContainer.js]æ¥å”¤é†’å’Œè·å¾—æ¸²æŸ“.</p>
<p>##æ›´å¤šå†…å®¹,å¾ˆå¿«å‘ˆç°<br>ä¸ä¹…ä¼šæœ‰è¯¦ç»†çš„æ•™ç¨‹.</p>
<h1 id="Deep-Linking"><a href="#Deep-Linking" class="headerlink" title="Deep Linking"></a>Deep Linking</h1><p>è¿™ä¸€éƒ¨åˆ†æŒ‡å—ä¸­,æˆ‘ä»¬å°†è®¾ç½®appæ¥å¤„ç†å¤–éƒ¨URIs.è®©æˆ‘ä»¬ä»SimpleAppå¼€å§‹<br><a href="https://reactnavigation.org/docs/intro" target="_blank" rel="external">getting startçš„æŒ‡å—</a></p>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­,æˆ‘ä»¬æƒ³ä½¿ç”¨ç±»ä¼¼<code>mychat://chat/Taylor</code>çš„URIæ¥æ‰“å¼€æˆ‘ä»¬çš„app,ç›´æ¥è¿æ¥åˆ°Taylorçš„chat page.</p>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>åœ¨å‰é¢æˆ‘ä»¬å®šä¹‰äº†navigatoræƒ³ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="symbol">  Home:</span> &#123; <span class="keyword">screen: </span>HomeScreen &#125;,</div><div class="line"><span class="symbol">  Chat:</span> &#123; <span class="keyword">screen: </span>ChatScreen &#125;,</div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æƒ³è®©pathç±»ä¼¼<code>chat/Taylor</code>é“¾æ¥åˆ°â€œChatâ€screen,ä¼ é€’<code>user</code>ä½œä¸ºå‚æ•°.æˆ‘ä»¬é‡æ–°å®šä¹‰æˆ‘ä»¬çš„chat screenä½¿ç”¨ä¸€ä¸ª<code>path</code>æ¥å‘Šè¯‰routeréœ€è¦åŒ¹é…çš„pathå’Œéœ€è¦æå–çš„å‚æ•°.è¿™ä¸ªè·¯å¾„é…ç½®ä¸º<code>chat/:user</code>.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="attr">  Home:</span> &#123; screen: HomeScreen &#125;,</div><div class="line"><span class="attr">  Chat:</span> &#123;</div><div class="line"><span class="attr">    screen:</span> ChatScreen,</div><div class="line"><span class="attr">    path:</span> <span class="string">'chat/:user'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="URIçš„å‰ç¼€"><a href="#URIçš„å‰ç¼€" class="headerlink" title="URIçš„å‰ç¼€"></a>URIçš„å‰ç¼€</h2><p>ä¸‹é¢é…ç½®navigation containeræ¥æå–appçš„path.å½“é…ç½®åœ¨é¡¶å±‚navigatorä¸Šçš„æ—¶å€™,æˆ‘ä»¬æä¾›<code>containerOperations</code>,</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> SimpleApp = StackNavigator(&#123;</div><div class="line">  ...</div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">containerOptions</span>: &#123;</div><div class="line">    <span class="comment">// on Android, the URI prefix typically contains a host in addition to scheme</span></div><div class="line">    URIPrefix: Platform.OS == <span class="string">'android'</span> ? <span class="string">'mychat://mychat/'</span> : <span class="string">'mychat://'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h2><p>åŸºäº<code>mychat://</code>URIå›¾å¼é…ç½®åŸç”Ÿçš„iOS app.<br>åœ¨<code>SimpleApp/ios/SimpleApp/AppleDelegate.m</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// Add the header at the top of the file:</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;React/RCTLinkingManager.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// Add this above the `@end`:</span></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url</div><div class="line">  sourceApplication:(<span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation</div><div class="line">&#123;</div><div class="line">  <span class="keyword">return</span> [RCTLinkingManager application:application openURL:url</div><div class="line">                      sourceApplication:sourceApplication annotation:annotation];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨Xcodeé‡Œ,æ‰“å¼€é¡¹ç›®çš„<code>simpleApp/ios/SimpleApp.xcodeproj</code>.åœ¨è¾¹æ ä¸­é€‰æ‹©é¡¹ç›®å¯¼èˆªåˆ°info tab.å‘ä¸‹æ»‘åŠ¨åˆ°â€œURL Typesâ€å¹¶ä¸”æ·»åŠ ä¸€ä¸ª.åœ¨æ–°çš„URL type,è®¾å®šåç§°å’Œurlå›¾å¼å¯¹åº”æƒ³å¯¼èˆªåˆ°çš„urlå›¾å¼.<br><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fe3z3gaupxj30ui0fk74v.jpg" alt=""></p>
<p>ç°åœ¨å¯ä»¥åœ¨Xcodeä¸­ç‚¹å‡»play,æˆ–è€…åœ¨å‘½ä»¤è¡Œè¿è¡Œ<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native <span class="keyword">run</span><span class="bash">-ios</span></div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†åœ¨iOSä¸­æµ‹è¯•URI,åœ¨safariä¸­æ‰“å¼€<code>mychat://chat/Taylor</code></p>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><p>ä¸ºäº†åœ¨Andoridä¸­é“¾æ¥å¤–é“¾,å¯ä»¥åœ¨manifestä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„intent.<br>åœ¨<code>SimpleApp/android/app/src/main/AndroidManifest.xml</code>ä¸­<code>MainActivity</code>å†…æ·»åŠ æ–°çš„<code>VIEW</code>type<code>intent-filter</code>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.VIEW"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.BROWSABLE"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:scheme</span>=<span class="string">"mychat"</span></span></div><div class="line">          <span class="attr">android:host</span>=<span class="string">"mychat"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ç°åœ¨,é‡æ–°è¿è¡Œ:<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native <span class="keyword">run</span><span class="bash">-android</span></div></pre></td></tr></table></figure></p>
<p>åœ¨Androidä¸­æµ‹è¯•intentæ“ä½œ,è¿è¡Œ<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb shell am start -W -<span class="selector-tag">a</span> android<span class="selector-class">.intent</span><span class="selector-class">.action</span><span class="selector-class">.VIEW</span> -d <span class="string">"mychat://mychat/chat/Taylor"</span> com.simpleapp</div></pre></td></tr></table></figure></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe3zdd1q9gg307i0dc17p.gif" alt=""></p>
<h1 id="Screen-tracking-and-analytics"><a href="#Screen-tracking-and-analytics" class="headerlink" title="Screen tracking and analytics"></a>Screen tracking and analytics</h1><p>è¿™ä¸ªå®ä¾‹ä¸­å±•ç¤ºæ€ä¹ˆåšå±å¹•è¿½è¸ªå¹¶ä¸”å‘åˆ°Google Analytics.è¿™ä¸ªæ–¹æ³•åº”ç”¨åœ¨å…¶ä»–çš„ç§»åŠ¨åˆ†æSDKä¹Ÿæ˜¯å¯ä»¥çš„.</p>
<h2 id="Screen-tracking"><a href="#Screen-tracking" class="headerlink" title="Screen tracking"></a>Screen tracking</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨å†…å»ºçš„navigation container,æˆ‘ä»¬ä½¿ç”¨<code>onNavigationStateChange</code>æ¥è¿½è¸ªscreen.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"> import &#123; GoogleAnalyticsTracker &#125; from <span class="string">'react-native-google-analytics-bridge'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</div><div class="line"></div><div class="line"><span class="comment">// gets the current screen from navigation state</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentRouteName</span><span class="params">(navigationState)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!navigationState) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">const</span> route = navigationState.routes[navigationState.index];</div><div class="line">  <span class="comment">// dive into nested navigators</span></div><div class="line">  <span class="keyword">if</span> (route.routes) &#123;</div><div class="line">    <span class="keyword">return</span> getCurrentRouteName(route);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> route.routeName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> AppNavigator = StackNavigator(AppRouteConfigs);</div><div class="line"></div><div class="line">export <span class="keyword">default</span> () =&gt; (</div><div class="line">  &lt;AppNavigator</div><div class="line">    onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123;</div><div class="line">      <span class="keyword">const</span> currentScreen = getCurrentRouteName(currentState);</div><div class="line">      <span class="keyword">const</span> prevScreen = getCurrentRouteName(prevState);</div><div class="line"></div><div class="line">      <span class="keyword">if</span> (prevScreen !== currentScreen) &#123;</div><div class="line">        <span class="comment">// the line below uses the Google Analytics tracker</span></div><div class="line">        <span class="comment">// change the tracker here to use other Mobile analytics SDK.</span></div><div class="line">        tracker.trackScreenView(currentScreen);</div><div class="line">      &#125;</div><div class="line">    &#125;&#125;</div><div class="line">  /&gt;</div><div class="line">);</div></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨ReduxåšScreen-tracking"><a href="#ä½¿ç”¨ReduxåšScreen-tracking" class="headerlink" title="ä½¿ç”¨ReduxåšScreen tracking"></a>ä½¿ç”¨ReduxåšScreen tracking</h2><p>ä½¿ç”¨Reduxçš„æ—¶å€™,æˆ‘ä»¬å¯ä»¥å†™Redux ä¸­é—´ä»¶æ¥track screen.ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„,æˆ‘ä»¬ä»å‰é¢çš„éƒ¨åˆ†é‡æ–°ä½¿ç”¨<code>getCurrenRouteName</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span>;</div><div class="line"><span class="keyword">import</span> &#123; GoogleAnalyticsTracker &#125; <span class="keyword">from</span> <span class="string">'react-native-google-analytics-bridge'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</div><div class="line"></div><div class="line"><span class="keyword">const</span> screenTracking = <span class="function">(<span class="params">&#123; getState &#125;</span>) =&gt;</span> next =&gt; <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (</div><div class="line">    action.type !== NavigationActions.NAVIGATE</div><div class="line">    &amp;&amp; action.type !== NavigationActions.BACK</div><div class="line">  ) &#123;</div><div class="line">    <span class="keyword">return</span> next(action);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> currentScreen = getCurrentRouteName(getState().navigation);</div><div class="line">  <span class="keyword">const</span> result = next(action);</div><div class="line">  <span class="keyword">const</span> nextScreen = getCurrentRouteName(getState().navigation);</div><div class="line">  <span class="keyword">if</span> (nextScreen !== currentScreen) &#123;</div><div class="line">    <span class="comment">// the line below uses the Google Analytics tracker</span></div><div class="line">    <span class="comment">// change the tracker here to use other Mobile analytics SDK.</span></div><div class="line">    tracker.trackScreenView(nextScreen);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> screenTracking;</div></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºRedux-storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶"><a href="#åˆ›å»ºRedux-storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶" class="headerlink" title="åˆ›å»ºRedux storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶"></a>åˆ›å»ºRedux storeå¹¶åº”ç”¨ä¸Šé¢çš„ä¸­é—´ä»¶</h2><p>åœ¨åˆ›å»ºstoreçš„æ—¶å€™åº”ç”¨è¿™ä¸ª<code>screenTracking</code>çš„ä¸­é—´ä»¶.çœ‹çœ‹Redux Integrationäº†è§£ç»†èŠ‚.<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> const store = createStore(</div><div class="line">  <span class="name">combineReducers</span>(&#123;</div><div class="line">    navigation: navigationReducer,</div><div class="line">    ...</div><div class="line">  &#125;),</div><div class="line">  applyMiddleware(</div><div class="line">    <span class="name">screenTracking</span>,</div><div class="line">    ...</div><div class="line">    ),</div><div class="line">)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Redux-Intergration&quot;&gt;&lt;a href=&quot;#Redux-Intergration&quot; class=&quot;headerlink&quot; title=&quot;Redux Intergration&quot;&gt;&lt;/a&gt;Redux Intergration&lt;/h1&gt;&lt;p&gt;ä¸ºäº†åœ¨red
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="http://yoursite.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(4)</title>
    <link href="http://yoursite.com/2017/03/29/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-4/"/>
    <id>http://yoursite.com/2017/03/29/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-4/</id>
    <published>2017-03-29T07:16:17.000Z</published>
    <updated>2017-03-29T16:34:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Navigation-Actions"><a href="#Navigation-Actions" class="headerlink" title="Navigation Actions"></a>Navigation Actions</h1><p>æ‰€æœ‰çš„Navigation Actionséƒ½ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡,è¿™ä¸ªå¯¹è±¡å¯ä»¥ä½¿ç”¨<code>navigation.dispatch</code>æ–¹æ³•ä¼ é€’åˆ°router.<br><em>æ³¨æ„</em>ï¼šå¦‚æœä½ æƒ³dispatch react-navigation,ä½ åº”è¯¥ä½¿ç”¨è¿™ä¸ªåº“æä¾›çš„action creators.</p>
<p>ä¸‹é¢çš„actionsæ˜¯å¯ä»¥ä½¿ç”¨çš„:</p>
<ul>
<li><code>Navigate</code>-å¯¼èˆªåˆ°å…¶ä»–çš„route</li>
<li><code>Reset</code>-ä½¿ç”¨æ–°çš„stateä»£æ›¿ç›®å‰çš„state</li>
<li><code>Back</code>-è¿”å›ä¸Šä¸€ä¸ªstate</li>
<li><code>Set Params</code>-ç»™å®šçš„routeè®¾ç½®å‚æ•°</li>
<li><code>Init</code>-å¦‚æœstateæ²¡æœ‰å®šä¹‰,ç”¨æ¥åˆå§‹åŒ–ç¬¬ä¸€ä¸ªstate</li>
</ul>
<h2 id="Navigate"><a href="#Navigate" class="headerlink" title="Navigate"></a>Navigate</h2><p><code>Navigatie action</code>ä¼šä½¿ç”¨<code>Navigate action</code>çš„ç»“æœæ¥æ›´æ–°å½“å‰çš„state.</p>
<ul>
<li><code>routeName</code>-å­—ç¬¦ä¸²-å¿…é€‰é¡¹,åœ¨appçš„routeré‡Œæ³¨å†Œçš„å¯¼èˆªç›®çš„åœ°çš„routeName.</li>
<li><code>params</code>-å¯¹è±¡-å¯é€‰é¡¹-èåˆè¿›ç›®çš„åœ°routeçš„å‚æ•°</li>
<li><code>actions</code>-å¯¹è±¡-å¯é€‰é¡¹-(é«˜çº§)-å¦‚æœscreenä¹Ÿæ˜¯ä¸€ä¸ªnavigator,æ¬¡çº§actionå¯ä»¥åœ¨å­routerä¸­è¿è¡Œ.åœ¨æ–‡æ¡£ä¸­æè¿°çš„ä»»ä½•actionséƒ½å¯ä»¥ä½œä¸ºæ¬¡çº§action.</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; from <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line">const navigateAction = NavigationActions.navigate(&#123;</div><div class="line"></div><div class="line">  routeName: <span class="string">'Profile'</span>,</div><div class="line"></div><div class="line">  params: &#123;&#125;,</div><div class="line"></div><div class="line">  action: NavigationActions.navigate(&#123; routeName: <span class="string">'SubProfileRoute'</span>&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">this.props.navigation.dispatch(navigateAction)</div></pre></td></tr></table></figure>
<h2 id="Reset"><a href="#Reset" class="headerlink" title="Reset"></a>Reset</h2><p><code>Reset</code>actionåˆ æ‰æ‰€æœ‰çš„navigation stateå¹¶ä¸”ä½¿ç”¨å‡ ä¸ªactionsçš„ç»“æœæ¥ä»£æ›¿.</p>
<ul>
<li><code>index</code>â€”æ•°ç»„-å¿…é€‰-navigation <code>state</code>ä¸­<code>route</code>æ•°ç»„ä¸­æ¿€æ´»routeçš„index.</li>
<li><code>actions</code>-æ•°ç»„-å¿…é€‰é¡¹-Navigation Actionsæ•°ç»„,å°†ä¼šæ›¿ä»£navigation state</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> resetAction = NavigationActions.reset(&#123;</div><div class="line">  <span class="attr">index</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">actions</span>: [</div><div class="line">    NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'Profile'</span>&#125;)</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(resetAction)</div></pre></td></tr></table></figure>
<h2 id="æ€ä¹ˆä½¿ç”¨indexå‚æ•°"><a href="#æ€ä¹ˆä½¿ç”¨indexå‚æ•°" class="headerlink" title="æ€ä¹ˆä½¿ç”¨indexå‚æ•°"></a>æ€ä¹ˆä½¿ç”¨<code>index</code>å‚æ•°</h2><p><code>index</code>å‚æ•°è¢«ç”¨æ¥å®šåˆ¶åŒ–å½“å‰æ¿€æ´»çš„route<br>ä¾‹å¦‚ï¼šä½¿ç”¨ä¸¤ä¸ªroutes <code>Profile</code>å’Œ<code>Settings</code>ç»™ä¸€ä¸ªåŸºç¡€çš„stakc navigationè®¾ç½®.ä¸ºäº†é‡ç½®routeåˆ°ç»è¿‡<code>Settings</code>çš„æ¿€æ´»screené‚£ä¸€ç‚¹,ä½†æ˜¯åœ¨å †æ ˆä¸­ä»–åˆå­˜æ”¾åœ¨<code>Setting</code>screenä¹‹ä¸Š,ä½ å¯ä»¥è¿™ä¹ˆåš:</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; from <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line">const resetAction = NavigationActions.reset(&#123;</div><div class="line">  index: <span class="number">1</span>,</div><div class="line">  actions: [</div><div class="line">    NavigationActions.navigate(&#123; routeName: <span class="string">'Profile'</span>&#125;),</div><div class="line">    NavigationActions.navigate(&#123; routeName: <span class="string">'Settings'</span>&#125;)</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line">this.props.navigation.dispatch(resetAction)</div></pre></td></tr></table></figure>
<h2 id="Back"><a href="#Back" class="headerlink" title="Back"></a>Back</h2><p>è¿”å›åˆ°å‰ä¸€ä¸ªscreenå¹¶ä¸”å…³é—­å½“å‰screen.<code>back</code>action creatoræ¥å—ä¸€ä¸ªå¯é€‰çš„å‚æ•°:</p>
<ul>
<li><code>key</code>-å­—ç¬¦ä¸²æˆ–è€…ç©º-å¯é€‰é¡¹-å¦‚æœè®¾å®šäº†,navigationå°†ä¼šä»è®¾å®šçš„keyè¿”å›.å¦‚æœæ˜¯null,navigationå°†è¿”å›åˆ°ä»»ä½•åœ°æ–¹.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> backAction = NavigationActions.back(&#123;</div><div class="line">  <span class="attr">key</span>: <span class="string">'Profile'</span></div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(backAction)</div></pre></td></tr></table></figure>
<h2 id="SetParams"><a href="#SetParams" class="headerlink" title="SetParams"></a>SetParams</h2><p>å½“dispatching <code>setParamsçš„æ—¶å€™</code>,routerå°†ä¼šäº§å‡ºä¸€ä¸ªæ–°çš„state,è¿™ä¸ªstateæ˜¯å·²ç»æ”¹å˜äº†ç‰¹å®šrouteçš„å‚æ•°,ä»¥keyä½œä¸ºèº«ä»½éªŒè¯</p>
<ul>
<li><code>params</code>-å¯¹è±¡-å¿…é€‰å‚æ•°-èåˆè¿›å·²ç»å­˜åœ¨çš„routeå‚æ•°ä¸­çš„æ–°å‚æ•°</li>
<li><code>key</code>-å­—ç¬¦ä¸²-å¿…é€‰å‚æ•°-Routeçš„key,åº”è¯¥åˆ†é…ç»™æ–°çš„å‚æ•°</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> setParamsAction = NavigationActions.setParams(&#123;</div><div class="line">  <span class="attr">params</span>: &#123; <span class="attr">title</span>: <span class="string">'Hello'</span> &#125;,</div><div class="line">  <span class="attr">key</span>: <span class="string">'screen-123'</span>,</div><div class="line">&#125;)</div><div class="line"><span class="keyword">this</span>.props.navigation.dispatch(setParamsAction)</div></pre></td></tr></table></figure>
<h1 id="Screen-Navigation-Options"><a href="#Screen-Navigation-Options" class="headerlink" title="Screen Navigation Options"></a>Screen Navigation Options</h1><p>æ¯ä¸ªscreenéƒ½å¯ä»¥é…ç½®å‡ ä¸ªæ–¹é¢çš„å†…å®¹,è¿™äº›å†…å®¹å½±å“åˆ°åœ¨çˆ¶navigatorsä¸­æ€ä¹ˆå¾—åˆ°å±•ç¤º.</p>
<h2 id="å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•"><a href="#å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•"></a>å®šåˆ¶æ¯ä¸€ä¸ªå¯é€‰é¡¹çš„ä¸¤ç§æ–¹æ³•</h2><p><em>é™æ€é…ç½®æ–¹æ³•</em>:æ¯ä¸€ä¸ªnavigation å¯é€‰é¡¹éƒ½å¯ä»¥è¢«ç›´æ¥è®¾å®š:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: <span class="symbol">'Grea</span>t',</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<p><em>åŠ¨æ€é…ç½®æ–¹æ³•</em><br>è¦ä¹ˆå°±é‡‡ç”¨å‡½æ•°å¼çš„æ–¹æ³•,æ¥å—å‚æ•°,ç„¶åè¿”å›å¯é€‰é¡¹çš„å€¼.</p>
<ul>
<li><code>navigation</code>-screençš„navigation propå’Œ<code>navigation.state</code>ä¸­screençš„route</li>
<li><code>childRouter</code>-å¦‚æœscreenæ˜¯ä¸€ä¸ªnavigator,è¿™ä¸ªå‚æ•°å°±æ˜¯å­ä»£router.</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: (navigation, childRouter) =&gt; &#123;</div><div class="line">     <span class="keyword">return</span> navigation.state.params.name + <span class="string">"'s Profile!"</span>;</div><div class="line">   &#125;,</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<h2 id="é€šç”¨çš„Navigation-Options"><a href="#é€šç”¨çš„Navigation-Options" class="headerlink" title="é€šç”¨çš„Navigation Options"></a>é€šç”¨çš„Navigation Options</h2><p>navigationçš„å¯é€‰é¡¹<code>title</code>åœ¨æ¯ä¸€ä¸ªnavigatorä¹‹é—´æ˜¯é€šç”¨çš„,ç”¨æ¥è®¾å®šæ¯ä¸€ä¸ªscreençš„æ ‡é¢˜å­—ç¬¦ä¸².</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"> static navigationOptions = &#123;</div><div class="line">   title: <span class="symbol">'Grea</span>t',</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure>
<p>ä¸åƒå…¶ä»–çš„navigationçš„å¯é…ç½®é¡¹ä»…ä»…ç”±navigator viewæ¥ä½¿ç”¨,title é€‰é¡¹å¯ä»¥è¢«ç¯å¢ƒå˜é‡ä½¿ç”¨æ¥æ›´æ–°æµè§ˆå™¨çš„æ ‡é¢˜æˆ–è€…appåˆ‡æ¢æ—¶å€™çš„æ ‡é¢˜.</p>
<h2 id="é»˜è®¤çš„Navigationé€‰é¡¹"><a href="#é»˜è®¤çš„Navigationé€‰é¡¹" class="headerlink" title="é»˜è®¤çš„Navigationé€‰é¡¹"></a>é»˜è®¤çš„Navigationé€‰é¡¹</h2><p>åœ¨screenä¸­å®šä¹‰<code>navigationOption</code>éå¸¸æ™®é,ä½†æ˜¯æœ‰æ—¶å€™åœ¨navigatorä¸­å®šä¹‰<code>navitationOptions</code>ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨</p>
<p>æƒ³è±¡ä¸‹é¢çš„åœºæ™¯:ä½ çš„<code>TabNavigator</code>ä»£è¡¨appä¸­çš„ä¸€ä¸ªscreen.ä»–åœ¨é¡¶å±‚<code>StackNavigator</code>ä¹‹å†…:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">StackNavigator:</span></div><div class="line"> - <span class="string">route1:</span> A screen</div><div class="line"> - <span class="string">route2:</span> A TabNavigator</div></pre></td></tr></table></figure>
<p>ç°åœ¨<code>route2</code>æ˜¯æ¿€æ´»çš„,ä½ å¯èƒ½ä¼šéšè—header,éšè—<code>route1</code>çš„headeréå¸¸å®¹æ˜“,<code>route2</code>çš„headeråº”è¯¥ä¹Ÿå¾ˆå®¹æ˜“éšè—.è¿™å°±æ˜¯é»˜è®¤Navigation Option è¦åšçš„.å¯ä»¥åœ¨<code>navigationOptions</code>ä¸­è®¾å®š:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">TabNavigator</span>(&#123;</div><div class="line">  <span class="attribute">profile</span>: ProfileScreen,</div><div class="line">  ...</div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attribute">navigationOptions</span>: &#123;</div><div class="line">     header: &#123;</div><div class="line">       visible: false,</div><div class="line">     &#125;,</div><div class="line">   &#125;,</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p>æç¤º:ä½ ä»ç„¶å¯ä»¥åœ¨å­ä»£å¯¼èˆªscreenä¸Šå®šåˆ¶<code>navigationOptions</code>.-ä¾‹å¦‚,ä¸Šé¢çš„<code>ProfileScreen</code>.ä»screenè·å¾—çš„<code>navigationOptions</code>ä¼šå’Œä»navigatoræ¥çš„é…ç½®æŒ‰ç…§é”®-é”®çš„æ–¹å¼èåˆåœ¨ä¸€èµ·.æ— è®ºåœ¨ä»€ä¹ˆè€Œæ—¶é—´,navigatorå’Œscreenå®šä¹‰ç›¸åŒçš„é…ç½®(ä¾‹å¦‚:<code>header</code>),screenä¼šä¼˜å…ˆä½¿ç”¨.å› æ­¤,å½“<code>ProfileScreen</code>æ¿€æ´»çš„æ—¶å€™,ä½ å¯ä»¥ä½¿headerå†æ¬¡å¯è§.</p>
<p><em>æ‰©å±•é»˜è®¤é…ç½®</em>:ä¸ºäº†ä½¿ç”¨screenç‰¹å®šçš„propertiesæ‰©å±•é»˜è®¤é…ç½®,è€Œä¸æ˜¯é‡å†™å®ƒ,ä½ å¯ä»¥åƒä¸‹é¢ä¸€æ ·é…ç½®é€‰é¡¹:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    header: (navigation, defaultHeader) =&gt; (&#123;</div><div class="line">      ...defaultHeader,</div><div class="line">      visible: <span class="literal">true</span>,</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¼ é€’åˆ°å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºåœ¨navigatorä¸­å®šä¹‰çš„<code>header</code>çš„é»˜è®¤å€¼.</p>
<h2 id="Tab-Navigation-Options"><a href="#Tab-Navigation-Options" class="headerlink" title="Tab Navigation Options"></a>Tab Navigation Options</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TabScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: (&#123; state &#125;) =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Tab</span> <span class="type">Label</span>',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./tab-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">      visible: <span class="literal">true</span></div><div class="line">    &#125;),</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><code>label</code>-å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯Reactç»„ä»¶</li>
<li><code>icon</code>-å‡½æ•°è¿”å›iconç»„ä»¶</li>
<li><code>visible</code>-trueæˆ–è€…false,æ˜¾ç¤ºæˆ–è€…éšè—tab bar,é»˜è®¤æ˜¯true</li>
</ul>
<h1 id="Custom-Navigation"><a href="#Custom-Navigation" class="headerlink" title="Custom Navigation"></a>Custom Navigation</h1><p>ä¸€ä¸ªnavigatoræ˜¯ä»»ä½•åŒ…å«routerçš„Reactç»„ä»¶.è¿™é‡Œæ˜¯ä¸€ä¸ªåŸºæœ¬navigator,ä½¿ç”¨routerçš„APIå»è·å¾—æ¿€æ´»ç»„ä»¶æ¥æ¸²æŸ“<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"> class MyNavigator extends React.Component &#123;</div><div class="line">  static router = MyRouter;</div><div class="line">  render() &#123;</div><div class="line">    const &#123; <span class="keyword">state</span>, dispatch &#125; = this.props.navigation;</div><div class="line">    const &#123; routes, index &#125; = <span class="keyword">state</span>;</div><div class="line"></div><div class="line">    // Figure <span class="keyword">out</span> what <span class="keyword">to</span> render based <span class="keyword">on</span> the navigation <span class="keyword">state</span> and the router:</div><div class="line">    const Component = MyRouter.getComponentForState(<span class="keyword">state</span>);</div><div class="line"></div><div class="line">    // The <span class="keyword">state</span> of the active child screen can be found at routes[index]</div><div class="line">    let childNavigation = &#123; dispatch, <span class="keyword">state</span>: routes[index] &#125;;</div><div class="line">    // If we want, we can also tinker with the dispatch function here, <span class="keyword">to</span> <span class="keyword">limit</span></div><div class="line">    // or augment our children's actions</div><div class="line"></div><div class="line">    // Assuming our children want the convenience of calling .navigate() and so <span class="keyword">on</span>,</div><div class="line">    // we should call addNavigationHelpers <span class="keyword">to</span> augment our navigation prop:</div><div class="line">    childNavigation = addNavigationHelpers(childNavigation);</div><div class="line"></div><div class="line">    return <span class="variable">&lt;Component navigation=&#123;childNavigation&#125; /&gt;</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Navigation-Prop"><a href="#Navigation-Prop" class="headerlink" title="Navigation Prop"></a>Navigation Prop</h2><p>navigation propä¼ é€’ç»™navigatorçš„ä»…ä»…åŒ…å«<code>state</code>å’Œ<code>dispatch</code>,è¿™æ˜¯å½“å‰çš„navigatorçš„state,ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªäº‹ä»¶é¢‘é“ç”¨æ¥å‘é€action request.<br>æ‰€æœ‰çš„navigatorséƒ½æ˜¯å—æ§ç»„ä»¶:ä»–ä»¬æ€»æ˜¯æ˜¾ç¤ºæ ¹æ®<code>props.navigation.state</code>æ¥æ˜¾ç¤º,ä»–ä»¬è¦æ”¹å˜state,å”¯ä¸€çš„åŠæ³•æ˜¯å‘é€actionsåˆ°<code>props.navigation.dispatch</code>.<br>Navigatorså¯ä»¥é€šè¿‡å®šåˆ¶ä»–ä»¬çš„routeræ¥æ”¹å˜çˆ¶navigatorsçš„è¡Œä¸º.ä¾‹å¦‚,å½“actionåº”è¯¥ä»<code>router.getStateForAction</code>è¿”å›nullæ¥é˜»æ­¢å…¶è¿è¡Œçš„æ—¶å€™.æˆ–è€…ä¸€ä¸ªnavigatorå¯ä»¥ä¸ºäº†å®šåˆ¶URIçš„æ“ä½œè€Œæ”¹å†™<code>router.getActionForPathParams</code>,ä¸ºäº†è¾“å‡ºç›¸å¯¹navigation actionä»¥åŠæ“ä½œ<code>router.getStateForAction</code>çš„action.</p>
<h2 id="Navigation-State"><a href="#Navigation-State" class="headerlink" title="Navigation State"></a>Navigation State</h2><p>ä¼ é€’åˆ°<code>props.navigation.state</code>çš„navigation stateæœ‰ä¸‹é¢çš„ç»“æ„:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> &#123;</div><div class="line">  <span class="attribute">index</span>: <span class="number">1</span>, <span class="comment">// identifies which route in the routes array is active</span></div><div class="line">  <span class="attribute">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="comment">// Each route needs a name, which routers will use to associate each route</span></div><div class="line">      <span class="comment">// with a react component</span></div><div class="line">      <span class="attribute">routeName</span>: <span class="string">'MyRouteName'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// A unique id for this route, used to keep order in the routes array:</span></div><div class="line">      <span class="attribute">key</span>: <span class="string">'myroute-123'</span>,</div><div class="line"></div><div class="line">      <span class="comment">// Routes can have any additional data. The included routers have `params`</span></div><div class="line">      ...customRouteData,</div><div class="line">    &#125;,</div><div class="line">    ..<span class="selector-class">.moreRoutes</span>,</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Navigation-Dispatchers"><a href="#Navigation-Dispatchers" class="headerlink" title="Navigation Dispatchers"></a>Navigation Dispatchers</h2><p>navigatorå¯ä»¥dispatch navigation actions,ä¾‹å¦‚Go to URI,Go back.<br>å¦‚æœactionè¢«æˆåŠŸæ“ä½œäº†,dispatcherå°†ä¼šè¿”å›true,å¦åˆ™å°±æ˜¯false</p>
<h2 id="æ„å»ºå®šåˆ¶navigatorsçš„API"><a href="#æ„å»ºå®šåˆ¶navigatorsçš„API" class="headerlink" title="æ„å»ºå®šåˆ¶navigatorsçš„API"></a>æ„å»ºå®šåˆ¶navigatorsçš„API</h2><p>ä¸ºäº†å¸®åŠ©å¼€å‘è€…å®æ–½å®šåˆ¶navigators,React Navigationæä¾›äº†ä¸‹é¢çš„å·¥å…·<br><code>createNavigator</code><br>è¿™ä¸ªå·¥å…·ä½¿ç”¨æ ‡å‡†æ–¹æ³•æŠŠrouterå’Œnavigation viewåˆå¹¶åœ¨ä¸€èµ·.<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">const MyApp = createNavigator(<span class="name">MyRouter</span>)(<span class="name">MyView</span>)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>å¹•åæ‰€åšçš„æ˜¯:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> MyApp = <span class="function">(<span class="params">&#123; navigation &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">MyView</span> <span class="attr">router</span>=<span class="string">&#123;MyRouter&#125;</span> <span class="attr">navigation</span>=<span class="string">&#123;navigation&#125;</span> /&gt;</span></span></div><div class="line">);</div><div class="line">MyApp.router = MyRouter;</div></pre></td></tr></table></figure>
<p><code>addNavigationHelpers</code><br>æ¥æ”¶ä¸€ä¸ªæ‹¥æœ‰<code>state</code>å’Œ<code>dispatch</code>çš„çº¯navigatorçš„prop,ä¼ é€’çš„å‚æ•°æ˜¯åœ¨screen navigation propä¸­çš„å„ç§å‡½æ•°,ä¾‹å¦‚<code>navigation.navigate()</code>å’Œ<code>navigation.goBack()</code>.è¿™äº›å‡½æ•°æ˜¯ç®€å•çš„åŠ©æ‰‹å‡½æ•°å¸®åŠ©åˆ›å»ºactionå¹¶ä¸”å‘é€åˆ°<code>dispatch</code>.</p>
<p><code>createNavigationContainer</code></p>
<p>å¦‚æœä½ æƒ³è®©ä½ çš„navigatorä½œä¸ºé¡¶å±‚ç»„ä»¶ä½¿ç”¨(æ²¡æœ‰navigation propä¼ å…¥),ä½ å¯ä»¥ä½¿ç”¨<code>createNavigationContainer</code>.å½“ç¼ºå°‘navigtion propçš„æ—¶å€™,è¿™ä¸ªå·¥å…·ä½¿ä½ çš„navigatorçœ‹èµ·æ¥åƒä¸€ä¸ªé¡¶å±‚çš„å¯¼èˆªç»„ä»¶.å®ƒå°†ç®¡ç†appçš„state,å’Œappçº§åˆ«çš„å¯¼èˆªç‰¹æ€§æ•´åˆåœ¨ä¸€èµ·,ä¾‹å¦‚æ“ä½œè¿›å‡ºçš„é“¾æ¥å’Œandroidçš„è¿”å›æŒ‰é’®è¡Œä¸º.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Navigation-Actions&quot;&gt;&lt;a href=&quot;#Navigation-Actions&quot; class=&quot;headerlink&quot; title=&quot;Navigation Actions&quot;&gt;&lt;/a&gt;Navigation Actions&lt;/h1&gt;&lt;p&gt;æ‰€æœ‰çš„Nav
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-Native" scheme="http://yoursite.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(3)</title>
    <link href="http://yoursite.com/2017/03/28/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-3/"/>
    <id>http://yoursite.com/2017/03/28/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-3/</id>
    <published>2017-03-28T07:48:36.000Z</published>
    <updated>2017-03-28T22:59:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Navigators"><a href="#Navigators" class="headerlink" title="Navigators"></a>Navigators</h1><p>Navigatorså…è®¸ä½ å®šä¹‰ä½ çš„å¯¼èˆªç»“æ„.Navigatorsä¹Ÿå¯ä»¥æ¸²æŸ“æ™®é€šçš„å…ƒç´ ,ä¾‹å¦‚ä½ é…ç½®å¥½çš„headerå’Œtab bar.<br>navigatorså¯ä»¥æ˜¯å•çº¯çš„Reactç»„ä»¶.</p>
<h2 id="å†…å»ºçš„Navigators"><a href="#å†…å»ºçš„Navigators" class="headerlink" title="å†…å»ºçš„Navigators"></a>å†…å»ºçš„Navigators</h2><p><code>react-navigation</code>åŒ…å«ä¸‹é¢çš„å‡ ä¸ªå‡½æ•°å¸®åŠ©ä½ åˆ›å»ºnavigatorsï¼š</p>
<ul>
<li><code>StackNavigator</code>-ä¸€æ¬¡æ¸²æŸ“ä¸€ä¸ªscreen,åœ¨screenä¹‹é—´åˆ‡æ¢.å½“ä¸€ä¸ªæ–°çš„screenè¢«æ‰“å¼€çš„æ—¶å€™,ä»–è¢«æ”¾åœ¨æ ˆé¡¶.</li>
<li><code>TabNavigator</code>-æ¸²æŸ“å‡ºä¸€ä¸ªtab barè®©ç”¨æˆ·å¯ä»¥åœ¨å¤šä¸ªscreenä¹‹é—´åˆ‡æ¢.</li>
<li><code>DrawNavigator</code>-æ¸²æŸ“ä¸€ä¸ªæŠ½å±‰,å¯ä»¥ä»å±å¹•å·¦è¾¹ä¾§æ»‘å‡º.</li>
</ul>
<h2 id="ä½¿ç”¨Navigatorsæ¸²æŸ“screen"><a href="#ä½¿ç”¨Navigatorsæ¸²æŸ“screen" class="headerlink" title="ä½¿ç”¨Navigatorsæ¸²æŸ“screen"></a>ä½¿ç”¨Navigatorsæ¸²æŸ“screen</h2><p>navigatorså®é™…æ¸²æŸ“çš„å°±æ˜¯Reactç»„ä»¶<br>äº†è§£æ€ä¹ˆåˆ›å»ºscreen,è¯»è¯»ä¸€ä¸‹å†…å®¹:</p>
<ul>
<li>Screen<code>navigation</code>propså…è®¸screenåˆ†å‘navigationåŠ¨ä½œ,ä¾‹å¦‚æ“ä½œå¦å¤–ä¸€ä¸ªscreen.</li>
<li>Screen <code>navigationOptions</code>å®šåˆ¶screençš„å±•ç¤ºæ–¹å¼(ä¾‹å¦‚ï¼šheader title,tab label)<h2 id="åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª"><a href="#åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª" class="headerlink" title="åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª"></a>åœ¨é¡¶å±‚ç»„ä»¶ä¸Šè°ƒç”¨å¯¼èˆª</h2>ä¸‡ä¸€ä½ æƒ³åœ¨åŒä¸€çº§åˆ«çš„Navigation screenä¹‹é—´ä½¿ç”¨Navigator,ä½ å¯ä»¥ä½¿ç”¨reactçš„<code>ref</code>é€‰é¡¹:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">   const <span class="type">AppNavigator</span> = <span class="type">StackNavigator</span>(<span class="type">SomeAppRouteConfigs</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  someEvent() &#123;</div><div class="line">    <span class="comment">// call navigate for AppNavigator here:</span></div><div class="line">    <span class="keyword">this</span>.navigator &amp;&amp; <span class="keyword">this</span>.navigator.dispatch(&#123; <span class="class"><span class="keyword">type</span></span>: <span class="symbol">'Navigat</span>e', routeName, params &#125;);</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">AppNavigator</span> ref=&#123;nav =&gt; &#123; <span class="keyword">this</span>.navigator = nav; &#125;&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:è¿™ä¸ªè§£å†³åŠæ³•åªèƒ½ç”¨åœ¨é¡¶å±‚navigatorä¸Š.</p>
<h2 id="Navigation-Containers"><a href="#Navigation-Containers" class="headerlink" title="Navigation Containers"></a>Navigation Containers</h2><p>å¦‚æœnavigatorsæ²¡æœ‰propsçš„è¯,ä»–å°±ä¼šè¡¨ç°ä¸ºé¡¶å±‚navigators.è¿™ä¸ªæ–¹å¼æä¾›äº†ä¸€ä¸ªé€æ˜çš„navigator container,è¿™æ˜¯é¡¶å±‚å¯¼èˆªpropsçš„æ¥æº.<br>å½“æ¸²æŸ“å…¶ä¸­ä¸€ä¸ªnavigatorsçš„æ—¶å€™,navigation propæ˜¯å¯é€‰çš„.å¦‚æœæ²¡æœ‰navigation prop,containerå°†ä¼šç®¡ç†è‡ªå·±çš„å¯¼èˆªstate.ä»–ä¹Ÿå¯ä»¥ä½¿ç”¨URLs,å¤–éƒ¨é“¾æ¥ä»¥åŠæ•´åˆandroidçš„back button.</p>
<p>ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿,åœ¨å¹•åå†…å»ºçš„navigatorsæœ‰è¿™ä¸ªèƒ½åŠ›,å› ä¸ºåœ¨å¹•åä»–ä»¬ä½¿ç”¨äº†<code>createNavigationContainer</code>.é€šå¸¸,navigatorséœ€è¦ä¸€ä¸ªnavigation propæ¥æ‰§è¡Œä¸€å®šçš„åŠŸèƒ½.<br><code>onNavigationStateChange(prevState, newState)</code></p>
<p>å½“navigation stateç”±é¡¶å±‚navigatorå˜åŒ–ç®¡ç†çš„æ—¶å€™,è¿™ä¸€ç‚¹éå¸¸æœ‰ç”¨.ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„,è¿™ä¸ªå‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šä½¿ç”¨å¯¼èˆªä¹‹å‰çš„stateå’Œå¯¼èˆªä¹‹åçš„æ–°stateä½œä¸ºå‚æ•°.</p>
<p><code>containerOptions</code><br>å½“ä¸€ä¸ªnavigatoråœ¨é¡¶å±‚è¢«ä½¿ç”¨çš„æ—¶å€™,è¿™äº›é€‰é¡¹å¯ä»¥æ¥é…ç½®è¿™ä¸ªnavigator.<br>å¦‚æœä¸€ä¸ªnavigatoré…ç½®äº†<code>containerOptions</code>,ä½†æ˜¯ä¹Ÿæ¥å—äº†<code>navigation</code>prop,ä¼šæŠ›å‡ºé”™è¯¯.å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹,navigatoræœ‰ä¸¤ç§é€‰æ‹©,å®ƒå°±ä¸çŸ¥é“æ€ä¹ˆåšäº†.</p>
<ul>
<li><code>URIPrefic</code>-appå¯ä»¥å¤„ç†çš„URIå‰ç¼€.åœ¨å¤„ç†<code>deep link</code>çš„æ—¶å€™ï¼Œå¯ä»¥æå–è·¯å¾„,å¹¶ä¸”ä¼ é€’åˆ°router.</li>
</ul>
<h1 id="StackNavigator"><a href="#StackNavigator" class="headerlink" title="StackNavigator"></a>StackNavigator</h1><p>ç»™ä½ çš„appæä¾›screenä¹‹é—´è½¬å˜çš„æ–¹æ³•,æ¯ä¸ªè½¬å˜åˆ°çš„screenä¼šå­˜æ”¾åœ¨å †æ ˆçš„æ ˆé¡¶.<br>é»˜è®¤æƒ…å†µä¸‹,StackNavigatoré…ç½®æœ‰iOSå’Œandroidçš„å¤–è§‚å’Œæ„Ÿè§‰:åœ¨iOSä¸‹,æ–°çš„screenä»å±å¹•çš„å³ä¾§æ»‘å…¥,åœ¨androidä¸‹,æ–°çš„screenä»åº•éƒ¨æ·¡å…¥.iOSä¸‹ä¹Ÿå¯ä»¥é…ç½®ä¸ºä»å±å¹•åº•éƒ¨æ»‘å…¥.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Hom</span>e',</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Profil</span>e', &#123;name: <span class="symbol">'Luc</span>y'&#125;)&#125;</div><div class="line">        title=<span class="string">"Go to Lucy's profile"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const <span class="type">ModalStack</span> = <span class="type">StackNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Profile</span>: &#123;</div><div class="line">    path: <span class="symbol">'people</span>/:name',</div><div class="line">    screen: <span class="type">MyProfileScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="å®šä¹‰API"><a href="#å®šä¹‰API" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><p><code>StackNavigator(Routeconfigs,StackNavigatorConfig)</code></p>
<h2 id="RouteConfigs"><a href="#RouteConfigs" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>routeçš„é…ç½®å¯¹è±¡æ˜¯route nameåˆ°route configçš„æ˜ å°„(è¯‘è€…:è¿™æ‰æ˜¯é‡ç‚¹),é…ç½®å¯¹è±¡å‘Šè¯‰navigatorä»€ä¹ˆæ¥ä»£è¡¨route.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">StackNavigator(&#123;</div><div class="line"></div><div class="line">  <span class="comment">// For each screen that you can navigate to, create a new entry like this:</span></div><div class="line">  Profile: &#123;</div><div class="line"></div><div class="line">    <span class="comment">// `ProfileScreen` is a React component that will be the main content of the screen.</span></div><div class="line">    screen: ProfileScreen,</div><div class="line">    <span class="comment">// When `ProfileScreen` is loaded by the StackNavigator, it will be given a `navigation` prop.</span></div><div class="line"></div><div class="line">    <span class="comment">// Optional: When deep linking or using react-navigation in a web app, this path is used:</span></div><div class="line">    path: <span class="string">'people/:username'</span>,</div><div class="line">    <span class="comment">// The action and route params are extracted from the path.</span></div><div class="line"></div><div class="line">    <span class="comment">// Optional: Override the `navigationOptions` for the screen</span></div><div class="line">    navigationOptions: &#123;</div><div class="line">      <span class="attr">title</span>: <span class="function">(<span class="params">&#123;state&#125;</span>) =&gt;</span> <span class="string">`<span class="subst">$&#123;state.params.username&#125;</span>'s Profile'`</span>,</div><div class="line">    &#125;,</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  ...MyOtherRoutes,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="StackNavigatorConfi"><a href="#StackNavigatorConfi" class="headerlink" title="StackNavigatorConfi"></a>StackNavigatorConfi</h2><p>Routerçš„Options:</p>
<ul>
<li><code>initialRouteName</code>-è®¾å®šé»˜è®¤çš„å †æ ˆçš„screen.éœ€è¦å’Œroute configçš„é”®ä¹‹ä¸€ç›¸åŒ.</li>
<li><code>initalRouteParams</code>-åˆå§‹åŒ–routeçš„å‚æ•°</li>
<li><code>navigationOptions</code>-é»˜è®¤éœ€è¦ä½¿ç”¨çš„å¯é€‰å‚æ•°</li>
<li><code>path</code>-è¦†ç›–route configsçš„è·¯å¾„è®¾ç½®</li>
</ul>
<p>å¯è§†åŒ–é€‰é¡¹:</p>
<ul>
<li><code>mode</code>-å®šä¹‰æ¸²æŸ“å’Œåˆ‡æ¢ä¹‹é—´çš„æ ·å¼:<ul>
<li><code>card</code>-ä½¿ç”¨iOSå’Œandroidæ ‡å‡†çš„åˆ‡æ¢æ–¹æ³•.é»˜è®¤å€¼</li>
<li><code>modal</code>-ä½¿screenä»åº•éƒ¨æ»‘åŠ¨æ˜¾ç¤º.ä»…ä»…åœ¨iOSä¸‹ä½¿ç”¨,Andoridä¸‹æ²¡æœ‰æ•ˆæœ</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>headerMode</code>-å®šåˆ¶headeræ¸²æŸ“çš„æ–¹æ³•</p>
<ul>
<li><code>float</code>-åˆ‡æ¢ç•Œé¢çš„æ—¶å€™,ç”¨åŠ¨ç”»æ•ˆæœåœ¨screençš„é¡¶éƒ¨æ¸²æŸ“header</li>
<li><code>screen</code>-æ¯ä¸€ä¸ªscreenéƒ½æœ‰ä¸€ä¸ªheaderé™„ç€åˆ°å¤´éƒ¨,åˆ‡æ¢çš„æ—¶å€™æœ‰æ·¡å…¥å’Œæ·¡å‡ºçš„æ•ˆæœ.andoridçš„åŸºæœ¬æ¨¡å¼</li>
<li><code>none</code>-æ²¡æœ‰headerçš„æ¸²æŸ“.</li>
</ul>
</li>
<li><p><code>cardStyle</code>-ä½¿ç”¨è¿™ä¸ªpropæ¥é‡å†™æˆ–è€…æ‰©å±•å•ä¸ªcardçš„é»˜è®¤style</p>
</li>
<li><code>onTransitionStart</code>-å½“cardå¼€å§‹åˆ‡æ¢åŠ¨ç”»çš„æ—¶å€™,è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨</li>
<li><code>onTransitionEnd</code>-å½“åˆ‡æ¢åŠ¨ç”»å®Œæˆçš„æ—¶å€™,è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨</li>
</ul>
<h2 id="Screen-Navigation-Options"><a href="#Screen-Navigation-Options" class="headerlink" title="Screen Navigation Options"></a>Screen Navigation Options</h2><p>é€šå¸¸åœ¨screenç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.ä¾‹å¦‚:<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">class ProfileScreen extends React.Component &#123;</div><div class="line"></div><div class="line">  static navigationOptions = &#123;</div><div class="line"></div><div class="line">    title: (&#123; <span class="keyword">state</span> &#125;) =&gt; `$&#123;<span class="keyword">state</span>.params.name&#125;'s Profile!`,</div><div class="line"></div><div class="line">    header: (&#123; <span class="keyword">state</span>, <span class="built_in">set</span>Params &#125;) =&gt; (&#123;</div><div class="line">      // Render a button <span class="keyword">on</span> the right side of the header</div><div class="line">      // When pressed switches the screen <span class="keyword">to</span> edit mode.</div><div class="line">      right: (</div><div class="line">        <span class="variable">&lt;Button</span></div><div class="line">          title=&#123;state.params.editing ? 'Done' : 'Edit'&#125;</div><div class="line">          onPress=&#123;() =&gt; <span class="built_in">set</span>Params(&#123;editing: <span class="keyword">state</span>.params.editing ? false : true&#125;)&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;;</div><div class="line">  ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰çš„<code>stackNavigator</code>çš„<code>navigationOptions</code>:</p>
<ul>
<li><code>title</code>-sceneçš„æ ‡é¢˜(å­—ç¬¦ä¸²)</li>
<li><code>header</code>-header barçš„é…ç½®å¯¹è±¡<ul>
<li><code>visible</code>-headerå¯è§†æ€§çš„åˆ‡æ¢.åªæœ‰å½“<code>headerMode</code>æ˜¯<code>screen</code>çš„æ—¶å€™æ‰å¯ä»¥å·¥ä½œ</li>
<li><code>title</code>-headerå¯ä»¥ä½¿ç”¨çš„å­—ç¬¦ä¸²æˆ–è€…Reactç»„ä»¶,é»˜è®¤æ˜¯sceneçš„<code>title</code></li>
<li><code>backTitle</code>-iOS backæŒ‰é’®çš„titleå­—ç¬¦ä¸²æˆ–è€…<code>null</code>åˆ°disableæ ‡ç­¾,é»˜è®¤è®¾å®šåˆ°sceneçš„<code>title</code>.</li>
<li><code>right</code>-æ˜¾ç¤ºåœ¨headerå³ä¾§çš„Reactç»„ä»¶</li>
<li><code>left</code>-åŒä¸Š,å·¦ä¾§</li>
<li><code>style</code>-headerçš„Styleå¯¹è±¡</li>
<li><code>titleStyle</code>-titleç»„å»ºçš„Styleå¯¹è±¡</li>
<li><code>tintColor</code>-headerçš„ç€è‰²</li>
</ul>
</li>
<li><code>cardStack</code>-card stackçš„é…ç½®å¯¹è±¡<ul>
<li><code>gesturesEnabled</code>-ä¸ç®¡ä½ æ˜¯ä¸æ˜¯ç”¨æ‰‹åŠ¿,åœ¨iOSä¸Šæ˜¯true,åœ¨androidé‡Œæ˜¯false.<h2 id="Navigator-Props"><a href="#Navigator-Props" class="headerlink" title="Navigator Props"></a>Navigator Props</h2>ç”±<code>StackNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥æ”¶ä¸¤ä¸ªprops:<br><code>screenProps</code>-å‘ä¸‹ä¼ é€’åˆ°å­screen,ä¾‹å¦‚:</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> SomeStack = StackNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;SomeStack</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><p>çœ‹çœ‹å®ä¾‹<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground/js/SimpleStack.js" target="_blank" rel="external">SimpleStack.js</a>å’Œ<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground/js/ModalStack.js" target="_blank" rel="external">ModalStack.js</a>,å¯ä»¥åœ¨æœ¬åœ°çš„<a href="https://github.com/react-community/react-navigation/tree/master/examples/NavigationPlayground" target="_blank" rel="external">NavigationPlayground</a>appä¸­è¿è¡Œ.</p>
<h1 id="TabNavigator"><a href="#TabNavigator" class="headerlink" title="TabNavigator"></a>TabNavigator</h1><p>é€šå¸¸å¾ˆå®¹æ˜“ä½¿ç”¨TabRouteræ¥åˆ›å»ºæœ‰å‡ ä¸ªtabsçš„screen.<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: &#123;</div><div class="line">      label: <span class="symbol">'Hom</span>e',</div><div class="line">      <span class="comment">// Note: By default the icon is only shown on iOS. Search the showIcon option below.</span></div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./chats-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Notification</span>s')&#125;</div><div class="line">        title=<span class="string">"Go to notifications"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNotificationsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    tabBar: &#123;</div><div class="line">      label: <span class="symbol">'Notification</span>s',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./notif-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.goBack()&#125;</div><div class="line">        title=<span class="string">"Go back home"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = <span class="type">StyleSheet</span>.create(&#123;</div><div class="line">  icon: &#123;</div><div class="line">    width: <span class="number">26</span>,</div><div class="line">    height: <span class="number">26</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const <span class="type">MyApp</span> = <span class="type">TabNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Notifications</span>: &#123;</div><div class="line">    screen: <span class="type">MyNotificationsScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;, &#123;</div><div class="line">  tabBarOptions: &#123;</div><div class="line">    activeTintColor: '#e91e63',</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="å®šä¹‰API-1"><a href="#å®šä¹‰API-1" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><p><code>TabNavigator(RouteConfigs,TabNavigator)</code></p>
<h2 id="RouteConfigs-1"><a href="#RouteConfigs-1" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>routeçš„é…ç½®å¯¹è±¡æ˜¯route nameåˆ°route configçš„æ˜ å°„(è¯‘è€…:è¿™æ‰æ˜¯é‡ç‚¹),é…ç½®å¯¹è±¡å‘Šè¯‰navigatorä»€ä¹ˆæ¥ä»£è¡¨route.</p>
<h2 id="TabNavigatorConfig"><a href="#TabNavigatorConfig" class="headerlink" title="TabNavigatorConfig"></a>TabNavigatorConfig</h2><ul>
<li><code>tabBarComponent</code>-ä½œä¸ºtab barçš„ç»„ä»¶.ä¾‹å¦‚,<code>TabView.TabBarBottom</code>(iosçš„é»˜è®¤é…ç½®),<code>TabView.TabBarTop</code>(androidçš„é»˜è®¤é…ç½®)</li>
<li><code>tabBarPosition</code>-tab barçš„ä½ç½®,å¯ä»¥æ˜¯<code>top</code>å’Œ<code>bottom</code></li>
<li><code>swipeEnabled</code>-æ˜¯å¦åœ¨tabä¹‹é—´æ»‘åŠ¨</li>
<li><code>animationEnabled</code>-å˜æ¢tabsçš„æ—¶å€™æ˜¯å¦å¼€å¯åŠ¨ç”»æ•ˆæœ</li>
<li><code>lazyLoad</code>-æ˜¯å¦åœ¨éœ€è¦çš„æ—¶å€™æ‰æƒ°æ€§åŠ è½½tabs,ä»£æ›¿é¢„æ¸²æŸ“</li>
<li><code>tabBarOption</code>-é…ç½®tab bar,çœ‹ä¸‹é¢<br>å‡ ä¸ªOptionså¯ä»¥ä¼ é€’åˆ°æ½œåœ¨çš„çš„router,ä¿®æ”¹å¯¼èˆªçš„é€»è¾‘</li>
<li><code>initialRouteName</code>-åˆå§‹åŒ–æ—¶åŠ è½½çš„tab route</li>
<li><code>order</code>-å®šä¹‰tabsé¡ºåºçš„routeNameçš„æ•°ç»„</li>
<li><code>paths</code>-æä¾›routeNameåˆ°pathé…ç½®çš„æ˜ å°„,é‡å†™routeConfigsé‡Œçš„pathsè®¾ç½®</li>
<li><code>backBehavior</code>-back buttonæ˜¯ä¸æ˜¯åº”è¯¥å¯¼è‡´tabåˆ‡æ¢åˆ°åˆå§‹çš„tabï¼Ÿå…¥å¦‚æœæ˜¯çš„è¯,è®¾å®š<code>initialRoute</code>,å¦åˆ™å°±æ˜¯<code>none</code>.é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.</li>
</ul>
<p><code>TabBarTop</code>çš„<code>tabBarOptions</code>è®¾ç½®(androidé»˜è®¤çš„tab bar)</p>
<ul>
<li><code>activeTintColor</code>-æ¿€æ´»tabçš„æ ‡ç­¾å’Œiconçš„é¢œè‰²</li>
<li><code>inactiveTintColor</code>-æœªæ¿€æ´»tabçš„æ ‡ç­¾å’Œiconçš„é¢œè‰²</li>
<li><code>showIcon</code>-æ˜¯å¦åœ¨tabä¸­æ˜¾ç¤ºicon,é»˜è®¤æ˜¯false</li>
<li><code>showLabel</code>-æ˜¯å¦åœ¨tabæ˜¾ç¤ºlabel,é»˜è®¤æ˜¯true</li>
<li><code>upperCaseLabel</code>-tabçš„labelæ˜¯å¦æ˜¯å¤§å†™,é»˜è®¤æ˜¯true</li>
<li><code>pressColor</code>-materialæ¶Ÿæ¼ªæ•ˆæœçš„é¢œè‰²(Android&gt;=5.0)</li>
<li><code>pressOpacity</code>-æŒ‰ä¸‹tabçš„é€æ˜åº¦å˜åŒ–(iOSå’ŒAndroid&lt;5.0)</li>
<li><code>scrollEnabled</code>-æ˜¯å¦æ˜¯æ»‘åŠ¨å¼tabs.</li>
<li><code>tabStyle</code>-tabçš„æ ·å¼é…ç½®å¯¹è±¡</li>
<li><code>indicatorStyle</code>-tabæŒ‡ç¤ºå™¨çš„æ ·å¼å¯¹è±¡(tabåº•éƒ¨çš„åˆ’çº¿)</li>
<li><code>labelStyle</code>-tab labelçš„æ ·å¼å¯¹è±¡</li>
<li><code>style</code>-tab barçš„æ ·å¼å¯¹è±¡</li>
</ul>
<p>å®ä¾‹:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">tabBarOptions</span>: &#123;</div><div class="line">  <span class="attribute">labelStyle</span>: &#123;</div><div class="line">    fontSize: <span class="number">12</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="selector-tag">style</span>: &#123;</div><div class="line">    <span class="attribute">backgroundColor</span>: <span class="string">'blue'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Screenå¯¼èˆªçš„é€‰é¡¹"><a href="#Screenå¯¼èˆªçš„é€‰é¡¹" class="headerlink" title="Screenå¯¼èˆªçš„é€‰é¡¹"></a>Screenå¯¼èˆªçš„é€‰é¡¹</h2><p>é€šå¸¸åœ¨screenç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.ä¾‹å¦‚:<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">class ProfileScreen extends React.Component &#123;</div><div class="line"></div><div class="line"> static navigationOptions = &#123;</div><div class="line"></div><div class="line">   title: (&#123; <span class="keyword">state</span> &#125;) =&gt; `$&#123;<span class="keyword">state</span>.params.name&#125;'s Profile!`,</div><div class="line"></div><div class="line">   tabBar: (&#123; <span class="keyword">state</span>, <span class="built_in">set</span>Params &#125;) =&gt; (&#123;</div><div class="line">     icon: (</div><div class="line">       <span class="variable">&lt;Image src=&#123;require('./my-icon.png')&#125; /&gt;</span></div><div class="line">     ),</div><div class="line">   &#125;),</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰<code>TabNavigator</code>çš„<code>navigationOption</code>:</p>
<ul>
<li><code>title</code>-sceneçš„title(å­—ç¬¦ä¸²)</li>
<li><code>tabBar</code>-tab barçš„configå¯¹è±¡:<ul>
<li><code>visible</code>-tab barçš„å¯è§æ€§çš„åˆ‡æ¢</li>
<li><code>icon</code>-Reactç»„ä»¶æˆ–è€…å‡½æ•°ç»™å‡º<code>{focused:boolean,tintColor:string}</code>,è¿”å›ä¸€ä¸ªReactç»„ä»¶,æ˜¾ç¤ºåœ¨tab bar</li>
<li><code>label</code>-æ˜¾ç¤ºåœ¨tab barä¸­çš„tabçš„åå­—.å¦‚æœå®šä¹‰ä¸ºundefined,sceneçš„<code>title</code>ä¼šè¢«ä½¿ç”¨.å¦‚æœè¦éšè—,çœ‹å‰é¢éƒ¨åˆ†çš„<code>tabBarOption.showLabel</code>.<h2 id="Navigator-Props-1"><a href="#Navigator-Props-1" class="headerlink" title="Navigator Props"></a>Navigator Props</h2>ç”±<code>TabNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥æ”¶ä¸‹é¢çš„props:</li>
</ul>
</li>
<li><code>screenProps</code>-å‘ä¸‹ä¼ é€’é¢å¤–çš„optionsç»™å­screen,ä¾‹å¦‚:</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> TabNav = TabNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;TabNav</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h1 id="æŠ½å±‰å¼å¯¼èˆª"><a href="#æŠ½å±‰å¼å¯¼èˆª" class="headerlink" title="æŠ½å±‰å¼å¯¼èˆª"></a>æŠ½å±‰å¼å¯¼èˆª</h1><p>ç”¨æ¥æ„å»ºæŠ½å±‰å¼å¯¼èˆª<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    drawer: () =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Hom</span>e',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./chats-icon.png')&#125;</div><div class="line">          style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="symbol">'Notification</span>s')&#125;</div><div class="line">        title=<span class="string">"Go to notifications"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNotificationsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    drawer: () =&gt; (&#123;</div><div class="line">      label: <span class="symbol">'Notification</span>s',</div><div class="line">      icon: (&#123; tintColor &#125;) =&gt; (</div><div class="line">        &lt;<span class="type">Image</span></div><div class="line">          source=&#123;require('./notif-icon.png')&#125;</div><div class="line">          style=&#123;[styles.tabIcon, &#123;tintColor: tintColor&#125;]&#125;</div><div class="line">        /&gt;</div><div class="line">      ),</div><div class="line">    &#125;),</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">Button</span></div><div class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.goBack()&#125;</div><div class="line">        title=<span class="string">"Go back home"</span></div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = <span class="type">StyleSheet</span>.create(&#123;</div><div class="line">  icon: &#123;</div><div class="line">    width: <span class="number">24</span>,</div><div class="line">    height: <span class="number">24</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">const <span class="type">MyApp</span> = <span class="type">DrawerNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123;</div><div class="line">    screen: <span class="type">MyHomeScreen</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="type">Notifications</span>: &#123;</div><div class="line">    screen: <span class="type">MyNotificationsScreen</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ‰“å¼€æŠ½å±‰æˆ–è€…å…³é—­æŠ½å±‰,åˆ†åˆ«å¯¼èˆªåˆ°<code>DrawerOpen</code>å’Œ<code>Drawerclose</code>.<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerOpen'</span>); <span class="comment">// open drawer</span></div><div class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerClose'</span>); <span class="comment">// close drawer</span></div></pre></td></tr></table></figure></p>
<h2 id="å®šä¹‰API-2"><a href="#å®šä¹‰API-2" class="headerlink" title="å®šä¹‰API"></a>å®šä¹‰API</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">DrawerNavigator</span><span class="params">(RouteConfigs, DrawerNavigatorConfig)</span></span></div></pre></td></tr></table></figure>
<h2 id="RouteConfigs-2"><a href="#RouteConfigs-2" class="headerlink" title="RouteConfigs"></a>RouteConfigs</h2><p>å‚çœ‹å‰é¢çš„å†…å®¹</p>
<h2 id="DrawerNavigatonConfig"><a href="#DrawerNavigatonConfig" class="headerlink" title="DrawerNavigatonConfig"></a>DrawerNavigatonConfig</h2><ul>
<li><code>drawerWidth</code>-æŠ½å±‰çš„å®½åº¦</li>
<li><code>drawerPosition</code>-é€‰é¡¹æ˜¯<code>left</code>å’Œ<code>right</code>.é»˜è®¤æ˜¯<code>left</code>.</li>
<li><code>contentComponent</code>-ç”¨æ¥æ¸²æŸ“æŠ½å±‰å†…å®¹çš„ç»„ä»¶,ä¾‹å¦‚,navigation item.æ¥æ”¶<code>navigation</code>prop.é»˜è®¤æ˜¯<code>DrawerView.Items</code>.äº†è§£æ›´å¤šå†…å®¹çœ‹ä¸‹é¢å†…å®¹.</li>
<li><code>contentOptions</code>-é…ç½®drawerçš„å†…å®¹,çœ‹ä¸‹é¢å†…å®¹<br>å‡ ä¸ªé€‰é¡¹ä¼ é€’ç»™æ½œåœ¨çš„router,ç”¨æ¥ä¿®æ”¹navigationçš„é€»è¾‘:</li>
<li><code>initialRouteName</code>-åˆå§‹åŒ–routeçš„routeName</li>
<li><code>order</code>-å®šä¹‰drawer itemé¡ºåºçš„routeNameæ•°ç»„</li>
<li><code>path</code>-æä¾›ä¸€ä¸ªrouteNameåˆ°path configçš„æ˜ å°„,é‡å†™æ‰routeConfigsä¸­çš„pathé…ç½®</li>
<li><code>backBehavior</code>-backæŒ‰é’®ä¸€å®šè¦è¿”å›åˆ°åˆå§‹åŒ–çš„routeå—ï¼Ÿå¦‚æœæ˜¯çš„è¯,è®¾ç½®åˆ°<code>initialRoute</code>,å¦åˆ™å°±ç”¨<code>none</code>.é»˜è®¤åˆ°<code>initialRoute</code>çš„è¡Œä¸º.<h2 id="æä¾›å®šåˆ¶åŒ–çš„contentComponent"><a href="#æä¾›å®šåˆ¶åŒ–çš„contentComponent" class="headerlink" title="æä¾›å®šåˆ¶åŒ–çš„contentComponent"></a>æä¾›å®šåˆ¶åŒ–çš„<em>contentComponent</em></h2>å¯ä»¥ä½¿ç”¨<code>react-navigation</code>é‡å†™é»˜è®¤çš„ç»„ä»¶.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> CustomDrawerContentComponent = <span class="function">(<span class="params">props</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;style.container&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">DrawerView.Items</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">);</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  container : &#123;</div><div class="line">    flex : 1,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>DrawerView.Item</code>çš„<code>contentOptions</code>é…ç½®</p>
<ul>
<li><code>activeTintColor</code>-æ¿€æ´»çš„æ ‡ç­¾çš„labelå’Œiconçš„é¢œè‰²</li>
<li><code>activeBackgroundColor</code>-æ¿€æ´»çš„æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</li>
<li><code>inactiveTintColor</code>-æœªæ¿€æ´»çš„æ ‡ç­¾çš„labelå’Œiconçš„é¢œè‰²</li>
<li><code>inactiveBackgroundColor</code>-æœªæ¿€æ´»çš„æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</li>
<li><code>style</code>-å†…å®¹éƒ¨åˆ†çš„æ ·å¼å¯¹è±¡</li>
</ul>
<p>ç¤ºä¾‹:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="selector-tag">contentOptions</span>: &#123;</div><div class="line">  <span class="attribute">activeTintColor</span>: <span class="string">'#e91e63'</span>,</div><div class="line">  style: &#123;</div><div class="line">    marginVertical: <span class="number">0</span>,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Screenå¯¼èˆªçš„é€‰é¡¹-1"><a href="#Screenå¯¼èˆªçš„é€‰é¡¹-1" class="headerlink" title="Screenå¯¼èˆªçš„é€‰é¡¹"></a>Screenå¯¼èˆªçš„é€‰é¡¹</h2><p>é€šå¸¸åœ¨ç»„ä»¶ä¸­å®šä¹‰é™æ€çš„<code>navigationOptions</code>.<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line"> static navigationOptions = &#123;</div><div class="line"></div><div class="line">   title: (&#123; state &#125;) =&gt; `$&#123;state.params.name&#125;<span class="symbol">'s</span> <span class="type">Profile</span>!`,</div><div class="line"></div><div class="line">   drawer: &#123;</div><div class="line">     icon: (</div><div class="line">       &lt;<span class="type">Image</span> src=&#123;require('./my-icon.png')&#125; /&gt;</div><div class="line">     ),</div><div class="line">   &#125;,</div><div class="line"> &#125;;</div><div class="line"> ...</div></pre></td></tr></table></figure></p>
<p>æ‰€æœ‰çš„<code>DrawerNavigation</code> <code>navigationOption</code>é…ç½®é¡¹</p>
<ul>
<li><code>title</code>-sceneçš„æ ‡é¢˜</li>
<li><code>drawer</code>-drawerçš„é…ç½®å¯¹è±¡<ul>
<li><code>label</code>-å­—ç¬¦ä¸²,Reactç»„ä»¶æˆ–è€…å‡½æ•°è¢«è®¾å®š<code>{fcoused:boolean,tinColor:string}</code>è¿”å›ä¸€ä¸ªReactç»„ä»¶,æ˜¾ç¤ºåœ¨drawerçš„è¾¹æ ä¸Š.å½“labelå®šä¹‰ä¸ºundefinedæ—¶,sceneçš„``titleè¢«ä½¿ç”¨.</li>
<li><code>icon</code>-Reactç»„ä»¶æˆ–è€…å‡½æ•°è¢«è®¾å®šä¸º<code>{fcoused:boolean,tintColor:string}</code>è¿”å›ä¸€ä¸ªReactå…ƒç´ ,æ˜¾ç¤ºåœ¨drawerçš„è¾¹æ ä¸Š.</li>
</ul>
</li>
</ul>
<h2 id="Navigator-çš„Props"><a href="#Navigator-çš„Props" class="headerlink" title="Navigator çš„Props"></a>Navigator çš„Props</h2><p>ç”±<code>DrawerNavigator(...)</code>åˆ›å»ºçš„navigatorç»„ä»¶æ¥å—ä¸‹é¢çš„props:</p>
<ul>
<li><code>screenProps</code>-å‘ä¸‹ä¼ é€’é¢å¤–çš„optionsåˆ°å­screen,ä¾‹å¦‚:</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> DrawerNav = DrawerNavigator(&#123;</div><div class="line">  <span class="comment">// config</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;DrawerNav</div><div class="line">  screenProps=&#123;<span class="comment">/* this prop will get passed to the screen components as this.props.screenProps */</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h1 id="Screen-Navigation-Prop"><a href="#Screen-Navigation-Prop" class="headerlink" title="Screen Navigation Prop"></a>Screen Navigation Prop</h1><p>appä¸­çš„æ¯ä¸ªscreenéƒ½æ¥æ”¶navigation prop åŒ…å«ä¸‹é¢çš„å†…å®¹:</p>
<ul>
<li><code>navigate</code>-(helper)é“¾æ¥çš„å…¶ä»–çš„screens</li>
<li><code>state</code>-screençš„å½“å‰stateå’Œroutes</li>
<li><code>setParam</code>-(helper)æ”¹å˜routeçš„å‚æ•°</li>
<li><code>goBack</code>-(helper)å…³é—­æ¿€æ´»çš„screenå¹¶ä¸”è¿”å›</li>
<li><code>dispatch</code>-å‘é€ä¸€ä¸ªactionåˆ°router</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Navigators&quot;&gt;&lt;a href=&quot;#Navigators&quot; class=&quot;headerlink&quot; title=&quot;Navigators&quot;&gt;&lt;/a&gt;Navigators&lt;/h1&gt;&lt;p&gt;Navigatorså…è®¸ä½ å®šä¹‰ä½ çš„å¯¼èˆªç»“æ„.Navigatorsä¹Ÿå¯ä»¥æ¸²æŸ“æ™®
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React-native" scheme="http://yoursite.com/tags/React-native/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigationå¯¼èˆªç³»ç»Ÿ(2)</title>
    <link href="http://yoursite.com/2017/03/28/%E7%BF%BB%E8%AF%91-React-navigation%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F-2/"/>
    <id>http://yoursite.com/2017/03/28/ç¿»è¯‘-React-navigationå¯¼èˆªç³»ç»Ÿ-2/</id>
    <published>2017-03-28T00:25:36.000Z</published>
    <updated>2017-03-27T23:45:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬äºŒéƒ¨åˆ†</p>
<h1 id="å·¢å¼å¯¼èˆª"><a href="#å·¢å¼å¯¼èˆª" class="headerlink" title="å·¢å¼å¯¼èˆª"></a>å·¢å¼å¯¼èˆª</h1><p>åœ¨ç§»åŠ¨åº”ç”¨ä¸­ç»„åˆå„ç§å½¢å¼çš„å¯¼èˆªæ˜¯éå¸¸æ™®éçš„.React Navigationä¸­çš„routerå’Œnavigatorsæ˜¯ç»„åˆå¼çš„,å¦‚æ­¤ä»¥æ¥å¯ä»¥å…è®¸æˆ‘ä»¬å®šä¹‰éå¸¸å¤æ‚çš„å¯¼èˆªç³»ç»Ÿ.</p>
<h2 id="Tab-Navigatorçš„ä»‹ç»"><a href="#Tab-Navigatorçš„ä»‹ç»" class="headerlink" title="Tab Navigatorçš„ä»‹ç»"></a>Tab Navigatorçš„ä»‹ç»</h2><p> æˆ‘ä»¬åœ¨<code>App.js</code>ä¸­åˆ›å»º<code>TabNavigator</code>ï¼š<br>  <figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">   <span class="class"><span class="keyword">class</span> <span class="title">RecentChatsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;<span class="type">Text</span>&gt;<span class="type">List</span> of recent chats&lt;/<span class="type">Text</span>&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllContactsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;<span class="type">Text</span>&gt;<span class="type">List</span> of all contacts&lt;/<span class="type">Text</span>&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const <span class="type">MainScreenNavigator</span> = <span class="type">TabNavigator</span>(&#123;</div><div class="line">  <span class="type">Recent</span>: &#123; screen: <span class="type">RecentChatsScreen</span> &#125;,</div><div class="line">  <span class="type">All</span>: &#123; screen: <span class="type">AllContactsScreen</span> &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p> å¦‚æœ<code>MainScreenNavigation</code>ä½œä¸ºé¡¶å±‚çš„å¯¼èˆªç»„ä»¶æ¥æ¸²æŸ“,çœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„:<br> <img src="https://ww1.sinaimg.cn/large/006tNbRwly1fe26v8brpug307i0dcjrv.gif" alt=""> </p>
<h2 id="åœ¨å±å¹•ä¸­æ„é€ ä¸€ä¸ªå·¢å¼å¯¼èˆªå™¨"><a href="#åœ¨å±å¹•ä¸­æ„é€ ä¸€ä¸ªå·¢å¼å¯¼èˆªå™¨" class="headerlink" title="åœ¨å±å¹•ä¸­æ„é€ ä¸€ä¸ªå·¢å¼å¯¼èˆªå™¨"></a>åœ¨å±å¹•ä¸­æ„é€ ä¸€ä¸ªå·¢å¼å¯¼èˆªå™¨</h2><p>æˆ‘ä»¬æƒ³è®©è¿™äº›tabsåœ¨appçš„ç¬¬ä¸€å±æ˜¾ç¤º,ä½†æ˜¯å †æ ˆä¸­çš„æ–°çš„screenä¼šè¦†ç›–tabs.<br>åœ¨å‰ä¸€æ­¥éª¤è®¾ç½®çš„<code>StackNavigator</code>ä¸­æ·»åŠ tabsä½œä¸ºé¡¶çº§å¯¼èˆª<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="symbol">  Home:</span> &#123; <span class="keyword">screen: </span>MainScreenNavigator &#125;,</div><div class="line"><span class="symbol">  Chat:</span> &#123; <span class="keyword">screen: </span>ChatScreen &#125;,</div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>å› ä¸º<code>MainScreenNavigator</code>ä½œä¸ºscreen,å¯ä»¥ä¼ é€’<code>navigationOtions</code>å‚æ•°:<br><figure class="highlight hsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> MainScreenNavigator.navigationOptions = &#123;</div><div class="line">  <span class="keyword">title</span>: <span class="string">'My Chats'</span>,</div><div class="line">&#125;<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>åœ¨æ¯ä¸€ä¸ªtabsä¸­æ·»åŠ é“¾æ¥åˆ°chatçš„æŒ‰é’®:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> &lt;Button</div><div class="line">  onPress=&#123;() =&gt; this<span class="selector-class">.props</span><span class="selector-class">.navigation</span><span class="selector-class">.navigate</span>(<span class="string">'Chat'</span>, &#123; user: <span class="string">'Lucy'</span> &#125;)&#125;</div><div class="line">  title=<span class="string">"Chat with Lucy"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬åœ¨æ¯ä¸ªå¯¼èˆªå™¨å½¼æ­¤ä¹‹é—´åšäº†é…ç½®,å¯ä»¥åœ¨å¯¼èˆªç•Œé¢ä¹‹é—´åˆ‡æ¢.</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fe2750jl3og307i0dc0x4.gif" alt=""></p>
<h1 id="é…ç½®å¤´éƒ¨"><a href="#é…ç½®å¤´éƒ¨" class="headerlink" title="é…ç½®å¤´éƒ¨"></a>é…ç½®å¤´éƒ¨</h1><p>åœ¨å‰é¢çš„ä¾‹å­ä¸­,æˆ‘ä»¬ç”¨StactNavigatoråˆ›å»ºäº†å‡ ä¸ªscreen.<br>å½“æˆ‘ä»¬å¯¼èˆªåˆ°chat screen,æˆ‘ä»¬é€šè¿‡navigate å‡½æ•°ä¼ é€’ç‰¹å®šçš„å‚æ•°åˆ°æ–°çš„å¯¼èˆªç•Œé¢.ä¾‹å¦‚,æˆ‘ä»¬æƒ³ç»™chat screenæä¾›ä¸€ä¸ªäººå:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'Chat'</span>, &#123; <span class="string">user:</span>  <span class="string">'Lucy'</span> &#125;);</div></pre></td></tr></table></figure></p>
<p><code>user</code>å‚æ•°å¯ä»¥åœ¨chat screenä¸­è·å–åˆ°:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ChatScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    const &#123; params &#125; = <span class="keyword">this</span>.props.navigation.state;</div><div class="line">    <span class="keyword">return</span> &lt;<span class="type">Text</span>&gt;<span class="type">Chat</span> <span class="keyword">with</span> &#123;params.user&#125;&lt;/<span class="type">Text</span>&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="è®¾å®šå¤´éƒ¨æ ‡é¢˜"><a href="#è®¾å®šå¤´éƒ¨æ ‡é¢˜" class="headerlink" title="è®¾å®šå¤´éƒ¨æ ‡é¢˜"></a>è®¾å®šå¤´éƒ¨æ ‡é¢˜</h2><p>æ¥ç€æ¥,å¯ä»¥åœ¨screen å‚æ•°ä¸­é…ç½®å¤´éƒ¨çš„æ ‡é¢˜<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ChatScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    <span class="comment">// // Title may be a simple string:</span></div><div class="line">    <span class="comment">// title: 'Hello',</span></div><div class="line">     </div><div class="line">    <span class="comment">// Or the title string may be a function of the </span></div><div class="line">    navigation prop:å¯ä»¥æ˜¯propçš„å‡½æ•°è§£æ</div><div class="line">    title: (&#123; state &#125;) =&gt; `<span class="type">Chat</span> <span class="keyword">with</span> $&#123;state.params.user&#125;`</div><div class="line">  &#125;;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe27gzgg40j30h90uojra.jpg" alt=""></p>
<h2 id="æ·»åŠ å³ä¾§çš„æŒ‰é’®"><a href="#æ·»åŠ å³ä¾§çš„æŒ‰é’®" class="headerlink" title="æ·»åŠ å³ä¾§çš„æŒ‰é’®"></a>æ·»åŠ å³ä¾§çš„æŒ‰é’®</h2><p>å¯ä»¥åœ¨optionä¸­æ·»åŠ å®šåˆ¶çš„å³ä¾§æŒ‰é’®<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">static navigationOptions = &#123;</div><div class="line">  <span class="selector-tag">header</span>: &#123;</div><div class="line">    <span class="attribute">right</span>: &lt;Button title=<span class="string">"Info"</span> /&gt;,</div><div class="line">  &#125;,</div><div class="line">  ...</div></pre></td></tr></table></figure></p>
<p><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fe27iwdrcmj30ha0uowee.jpg" alt=""></p>
<p>å’Œ<code>title</code>ä¸€æ ·,<code>header</code>optionå¯ä»¥å®šä¹‰ä¸ºpropçš„ä¸€ä¸ªå‡½æ•°.è®©æˆ‘ä»¬æ¥åŸºäºå¯¼èˆªå‚æ•°æ¸²æŸ“ä¸€ä¸ªä¸åŒçš„æŒ‰é’®,è®¾å®šä¸ºç‚¹å‡»æ—¶è°ƒç”¨<code>navigation.setParams</code>:</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">static navigationOptions = &#123;</div><div class="line">  title: (&#123; <span class="keyword">state</span> &#125;) =&gt; &#123;</div><div class="line">    if (<span class="keyword">state</span>.params.mode === 'info') &#123;</div><div class="line">      return `$&#123;<span class="keyword">state</span>.params.<span class="keyword">user</span>&#125;'s Contact Info`;</div><div class="line">    &#125;</div><div class="line">    return `Chat with $&#123;<span class="keyword">state</span>.params.<span class="keyword">user</span>&#125;`;</div><div class="line">  &#125;,</div><div class="line">  header: (&#123; <span class="keyword">state</span>, <span class="built_in">set</span>Params &#125;) =&gt; &#123;</div><div class="line">    // The navigation prop has functions like <span class="built_in">set</span>Params, goBack, and navigate.</div><div class="line">    let right = (</div><div class="line">      <span class="variable">&lt;Button</span></div><div class="line">        title=&#123;`$&#123;state.params.user&#125;'s info`&#125;</div><div class="line">        onPress=&#123;() =&gt; <span class="built_in">set</span>Params(&#123; mode: 'info' &#125;)&#125;</div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">    if (<span class="keyword">state</span>.params.mode === 'info') &#123;</div><div class="line">      right = (</div><div class="line">        <span class="variable">&lt;Button</span></div><div class="line">          title="Done"</div><div class="line">          onPress=&#123;() =&gt; <span class="built_in">set</span>Params(&#123; mode: '<span class="keyword">none</span>' &#125;)&#125;</div><div class="line">        /&gt;        </div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">    return &#123; right &#125;;</div><div class="line">  &#125;,</div><div class="line">  ...</div></pre></td></tr></table></figure>
<p>ç°åœ¨å¤´éƒ¨å¯ä»¥å’Œscreençš„è·¯ç”±stateè¿›è¡Œäº¤äº’äº†.<br><img src="https://ww1.sinaimg.cn/large/006tNbRwly1fe27os9kgrg307g0dc752.gif" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬äºŒéƒ¨åˆ†&lt;/p&gt;
&lt;h1 id=&quot;å·¢å¼å¯¼èˆª&quot;&gt;&lt;a href=&quot;#å·¢å¼å¯¼èˆª&quot; class=&quot;headerlink&quot; title=&quot;å·¢å¼å¯¼èˆª&quot;&gt;&lt;/a&gt;å·¢å¼å¯¼èˆª&lt;/h1&gt;&lt;p&gt;åœ¨ç§»åŠ¨åº”ç”¨ä¸­ç»„åˆå„ç§å½¢å¼çš„å¯¼èˆªæ˜¯éå¸¸æ™®éçš„.React Navigationä¸­çš„routerå’Œnav
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React" scheme="http://yoursite.com/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Airbnb React/JSX ç¼–ç è§„èŒƒ</title>
    <link href="http://yoursite.com/2017/03/28/Airbnb-React-JSX-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"/>
    <id>http://yoursite.com/2017/03/28/Airbnb-React-JSX-ç¼–ç è§„èŒƒ/</id>
    <published>2017-03-28T00:13:55.000Z</published>
    <updated>2017-03-27T16:15:25.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Airbnb-React-JSX-ç¼–ç è§„èŒƒ"><a href="#Airbnb-React-JSX-ç¼–ç è§„èŒƒ" class="headerlink" title="Airbnb React/JSX ç¼–ç è§„èŒƒ"></a>Airbnb React/JSX ç¼–ç è§„èŒƒ</h1><p><em>ç®—æ˜¯æœ€åˆç†çš„React/JSXç¼–ç è§„èŒƒä¹‹ä¸€äº†</em></p>
<h2 id="å†…å®¹ç›®å½•"><a href="#å†…å®¹ç›®å½•" class="headerlink" title="å†…å®¹ç›®å½•"></a>å†…å®¹ç›®å½•</h2><ol>
<li><a href="#basic-rules-åŸºæœ¬è§„èŒƒ">åŸºæœ¬è§„èŒƒ</a></li>
<li><a href="#åˆ›å»ºæ¨¡å—">Class vs React.createClass vs stateless</a></li>
<li><a href="#mixins">Mixins</a></li>
<li><a href="#naming-å‘½å">å‘½å</a></li>
<li><a href="#declaration-å£°æ˜æ¨¡å—">å£°æ˜æ¨¡å—</a></li>
<li><a href="#alignment-ä»£ç å¯¹é½">ä»£ç å¯¹é½</a></li>
<li><a href="#quotes-å•å¼•å·è¿˜æ˜¯åŒå¼•å·">å•å¼•å·è¿˜æ˜¯åŒå¼•å·</a></li>
<li><a href="#spacing-ç©ºæ ¼">ç©ºæ ¼</a></li>
<li><a href="#props-å±æ€§">å±æ€§</a></li>
<li><a href="#refs">Refså¼•ç”¨</a></li>
<li><a href="#parentheses-æ‹¬å·">æ‹¬å·</a></li>
<li><a href="#tags-æ ‡ç­¾">æ ‡ç­¾</a></li>
<li><a href="#methods-å‡½æ•°">å‡½æ•°/æ–¹æ³•</a></li>
<li><a href="#ordering-react-æ¨¡å—ç”Ÿå‘½å‘¨æœŸ">æ¨¡å—ç”Ÿå‘½å‘¨æœŸ</a></li>
<li><a href="#ismounted">isMounted</a></li>
</ol>
<h2 id="Basic-Rules-åŸºæœ¬è§„èŒƒ"><a href="#Basic-Rules-åŸºæœ¬è§„èŒƒ" class="headerlink" title="Basic Rules åŸºæœ¬è§„èŒƒ"></a>Basic Rules åŸºæœ¬è§„èŒƒ</h2><ul>
<li>æ¯ä¸ªæ–‡ä»¶åªå†™ä¸€ä¸ªæ¨¡å—.<ul>
<li>ä½†æ˜¯å¤šä¸ª<a href="https://facebook.github.io/react/docs/reusable-components.html#stateless-functions" target="_blank" rel="external">æ— çŠ¶æ€æ¨¡å—</a>å¯ä»¥æ”¾åœ¨å•ä¸ªæ–‡ä»¶ä¸­. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/no-multi-comp.md#ignorestateless" target="_blank" rel="external"><code>react/no-multi-comp</code></a>.</li>
</ul>
</li>
<li>æ¨èä½¿ç”¨JSXè¯­æ³•.</li>
<li>ä¸è¦ä½¿ç”¨ <code>React.createElement</code>ï¼Œé™¤éä»ä¸€ä¸ªéJSXçš„æ–‡ä»¶ä¸­åˆå§‹åŒ–ä½ çš„app.</li>
</ul>
<h2 id="åˆ›å»ºæ¨¡å—"><a href="#åˆ›å»ºæ¨¡å—" class="headerlink" title="åˆ›å»ºæ¨¡å—"></a>åˆ›å»ºæ¨¡å—</h2><p>   Class vs React.createClass vs stateless  </p>
<ul>
<li><p>å¦‚æœä½ çš„æ¨¡å—æœ‰å†…éƒ¨çŠ¶æ€æˆ–è€…æ˜¯<code>refs</code>, æ¨èä½¿ç”¨ <code>class extends React.Component</code> è€Œä¸æ˜¯ <code>React.createClass</code>.<br>eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/prefer-es6-class.md" target="_blank" rel="external"><code>react/prefer-es6-class</code></a> <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/prefer-stateless-function.md" target="_blank" rel="external"><code>react/prefer-stateless-function</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> Listing = React.createClass(&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;&#123;this.state.hello&#125;&lt;/div&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Listing</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;&#123;this.state.hello&#125;&lt;/div&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„æ¨¡å—æ²¡æœ‰çŠ¶æ€æˆ–æ˜¯æ²¡æœ‰å¼•ç”¨<code>refs</code>ï¼Œ æ¨èä½¿ç”¨æ™®é€šå‡½æ•°ï¼ˆéç®­å¤´å‡½æ•°ï¼‰è€Œä¸æ˜¯ç±»:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Listing</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;&#123;this.props.hello&#125;&lt;/div&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bad (relying on function name inference is discouraged)</span></div><div class="line"><span class="keyword">const</span> Listing = <span class="function">(<span class="params">&#123; hello &#125;</span>) =&gt;</span> (</div><div class="line">  &lt;div&gt;&#123;hello&#125;&lt;/div&gt;</div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Listing</span>(<span class="params">&#123; hello &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &lt;div&gt;&#123;hello&#125;&lt;/div&gt;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Mixins"><a href="#Mixins" class="headerlink" title="Mixins"></a>Mixins</h2><ul>
<li><p><a href="https://facebook.github.io/react/blog/2016/07/13/mixins-considered-harmful.html" target="_blank" rel="external">ä¸è¦ä½¿ç”¨ mixins</a>.</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? Mixins ä¼šå¢åŠ éšå¼çš„ä¾èµ–ï¼Œå¯¼è‡´å‘½åå†²çªï¼Œå¹¶ä¸”ä¼šä»¥é›ªçƒå¼å¢åŠ å¤æ‚åº¦ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹Mixinså¯ä»¥è¢«æ›´å¥½çš„æ–¹æ³•æ›¿ä»£ï¼Œå¦‚ï¼šç»„ä»¶åŒ–ï¼Œé«˜é˜¶ç»„ä»¶ï¼Œå·¥å…·æ¨¡å—ç­‰ã€‚</p>
</blockquote>
</li>
</ul>
<h2 id="Naming-å‘½å"><a href="#Naming-å‘½å" class="headerlink" title="Naming å‘½å"></a>Naming å‘½å</h2><ul>
<li><strong>æ‰©å±•å</strong>: Reactæ¨¡å—ä½¿ç”¨ <code>.jsx</code> æ‰©å±•å.</li>
<li><strong>æ–‡ä»¶å</strong>: æ–‡ä»¶åä½¿ç”¨å¸•æ–¯å¡å‘½å. å¦‚, <code>ReservationCard.jsx</code>.</li>
<li><p><strong>å¼•ç”¨å‘½å</strong>: Reactæ¨¡å—åä½¿ç”¨å¸•æ–¯å¡å‘½åï¼Œå®ä¾‹ä½¿ç”¨éª†é©¼å¼å‘½å. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-pascal-case.md" target="_blank" rel="external"><code>react/jsx-pascal-case</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">import</span> reservationCard <span class="keyword">from</span> <span class="string">'./ReservationCard'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> ReservationCard <span class="keyword">from</span> <span class="string">'./ReservationCard'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> ReservationItem = &lt;ReservationCard /&gt;;</div><div class="line"></div><div class="line">// good</div><div class="line">const reservationItem = &lt;ReservationCard /&gt;;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>æ¨¡å—å‘½å</strong>: æ¨¡å—ä½¿ç”¨å½“å‰æ–‡ä»¶åä¸€æ ·çš„åç§°. æ¯”å¦‚ <code>ReservationCard.jsx</code> åº”è¯¥åŒ…å«åä¸º <code>ReservationCard</code>çš„æ¨¡å—. ä½†æ˜¯ï¼Œå¦‚æœæ•´ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä½¿ç”¨ <code>index.js</code>ä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œç„¶åç›´æ¥ä½¿ç”¨ <code>index.js</code> æˆ–è€…æ–‡ä»¶å¤¹åä½œä¸ºæ¨¡å—çš„åç§°:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer/Footer'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer/index'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>é«˜é˜¶æ¨¡å—å‘½å</strong>: å¯¹äºç”Ÿæˆä¸€ä¸ªæ–°çš„æ¨¡å—ï¼Œå…¶ä¸­çš„æ¨¡å—å <code>displayName</code> åº”è¯¥ä¸ºé«˜é˜¶æ¨¡å—åå’Œä¼ å…¥æ¨¡å—åçš„ç»„åˆ. ä¾‹å¦‚, é«˜é˜¶æ¨¡å— <code>withFoo()</code>, å½“ä¼ å…¥ä¸€ä¸ª <code>Bar</code> æ¨¡å—çš„æ—¶å€™ï¼Œ ç”Ÿæˆçš„æ¨¡å—å <code>displayName</code> åº”è¯¥ä¸º <code>withFoo(Bar)</code>.</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆï¼Ÿä¸€ä¸ªæ¨¡å—çš„ <code>displayName</code> å¯èƒ½ä¼šåœ¨å¼€å‘è€…å·¥å…·æˆ–è€…é”™è¯¯ä¿¡æ¯ä¸­ä½¿ç”¨åˆ°ï¼Œå› æ­¤æœ‰ä¸€ä¸ªèƒ½æ¸…æ¥šçš„è¡¨è¾¾è¿™å±‚å…³ç³»çš„å€¼èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£æ¨¡å—å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæ›´å¥½çš„Debug.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">withFoo</span>(<span class="params">WrappedComponent</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">WithFoo</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &lt;WrappedComponent &#123;...props&#125; foo /&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// good</div><div class="line">export default function withFoo(WrappedComponent) &#123;</div><div class="line">  function WithFoo(props) &#123;</div><div class="line">    return &lt;WrappedComponent &#123;...props&#125; foo /&gt;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  const wrappedComponentName = WrappedComponent.displayName</div><div class="line">    || WrappedComponent.name</div><div class="line">    || 'Component';</div><div class="line"></div><div class="line">  WithFoo.displayName = `withFoo($&#123;wrappedComponentName&#125;)`;</div><div class="line">  return WithFoo;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>å±æ€§å‘½å</strong>: é¿å…ä½¿ç”¨DOMç›¸å…³çš„å±æ€§æ¥ç”¨ä½œå…¶ä»–çš„ç”¨é€”ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆï¼Ÿå¯¹äº<code>style</code> å’Œ <code>className</code>è¿™æ ·çš„å±æ€§åï¼Œæˆ‘ä»¬éƒ½ä¼šé»˜è®¤å®ƒä»¬ä»£è¡¨ä¸€äº›ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚å…ƒç´ çš„æ ·å¼ï¼ŒCSS classçš„åç§°ã€‚åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨è¿™äº›å±æ€§æ¥è¡¨ç¤ºå…¶ä»–çš„å«ä¹‰ä¼šä½¿ä½ çš„ä»£ç æ›´éš¾é˜…è¯»ï¼Œæ›´éš¾ç»´æŠ¤ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¼•èµ·bugã€‚</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;MyComponent style=<span class="string">"fancy"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;MyComponent variant=<span class="string">"fancy"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Declaration-å£°æ˜æ¨¡å—"><a href="#Declaration-å£°æ˜æ¨¡å—" class="headerlink" title="Declaration å£°æ˜æ¨¡å—"></a>Declaration å£°æ˜æ¨¡å—</h2><ul>
<li><p>ä¸è¦ä½¿ç”¨ <code>displayName</code> æ¥å‘½åReactæ¨¡å—ï¼Œè€Œæ˜¯ä½¿ç”¨å¼•ç”¨æ¥å‘½åæ¨¡å—ï¼Œ å¦‚ class åç§°.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.createClass(&#123;</div><div class="line">  <span class="attr">displayName</span>: <span class="string">'ReservationCard'</span>,</div><div class="line">  <span class="comment">// stuff goes here</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ReservationCard</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Alignment-ä»£ç å¯¹é½"><a href="#Alignment-ä»£ç å¯¹é½" class="headerlink" title="Alignment ä»£ç å¯¹é½"></a>Alignment ä»£ç å¯¹é½</h2><ul>
<li><p>éµå¾ªä»¥ä¸‹çš„JSXè¯­æ³•ç¼©è¿›/æ ¼å¼. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-closing-bracket-location.md" target="_blank" rel="external"><code>react/jsx-closing-bracket-location</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo superLongParam=<span class="string">"bar"</span></div><div class="line">     anotherSuperLongParam=<span class="string">"baz"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good, æœ‰å¤šè¡Œå±æ€§çš„è¯, æ–°å»ºä¸€è¡Œå…³é—­æ ‡ç­¾</span></div><div class="line">&lt;Foo</div><div class="line">  superLongParam=<span class="string">"bar"</span></div><div class="line">  anotherSuperLongParam=<span class="string">"baz"</span></div><div class="line">/&gt;</div><div class="line"></div><div class="line"><span class="comment">// è‹¥èƒ½åœ¨ä¸€è¡Œä¸­æ˜¾ç¤º, ç›´æ¥å†™æˆä¸€è¡Œ</span></div><div class="line">&lt;Foo bar=<span class="string">"bar"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// å­å…ƒç´ æŒ‰ç…§å¸¸è§„æ–¹å¼ç¼©è¿›</span></div><div class="line">&lt;Foo</div><div class="line">  superLongParam=<span class="string">"bar"</span></div><div class="line">  anotherSuperLongParam=<span class="string">"baz"</span></div><div class="line">&gt;</div><div class="line">  &lt;Quux /&gt;</div><div class="line">&lt;/Foo&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Quotes-å•å¼•å·è¿˜æ˜¯åŒå¼•å·"><a href="#Quotes-å•å¼•å·è¿˜æ˜¯åŒå¼•å·" class="headerlink" title="Quotes å•å¼•å·è¿˜æ˜¯åŒå¼•å·"></a>Quotes å•å¼•å·è¿˜æ˜¯åŒå¼•å·</h2><ul>
<li><p>å¯¹äºJSXå±æ€§å€¼æ€»æ˜¯ä½¿ç”¨åŒå¼•å·(<code>&quot;</code>), å…¶ä»–å‡ä½¿ç”¨å•å¼•å·(<code>&#39;</code>). eslint: <a href="http://eslint.org/docs/rules/jsx-quotes" target="_blank" rel="external"><code>jsx-quotes</code></a></p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? HTMLå±æ€§ä¹Ÿæ˜¯ç”¨åŒå¼•å·, å› æ­¤JSXçš„å±æ€§ä¹Ÿéµå¾ªæ­¤çº¦å®š.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo bar=<span class="string">'bar'</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo bar=<span class="string">"bar"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo style=&#123;&#123; <span class="attr">left</span>: <span class="string">"20px"</span> &#125;&#125; /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo style=&#123;&#123; <span class="attr">left</span>: <span class="string">'20px'</span> &#125;&#125; /&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Spacing-ç©ºæ ¼"><a href="#Spacing-ç©ºæ ¼" class="headerlink" title="Spacing ç©ºæ ¼"></a>Spacing ç©ºæ ¼</h2><ul>
<li><p>æ€»æ˜¯åœ¨è‡ªåŠ¨å…³é—­çš„æ ‡ç­¾å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦æ¢è¡Œ. eslint: <a href="http://eslint.org/docs/rules/no-multi-spaces" target="_blank" rel="external"><code>no-multi-spaces</code></a>, <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-space-before-closing.md" target="_blank" rel="external"><code>react/jsx-space-before-closing</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo/&gt;</div><div class="line"></div><div class="line"><span class="comment">// very bad</span></div><div class="line">&lt;Foo                 /&gt;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo</div><div class="line"> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦åœ¨JSX <code>{}</code> å¼•ç”¨æ‹¬å·é‡Œä¸¤è¾¹åŠ ç©ºæ ¼. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-curly-spacing.md" target="_blank" rel="external"><code>react/jsx-curly-spacing</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo bar=&#123; baz &#125; /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo bar=&#123;baz&#125; /&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Props-å±æ€§"><a href="#Props-å±æ€§" class="headerlink" title="Props å±æ€§"></a>Props å±æ€§</h2><ul>
<li><p>JSXå±æ€§åä½¿ç”¨éª†é©¼å¼é£æ ¼<code>camelCase</code>.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo</div><div class="line">  UserName=<span class="string">"hello"</span></div><div class="line">  phone_number=&#123;<span class="number">12345678</span>&#125;</div><div class="line">/&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo</div><div class="line">  userName=<span class="string">"hello"</span></div><div class="line">  phoneNumber=&#123;<span class="number">12345678</span>&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœå±æ€§å€¼ä¸º <code>true</code>, å¯ä»¥ç›´æ¥çœç•¥. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-boolean-value.md" target="_blank" rel="external"><code>react/jsx-boolean-value</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo</div><div class="line">  hidden=&#123;<span class="literal">true</span>&#125;</div><div class="line">/&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo</div><div class="line">  hidden</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>&lt;img&gt;</code> æ ‡ç­¾æ€»æ˜¯æ·»åŠ  <code>alt</code> å±æ€§. å¦‚æœå›¾ç‰‡ä»¥presentation(æ„Ÿè§‰æ˜¯ä»¥ç±»ä¼¼PPTæ–¹å¼æ˜¾ç¤º?)æ–¹å¼æ˜¾ç¤ºï¼Œ<code>alt</code> å¯ä¸ºç©º, æˆ–è€…<code>&lt;img&gt;</code> è¦åŒ…å«<code>role=&quot;presentation&quot;</code>. eslint: <a href="https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/img-has-alt.md" target="_blank" rel="external"><code>jsx-a11y/img-has-alt</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> alt=<span class="string">"Me waving hello"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> alt=<span class="string">""</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> role=<span class="string">"presentation"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦åœ¨ <code>alt</code> å€¼é‡Œä½¿ç”¨å¦‚ â€œimageâ€, â€œphotoâ€, or â€œpictureâ€åŒ…æ‹¬å›¾ç‰‡å«ä¹‰è¿™æ ·çš„è¯ï¼Œ ä¸­æ–‡ä¹Ÿä¸€æ ·. eslint: <a href="https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/img-redundant-alt.md" target="_blank" rel="external"><code>jsx-a11y/img-redundant-alt</code></a></p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨å·²ç»æŠŠ <code>img</code> æ ‡ç­¾æ ‡æ³¨ä¸ºå›¾ç‰‡äº†, æ‰€ä»¥æ²¡æœ‰å¿…è¦å†åœ¨ <code>alt</code> é‡Œè¯´æ˜äº†.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> alt=<span class="string">"Picture of me waving hello"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;img src=<span class="string">"hello.jpg"</span> alt=<span class="string">"Me waving hello"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨æœ‰æ•ˆæ­£ç¡®çš„ aria <code>role</code>å±æ€§å€¼ <a href="https://www.w3.org/TR/wai-aria/roles#role_definitions" target="_blank" rel="external">ARIA roles</a>. eslint: <a href="https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/aria-role.md" target="_blank" rel="external"><code>jsx-a11y/aria-role</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad - not an ARIA role</span></div><div class="line">&lt;div role=<span class="string">"datepicker"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// bad - abstract ARIA role</span></div><div class="line">&lt;div role=<span class="string">"range"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;div role=<span class="string">"button"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸è¦åœ¨æ ‡ç­¾ä¸Šä½¿ç”¨ <code>accessKey</code> å±æ€§. eslint: <a href="https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/no-access-key.md" target="_blank" rel="external"><code>jsx-a11y/no-access-key</code></a></p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨åœ¨é”®ç›˜å¿«æ·é”®ä¸é”®ç›˜å‘½ä»¤æ—¶é€ æˆçš„ä¸ç»Ÿä¸€æ€§ä¼šå¯¼è‡´é˜…è¯»æ€§æ›´åŠ å¤æ‚.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;div accessKey=<span class="string">"h"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;div /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>é¿å…ä½¿ç”¨æ•°ç»„çš„indexæ¥ä½œä¸ºå±æ€§<code>key</code>çš„å€¼ï¼Œæ¨èä½¿ç”¨å”¯ä¸€ID. (<a href="https://medium.com/@robinpokorny/index-as-a-key-is-an-anti-pattern-e0349aece318" target="_blank" rel="external">ä¸ºä»€ä¹ˆ?</a>)</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&#123;todos.map(<span class="function">(<span class="params">todo, index</span>) =&gt;</span></div><div class="line">  &lt;Todo</div><div class="line">    &#123;...todo&#125;</div><div class="line">    key=&#123;index&#125;</div><div class="line">  /&gt;</div><div class="line">)&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&#123;todos.map(<span class="function"><span class="params">todo</span> =&gt;</span> (</div><div class="line">  &lt;Todo</div><div class="line">    &#123;...todo&#125;</div><div class="line">    key=&#123;todo.id&#125;</div><div class="line">  /&gt;</div><div class="line">))&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å¯¹äºæ‰€æœ‰éå¿…é¡»çš„å±æ€§ï¼Œæ€»æ˜¯æ‰‹åŠ¨å»å®šä¹‰<code>defaultProps</code>å±æ€§.</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? propTypes å¯ä»¥ä½œä¸ºæ¨¡å—çš„æ–‡æ¡£è¯´æ˜, å¹¶ä¸”å£°æ˜ defaultProps çš„è¯æ„å‘³ç€é˜…è¯»ä»£ç çš„äººä¸éœ€è¦å»å‡è®¾ä¸€äº›é»˜è®¤å€¼ã€‚æ›´é‡è¦çš„æ˜¯, æ˜¾ç¤ºçš„å£°æ˜é»˜è®¤å±æ€§å¯ä»¥è®©ä½ çš„æ¨¡å—è·³è¿‡å±æ€§ç±»å‹çš„æ£€æŸ¥.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SFC</span>(<span class="params">&#123; foo, bar, children &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &lt;div&gt;&#123;foo&#125;&#123;bar&#125;&#123;children&#125;&lt;/div&gt;;</div><div class="line">&#125;</div><div class="line">SFC.propTypes = &#123;</div><div class="line">  <span class="attr">foo</span>: PropTypes.number.isRequired,</div><div class="line">  <span class="attr">bar</span>: PropTypes.string,</div><div class="line">  <span class="attr">children</span>: PropTypes.node,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SFC</span>(<span class="params">&#123; foo, bar &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &lt;div&gt;&#123;foo&#125;&#123;bar&#125;&lt;/div&gt;;</div><div class="line">&#125;</div><div class="line">SFC.propTypes = &#123;</div><div class="line">  <span class="attr">foo</span>: PropTypes.number.isRequired,</div><div class="line">  <span class="attr">bar</span>: PropTypes.string,</div><div class="line">  <span class="attr">children</span>: PropTypes.node,</div><div class="line">&#125;;</div><div class="line">SFC.defaultProps = &#123;</div><div class="line">  <span class="attr">bar</span>: <span class="string">''</span>,</div><div class="line">  <span class="attr">children</span>: <span class="literal">null</span>,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><ul>
<li><p>æ€»æ˜¯åœ¨Refsé‡Œä½¿ç”¨å›è°ƒå‡½æ•°. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/no-string-refs.md" target="_blank" rel="external"><code>react/no-string-refs</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo</div><div class="line">  ref=<span class="string">"myRef"</span></div><div class="line">/&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo</div><div class="line">  ref=&#123;(ref) =&gt; &#123; <span class="keyword">this</span>.myRef = ref; &#125;&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Parentheses-æ‹¬å·"><a href="#Parentheses-æ‹¬å·" class="headerlink" title="Parentheses æ‹¬å·"></a>Parentheses æ‹¬å·</h2><ul>
<li><p>å°†å¤šè¡Œçš„JSXæ ‡ç­¾å†™åœ¨ <code>()</code>é‡Œ. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-wrap-multilines.md" target="_blank" rel="external"><code>react/jsx-wrap-multilines</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">return</span> &lt;MyComponent className="long body" foo="bar"&gt;</div><div class="line">           &lt;MyChild /&gt;</div><div class="line">         &lt;/MyComponent&gt;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;MyComponent className="long body" foo="bar"&gt;</div><div class="line">      &lt;MyChild /&gt;</div><div class="line">    &lt;/MyComponent&gt;</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good, å•è¡Œå¯ä»¥ä¸éœ€è¦</span></div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> body = &lt;div&gt;hello&lt;/div&gt;;</div><div class="line">  <span class="keyword">return</span> &lt;MyComponent&gt;&#123;body&#125;&lt;/MyComponent&gt;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Tags-æ ‡ç­¾"><a href="#Tags-æ ‡ç­¾" class="headerlink" title="Tags æ ‡ç­¾"></a>Tags æ ‡ç­¾</h2><ul>
<li><p>å¯¹äºæ²¡æœ‰å­å…ƒç´ çš„æ ‡ç­¾æ¥è¯´æ€»æ˜¯è‡ªå·±å…³é—­æ ‡ç­¾. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/self-closing-comp.md" target="_blank" rel="external"><code>react/self-closing-comp</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo className=<span class="string">"stuff"</span>&gt;&lt;/Foo&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo className=<span class="string">"stuff"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœæ¨¡å—æœ‰å¤šè¡Œçš„å±æ€§ï¼Œ å…³é—­æ ‡ç­¾æ—¶æ–°å»ºä¸€è¡Œ. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-closing-bracket-location.md" target="_blank" rel="external"><code>react/jsx-closing-bracket-location</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">&lt;Foo</div><div class="line">  bar=<span class="string">"bar"</span></div><div class="line">  baz=<span class="string">"baz"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">&lt;Foo</div><div class="line">  bar=<span class="string">"bar"</span></div><div class="line">  baz=<span class="string">"baz"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Methods-å‡½æ•°"><a href="#Methods-å‡½æ•°" class="headerlink" title="Methods å‡½æ•°"></a>Methods å‡½æ•°</h2><ul>
<li><p>ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥è·å–æœ¬åœ°å˜é‡.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ItemList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;ul&gt;</div><div class="line">      &#123;props.items.map((item, index) =&gt; (</div><div class="line">        &lt;Item</div><div class="line">          key=&#123;item.key&#125;</div><div class="line">          onClick=&#123;() =&gt; doSomethingWith(item.name, index)&#125;</div><div class="line">        /&gt;</div><div class="line">      ))&#125;</div><div class="line">    &lt;/ul&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å½“åœ¨ <code>render()</code> é‡Œä½¿ç”¨äº‹ä»¶å¤„ç†æ–¹æ³•æ—¶ï¼Œæå‰åœ¨æ„é€ å‡½æ•°é‡ŒæŠŠ <code>this</code> ç»‘å®šä¸Šå». eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-no-bind.md" target="_blank" rel="external"><code>react/jsx-no-bind</code></a></p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? åœ¨æ¯æ¬¡ <code>render</code> è¿‡ç¨‹ä¸­ï¼Œ å†è°ƒç”¨ <code>bind</code> éƒ½ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæµªè´¹èµ„æº.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  onClickDiv() &#123;</div><div class="line">    <span class="comment">// do stuff</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div onClick=&#123;this.onClickDiv.bind(this)&#125; /&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// good</div><div class="line">class extends React.Component &#123;</div><div class="line">  constructor(props) &#123;</div><div class="line">    super(props);</div><div class="line"></div><div class="line">    this.onClickDiv = this.onClickDiv.bind(this);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  onClickDiv() &#123;</div><div class="line">    // do stuff</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    return &lt;div onClick=&#123;this.onClickDiv&#125; /&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨Reactæ¨¡å—ä¸­ï¼Œä¸è¦ç»™æ‰€è°“çš„ç§æœ‰å‡½æ•°æ·»åŠ  <code>_</code> å‰ç¼€ï¼Œæœ¬è´¨ä¸Šå®ƒå¹¶ä¸æ˜¯ç§æœ‰çš„.</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆï¼Ÿ<code>_</code> ä¸‹åˆ’çº¿å‰ç¼€åœ¨æŸäº›è¯­è¨€ä¸­é€šå¸¸è¢«ç”¨æ¥è¡¨ç¤ºç§æœ‰å˜é‡æˆ–è€…å‡½æ•°ã€‚ä½†æ˜¯ä¸åƒå…¶ä»–çš„ä¸€äº›è¯­è¨€ï¼Œåœ¨JSä¸­æ²¡æœ‰åŸç”Ÿæ”¯æŒæ‰€è°“çš„ç§æœ‰å˜é‡ï¼Œæ‰€æœ‰çš„å˜é‡å‡½æ•°éƒ½æ˜¯å…±æœ‰çš„ã€‚å°½ç®¡ä½ çš„æ„å›¾æ˜¯ä½¿å®ƒç§æœ‰åŒ–ï¼Œåœ¨ä¹‹å‰åŠ ä¸Šä¸‹åˆ’çº¿å¹¶ä¸ä¼šä½¿è¿™äº›å˜é‡ç§æœ‰åŒ–ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å±æ€§ï¼ˆåŒ…æ‹¬æœ‰ä¸‹åˆ’çº¿å‰ç¼€åŠæ²¡æœ‰å‰ç¼€çš„ï¼‰éƒ½åº”è¯¥è¢«è§†ä¸ºæ˜¯å…±æœ‰çš„ã€‚äº†è§£æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹Issue <a href="https://github.com/airbnb/javascript/issues/1024" target="_blank" rel="external">#1024</a>, å’Œ <a href="https://github.com/airbnb/javascript/issues/490" target="_blank" rel="external">#490</a> ã€‚</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">React.createClass(&#123;</div><div class="line">  _onClickSubmit() &#123;</div><div class="line">    <span class="comment">// do stuff</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// other stuff</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  onClickSubmit() &#123;</div><div class="line">    <span class="comment">// do stuff</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// other stuff</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <code>render</code> æ–¹æ³•ä¸­æ€»æ˜¯ç¡®ä¿ <code>return</code> è¿”å›å€¼. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/require-render-return.md" target="_blank" rel="external"><code>react/require-render-return</code></a></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">render() &#123;</div><div class="line">  (&lt;div /&gt;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// good</div><div class="line">render() &#123;</div><div class="line">  return (&lt;div /&gt;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Ordering-React-æ¨¡å—ç”Ÿå‘½å‘¨æœŸ"><a href="#Ordering-React-æ¨¡å—ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Ordering React æ¨¡å—ç”Ÿå‘½å‘¨æœŸ"></a>Ordering React æ¨¡å—ç”Ÿå‘½å‘¨æœŸ</h2><ul>
<li><code>class extends React.Component</code> çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°:</li>
</ul>
<ol>
<li>å¯é€‰çš„ <code>static</code> æ–¹æ³•</li>
<li><code>constructor</code> æ„é€ å‡½æ•°</li>
<li><code>getChildContext</code> è·å–å­å…ƒç´ å†…å®¹</li>
<li><code>componentWillMount</code> æ¨¡å—æ¸²æŸ“å‰</li>
<li><code>componentDidMount</code> æ¨¡å—æ¸²æŸ“å</li>
<li><code>componentWillReceiveProps</code> æ¨¡å—å°†æ¥å—æ–°çš„æ•°æ®</li>
<li><code>shouldComponentUpdate</code> åˆ¤æ–­æ¨¡å—éœ€ä¸éœ€è¦é‡æ–°æ¸²æŸ“</li>
<li><code>componentWillUpdate</code> ä¸Šé¢çš„æ–¹æ³•è¿”å› <code>true</code>ï¼Œ æ¨¡å—å°†é‡æ–°æ¸²æŸ“</li>
<li><code>componentDidUpdate</code> æ¨¡å—æ¸²æŸ“ç»“æŸ</li>
<li><code>componentWillUnmount</code> æ¨¡å—å°†ä»DOMä¸­æ¸…é™¤, åšä¸€äº›æ¸…ç†ä»»åŠ¡</li>
<li><em>ç‚¹å‡»å›è°ƒæˆ–è€…äº‹ä»¶å¤„ç†å™¨</em> å¦‚ <code>onClickSubmit()</code> æˆ– <code>onChangeDescription()</code></li>
<li><em><code>render</code> é‡Œçš„ getter æ–¹æ³•</em> å¦‚ <code>getSelectReason()</code> æˆ– <code>getFooterContent()</code></li>
<li><em>å¯é€‰çš„ render æ–¹æ³•</em> å¦‚ <code>renderNavigation()</code> æˆ– <code>renderProfilePicture()</code></li>
<li><code>render</code> render() æ–¹æ³•</li>
</ol>
<ul>
<li><p>å¦‚ä½•å®šä¹‰ <code>propTypes</code>, <code>defaultProps</code>, <code>contextTypes</code>, ç­‰ç­‰å…¶ä»–å±æ€§â€¦</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> propTypes = &#123;</div><div class="line">  <span class="attr">id</span>: PropTypes.number.isRequired,</div><div class="line">  <span class="attr">url</span>: PropTypes.string.isRequired,</div><div class="line">  <span class="attr">text</span>: PropTypes.string,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> defaultProps = &#123;</div><div class="line">  <span class="attr">text</span>: <span class="string">'Hello World'</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> methodsAreOk() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;a href=&#123;this.props.url&#125; data-id=&#123;this.props.id&#125;&gt;&#123;this.props.text&#125;&lt;/a&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Link.propTypes = propTypes;</div><div class="line">Link.defaultProps = defaultProps;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Link;</div></pre></td></tr></table></figure>
</li>
<li><p><code>React.createClass</code> çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¸ä½¿ç”¨classç¨æœ‰ä¸åŒ: eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/sort-comp.md" target="_blank" rel="external"><code>react/sort-comp</code></a></p>
</li>
</ul>
<ol>
<li><code>displayName</code> è®¾å®šæ¨¡å—åç§°</li>
<li><code>propTypes</code> è®¾ç½®å±æ€§çš„ç±»å‹</li>
<li><code>contextTypes</code> è®¾ç½®ä¸Šä¸‹æ–‡ç±»å‹</li>
<li><code>childContextTypes</code> è®¾ç½®å­å…ƒç´ ä¸Šä¸‹æ–‡ç±»å‹</li>
<li><code>mixins</code> æ·»åŠ ä¸€äº›mixins</li>
<li><code>statics</code></li>
<li><code>defaultProps</code> è®¾ç½®é»˜è®¤çš„å±æ€§å€¼</li>
<li><code>getDefaultProps</code> è·å–é»˜è®¤å±æ€§å€¼</li>
<li><code>getInitialState</code> æˆ–è€…åˆå§‹çŠ¶æ€</li>
<li><code>getChildContext</code></li>
<li><code>componentWillMount</code></li>
<li><code>componentDidMount</code></li>
<li><code>componentWillReceiveProps</code></li>
<li><code>shouldComponentUpdate</code></li>
<li><code>componentWillUpdate</code></li>
<li><code>componentDidUpdate</code></li>
<li><code>componentWillUnmount</code></li>
<li><em>clickHandlers or eventHandlers</em> like <code>onClickSubmit()</code> or <code>onChangeDescription()</code></li>
<li><em>getter methods for <code>render</code></em> like <code>getSelectReason()</code> or <code>getFooterContent()</code></li>
<li><em>Optional render methods</em> like <code>renderNavigation()</code> or <code>renderProfilePicture()</code></li>
<li><code>render</code></li>
</ol>
<h2 id="isMounted"><a href="#isMounted" class="headerlink" title="isMounted"></a>isMounted</h2><ul>
<li><p>ä¸è¦å†ä½¿ç”¨ <code>isMounted</code>. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/no-is-mounted.md" target="_blank" rel="external"><code>react/no-is-mounted</code></a></p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? <a href="https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html" target="_blank" rel="external"><code>isMounted</code> åäººç±»è®¾è®¡æ¨¡å¼:()</a>, åœ¨ ES6 classes ä¸­æ— æ³•ä½¿ç”¨ï¼Œ å®˜æ–¹å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬é‡Œåˆ é™¤æ­¤æ–¹æ³•.</p>
</blockquote>
</li>
</ul>
<p><strong><a href="#å†…å®¹ç›®å½•">â¬† å›åˆ°é¡¶éƒ¨</a></strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Airbnb-React-JSX-ç¼–ç è§„èŒƒ&quot;&gt;&lt;a href=&quot;#Airbnb-React-JSX-ç¼–ç è§„èŒƒ&quot; class=&quot;headerlink&quot; title=&quot;Airbnb React/JSX ç¼–ç è§„èŒƒ&quot;&gt;&lt;/a&gt;Airbnb React/JSX ç¼–ç è§„èŒƒ&lt;/
    
    </summary>
    
      <category term="è½¬è½½" scheme="http://yoursite.com/categories/%E8%BD%AC%E8%BD%BD/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘|React-navigation(1)</title>
    <link href="http://yoursite.com/2017/03/28/New-React-navigation-system-github-3211/"/>
    <id>http://yoursite.com/2017/03/28/New-React-navigation-system-github-3211/</id>
    <published>2017-03-27T20:26:48.000Z</published>
    <updated>2017-03-27T15:20:58.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™ä¸ªReact-nativeçš„å¯¼èˆªç³»ç»Ÿå¯èƒ½å·²ç»åŸºæœ¬å®˜æ–¹æ ‡é…ç³»ç»Ÿäº†.ä¸¤ä¸ªæœˆæ—¶é—´å·²ç»ç§¯ç´¯äº†3000å¤šçš„star.<br>æ•™ç¨‹å¯ä»¥å‚è€ƒ<a href="https://hackernoon.com/getting-started-with-react-navigation-the-navigation-solution-for-react-native-ea3f4bd786a4#.n0pz5ev39" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>,è¿™ä¸ªæ–‡ç« ä½œè€…è€å…„å’Œæˆ‘ä¸€æ ·å¾ˆå–œæ¬¢æŠ˜è…¾.å‰é¢å°±å‚è€ƒäº†ä»–çš„å¦ä¸€ä¸ªå¯¼èˆªæ•™ç¨‹,è¿™æ¬¡å†æ¥.</p>
<hr>
<p>æœ¬æ–‡æ˜¯ç¿»è¯‘çš„<a href="https://reactnavigation.org/docs/intro/" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>.æ‰“ç®—ç¿»è¯‘å®Œ<br>åŸºæœ¬æ€è·¯æ˜¯æœ‰å‡ ä¸ªæ³¨å†Œç³»ç»Ÿ,å¦‚æœè¦åœ¨appä¸­ä½¿ç”¨å¯¼èˆª,å¿…é¡»è¦æŠŠç»„ä»¶æ³¨å†Œåˆ°å¯¹åº”çš„ç³»ç»Ÿä¸­.</p>
<h1 id="åŸæ–‡å¼€å§‹ï¼šä½ å¥½ï¼ç§»åŠ¨å¯¼èˆª"><a href="#åŸæ–‡å¼€å§‹ï¼šä½ å¥½ï¼ç§»åŠ¨å¯¼èˆª" class="headerlink" title="åŸæ–‡å¼€å§‹ï¼šä½ å¥½ï¼ç§»åŠ¨å¯¼èˆª"></a>åŸæ–‡å¼€å§‹ï¼šä½ å¥½ï¼ç§»åŠ¨å¯¼èˆª</h1><p>ä½¿ç”¨React Navigationæ¥æ„å»ºè·¨å¹³å°å¯¼èˆª</p>
<h2 id="é…ç½®å’Œå®‰è£…"><a href="#é…ç½®å’Œå®‰è£…" class="headerlink" title="é…ç½®å’Œå®‰è£…"></a>é…ç½®å’Œå®‰è£…</h2><p>é¦–å…ˆè¦é…ç½®React Nativeç³»ç»Ÿ.æ¥ä¸‹æ¥åˆ›å»ºRNé¡¹ç›®,æ·»åŠ <code>react-navigation</code></p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="comment"># Create a new React Native App</span></div><div class="line"> <span class="comment">#åˆ›å»ºæ–°RN APP</span></div><div class="line">react-native init SimpleApp</div><div class="line">cd SimpleApp</div><div class="line"></div><div class="line"><span class="comment"># Install the latest version of react-navigation from npmå®‰è£…æœ€æ–°ç‰ˆæœ¬</span></div><div class="line">npm install --save react-navigation</div><div class="line"></div><div class="line"><span class="comment"># Run the new appè¿è¡Œï¼Œç¡®ä¿åˆå§‹åŒ–æ­£å¸¸</span></div><div class="line">react-native <span class="keyword">run</span><span class="bash">-android <span class="comment"># or:</span></span></div><div class="line">react-native <span class="keyword">run</span><span class="bash">-ios</span></div></pre></td></tr></table></figure>
<p> <img src="https://ww3.sinaimg.cn/large/006tKfTcly1fe1ostu6xlj30ku112jrj.jpg" alt="åˆå§‹åŒ–ç•Œé¢"></p>
<p>ä¸ºäº†åœ¨Androidå’ŒiOSä¹‹é—´å…±äº«ä»£ç ,åˆ é™¤æ‰<code>index.ios.js</code>å’Œ<code>index.andorid.js</code>çš„å®é™…ä»£ç ,ä½¿ç”¨<code>import &#39;./App&#39;</code>æ¥å®ç°å…·ä½“çš„ä»£ç </p>
<p>ç°åœ¨æ¥åˆ›å»ºâ€˜App.jsâ€™</p>
<h2 id="Stack-Navigatorä»‹ç»"><a href="#Stack-Navigatorä»‹ç»" class="headerlink" title="Stack Navigatorä»‹ç»"></a>Stack Navigatorä»‹ç»</h2><p>ä¸ºäº†æƒ³ä½¿ç”¨<code>stack</code> navigationçš„æ¦‚å¿µ,æˆ‘ä»¬ä¼šä½¿ç”¨<code>StactkNavigator</code>.(è¯‘æ³¨ï¼šstackå°±æ˜¯æ•°æ®ç»“æ„çš„å †æ ˆæŠ€æœ¯,éµå¾ªåè¿›å…ˆå‡ºçš„åŸç†).æ¯ä¸€ä¸ª<code>è¢«</code>åˆ°å¯¼èˆªçš„screen(å¯¼èˆªç”»é¢)è¢«æ”¾åœ¨å †æ ˆçš„æ ˆé¡¶,è¿”å›æ—¶å€™,ä¼šä»æ ˆé¡¶å¼¹å‡ºå¯¹åº”çš„ç»„ä»¶.å…ˆçœ‹çœ‹ä¸€ä¸ªscreençš„æƒ…å†µ</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…¶å®è¿™ä¸ªä»£ç æ²¡æœ‰å®ç°App.jsï¼Œexportçš„æ¨¡å¼,æ³¨æ„</span></div><div class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="symbol">'reac</span>t';</div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  <span class="type">AppRegistry</span>,</div><div class="line">  <span class="type">Text</span>,</div><div class="line">&#125; from <span class="symbol">'react</span>-native';</div><div class="line"><span class="comment">//å¯¼å…¥stackå¯¼èˆªç»„ä»¶</span></div><div class="line"><span class="keyword">import</span> &#123; <span class="type">StackNavigator</span> &#125; from <span class="symbol">'react</span>-navigation';</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Welcom</span>e',<span class="comment">//åœ¨å¯¼èˆªä¸­æ˜¾ç¤ºçš„æ ‡é¢˜å†…å®¹</span></div><div class="line">  &#125;;</div><div class="line">  render() &#123;</div><div class="line">    <span class="comment">//è¿™é‡Œå¯ä»¥æ˜¯å¯¼å…¥çš„å…¶ä»–ç»„ä»¶</span></div><div class="line">    <span class="keyword">return</span> &lt;<span class="type">Text</span>&gt;<span class="type">Hello</span>, <span class="type">Navigation</span>!&lt;/<span class="type">Text</span>&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//è¿›è¡Œå¯¼èˆªçš„æ³¨å†Œ</span></div><div class="line">const <span class="type">SimpleApp</span> = <span class="type">StackNavigator</span>(&#123;</div><div class="line">  <span class="type">Home</span>: &#123; screen: <span class="type">HomeScreen</span> &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="type">AppRegistry</span>.registerComponent(<span class="symbol">'SimpleAp</span>p', () =&gt; <span class="type">SimpleApp</span>);</div></pre></td></tr></table></figure>
<p><code>title</code>æ˜¯static<code>navigationOptions</code>é‡Œé…ç½®çš„æ ‡é¢˜å†…å®¹,å‡ºç°çš„ç•Œé¢çœ‹ä¸‹é¢</p>
<p><img src="https://ww1.sinaimg.cn/large/006tNbRwly1fe1pa9cdbrj30yj1pd0t3.jpg" alt=""></p>
<h2 id="æ·»åŠ æ–°çš„å¯¼èˆªç”»é¢"><a href="#æ·»åŠ æ–°çš„å¯¼èˆªç”»é¢" class="headerlink" title="æ·»åŠ æ–°çš„å¯¼èˆªç”»é¢"></a>æ·»åŠ æ–°çš„å¯¼èˆªç”»é¢</h2><p>å†æ·»åŠ ä¸€ä¸ª<code>ChatScreen</code>ç”»é¢</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ChatScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Chat</span> <span class="keyword">with</span> <span class="type">Lucy</span>',</div><div class="line">  &#125;;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">View</span>&gt;</div><div class="line">        &lt;<span class="type">Text</span>&gt;<span class="type">Chat</span> <span class="keyword">with</span> <span class="type">Lucy</span>&lt;/<span class="type">Text</span>&gt;</div><div class="line">      &lt;/<span class="type">View</span>&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨<code>HomeScreen</code>ä¸­æ·»åŠ ä¸€ä¸ªbuttonç»„ä»¶,ä½¿ç”¨<code>routeName</code> <code>Chat</code>å…³è”åˆ°<code>ChatScreen</code>.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Welcom</span>e',</div><div class="line">  &#125;;</div><div class="line">  render() &#123;</div><div class="line">    const &#123; navigate &#125; = <span class="keyword">this</span>.props.navigation;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">View</span>&gt;</div><div class="line">        &lt;<span class="type">Text</span>&gt;<span class="type">Hello</span>, <span class="type">Chat</span> <span class="type">App</span>!&lt;/<span class="type">Text</span>&gt;</div><div class="line">        &lt;<span class="type">Button</span></div><div class="line">          onPress=&#123;() =&gt; navigate(<span class="symbol">'Cha</span>t')&#125;</div><div class="line">          title=<span class="string">"Chat with Lucy"</span></div><div class="line">        /&gt;</div><div class="line">      &lt;/<span class="type">View</span>&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä»<code>screen navigation prop</code>è·å¾—çš„å¯¼èˆªå‡½æ•°è½¬å‘<code>ChatScreen</code>.ä½†æ˜¯è¿™éœ€è¦åœ¨<code>StackNavigator</code>ä¸­æ³¨å†Œ.<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> const SimpleApp = StackNavigator(&#123;</div><div class="line"><span class="symbol">  Home:</span> &#123; screen: HomeScreen &#125;,</div><div class="line"><span class="symbol">  Chat:</span> &#123; screen: ChatScreen &#125;,<span class="comment">//æ–°æ·»åŠ çš„screen</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨å¯ä»¥å¯¼èˆªåˆ°ChatScreen,ä¹Ÿå¯ä»¥è¿”å›äº†.<br><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fe1pjjrpn4g307i0dc75l.gif" alt=""></p>
<h2 id="ä¼ é€’å‚æ•°"><a href="#ä¼ é€’å‚æ•°" class="headerlink" title="ä¼ é€’å‚æ•°"></a>ä¼ é€’å‚æ•°</h2><p>åœ¨<code>ChatScreen</code>ä¸­ç¡¬ç¼–ç æ ‡é¢˜ä¸æ˜¯å¥½åŠæ³•,å¯ä»¥åœ¨å¯¼èˆªçš„æ—¶å€™ä¼ é€’å‚æ•°.é¦–å…ˆç¼–è¾‘ä¸€ä¸‹<code>HomeScreen</code>ç»„ä»¶,ä¼ é€’<code>name</code>å‚æ•°åˆ°è·¯ç”±ä¸­.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    title: <span class="symbol">'Welcom</span>e',</div><div class="line">  &#125;;</div><div class="line">  render() &#123;</div><div class="line">    const &#123; navigate &#125; = <span class="keyword">this</span>.props.navigation;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;<span class="type">View</span>&gt;</div><div class="line">        &lt;<span class="type">Text</span>&gt;<span class="type">Hello</span>, <span class="type">Chat</span> <span class="type">App</span>!&lt;/<span class="type">Text</span>&gt;</div><div class="line">        &lt;<span class="type">Button</span></div><div class="line">          onPress=&#123;() =&gt; navigate(<span class="symbol">'Cha</span>t', &#123; user: <span class="symbol">'Luc</span>y' &#125;)&#125;</div><div class="line">          title=<span class="string">"Chat with Lucy"</span></div><div class="line">        /&gt;</div><div class="line">      &lt;/<span class="type">View</span>&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ç¼–è¾‘<code>ChatScreen</code>ç»„ä»¶æ˜¾ç¤ºçš„<code>name</code>å‚æ•°,è¿™ä¸ªå‚æ•°é€šè¿‡routeæ¥ä¼ é€’.</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> class ChatScreen extends React.Component &#123;</div><div class="line">  static navigationOptions = &#123;</div><div class="line">    // Nav options can be defined as a function of the navigation prop:</div><div class="line">    title: (&#123; <span class="keyword">state</span> &#125;) =&gt; `Chat with $&#123;<span class="keyword">state</span>.params.<span class="keyword">user</span>&#125;`,</div><div class="line">  &#125;;</div><div class="line">  render() &#123;</div><div class="line">    // The screen's current route is passed <span class="keyword">in</span> <span class="keyword">to</span> `props.navigation.<span class="keyword">state</span>`:</div><div class="line">    const &#123; params &#125; = this.props.navigation.<span class="keyword">state</span>;</div><div class="line">    return (</div><div class="line">      <span class="variable">&lt;View&gt;</span></div><div class="line">        <span class="variable">&lt;Text&gt;</span>Chat with &#123;params.<span class="keyword">user</span>&#125;&lt;/Text&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨å½“ä½ å¯¼èˆªåˆ°Chat screençš„æ—¶å€™,å¯ä»¥çœ‹åˆ°åå­—äº†.åœ¨<code>HomeScreen</code>ä¸­æ”¹å˜<code>name</code>,çœ‹çœ‹å˜åŒ–.</p>
<p><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fe1t489r4gg307i0dc75l.gif" alt=""></p>
<p>ç¬¬ä¸€éƒ¨åˆ†å°±è¿™äº›.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªReact-nativeçš„å¯¼èˆªç³»ç»Ÿå¯èƒ½å·²ç»åŸºæœ¬å®˜æ–¹æ ‡é…ç³»ç»Ÿäº†.ä¸¤ä¸ªæœˆæ—¶é—´å·²ç»ç§¯ç´¯äº†3000å¤šçš„star.&lt;br&gt;æ•™ç¨‹å¯ä»¥å‚è€ƒ&lt;a href=&quot;https://hackernoon.com/getting-started-with-react-n
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="React" scheme="http://yoursite.com/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Redux- actions Readme</title>
    <link href="http://yoursite.com/2017/03/27/Redux-actions-Readme/"/>
    <id>http://yoursite.com/2017/03/27/Redux-actions-Readme/</id>
    <published>2017-03-27T10:41:40.000Z</published>
    <updated>2017-03-27T02:43:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="redux-actions"><a href="#redux-actions" class="headerlink" title="redux-actions"></a>redux-actions</h1><p><a href="https://travis-ci.org/acdlite/redux-actions" target="_blank" rel="external"><img src="https://img.shields.io/travis/acdlite/redux-actions/master.svg?style=flat-square" alt="build status"></a></p>
<p><a href="https://nodei.co/npm/redux-actions/" target="_blank" rel="external"><img src="https://nodei.co/npm/redux-actions.png?downloads=true" alt="NPM"></a></p>
<p><a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="external">Flux Standard Action</a> utilities for Redux.</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save redux-actions</div></pre></td></tr></table></figure>
<p>The <a href="https://www.npmjs.com" target="_blank" rel="external">npm</a> package provides a <a href="http://webpack.github.io/docs/commonjs.html" target="_blank" rel="external">CommonJS</a> build for use in Node.js, and with bundlers like <a href="http://webpack.github.io/" target="_blank" rel="external">Webpack</a> and <a href="http://browserify.org/" target="_blank" rel="external">Browserify</a>. It also includes an <a href="http://jsmodules.io/" target="_blank" rel="external">ES modules</a> build that works well with <a href="http://rollupjs.org/" target="_blank" rel="external">Rollup</a> and <a href="https://webpack.js.org" target="_blank" rel="external">Webpack2</a>â€˜s tree-shaking.</p>
<p>If you donâ€™t use <a href="https://www.npmjs.com" target="_blank" rel="external">npm</a>, you may grab the latest <a href="https://unpkg.com/redux-actions@latest/dist" target="_blank" rel="external">UMD</a> build from <a href="https://unpkg.com" target="_blank" rel="external">unpkg</a> (either a <a href="https://unpkg.com/redux-actions@latest/dist/redux-actions.js" target="_blank" rel="external">development</a> or a <a href="https://unpkg.com/redux-actions@latest/dist/redux-actions.min.js" target="_blank" rel="external">production</a> build). The UMD build exports a global called <code>window.ReduxActions</code> if you add it to your page via a <code>&lt;script&gt;</code> tag. We <em>donâ€™t</em> recommend UMD builds for any serious application, as most of the libraries complementary to Redux are only available on <a href="https://www.npmjs.com/search?q=redux" target="_blank" rel="external">npm</a>.</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="createAction-type-payloadCreator-Identity-metaCreator"><a href="#createAction-type-payloadCreator-Identity-metaCreator" class="headerlink" title="createAction(type, payloadCreator = Identity, ?metaCreator)"></a><code>createAction(type, payloadCreator = Identity, ?metaCreator)</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createAction &#125; <span class="keyword">from</span> <span class="string">'redux-actions'</span>;</div></pre></td></tr></table></figure>
<p>Wraps an action creator so that its return value is the payload of a Flux Standard Action.</p>
<p><code>payloadCreator</code> must be a function, <code>undefined</code>, or <code>null</code>. If <code>payloadCreator</code> is <code>undefined</code> or <code>null</code>, the identity function is used.</p>
<p>Example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> increment = createAction(<span class="string">'INCREMENT'</span>, amount =&gt; amount);</div><div class="line"><span class="comment">// same as</span></div><div class="line">increment = createAction(<span class="string">'INCREMENT'</span>);</div><div class="line"></div><div class="line">expect(increment(<span class="number">42</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'INCREMENT'</span>,</div><div class="line">  <span class="attr">payload</span>: <span class="number">42</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>If the payload is an instance of an <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error" target="_blank" rel="external">Error<br>object</a>,<br>redux-actions will automatically set <figure class="highlight plain"><figcaption><span>to true.</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Example:</div><div class="line"></div><div class="line">```js</div><div class="line">const increment = createAction(&apos;INCREMENT&apos;);</div><div class="line"></div><div class="line">const error = new TypeError(&apos;not a number&apos;);</div><div class="line">expect(increment(error)).to.deep.equal(&#123;</div><div class="line">  type: &apos;INCREMENT&apos;,</div><div class="line">  payload: error,</div><div class="line">  error: true</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><code>createAction</code> also returns its <code>type</code> when used as type in <code>handleAction</code> or <code>handleActions</code>.</p>
<p>Example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> increment = createAction(<span class="string">'INCREMENT'</span>);</div><div class="line"></div><div class="line"><span class="comment">// As parameter in handleAction:</span></div><div class="line">handleAction(increment, &#123;</div><div class="line">  next(state, action) &#123;...&#125;,</div><div class="line">  <span class="keyword">throw</span>(state, action) &#123;...&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// As object key in handleActions:</span></div><div class="line"><span class="keyword">const</span> reducer = handleActions(&#123;</div><div class="line">  [increment]: <span class="function">(<span class="params">state, action</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="attr">counter</span>: state.counter + action.payload</div><div class="line">  &#125;)</div><div class="line">&#125;, &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;);</div></pre></td></tr></table></figure>
<p><strong>NOTE:</strong> The more correct name for this function is probably <code>createActionCreator()</code>, but that seems a bit redundant.</p>
<p>Use the identity form to create one-off actions:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">createAction(<span class="string">'ADD_TODO'</span>)(<span class="string">'Use Redux'</span>);</div></pre></td></tr></table></figure>
<p><code>metaCreator</code> is an optional function that creates metadata for the payload. It receives the same arguments as the payload creator, but its result becomes the meta field of the resulting action. If <code>metaCreator</code> is undefined or not a function, the meta field is omitted.</p>
<h3 id="createActions-actionMap-identityActions"><a href="#createActions-actionMap-identityActions" class="headerlink" title="createActions(?actionMap, ?...identityActions)"></a><code>createActions(?actionMap, ?...identityActions)</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createActions &#125; <span class="keyword">from</span> <span class="string">'redux-actions'</span>;</div></pre></td></tr></table></figure>
<p>Returns an object mapping action types to action creators. The keys of this object are camel-cased from the keys in <code>actionMap</code> and the string literals of <code>identityActions</code>; the values are the action creators.</p>
<p><code>actionMap</code> is an optional object and a recursive data structure, with action types as keys, and whose values <strong>must</strong> be either</p>
<ul>
<li>a function, which is the payload creator for that action</li>
<li>an array with <code>payload</code> and <code>meta</code> functions in that order, as in <a href="#createactiontype-payloadcreator--identity-metacreator"><code>createAction</code></a><ul>
<li><code>meta</code> is <strong>required</strong> in this case (otherwise use the function form above)</li>
</ul>
</li>
<li>an <code>actionMap</code></li>
</ul>
<p><code>identityActions</code> is an optional list of positional string arguments that are action type strings; these action types will use the identity payload creator.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; actionOne, actionTwo, actionThree &#125; = createActions(&#123;</div><div class="line">  <span class="comment">// function form; payload creator defined inline</span></div><div class="line">  ACTION_ONE: <span class="function">(<span class="params">key, value</span>) =&gt;</span> (&#123; [key]: value &#125;),</div><div class="line"></div><div class="line">  <span class="comment">// array form</span></div><div class="line">  ACTION_TWO: [</div><div class="line">    <span class="function">(<span class="params">first</span>) =&gt;</span> [first],             <span class="comment">// payload</span></div><div class="line">    (first, second) =&gt; (&#123; second &#125;) <span class="comment">// meta</span></div><div class="line">  ],</div><div class="line"></div><div class="line">  <span class="comment">// trailing action type string form; payload creator is the identity</span></div><div class="line">&#125;, <span class="string">'ACTION_THREE'</span>);</div><div class="line"></div><div class="line">expect(actionOne(<span class="string">'key'</span>, <span class="number">1</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'ACTION_ONE'</span>,</div><div class="line">  <span class="attr">payload</span>: &#123; <span class="attr">key</span>: <span class="number">1</span> &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">expect(actionTwo(<span class="string">'first'</span>, <span class="string">'second'</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'ACTION_TWO'</span>,</div><div class="line">  <span class="attr">payload</span>: [<span class="string">'first'</span>],</div><div class="line">  <span class="attr">meta</span>: &#123; <span class="attr">second</span>: <span class="string">'second'</span> &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">expect(actionThree(<span class="number">3</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'ACTION_THREE'</span>,</div><div class="line">  <span class="attr">payload</span>: <span class="number">3</span>,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>If <code>actionMap</code> has a recursive structure, its leaves are used as payload and meta creators, and the action type for each leaf is the combined path to that leaf:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> actionCreators = createActions(&#123;</div><div class="line">  <span class="attr">APP</span>: &#123;</div><div class="line">    <span class="attr">COUNTER</span>: &#123;</div><div class="line">      <span class="attr">INCREMENT</span>: [</div><div class="line">        <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; amount &#125;),</div><div class="line">        amount =&gt; (&#123; <span class="attr">key</span>: <span class="string">'value'</span>, amount &#125;)</div><div class="line">      ],</div><div class="line">      <span class="attr">DECREMENT</span>: <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; <span class="attr">amount</span>: -amount &#125;)</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">NOTIFY</span>: [</div><div class="line">      <span class="function">(<span class="params">username, message</span>) =&gt;</span> (&#123; <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;username&#125;</span>: <span class="subst">$&#123;message&#125;</span>`</span> &#125;),</div><div class="line">      (username, message) =&gt; (&#123; username, message &#125;)</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">expect(actionCreators.app.counter.increment(<span class="number">1</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'APP/COUNTER/INCREMENT'</span>,</div><div class="line">  <span class="attr">payload</span>: &#123; <span class="attr">amount</span>: <span class="number">1</span> &#125;,</div><div class="line">  <span class="attr">meta</span>: &#123; <span class="attr">key</span>: <span class="string">'value'</span>, <span class="attr">amount</span>: <span class="number">1</span> &#125;</div><div class="line">&#125;);</div><div class="line">expect(actionCreators.app.counter.decrement(<span class="number">1</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'APP/COUNTER/DECREMENT'</span>,</div><div class="line">  <span class="attr">payload</span>: &#123; <span class="attr">amount</span>: <span class="number">-1</span> &#125;</div><div class="line">&#125;);</div><div class="line">expect(actionCreators.app.notify(<span class="string">'yangmillstheory'</span>, <span class="string">'Hello World'</span>)).to.deep.equal(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'APP/NOTIFY'</span>,</div><div class="line">  <span class="attr">payload</span>: &#123; <span class="attr">message</span>: <span class="string">'yangmillstheory: Hello World'</span> &#125;,</div><div class="line">  <span class="attr">meta</span>: &#123; <span class="attr">username</span>: <span class="string">'yangmillstheory'</span>, <span class="attr">message</span>: <span class="string">'Hello World'</span> &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>When using this form, you can pass an object with key <code>namespace</code> as the last positional argument, instead of the default <code>/</code>.</p>
<h3 id="handleAction-type-reducer-reducerMap-Identity-defaultState"><a href="#handleAction-type-reducer-reducerMap-Identity-defaultState" class="headerlink" title="handleAction(type, reducer | reducerMap = Identity, defaultState)"></a><code>handleAction(type, reducer | reducerMap = Identity, defaultState)</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; handleAction &#125; <span class="keyword">from</span> <span class="string">'redux-actions'</span>;</div></pre></td></tr></table></figure>
<p>Wraps a reducer so that it only handles Flux Standard Actions of a certain type.</p>
<p>If a <code>reducer</code> function is passed, it is used to handle both normal actions and failed actions. (A failed action is analogous to a rejected promise.) You can use this form if you know a certain type of action will never fail, like the increment example above.</p>
<p>Otherwise, you can specify separate reducers for <code>next()</code> and <code>throw()</code> using the <code>reducerMap</code> form. This API is inspired by the ES6 generator interface.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">handleAction(<span class="string">'FETCH_DATA'</span>, &#123;</div><div class="line">  next(state, action) &#123;...&#125;,</div><div class="line">  <span class="keyword">throw</span>(state, action) &#123;...&#125;</div><div class="line">&#125;, defaultState);</div></pre></td></tr></table></figure>
<p>If either <code>next()</code> or <code>throw()</code> are <code>undefined</code> or <code>null</code>, then the identity function is used for that reducer.</p>
<p>If the reducer argument (<code>reducer | reducerMap</code>) is <code>undefined</code>, then the identity function is used.</p>
<p>The third parameter <code>defaultState</code> is required, and is used when <code>undefined</code> is passed to the reducer.</p>
<h3 id="handleActions-reducerMap-defaultState"><a href="#handleActions-reducerMap-defaultState" class="headerlink" title="handleActions(reducerMap, defaultState)"></a><code>handleActions(reducerMap, defaultState)</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; handleActions &#125; <span class="keyword">from</span> <span class="string">'redux-actions'</span>;</div></pre></td></tr></table></figure>
<p>Creates multiple reducers using <code>handleAction()</code> and combines them into a single reducer that handles multiple actions. Accepts a map where the keys are passed as the first parameter to <code>handleAction()</code> (the action type), and the values are passed as the second parameter (either a reducer or reducer map). The map must not be empty.</p>
<p>The second parameter <code>defaultState</code> is required, and is used when <code>undefined</code> is passed to the reducer.</p>
<p>(Internally, <code>handleActions()</code> works by applying multiple reducers in sequence using <a href="https://github.com/acdlite/reduce-reducers" target="_blank" rel="external">reduce-reducers</a>.)</p>
<p>Example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> reducer = handleActions(&#123;</div><div class="line">  <span class="attr">INCREMENT</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="attr">counter</span>: state.counter + action.payload</div><div class="line">  &#125;),</div><div class="line"></div><div class="line">  <span class="attr">DECREMENT</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="attr">counter</span>: state.counter - action.payload</div><div class="line">  &#125;)</div><div class="line">&#125;, &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;);</div></pre></td></tr></table></figure>
<h3 id="combineActions-types"><a href="#combineActions-types" class="headerlink" title="combineActions(...types)"></a><code>combineActions(...types)</code></h3><p>Combine any number of action types or action creators. <code>types</code> is a list of positional arguments which can be action type strings, symbols, or action creators.</p>
<p>This allows you to reduce multiple distinct actions with the same reducer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; increment, decrement &#125; = createActions(&#123;</div><div class="line">  <span class="attr">INCREMENT</span>: <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; amount &#125;),</div><div class="line">  <span class="attr">DECREMENT</span>: <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; <span class="attr">amount</span>: -amount &#125;),</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> reducer = handleAction(combineActions(increment, decrement), &#123;</div><div class="line">  <span class="attr">next</span>: <span class="function">(<span class="params">state, &#123; payload: &#123; amount &#125; &#125;</span>) =&gt;</span> (&#123; ...state, <span class="attr">counter</span>: state.counter + amount &#125;),</div><div class="line">  <span class="attr">throw</span>: <span class="function"><span class="params">state</span> =&gt;</span> (&#123; ...state, <span class="attr">counter</span>: <span class="number">0</span> &#125;),</div><div class="line">&#125;, &#123; <span class="attr">counter</span>: <span class="number">10</span> &#125;)</div><div class="line"></div><div class="line">expect(reducer(<span class="literal">undefined</span>, increment(<span class="number">1</span>)).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">11</span> &#125;)</div><div class="line">expect(reducer(<span class="literal">undefined</span>, decrement(<span class="number">1</span>)).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">9</span> &#125;)</div><div class="line">expect(reducer(<span class="literal">undefined</span>, increment(<span class="keyword">new</span> <span class="built_in">Error</span>)).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;)</div><div class="line">expect(reducer(<span class="literal">undefined</span>, decrement(<span class="keyword">new</span> <span class="built_in">Error</span>)).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;)</div></pre></td></tr></table></figure>
<p>Hereâ€™s an example using <code>handleActions</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; increment, decrement &#125; = createActions(&#123;</div><div class="line">  <span class="attr">INCREMENT</span>: <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; amount &#125;),</div><div class="line">  <span class="attr">DECREMENT</span>: <span class="function"><span class="params">amount</span> =&gt;</span> (&#123; <span class="attr">amount</span>: -amount &#125;)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> reducer = handleActions(&#123;</div><div class="line">  [combineActions(increment, decrement)](state, &#123; <span class="attr">payload</span>: &#123; amount &#125; &#125;) &#123;</div><div class="line">    <span class="keyword">return</span> &#123; ...state, <span class="attr">counter</span>: state.counter + amount &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;, &#123; <span class="attr">counter</span>: <span class="number">10</span> &#125;);</div><div class="line"></div><div class="line">expect(reducer(&#123; <span class="attr">counter</span>: <span class="number">5</span> &#125;, increment(<span class="number">5</span>))).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">10</span> &#125;);</div><div class="line">expect(reducer(&#123; <span class="attr">counter</span>: <span class="number">5</span> &#125;, decrement(<span class="number">5</span>))).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;);</div><div class="line">expect(reducer(&#123; <span class="attr">counter</span>: <span class="number">5</span> &#125;, &#123; <span class="attr">type</span>: <span class="string">'NOT_TYPE'</span>, <span class="attr">payload</span>: <span class="number">1000</span> &#125;)).to.equal(&#123; <span class="attr">counter</span>: <span class="number">5</span> &#125;);</div><div class="line">expect(reducer(<span class="literal">undefined</span>, increment(<span class="number">5</span>))).to.deep.equal(&#123; <span class="attr">counter</span>: <span class="number">15</span> &#125;);</div></pre></td></tr></table></figure>
<h2 id="Usage-with-middleware"><a href="#Usage-with-middleware" class="headerlink" title="Usage with middleware"></a>Usage with middleware</h2><p>redux-actions is handy all by itself, however, its real power comes when you combine it with middleware.</p>
<p>The identity form of <code>createAction</code> is a great way to create a single action creator that handles multiple payload types. For example, using <a href="https://github.com/acdlite/redux-promise" target="_blank" rel="external">redux-promise</a> and <a href="https://github.com/acdlite/redux-rx" target="_blank" rel="external">redux-rx</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> addTodo = createAction(<span class="string">'ADD_TODO'</span>);</div><div class="line"></div><div class="line"><span class="comment">// A single reducer...</span></div><div class="line">handleAction(<span class="string">'ADD_TODO'</span>, (state = &#123; <span class="attr">todos</span>: [] &#125;, action) =&gt; (&#123;</div><div class="line">  ...state,</div><div class="line">  <span class="attr">todos</span>: [...state.todos, action.payload]</div><div class="line">&#125;));</div><div class="line"></div><div class="line"><span class="comment">// ...that works with all of these forms:</span></div><div class="line"><span class="comment">// (Don't forget to use `bindActionCreators()` or equivalent.</span></div><div class="line"><span class="comment">// I've left that bit out)</span></div><div class="line">addTodo(<span class="string">'Use Redux'</span>)</div><div class="line">addTodo(<span class="built_in">Promise</span>.resolve(<span class="string">'Weep with joy'</span>));</div><div class="line">addTodo(Observable.of(</div><div class="line">  <span class="string">'Learn about middleware'</span>,</div><div class="line">  <span class="string">'Learn about higher-order stores'</span></div><div class="line">)).subscribe();</div></pre></td></tr></table></figure>
<h2 id="See-also"><a href="#See-also" class="headerlink" title="See also"></a>See also</h2><p>Use redux-actions in combination with FSA-compliant libraries.</p>
<ul>
<li><a href="https://github.com/acdlite/redux-promise" target="_blank" rel="external">redux-promise</a> - Promise middleware</li>
<li><a href="https://github.com/acdlite/redux-rx" target="_blank" rel="external">redux-rx</a> - Includes observable middleware.</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;redux-actions&quot;&gt;&lt;a href=&quot;#redux-actions&quot; class=&quot;headerlink&quot; title=&quot;redux-actions&quot;&gt;&lt;/a&gt;redux-actions&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://travis-ci
    
    </summary>
    
      <category term="Readme" scheme="http://yoursite.com/categories/Readme/"/>
    
    
      <category term="è½¬è½½" scheme="http://yoursite.com/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>React-Native-Immutable</title>
    <link href="http://yoursite.com/2017/03/27/React-Native-Immutable/"/>
    <id>http://yoursite.com/2017/03/27/React-Native-Immutable/</id>
    <published>2017-03-27T00:15:12.000Z</published>
    <updated>2017-03-26T16:16:21.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="react-native-immutable"><a href="#react-native-immutable" class="headerlink" title="react-native-immutable"></a>react-native-immutable</h1><p><strong>using immutable.js library as store with react &amp;&amp; react-native</strong></p>
<p>More info of <a href="http://facebook.github.io/immutable-js/" target="_blank" rel="external">immutable.js</a></p>
<hr>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm <span class="keyword">install</span> react-<span class="keyword">native</span>-immutable <span class="comment">--save</span></div></pre></td></tr></table></figure>
<h2 id="Useage"><a href="#Useage" class="headerlink" title="Useage"></a>Useage</h2><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">react-native project</div><div class="line">   <span class="string">|---index.ios.js</span></div><div class="line">   <span class="string">|---App</span></div><div class="line">         <span class="string">|---Actions</span></div><div class="line">         	   <span class="string">|--- mainAction.js</span></div><div class="line">         	   <span class="string">|--- userAction.js</span></div><div class="line">         	   <span class="string">|--- articleAction.js</span></div><div class="line">         	   <span class="string">|--- ...</span></div><div class="line">         <span class="string">|---Stores</span></div><div class="line">         	   <span class="string">|--- mainStore.js</span></div><div class="line">         	   <span class="string">|--- userStore.js</span></div><div class="line">         	   <span class="string">|--- articleStore.js</span></div><div class="line">         	   <span class="string">|--- ...</span></div><div class="line">         <span class="string">|---Webapi</span></div></pre></td></tr></table></figure>
<h3 id="index-ios-js"><a href="#index-ios-js" class="headerlink" title="index.ios.js"></a>index.ios.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react-native'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; mixins &#125; = <span class="built_in">require</span>(<span class="string">'react-native-immutable'</span>);</div><div class="line"><span class="keyword">var</span> StoreMixin = mixins.StoreMixin;</div><div class="line"><span class="keyword">var</span> appStore = <span class="built_in">require</span>(<span class="string">'./App/Stores/mainStore'</span>);</div><div class="line"><span class="keyword">var</span> appAction = <span class="built_in">require</span>(<span class="string">'./App/Actions/mainAction'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;</div><div class="line">  AppRegistry,</div><div class="line">  StyleSheet,</div><div class="line">  View,</div><div class="line">  Text</div><div class="line">&#125; = React;</div><div class="line"></div><div class="line"><span class="keyword">var</span> App = React.createClass(&#123;</div><div class="line">    <span class="attr">mixins</span>: [StoreMixin(appStore,<span class="string">"user"</span>,<span class="string">"article"</span>)],</div><div class="line">    <span class="attr">onChangeUserName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    	appAction.emit(<span class="string">'onChangeUserName'</span>, <span class="string">"wilson"</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        </div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state);  <span class="comment">// when store was changed, the state will change;</span></div><div class="line">        </div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.username)</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> (</div><div class="line">        	<span class="xml"><span class="tag">&lt;<span class="name">View</span>&gt;</span></span></div><div class="line">        		<span class="tag">&lt;<span class="name">Text</span> <span class="attr">onPress</span>=<span class="string">&#123;this.onChangeUserName&#125;</span>&gt;</span>Change user name<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">        	<span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">        )   </div><div class="line">    &#125; </div><div class="line">&#125;);</div><div class="line">    </div><div class="line">    </div><div class="line">AppRegistry.registerComponent(<span class="string">'DEMO'</span>, () =&gt; App);</div></pre></td></tr></table></figure>
<h3 id="mainAction-js"><a href="#mainAction-js" class="headerlink" title="mainAction.js"></a>mainAction.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;Action&#125; = <span class="built_in">require</span>(<span class="string">'react-native-immutable'</span>);</div><div class="line"></div><div class="line"><span class="comment">// require userAction</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'./userAction'</span>)();</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// require articleAction</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'./articleAction'</span>)();</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = Action;</div></pre></td></tr></table></figure>
<h3 id="userAction-js"><a href="#userAction-js" class="headerlink" title="userAction.js"></a>userAction.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> Immutable = <span class="built_in">require</span>(<span class="string">'immutable'</span>);</div><div class="line"><span class="keyword">var</span> &#123;Action&#125; = <span class="built_in">require</span>(<span class="string">'react-native-immutable'</span>);</div><div class="line"><span class="keyword">var</span> appStore = <span class="built_in">require</span>(<span class="string">'../Stores/mainStore'</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ›´æ–°ç®¡ç†å‘˜</span></div><div class="line"><span class="keyword">var</span> userAction = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	Action.on(<span class="string">'onChangeUserName'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">		<span class="comment">// study immutable.js visit http://facebook.github.io/immutable-js/</span></div><div class="line">    	appStore.getStore(<span class="string">"user"</span>).set(<span class="string">'name'</span>, name );</div><div class="line">	&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = userAction;</div></pre></td></tr></table></figure>
<h3 id="mainStore-js"><a href="#mainStore-js" class="headerlink" title="mainStore.js"></a>mainStore.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> Immutable = <span class="built_in">require</span>(<span class="string">'immutable'</span>);</div><div class="line"><span class="keyword">var</span> &#123;Store,Action&#125; = <span class="built_in">require</span>(<span class="string">'react-native-immutable'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react-native'</span>);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> appStore = <span class="built_in">module</span>.exports = Store(&#123;</div><div class="line">    <span class="attr">user</span>: <span class="built_in">require</span>(<span class="string">'./userStore'</span>),</div><div class="line">    <span class="attr">article</span>: <span class="built_in">require</span>(<span class="string">'./articleStore'</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Use AsyncStorage if u what</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;</div><div class="line">    AsyncStorage</div><div class="line">&#125; = React;</div><div class="line"></div><div class="line"><span class="keyword">var</span> db_name = <span class="string">"app_store"</span>;</div><div class="line"></div><div class="line">Action.on(<span class="string">"_updateStore"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    AsyncStorage.setItem(db_name, <span class="built_in">JSON</span>.stringify(data), <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (err) &#123;</div><div class="line">            <span class="built_in">console</span>.error(<span class="string">"error"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//initial Data</span></div><div class="line">AsyncStorage.getItem(db_name, <span class="function"><span class="keyword">function</span>(<span class="params">err, res</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.error(<span class="string">"error"</span>)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span>( <span class="keyword">typeof</span> res == <span class="literal">undefined</span> )&#123;</div><div class="line">            Action.emit(<span class="string">"_updateStore"</span>,appStore.getData());</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            appStore = Immutable.fromJS(<span class="built_in">JSON</span>.parse(res));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="userStore-js"><a href="#userStore-js" class="headerlink" title="userStore.js"></a>userStore.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">''</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;react-native-immutable&quot;&gt;&lt;a href=&quot;#react-native-immutable&quot; class=&quot;headerlink&quot; title=&quot;react-native-immutable&quot;&gt;&lt;/a&gt;react-native-immutab
    
    </summary>
    
      <category term="Readme" scheme="http://yoursite.com/categories/Readme/"/>
    
    
      <category term="è½¬è½½" scheme="http://yoursite.com/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>Immutable.js-doc</title>
    <link href="http://yoursite.com/2017/03/26/Immutable-js/"/>
    <id>http://yoursite.com/2017/03/26/Immutable-js/</id>
    <published>2017-03-26T14:05:27.000Z</published>
    <updated>2017-03-26T06:06:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Immutable-collections-for-JavaScript"><a href="#Immutable-collections-for-JavaScript" class="headerlink" title="Immutable collections for JavaScript"></a>Immutable collections for JavaScript</h1><p><a href="https://travis-ci.org/facebook/immutable-js" target="_blank" rel="external"><img src="https://travis-ci.org/facebook/immutable-js.svg?branch=master" alt="Build Status"></a></p>
<p><a href="http://en.wikipedia.org/wiki/Immutable_object" target="_blank" rel="external">Immutable</a> data cannot be changed once created, leading to much simpler<br>application development, no defensive copying, and enabling advanced memoization<br>and change detection techniques with simple logic. <a href="http://en.wikipedia.org/wiki/Persistent_data_structure" target="_blank" rel="external">Persistent</a> data presents<br>a mutative API which does not update the data in-place, but instead always<br>yields new updated data.</p>
<p>Immutable.js provides many Persistent Immutable data structures including:<br><code>List</code>, <code>Stack</code>, <code>Map</code>, <code>OrderedMap</code>, <code>Set</code>, <code>OrderedSet</code> and <code>Record</code>.</p>
<p>These data structures are highly efficient on modern JavaScript VMs by using<br>structural sharing via <a href="http://en.wikipedia.org/wiki/Hash_array_mapped_trie" target="_blank" rel="external">hash maps tries</a> and <a href="http://hypirion.com/musings/understanding-persistent-vector-pt-1" target="_blank" rel="external">vector tries</a> as popularized<br>by Clojure and Scala, minimizing the need to copy or cache data.</p>
<p>Immutable.js also provides a lazy <code>Seq</code>, allowing efficient<br>chaining of collection methods like <code>map</code> and <code>filter</code> without creating<br>intermediate representations. Create some <code>Seq</code> with <code>Range</code> and <code>Repeat</code>.</p>
<p>Want to hear more? Watch the presentation about Immutable.js:</p>
<p><a href="https://youtu.be/I7IdS-PbEgI" target="_blank" alt="Immutable Data and React"><img src="https://img.youtube.com/vi/I7IdS-PbEgI/0.jpg"></a></p>
<h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><p>Install <code>immutable</code> using npm.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install immutable</div></pre></td></tr></table></figure>
<p>Then require it into any module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)</div><div class="line"><span class="keyword">const</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>)</div><div class="line">map1.get(<span class="string">'b'</span>) <span class="comment">// 2</span></div><div class="line">map2.get(<span class="string">'b'</span>) <span class="comment">// 50</span></div></pre></td></tr></table></figure>
<h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><p>To use Immutable.js from a browser, download <a href="https://github.com/facebook/immutable-js/blob/master/dist/immutable.min.js" target="_blank" rel="external">dist/immutable.min.js</a><br>or use a CDN such as <a href="https://cdnjs.com/libraries/immutable" target="_blank" rel="external">CDNJS</a><br>or <a href="http://www.jsdelivr.com/#!immutable.js" target="_blank" rel="external">jsDelivr</a>.</p>
<p>Then, add it as a script tag to your page:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"immutable.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript"></span></div><div class="line">    <span class="keyword">var</span> map1 = Immutable.Map(&#123;a:<span class="number">1</span>, b:<span class="number">2</span>, c:<span class="number">3</span>&#125;);</div><div class="line">    <span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">    map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">    map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Or use an AMD loader (such as <a href="http://requirejs.org/" target="_blank" rel="external">RequireJS</a>):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>([<span class="string">'./immutable.min.js'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">Immutable</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line">    <span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">    map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">    map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>If youâ€™re using <a href="https://webpack.github.io/" target="_blank" rel="external">webpack</a> or<br><a href="http://browserify.org/" target="_blank" rel="external">browserify</a>, the <code>immutable</code> npm module also works<br>from the browser.</p>
<h3 id="Flow-amp-TypeScript"><a href="#Flow-amp-TypeScript" class="headerlink" title="Flow &amp; TypeScript"></a>Flow &amp; TypeScript</h3><p>Use these Immutable collections and sequences as you would use native<br>collections in your <a href="https://flowtype.org/" target="_blank" rel="external">Flowtype</a> or <a href="http://typescriptlang.org" target="_blank" rel="external">TypeScript</a> programs while still taking<br>advantage of type generics, error detection, and auto-complete in your IDE.</p>
<p>Installing <code>immutable</code> via npm brings with it type definitions for Flow (v0.39.0 or higher)<br>and TypeScript (v2.1.0 or higher), so you shouldnâ€™t need to do anything at all!</p>
<h4 id="Using-TypeScript-with-Immutable-js-v4"><a href="#Using-TypeScript-with-Immutable-js-v4" class="headerlink" title="Using TypeScript with Immutable.js v4"></a>Using TypeScript with Immutable.js v4</h4><p>Immutable.js type definitions embrace ES2015. While Immutable.js itself supports<br>legacy browsers and environments, its type definitions require TypeScriptâ€™s 2015<br>lib. Include either <code>&quot;target&quot;: &quot;es2015&quot;</code> or <code>&quot;lib&quot;: &quot;es2015&quot;</code> in your<br><code>tsconfig.json</code>, or provide <code>--target es2015</code> or <code>--lib es2015</code> to the<br><code>tsc</code> command.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">"immutable"</span>;</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;);</div><div class="line"><span class="keyword">const</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div></pre></td></tr></table></figure>
<h4 id="Using-TypeScript-with-Immutable-js-v3-and-earlier"><a href="#Using-TypeScript-with-Immutable-js-v3-and-earlier" class="headerlink" title="Using TypeScript with Immutable.js v3 and earlier:"></a>Using TypeScript with Immutable.js v3 and earlier:</h4><p>Previous versions of Immutable.js include a reference file which you can include<br>via relative path to the type definitions at the top of your file.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///&lt;reference path='./node_modules/immutable/dist/immutable.d.ts'/&gt;</span></div><div class="line"><span class="keyword">import</span> Immutable = <span class="built_in">require</span>(<span class="string">'immutable'</span>);</div><div class="line"><span class="keyword">var</span> map1: Immutable.Map&lt;string, number&gt;;</div><div class="line">map1 = Immutable.Map(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;);</div><div class="line"><span class="keyword">var</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>);</div><div class="line">map1.get(<span class="string">'b'</span>); <span class="comment">// 2</span></div><div class="line">map2.get(<span class="string">'b'</span>); <span class="comment">// 50</span></div></pre></td></tr></table></figure>
<h2 id="The-case-for-Immutability"><a href="#The-case-for-Immutability" class="headerlink" title="The case for Immutability"></a>The case for Immutability</h2><p>Much of what makes application development difficult is tracking mutation and<br>maintaining state. Developing with immutable data encourages you to think<br>differently about how data flows through your application.</p>
<p>Subscribing to data events throughout your application creates a huge overhead of<br>book-keeping which can hurt performance, sometimes dramatically, and creates<br>opportunities for areas of your application to get out of sync with each other<br>due to easy to make programmer error. Since immutable data never changes,<br>subscribing to changes throughout the model is a dead-end and new data can only<br>ever be passed from above.</p>
<p>This model of data flow aligns well with the architecture of <a href="http://facebook.github.io/react/" target="_blank" rel="external">React</a><br>and especially well with an application designed using the ideas of <a href="http://facebook.github.io/flux/docs/overview.html" target="_blank" rel="external">Flux</a>.</p>
<p>When data is passed from above rather than being subscribed to, and youâ€™re only<br>interested in doing work when something has changed, you can use equality.</p>
<p>Immutable collections should be treated as <em>values</em> rather than <em>objects</em>. While<br>objects represent some thing which could change over time, a value represents<br>the state of that thing at a particular instance of time. This principle is most<br>important to understanding the appropriate use of immutable data. In order to<br>treat Immutable.js collections as values, itâ€™s important to use the<br><code>Immutable.is()</code> function or <code>.equals()</code> method to determine value equality<br>instead of the <code>===</code> operator which determines object reference identity.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>( &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)</div><div class="line"><span class="keyword">const</span> map2 = map1.set(<span class="string">'b'</span>, <span class="number">2</span>)</div><div class="line">assert(map1.equals(map2) === <span class="literal">true</span>)</div><div class="line"><span class="keyword">const</span> map3 = map1.set(<span class="string">'b'</span>, <span class="number">50</span>)</div><div class="line">assert(map1.equals(map3) === <span class="literal">false</span>)</div></pre></td></tr></table></figure>
<p>Note: As a performance optimization Immutable.js attempts to return the existing<br>collection when an operation would result in an identical collection, allowing<br>for using <code>===</code> reference equality to determine if something definitely has not<br>changed. This can be extremely useful when used within a memoization function<br>which would prefer to re-run the function if a deeper equality check could<br>potentially be more costly. The <code>===</code> equality check is also used internally by<br><code>Immutable.is</code> and <code>.equals()</code> as a performance optimization.</p>
<p>If an object is immutable, it can be â€œcopiedâ€ simply by making another reference<br>to it instead of copying the entire object. Because a reference is much smaller<br>than the object itself, this results in memory savings and a potential boost in<br>execution speed for programs which rely on copies (such as an undo-stack).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)</div><div class="line"><span class="keyword">const</span> clone = map1;</div></pre></td></tr></table></figure>
<h2 id="JavaScript-first-API"><a href="#JavaScript-first-API" class="headerlink" title="JavaScript-first API"></a>JavaScript-first API</h2><p>While Immutable.js is inspired by Clojure, Scala, Haskell and other functional<br>programming environments, itâ€™s designed to bring these powerful concepts to<br>JavaScript, and therefore has an Object-Oriented API that closely mirrors that<br>of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla" target="_blank" rel="external">ES2015</a> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="external">Array</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a>.</p>
<p>The difference for the immutable collections is that methods which would mutate<br>the collection, like <code>push</code>, <code>set</code>, <code>unshift</code> or <code>splice</code> instead return a new<br>immutable collection. Methods which return new arrays like <code>slice</code> or <code>concat</code><br>instead return new immutable collections.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; List &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> list1 = List([ <span class="number">1</span>, <span class="number">2</span> ]);</div><div class="line"><span class="keyword">const</span> list2 = list1.push(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="keyword">const</span> list3 = list2.unshift(<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> list4 = list1.concat(list2, list3);</div><div class="line">assert(list1.size === <span class="number">2</span>);</div><div class="line">assert(list2.size === <span class="number">5</span>);</div><div class="line">assert(list3.size === <span class="number">6</span>);</div><div class="line">assert(list4.size === <span class="number">13</span>);</div><div class="line">assert(list4.get(<span class="number">0</span>) === <span class="number">1</span>);</div></pre></td></tr></table></figure>
<p>Almost all of the methods on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="external">Array</a> will be found in similar form on<br><code>Immutable.List</code>, those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a> found on <code>Immutable.Map</code>, and those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a><br>found on <code>Immutable.Set</code>, including collection operations like <code>forEach()</code><br>and <code>map()</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> alpha = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>, <span class="attr">d</span>: <span class="number">4</span> &#125;);</div><div class="line">alpha.map(<span class="function">(<span class="params">v, k</span>) =&gt;</span> k.toUpperCase()).join();</div><div class="line"><span class="comment">// 'A,B,C,D'</span></div></pre></td></tr></table></figure>
<h3 id="Accepts-raw-JavaScript-objects"><a href="#Accepts-raw-JavaScript-objects" class="headerlink" title="Accepts raw JavaScript objects."></a>Accepts raw JavaScript objects.</h3><p>Designed to inter-operate with your existing JavaScript, Immutable.js<br>accepts plain JavaScript Arrays and Objects anywhere a method expects an<br><code>Collection</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>, <span class="attr">d</span>: <span class="number">4</span> &#125;)</div><div class="line"><span class="keyword">const</span> map2 = <span class="built_in">Map</span>(&#123; <span class="attr">c</span>: <span class="number">10</span>, <span class="attr">a</span>: <span class="number">20</span>, <span class="attr">t</span>: <span class="number">30</span> &#125;)</div><div class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">d</span>: <span class="number">100</span>, <span class="attr">o</span>: <span class="number">200</span>, <span class="attr">g</span>: <span class="number">300</span> &#125;</div><div class="line"><span class="keyword">const</span> map3 = map1.merge(map2, obj);</div><div class="line"><span class="comment">// Map &#123; a: 20, b: 2, c: 10, d: 100, t: 30, o: 200, g: 300 &#125;</span></div></pre></td></tr></table></figure>
<p>This is possible because Immutable.js can treat any JavaScript Array or Object<br>as a Collection. You can take advantage of this in order to get sophisticated<br>collection methods on JavaScript Objects, which otherwise have a very sparse<br>native API. Because Seq evaluates lazily and does not cache intermediate<br>results, these operations can be extremely efficient.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; Seq &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> myObject = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</div><div class="line">Seq(myObject).map(<span class="function"><span class="params">x</span> =&gt;</span> x * x).toObject();</div><div class="line"><span class="comment">// &#123; a: 1, b: 4, c: 9 &#125;</span></div></pre></td></tr></table></figure>
<p>Keep in mind, when using JS objects to construct Immutable Maps, that<br>JavaScript Object properties are always strings, even if written in a quote-less<br>shorthand, while Immutable Maps accept keys of any type.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; fromJS &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> obj = &#123; <span class="number">1</span>: <span class="string">"one"</span> &#125;</div><div class="line"><span class="built_in">Object</span>.keys(obj) <span class="comment">// [ "1" ]</span></div><div class="line">obj[<span class="string">"1"</span>] <span class="comment">// "one"</span></div><div class="line">obj[<span class="number">1</span>]   <span class="comment">// "one"</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> map = fromJS(obj)</div><div class="line">map.get(<span class="string">"1"</span>) <span class="comment">// "one"</span></div><div class="line">map.get(<span class="number">1</span>)   <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>Property access for JavaScript Objects first converts the key to a string, but<br>since Immutable Map keys can be of any type the argument to <code>get()</code> is<br>not altered.</p>
<h3 id="Converts-back-to-raw-JavaScript-objects"><a href="#Converts-back-to-raw-JavaScript-objects" class="headerlink" title="Converts back to raw JavaScript objects."></a>Converts back to raw JavaScript objects.</h3><p>All Immutable.js Collections can be converted to plain JavaScript Arrays and<br>Objects shallowly with <code>toArray()</code> and <code>toObject()</code> or deeply with <code>toJS()</code>.<br>All Immutable Collections also implement <code>toJSON()</code> allowing them to be passed<br>to <code>JSON.stringify</code> directly.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span>, List &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> deep = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: List([ <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ]) &#125;)</div><div class="line">deep.toObject() <span class="comment">// &#123; a: 1, b: 2, c: List [ 3, 4, 5 ] &#125;</span></div><div class="line">deep.toArray() <span class="comment">// [ 1, 2, List [ 3, 4, 5 ] ]</span></div><div class="line">deep.toJS() <span class="comment">// &#123; a: 1, b: 2, c: [ 3, 4, 5 ] &#125;</span></div><div class="line"><span class="built_in">JSON</span>.stringify(deep) <span class="comment">// '&#123;"a":1,"b":2,"c":[3,4,5]&#125;'</span></div></pre></td></tr></table></figure>
<h3 id="Embraces-ES2015"><a href="#Embraces-ES2015" class="headerlink" title="Embraces ES2015"></a>Embraces ES2015</h3><p>Immutable.js supports all JavaScript environments, including legacy<br>browsers (even IE8). However it also takes advantage of features added to<br>JavaScript in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla" target="_blank" rel="external">ES2015</a>, the latest standard version of JavaScript, including<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/The_Iterator_protocol" target="_blank" rel="external">Iterators</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="external">Arrow Functions</a>, <a href="http://wiki.ecmascript.org/doku.php?id=strawman:maximally_minimal_classes" target="_blank" rel="external">Classes</a>, and <a href="http://www.2ality.com/2014/09/es6-modules-final.html" target="_blank" rel="external">Modules</a>. Itâ€™s inspired<br>by the native <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="external">Map</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="external">Set</a> collections added to ES2015.</p>
<p>All examples in the Documentation are presented in ES2015. To run in all<br>browsers, they need to be translated to ES3.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES2015</span></div><div class="line"><span class="keyword">const</span> mapped = foo.map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div><div class="line"><span class="comment">// ES3</span></div><div class="line"><span class="keyword">var</span> mapped = foo.map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x * x; &#125;);</div></pre></td></tr></table></figure>
<h2 id="Nested-Structures"><a href="#Nested-Structures" class="headerlink" title="Nested Structures"></a>Nested Structures</h2><p>The collections in Immutable.js are intended to be nested, allowing for deep<br>trees of data, similar to JSON.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; fromJS &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> nested = fromJS(&#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: [ <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ] &#125; &#125; &#125;)</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ] &#125; &#125; &#125;</span></div></pre></td></tr></table></figure>
<p>A few power-tools allow for reading and operating on nested data. The<br>most useful are <code>mergeDeep</code>, <code>getIn</code>, <code>setIn</code>, and <code>updateIn</code>, found on <code>List</code>,<br><code>Map</code> and <code>OrderedMap</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nested2 = nested.mergeDeep(&#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: &#123; <span class="attr">d</span>: <span class="number">6</span> &#125; &#125; &#125;)</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ], d: 6 &#125; &#125; &#125;</span></div><div class="line"></div><div class="line">nested2.getIn([ <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span> ]) <span class="comment">// 6</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> nested3 = nested2.updateIn([ <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span> ], value =&gt; value + <span class="number">1</span>)</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5 ], d: 7 &#125; &#125; &#125;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> nested4 = nested3.updateIn([ <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span> ], list =&gt; list.push(<span class="number">6</span>))</div><div class="line"><span class="comment">// Map &#123; a: Map &#123; b: Map &#123; c: List [ 3, 4, 5, 6 ], d: 7 &#125; &#125; &#125;</span></div></pre></td></tr></table></figure>
<h2 id="Lazy-Seq"><a href="#Lazy-Seq" class="headerlink" title="Lazy Seq"></a>Lazy Seq</h2><p><code>Seq</code> describes a lazy operation, allowing them to efficiently chain<br>use of all the sequence methods (such as <code>map</code> and <code>filter</code>).</p>
<p><strong>Seq is immutable</strong> â€” Once a Seq is created, it cannot be<br>changed, appended to, rearranged or otherwise modified. Instead, any mutative<br>method called on a Seq will return a new Seq.</p>
<p><strong>Seq is lazy</strong> â€” Seq does as little work as necessary to respond to any<br>method call.</p>
<p>For example, the following does not perform any work, because the resulting<br>Seq is never used:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; Seq &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> oddSquares = Seq([ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span> ])</div><div class="line">  .filter(<span class="function"><span class="params">x</span> =&gt;</span> x % <span class="number">2</span>)</div><div class="line">  .map(<span class="function"><span class="params">x</span> =&gt;</span> x * x)</div></pre></td></tr></table></figure>
<p>Once the Seq is used, it performs only the work necessary. In this<br>example, no intermediate arrays are ever created, filter is called three times,<br>and map is only called once:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(oddSquares.get(<span class="number">1</span>)); <span class="comment">// 9</span></div></pre></td></tr></table></figure>
<p>Any collection can be converted to a lazy Seq with <code>.toSeq()</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span> &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> seq = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;).toSeq()</div></pre></td></tr></table></figure>
<p>Seq allows for the efficient chaining of sequence operations, especially when<br>converting to a different concrete type (such as to a JS object):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">seq.flip().map(<span class="function"><span class="params">key</span> =&gt;</span> key.toUpperCase()).flip().toObject();</div><div class="line"><span class="comment">// &#123; A: 1, B: 1, C: 1 &#125;</span></div></pre></td></tr></table></figure>
<p>As well as expressing logic that would otherwise seem memory-limited:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; Range &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line">Range(<span class="number">1</span>, <span class="literal">Infinity</span>)</div><div class="line">  .skip(<span class="number">1000</span>)</div><div class="line">  .map(<span class="function"><span class="params">n</span> =&gt;</span> -n)</div><div class="line">  .filter(<span class="function"><span class="params">n</span> =&gt;</span> n % <span class="number">2</span> === <span class="number">0</span>)</div><div class="line">  .take(<span class="number">2</span>)</div><div class="line">  .reduce(<span class="function">(<span class="params">r, n</span>) =&gt;</span> r * n, <span class="number">1</span>);</div><div class="line"><span class="comment">// 1006008</span></div></pre></td></tr></table></figure>
<p>Note: A Collection is always iterated in the same order, however that order may<br>not always be well defined, as is the case for the <code>Map</code>.</p>
<h2 id="Equality-treats-Collections-as-Data"><a href="#Equality-treats-Collections-as-Data" class="headerlink" title="Equality treats Collections as Data"></a>Equality treats Collections as Data</h2><p>Immutable.js provides equality which treats immutable data structures as pure<br>data, performing a deep equality check if necessary.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span>, is &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> map1 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)</div><div class="line"><span class="keyword">const</span> map2 = <span class="built_in">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)</div><div class="line">assert(map1 !== map2) <span class="comment">// two different instances</span></div><div class="line">assert(is(map1, map2)) <span class="comment">// have equivalent values</span></div><div class="line">assert(map1.equals(map2)) <span class="comment">// alternatively use the equals method</span></div></pre></td></tr></table></figure>
<p><code>Immutable.is()</code> uses the same measure of equality as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="external">Object.is</a><br>including if both are immutable and all keys and values are equal<br>using the same measure of equality.</p>
<h2 id="Batching-Mutations"><a href="#Batching-Mutations" class="headerlink" title="Batching Mutations"></a>Batching Mutations</h2><blockquote>
<p>If a tree falls in the woods, does it make a sound?</p>
<p>If a pure function mutates some local data in order to produce an immutable<br>return value, is that ok?</p>
<p>â€” Rich Hickey, Clojure</p>
</blockquote>
<p>Applying a mutation to create a new immutable object results in some overhead,<br>which can add up to a minor performance penalty. If you need to apply a series<br>of mutations locally before returning, Immutable.js gives you the ability to<br>create a temporary mutable (transient) copy of a collection and apply a batch of<br>mutations in a performant manner by using <code>withMutations</code>. In fact, this is<br>exactly how  Immutable.js applies complex mutations itself.</p>
<p>As an example, building <code>list2</code> results in the creation of 1, not 3, new<br>immutable Lists.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; List &#125; = <span class="built_in">require</span>(<span class="string">'immutable'</span>)</div><div class="line"><span class="keyword">const</span> list1 = List([ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]);</div><div class="line"><span class="keyword">const</span> list2 = list1.withMutations(<span class="function"><span class="keyword">function</span> (<span class="params">list</span>) </span>&#123;</div><div class="line">  list.push(<span class="number">4</span>).push(<span class="number">5</span>).push(<span class="number">6</span>);</div><div class="line">&#125;);</div><div class="line">assert(list1.size === <span class="number">3</span>);</div><div class="line">assert(list2.size === <span class="number">6</span>);</div></pre></td></tr></table></figure>
<p>Note: Immutable.js also provides <code>asMutable</code> and <code>asImmutable</code>, but only<br>encourages their use when <code>withMutations</code> will not suffice. Use caution to not<br>return a mutable copy, which could result in undesired behavior.</p>
<p><em>Important!</em>: Only a select few methods can be used in <code>withMutations</code> including<br><code>set</code>, <code>push</code> and <code>pop</code>. These methods can be applied directly against a<br>persistent data-structure where other methods like <code>map</code>, <code>filter</code>, <code>sort</code>,<br>and <code>splice</code> will always return new immutable data-structures and never mutate<br>a mutable collection.</p>
<h2 id="Documentation"><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h2><p><a href="http://facebook.github.io/immutable-js/docs/" target="_blank" rel="external">Read the docs</a> and eat your vegetables.</p>
<p>Docs are automatically generated from <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts" target="_blank" rel="external">Immutable.d.ts</a>.<br>Please contribute!</p>
<p>Also, donâ€™t miss the <a href="https://github.com/facebook/immutable-js/wiki" target="_blank" rel="external">Wiki</a> which<br>contains articles on specific topics. Canâ€™t find something? Open an <a href="https://github.com/facebook/immutable-js/issues" target="_blank" rel="external">issue</a>.</p>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><p>If you are using the <a href="http://chaijs.com/" target="_blank" rel="external">Chai Assertion Library</a>, <a href="https://github.com/astorije/chai-immutable" target="_blank" rel="external">Chai Immutable</a> provides a set of assertions to use against Immutable.js collections.</p>
<h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><p>Use <a href="https://github.com/facebook/immutable-js/issues" target="_blank" rel="external">Github issues</a> for requests.</p>
<p>We actively welcome pull requests, learn how to <a href="./CONTRIBUTING.md">contribute</a>.</p>
<h2 id="Changelog"><a href="#Changelog" class="headerlink" title="Changelog"></a>Changelog</h2><p>Changes are tracked as <a href="https://github.com/facebook/immutable-js/releases" target="_blank" rel="external">Github releases</a>.</p>
<h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a href="https://www.youtube.com/watch?v=K2NYwP90bNs" target="_blank" rel="external">Phil Bagwell</a>, for his inspiration<br>and research in persistent data structures.</p>
<p><a href="https://github.com/hughfdjackson/" target="_blank" rel="external">Hugh Jackson</a>, for providing the npm package<br>name. If youâ€™re looking for his unsupported package, see <a href="https://github.com/hughfdjackson/immutable" target="_blank" rel="external">this repository</a>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>Immutable.js is <a href="https://github.com/facebook/immutable-js/blob/master/LICENSE" target="_blank" rel="external">BSD-licensed</a>. We also provide an additional <a href="https://github.com/facebook/immutable-js/blob/master/PATENTS" target="_blank" rel="external">patent grant</a>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Immutable-collections-for-JavaScript&quot;&gt;&lt;a href=&quot;#Immutable-collections-for-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;Immutable collection
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>paserServer-Dashboard</title>
    <link href="http://yoursite.com/2017/03/26/paserServer-Dashboard/"/>
    <id>http://yoursite.com/2017/03/26/paserServer-Dashboard/</id>
    <published>2017-03-26T10:59:38.000Z</published>
    <updated>2017-03-26T03:02:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Parse-Dashboard"><a href="#Parse-Dashboard" class="headerlink" title="Parse Dashboard"></a>Parse Dashboard</h1><p><a href="https://travis-ci.org/ParsePlatform/parse-dashboard" target="_blank" rel="external"><img src="https://img.shields.io/travis/ParsePlatform/parse-dashboard/master.svg?style=flat" alt="Build Status"></a><br><a href="https://www.npmjs.com/package/parse-dashboard" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/parse-dashboard.svg?style=flat" alt="npm version"></a></p>
<p>Parse Dashboard is a standalone dashboard for managing your Parse apps. You can use it to manage your <a href="https://github.com/ParsePlatform/parse-server" target="_blank" rel="external">Parse Server</a> apps and your apps that are running on <a href="https://Parse.com" target="_blank" rel="external">Parse.com</a>.</p>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#local-installation">Local Installation</a><ul>
<li><a href="#configuring-parse-dashboard">Configuring Parse Dashboard</a></li>
<li><a href="#managing-multiple-apps">Managing Multiple Apps</a></li>
<li><a href="#other-configuration-options">Other Configuration Options</a></li>
</ul>
</li>
<li><a href="#running-as-express-middleware">Running as Express Middleware</a></li>
<li><a href="#deploying-parse-dashboard">Deploying Parse Dashboard</a><ul>
<li><a href="#preparing-for-deployment">Preparing for Deployment</a></li>
<li><a href="#security-considerations">Security Considerations</a><ul>
<li><a href="#configuring-basic-authentication">Configuring Basic Authentication</a></li>
<li><a href="#separating-app-access-based-on-user-identity">Separating App Access Based on User Identity</a></li>
</ul>
</li>
<li><a href="#run-with-docker">Run with Docker</a></li>
</ul>
</li>
<li><a href="#contributing">Contributing</a></li>
</ul>
<h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p><a href="https://nodejs.org" target="_blank" rel="external">Node.js</a> version &gt;= 4.3 is required to run the dashboard. You also need to be using Parse Server version 2.1.4 or higher.</p>
<h1 id="Local-Installation"><a href="#Local-Installation" class="headerlink" title="Local Installation"></a>Local Installation</h1><p>Install the dashboard from <code>npm</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> -g <span class="keyword">parse</span>-dashboard</div></pre></td></tr></table></figure>
<p>You can launch the dashboard for an app with a single command by supplying an app ID, master key, URL, and name like this:</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">parse-dashboard </span><span class="built_in">--appId</span> <span class="string">yourAppId </span><span class="built_in">--masterKey</span> <span class="string">yourMasterKey </span><span class="built_in">--serverURL</span> <span class="string">"https://example.com/parse"</span> <span class="built_in">--appName</span> <span class="string">optionalName</span></div></pre></td></tr></table></figure>
<p>You may set the host, port and mount path by supplying the <code>--host</code>, <code>--port</code> and <code>--mountPath</code> options to parse-dashboard. You can use anything you want as the app name, or leave it out in which case the app ID will be used.</p>
<p>After starting the dashboard, you can visit <a href="http://localhost:4040" target="_blank" rel="external">http://localhost:4040</a> in your browser:</p>
<p><img src=".github/dash-shot.png" alt="Parse Dashboard"></p>
<h2 id="Configuring-Parse-Dashboard"><a href="#Configuring-Parse-Dashboard" class="headerlink" title="Configuring Parse Dashboard"></a>Configuring Parse Dashboard</h2><h3 id="File"><a href="#File" class="headerlink" title="File"></a>File</h3><p>You can also start the dashboard from the command line with a config file.  To do this, create a new file called <code>parse-dashboard-config.json</code> inside your local Parse Dashboard directory hierarchy.  The file should match the following format:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"apps"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"serverURL"</span>: <span class="string">"http://localhost:1337/parse"</span>,</div><div class="line">      <span class="attr">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="attr">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="attr">"appName"</span>: <span class="string">"MyApp"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>You can then start the dashboard using <code>parse-dashboard --config parse-dashboard-config.json</code>.</p>
<h3 id="Environment-variables"><a href="#Environment-variables" class="headerlink" title="Environment variables"></a>Environment variables</h3><blockquote>
<p>This only works when starting the app using the <code>parse-dashboard</code> command</p>
</blockquote>
<p>There are also two methods you can use to configure the dashboard using environment variables.</p>
<h4 id="Multiple-apps"><a href="#Multiple-apps" class="headerlink" title="Multiple apps"></a>Multiple apps</h4><p>Provide the entire JSON configuration in <code>PARSE_DASHBOARD_CONFIG</code> and it will be parsed just like the config file.</p>
<h4 id="Single-app"><a href="#Single-app" class="headerlink" title="Single app"></a>Single app</h4><p>You can also define each configuration option individually.</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">HOST:</span> <span class="string">"0.0.0.0"</span></div><div class="line"><span class="symbol">PORT:</span> <span class="string">"4040"</span></div><div class="line"><span class="symbol">MOUNT_PATH:</span> <span class="string">"/"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_TRUST_PROXY:</span> undefined <span class="comment">// Or "1" to trust connection info from a proxy's X-Forwarded-* headers</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_SERVER_URL:</span> <span class="string">"http://localhost:1337/parse"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_MASTER_KEY:</span> <span class="string">"myMasterKey"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_APP_ID:</span> <span class="string">"myAppId"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_APP_NAME:</span> <span class="string">"MyApp"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_USER_ID:</span> <span class="string">"user1"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_USER_PASSWORD:</span> <span class="string">"pass"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_SSL_KEY:</span> <span class="string">"sslKey"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_SSL_CERT:</span> <span class="string">"sslCert"</span></div><div class="line"><span class="symbol">PARSE_DASHBOARD_CONFIG:</span> undefined <span class="comment">// Only for reference, it must not exist</span></div></pre></td></tr></table></figure>
<h2 id="Managing-Multiple-Apps"><a href="#Managing-Multiple-Apps" class="headerlink" title="Managing Multiple Apps"></a>Managing Multiple Apps</h2><p>Managing multiple apps from the same dashboard is also possible.  Simply add additional entries into the <code>parse-dashboard-config.json</code> fileâ€™s <code>&quot;apps&quot;</code> array.</p>
<p>You can manage self-hosted <a href="https://github.com/ParsePlatform/parse-server" target="_blank" rel="external">Parse Server</a> apps, <em>and</em> apps that are hosted on <a href="http://parse.com/" target="_blank" rel="external">Parse.com</a> from the same dashboard. In your config file, you will need to add the <code>restKey</code> and <code>javascriptKey</code> as well as the other paramaters, which you can find on <code>dashboard.parse.com</code>. Set the serverURL to <code>http://api.parse.com/1</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"apps"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"serverURL"</span>: <span class="string">"https://api.parse.com/1"</span>, <span class="comment">// Hosted on Parse.com</span></div><div class="line">      <span class="string">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="string">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="string">"javascriptKey"</span>: <span class="string">"myJavascriptKey"</span>,</div><div class="line">      <span class="string">"restKey"</span>: <span class="string">"myRestKey"</span>,</div><div class="line">      <span class="string">"appName"</span>: <span class="string">"My Parse.Com App"</span>,</div><div class="line">      <span class="string">"production"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"serverURL"</span>: <span class="string">"http://localhost:1337/parse"</span>, <span class="comment">// Self-hosted Parse Server</span></div><div class="line">      <span class="string">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="string">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="string">"appName"</span>: <span class="string">"My Parse Server App"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="App-Icon-Configuration"><a href="#App-Icon-Configuration" class="headerlink" title="App Icon Configuration"></a>App Icon Configuration</h2><p>Parse Dashboard supports adding an optional icon for each app, so you can identify them easier in the list. To do so, you <em>must</em> use the configuration file, define an <code>iconsFolder</code> in it, and define the <code>iconName</code> parameter for each app (including the extension). The path of the <code>iconsFolder</code> is relative to the configuration file. If you have installed ParseDashboard globally you need to use the full path as value for the <code>iconsFolder</code>. To visualize what it means, in the following example <code>icons</code> is a directory located under the same directory as the configuration file:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"apps"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"serverURL"</span>: <span class="string">"http://localhost:1337/parse"</span>,</div><div class="line">      <span class="attr">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="attr">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="attr">"appName"</span>: <span class="string">"My Parse Server App"</span>,</div><div class="line">      <span class="attr">"iconName"</span>: <span class="string">"MyAppIcon.png"</span>,</div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"iconsFolder"</span>: <span class="string">"icons"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Other-Configuration-Options"><a href="#Other-Configuration-Options" class="headerlink" title="Other Configuration Options"></a>Other Configuration Options</h2><p>You can set <code>appNameForURL</code> in the config file for each app to control the url of your app within the dashboard. This can make it easier to use bookmarks or share links on your dashboard.</p>
<p>To change the app to production, simply set <code>production</code> to <code>true</code> in your config file. The default value is false if not specified.</p>
<h1 id="Running-as-Express-Middleware"><a href="#Running-as-Express-Middleware" class="headerlink" title="Running as Express Middleware"></a>Running as Express Middleware</h1><p>Instead of starting Parse Dashboard with the CLI, you can also run it as an <a href="https://github.com/expressjs/express" target="_blank" rel="external">express</a> middleware.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="keyword">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> ParseDashboard = <span class="keyword">require</span>(<span class="string">'parse-dashboard'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> dashboard = <span class="keyword">new</span> ParseDashboard(&#123;</div><div class="line">  <span class="string">"apps"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"serverURL"</span>: <span class="string">"http://localhost:1337/parse"</span>,</div><div class="line">      <span class="string">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="string">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="string">"appName"</span>: <span class="string">"MyApp"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="comment">// make the Parse Dashboard available at /dashboard</span></div><div class="line">app.<span class="keyword">use</span>(<span class="string">'/dashboard'</span>, dashboard);</div><div class="line"></div><div class="line"><span class="keyword">var</span> httpServer = <span class="keyword">require</span>(<span class="string">'http'</span>).createServer(app);</div><div class="line">httpServer.listen(<span class="number">4040</span>);</div></pre></td></tr></table></figure>
<p>If you want to run both <a href="https://github.com/ParsePlatform/parse-server" target="_blank" rel="external">Parse Server</a> and Parse Dashboard on the same server/port, you can run them both as express middleware:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="keyword">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> ParseServer = <span class="keyword">require</span>(<span class="string">'parse-server'</span>).ParseServer;</div><div class="line"><span class="keyword">var</span> ParseDashboard = <span class="keyword">require</span>(<span class="string">'parse-dashboard'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> allowInsecureHTTP = <span class="keyword">false</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> api = <span class="keyword">new</span> ParseServer(&#123;</div><div class="line">	<span class="comment">// Parse Server settings</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> dashboard = <span class="keyword">new</span> ParseDashboard(&#123;</div><div class="line">	<span class="comment">// Parse Dashboard settings</span></div><div class="line">&#125;, allowInsecureHTTP);</div><div class="line"></div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="comment">// make the Parse Server available at /parse</span></div><div class="line">app.<span class="keyword">use</span>(<span class="string">'/parse'</span>, api);</div><div class="line"></div><div class="line"><span class="comment">// make the Parse Dashboard available at /dashboard</span></div><div class="line">app.<span class="keyword">use</span>(<span class="string">'/dashboard'</span>, dashboard);</div><div class="line"></div><div class="line"><span class="keyword">var</span> httpServer = <span class="keyword">require</span>(<span class="string">'http'</span>).createServer(app);</div><div class="line">httpServer.listen(<span class="number">4040</span>);</div></pre></td></tr></table></figure>
<h1 id="Deploying-Parse-Dashboard"><a href="#Deploying-Parse-Dashboard" class="headerlink" title="Deploying Parse Dashboard"></a>Deploying Parse Dashboard</h1><h2 id="Preparing-for-Deployment"><a href="#Preparing-for-Deployment" class="headerlink" title="Preparing for Deployment"></a>Preparing for Deployment</h2><p>Make sure the server URLs for your apps can be accessed by your browser. If you are deploying the dashboard, then <code>localhost</code> urls will not work.</p>
<h2 id="Security-Considerations"><a href="#Security-Considerations" class="headerlink" title="Security Considerations"></a>Security Considerations</h2><p>In order to securely deploy the dashboard without leaking your apps master key, you will need to use HTTPS and Basic Authentication.</p>
<p>The deployed dashboard detects if you are using a secure connection. If you are deploying the dashboard behind a load balancer or front-facing proxy, then the app wonâ€™t be able to detect that the connection is secure. In this case, you can start the dashboard with the <code>--trustProxy=1</code> option (or set the PARSE_DASHBOARD_TRUST_PROXY config var to 1) to rely on the X-Forwarded-* headers for the clientâ€™s connection security.  This is useful for hosting on services like Heroku, where you can trust the provided proxy headers to correctly determine whether youâ€™re using HTTP or HTTPS.  You can also turn on this setting when using the dashboard as <a href="https://github.com/expressjs/express" target="_blank" rel="external">express</a> middleware:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> trustProxy = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> dashboard = <span class="keyword">new</span> ParseDashboard(&#123;</div><div class="line">  <span class="string">"apps"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"serverURL"</span>: <span class="string">"http://localhost:1337/parse"</span>,</div><div class="line">      <span class="string">"appId"</span>: <span class="string">"myAppId"</span>,</div><div class="line">      <span class="string">"masterKey"</span>: <span class="string">"myMasterKey"</span>,</div><div class="line">      <span class="string">"appName"</span>: <span class="string">"MyApp"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="string">"trustProxy"</span>: <span class="number">1</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Configuring-Basic-Authentication"><a href="#Configuring-Basic-Authentication" class="headerlink" title="Configuring Basic Authentication"></a>Configuring Basic Authentication</h3><p>You can configure your dashboard for Basic Authentication by adding usernames and passwords your <code>parse-dashboard-config.json</code> configuration file:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"apps"</span>: [&#123;<span class="attr">"..."</span>: <span class="string">"..."</span>&#125;],</div><div class="line">  <span class="attr">"users"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"user"</span>:<span class="string">"user1"</span>,</div><div class="line">      <span class="attr">"pass"</span>:<span class="string">"pass"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"user"</span>:<span class="string">"user2"</span>,</div><div class="line">      <span class="attr">"pass"</span>:<span class="string">"pass"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"useEncryptedPasswords"</span>: <span class="literal">true</span> | <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>You can store the password in either <code>plain text</code> or <code>bcrypt</code> formats. To use the <code>bcrypt</code> format, you must set the config <code>useEncryptedPasswords</code> parameter to <code>true</code>.<br>You can encrypt the password using any online bcrypt tool e.g. <a href="https://www.bcrypt-generator.com" target="_blank" rel="external">https://www.bcrypt-generator.com</a>.</p>
<h3 id="Separating-App-Access-Based-on-User-Identity"><a href="#Separating-App-Access-Based-on-User-Identity" class="headerlink" title="Separating App Access Based on User Identity"></a>Separating App Access Based on User Identity</h3><p>If you have configured your dashboard to manage multiple applications, you can restrict the management of apps based on user identity.</p>
<p>To do so, update your <code>parse-dashboard-config.json</code> configuration file to match the following format:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"apps"</span>: [&#123;<span class="attr">"..."</span>: <span class="string">"..."</span>&#125;],</div><div class="line">  <span class="attr">"users"</span>: [</div><div class="line">     &#123;</div><div class="line">       <span class="attr">"user"</span>:<span class="string">"user1"</span>,</div><div class="line">       <span class="attr">"pass"</span>:<span class="string">"pass1"</span>,</div><div class="line">       <span class="attr">"apps"</span>: [&#123;<span class="attr">"appId"</span>: <span class="string">"myAppId1"</span>&#125;, &#123;<span class="attr">"appId"</span>: <span class="string">"myAppId2"</span>&#125;]</div><div class="line">     &#125;,</div><div class="line">     &#123;</div><div class="line">       <span class="attr">"user"</span>:<span class="string">"user2"</span>,</div><div class="line">       <span class="attr">"pass"</span>:<span class="string">"pass2"</span>,</div><div class="line">       <span class="attr">"apps"</span>: [&#123;<span class="attr">"appId"</span>: <span class="string">"myAppId1"</span>&#125;]</div><div class="line">     &#125;  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The effect of such a configuration is as follows:</p>
<p>When <code>user1</code> logs in, he/she will be able to manage <code>myAppId1</code> and <code>myAppId2</code> from the dashboard.</p>
<p>When <em><code>user2</code></em>  logs in, he/she will only be able to manage <em><code>myAppId1</code></em> from the dashboard.</p>
<h2 id="Run-with-Docker"><a href="#Run-with-Docker" class="headerlink" title="Run with Docker"></a>Run with Docker</h2><p>It is easy to use it with Docker. First build the image:</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">docker</span> <span class="keyword">build </span>-t parse-dashboard .</div></pre></td></tr></table></figure>
<p>Run the image with your <code>config.json</code> mounted as a volume</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d -<span class="selector-tag">p</span> <span class="number">8080</span>:<span class="number">4040</span> -v host/path/to/config<span class="selector-class">.json</span>:/src/Parse-Dashboard/parse-dashboard-config<span class="selector-class">.json</span> parse-dashboard</div></pre></td></tr></table></figure>
<p>By default, the container will start the app at port 4040 inside the container. However, you can run custom command as well (see <code>Deploying in production</code> for custom setup).</p>
<p>In this example, we want to run the application in production mode at port 80 of the host machine.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d -<span class="selector-tag">p</span> <span class="number">80</span>:<span class="number">8080</span> -v host/path/to/config<span class="selector-class">.json</span>:/src/Parse-Dashboard/parse-dashboard-config<span class="selector-class">.json</span> parse-dashboard --port <span class="number">8080</span></div></pre></td></tr></table></figure>
<p>If you are not familiar with Docker, <code>--port 8080</code> will be passed in as argument to the entrypoint to form the full command <code>npm start -- --port 8080</code>. The application will start at port 8080 inside the container and port <code>8080</code> will be mounted to port <code>80</code> on your host machine.</p>
<h1 id="Contributing"><a href="#Contributing" class="headerlink" title="Contributing"></a>Contributing</h1><p>We really want Parse to be yours, to see it grow and thrive in the open source community. Please see the <a href="CONTRIBUTING.md">Contributing to Parse Dashboard guide</a>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Parse-Dashboard&quot;&gt;&lt;a href=&quot;#Parse-Dashboard&quot; class=&quot;headerlink&quot; title=&quot;Parse Dashboard&quot;&gt;&lt;/a&gt;Parse Dashboard&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://t
    
    </summary>
    
      <category term="Readme" scheme="http://yoursite.com/categories/Readme/"/>
    
    
      <category term="Database" scheme="http://yoursite.com/tags/Database/"/>
    
  </entry>
  
  <entry>
    <title>PaserServer_readme</title>
    <link href="http://yoursite.com/2017/03/26/PaserServer-readme/"/>
    <id>http://yoursite.com/2017/03/26/PaserServer-readme/</id>
    <published>2017-03-26T10:50:57.000Z</published>
    <updated>2017-03-26T02:56:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src=".github/parse-server-logo.png?raw=true" alt="Parse Server logo"></p>
<p><a href="https://travis-ci.org/ParsePlatform/parse-server" target="_blank" rel="external"><img src="https://img.shields.io/travis/ParsePlatform/parse-server/master.svg?style=flat" alt="Build Status"></a><br><a href="https://codecov.io/github/ParsePlatform/parse-server?branch=master" target="_blank" rel="external"><img src="https://img.shields.io/codecov/c/github/ParsePlatform/parse-server/master.svg" alt="Coverage Status"></a><br><a href="https://www.npmjs.com/package/parse-server" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/parse-server.svg?style=flat" alt="npm version"></a></p>
<p><a href="https://gitter.im/ParsePlatform/Chat" target="_blank" rel="external"><img src="https://img.shields.io/badge/gitter-join%20chat%20%E2%86%92-brightgreen.svg" alt="Join Chat"></a></p>
<p>Parse Server is an <a href="http://blog.parse.com/announcements/introducing-parse-server-and-the-database-migration-tool/" target="_blank" rel="external">open source version of the Parse backend</a> that can be deployed to any infrastructure that can run Node.js.</p>
<p>Parse Server works with the Express web application framework. It can be added to existing web applications, or run by itself.</p>
<h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p>April 2016 - We created a series of video screencasts, please check them out here: <a href="http://blog.parse.com/learn/parse-server-video-series-april-2016/" target="_blank" rel="external">http://blog.parse.com/learn/parse-server-video-series-april-2016/</a></p>
<p>The fastest and easiest way to get started is to run MongoDB and Parse Server locally.</p>
<h2 id="Running-Parse-Server"><a href="#Running-Parse-Server" class="headerlink" title="Running Parse Server"></a>Running Parse Server</h2><h3 id="Locally"><a href="#Locally" class="headerlink" title="Locally"></a>Locally</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ npm <span class="keyword">install</span> -g <span class="keyword">parse</span>-<span class="keyword">server</span> mongodb-runner</div><div class="line">$ mongodb-runner <span class="keyword">start</span></div><div class="line">$ <span class="keyword">parse</span>-<span class="keyword">server</span> <span class="comment">--appId APPLICATION_ID --masterKey MASTER_KEY --databaseURI mongodb://localhost/test</span></div></pre></td></tr></table></figure>
<h3 id="Inside-a-Docker-container"><a href="#Inside-a-Docker-container" class="headerlink" title="Inside a Docker container"></a>Inside a Docker container</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$ docker build --tag <span class="built_in">parse</span>-server .</div><div class="line">$ docker <span class="keyword">run</span> --name my-mongo -d mongo</div><div class="line">$ docker <span class="keyword">run</span> --name my-<span class="built_in">parse</span>-server --link my-mongo:mongo <span class="built_in">parse</span>-server --appId APPLICATION_ID --masterKey MASTER_KEY --databaseURI mongodb:<span class="comment">//mongo/test</span></div><div class="line">```  </div><div class="line"></div><div class="line">You can <span class="keyword">use</span> any arbitrary <span class="keyword">string</span> as your application id <span class="keyword">and</span> master <span class="built_in">key</span>. These will be used by your clients to authenticate with the <span class="built_in">Parse</span> Server.</div><div class="line"></div><div class="line">That's it! You are now running a standalone version of <span class="built_in">Parse</span> Server on your machine.</div><div class="line"></div><div class="line">**Using a remote MongoDB?** Pass the  `--databaseURI DATABASE_URI` parameter when starting `<span class="built_in">parse</span>-server`. Learn more about configuring <span class="built_in">Parse</span> Server [here](<span class="meta">#configuration). For a full list of available options, run `parse-server --help`.</span></div><div class="line"></div><div class="line"><span class="meta">### Saving your first object</span></div><div class="line"></div><div class="line">Now that you're running <span class="built_in">Parse</span> Server, it is <span class="built_in">time</span> to <span class="keyword">save</span> your first object. We'll <span class="keyword">use</span> the [REST API](https:<span class="comment">//parse.com/docs/rest/guide), but you can easily do the same using any of the [Parse SDKs](https://parseplatform.github.io/#sdks). Run the following:</span></div><div class="line"></div><div class="line">```bash</div><div class="line">curl -X POST \</div><div class="line">-H <span class="string">"X-Parse-Application-Id: APPLICATION_ID"</span> \</div><div class="line">-H <span class="string">"Content-Type: application/json"</span> \</div><div class="line">-d '&#123;<span class="string">"score"</span>:<span class="number">1337</span>,<span class="string">"playerName"</span>:<span class="string">"Sean Plott"</span>,<span class="string">"cheatMode"</span>:false&#125;' \</div><div class="line">http:<span class="comment">//localhost:1337/parse/classes/GameScore</span></div></pre></td></tr></table></figure>
<p>You should get a response similar to this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"objectId"</span>: <span class="string">"2ntvSpRGIK"</span>,</div><div class="line">  <span class="string">"createdAt"</span>: <span class="string">"2016-03-11T23:51:48.050Z"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>You can now retrieve this object directly (make sure to replace <code>2ntvSpRGIK</code> with the actual <code>objectId</code> you received when the object was created):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ curl -X GET \</div><div class="line">  -H <span class="string">"X-Parse-Application-Id: APPLICATION_ID"</span> \</div><div class="line">  http://localhost:1337/parse/classes/GameScore/2ntvSpRGIK</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// Response</div><div class="line">&#123;</div><div class="line">  "objectId": "2ntvSpRGIK",</div><div class="line">  "score": 1337,</div><div class="line">  "playerName": "Sean Plott",</div><div class="line">  "cheatMode": false,</div><div class="line">  "updatedAt": "2016-03-11T23:51:48.050Z",</div><div class="line">  "createdAt": "2016-03-11T23:51:48.050Z"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Keeping tracks of individual object ids is not ideal, however. In most cases you will want to run a query over the collection, like so:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>curl -X GET \</div><div class="line">  -H <span class="string">"X-Parse-Application-Id: APPLICATION_ID"</span> \</div><div class="line">  <span class="symbol">http:</span>/<span class="regexp">/localhost:1337/parse</span><span class="regexp">/classes/</span>GameScore</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// The response will provide all the matching objects within the `results` array:</div><div class="line">&#123;</div><div class="line">  "results": [</div><div class="line">    &#123;</div><div class="line">      "objectId": "2ntvSpRGIK",</div><div class="line">      "score": 1337,</div><div class="line">      "playerName": "Sean Plott",</div><div class="line">      "cheatMode": false,</div><div class="line">      "updatedAt": "2016-03-11T23:51:48.050Z",</div><div class="line">      "createdAt": "2016-03-11T23:51:48.050Z"</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>To learn more about using saving and querying objects on Parse Server, check out the <a href="https://parse.com/docs" target="_blank" rel="external">Parse documentation</a>.</p>
<h3 id="Connect-your-app-to-Parse-Server"><a href="#Connect-your-app-to-Parse-Server" class="headerlink" title="Connect your app to Parse Server"></a>Connect your app to Parse Server</h3><p>Parse provides SDKs for all the major platforms. Refer to the Parse Server guide to <a href="https://github.com/ParsePlatform/parse-server/wiki/Parse-Server-Guide#using-parse-sdks-with-parse-server" target="_blank" rel="external">learn how to connect your app to Parse Server</a>.</p>
<h2 id="Running-Parse-Server-elsewhere"><a href="#Running-Parse-Server-elsewhere" class="headerlink" title="Running Parse Server elsewhere"></a>Running Parse Server elsewhere</h2><p>Once you have a better understanding of how the project works, please refer to the <a href="https://github.com/ParsePlatform/parse-server/wiki" target="_blank" rel="external">Parse Server wiki</a> for in-depth guides to deploy Parse Server to major infrastructure providers. Read on to learn more about additional ways of running Parse Server.</p>
<h3 id="Parse-Server-Sample-Application"><a href="#Parse-Server-Sample-Application" class="headerlink" title="Parse Server Sample Application"></a>Parse Server Sample Application</h3><p>We have provided a basic <a href="https://github.com/ParsePlatform/parse-server-example" target="_blank" rel="external">Node.js application</a> that uses the Parse Server module on Express and can be easily deployed to various infrastructure providers:</p>
<ul>
<li><a href="https://devcenter.heroku.com/articles/deploying-a-parse-server-to-heroku" target="_blank" rel="external">Heroku and mLab</a></li>
<li><a href="http://mobile.awsblog.com/post/TxCD57GZLM2JR/How-to-set-up-Parse-Server-on-AWS-using-AWS-Elastic-Beanstalk" target="_blank" rel="external">AWS and Elastic Beanstalk</a></li>
<li><a href="https://medium.com/@justinbeckwith/deploying-parse-server-to-google-app-engine-6bc0b7451d50" target="_blank" rel="external">Google App Engine</a></li>
<li><a href="https://azure.microsoft.com/en-us/blog/azure-welcomes-parse-developers/" target="_blank" rel="external">Microsoft Azure</a></li>
<li><a href="https://blog.sashido.io/tag/migration/" target="_blank" rel="external">SashiDo</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-run-parse-server-on-ubuntu-14-04" target="_blank" rel="external">Digital Ocean</a></li>
<li><a href="https://github.com/cf-platform-eng/pws-parse-server" target="_blank" rel="external">Pivotal Web Services</a></li>
<li><a href="http://blog.back4app.com/2016/03/01/quick-wizard-migration/" target="_blank" rel="external">Back4app</a></li>
<li><a href="https://gomix.com/#!/project/parse-server" target="_blank" rel="external">Gomix</a></li>
</ul>
<h3 id="Parse-Server-Express"><a href="#Parse-Server-Express" class="headerlink" title="Parse Server + Express"></a>Parse Server + Express</h3><p>You can also create an instance of Parse Server, and mount it on a new or existing Express website:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> ParseServer = <span class="built_in">require</span>(<span class="string">'parse-server'</span>).ParseServer;</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="keyword">var</span> api = <span class="keyword">new</span> ParseServer(&#123;</div><div class="line">  <span class="attr">databaseURI</span>: <span class="string">'mongodb://localhost:27017/dev'</span>, <span class="comment">// Connection string for your MongoDB database</span></div><div class="line">  cloud: <span class="string">'/home/myApp/cloud/main.js'</span>, <span class="comment">// Absolute path to your Cloud Code</span></div><div class="line">  appId: <span class="string">'myAppId'</span>,</div><div class="line">  <span class="attr">masterKey</span>: <span class="string">'myMasterKey'</span>, <span class="comment">// Keep this key secret!</span></div><div class="line">  fileKey: <span class="string">'optionalFileKey'</span>,</div><div class="line">  <span class="attr">serverURL</span>: <span class="string">'http://localhost:1337/parse'</span> <span class="comment">// Don't forget to change to https if needed</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// Serve the Parse API on the /parse URL prefix</span></div><div class="line">app.use(<span class="string">'/parse'</span>, api);</div><div class="line"></div><div class="line">app.listen(<span class="number">1337</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'parse-server-example running on port 1337.'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>For a full list of available options, run <code>parse-server --help</code>.</p>
<h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><p>Parse Server will, by default, log:</p>
<ul>
<li>to the console</li>
<li>daily rotating files as new line delimited JSON</li>
</ul>
<p>Logs are also be viewable in Parse Dashboard.</p>
<p><strong>Want to log each request and response?</strong> Set the <code>VERBOSE</code> environment variable when starting <code>parse-server</code>. Usage :-  <code>VERBOSE=&#39;1&#39; parse-server --appId APPLICATION_ID --masterKey MASTER_KEY</code></p>
<p><strong>Want logs to be in placed in other folder?</strong> Pass the <code>PARSE_SERVER_LOGS_FOLDER</code> environment variable when starting <code>parse-server</code>. Usage :-  <code>PARSE_SERVER_LOGS_FOLDER=&#39;&lt;path-to-logs-folder&gt;&#39; parse-server --appId APPLICATION_ID --masterKey MASTER_KEY</code></p>
<p><strong>Want new line delimited JSON error logs (for consumption by CloudWatch, Google Cloud Logging, etc.)?</strong> Pass the <code>JSON_LOGS</code> environment variable when starting <code>parse-server</code>. Usage :-  <code>JSON_LOGS=&#39;1&#39; parse-server --appId APPLICATION_ID --masterKey MASTER_KEY</code></p>
<h1 id="Documentation"><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h1><p>The full documentation for Parse Server is available in the <a href="https://github.com/ParsePlatform/parse-server/wiki" target="_blank" rel="external">wiki</a>. The <a href="https://github.com/ParsePlatform/parse-server/wiki/Parse-Server-Guide" target="_blank" rel="external">Parse Server guide</a> is a good place to get started. If youâ€™re interested in developing for Parse Server, the <a href="https://github.com/ParsePlatform/parse-server/wiki/Development-Guide" target="_blank" rel="external">Development guide</a> will help you get set up.</p>
<h2 id="Migrating-an-Existing-Parse-App"><a href="#Migrating-an-Existing-Parse-App" class="headerlink" title="Migrating an Existing Parse App"></a>Migrating an Existing Parse App</h2><p>The hosted version of Parse will be fully retired on January 28th, 2017. If you are planning to migrate an app, you need to begin work as soon as possible. There are a few areas where Parse Server does not provide compatibility with the hosted version of Parse. Learn more in the <a href="https://parse.com/migration" target="_blank" rel="external">Migration guide</a>.</p>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>Parse Server can be configured using the following options. You may pass these as parameters when running a standalone <code>parse-server</code>, or by loading a configuration file in JSON format using <code>parse-server path/to/configuration.json</code>. If youâ€™re using Parse Server on Express, you may also pass these to the <code>ParseServer</code> object as options.</p>
<p>For the full list of available options, run <code>parse-server --help</code>.</p>
<h4 id="Basic-options"><a href="#Basic-options" class="headerlink" title="Basic options"></a>Basic options</h4><ul>
<li><code>appId</code> <strong>(required)</strong> - The application id to host with this server instance. You can use any arbitrary string. For migrated apps, this should match your hosted Parse app.</li>
<li><code>masterKey</code> <strong>(required)</strong> - The master key to use for overriding ACL security.  You can use any arbitrary string. Keep it secret! For migrated apps, this should match your hosted Parse app.</li>
<li><code>databaseURI</code> <strong>(required)</strong> - The connection string for your database, i.e. <code>mongodb://user:pass@host.com/dbname</code>. Be sure to <a href="https://app.zencoder.com/docs/guides/getting-started/special-characters-in-usernames-and-passwords" target="_blank" rel="external">URL encode your password</a> if your password has special characters.</li>
<li><code>port</code> - The default port is 1337, specify this parameter to use a different port.</li>
<li><code>serverURL</code> - URL to your Parse Server (donâ€™t forget to specify http:// or https://). This URL will be used when making requests to Parse Server from Cloud Code.</li>
<li><code>cloud</code> - The absolute path to your cloud code <code>main.js</code> file.</li>
<li><code>push</code> - Configuration options for APNS and GCM push. See the <a href="https://github.com/ParsePlatform/parse-server/wiki/Push" target="_blank" rel="external">Push Notifications wiki entry</a>.</li>
</ul>
<h4 id="Client-key-options"><a href="#Client-key-options" class="headerlink" title="Client key options"></a>Client key options</h4><p>The client keys used with Parse are no longer necessary with Parse Server. If you wish to still require them, perhaps to be able to refuse access to older clients, you can set the keys at initialization time. Setting any of these keys will require all requests to provide one of the configured keys.</p>
<ul>
<li><code>clientKey</code></li>
<li><code>javascriptKey</code></li>
<li><code>restAPIKey</code></li>
<li><code>dotNetKey</code></li>
</ul>
<h4 id="Advanced-options"><a href="#Advanced-options" class="headerlink" title="Advanced options"></a>Advanced options</h4><ul>
<li><code>fileKey</code> - For migrated apps, this is necessary to provide access to files already hosted on Parse.</li>
<li><code>allowClientClassCreation</code> - Set to false to disable client class creation. Defaults to true.</li>
<li><code>enableAnonymousUsers</code> - Set to false to disable anonymous users. Defaults to true.</li>
<li><code>auth</code> - Used to configure support for <a href="https://github.com/ParsePlatform/parse-server/wiki/OAuth--and-Custom-Authentication" target="_blank" rel="external">3rd party authentication</a>.</li>
<li><code>facebookAppIds</code> - An array of valid Facebook application IDs that users may authenticate with.</li>
<li><code>mountPath</code> - Mount path for the server. Defaults to <code>/parse</code>.</li>
<li><code>filesAdapter</code> - The default behavior (GridStore) can be changed by creating an adapter class (see <a href="https://github.com/ParsePlatform/parse-server/blob/master/src/Adapters/Files/FilesAdapter.js" target="_blank" rel="external"><code>FilesAdapter.js</code></a>).</li>
<li><code>maxUploadSize</code> - Max file size for uploads. Defaults to 20 MB.</li>
<li><code>loggerAdapter</code> - The default behavior/transport (File) can be changed by creating an adapter class (see <a href="https://github.com/ParsePlatform/parse-server/blob/master/src/Adapters/Logger/LoggerAdapter.js" target="_blank" rel="external"><code>LoggerAdapter.js</code></a>).</li>
<li><code>sessionLength</code> - The length of time in seconds that a session should be valid for. Defaults to 31536000 seconds (1 year).</li>
<li><code>revokeSessionOnPasswordReset</code> - When a user changes their password, either through the reset password email or while logged in, all sessions are revoked if this is true. Set to false if you donâ€™t want to revoke sessions.</li>
<li><code>accountLockout</code> - Lock account when a malicious user is attempting to determine an account password by trial and error.</li>
<li><code>passwordPolicy</code> - Optional password policy rules to enforce.</li>
<li><code>customPages</code> - A hash with urls to override email verification links, password reset links and specify frame url for masking user-facing pages. Available keys: <code>parseFrameURL</code>, <code>invalidLink</code>, <code>choosePassword</code>, <code>passwordResetSuccess</code>, <code>verifyEmailSuccess</code>.</li>
<li><code>middleware</code> - (CLI only), a module name, function that is an express middleware. When using the CLI, the express app will load it just <strong>before</strong> mounting parse-server on the mount path. This option is useful for injecting a monitoring middleware.</li>
</ul>
<h5 id="Logging-1"><a href="#Logging-1" class="headerlink" title="Logging"></a>Logging</h5><p>Use the <code>PARSE_SERVER_LOGS_FOLDER</code> environment variable when starting <code>parse-server</code> to save your server logfiles to the specified folder.</p>
<p>Usage:</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">PARSE_SERVER_LOGS_FOLDER=</span><span class="string">'&lt;path-to-logs-folder&gt;'</span> <span class="string">parse-server </span><span class="built_in">--appId</span> <span class="string">APPLICATION_ID </span><span class="built_in">--masterKey</span> <span class="string">MASTER_KEY</span></div></pre></td></tr></table></figure>
<h5 id="Email-verification-and-password-reset"><a href="#Email-verification-and-password-reset" class="headerlink" title="Email verification and password reset"></a>Email verification and password reset</h5><p>Verifying user email addresses and enabling password reset via email requires an email adapter. As part of the <code>parse-server</code> package we provide an adapter for sending email through Mailgun. To use it, sign up for Mailgun, and add this to your initialization code:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> server = ParseServer(&#123;</div><div class="line">  ...otherOptions,</div><div class="line">  <span class="comment">// Enable email verification</span></div><div class="line">  verifyUserEmails: <span class="literal">true</span>,</div><div class="line"></div><div class="line">  <span class="comment">// if `verifyUserEmails` is `true` and</span></div><div class="line">  <span class="comment">//     if `emailVerifyTokenValidityDuration` is `undefined` then</span></div><div class="line">  <span class="comment">//        email verify token never expires</span></div><div class="line">  <span class="comment">//     else</span></div><div class="line">  <span class="comment">//        email verify token expires after `emailVerifyTokenValidityDuration`</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// `emailVerifyTokenValidityDuration` defaults to `undefined`</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// email verify token below expires in 2 hours (= 2 * 60 * 60 == 7200 seconds)</span></div><div class="line">  emailVerifyTokenValidityDuration: <span class="number">2</span> * <span class="number">60</span> * <span class="number">60</span>, <span class="comment">// in seconds (2 hours = 7200 seconds)</span></div><div class="line"></div><div class="line">  <span class="comment">// set preventLoginWithUnverifiedEmail to false to allow user to login without verifying their email</span></div><div class="line">  <span class="comment">// set preventLoginWithUnverifiedEmail to true to prevent user from login if their email is not verified</span></div><div class="line">  preventLoginWithUnverifiedEmail: <span class="literal">false</span>, <span class="comment">// defaults to false</span></div><div class="line"></div><div class="line">  <span class="comment">// The public URL of your app.</span></div><div class="line">  <span class="comment">// This will appear in the link that is used to verify email addresses and reset passwords.</span></div><div class="line">  <span class="comment">// Set the mount path as it is in serverURL</span></div><div class="line">  publicServerURL: <span class="string">'https://example.com/parse'</span>,</div><div class="line">  <span class="comment">// Your apps name. This will appear in the subject and body of the emails that are sent.</span></div><div class="line">  appName: <span class="string">'Parse App'</span>,</div><div class="line">  <span class="comment">// The email adapter</span></div><div class="line">  emailAdapter: &#123;</div><div class="line">    <span class="attr">module</span>: <span class="string">'parse-server-simple-mailgun-adapter'</span>,</div><div class="line">    <span class="attr">options</span>: &#123;</div><div class="line">      <span class="comment">// The address that your emails come from</span></div><div class="line">      fromAddress: <span class="string">'parse@example.com'</span>,</div><div class="line">      <span class="comment">// Your domain from mailgun.com</span></div><div class="line">      domain: <span class="string">'example.com'</span>,</div><div class="line">      <span class="comment">// Your API key from mailgun.com</span></div><div class="line">      apiKey: <span class="string">'key-mykey'</span>,</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// account lockout policy setting (OPTIONAL) - defaults to undefined</span></div><div class="line">  <span class="comment">// if the account lockout policy is set and there are more than `threshold` number of failed login attempts then the `login` api call returns error code `Parse.Error.OBJECT_NOT_FOUND` with error message `Your account is locked due to multiple failed login attempts. Please try again after &lt;duration&gt; minute(s)`. After `duration` minutes of no login attempts, the application will allow the user to try login again.</span></div><div class="line">  accountLockout: &#123;</div><div class="line">    <span class="attr">duration</span>: <span class="number">5</span>, <span class="comment">// duration policy setting determines the number of minutes that a locked-out account remains locked out before automatically becoming unlocked. Set it to a value greater than 0 and less than 100000.</span></div><div class="line">    threshold: <span class="number">3</span>, <span class="comment">// threshold policy setting determines the number of failed sign-in attempts that will cause a user account to be locked. Set it to an integer value greater than 0 and less than 1000.</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">// optional settings to enforce password policies</span></div><div class="line">  passwordPolicy: &#123;</div><div class="line">    <span class="comment">// Two optional settings to enforce strong passwords. Either one or both can be specified. </span></div><div class="line">    <span class="comment">// If both are specified, both checks must pass to accept the password</span></div><div class="line">    <span class="comment">// 1. a RegExp object or a regex string representing the pattern to enforce </span></div><div class="line">    validatorPattern: <span class="regexp">/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.&#123;8,&#125;)/</span>, <span class="comment">// enforce password with at least 8 char with at least 1 lower case, 1 upper case and 1 digit</span></div><div class="line">    <span class="comment">// 2. a callback function to be invoked to validate the password  </span></div><div class="line">    validatorCallback: <span class="function">(<span class="params">password</span>) =&gt;</span> &#123; <span class="keyword">return</span> validatePassword(password) &#125;, </div><div class="line">    <span class="attr">doNotAllowUsername</span>: <span class="literal">true</span>, <span class="comment">// optional setting to disallow username in passwords</span></div><div class="line">    maxPasswordAge: <span class="number">90</span>, <span class="comment">// optional setting in days for password expiry. Login fails if user does not reset the password within this period after signup/last reset. </span></div><div class="line">    maxPasswordHistory: <span class="number">5</span>, <span class="comment">// optional setting to prevent reuse of previous n passwords. Maximum value that can be specified is 20. Not specifying it or specifying 0 will not enforce history.</span></div><div class="line">    <span class="comment">//optional setting to set a validity duration for password reset links (in seconds)</span></div><div class="line">    resetTokenValidityDuration: <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>, <span class="comment">// expire after 24 hours</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>You can also use other email adapters contributed by the community such as:</p>
<ul>
<li><a href="https://www.npmjs.com/package/parse-server-postmark-adapter" target="_blank" rel="external">parse-server-postmark-adapter</a></li>
<li><a href="https://www.npmjs.com/package/parse-server-sendgrid-adapter" target="_blank" rel="external">parse-server-sendgrid-adapter</a></li>
<li><a href="https://www.npmjs.com/package/parse-server-mandrill-adapter" target="_blank" rel="external">parse-server-mandrill-adapter</a></li>
<li><a href="https://www.npmjs.com/package/parse-server-simple-ses-adapter" target="_blank" rel="external">parse-server-simple-ses-adapter</a></li>
<li><a href="https://www.npmjs.com/package/parse-server-mailgun-adapter-template" target="_blank" rel="external">parse-server-mailgun-adapter-template</a></li>
<li><a href="https://www.npmjs.com/package/parse-server-mailjet-adapter" target="_blank" rel="external">parse-server-mailjet-adapter</a></li>
<li><a href="https://www.npmjs.com/package/simple-parse-smtp-adapter" target="_blank" rel="external">simple-parse-smtp-adapter</a></li>
</ul>
<h3 id="Using-environment-variables-to-configure-Parse-Server"><a href="#Using-environment-variables-to-configure-Parse-Server" class="headerlink" title="Using environment variables to configure Parse Server"></a>Using environment variables to configure Parse Server</h3><p>You may configure the Parse Server using environment variables:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">PORT</div><div class="line">PARSE_SERVER_APPLICATION_ID</div><div class="line">PARSE_SERVER_MASTER_KEY</div><div class="line">PARSE_SERVER_DATABASE_URI</div><div class="line">PARSE_SERVER_URL</div><div class="line">PARSE_SERVER_CLOUD_CODE_MAIN</div></pre></td></tr></table></figure>
<p>The default port is 1337, to use a different port set the PORT environment variable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ PORT=8080 parse-server --appId APPLICATION_ID --masterKey MASTER_KEY</div></pre></td></tr></table></figure>
<p>For the full list of configurable environment variables, run <code>parse-server --help</code>.</p>
<h3 id="Available-Adapters"><a href="#Available-Adapters" class="headerlink" title="Available Adapters"></a>Available Adapters</h3><p><a href="https://github.com/parse-server-modules" target="_blank" rel="external">Parse Server Modules (Adapters)</a></p>
<h3 id="Configuring-File-Adapters"><a href="#Configuring-File-Adapters" class="headerlink" title="Configuring File Adapters"></a>Configuring File Adapters</h3><p>Parse Server allows developers to choose from several options when hosting files:</p>
<ul>
<li><code>GridStoreAdapter</code>, which is backed by MongoDB;</li>
<li><code>S3Adapter</code>, which is backed by <a href="https://aws.amazon.com/s3/" target="_blank" rel="external">Amazon S3</a>; or</li>
<li><code>GCSAdapter</code>, which is backed by <a href="https://cloud.google.com/storage/" target="_blank" rel="external">Google Cloud Storage</a></li>
</ul>
<p><code>GridStoreAdapter</code> is used by default and requires no setup, but if youâ€™re interested in using S3 or Google Cloud Storage, additional configuration information is available in the <a href="https://github.com/ParsePlatform/parse-server/wiki/Configuring-File-Adapters" target="_blank" rel="external">Parse Server wiki</a>.</p>
<h1 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h1><p>For implementation related questions or technical support, please refer to the <a href="http://stackoverflow.com/questions/tagged/parse.com" target="_blank" rel="external">Stack Overflow</a> and <a href="https://serverfault.com/tags/parse" target="_blank" rel="external">Server Fault</a> communities.</p>
<p>If you believe youâ€™ve found an issue with Parse Server, make sure these boxes are checked before <a href="https://github.com/ParsePlatform/parse-server/issues" target="_blank" rel="external">reporting an issue</a>:</p>
<ul>
<li><p>[ ] Youâ€™ve met the <a href="https://github.com/ParsePlatform/parse-server/wiki/Parse-Server-Guide#prerequisites" target="_blank" rel="external">prerequisites</a>.</p>
</li>
<li><p>[ ] Youâ€™re running the <a href="https://github.com/ParsePlatform/parse-server/releases" target="_blank" rel="external">latest version</a> of Parse Server.</p>
</li>
<li><p>[ ] Youâ€™ve searched through <a href="https://github.com/ParsePlatform/parse-server/issues?utf8=%E2%9C%93&amp;q=" target="_blank" rel="external">existing issues</a>. Chances are that your issue has been reported or resolved before.</p>
</li>
</ul>
<h1 id="Want-to-ride-the-bleeding-edge"><a href="#Want-to-ride-the-bleeding-edge" class="headerlink" title="Want to ride the bleeding edge?"></a>Want to ride the bleeding edge?</h1><p>The <code>latest</code> branch in this repository is automatically maintained to be the last<br>commit to <code>master</code> to pass all tests, in the same form found on npm. It is<br>recommend to use builds deployed npm for many reasons, but if you want to use<br>the latest not-yet-released version of parse-server, you can do so by depending<br>directly on this branch:</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install parseplatform/parse-<span class="keyword">server</span>.git<span class="meta">#latest</span></div></pre></td></tr></table></figure>
<h1 id="Contributing"><a href="#Contributing" class="headerlink" title="Contributing"></a>Contributing</h1><p>We really want Parse to be yours, to see it grow and thrive in the open source community. Please see the <a href="CONTRIBUTING.md">Contributing to Parse Server guide</a>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;.github/parse-server-logo.png?raw=true&quot; alt=&quot;Parse Server logo&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/ParsePlatform/parse-serv
    
    </summary>
    
      <category term="Readme" scheme="http://yoursite.com/categories/Readme/"/>
    
    
      <category term="database" scheme="http://yoursite.com/tags/database/"/>
    
  </entry>
  
</feed>
