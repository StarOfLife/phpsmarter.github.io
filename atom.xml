<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>phpsmarter</title>
  <subtitle>A beginner of React-native</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-03-23T11:33:16.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>phpsmarter</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æµ‹è¯•æ–‡ä»¶</title>
    <link href="http://yoursite.com/2017/03/23/new-article-2/"/>
    <id>http://yoursite.com/2017/03/23/new-article-2/</id>
    <published>2017-03-23T15:31:30.000Z</published>
    <updated>2017-03-23T11:33:16.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="Redux" scheme="http://yoursite.com/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App</title>
    <link href="http://yoursite.com/2017/03/23/%E7%BF%BB%E8%AF%91-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8React,Redux%E5%92%8CImmutable-js%E6%9E%84%E5%BB%BATodo-App/"/>
    <id>http://yoursite.com/2017/03/23/ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App/</id>
    <published>2017-03-23T00:04:10.000Z</published>
    <updated>2017-03-23T11:29:39.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡æ˜¯ç¿»è¯‘ç‰ˆæœ¬,<a href="https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/" target="_blank" rel="external">åŸæ–‡è¯·è§</a><br><em>By Dan Prince  May 03, 2016</em></p>
</blockquote>
<p>Reactä½¿ç”¨ç»„ä»¶å’Œå•å‘æ•°æ®æµæ–¹å¼æè¿°ç”¨æˆ·ç•Œé¢,ä½†æ˜¯Reactå¯¹stateçš„å¤„ç†éå¸¸çš„ç®€å•.è¿™ä¸€ç‚¹è®©æˆ‘ä»¬çŸ¥é“,Reactä»…ä»…åªå½“äºä¼ ç»Ÿçš„<code>Model-View-Controller</code>æ„æ¶çš„<code>View</code>å±‚.</p>
<p>ä»…ä»…ä½¿ç”¨Reactä¹Ÿå¯ä»¥æ„å»ºå¤§å‹çš„app,ä½†æ˜¯å¾ˆå¿«æˆ‘ä»¬ä¼šå‘ç°,è¦ä¿æŒä»£ç çš„ç®€æ´,æˆ‘ä»¬éœ€è¦åœ¨å…¶ä»–åœ°æ–¹ç®¡ç†state(æŠŠstateçš„ç®¡ç†ç‹¬ç«‹å‡ºæ¥).</p>
<p>æ²¡æœ‰å®˜æ–¹ç®¡ç†åº”ç”¨stateçš„å·¥å…·,ä½†æ˜¯æœ‰å‡ ä¸ªåº“å·¥ä½œçš„çš„ä¸é”™.ä»Šå¤©æˆ‘ä»¬æ·»åŠ ä¸¤ä¸ªåº“å’ŒReactä¸€èµ·æ¥æ„å»ºä¸€ä¸ªç®€å•çš„app.</p>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>Reduxæ˜¯ä¸€ä¸ªå°å‹çš„jsåº“,ä½œä¸ºappçš„stateå®¹å™¨.ç³…åˆäº†Flucå’ŒElmçš„æ¦‚å¿µ.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reduxç®¡ç†ä»»ä½•appçš„state,åªè¦æˆ‘ä»¬ç´§æ‰£ä¸‹é¢çš„æŒ‡å¯¼ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„stateä¿æŒåœ¨ä¸€ä¸ªå•ä¸€çš„storeä¸­</li>
<li>stateçš„æ”¹å˜åªä¼šæ¥è‡ªäºactions</li>
</ol>
<p>Reduxçš„æ ¸å¿ƒ storeæ˜¯ä¸€ä¸ªå‡½æ•°,å®ƒæ¥æ”¶å½“å‰çš„applicationçš„stateå’Œä¸€ä¸ªaction,åˆå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„application state,è¿™ä¸ªå‡½æ•°å«åšReducer.</p>
<p>æˆ‘ä»¬çš„Reactç»„ä»¶è´Ÿè´£å‘é€actionsåˆ°æˆ‘ä»¬çš„store,åè¿‡æ¥,å¦‚æœç»„ä»¶éœ€è¦æ¸²æŸ“çš„æ—¶å€™,storeä¼šé€šçŸ¥ä»–.</p>
<h2 id="ImmutableJS"><a href="#ImmutableJS" class="headerlink" title="ImmutableJS"></a>ImmutableJS</h2><p>å› ä¸ºReduxä¸å…è®¸æˆ‘ä»¬mutateç¨‹åºçš„state,å¦‚æœå€ŸåŠ©immutableæ•°æ®ç»“æ„æ¨¡å‹åŒ–åº”ç”¨ç¨‹åºçš„stateå°†ä¼šéå¸¸çš„æœ‰ç”¨.<br><code>Immutable.js</code>ä½¿ç”¨çªå˜ç•Œé¢(mutative interfaces)æä¾›ä¸€äº›immutableæ•°æ®ç»“æ„,è¿™äº›ç•Œé¢å®æ–½æ—¶éå¸¸çš„é«˜æ•ˆ,çµæ„Ÿæ¥è‡ªäºClojureå’ŒScala.</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>æˆ‘ä»¬å°†ä¼šä½¿ç”¨React,Reduxå’ŒImmutableJSå»æ„å»ºä¸€ä¸ªç®€å•çš„todo list,å…è®¸æˆ‘ä»¬æ·»åŠ todos,åœ¨å®Œæˆå’Œæœªå®Œæˆä¹‹é—´åˆ‡æ¢.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//html</div><div class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">//css</div><div class="line"> html, body, input, button &#123;</div><div class="line">  font-family: Sawasdee;</div><div class="line">  font-size: 20px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__list &#123;</div><div class="line">  margin: 0;</div><div class="line">  padding: 0;</div><div class="line">  list-style-type: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item &#123;</div><div class="line">  padding: .5em .25em;</div><div class="line">  border-bottom: solid 1px #eee;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item:hover &#123;</div><div class="line">  background: #f7f7f7;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__entry &#123;</div><div class="line">  border: solid 1px #ccc;</div><div class="line">  padding: .25em .5em;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #f3f3f3;</div><div class="line">  width: 100%;</div><div class="line">  box-sizing: border-box;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button &#123;</div><div class="line">  border: 0;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #71B7FF;  </div><div class="line">  color: #fff;</div><div class="line">  padding: .25em .5em;</div><div class="line">  margin: .5em 0;</div><div class="line">  margin-right: .25em;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button:hover &#123;</div><div class="line">  background: #B2D8FF;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//js</span></div><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span>, List &#125; = Immutable;</div><div class="line"><span class="keyword">const</span> &#123; createStore &#125; = Redux;</div><div class="line"><span class="keyword">const</span> &#123; Provider, connect &#125; = reactRedux;</div><div class="line"></div><div class="line"><span class="keyword">const</span> components = &#123;</div><div class="line">  Todo(&#123; todo &#125;) &#123;</div><div class="line">    <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;  </div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  TodoList(&#123; todos, toggleTodo, addTodo &#125;) &#123;</div><div class="line">    <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> text = e.target.value;</div><div class="line">      <span class="keyword">if</span>(e.which === <span class="number">13</span> &amp;&amp; text.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        addTodo(text);</div><div class="line">        e.target.value = <span class="string">''</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> toggleClick = <span class="function">(<span class="params">id</span>) =&gt;</span> () =&gt; toggleTodo(id);</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> &#123; Todo &#125; = components;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='todo'&gt;</div><div class="line">        &lt;input type='text'</div><div class="line">               className='todo__entry'</div><div class="line">               placeholder='Add todo'</div><div class="line">               onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">        &lt;ul className='todo__list'&gt;</div><div class="line">          &#123;todos.map(t =&gt; (</div><div class="line">            &lt;li</div><div class="line">              key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">              &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">            &lt;/li&gt;</div><div class="line">          ))&#125; </div><div class="line">        &lt;/ul&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const actions = &#123;</div><div class="line">  addTodo(text) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'ADD_TODO',</div><div class="line">      payload: &#123;</div><div class="line">        id: Math.random().toString(34).slice(2),</div><div class="line">        isDone: false,</div><div class="line">        text</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  toggleTodo(id) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'TOGGLE_TODO',</div><div class="line">      payload: id</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const init = List();</div><div class="line"></div><div class="line">const reducer = function(state=init, action) &#123;</div><div class="line">  switch(action.type) &#123;</div><div class="line">    case 'ADD_TODO':</div><div class="line">      return state.push(</div><div class="line">        Map(action.payload)</div><div class="line">      );</div><div class="line">    case 'TOGGLE_TODO':</div><div class="line">      return state.map(t =&gt; &#123;</div><div class="line">        if(t.get('id') == action.payload) &#123;</div><div class="line">          return t.update('isDone', isDone =&gt; !isDone);</div><div class="line">        &#125; else &#123;</div><div class="line">          return t;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    default:</div><div class="line">      return state;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const containers = &#123;</div><div class="line">  TodoList: connect(</div><div class="line">    function mapStateToProps(state) &#123;</div><div class="line">      return &#123;</div><div class="line">        todos: state</div><div class="line">      &#125;;</div><div class="line">    &#125;,</div><div class="line">    function mapDispatchToProps(dispatch) &#123;</div><div class="line">      return &#123;</div><div class="line">        toggleTodo: (id) =&gt; dispatch(actions.toggleTodo(id)),</div><div class="line">        addTodo: (text) =&gt; dispatch(actions.addTodo(text))</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">  )(components.TodoList)</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const &#123; TodoList &#125; = containers;</div><div class="line">const store = createStore(reducer);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    &lt;TodoList /&gt;</div><div class="line">  &lt;/Provider&gt;,</div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä»£ç åœ¨ <a href="https://github.com/sitepoint-editors/immutable-redux-todo" target="_blank" rel="external">Github</a></p>
<blockquote>
<p>å¯èƒ½æç¤ºbuildå¤±è´¥,<code>npm install babel-core</code>è¯•è¯•</p>
</blockquote>
<h2 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h2><p>ä»åˆ›å»ºé¡¹ç›®ğŸ“‚å¼€å§‹,å»ºç«‹ä¸€ä¸ªpackage.jsonæ–‡ä»¶.ç„¶åå®‰è£…éœ€è¦çš„ä¾èµ–åŒ….</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> npm install --save react react-dom redux react-redux immutable</div><div class="line">npm install --save-dev webpack babel-loader babel-preset-es2015 babel-preset-react</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨JSXå’ŒES2015,ç”¨Babelç¼–è¯‘ä»£ç ,ä½¿ç”¨Webpackæ¥å®Œæˆè¿™ä¸ªæ¨¡å—ç»‘å®šè¿‡ç¨‹.</p>
<p>åœ¨<code>webpack.config.js</code>æ–‡ä»¶ä¸­åˆ›å»ºWebpacké…ç½®æ–‡ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./src/app.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname,</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel'</span>,</div><div class="line">        <span class="attr">query</span>: &#123; <span class="attr">presets</span>: [ <span class="string">'es2015'</span>, <span class="string">'react'</span> ] &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<p>æœ€åæ‰©å±•ä¸€ä¸‹<code>package.json</code>,æ·»åŠ ä¸€ä¸ªnpm scriptä½¿ç”¨source mapsç¼–è¯‘æˆ‘ä»¬çš„ä»£ç .</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> "scripts": &#123;</div><div class="line">  "build": "webpack --debug"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯æ¬¡ç¼–è¯‘ä»£ç çš„æ—¶å€™,è¿è¡Œ<code>npm run build</code>.</p>
<h2 id="React-amp-Components"><a href="#React-amp-Components" class="headerlink" title="React&amp;Components"></a>React&amp;Components</h2><p>åœ¨å®æ–½é¡¹ç›®ä¹‹å‰,å…ˆåˆ›å»ºä¸€äº›å‚»ç“œæ•°æ®æœ‰å¾ˆå¤§çš„ç”¨å¤„,ä½†æˆ‘ä»¬æ„æ€éœ€è¦æ¸²æŸ“çš„ç»„ä»¶çš„æ—¶å€™,æœ‰ä¸€ç‚¹ç‚¹åˆæ­¥çš„æ„Ÿè§‰.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªReactç»„ä»¶<code>&lt;Todo/&gt;</code>å’Œ<code>&lt;TodoList&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/components.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Todo</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todo &#125; = props;</div><div class="line">  <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos &#125; = props;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text' placeholder='Add todo' /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.id&#125; className='todo__item'&gt;</div><div class="line">            &lt;Todo todo=&#123;t&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>åˆ°äº†è¿™ä¸€æ­¥,å¯ä»¥åˆ›å»º<code>index.html</code>æ–‡ä»¶æ¥æµ‹è¯•è¿™äº›ç»„ä»·,æ·»åŠ ä¸‹é¢çš„æ ‡è®°</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Immutable Todo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p>è¿˜æœ‰ä¸€ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶<code>src/app.js</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;dummyTodos&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>npm run build</code>ç¼–è¯‘æ–‡ä»¶,ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€index.htmlæ–‡ä»¶,ç¡®ä¿è¿è¡Œ.</p>
<h2 id="Redux-amp-ImmutableJS"><a href="#Redux-amp-ImmutableJS" class="headerlink" title="Redux&amp;ImmutableJS"></a>Redux&amp;ImmutableJS</h2><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å¾ˆå¥½çš„UI,å¯ä»¥å¼€å§‹è€ƒè™‘ç»„ä»¶æœ€åçš„state.å¼€å§‹åˆ›å»ºçš„å‚»ç“œæ•°æ®æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€ç«¯,æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“è½¬åŒ–ä¸ºImmutableJSé›†åˆ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = List([</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;)</div><div class="line">]);</div></pre></td></tr></table></figure>
<hr>
<p>ImmutableJS mapå’ŒJavascriptçš„å¯¹è±¡å·¥ä½œæ–¹å¼ä¸åŒ,æ‰€ä»¥æˆ‘ä»¬è¦å¯¹ç»„ä»¶åšä¸€ç‚¹è½»å¾®çš„æ”¹å˜.propertyæ¥å…¥çš„åœ°æ–¹(ä¾‹å¦‚ï¼štodo.id)éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•è°ƒç”¨æ¥ä»£æ›¿(ä¾‹å¦‚:<code>todo.get(â€˜idâ€™)</code>).</p>
<h2 id="è®¾è®¡Actions"><a href="#è®¾è®¡Actions" class="headerlink" title="è®¾è®¡Actions"></a>è®¾è®¡Actions</h2><p>ç°åœ¨æˆ‘ä»¬è·å¾—äº†æ•°æ®çš„ç‰¹å¾,å¯ä»¥è€ƒè™‘ä¸€ä¸‹actionsçš„æ›´æ–°.è¿™ä¸ªå®ä¾‹ä¸­,æˆ‘ä»¬ä»…ä»…éœ€è¦ä¸¤ä¸ªacions,ä¸€ä¸ªæ˜¯æ·»åŠ æ–°çš„todo,å¦ä¸€ä¸ªè½¬æ¢todoçš„çŠ¶æ€.</p>
<p>è®©æˆ‘ä»¬å®šä¹‰å‡ ä¸ªå‡½æ•°åˆ›å»ºè¿™äº›actions</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// src/actions.js</span></div><div class="line"></div><div class="line"><span class="comment">// succinct hack for generating passable unique ids</span></div><div class="line"><span class="keyword">const</span> uid = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random().toString(<span class="number">34</span>).slice(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'ADD_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: &#123;</div><div class="line">      <span class="attr">id</span>: uid(),</div><div class="line">      <span class="attr">isDone</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">text</span>: text</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'TOGGLE_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: id</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ªactionä»…ä»…æ˜¯ä¸€ä¸ªæœ‰typeå’Œpayloadçš„å±æ€§å¯¹è±¡.åœ¨æˆ‘ä»¬è§¦å‘actionå,typeå±æ€§å¸®åŠ©æˆ‘ä»¬ç”¨payloadæ¥ä½œä»€ä¹ˆ.</p>
<h2 id="è®¾è®¡ä¸€ä¸ªReducer"><a href="#è®¾è®¡ä¸€ä¸ªReducer" class="headerlink" title="è®¾è®¡ä¸€ä¸ªReducer"></a>è®¾è®¡ä¸€ä¸ªReducer</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†stateçš„ç‰¹æ€§å’Œæ›´æ–°stateçš„action,æˆ‘ä»¬å¯ä»¥åˆ›å»ºreduceräº†.ä»…ä»…æé†’ä¸€ä¸‹,reduceræ˜¯ä¸€ä¸ªæ¥æ”¶stateå’Œactionçš„å‡½æ•°,ç„¶åç”¨æ¥è®¡ç®—æ›´æ–°state.</p>
<p>è¿™é‡Œæ˜¯æˆ‘ä»¬reducerçš„åˆå§‹ç»“æ„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/reducer.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> init = List([]);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">todos=init, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span>(action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> todos;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ“ä½œ<code>ADD_TODO</code>actionéå¸¸ç®€å•,å¯æ˜¯ä½¿ç”¨<code>.push()</code>æ–¹æ³•,è¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨,æ·»åŠ todoåˆ°æœ«å°¾.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.push(<span class="built_in">Map</span>(action.payload));</div></pre></td></tr></table></figure>
<hr>
<p>è®°ä½è¦pushåˆ°åˆ—è¡¨ä¹‹å‰,è¦æŠŠtodoå¯¹è±¡è½¬å˜ä¸ºimmutable map.</p>
<p>æˆ‘ä»¬éœ€è¦å¤„ç†çš„ç¨å¾®å¤æ‚çš„actionæ˜¯<code>TOOGLE_TODO</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.map(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</div><div class="line">   <span class="keyword">if</span>(t.get(<span class="string">'id'</span>) === action.payload) &#123;</div><div class="line">     <span class="keyword">return</span> t.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line">   &#125; <span class="keyword">else</span> &#123;</div><div class="line">     <span class="keyword">return</span> t;</div><div class="line">   &#125;</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>.map()</code>éå†åˆ—è¡¨,æ‰¾åˆ°ä¸aciton<code>id</code>åŒ¹é…çš„todoé¡¹ç›®.ä¹‹åæˆ‘ä»¬è°ƒç”¨<code>.update()</code>æ–¹æ³•,æ¥æ”¶ä¸€ä¸ªé”®å’Œå‡½æ•°,ç„¶åè¿”å›ä¸€ä¸ªmapçš„æ–°æ‹·è´åˆ°updataå‡½æ•°,æ–°æ‹·è´ä¸­æ–°å€¼æ›¿æ¢äº†åˆå§‹å€¼.</p>
<p>å­—é¢é‡ç‰ˆæœ¬<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">const</span> todo = <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">'foo'</span>, <span class="attr">isDone</span>: <span class="literal">false</span> &#125;);</div><div class="line">todo.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line"><span class="comment">// =&gt; &#123; id: 0, text: 'foo', isDone: true &#125;</span></div></pre></td></tr></table></figure></p>
<hr>
<h2 id="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"><a href="#æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·" class="headerlink" title="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"></a>æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·</h2><p>actionså’Œreducerå‡†å¤‡å¥½äº†,å¯ä»¥åˆ›å»ºä¸€ä¸ªstore,è¿æ¥åˆ°æˆ‘ä»¬çš„Reactç»„ä»¶ä¸­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;store.getState()&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä¸ºäº†ä¿æŒç»„ä»¶å’Œstoreçš„ç‹¬ç«‹,æˆ‘ä»¬ä½¿ç”¨<code>react-redux</code>å¸®åŠ©ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹.å®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºç‹¬ç«‹äºstoreçš„å®¹å™¨,åŒ…è£…æ‰€æœ‰çš„ç»„ä»¶,æˆ‘ä»¬ä¸éœ€è¦æ”¹å˜å…ˆå‰çš„è®¾è®¡.</p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¹å™¨åŒ…è£…<code>&lt;TodoList/&gt;</code>ç»„ä»¶,çœ‹çœ‹ä¸‹é¢çš„å†…å®¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/containers.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> components <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> &#123; addTodo, toggleTodo &#125; <span class="keyword">from</span> <span class="string">'./actions'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> TodoList = connect(</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">)(components.TodoList);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>connect</code>å‡½æ•°åˆ›å»ºå®¹å™¨.å½“æˆ‘ä»¬è°ƒç”¨<code>connect()</code>å‡½æ•°,ä¼ é€’ä¸¤ä¸ªå‡½æ•°,<code>mapStateToProps()</code>å’Œ<code>mapDispatchToProps()</code>.</p>
<p><code>mapStateToProps()</code>å‡½æ•°æ¥æ”¶å½“å‰storeçš„stateä½œä¸ºå‚æ•°,æœŸå¾…è¿”å›ä¸€ä¸ªæˆ‘ä»¬åŒ…è£…ç»„ä»¶éœ€è¦çš„å¯¹è±¡æ˜ å°„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; <span class="attr">todos</span>: state &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢ä»£ç æ˜¯ä¸€ä¸ªåŒ…è£…ç»„ä»¶æ ¹æ®æ˜ å°„mapå¯è§†åŒ–çš„ç»“æœ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›<code>mapDispatchProps</code>å‡½æ•°,ä¼ é€’storeçš„<code>dispatch</code>æ–¹æ³•,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨action creatrosæ¥dispatch actions.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">addTodo</span>: <span class="function"><span class="params">text</span> =&gt;</span> dispatch(addTodo(text)),</div><div class="line">    <span class="attr">toggleTodo</span>: <span class="function"><span class="params">id</span> =&gt;</span> dispatch(toggleTodo(id))</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å†ä¸€æ¬¡å®ä¾‹åŒ–ç»„ä»¶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125;</div><div class="line">         addTodo=&#123;text =&gt; dispatch(addTodo(text))&#125;</div><div class="line">         toggleTodo=&#123;id =&gt; dispatch(toggleTodo(id))&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠaction creatorsæ˜ å°„åˆ°ç»„ä»¶,å¯ä»¥ä»äº‹ä»¶ç›‘å¬ä¸­è°ƒç”¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos, toggleTodo, addTodo &#125; = props;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> input = event.target;</div><div class="line">    <span class="keyword">const</span> text = input.value;</div><div class="line">    <span class="keyword">const</span> isEnterKey = (event.which == <span class="number">13</span>);</div><div class="line">    <span class="keyword">const</span> isLongEnough = text.length &gt; <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(isEnterKey &amp;&amp; isLongEnough) &#123;</div><div class="line">      input.value = <span class="string">''</span>;</div><div class="line">      addTodo(text);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> toggleClick = <span class="function"><span class="params">id</span> =&gt;</span> event =&gt; toggleTodo(id);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text'</div><div class="line">             className='todo__entry'</div><div class="line">             placeholder='Add todo'</div><div class="line">             onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">            &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>containerå®¹å™¨è‡ªåŠ¨è®¢é˜…storeçš„å˜åŒ–,åªè¦çš„æ˜ å°„çš„propså˜åŒ–çš„æ—¶å€™,å®¹å™¨åŒ…è£…çš„ç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“.</p>
<p>æœ€å,éœ€è¦ä½¿å®¹å™¨ç»„ä»¶ç‹¬ç«‹äºstore,ä½¿ç”¨<code>&lt;Provider/&gt;</code>ç»„ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./containers'</span>;</div><div class="line"><span class="comment">//                          ^^^^^^^^^^</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">TodoList</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>ä¸å¯å¦è®¤,å¯¹äºåˆå­¦è€…æ¥è¯´,Reactå’ŒReduxçš„ç”Ÿæ€ç³»ç»Ÿæ˜¯ç›¸å½“å¤æ‚å’Œä»¤äººè¿·æƒ‘çš„.<br>ä½†æ˜¯å¥½æ¶ˆæ¯æ˜¯è¿™äº›æ¦‚å¿µæ˜¯å¯ä»¥å¯ä»¥è½¬ç§»çš„.æˆ‘ä»¬ä»…ä»…ç²—ç•¥çš„æ¥è§¦äº†Reduxçš„åŸºç¡€æ„æ¶,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Elm æ„æ¶</code>,æˆ–è€…é€‰å–ClojureScriptåº“ä¾‹å¦‚ï¼š<code>Om</code>,<code>Re-frame</code>.ç±»ä¼¼çš„,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°immutableæ•°æ®ç»“æ„çš„åªè¨€ç‰‡è¯­,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Clojure</code>æˆ–è€…<code>Haskell</code>.</p>
<p>ä¸ç®¡ä½ æ˜¯åˆšå¼€å§‹æ¢ç´¢æœ‰å…³stateçš„webç¼–ç¨‹å¼€å‘è€…,è¿˜æ˜¯ä½¿ç”¨javascriptå¾ˆé•¿æ—¶é—´çš„å¼€å‘è€…,åŸºäºactionæ„æ¶çš„åŠæˆå’Œimmutableæ•°æ®ç»“æ„å˜å¾—è‡³è§‚é‡è¦çš„æŠ€èƒ½.æ‰€ä»¥ç°åœ¨æ˜¯å­¦ä¹ è¿™äº›å†…å®¹çš„æ—¶é—´äº†.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡æ˜¯ç¿»è¯‘ç‰ˆæœ¬,&lt;a href=&quot;https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/&quot; target=&quot;_blank&quot; rel=
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥</title>
    <link href="http://yoursite.com/2017/03/21/%E7%BF%BB%E8%AF%91-%E8%AE%A9%E6%88%91%E4%BB%AC%E6%8A%8AReact-Container%E7%BB%84%E5%90%88%E8%B5%B7%E6%9D%A5/"/>
    <id>http://yoursite.com/2017/03/21/ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥/</id>
    <published>2017-03-21T00:04:10.000Z</published>
    <updated>2017-03-23T11:29:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p><em>Arunoda Susiripala</em>  <a href="https://voice.kadira.io/let-s-compose-some-react-containers-3b91b6d9b7c8#.92sjwgug1" target="_blank" rel="external">è¯·å‚çœ‹åŸæ–‡</a></p>
</blockquote>
<p>è¿‘æ¥(Jan,2016),è‡ªç»™è‡ªè¶³çš„container(Reduxçš„å®¹å™¨)æ–¹æ³•åœ¨Reactçš„ç¤¾åŒºä¸­éå¸¸çš„æµè¡Œ.ä»–ä»¬åœ¨Realy,Reduxç”šè‡³æ˜¯åœ¨Meteorä¸­å¹¿æ³›ä½¿ç”¨.è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ·±å…¥containerå†…éƒ¨,äº†è§£ä¸€ä¸‹æ€ä¹ˆç®€ä¾¿çš„ç»„åˆcontainers.</p>
<h2 id="ä»€ä¹ˆæ˜¯Container"><a href="#ä»€ä¹ˆæ˜¯Container" class="headerlink" title="ä»€ä¹ˆæ˜¯Container?"></a>ä»€ä¹ˆæ˜¯Container?</h2><p>åœ¨Reactä¸­,æˆ‘ä»¬æœ‰propså’Œstatesæ¥ç®¡ç†ç»„ä»¶çš„æ•°æ®éœ€æ±‚.æœ€è¿‘æœ‰ä¸€ä¸ªè¶‹åŠ¿,åœ¨ç»„ä»¶ä¸­ä»…ä»…åªé€šè¿‡propsæ¥æ¥æ”¶æ•°æ®å’Œaction.æˆ‘ä»¬ä»…ä»…åœ¨ç»„ä»¶å†…éƒ¨ä¿ç•™state.</p>
<p>æˆ‘ä»¬æœ‰æ—¶å€™å«è¿™äº›ç»„ä»¶ä¸ºâ€œå•çº¯å±•ç¤ºç»„ä»¶â€.<br>æˆ‘ä¹Ÿä¸å¤ªç¡®å®šè°å‘æ˜çš„è¿™ä¸ªæœ¯è¯­.ä½†æ˜¯æˆ‘æ‰å¯èƒ½æ˜¯<a href="https://medium.com/@dan_abramov" target="_blank" rel="external">Dan Abramov</a>.<br>æŸ¥çœ‹ä¸€ä¸‹ä»–çš„æ–‡ç« â€œSmart and Dumb Componentsâ€.</p>
<p>ä½†æ˜¯æˆ‘è®¤ä¸ºå«åš<strong><code>UIç»„ä»¶</code></strong>æ›´å¥½ä¸€ç‚¹(æˆ–è€…ä»…ä»…å«åšç»„ä»¶).<br>æ¥ç€åˆå¦ä¸€å¥—ç»„ä»¶å®é™…ç®¡ç†æœ¬åœ°æ•°æ®å’Œè·å–è¿œç¨‹æ•°æ®.è¿™äº›ç»„ä»¶è¢«ç§°ä¸º<strong><code>containerç»„ä»¶</code></strong>.Relayå’ŒReduxçš„Reactç»‘å®šæ˜¯ä»–ä»¬æ›´æµè¡Œäº†.</p>
<p>ä¸‹é¢æ˜¯æ€ä¹ˆä½¿ç”¨Reat Devtoolsæ¥æŸ¥çœ‹ç»„ä»¶çš„è§†å›¾.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-f461d4894bfc06de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="1*QhMLf9dhu-cbAxN9Gc9dtg-2.png"></p>
<p>Container(BlogPost)æ¥æ”¶postId Props.ç„¶åä»–å°†ä¼šè·å–æ•°æ®ä¼ é€’åˆ°å®é™…UIç»„ä»¶ä¸­.</p>
<h2 id="Containerçš„å¸¸è§„ä»»åŠ¡"><a href="#Containerçš„å¸¸è§„ä»»åŠ¡" class="headerlink" title="Containerçš„å¸¸è§„ä»»åŠ¡"></a>Containerçš„å¸¸è§„ä»»åŠ¡</h2><p>containerçš„ä¸»è¦ä»»åŠ¡æ˜¯è·å–æ•°æ®,è¿™é‡Œé¢æœ‰ä¸€äº›äº‹æƒ…è¦åš,è®©æˆ‘ä»¬çœ‹çœ‹:</p>
<ul>
<li>è¯·æ±‚æ•°æ®(è°ƒç”¨è®¢é˜…æˆ–è€…ä»…ä»…è·å–æ•°æ®)</li>
<li>å½“æ•°æ®åŠ è½½çš„æ—¶å€™å±•ç¤ºåŠ è½½å›¾ç‰‡</li>
<li>ä¸€æ—¦æ•°æ®è¿”å›,æŠŠå®ƒä¼ é€’åˆ°UIç»„ä»¶ä¸­</li>
<li>å¦‚æœæœ‰é”™è¯¯,å±•ç¤ºç»™ç”¨æˆ·</li>
<li>å½“propsæ”¹å˜äº†,éœ€è¦é‡æ–°è·å–æˆ–è€…é‡æ–°è®¢é˜…</li>
<li>å½“containerå¸è½½çš„æ—¶å€™,éœ€è¦æ¸…é™¤èµ„æº.</li>
</ul>
<p>è¿™é‡Œcontaineræœ‰å¾ˆå¤šçš„ä»»åŠ¡è¦å®Œæˆ.å¦‚æœä½ æƒ³è‡ªå·±åšè¿™äº›ä»»åŠ¡,ä½ å°±ä¸å¾—ä¸åšä¸€äº›é‡å¤çš„å·¥ä½œ,å‘ç”Ÿé”™è¯¯çš„æ¥æºå°±ç”±æ­¤è¯ç”Ÿäº†.</p>
<h2 id="React-Komposerçš„ä»‹ç»"><a href="#React-Komposerçš„ä»‹ç»" class="headerlink" title="React Komposerçš„ä»‹ç»"></a>React Komposerçš„ä»‹ç»</h2><p>React Komposerè¯•å›¾å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“çš„åˆå¹¶containers.æœ‰äº†å®ƒ,ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®èµ„æº,ä¸ç®¡ä½ çš„æ•°æ®æ˜¯æ¥è‡ªäºPromise,Observableç”šè‡³æ˜¯Meteorâ€˜s Tracker.</p>
<h3 id="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3><p>åƒä¸‹é¢è¿™æ ·åˆ›å»ºä¸€ä¸ª<em>æ•°å­—æ—¶é’Ÿ</em>:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-10d84673aea28707.gif?imageMogr2/auto-orient/strip" alt="Digital clock"></p>
<p>è¿™æ˜¯ä¸€ä¸ªå¥½çš„å®ä¾‹,å› ä¸ºæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸ªcontainerçš„å‡ ä¹æ‰€æœ‰çš„åŠŸèƒ½.å¼€å§‹</p>
<p>é¦–å…ˆå®‰è£…react-komposer:</p>
<p><code>npm i â€” save react-komposer</code></p>
<p>ç„¶åè¾“å…¥composeå‡½æ•°ï¼š<br><code>import {compose} from â€˜react-komposerâ€™;</code></p>
<p>ç°åœ¨éœ€è¦ä¸€ä¸ªUIç»„ä»¶å»æ¸²æŸ“æ—¶é—´:</p>
<p><code>const Time = ({time}) =&gt; (&lt;div&gt;{time}&lt;/div&gt;);</code></p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„ç»„åˆå‡½æ•°:</p>
<p>è·å–æ—¶é—´çš„æ—¶å€™éœ€è¦è°ƒç”¨<code>onData</code>å›è°ƒå‡½æ•°(è¿™é‡Œæ²¡æœ‰å®é™…åšä»€ä¹ˆ.)</p>
<p>éœ€è¦è°ƒç”¨<code>onData</code>å‡½æ•°å¤šå°‘æ¬¡å¯ä»¥,åªè¦ç¨‹åºéœ€è¦.å¦‚æœæœ‰é”™è¯¯,å¯ä»¥æŠŠé”™è¯¯ä¿¡æ¯ä½œä¸º<code>onData</code>çš„ç¬¬ä¸€ä¸ªå€¼.</p>
<p>æœ€å,æˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ªæ¸…é™¤èµ„æºçš„é¢å‡½æ•°.åœ¨è¿™ä¸ªå®ä¾‹ä¸­ç”¨ä»–æ¥æ¸…é™¤setIntervaçš„å¥æŸ„.</p>
<p>å¥½äº†,ç°åœ¨æ¥åˆå¹¶ä¸€ä¸‹composer:<br><code>const Clock = compose(composerFunction)(Time);</code></p>
<p>ç„¶åæ¸²æŸ“åˆ°DOMä¸­:<br><code>ReactDOM.render(&lt;Clock /&gt;, document.body);</code></p>
<p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè‡ªæˆ‘ç®¡ç†(state)çš„æ—¶é’Ÿ.<a href="https://jsfiddle.net/arunoda/jxse2yw8/" target="_blank" rel="external">çœ‹çœ‹å®é™…æ¼”ç¤º</a>.</p>
<p>è¿™é‡Œæœ‰ä¸ª<a href="https://jsfiddle.net/arunoda/7qy1mxc7/" target="_blank" rel="external">æ›´å¤æ‚çš„ç‰ˆæœ¬</a>,ä½¿ç”¨props,å¤„ç†é”™è¯¯ä¿¡æ¯.</p>
<p>ä½ ä¹Ÿå¯ä»¥æ”¹å˜é»˜è®¤åŠ è½½å’Œé”™è¯¯ç»„ä»¶.æŸ¥çœ‹ä¸€ä¸‹<a href="https://github.com/kadirahq/react-komposer#api" target="_blank" rel="external">react-komposer æ–‡æ¡£</a>.</p>
<p>è·å¾—å¥½å¤„:æ›´å®¹æ˜“æµ‹è¯•</p>
<p>ä½œä¸ºè¿™ä¸ªç»„ä»¶çš„é™„åŠ æ•ˆæœ,æˆ‘ä»¬ç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“æµ‹è¯•UIä»£ç .</p>
<ul>
<li>å› ä¸ºUIç»„ä»¶ä»…ä»…é€šè¿‡propsæ¥æ”¶æ•°æ®(å’Œaction),æ˜¯çš„æµ‹è¯•å¾ˆå®¹æ˜“.</li>
<li>ä¹Ÿå¯ä»¥æµ‹è¯•ç»„åˆå‡½æ•°çš„æ•°æ®è·å–é€»è¾‘.</li>
</ul>
<h2 id="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"><a href="#å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ" class="headerlink" title="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"></a>å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ</h2><p>æˆ‘å·²ç»æåˆ°è¿‡,å¯ä»¥ä½¿ç”¨è¿™ä¸ªç»„ä»¶å’Œä»»ä½•æ•°æ®æºä¸€èµ·å·¥ä½œ,å› ä¸ºç»„åˆçš„APIæ˜¯é€šç”¨çš„.æˆ‘ä»¬æœ‰å¤„ç†æµè¡Œæ•°æ®æºçš„ç‰¹å®šAPIS.<br> è¿™é‡Œæ˜¯:</p>
<ul>
<li><em>composeWithPromise</em>ç”¨äºPromise-baseed æ•°æ®æº</li>
<li><em>composeWithObservable</em>ç”¨äºRx.js Observalbe-basedæ•°æ®æº</li>
<li><em>composeWithTracker</em>å‡ºäº‹ç‰¹æ®Šçš„ä¸€äº›æ•°æ®æº.</li>
</ul>
<p>æœ‰äº†è¿™äº›API,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨react-komposerå»åˆå¹¶ä»»ä½•æ•°æ®æºçš„container.</p>
<p>çœ‹çœ‹<a href="https://github.com/kadirahq/react-komposer#using-with-xxx" target="_blank" rel="external">repo</a>,æœ‰æ›´å¤šçš„ä¾‹å­.</p>
<p>åœ¨ä½ çš„appä¸­ä½¿ç”¨ä¸€ä¸‹react-komposer,ä½ ä¼šå–œæ¬¢ä¸Šä»–çš„.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Arunoda Susiripala&lt;/em&gt;  &lt;a href=&quot;https://voice.kadira.io/let-s-compose-some-react-containers-3b91b6d9b7c8#.92sjwgug1&quot; t
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†</title>
    <link href="http://yoursite.com/2017/03/20/javascript%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%EF%BC%8C%E9%B8%AD%E5%AD%90%E7%BB%88%E4%BA%8E%E7%85%AE%E7%86%9F%E4%BA%86/"/>
    <id>http://yoursite.com/2017/03/20/javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†/</id>
    <published>2017-03-20T00:04:10.000Z</published>
    <updated>2017-03-23T12:06:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>å†¬è‡³æ¥äº†ï¼Œåˆšå»åƒäº†ä¸€ç¢—èåœé¥ºå­ï¼Œæµ‘èº«å‘çƒ­ã€‚çªç„¶è§‰å¾—é¸­å­å·²ç»ç†Ÿäº†ã€‚</p>
<p>å¼€ä¸ªç©ç¬‘ã€‚è¿™é‡Œè¦è¯´çš„æ˜¯åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»å‹(ducking type)ã€‚ <code>è¿™ä¸ªè¯é¢˜åº”è¯¥æ˜¯æ•´ä¸ªjavascripté¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³</code>.ä¸çŸ¥é“ä¸‹è¿™ä¸ªç»“è®ºå¯¹ä¸å¯¹ï¼Ÿå¯æ˜¯åœ¨å‰é¢è¿˜ä¸å¤ªäº†è§£åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ã€‚çœ‹ä»£ç çš„æ—¶å€™æ€»æœ‰ç§æ„Ÿè§‰ï¼Œå°±æ˜¯javascriptå¤ªçµæ´»äº†ï¼Œæ€ä¹ˆä»€ä¹ˆå¯¹è±¡çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡å‚æ•°ä¼ é€’çš„æ–¹å¼æ¥åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ã€‚åœ¨æ¨¡å¼å­¦ä¹ æ—¶å¸¸çœ‹åˆ°è¿™ç§ä»£ç ã€‚<br>åˆšæ‰åˆé‡æ–°çœ‹è¿™éƒ¨åˆ†å†…å®¹æ—¶çªç„¶æ˜ç™½äº†ã€‚è¿™ä¸ªæ–¹æ³•å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹é‡Œçš„é¸­å­æ¨¡å‹ã€‚</p>
<p>ä»€ä¹ˆæ˜¯é¸­å­ç±»å‹å‘¢ï¼Ÿæˆ‘æ€»ç»“ä¸€å¥è¯ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦èƒ½å¹²æ´»å°±è¡Œã€‚javascripté‡Œé¢å¯¹è±¡éƒ½æ˜¯è“é¢†ï¼Œåªå¹²æ´»ï¼Œè‡³äºæ˜¯å°å­¦æ°´å¹³è¿˜æ˜¯åšå£«æ°´å¹³ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒï¼Œèƒ½å¹²æ´»å°±è¡Œã€‚ javaè¯­è¨€å°±ä¸æ˜¯ï¼Œjavaåœ¨ä½ å¹²æ´»ä¹‹å‰æƒ³è¦æŠŠä½ çš„ç¥–å®—åå…«ä»£éƒ½æŸ¥ä¸€éï¼Œæ ¹æ­£è‹—çº¢çš„æ‰èƒ½æ¥å¹²æ´»ã€‚æ‰€ä»¥javascriptå°±å¾ˆçµæ´»å•¦ã€‚</p>
<p>è¿™å°±æ˜¯é¸­å­ç±»å‹ã€‚<code>å¦‚æœå®ƒèµ°èµ·è·¯æ¥åƒé¸­å­ï¼Œå«èµ·æ¥å˜å˜çš„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­</code>ã€‚</p>
<p>é¸­å­ç±»å‹èµ‹äºˆäº†javascriptæå¤§çš„çµæ´»æ€§ï¼ŒåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„æ—¶å€™éå¸¸è‡ªç”±ã€‚ </p>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ ç¬¬ä¸€ç« </p>
<p>çœ‹ä¸‹é¢ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> duck = &#123;  <span class="comment">//é¸­å­å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> chicken = &#123;  <span class="comment">//é¸¡å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> choir = []; <span class="comment">// åˆå”±å›¢</span></div><div class="line">	<span class="keyword">var</span> joinChoir = <span class="function"><span class="keyword">function</span>(<span class="params"> animal </span>)</span>&#123; <span class="comment">//å®ä¾‹åŒ–åŠ¨ç‰©å¯¹è±¡</span></div><div class="line">		<span class="keyword">if</span> ( animal &amp;&amp; <span class="keyword">typeof</span> animal.duckSinging === <span class="string">'function'</span> )&#123; </div><div class="line">       <span class="comment">//ç¨ä½œæ£€æµ‹ï¼Œåªè¦æœ‰å”±æ­Œçš„æ–¹æ³•å°±å¯ä»¥ç”¨ã€‚</span></div><div class="line">			choir.push( animal );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ­å–œåŠ å…¥åˆå”±å›¢'</span> );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'åˆå”±å›¢å·²æœ‰æˆå‘˜æ•°é‡:'</span> + choir.length );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	joinChoir( duck ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div><div class="line">	joinChoir( chicken ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªé¸­å­ç±»å‹çš„ä»£ç ï¼Œ é¸¡ä¹Ÿæ··å…¥åˆå”±å›¢äº†ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦ä½ èƒ½å”±æ­Œå°±è¡Œäº†ã€‚<br>å¾ˆæ–¹ä¾¿å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚ javascriptä»£ç ä¸­éå¸ƒè¿™æ ·çš„ä¾‹å­ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥ä¸€ç‚¹ä¹Ÿä¸å¥‡æ€ªäº†ã€‚å› ä¸ºè¿™é¸­å­ç±»å‹å°±æ˜¯åŠ¨æ€è¯­è¨€çš„ä¼˜åŠ¿ã€‚è€Œjavascriptå°±æ˜¯åŠ¨æ€è¯­è¨€ä¹‹ä¸€ï¼Œåªæ˜¯å®ç°äº†è¿™ç§æ¨¡å¼è€Œå·²ã€‚</p>
<p>å¯¹äºè¿™ä¸ªé—®é¢˜çš„è®¤è¯†ä¹Ÿç ´è´¹å‘¨æŠ˜ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥æ˜¯å€¼å¾—çš„ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå¯¹javascriptçš„åº”ç”¨èƒ½åŠ›å°±æ›´åŠ æ·±äº†ä¸€æ­¥ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å†¬è‡³æ¥äº†ï¼Œåˆšå»åƒäº†ä¸€ç¢—èåœé¥ºå­ï¼Œæµ‘èº«å‘çƒ­ã€‚çªç„¶è§‰å¾—é¸­å­å·²ç»ç†Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¼€ä¸ªç©ç¬‘ã€‚è¿™é‡Œè¦è¯´çš„æ˜¯åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»å‹(ducking type)ã€‚ &lt;code&gt;è¿™ä¸ªè¯é¢˜åº”è¯¥æ˜¯æ•´ä¸ªjavascripté¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³&lt;/code&gt;.ä¸çŸ¥é“ä¸‹è¿™ä¸ªç»“è®ºå¯¹ä¸å¯¹ï¼Ÿå¯æ˜¯åœ¨å‰é¢
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/19/javascript%E7%9A%84%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/19/javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼/</id>
    <published>2017-03-19T00:04:10.000Z</published>
    <updated>2017-03-23T12:05:48.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ç§åªéœ€è¦ä½¿ç”¨ç»§æ‰¿å°±å¯ä»¥å®ç°çš„éå¸¸ç®€å•çš„æ¨¡å¼<br> æ¨¡æ¿æ–¹æ³•ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€æ˜¯æŠ½è±¡çš„çˆ¶ç±»ï¼ŒäºŒæ˜¯å…·ä½“å®ç°çš„å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°ä¸€äº›å…¬å…±æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚</p>
</blockquote>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬11ç« </p>
<p>è¿™ä¸ªæ¨¡å¼æ–¹æ³•å¾ˆæœ‰æ„æ€,åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„é¢è¿‡ç¨‹ï¼Œæ˜¯å¯¹ç±»ä¼¼çš„ç”Ÿäº§è¿‡ç¨‹çš„å…·ä½“ç»†èŠ‚çš„ç†è§£ï¼Œæ‰¾å‡ºæµç¨‹ä¸­çš„å…±åŒç‚¹ä½œä¸ºæŠ½è±¡çš„çˆ¶ç±»ã€‚<br>å’–å•¡å’ŒèŒ¶çš„å†²æ³¡è¿‡ç¨‹</p>
<table>
<thead>
<tr>
<th style="text-align:left">æ³¡<code>å’–å•¡</code></th>
<th style="text-align:left">æ³¡<code>èŒ¶</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
</tr>
<tr>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æ³¡å’–å•¡</code></td>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æµ¸æ³¡èŒ¶å¶</code></td>
</tr>
<tr>
<td style="text-align:left">æŠŠ<code>å’–å•¡</code>å€’è¿›æ¯å­</td>
<td style="text-align:left">æŠŠ<code>èŒ¶æ°´</code>å€’è¿›æ¯å­</td>
</tr>
<tr>
<td style="text-align:left">åŠ <code>ç³–å’Œç‰›å¥¶</code></td>
<td style="text-align:left">åŠ <code>æŸ æª¬</code></td>
</tr>
</tbody>
</table>
<p>æŠŠæ³¡å’–å•¡å’Œæ³¡èŒ¶çš„ä¸åŒç‚¹æ ‡ç¤ºå‡ºæ¥ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯å…±åŒçš„éƒ¨åˆ†</p>
<ul>
<li>[ ] åŸæ–™ä¸åŒï¼Œä¸€ä¸ªæ˜¯å’–å•¡ï¼Œä¸€ä¸ªæ˜¯èŒ¶ã€‚æŠ½è±¡ä¸ºé¥®æ–™</li>
<li>[ ] æ³¡çš„æ–¹å¼ä¸åŒï¼Œä¸€ä¸ªæ˜¯æ³¡ï¼Œä¸€ä¸ªæ˜¯æµ¸æ³¡ã€‚ç»Ÿä¸€æŠ½è±¡ä¸ºæ³¡</li>
<li>[ ] åŠ å…¥çš„è°ƒå‘³å“ä¸åŒï¼Œä¸€ä¸ªæ˜¯ç³–å’Œç‰›å¥¶ï¼Œä¸€ä¸ªæ˜¯æŸ æª¬ã€‚æŠ½è±¡ä¸ºè°ƒæ–™<br>æ•´ä¸ªå†²æ³¡é¥®æ–™çš„è¿‡ç¨‹å°±æŠ½è±¡ä¸ºä¸‹é¢çš„æµç¨‹</li>
</ul>
<ol>
<li>æŠŠæ°´ç…®æ²¸</li>
<li>ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</li>
<li>æŠŠé¥®æ–™å€’è¿›è¢«å­</li>
<li>åŠ è°ƒæ–™</li>
</ol>
<p>æŠ½è±¡çš„çˆ¶ç±»çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; </div><div class="line">Beverage.prototype.boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log( <span class="string">'æŠŠæ°´ç…®æ²¸'</span> );</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Beverage.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å®šä¹‰å­ç±»çš„å‡½æ•°æ‰§è¡Œé¡ºåº</span></div><div class="line">	<span class="keyword">this</span>.boilWater();</div><div class="line">	<span class="keyword">this</span>.brew();</div><div class="line">	<span class="keyword">this</span>.pourInCup();</div><div class="line">	<span class="keyword">this</span>.addCondiments();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ‰äº†çˆ¶ç±»çš„æ¨¡æ¿ï¼Œåœ¨ç…®èŒ¶æ˜¯å°±ä¾ç…§çˆ¶ç±»çš„æ¨¡æ¿æ¥ä½¿ç”¨ï¼Œé€šç”¨éƒ¨åˆ†ä¸åŠ¨ï¼Œç‰¹æ®Šçš„åœ°æ–¹é‡å†™çˆ¶ç±»çš„æ–¹æ³•</p>
<p>èŒ¶å¶å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ¨¡æ¿</p>
<pre><code>var Tea = function(){}; //å®šä¹‰ç…®èŒ¶å­ç±»
Tea.prototype = new Beverage(); //ç»§æ‰¿çˆ¶ç±»
Tea.prototype.brew = function(){ //é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&apos; );
};
Tea.prototype.pourInCup = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;æŠŠèŒ¶å€’è¿›æ¯å­&apos; );
};
Tea.prototype.addCondiments = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;åŠ æŸ æª¬&apos; );
};
var tea = new Tea(); //å®ä¾‹åŒ–å­ç±»
tea.init(); //ä¾ç…§çˆ¶ç±»çš„æ–¹æ³•æ‰§è¡Œé¡ºåºæ¥æ‰§è¡Œ

//ç”±äºjavascriptçš„å¯¹è±¡åŸå‹ç»§æ‰¿é“¾çš„æ–¹å¼å’Œjavaçš„ç»§æ‰¿æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¿™é‡Œä»£ç ç»“æ„å’Œjavaç±»ä¼¼ï¼Œä½†æ˜¯é‡Œé¢çš„æœºåˆ¶æ˜¯ä¸åŒçš„

<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line"></div><div class="line"><span class="clean">#####é’©å­æ–¹æ³•</span></div><div class="line"></div><div class="line"><span class="number">1.</span> æŠŠæ°´ç…®æ²¸</div><div class="line"><span class="number">2.</span> ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</div><div class="line"><span class="number">3.</span> æŠŠé¥®æ–™å€’è¿›è¢«å­</div><div class="line"><span class="number">4.</span> åŠ è°ƒæ–™</div><div class="line"></div><div class="line">ä¸Šé¢æ˜¯ä¸€èˆ¬çš„å†²è°ƒé¥®æ–™çš„æµç¨‹ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚æœ‰çš„äººå¯èƒ½ä¸ä¼šåŠ è°ƒæ–™ã€‚é‡åˆ°è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨`é’©å­æ–¹æ³•`æ¥åœ¨éš”ç¦»æœ‰å˜åŒ–çš„æ­¥éª¤</div></pre></td></tr></table></figure>
</code></pre><p>var Beverage = function(){};<br>    Beverage.prototype.boilWater = function(){<br>        console.log( â€˜æŠŠæ°´ç…®æ²¸â€™ );<br>    };<br>    Beverage.prototype.brew = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™brew æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.pourInCup = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™pourInCup æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.addCondiments = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™addCondiments æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.customerWantsCondiments = function(){<br>        return true; // é»˜è®¤éœ€è¦è°ƒæ–™<br>    };<br>    Beverage.prototype.init = function(){<br>        this.boilWater();<br>        this.brew();<br>        this.pourInCup();<br>    if ( this.customerWantsCondiments() ){ // å¦‚æœæŒ‚é’©è¿”å›trueï¼Œåˆ™éœ€è¦è°ƒæ–™<br>        this.addCondiments(); //ç¬¬å››æ­¥å°±å˜ä¸ºå¯é€‰çš„æ–¹æ³•äº†<br>    }<br>};<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å®ä¾‹åŒ–å†²æ³¡å’–å•¡çš„å®ä¾‹</div></pre></td></tr></table></figure></p>
<p> var CoffeeWithHook = function(){};<br> CoffeeWithHook.prototype = new Beverage();<br>CoffeeWithHook.prototype.brew = function(){<br>    console.log( â€˜ç”¨æ²¸æ°´å†²æ³¡å’–å•¡â€™ );<br>};<br>CoffeeWithHook.prototype.pourInCup = function(){<br>    console.log( â€˜æŠŠå’–å•¡å€’è¿›æ¯å­â€™ );<br>};<br>CoffeeWithHook.prototype.addCondiments = function(){<br>    console.log( â€˜åŠ ç³–å’Œç‰›å¥¶â€™ );<br>};<br>CoffeeWithHook.prototype.customerWantsCondiments = function(){<br>    return window.confirm( â€˜è¯·é—®éœ€è¦è°ƒæ–™å—ï¼Ÿâ€™ );//å¯¹é¡¾å®¢é€‰æ‹©çš„åˆ¤æ–­æ¡ä»¶<br>};<br>var coffeeWithHook = new CoffeeWithHook();</p>
<p>```</p>
<p>æ¨¡æ¿æ–¹æ³•é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ç§åªéœ€è¦ä½¿ç”¨ç»§æ‰¿å°±å¯ä»¥å®ç°çš„éå¸¸ç®€å•çš„æ¨¡å¼&lt;br&gt; æ¨¡æ¿æ–¹æ³•ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€æ˜¯æŠ½è±¡çš„çˆ¶ç±»ï¼ŒäºŒæ˜¯å…·ä½“å®ç°çš„å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°ä¸€äº›å…¬å…±æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚&lt;/p&gt;
&lt;/blockquote
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptç»„åˆæ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/18/javascript%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/18/javascriptç»„åˆæ¨¡å¼/</id>
    <published>2017-03-17T23:04:10.000Z</published>
    <updated>2017-03-23T12:19:01.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ç”±æ›´å°çš„å¯¹è±¡ç»„æˆçš„ã€‚è¿™é‡Œåªæ˜¯ç»„åˆï¼Œå¹¶æ²¡æœ‰ä»å±å…³ç³»ã€‚å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬åç« </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®å‘½ä»¤çš„ä»£ç </span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openPcCommand = &#123; <span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openQQCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//ç»„åˆæ¨¡å¼çš„æ ¹å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;<span class="comment">//å¶å¯¹è±¡ä½œä¸ºæ•°ç»„çš„å…ƒç´ ä¼ é€’åˆ°</span></div><div class="line">			<span class="comment">//æ•°ç»„ä¸­</span></div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰§è¡Œç»„åˆå‘½ä»¤</span></div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute(); <span class="comment">//å¶å¯¹è±¡éƒ½æœ‰executeæ–¹æ³•</span></div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> macroCommand = MacroCommand();</div><div class="line">	macroCommand.add( closeDoorCommand );<span class="comment">//æ·»åŠ åˆ°æ ¹å¯¹è±¡æ•°ç»„ä¸­</span></div><div class="line">	macroCommand.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.add( openQQCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.execute();<span class="comment">//æ‰§è¡Œæ ¹å‘½ä»¤</span></div></pre></td></tr></table></figure>
<p><em>ä¸¤ä¸ªè¦ç‚¹</em>:1.jså¯¹è±¡å¼•ç”¨å¯ä»¥ä½œä¸ºæ•°ç»„å…ƒç´ åŠ å…¥åˆ°æ•°ç»„ä¸­ã€‚2. å¶å¯¹è±¡éƒ½æœ‰ä¸€æ ·çš„executeæ–¹æ³•ã€‚åœ¨æ ¹å¯¹è±¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨leaf.executeçš„æ¨¡å¼æ¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>åœ¨å¶å¯¹è±¡ä¸­è¿˜å¯ä»¥ç»§ç»­æ‰©å±•ä¹Ÿå¯¹è±¡ï¼Œç»„åˆçš„æ·±åº¦ç»§ç»­åŠ æ·±ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ ¹å¯¹è±¡çš„æ–¹æ³•ä¿æŒä¸å˜</span></div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openAcCommand = &#123;</div><div class="line">		<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç©ºè°ƒ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"><span class="comment">/**********å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤</span></div><div class="line">*********/</div><div class="line"><span class="keyword">var</span> openTvCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç”µè§†'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openSoundCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€éŸ³å“'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand1 = MacroCommand(); <span class="comment">//ç¬¬ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openTvCommand ); <span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openSoundCommand );<span class="comment">//åŒä¸Š</span></div><div class="line"><span class="comment">/*********å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½•QQ çš„å‘½ä»¤****************/</span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openPcCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openQQCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand2 = MacroCommand();<span class="comment">//ç¬¬äºŒä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( closeDoorCommand );<span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">macroCommand2.add( openQQCommand );</div><div class="line"><span class="comment">/*********ç°åœ¨æŠŠæ‰€æœ‰çš„å‘½ä»¤ç»„åˆæˆä¸€ä¸ªâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> macroCommand = MacroCommand(); <span class="comment">//é¡¶çº§æ ¹å¯¹è±¡</span></div><div class="line">macroCommand.add( openAcCommand ); <span class="comment">//ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand.add( macroCommand1 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line">macroCommand.add( macroCommand2 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line"><span class="comment">/*********æœ€åç»™é¥æ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> setCommand = (<span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		command.execute();</div><div class="line">	&#125;</div><div class="line">&#125;)( macroCommand );</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//æœ€ç»ˆæ‰€æœ‰çš„å¶å¯¹è±¡çš„å¼•ç”¨éƒ½æ·»åŠ åˆ°commandlistæ•°ç»„ä¸­ï¼Œåœ¨æ ¹å¯¹è±¡ä¸Šæ‰§è¡Œ</span></div><div class="line"><span class="comment">//executeæ–¹æ³•æ—¶ï¼Œä¼šéå†æ‰€æœ‰çš„å¶å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œleaf.execute()æ–¹æ³•ã€‚</span></div><div class="line"><span class="comment">//å¾—åˆ°ç»“æœ</span></div></pre></td></tr></table></figure>
<p>#####æœ€ç»ˆè¿˜æ˜¯ä½¿ç”¨äº†javascriptçš„æ•°ç»„æ“ä½œå’Œå¯¹è±¡æ“ä½œçš„ä¾¿åˆ©æ€§ã€‚åœ¨javascriptçš„æ¨¡å¼è®¾è®¡ä¸­ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨æ“ä½œæ•°ç»„å’Œå¯¹è±¡ã€‚æ‰€æœ‰æœ‰å¿…è¦è¿˜å¥½åœ¨æ·±åˆ»ç†è§£ä¸€ä¸‹æ•°ç»„å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>è¿™ä¸ªç³»åˆ—å†™äº†å¥½å‡ ç¯‡æ–‡ç« äº†ã€‚å…¶å®å†™çš„æ—¶å€™å¥½å¤šåœ°æ–¹è¿˜ä¸å¤ªæ‡‚ï¼Œå†™ç€å†™ç€æœ‰äº›åœ°æ–¹å°±æ˜ç™½äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦åšæŒå†™ä¸‹å»ã€‚ç°åœ¨è§‰å¾—å†™çš„è¿˜ä¸é”™ï¼Œè¿‡åŠå¹´å¯èƒ½è§‰å¾—å°±å¾ˆå‚»äº†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ç”±æ›´å°çš„å¯¹è±¡ç»„æˆçš„ã€‚è¿™é‡Œåªæ˜¯ç»„åˆï¼Œå¹¶æ²¡æœ‰ä»å±å…³ç³»ã€‚å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬åç« &lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptæ¡¥æ¥æ¨¡å¼(2)</title>
    <link href="http://yoursite.com/2017/03/17/javascript%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F(2)/"/>
    <id>http://yoursite.com/2017/03/17/javascriptæ¡¥æ¥æ¨¡å¼(2)/</id>
    <published>2017-03-17T13:04:10.000Z</published>
    <updated>2017-03-23T12:12:26.000Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>äº‹ä»¶ç›‘å¬å™¨</li>
<li>æ¡¥æ¥æ¨¡å¼çš„å…¶ä»–ä¾‹å­<br>è¿™å®é™…å°±æ˜¯ä¸€ä¸ªé—­åŒ…çš„ä¾‹å­ï¼Œé€šè¿‡é—­åŒ…å‡½æ•°è·å–å¤–å±‚å‡½æ•°ä½œç”¨åŸŸå†…å®šä¹‰çš„ç§æœ‰å˜é‡ã€‚è¿™ä¸ªå‡½æ•°åˆå¯ä»¥å«åšç‰¹æƒå‡½æ•°ï¼Œgetterå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªgetä¸set.       </li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> <span class="keyword">Public</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">var</span> secret = <span class="number">3</span>;</div><div class="line">  this.privilegedGetter = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> secret;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="keyword">Public</span>;</div><div class="line"><span class="keyword">var</span> data = o.privilegedGetter();</div></pre></td></tr></table></figure>
<p>3 .  ç”¨æ¡¥æ¥æ¨¡å¼è”ç»“å¤šä¸ªç±».é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œå¦‚æœä»£ç ä»ä¸Šå¾€ä¸‹çœ‹æ˜¯èšåˆäº†è¿ä¸ªç±»ã€‚åœ¨æ¡¥æ¥ç±»ä¸­ç»Ÿä¸€è¿”å›ã€‚å¦‚æœæ˜¯ä»ä¸‹å¾€ä¸Šçœ‹ä»£ç ï¼Œå®é™…æ˜¯æŠŠä¸€ä¸ªå®Œæ•´çš„ä»£ç æ‹†æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„ç±»ï¼Œè¿™æ ·ä¸¤ä¸ªç‹¬ç«‹çš„ç±»å¯ä»¥ä¿®æ”¹è‡ªå·±çš„é€»è¾‘ï¼Œä¸ä¼šå½±å“åˆ°å¦ä¸€ç±»çš„å·¥ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">var</span> Class1 = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = a;</div><div class="line">  <span class="keyword">this</span>.b = b;</div><div class="line">  <span class="keyword">this</span>.c = c;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> Class2 = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.d = d;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> BridgeClass = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.one = <span class="keyword">new</span> Class1(a, b, c);</div><div class="line">  <span class="keyword">this</span>.two = <span class="keyword">new</span> Class2(d);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>4 . æ„å»ºXHRè¿æ¥é˜Ÿåˆ—</p>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;äº‹ä»¶ç›‘å¬å™¨&lt;/li&gt;
&lt;li&gt;æ¡¥æ¥æ¨¡å¼çš„å…¶ä»–ä¾‹å­&lt;br&gt;è¿™å®é™…å°±æ˜¯ä¸€ä¸ªé—­åŒ…çš„ä¾‹å­ï¼Œé€šè¿‡é—­åŒ…å‡½æ•°è·å–å¤–å±‚å‡½æ•°ä½œç”¨åŸŸå†…å®šä¹‰çš„ç§æœ‰å˜é‡ã€‚è¿™ä¸ªå‡½æ•°åˆå¯ä»¥å«åšç‰¹æƒå‡½æ•°ï¼Œgetterå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªgetä¸set.       &lt;/li&gt;
&lt;/ol&gt;
&lt;figure cla
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptå•ä¾‹æ¨¡å¼(1)</title>
    <link href="http://yoursite.com/2017/03/16/javascript%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F(1)/"/>
    <id>http://yoursite.com/2017/03/16/javascriptå•ä¾‹æ¨¡å¼(1)/</id>
    <published>2017-03-16T00:04:10.000Z</published>
    <updated>2017-03-23T12:04:42.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å•ä¾‹(singleton).è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ç§å°†ä»£ç ç»„ç»‡ä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒçš„æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡å•ä¸€å˜é‡æ¥è®¿é—®ã€‚é€šè¿‡ç¡®ä¿å•ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªæ‹·è´ï¼Œå¯ä»¥ç¡®ä¿ä»£ä¹°ä½¿ç”¨ç«¥é¢œçš„å…¨å±€èµ„æºã€‚å•ä¾‹å¯ä»¥ç”¨æ¥åˆ’åˆ†å‘½åç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ©å•ä¾‹æŠŠä»£ç ç»„ç»‡çš„æ›´ä¸ºä¸€è‡´ï¼Œä»è€Œæ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚</p>
</blockquote>
<pre><code>æœ¬æ–‡å‚ç…§è¿™æœ¬ä¹¦ç¬¬äº”ç« ï¼Œä»‹ç»çš„é‡ç‚¹å’Œå¦ä¸€æœ¬ä¹¦å¥½åƒæ˜¯ä¸åŒçš„ã€‚ç»“åˆç€çœ‹çœ‹    
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2044710-c97bcd5773f19459.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="s3398900.jpg"></p>
<p>####å•ä¾‹çš„åŸºæœ¬ç»“æ„<br>æœ€åŸºæœ¬çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯¹è±¡å­—é¢é‡ä½œä¸ºå•ä½“</span></div><div class="line"><span class="keyword">var</span> Singleton = &#123;</div><div class="line">  <span class="attr">attribute1</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">attribute2</span>: <span class="number">10</span>,</div><div class="line"></div><div class="line">  <span class="attr">method1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">method2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Singleton.attribute1 = <span class="literal">false</span>; <span class="comment">//ä¿®æ”¹</span></div><div class="line"><span class="keyword">var</span> total = Singleton.attribute2 + <span class="number">5</span>; <span class="comment">//ä½¿ç”¨å•ä¾‹</span></div><div class="line"><span class="keyword">var</span> result = Singleton.method1();</div></pre></td></tr></table></figure>
<p><code>æ–¹æ³•ä½äºå¯¹è±¡å­—é¢é‡ä¸­å°±æœ‰äº†å‘½åç©ºé—´ï¼Œå’Œå…¶ä»–åŒåçš„å‡½æ•°å°±ä¸ä¼šå†²çªäº†ã€‚å¯¹è±¡å­—é¢é‡é‡Œçš„æ–¹æ³•ç»Ÿä¸€ç”¨  nameSpace.methodçš„æ ¼å¼è°ƒç”¨</code><br>å¯¹è±¡å­—é¢é‡çš„å‘½åç©ºé—´è¿˜å¯ä»¥ç»§ç»­åˆ’åˆ†ä¾‹å¦‚parent.children.methodã€‚<br>è¿™æ ·ä¸ä»…å˜é‡å‘ç”Ÿå†²çªçš„æœºä¼šå¤§å¤§å‡å°‘ï¼Œè€Œä¸”å½’å±æ›´æ˜ç¡®äº†ã€‚</p>
<p>ä¸Šé¢çš„å¯¹è±¡å­—é¢é‡çš„å•ä¾‹æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Ÿ åœ¨nodeç¨‹åºä¸­çš„é…ç½®æ–‡ä»¶config.jsé‡Œé¢æ˜¯ä¸æ˜¯éƒ½æ˜¯è¿™ç§ä»£ç ï¼Ÿ é…ç½®é¡¹éƒ½æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚</p>
<p>#####æƒ°æ€§å®ä¾‹åŒ–<br>æœ¬æ¥å•ä¾‹æ˜¯æƒ³å†™è¿™ä¸ªå†…å®¹çš„ï¼Œä½†æ˜¯ä»Šå¤©ä¸€çœ‹ï¼Œè¿˜æ˜¯æ²¡çœ‹å…¨ã€‚æ›¾æ¢çš„jsæ¨¡å¼ä¹¦é‡Œçš„å•ä¾‹å…¶å®éƒ½æ˜¯è¿™ä¸ªéƒ¨åˆ†ã€‚<code>å®é™…çš„å•ä¾‹ä»£ç æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥ç¼“å­˜å®ä¾‹åŒ–çš„ä»£ç ï¼Œå¦‚æœå·²ç»å®ä¾‹åŒ–å°±ç›´æ¥è¿”å›ç¼“å­˜çš„ä»£ç ã€‚</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">  MyNamespace.Singleton = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">var</span> uniqueInstance; <span class="comment">// ç§æœ‰å˜é‡ç¼“å­˜å®ä¾‹åŒ–å•ä¾‹</span></div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">constructor</span>(<span class="params"></span>) </span>&#123; <span class="comment">// å…·ä½“éœ€è¦æŒ‰éœ€åŠ è½½çš„ä»£ç .</span></div><div class="line">    <span class="keyword">var</span> privateAttribute1 = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">var</span> privateAttribute2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod2</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123; <span class="comment">// Public members.</span></div><div class="line">      publicAttribute1: <span class="literal">true</span>,</div><div class="line">      <span class="attr">publicAttribute2</span>: <span class="number">10</span>,</div><div class="line">    </div><div class="line">      <span class="attr">publicMethod1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">publicMethod2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;</div><div class="line">    &#125;  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">getInstance</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>(!uniqueInstance) &#123; <span class="comment">// å•ä¾‹è‹¥ä¸å­˜åœ¨ï¼Œè°ƒç”¨constructorå‡½æ•°</span></div><div class="line">        uniqueInstance = <span class="keyword">constructor</span>(); //è°ƒç”¨<span class="keyword">constructor</span>å‡½æ•°åï¼Œç¼“å­˜è¿”å›å€¼</div><div class="line">      &#125;</div><div class="line">      return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å•ä¾‹(singleton).è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ç§å°†ä»£ç ç»„ç»‡ä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒçš„æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡å•ä¸€å˜é‡æ¥è®¿é—®ã€‚é€šè¿‡ç¡®ä¿å•ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªæ‹·è´ï¼Œå¯ä»¥ç¡®ä¿ä»£ä¹°ä½¿ç”¨ç«¥é¢œçš„å…¨å±€èµ„æºã€‚å•ä¾‹å¯ä»¥ç”¨æ¥åˆ’åˆ†å‘½åç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ©å•ä¾‹æŠŠä»£ç ç»„ç»‡çš„æ›´ä¸ºä¸€è‡´ï¼Œä»è€Œæ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚&lt;
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptä»£ç†æ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/12/javascript%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/12/javascriptä»£ç†æ¨¡å¼/</id>
    <published>2017-03-12T00:04:10.000Z</published>
    <updated>2017-03-23T12:03:28.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä»£ç†æ¨¡å¼æ˜¯ç»™å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®<br>   å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<p><code>ç¼“å­˜ä»£ç†</code></p>
<p>  ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€æ¯”è¾ƒå¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œä¸‹ä¸€æ¬¡è¿ç®—æ—¶å¦‚æœä¼ é€’å‚æ•°å’Œç¼“å­˜çš„å‚æ•°ä¸€è‡´ï¼Œåˆ™å¯æ˜¯ç›´æ¥è¿”å›å‰é¢å­˜å‚¨çš„è¿ç®—ç»“æœ</p>
<p>è®¡ç®—ä¹˜ç§¯çš„å®ä¾‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//é»˜è®¤ä¼ é€’çš„argumentså‚æ•°åˆ—è¡¨</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹è®¡ç®—ä¹˜ç§¯'</span> );</div><div class="line">		<span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++ )&#123;</div><div class="line">			a = a * <span class="built_in">arguments</span>[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> a;</div><div class="line">	&#125;;</div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span> ); <span class="comment">// è¾“å‡ºï¼š6</span></div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24</span></div><div class="line">	<span class="comment">//ç°åœ¨åŠ å…¥ç¼“å­˜ä»£ç†å‡½æ•°ï¼š</span></div><div class="line"></div><div class="line">	<span class="keyword">var</span> proxyMult = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> cache = &#123;&#125;;  <span class="comment">//ç¼“å­˜å¯¹è±¡</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.join.call( <span class="built_in">arguments</span>, <span class="string">','</span> ); </div><div class="line">			<span class="keyword">if</span> ( args <span class="keyword">in</span> cache )&#123; <span class="comment">//å¦‚æœåˆå¹¶çš„å‚æ•°åœ¨ç¼“å­˜ä¸­</span></div><div class="line">				<span class="keyword">return</span> cache[ args ]; <span class="comment">//ç›´æ¥åˆ†ä¼šç¼“å­˜æ•°æ®</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> cache[ args ] = mult.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> ); </div><div class="line">                        <span class="comment">//è°ƒç”¨å‡½æ•°ä¹‹åå­˜å‚¨åˆ°ç¼“å­˜å¯¹è±¡ä¸­</span></div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line"></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24  //ç¬¬ä¸€æ¬¡è®¡ç®—</span></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24 //ç¬¬äºŒæ¬¡è®¡ç®—ï¼Œç›´æ¥å­˜ç¼“å­˜ä¸­è·å–</span></div><div class="line"></div><div class="line"><span class="comment">//è¿™é‡Œçš„ä¸¤ä¸ªå‡½æ•°ï¼Œmultiè´Ÿè´£è®¡ç®—ï¼ŒproxyMultiè´Ÿè´£ç¼“å­˜çš„å­˜å‚¨å’Œè¯»å–ã€‚</span></div><div class="line"><span class="comment">//ä¸¤ä¸ªå‡½æ•°åˆ†åŠŸèƒ½å®Œæˆå¯¹åº”çš„åŠŸèƒ½</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä»£ç†æ¨¡å¼æ˜¯ç»™å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®&lt;br&gt;   å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;ç¼“å­˜ä»£ç†&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;  ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€æ¯”è¾ƒå¤§çš„è¿
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App</title>
    <link href="http://yoursite.com/2017/03/12/%E7%BF%BB%E8%AF%91-%E4%BD%BF%E7%94%A8React%E6%9E%84%E5%BB%BA%E4%BD%A0%E7%9A%84App/"/>
    <id>http://yoursite.com/2017/03/12/ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App/</id>
    <published>2017-03-12T00:04:10.000Z</published>
    <updated>2017-03-23T11:29:53.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™ç¯‡æ–‡ç« æ—¶é—´æœ‰ç‚¹ä¹…è¿œ,ç¿»è¯‘è¯•è¯•çœ‹.ä½†æ˜¯æœ¬ç¯‡æ–‡ç« å¯¹äºReactçš„æ¸²æŸ“å·¥ä½œåŸç†è®²çš„æ¯”è¾ƒå¥½,ä½¿ç”¨ä¸€ä¸ªæ¸¸æˆå¼•æ“çš„æ¸²æŸ“æ–¹å¼æ¥ç±»æ¯”è§£é‡ŠReactçš„æ•°æ®æµç¨‹,å€¼å¾—å­¦ä¹ . <a href="http://konkle.us/architecting-your-app-react-part-1/" target="_blank" rel="external">åŸæ–‡åœ¨è¿™é‡Œ</a></p>
</blockquote>
<p>å»å¹´äº”æœˆ(2013å¹´5æœˆ),Facebookå‘å¸ƒäº†æ„å»ºå‰ç«¯ç»„ä»¶åº“çš„å¼€æºè½¯ä»¶-React.Reactå¯¹äºæµè§ˆå™¨å’Œappçš„ç»“æ„æ¥è¯´æœ‰ç‚¹å¼‚ç±».ä½†æ˜¯ç»è¿‡è¿™æ®µæ—¶é—´,å¼€å‘è€…é€æ¸çœ‹åˆ°äº†ä¸€äº›ä¼˜åŠ¿,Reactä¹Ÿå› æ­¤è·å–äº†å¾ˆå¤šçš„äººæ°”.Reactæœ€ä¸ºç›¸åŠ©çš„é¢ç‰¹å¾æ˜¯å¼•å…¥äº†virtual-DOMæ–¹æ³•,virtual-DOMä½¿å®é™…çš„æµè§ˆå™¨çš„DOMå˜åŒ–å‡åˆ°æœ€ä½,DOMçš„æ¸²æŸ“æ€§èƒ½å¤§å¹…æé«˜.</p>
<p>Reactå¹¶ä¸æ˜¯å®Œæ•´çš„MVCæ¡†æ¶,Reactå®é™…æ˜¯MVCçš„åŠ å¼ºç‰ˆ(è¿™ç‚¹,çœŸæ˜¯é›ªä¸­é€ç‚­,ä¸€ç›´éƒ½å¯¹è¿™ä¸ªæ¡†æ¶åˆ°åº•æ˜¯ä¸æ˜¯MVCè€Œå¿ƒå­˜ç–‘è™‘).å¾ˆå¤šå¼€å‘è€…é€‰æ‹©Reactä½œä¸ºMVCæ¡†æ¶çš„å»¶ä¼¸,ä¾‹å¦‚Backbone.Reactæœ¬èº«å¹¶æ²¡æœ‰è·¯ç”±å’Œæ•°æ®åŒæ­¥çš„å†…å®¹,æ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨å–œæ¬¢çš„å·¥å…·æ¥å®Œæˆç±»ä¼¼çš„åŠŸèƒ½.Reactä¹Ÿå¯ä»¥åœ¨å…¶ä»–çš„åº”ç”¨ä¸­ç®¡ç†ä¸€éƒ¨åˆ†ç‰¹å®šçš„ç»„ä»¶.ä½†æ˜¯å¦‚æœåœ¨åº”ç”¨çš„ç•Œé¢ä¸Šå…¨é¢ä½¿ç”¨React,å‘æŒ¥çš„åŠŸèƒ½ä¼šæ›´å¤§.</p>
<p>#####å°½å¯èƒ½çš„é¿å…DOM<br>Reactä½œä¸ºjavascriptçš„ä¸€ä¸ªç±»,æä¾›virtual-DOMå®æ–½æ–¹æ¡ˆ.è¿™æ„å‘³ç€ä½ å¯ä»¥é¢‘ç¹çš„æ›´æ–°ä½ çš„åº”ç”¨ç¨‹åºçš„å…ƒç´ æ ‘,ä½†æ˜¯å®é™…ä¸Šæ²¡æœ‰å‘ç”Ÿæµè§ˆå™¨çš„DOMæ“ä½œ.ç”±äºä½¿ç”¨äº†ç°ä»£çš„å¼•æ“,Javascriptçš„é€Ÿåº¦ç›¸å½“å¿«.å®é™…ç”±äºå¼•æ“çš„é€Ÿåº¦å¾ˆå¿«,å½“æ¯ä¸€æ¬¡æ•°æ®æ›´æ–°çš„æ—¶å€™,æ¸²æŸ“åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å¯ä»¥çš„,å‡å°‘äº†å®æ—¶å…ƒç´ æ“ä½œå’ŒåŒå‘æ•°æ®ç»‘å®šçš„éœ€æ±‚.Reactå‘¨æœŸæ€§çš„æ¯”è¾ƒvirtual-DOMå’Œæµè§ˆå™¨DOM,ä»…ä»…åšå‡ºæœ€æœ‰å¿…è¦çš„DOMåŒæ­¥.</p>
<p>#####å•å‘æ•°æ®æµ<br>å½“HTMLå…ƒç´ çš„æ¸²æŸ“èŠ±é”€å¤§å¹…åº¦é™ä½ä»¥å,ä½ ç°åœ¨éœ€è¦èŠ±è´¹æ›´å¤šçš„çš„æ–¹æ³•æ¥ç®¡ç†ä½ çš„ç•Œé¢.æ”¾å¼ƒé”™ç»¼å¤æ‚çš„å°±åœ°æ›´æ–°å…ƒç´ æ“ä½œå’Œæ•°æ®å˜åŒ–ä¸­çš„çš„å¤šä¸ªstateçš„åŒæ­¥,ä½ å¯ä»¥æŠŠçŠ¶æ€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹,åŸºäºé›†ä¸­çš„stateæ¥æè¿°ä½ çš„ç•Œé¢.åªè¦çŠ¶æ€ä»¥æ”¹å˜,Reactçš„ç»„ä»¶å°±å¯ä»¥è¿›è¡Œæ›´æ–°æ“ä½œ.<br>å½“ä½ çš„æ•´ä¸ªåº”ç”¨éƒ½åŸºäºè¿™ä¸ªæ€æƒ³æ¥è®¾è®¡,ä½ å¯ä»¥æŠŠimmutable æ•°æ®ä»é¡¶å±‚ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶,ç„¶åæ‰§è¡Œè‡ªé¡¶å‘ä¸‹çš„åº”ç”¨æ›´æ–°.Reactä»æ ¹æœ¬ä¸Šæ”¹å˜äº†ä½ å¯¹åº”ç”¨çš„æ€è·¯,è€Œä¸”ç»å¸¸ä¼šç®€åŒ–åº”ç”¨çš„è®¾è®¡.</p>
<p>#####æµè§ˆå™¨ä½œä¸ºæ¸²æŸ“å¼•æ“<br>è¿™ä¸€ç‚¹æ˜¯å¯¹MVCæ¡†æ¶éå¸¸æ¿€è¿›çš„æ”¹å˜,å®ƒå¼ºè°ƒä½¿ç”¨åŒå‘æ•°æ®ç»‘å®š,å°½å¯èƒ½å¤šè‡ªåŠ¨å°±åœ°é‡æ–°æ¸²æŸ“.å½“æˆ‘åˆšå¼€å§‹äº†è§£Reactçš„æ—¶å€™,æˆ‘è¿˜ä¸æ˜¯å¤ªç¡®å®š.è½¬æŠ˜ç‚¹æ˜¯æˆ‘çœ‹äº†ä¸€ä¸ªPete Huntçš„è§†é¢‘:æ¯”è¾ƒReactå’ŒDoom3æ¸²æŸ“å¼•æ“.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-a1553d287e86aebb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="doom3çš„æ¸²æŸ“ç¤ºæ„å›¾"><br>åœ¨å›¾è¡¨ä¸­,æ¸¸æˆçš„sateç»è¿‡åº•å±‚çš„å›¾å½¢ä»£ç å¯¼å…¥å‰ç«¯é€»è¾‘å’ŒæŠ½è±¡å±‚.è¿™ä¸ªæ“ä½œä¼šåˆ›å»ºä¸€ä¸ªâ€œåœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚â€(scene intermediate representation),è¿™ä¸ªè¡¨ç¤ºå±‚è¡¨ç°å‡ºç”¨æˆ·åº”è¯¥çœ‹åˆ°çš„å†…å®¹.è¿™ä¸ªè¡¨ç¤ºå±‚ä¼šä¼ é€’ç»™â€backendâ€(åç«¯),åç«¯æ¥æ”¶è¡¨ç¤ºå±‚å†…å®¹,éšä¹‹è½¬æ¢ä¸ºOpenGLæ“ä½œ,OpenGLä½¿ç”¨å›¾å½¢å¡(ç”µè„‘æ˜¾å¡)æ¸²æŸ“å‡ºå†…å®¹.Reactçš„å·¥ä½œåŸç†å’ŒDoom3çš„æ¸²æŸ“æ–¹å¼æ˜¯ä¸€æ ·çš„.(doom3æ˜¯æ—©æœŸä¸€æ¬¾æ¯”è¾ƒè‘—åçš„ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆ,è¿™é‡Œä½¿ç”¨doom3çš„å›¾å½¢æ¸²æŸ“æ–¹å¼æ¥è¯´æ˜Reactçš„å·¥ä½œæ–¹å¼).</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-73a98731bc9d6411.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Reactç»„ä»¶æ¸²æŸ“"></p>
<p>å½“ç¨‹åºçš„stateç”±äºæµè§ˆå™¨æˆ–è€…å®æ—¶äº‹ä»¶å‘ç”Ÿå˜åŒ–,Reactç¨‹åºæ¥æ”¶è¿™äº›å˜åŒ–,å¹¶ä¸”ä¼ é€’ç»™ç»„ä»¶ä»¬,æ¥ç€ä½¿ç”¨virtual-DOMæ–¹å¼ç”Ÿæˆä¸­é—´è¡¨ç¤ºå±‚.æµè§ˆå™¨çš„DOMå¹¶ä¸ä¼šå‘ç”Ÿç«‹å³çš„å˜åŒ–.ç„¶è€ŒReactä¼šå‘¨æœŸæ€§çš„æ¥æ”¶virtual DOM,è®¡ç®—å‡ºå¿…è¦çš„DOMæ“ä½œ.è¿™ä¸€ç‚¹å’Œæ¸¸æˆå¼•æ“æ¥å—åœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚,å†³å®šæ˜¯å¦ä½¿ç”¨OpenGLæ¸²æŸ“åœºæ™¯ç±»ä¼¼.Reactæ˜¯æ¥æ”¶DOM,æŠŠå®ƒæ¸²æŸ“åˆ°ç”¨æˆ·å±å¹•ä¸Š.(å¯è§ä¸¤è€…æ¸²æŸ“çš„æ€è·¯æ˜¯ä¸€æ ·çš„,Reactä½¿ç”¨äº†æµè§ˆå™¨æ¥åšè¿™ä¸ªå·¥ä½œ).</p>
<p>æµè§ˆå™¨å’Œæ¸¸æˆå¼•æ“ä¸€æ ·,æœ€æ…¢çš„éƒ¨åˆ†å®é™…æ˜¯ä¸­é—´è¡¨ç¤ºå±‚åˆ°å±å¹•çš„æ¸²æŸ“éƒ¨åˆ†.ä½ å¯ä»¥å¯¹virtual-DOMåšå‡ºè®¸å¤šç»†å°çš„æ”¹å˜,Reactä¼˜åŒ–äº†è¿™ä¸ªéƒ¨åˆ†,æ‰€ä»¥ä¸ä¼šå› æ­¤è€Œç‰ºç‰²æ¸²æŸ“çš„æ€§èƒ½.</p>
<p>#####æ›´å¤šçš„èµ„æº<br>åœ¨ç¬¬äºŒéƒ¨åˆ†,æˆ‘å°†ä¼šæ¼”ç¤ºæ€ä¹ˆæŠŠReactçš„è®¾è®¡å“²å­¦ä»˜è¯¸å®è·µ.æˆ‘ä¼šåˆ†äº«æ€ä¹ˆæ›´å…·ä¸åŒçš„åŠŸèƒ½è´£ä»»,æ¸²æŸ“ä¸€ä¸ªç”±å°ç»„ä»¶ç»„æˆçš„é¡¶çº§ç»„ä»¶çš„ç•Œé¢.æˆ‘ä¹Ÿä¼šæ¼”ç¤ºæ€ä¹ˆåœ¨Reactåº”ç”¨ä¸­æ•´åˆè·¯ç”±åŠŸèƒ½å’Œæ•°æ®åŒæ­¥åŠŸèƒ½.</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„Reactå†…å®¹,æƒ³çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„,çœ‹çœ‹ä¸‹é¢çš„èµ„æºåˆ—è¡¨.</p>
<ul>
<li><a href="http://facebook.github.io/react/" target="_blank" rel="external">Reactä¸»é¡µ</a></li>
<li><a href="http://facebook.github.io/react/docs/videos.html" target="_blank" rel="external">è§†é¢‘</a></li>
<li><a href="http://facebook.github.io/react/docs/examples.html" target="_blank" rel="external">å®ä¾‹</a></li>
<li><a href="https://groups.google.com/forum/#!forum/reactjs" target="_blank" rel="external">React Google Group</a></li>
<li>#reactjs on Freenode-å®˜æ–¹ IRCé¢‘é“,æ¯”è¾ƒæ´»è·ƒ</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ—¶é—´æœ‰ç‚¹ä¹…è¿œ,ç¿»è¯‘è¯•è¯•çœ‹.ä½†æ˜¯æœ¬ç¯‡æ–‡ç« å¯¹äºReactçš„æ¸²æŸ“å·¥ä½œåŸç†è®²çš„æ¯”è¾ƒå¥½,ä½¿ç”¨ä¸€ä¸ªæ¸¸æˆå¼•æ“çš„æ¸²æŸ“æ–¹å¼æ¥ç±»æ¯”è§£é‡ŠReactçš„æ•°æ®æµç¨‹,å€¼å¾—å­¦ä¹ . &lt;a href=&quot;http://konkle.us/architecting-your-ap
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptå¼€æ”¾-å°é—­åŸåˆ™-NBAå¸¸è§„èµ›ç»“æŸ</title>
    <link href="http://yoursite.com/2017/03/11/javascript%E5%BC%80%E6%94%BE-%E5%B0%81%E9%97%AD%E5%8E%9F%E5%88%99-NBA%E5%B8%B8%E8%A7%84%E8%B5%9B%E7%BB%93%E6%9D%9F/"/>
    <id>http://yoursite.com/2017/03/11/javascriptå¼€æ”¾-å°é—­åŸåˆ™-NBAå¸¸è§„èµ›ç»“æŸ/</id>
    <published>2017-03-11T08:04:10.000Z</published>
    <updated>2017-03-23T12:10:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åœ¨é¢å‘å¯¹è±¡ç¨‹åº(OOP)è®¾è®¡ä¸­ï¼Œå¼€æ”¾-å°é—­åŸåˆ™(OCP)æ˜¯æœ€é‡è¦çš„åŸåˆ™ï¼Œä¸€ä¸ªoopçš„ç¨‹åºå…·æœ‰è‰¯å¥½çš„è®¾è®¡ï¼Œå¾€å¾€è¯´æ˜å®ƒæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™çš„.<br>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬20ç« <br>é¦–å…ˆçœ‹ä¸€ä¸ªä»£ç .å¼€æ”¾å°é—­æ˜¯ç›¸äº’å…³è”çš„åœ¨ä¸€æ®µä»£ç ä¸­æ—¢è¦ä½“ç°å°é—­åˆè¦ä½“ç°å¼€æ”¾ã€‚å°é—­ä¸ç ´åæ—§åŠŸèƒ½ï¼Œå¼€æ”¾æœ‰å¯ä»¥æ·»åŠ æ–°åŠŸèƒ½ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸ªå‡½æ•°æ˜¯ä¿®é¥°æ¨¡å¼ï¼Œåœ¨å‡½æ•°è¿è¡Œåæ·»åŠ åŠŸèƒ½</span></div><div class="line"><span class="comment">//é€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œæ·»åŠ çš„åŠŸèƒ½ä¸å½±å“åŸå‡½æ•°çš„åŠŸèƒ½</span></div><div class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			<span class="keyword">return</span> ret;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="comment">//å¦‚æœå¤šäººå¼€å‘ï¼Œéƒ½è¦åœ¨window.onloadä¸‹æŒ‚è½½å‡½æ•°åŠŸèƒ½(åŸç”Ÿçš„jsä»£ç </span></div><div class="line">	<span class="comment">//åªèƒ½åŠ è½½ä¸€æ¬¡window.loadå‡½æ•°)ã€‚å¾ˆæœ‰å¯èƒ½åˆ«äººä¹Ÿåœ¨ä½¿ç”¨.</span></div><div class="line">	<span class="comment">//è¦è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ç»“åˆafterå‡½æ•°å’Œå‡½æ•°å¼•ç”¨èµ‹å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜</span></div><div class="line">	<span class="comment">//å¦‚æœwindoW.loadå·²ç»æŒ‚è½½æœ‰å†…å®¹ï¼Œå°±å¼•ç”¨èµ‹å€¼ï¼Œç„¶åä½¿ç”¨after</span></div><div class="line">	<span class="comment">//å¦‚æœæ²¡æœ‰ä½¿ç”¨åˆ™ç›´æ¥å¼•ç”¨ç©ºå‡½æ•°å¯¹è±¡ï¼Œç„¶åæŒ‚è½½afterå‡½æ•°</span></div><div class="line">	<span class="comment">//æ— è®ºå“ªç§æƒ…å†µï¼Œé€šè¿‡afterå‡½æ•°çš„</span></div><div class="line">	<span class="built_in">window</span>.onload = ( <span class="built_in">window</span>.onload || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125; ).after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="built_in">document</span>.getElementsByTagName( <span class="string">'*'</span> ).length );</div><div class="line">	&#125;);</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨å¼€æ”¾-å°é—­åŸåˆ™å¾ˆå›°éš¾ï¼Œå…³é”®æ˜¯è¦æ‰¾åˆ°ç¨‹åºåœ¨å“ªé‡Œå‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸æ˜¯ä¸€æœä¸€å¤•ä¹‹åŠŸã€‚æ‰€ä»¥é“ç†å¾ˆç®€å•ï¼Œä½†æ˜¯åº”ç”¨èµ·æ¥å¯èƒ½å¾ˆå›°éš¾ã€‚é•¿è·¯æ¼«æ¼«å•Šã€‚</p>
<p>è‡³æ­¤æœ¬äººåŸºæœ¬æŠŠjavascriptçš„æ¨¡å¼è®¾è®¡çš„å†…å®¹è¿‡äº†ä¸€éã€‚å¯ä»¥è¯´æ”¶è·è‰¯å¤šï¼Œå­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚é˜…è¯»ä»£ç å’Œåˆ†æä»£ç çš„èƒ½åŠ›æœ‰äº†æé«˜ï¼Œå¥½åƒæ˜¯åœ¨NBAçš„èµ›åœºä¸Šï¼Œé€šè¿‡è§£è¯´å‘˜çš„ä¸€äº›æˆ˜æœ¯åˆ†æï¼Œæ…¢æ…¢çœ‹æ˜ç™½äº†ä¸€äº›è·‘ä½å’Œæˆ˜æœ¯ï¼Œå¯¹äºä¸€ä¸ªçƒè¿·æ¥è¯´åœ¨è¿™ç§æƒ…å†µä¸‹çœ‹æ¯”èµ›å°±ä¸å…‰å…‰æ˜¯çœ‹çƒ­é—¹äº†ï¼Œæ¯”èµ›æœ‰äº†æ›´æ·±å±‚æ¬¡çš„æ„ä¹‰ï¼Œæ­¤æ—¶çš„å¿ƒæƒ…å°±æ˜¯æœ‰æƒ³çœ‹æ›´å¤šæ¯”èµ›æ¥éªŒè¯ä¸‹ä¸€åœºæ¯”èµ›æ˜¯å¦ä¹Ÿä¼šå‡ºç°åŒæ ·çš„æˆ˜æœ¯ã€‚<br>ä½†è¿™ä¹Ÿåªæ˜¯ä¸€ä¸ªèµ·ç‚¹è€Œå·²ï¼Œè¿‡ä¸€å¹´è‚¯èƒ½ä¼šè§‰å¾—ç°åœ¨å†™çš„è¿™äº›æ–‡ç« å¾ˆå¹¼ç¨šå¾ˆå‚»æ¯”ã€‚å°±æ‹¿è¿™äº›å­¦ä¹ ç¬”è®°è®°å½•è¿™ä¸ªå‚»é€¼çš„è¿‡ç¨‹å§.</p>
<p>NBAå¸¸è§„èµ›ç»“æŸäº†ï¼Œè¿˜æœ‰å­£åèµ›å’Œä¸‹ä¸€èµ›å­£ç­‰ç€å‘¢ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨é¢å‘å¯¹è±¡ç¨‹åº(OOP)è®¾è®¡ä¸­ï¼Œå¼€æ”¾-å°é—­åŸåˆ™(OCP)æ˜¯æœ€é‡è¦çš„åŸåˆ™ï¼Œä¸€ä¸ªoopçš„ç¨‹åºå…·æœ‰è‰¯å¥½çš„è®¾è®¡ï¼Œå¾€å¾€è¯´æ˜å®ƒæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™çš„.&lt;br&gt;å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬20ç« &lt;br&gt;é¦–å…ˆçœ‹ä¸€ä¸ªä»£ç .å¼€æ”¾å°é—­æ˜¯ç›¸äº’å…³è”çš„åœ¨ä¸€
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptå·¥å‚æ¨¡å¼-XHRå·¥å‚</title>
    <link href="http://yoursite.com/2017/03/11/javascript%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-XHR%E5%B7%A5%E5%8E%82/"/>
    <id>http://yoursite.com/2017/03/11/javascriptå·¥å‚æ¨¡å¼-XHRå·¥å‚/</id>
    <published>2017-03-11T00:07:10.000Z</published>
    <updated>2017-03-23T12:09:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2044710-f56a2c10764090f7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="s3398900.jpg"></p>
<blockquote>
<p>ä¸€ä¸ªç±»æˆ–å¯¹è±¡ä¸­å¾€å¾€åŒ…æ‹¬åˆ«çš„å¯¹è±¡ã€‚åœ¨åˆ›å»ºè¿™ç§æˆå‘˜å¯¹è±¡æ—¶ï¼Œä½ å¯èƒ½ä¹ æƒ¯äºä½¿ç”¨å¸¸è§„æ–¹å¼ï¼Œå³ç”¨newå…³é”®å­—å’Œç±»æ„é€ å‡½æ•°ã€‚é—®é¢˜æ˜¯è¿™æ ·ä¼šå¯¼è‡´ä¸¤ä¸ªç±»ä¹‹é—´äº§ç”Ÿä¾èµ–æ€§ã€‚é€šè¿‡å·¥å‚æ¨¡å¼å¯ä»¥æ¶ˆé™¤ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»–ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•æ¥å†³å®šç©¶ç«Ÿè¦å®ä¾‹åŒ–å“ªä¸ªç±»ã€‚å‚ç…§ä¸Šå›¾é‚£æœ¬ä¹¦ï¼Œç¬¬7ç« å†…å®¹</p>
</blockquote>
<p>#####XHRå·¥å‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> AjaxHandler = <span class="keyword">new</span> Interface(<span class="string">'AjaxHandler'</span>, [<span class="string">'request'</span>, <span class="string">'createXhrObject'</span>]);</div><div class="line"></div><div class="line"><span class="comment">/* SimpleHandler class. */</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> SimpleHandler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// implements AjaxHandler</span></div><div class="line">SimpleHandler.prototype = &#123;</div><div class="line">  <span class="comment">//requestå‡½æ•°è´Ÿè´£æ‰§è¡Œå‘å‡ºçš„è¯·æ±‚å’Œå¤„ç†ç›¸åº”ç»“æœæ‰€éœ€çš„ä¸€ç³»åˆ—æ“ä½œ</span></div><div class="line">  <span class="comment">//ä»–å…ˆä½¿ç”¨createXhrObject()å‡½æ•°å¹¶å¯¹å…¶è¿›è¡Œé…ç½®ï¼Œç„¶åå‘é€è¯·æ±‚</span></div><div class="line">  request: <span class="function"><span class="keyword">function</span>(<span class="params">method, url, callback, postVars</span>) </span>&#123;</div><div class="line">    <span class="comment">//é¦–æ¬¡è¿è¡Œæˆ–è€…æ˜¯æ²¡æœ‰è·å¾—XHRå¯¹è±¡æ—¶æ‰§è¡Œå…·ä½“çš„æ–¹æ³•ã€‚</span></div><div class="line">    <span class="comment">//ä¸€æ—¦è·å–äº†XHRå¯¹è±¡ï¼Œå°±ä¼šç¼“å­˜èµ·æ¥ï¼Œåç»­æ‰§è¡Œç›´æ¥ä»å˜é‡å¼•ç”¨ä¸­è·å–XHRå¯¹è±¡</span></div><div class="line">    <span class="keyword">var</span> xhr = <span class="keyword">this</span>.createXhrObject();</div><div class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>(xhr.readyState !== <span class="number">4</span>) <span class="keyword">return</span>;</div><div class="line">      (xhr.status === <span class="number">200</span>) ? </div><div class="line">        callback.success(xhr.responseText, xhr.responseXML) : </div><div class="line">        callback.failure(xhr.status);</div><div class="line">    &#125;;</div><div class="line">    xhr.open(method, url, <span class="literal">true</span>);</div><div class="line">    <span class="keyword">if</span>(method !== <span class="string">'POST'</span>) postVars = <span class="literal">null</span>;</div><div class="line">    xhr.send(postVars);</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">//createXhrObject()è¿™ä¸ªå·¥å‚æ–¹æ³•æ ¹æ®å½“å‰å…·ä½“ç¯å¢ƒè¿”å›ä¸€ä¸ªXHRå¯¹è±¡</span></div><div class="line">  <span class="comment">//é¦–æ¬¡æ‰§è¡Œæ—¶ï¼Œä»–ä¼šä¾æ¬¡å°è¯•æ‰§è¡Œä¸‰ç§ç”¨äºåˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•ï¼Œä¸€æ—¦é‡åˆ°</span></div><div class="line">  <span class="comment">//ç®¡ç”¨çš„ï¼Œä»–å°±ä¼šè¿”å›æ‰€åˆ›å»ºçš„å¯¹è±¡ï¼ŒåŒæ—¶æŠŠè‡ªå·±ä¹Ÿæ”¹ä¸ºè¿”å›çš„é‚£ä¸ªå¯¹è±¡</span></div><div class="line">  createXhrObject: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//å·¥å‚æ–¹æ³•.</span></div><div class="line">    <span class="keyword">var</span> methods = [<span class="comment">//ä¸‰ç§åˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•ç»„æˆæ•°ç»„</span></div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest(); &#125;,</div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>); &#125;,</div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>); &#125;</div><div class="line">    ];</div><div class="line">    <span class="comment">//ä¸‹é¢éå†æ•°ç»„æ–¹æ³•ï¼Œå°è¯•è·å¾—XHRå¯¹è±¡</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = methods.length; i &lt; len; i++) &#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        methods[i](); <span class="comment">//å°è¯•è·å¾—XHRå¯¹è±¡</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">catch</span>(e) &#123;</div><div class="line">        <span class="keyword">continue</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// If we reach this point, method[i] worked.</span></div><div class="line">      <span class="comment">//å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œæ•°ç»„ä¸­æœ‰æ–¹æ³•å¯ä»¥åˆ›å»ºXHRå¯¹è±¡</span></div><div class="line">      <span class="keyword">this</span>.createXhrObject = methods[i]; <span class="comment">//ç›´æ¥æŠŠå¯¹è±¡ç»™ç¬¬ä¸€ç§å¯ä»¥è·å–</span></div><div class="line"><span class="comment">//å¯¹è±¡çš„æ–¹æ³•ï¼Œç¼“å­˜èµ·æ¥      </span></div><div class="line">        <span class="keyword">return</span> methods[i];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// If we reach this point, none of the methods worked.</span></div><div class="line">    <span class="comment">//å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œè¡¨ç¤ºæ²¡æœ‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼ŒæŠ›å‡ºé”™è¯¯</span></div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'SimpleHandler: Could not create an XHR object.'</span>);</div><div class="line">  &#125; </div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/* Usage. å…·ä½“çš„ä½¿ç”¨æ–¹æ³•*/</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> myHandler = <span class="keyword">new</span> SimpleHandler(); <span class="comment">//çœ‹ä¸åˆ°å·¥å‚åŒ–çš„è¿‡ç¨‹</span></div><div class="line"><span class="keyword">var</span> callback = &#123; </div><div class="line">  <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">responseText</span>) </span>&#123; alert(<span class="string">'Success: '</span> + responseText); &#125;, </div><div class="line">  <span class="attr">failure</span>: <span class="function"><span class="keyword">function</span>(<span class="params">statusCode</span>) </span>&#123; alert(<span class="string">'Failure: '</span> + statusCode); &#125; </div><div class="line">&#125;;</div><div class="line">myHandler.request(<span class="string">'GET'</span>, <span class="string">'script.php'</span>, callback);</div></pre></td></tr></table></figure>
<p>createXhrObject()è¿™ä¸ªå‡½æ•°å°±æ˜¯å¯¹è±¡å·¥å‚æ–¹æ³•ï¼Œç”±äºéœ€è¦è€ƒè™‘åˆ°ä¸åŒæµè§ˆå™¨å¯¹äºajaxå¯¹è±¡çš„å·®å¼‚æ€§ï¼Œåœ¨è·å–XHRå¯¹è±¡æ˜¯æœ‰æ ¹æ®ä¸åŒçš„æ¡ä»¶æ¥è¿›è¡Œã€‚ä½†æ˜¯è¿™ä¸ª<code>æ ¹æ®ä¸åŒæ¡ä»¶å®ä¾‹åŒ–XHRå¯¹è±¡çš„æ–¹æ³•</code>å’Œå®é™…çš„<code>ajaxè¯·æ±‚æ–¹æ³•</code>æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ã€‚æ‰€ä»¥åœ¨è¿™é‡ŒæŠŠå®ä¾‹åŒ–XHRå¯¹è±¡çš„è¿‡ç¨‹å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡å·¥å‚é‡Œã€‚åœ¨ajaxæ–¹æ³•ä¸­åªéœ€è¦ä½¿ç”¨XHRå¯¹è±¡å°±å¯ä»¥äº†ã€‚ </p>
<p>ä¸¤ä¸ªç‹¬ç«‹çš„å¯¹è±¡ä¹‹é—´å®ç°äº†è§£è€¦å’Œã€‚å…¶å®åœ¨jsæ¨¡å¼è®¾è®¡ä¸­æ¯ç§æ¨¡å¼åŸºæœ¬éƒ½æ˜¯å›´ç»•åŠŸèƒ½çš„è§£è€¦å’Œæ¥å±•å¼€ã€‚è¦è§£å†³é—®é¢˜é¦–å…ˆè¦ç®€åŒ–é—®é¢˜ï¼Œåœ¨ç®€åŒ–è¿‡ç¨‹ä¸­æ‰èƒ½è¯†åˆ«å‡ºæ¨¡å¼ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2044710-f56a2c10764090f7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320&quot; a
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptä¸­ä»‹è€…æ¨¡å¼-å’¸é±¼ç½‘çš„æ€è€ƒ</title>
    <link href="http://yoursite.com/2017/03/11/javascript%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F-%E5%92%B8%E9%B1%BC%E7%BD%91%E7%9A%84%E6%80%9D%E8%80%83/"/>
    <id>http://yoursite.com/2017/03/11/javascriptä¸­ä»‹è€…æ¨¡å¼-å’¸é±¼ç½‘çš„æ€è€ƒ/</id>
    <published>2017-03-10T21:04:10.000Z</published>
    <updated>2017-03-23T12:17:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>åœ¨å­—å…¸é‡Œï¼Œä¸­ä»‹è€…æ˜¯æŒ‡â€œååŠ©è°ˆåˆ¤å’Œè§£å†³å†²çªçš„ä¸­ç«‹æ–¹â€ã€‚åœ¨æ¨¡å¼è®¾è®¡é‡Œï¼Œä¸­ä»‹è€…æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬å…¬å¼€ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç³»ç»Ÿä¸åŒéƒ¨åˆ†å¯ä»¥é€šè¿‡è¯¥æ¥å£è¿›è¡Œé€šè®¯ã€‚<br>ä¹Ÿè®¸ä¸€ä¸ªå¯¹è±¡å¯ä»¥å’Œåä¸ªå¯¹è±¡ä¹‹é—´å‘ç”Ÿè”ç³»ï¼Œåä¸ªå¯¹è±¡ä¹‹é—´æœ‰å¯ä»¥å‘ç”Ÿç›¸äº’è”ç³»ï¼Œä»è€Œå½¢æˆä¸€å¼ å·¨å¤§çš„å…³ç³»ç½‘ï¼Œè¦æƒ³åœ¨è¿™ä¹ˆå¤æ‚çš„å…³ç³»ç½‘ä¸­ç†æ¸…å…³ç³»ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚<br>ä¸­ä»‹è€…æ¨¡å¼å°±æ˜¯è¦æŠŠå¯¹è±¡ä¹‹é—´çš„ç›¸äº’è€¦åˆå…³ç³»è§£é™¤ã€‚é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å’Œä¸­ä»‹è€…å¯¹è±¡é€šè®¯ï¼Œå¯¹è±¡ä¹‹é—´ä¸ç›´æ¥å‘ç”Ÿè”ç³»ã€‚<br>ä¸­ä»‹è€…å¯¹è±¡æ˜¯çš„å¯¹è±¡ä¹‹é—´çš„ç½‘çŠ¶ç»“æ„å˜ä¸ºä¸€å¯¹å¤šçš„å…³ç³»ã€‚</p>
</blockquote>
<p>æ‹¿å’¸é±¼ç½‘æ¥è¯´ã€‚ä»¥å‰å¦‚æœæˆ‘ä»¬æœ‰é—²ç½®çš„ä¸œè¥¿ï¼Œå¯ä»¥åœ¨å°åŒºçš„è·¯ä¸Šæ‘†ä¸ªæ‘Šå­ï¼Œè¿™æ ·çœ‹åˆ°ä¸œè¥¿çš„é‚»å±…å¯èƒ½ä¼šæ¥ä¹°ã€‚å¯æ˜¯è¿™ç§å…³ç³»æ˜¯ååˆ†ä¸ç¨³å®šå’Œå¤æ‚çš„ï¼Œäº¤æ˜“å‘ç”Ÿéƒ½æœ‰å¶ç„¶æ€§ã€‚<br>å¦‚æœæˆ‘ä»¬æŠŠé—²ç½®å‘å¸ƒåˆ°å’¸é±¼ï¼Œé‚£ä¹ˆå‘å¸ƒè€…å’Œè´­ä¹°è€…ä¸ä¼šç›´æ¥å‘ç”Ÿè”ç³»ã€‚ä¹‹é—´çš„å…³ç³»éƒ½æ˜¯é€šè¿‡å’¸é±¼æ¥å®Œæˆçš„ã€‚è¿™æ ·çš„æ¨¡å¼å°±æ¯”ç›´æ¥äº¤æ˜“ä¾¿åˆ©çš„å¤šã€‚</p>
<p>å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬14ç« ã€‚ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹åŠ¨ç‰©ä¹¦ ç¬¬9ç« ã€‚9.6</p>
<p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­<br>è¿™æ˜¯ä¸€ä¸ªæ‰å¯¹å®æ€çš„æ¸¸æˆã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params"> name </span>)</span>&#123; <span class="comment">//ç©å®¶æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.name = name <span class="comment">//ç©å®¶åå­—</span></div><div class="line">		<span class="keyword">this</span>.enemy = <span class="literal">null</span>; <span class="comment">// æ•Œäºº</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è·èƒœå‡½æ•°</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="keyword">this</span>.name + <span class="string">' won '</span> );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å¤±è´¥å‡½æ•°</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="keyword">this</span>.name +<span class="string">' lost'</span> );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.die = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å¤±è´¥å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.lose();</div><div class="line">		<span class="keyword">this</span>.enemy.win();</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//æ¥ä¸‹æ¥åˆ›å»º2 ä¸ªç©å®¶å¯¹è±¡ï¼š</span></div><div class="line">	<span class="keyword">var</span> player1 = <span class="keyword">new</span> Player( <span class="string">'çš®è›‹'</span> );</div><div class="line">	<span class="keyword">var</span> player2 = <span class="keyword">new</span> Player( <span class="string">'å°ä¹–'</span> );</div><div class="line">	<span class="comment">//ç»™ç©å®¶ç›¸äº’è®¾ç½®æ•Œäººï¼š</span></div><div class="line">	player1.enemy = player2;</div><div class="line">	player2.enemy = player1;</div><div class="line"></div><div class="line">	player1.die();<span class="comment">// è¾“å‡ºï¼šçš®è›‹ lostã€å°ä¹– won</span></div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„ç›¸äº’ä½œç”¨è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚<br>å½“å¢åŠ ç©å®¶ç»„é˜Ÿçš„æ—¶å€™ï¼Œå°±æ¯”è¾ƒå¤æ‚äº†ï¼Œçœ‹çœ‹ä¾ç…§ä¸Šé¢çš„æ€è·¯çš„ä»£ç <br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> players = []; <span class="comment">//ç©å®¶çš„æ•°ç»„ï¼Œä½¿ç”¨çš„æ—¶å€™æ˜¯äºŒç»´æ•°ç»„ï¼Œä¸€ç»´æ˜¯é˜Ÿé¢œè‰²</span></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">Player</span></span>( name, teamColor )&#123;<span class="comment">//æ„é€ å‡½æ•°</span></div><div class="line">		<span class="built_in">this</span>.partners = []; <span class="comment">// é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">		<span class="built_in">this</span>.enemies = []; <span class="comment">// æ•Œäººåˆ—è¡¨</span></div><div class="line">		<span class="built_in">this</span>.state = <span class="string">'live'</span>; <span class="comment">// ç©å®¶çŠ¶æ€</span></div><div class="line">		<span class="built_in">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></div><div class="line">		<span class="built_in">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿèƒœåˆ©</span></div><div class="line">		console.log( <span class="string">'winner: '</span> + <span class="built_in">this</span>.name );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.lose = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿå¤±è´¥</span></div><div class="line">		console.log( <span class="string">'loser: '</span> + <span class="built_in">this</span>.name );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.die = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></div><div class="line">		<span class="keyword">var</span> all_dead = <span class="literal">true</span>;</div><div class="line"></div><div class="line">		<span class="built_in">this</span>.state = <span class="string">'dead'</span>; <span class="comment">// è®¾ç½®ç©å®¶çŠ¶æ€ä¸ºæ­»äº¡ï¼Œæ ‡è®°å˜é‡</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[ i++ ]; )&#123; </div><div class="line">      <span class="comment">// éå†é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">			<span class="keyword">if</span> ( partner.state !== <span class="string">'dead'</span> )&#123; </div><div class="line">    <span class="comment">// å¦‚æœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æœªå¤±è´¥</span></div><div class="line">				all_dead = <span class="literal">false</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> ( all_dead === <span class="literal">true</span> )&#123; <span class="comment">// å¦‚æœé˜Ÿå‹å…¨éƒ¨æ­»äº¡</span></div><div class="line">			<span class="built_in">this</span>.lose(); <span class="comment">// é€šçŸ¥è‡ªå·±æ¸¸æˆå¤±è´¥</span></div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰é˜Ÿå‹ç©å®¶æ¸¸æˆå¤±è´¥</span></div><div class="line">				partner.lose();</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, enemy; enemy = <span class="built_in">this</span>.enemies[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰æ•Œäººæ¸¸æˆèƒœåˆ©</span></div><div class="line">				enemy.win();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">var</span> playerFactory = <span class="function"><span class="keyword">function</span></span>( name, teamColor )&#123;<span class="comment">//ç©å®¶å¯¹è±¡å·¥å‚</span></div><div class="line">		<span class="keyword">var</span> <span class="keyword">new</span><span class="type">Player</span> = <span class="keyword">new</span> <span class="type">Player</span>( name, teamColor ); </div><div class="line"><span class="comment">// åˆ›å»ºæ–°ç©å®¶</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = players[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰çš„ç©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥</span></div><div class="line">			<span class="keyword">if</span> ( player.teamColor === <span class="keyword">new</span><span class="type">Player</span>.teamColor )&#123; </div><div class="line"><span class="comment">// å¦‚æœæ˜¯åŒä¸€é˜Ÿçš„ç©å®¶</span></div><div class="line">				player.partners.push( <span class="keyword">new</span><span class="type">Player</span> ); </div><div class="line"><span class="comment">// ç›¸äº’æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">				<span class="keyword">new</span><span class="type">Player</span>.partners.push( player );</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				player.enemies.push( <span class="keyword">new</span><span class="type">Player</span> ); </div><div class="line"><span class="comment">// ç›¸äº’æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨</span></div><div class="line">				<span class="keyword">new</span><span class="type">Player</span>.enemies.push( player );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		players.push( <span class="keyword">new</span><span class="type">Player</span> );</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span><span class="type">Player</span>;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment">//çº¢é˜Ÿï¼š4ä¸ªç©å®¶</span></div><div class="line">	<span class="keyword">var</span> player1 = playerFactory( <span class="string">'çš®è›‹'</span>, <span class="string">'red'</span> ),</div><div class="line">	player2 = playerFactory( <span class="string">'å°ä¹–'</span>, <span class="string">'red'</span> ),</div><div class="line">	player3 = playerFactory( <span class="string">'å®å®'</span>, <span class="string">'red'</span> ),</div><div class="line">	player4 = playerFactory( <span class="string">'å°å¼º'</span>, <span class="string">'red'</span> );</div><div class="line">	<span class="comment">//è“é˜Ÿï¼š4ä¸ªç©å®¶</span></div><div class="line">	<span class="keyword">var</span> player5 = playerFactory( <span class="string">'é»‘å¦'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player6 = playerFactory( <span class="string">'è‘±å¤´'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player7 = playerFactory( <span class="string">'èƒ–å¢©'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player8 = playerFactory( <span class="string">'æµ·ç›—'</span>, <span class="string">'blue'</span> );</div><div class="line"></div><div class="line">	player1.die();</div><div class="line">	player2.die();</div><div class="line">	player4.die();</div><div class="line">	player3.die();</div></pre></td></tr></table></figure></p>
<blockquote>
<p>ä»¥ä¸Šçš„ä»£ç å°±æœ‰ç‚¹å¤æ‚äº†ã€‚å½“ç©å®¶å¤±è´¥(æ­»äº¡)ä»¥åè¦éå†å…¶ä»–é˜Ÿå‹ç­‰ç­‰ã€‚åŠ å…¥é˜Ÿä¼çš„æ—¶å€™ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œè¦ç›¸äº’ç¡®è®¤ã€‚é˜Ÿå‹ä¹‹é—´çš„ç›¸äº’äº¤å‰å˜åŒ–å¾ˆéº»çƒ¦ã€‚</p>
</blockquote>
<p>ä¸‹é¢çœ‹çœ‹ä¸­ä»‹è€…æ¨¡å¼æ”¹é€ çš„ä»£ç ã€‚<br>é‡è¦çš„æ˜¯æ·»åŠ äº†playerDirectorè¿™ä¸ªä¸­ä»‹è€…å¯¹è±¡ã€‚<br>playerDirectorä¸­ä»‹è€…å¯¹è±¡ä¸­æ·»åŠ æ¥å£ï¼ŒreceiveMessage()é€šçŸ¥ä¸­ä»‹è€…æ¥è¿›è¡Œç›¸å…³æ“ä½œã€‚å¯ä»¥å…ˆåœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­çœ‹çœ‹è¿™ä¸ªæ–¹æ³•<br>reciveMessage( â€˜playerDeadâ€™, this )ï¼›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é€šçŸ¥ä¸­ä»‹è€…çš„æ–¹æ³•ã€‚ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ›å»ºçš„ç©å®¶å¯¹è±¡ã€‚<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">  <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>ä¸­ä»‹è€…æ¨¡å¼<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line"> function Player( name, teamColor )&#123;<span class="comment">//æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></div><div class="line">		<span class="keyword">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²ï¼Œç©å®¶æ•°ç»„çš„ç¬¬ä¸€ç»´</span></div><div class="line">		<span class="keyword">this</span>.state = <span class="string">'alive'</span>; <span class="comment">// ç©å®¶ç”Ÿå­˜çŠ¶æ€</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = function()&#123;<span class="comment">//èƒœåˆ©</span></div><div class="line">		console.log( <span class="keyword">this</span>.name + <span class="string">' won '</span> );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.lose = function()&#123; <span class="comment">//å¤±è´¥</span></div><div class="line">		console.log( <span class="keyword">this</span>.name +<span class="string">' lost'</span> );</div><div class="line">	&#125;;</div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç©å®¶æ­»äº¡**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.die = function()&#123;</div><div class="line">		<span class="keyword">this</span>.state = <span class="string">'dead'</span>;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'playerDead'</span>, <span class="keyword">this</span> ); </div><div class="line">              <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ­»äº¡</span></div><div class="line">	&#125;;</div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç§»é™¤ç©å®¶**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.remove = function()&#123;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'removePlayer'</span>, <span class="keyword">this</span> );     </div><div class="line">               <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªç©å®¶</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç©å®¶æ¢é˜Ÿ**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.changeTeam = function( color )&#123;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'changeTeam'</span>, <span class="keyword">this</span>, color );     </div><div class="line">          <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ¢é˜Ÿ</span></div><div class="line">	&#125;;</div><div class="line">       </div><div class="line">	<span class="keyword">var</span> playerDirector= ( function()&#123; <span class="comment">//ä¸­ä»‹è€…æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">var</span> players = &#123;&#125;, <span class="comment">// ä¿å­˜æ‰€æœ‰ç©å®¶</span></div><div class="line">			operations = &#123;&#125;; <span class="comment">// ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ</span></div><div class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*æ–°å¢ä¸€ä¸ªç©å®¶*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">		operations.addPlayer = function( player )&#123;</div><div class="line">			<span class="keyword">var</span> teamColor = player.teamColor; <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></div><div class="line">			players[ teamColor ] = players[ teamColor ] || []; </div><div class="line">                   <span class="comment">// å¦‚æœè¯¥é¢œè‰²çš„ç©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™åˆ›å»º</span></div><div class="line"></div><div class="line">			players[ teamColor ].push( player ); <span class="comment">// æ·»åŠ ç©å®¶è¿›é˜Ÿä¼</span></div><div class="line">		&#125;;</div><div class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ç§»é™¤ä¸€ä¸ªç©å®¶*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">	operations.removePlayer = function( player )&#123;</div><div class="line">		<span class="keyword">var</span> teamColor = player.teamColor, <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></div><div class="line">		teamPlayers = players[ teamColor ] || []; <span class="comment">// è¯¥é˜Ÿä¼æ‰€æœ‰æˆå‘˜</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = teamPlayers.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- )&#123; <span class="comment">// éå†åˆ é™¤</span></div><div class="line">			<span class="keyword">if</span> ( teamPlayers[ i ] === player )&#123;</div><div class="line">				teamPlayers.splice( i, <span class="number">1</span> );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ç©å®¶æ¢é˜Ÿ*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">	operations.changeTeam = function( player, newTeamColor )&#123; <span class="comment">// ç©å®¶æ¢é˜Ÿ</span></div><div class="line">		operations.removePlayer( player ); <span class="comment">// ä»åŸé˜Ÿä¼ä¸­åˆ é™¤</span></div><div class="line">		player.teamColor = newTeamColor; <span class="comment">// æ”¹å˜é˜Ÿä¼é¢œè‰²</span></div><div class="line">		operations.addPlayer( player ); <span class="comment">// å¢åŠ åˆ°æ–°é˜Ÿä¼ä¸­</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	operations.playerDead = function( player )&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></div><div class="line">		<span class="keyword">var</span> teamColor = player.teamColor,</div><div class="line">		teamPlayers = players[ teamColor ]; <span class="comment">// ç©å®¶æ‰€åœ¨é˜Ÿä¼</span></div><div class="line">		<span class="keyword">var</span> all_dead = <span class="keyword">true</span>;</div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">			<span class="keyword">if</span> ( player.state !== <span class="string">'dead'</span> )&#123;</div><div class="line">				all_dead = <span class="keyword">false</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> ( all_dead === <span class="keyword">true</span> )&#123; <span class="comment">// å…¨éƒ¨æ­»äº¡</span></div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">				player.lose(); <span class="comment">// æœ¬é˜Ÿæ‰€æœ‰ç©å®¶lose</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> color <span class="keyword">in</span> players )&#123;</div><div class="line">				<span class="keyword">if</span> ( color !== teamColor )&#123;</div><div class="line">					<span class="keyword">var</span> teamPlayers = players[ color ]; </div><div class="line">                                         <span class="comment">// å…¶ä»–é˜Ÿä¼çš„ç©å®¶</span></div><div class="line">					<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">						player.win(); <span class="comment">// å…¶ä»–é˜Ÿä¼æ‰€æœ‰ç©å®¶win</span></div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">         </div><div class="line">	   <span class="keyword">var</span> reciveMessage = function()&#123;</div><div class="line">            <span class="comment">//è¢«ä¸­ä»‹è€…ä¸­ä½¿ç”¨é€šçŸ¥ä¸­ä»‹è€…çš„æ–¹æ³•</span></div><div class="line">		<span class="keyword">var</span> message = Array.prototype.shift.call( arguments ); <span class="comment">// arguments çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¶ˆæ¯åç§°</span></div><div class="line">		operations[ message ].apply( <span class="keyword">this</span>, arguments );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		reciveMessage: reciveMessage<span class="comment">//æ­ç¤ºæ¨¡å¼çš„æ–¹æ³•</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;)();</div><div class="line"></div><div class="line">	<span class="comment">// çº¢é˜Ÿï¼š</span></div><div class="line">	<span class="keyword">var</span> player1 = playerFactory( <span class="string">'çš®è›‹'</span>, <span class="string">'red'</span> ),</div><div class="line">	player2 = playerFactory( <span class="string">'å°ä¹–'</span>, <span class="string">'red'</span> ),</div><div class="line">	player3 = playerFactory( <span class="string">'å®å®'</span>, <span class="string">'red'</span> ),</div><div class="line">	player4 = playerFactory( <span class="string">'å°å¼º'</span>, <span class="string">'red'</span> );</div><div class="line">	<span class="comment">// è“é˜Ÿï¼š</span></div><div class="line">	<span class="keyword">var</span> player5 = playerFactory( <span class="string">'é»‘å¦'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player6 = playerFactory( <span class="string">'è‘±å¤´'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player7 = playerFactory( <span class="string">'èƒ–å¢©'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player8 = playerFactory( <span class="string">'æµ·ç›—'</span>, <span class="string">'blue'</span> );</div><div class="line">	player1.die();</div><div class="line">	player2.die();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div><div class="line"></div><div class="line">	player1.remove();</div><div class="line">	player2.remove();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div><div class="line"></div><div class="line">	player1.changeTeam( <span class="string">'blue'</span> );</div><div class="line">	player2.die();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div></pre></td></tr></table></figure></p>
<p>ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œä½¿ç”¨è€…ä¹‹é—´æ˜¯ä¸å‘ç”Ÿä»»ä½•å…³ç³»çš„ã€‚å‘ç”Ÿä»»ä½•çš„æ“ä½œéƒ½æ˜¯é€šçŸ¥ä¸­ä»‹è€…ã€‚ä¸­ä»‹è€…å†é€šçŸ¥å…¶ä»–ä½¿ç”¨è€…ã€‚<br>ä½¿ç”¨è€…ä¹‹é—´çš„è€¦åˆè§£é™¤äº†ã€‚</p>
<p>æ•°ç»„çš„ä½¿ç”¨ä¸Šçµæ´»åº¦å¾ˆå¤§è¦æ³¨æ„ï¼Œå…¶ä»–çš„åœ°æ–¹è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ã€‚</p>
<p>æˆ‘æ„Ÿè§‰reactç»„ä»¶å’Œreduxæ¨¡å—çš„ç›¸äº’å…³ç³»å°±æ˜¯ä¸­ä»‹è€…æ¨¡å¼ï¼Œæ‚¨è§‰å¾—å‘¢ï¼Ÿ</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨å­—å…¸é‡Œï¼Œä¸­ä»‹è€…æ˜¯æŒ‡â€œååŠ©è°ˆåˆ¤å’Œè§£å†³å†²çªçš„ä¸­ç«‹æ–¹â€ã€‚åœ¨æ¨¡å¼è®¾è®¡é‡Œï¼Œä¸­ä»‹è€…æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬å…¬å¼€ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç³»ç»Ÿä¸åŒéƒ¨åˆ†å¯ä»¥é€šè¿‡è¯¥æ¥å£è¿›è¡Œé€šè®¯ã€‚&lt;br&gt;ä¹Ÿè®¸ä¸€ä¸ªå¯¹è±¡å¯ä»¥å’Œåä¸ªå¯¹è±¡ä¹‹é—´å‘ç”Ÿè”ç³»ï¼Œåä¸ªå¯¹è±¡ä¹‹é—´æœ‰å¯ä»¥å‘ç”Ÿç›¸äº’è”ç³»ï¼Œä»è€Œå½¢æˆä¸€
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/10/javascript%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/10/javascriptå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼/</id>
    <published>2017-03-10T00:04:10.000Z</published>
    <updated>2017-03-23T12:07:55.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™ä¸ªæ¨¡å¼çœ‹äº†å¾ˆé•¿æ—¶é—´ï¼Œå¡åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œå…¶ä»–çš„æ¨¡å¼ä¸ºäº†ç®€åŒ–ç¼–ç¨‹çš„å¤æ‚æ€§ï¼Œéƒ½æ˜¯é¼“åŠ±å‡½æ•°æˆ–è€…å¯¹è±¡é—´<code>è§£è€¦å’Œ</code>çš„ï¼Œä½†æ˜¯å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼è™½ç„¶å‘å¸ƒè€…å’Œè®¢é˜…è€…å¯¹è±¡åˆ†å¼€äº†ï¼Œä½†æ˜¯ä¹‹é—´çš„ä¾èµ–å…³ç³»åè€Œæ›´å¼ºäº†ã€‚ </p>
</blockquote>
<p><em>å…³é”®ç‚¹</em>ï¼š1.è®¢é˜…è€…åœ¨è®¢é˜…äº‹ä»¶çš„æ—¶å€™å®é™…æ˜¯åœ¨å‘å¸ƒè€…å¯¹è±¡çš„æ•°ç»„ä¸­å†™å…¥è¦è®¢é˜…çš„äº‹ä»¶ã€‚ 2.å‘å¸ƒè€…åœ¨å‘å¸ƒæˆ–è€…å«triggeräº‹ä»¶çš„æ—¶å€™ï¼Œå®é™…æ˜¯åœ¨å‘å¸ƒè€…ä¸­éå†æ•°ç»„ä¸­è®¢é˜…è€…çš„äº‹ä»¶æ–¹æ³•ã€‚<code>æ¶‰åŠçš„æ˜¯æ¶ˆæ¯æ•°ç»„çš„å†™å…¥å’Œéå†è¯»å‡ºè¿‡ç¨‹</code>ã€‚</p>
<p>å¦å¤–ä¸€ç‚¹å°±æ˜¯ï¼Œç”±äºjavascriptçš„å‡½æ•°ä¸€ç±»å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥å†™å…¥æ•°ç»„ï¼Œè¿™æ ·å’‹å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼ä¸­æ“ä½œèµ·æ¥ç›¸å½“çš„æ–¹ä¾¿ï¼ŒjsçœŸæ˜¯å‰å®³ã€‚</p>
<p>å…³äºå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼çš„åŒºåˆ«æˆ‘æ²¡ææ‡‚ã€‚è¿™é‡Œçš„ä¾‹å­æˆ–è®¸æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæˆ–è®¸æ˜¯å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼ã€‚</p>
<blockquote>
<p>å‚è€ƒ ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹<code>pro javascript design patterns</code> ç¬¬åäº”ç« </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å‘å¸ƒè€…æ„é€ å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Publisher</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subscribers = []; <span class="comment">//è®¢é˜…å’Œå‘å¸ƒéƒ½æ˜¯å›´ç»•è¿™ä¸ªæ•°ç»„è¿›é¡¹</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//æ‰§è¡Œå‘å¸ƒçš„æ–¹æ³•ï¼Œéå†è®¢é˜…è€…å¯¹æ–¹æ³•</span></div><div class="line">Publisher.prototype.deliver = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subscribers.forEach(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</div><div class="line">      fn(data);</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//è®¢é˜…çš„æ–¹æ³•ï¼Œè®¢é˜…è€…å¯¹è±¡å†™å…¥subscribersæ•°ç»„</span></div><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸¤ä¸ªæ–¹æ³•æŒ‚è½½åœ¨FunctionåŸå‹ä¸Š</span></div><div class="line"><span class="built_in">Function</span>.prototype.subscribe = <span class="function"><span class="keyword">function</span>(<span class="params">publisher</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">var</span> alreadyExists = publisher.subscribers.some(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> ( el === that ) &#123; <span class="comment">//å¦‚æœå·²ç»è®¢é˜…çš„è¯ï¼Œç«‹å³è¿”å›</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">if</span> ( !alreadyExists ) &#123; <span class="comment">//è®¢é˜…è€…çš„è®¢é˜…å¯¹è±¡æ’å…¥æ•°ç»„</span></div><div class="line">    publisher.subscribers.push(<span class="keyword">this</span>);<span class="comment">//æ³¨æ„å‘½åç©ºé—´</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//å–æ¶ˆè®¢é˜…çš„æ–¹æ³•</span></div><div class="line"><span class="built_in">Function</span>.prototype.unsubscribe = <span class="function"><span class="keyword">function</span>(<span class="params">publisher</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  publisher.subscribers = publisher.subscribers.filter(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> ( el !== that ) &#123; <span class="comment">//å¦‚æœæ˜¯è®¢é˜…å¯¹è±¡å°±è¿‡æ»¤æ‰</span></div><div class="line">        <span class="keyword">return</span> el;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> publisherObject = <span class="keyword">new</span> Publisher;<span class="comment">//å‘å¸ƒè€…å¯¹è±¡</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> observerObject = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;<span class="comment">//è®¢é˜…è€…å¯¹è±¡ </span></div><div class="line">  <span class="comment">// process data</span></div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">  <span class="comment">// unsubscribe from this publisher</span></div><div class="line">  <span class="built_in">arguments</span>.callee.unsubscribe(publisherObject);</div><div class="line">  <span class="comment">//åœ¨è®¢é˜…å¯¹è±¡ä¸­å–æ¶ˆè®¢é˜…ï¼Œå…¶å®å°±æ˜¯åªæ‰§è¡Œä¸€æ¬¡å‘å¸ƒæ“ä½œ</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">observerObject.subscribe(publisherObject);  </div><div class="line"><span class="comment">//æ‰§è¡Œè®¢é˜…ï¼Œæ³¨æ„è¿™ä¸ªè®¢é˜…æ–¹æ³•æŒ‚è½½çš„åŸå‹ï¼Œæˆ‘å¼€å§‹ææ··äº†ï¼Œä»¥ä¸ºä»£ç æœ‰é”™</span></div></pre></td></tr></table></figure>
<blockquote>
<p>jsçš„æ•°ç»„æ“ä½œå’Œé«˜é˜¶å‡½æ•°çš„ç‰¹æ€§ä½¿å¾—å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼å¾ˆå¥½å®ç°ã€‚<br>  è¿™ä¸ªæ¨¡å¼æˆ‘åœ¨react/reduxçš„æ•°æ®æµç¨‹ä¸­è§‰å¾—æ˜¯æœ‰çš„ï¼Œä½†æ˜¯åè€Œåœ¨æ¨¡å¼å­¦ä¹ ä¸­æ˜¯æœ€éš¾çš„ã€‚è§£è€¦å’Œä¹Ÿä¸æ˜¯ç»å¯¹çš„ä¸€ç‚¹è”ç³»éƒ½æ²¡æœ‰ï¼Œå…³ç³»æ˜¯<code>è—•æ–­ä¸è¿</code>ï¼Œè¦çœ‹åˆ°æ–­å¼€çš„<code>ä¸¤èŠ‚è—•</code>ï¼Œè¿˜è¦çœ‹åˆ°ä¹‹é—´çš„çš„<code>ä¸</code>.react/reduxçš„å­¦ä¹ ä¸­å°±è¦æ‰¾åˆ°è¿™å±‚å…³ç³»ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªæ¨¡å¼çœ‹äº†å¾ˆé•¿æ—¶é—´ï¼Œå¡åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œå…¶ä»–çš„æ¨¡å¼ä¸ºäº†ç®€åŒ–ç¼–ç¨‹çš„å¤æ‚æ€§ï¼Œéƒ½æ˜¯é¼“åŠ±å‡½æ•°æˆ–è€…å¯¹è±¡é—´&lt;code&gt;è§£è€¦å’Œ&lt;/code&gt;çš„ï¼Œä½†æ˜¯å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼è™½ç„¶å‘å¸ƒè€…å’Œè®¢é˜…è€…å¯¹è±¡åˆ†å¼€äº†ï¼Œä½†æ˜¯ä¹‹é—´çš„ä¾èµ–å…³ç³»åè€Œæ›´å¼ºäº†ã€‚ &lt;/p&gt;
&lt;/blockqu
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javscript" scheme="http://yoursite.com/tags/javscript/"/>
    
  </entry>
  
  <entry>
    <title>javascripté€‚é…å™¨æ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/10/javascript%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/10/javascripté€‚é…å™¨æ¨¡å¼/</id>
    <published>2017-03-09T17:04:10.000Z</published>
    <updated>2017-03-23T12:15:21.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>é€‚é…å™¨æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹æ€§ã€‚ä½¿ç”¨é€‚é…å™¨ä»¥ååŸæœ¬ä¸å…¼å®¹çš„ä¸¤ä¸ªè½¯ä»¶çš„æ¥å£å¯ä»¥å·¥ä½œåœ¨ä¸€èµ·äº†ã€‚<br>å®—æ—¨æ˜¯ä¸è¦æ”¹å˜åŸè½¯ä»¶æ¥å£çš„ç¨‹åºä»£ç ï¼Œåœ¨å¤–éƒ¨ä½¿ç”¨é€‚é…å™¨å¯¹æ•°æ®ç»“æ„åšè°ƒæ•´ã€‚<br>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬17ç« </p>
</blockquote>
<p>ç¬¬ä¸€æ®µä»£ç ï¼Œä¸¤ä¸ªåœ°å›¾æ¥å£ä¹‹é—´çš„é€‚é…</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> googleMap = &#123;</div><div class="line">		<span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)æ–¹æ³•æ˜¯<span class="title">show</span></span></div><div class="line">			<span class="title">console</span>.<span class="title">log</span>(<span class="params"> <span class="string">'å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾'</span> </span>);</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="title">var</span> <span class="title">baiduMap</span> = &#123;</div><div class="line">		display: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ–¹æ³•æ˜¯display</span></div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> baiduMapAdapter = &#123;</div><div class="line">		<span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//é€‚é…å™¨ä¹Ÿæ”¹ä¸ºshow,è¿”å›çš„æ˜¯display</span></div><div class="line">			<span class="keyword">return</span> baiduMap.display();</div><div class="line"></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//ä¸‹é¢æ˜¯æ¸²æŸ“åœ°å›¾çš„æ–¹æ³•ï¼Œä¼ å…¥åœ°å›¾å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> renderMap = <span class="function"><span class="keyword">function</span>(<span class="params"> map </span>)</span>&#123;<span class="comment">//ä¼ å…¥åœ°å›¾å¯¹è±¡</span></div><div class="line">		<span class="keyword">if</span> ( map.show <span class="keyword">instanceof</span> <span class="built_in">Function</span> )&#123; <span class="comment">//åˆ¤æ–­</span></div><div class="line">			map.show();  <span class="comment">//åœ°å›¾å¯¹è±¡çš„showæ–¹æ³•</span></div><div class="line">			<span class="comment">//åœ¨ä¼ å…¥baiduMapAdapterå¯¹è±¡çš„æ—¶å€™ï¼Œè°ƒç”¨showæ–¹æ³•ï¼Œè¿”å›çš„</span></div><div class="line">			<span class="comment">//å®é™…æ˜¯baiduMapçš„displayæ–¹æ³•ã€‚</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	renderMap( googleMap ); <span class="comment">// è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾</span></div><div class="line">	renderMap( baiduMapAdapter ); <span class="comment">// è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ </span></div><div class="line"> </div><div class="line"> <span class="string">``</span><span class="string">`   </span></div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">æ•°æ®ç»“æ„å¦‚æœä¸åŒï¼Œä¹Ÿå¯ä»¥ä¸è¦æ”¹åŠ¨APIçš„è¾“å‡ºä»£ç ï¼Œåªæ”¹åŠ¨è¾“å‡ºä»¥åçš„æ•°æ®å‘ˆç°ç»“æ„</div></pre></td></tr></table></figure>
<p> //å…¶ä¸­ä¸€ä¸ªAPIè¿”å›çš„æ•°æ®<br> var getGuangdongCity = function(){<br>        var guangdongCity = [<br>        {<br>            name: â€˜shenzhenâ€™,<br>            id: 11,<br>        }, {<br>            name: â€˜guangzhouâ€™,<br>            id: 12,<br>        }<br>        ];<br>        return guangdongCity;<br>    };<br>    var render = function( fn ){<br>        console.log( â€˜å¼€å§‹æ¸²æŸ“å¹¿ä¸œçœåœ°å›¾â€™ );<br>        document.write( JSON.stringify( fn() ) );<br>    };<br>    render( getGuangdongCity );</p>
<pre><code>//å¦ä¸€ä¸ªapiè·å¾—çš„æ•°æ®
var guangdongCity = {
    shenzhen: 11,
    guangzhou: 12,
    zhuhai: 13
};

//è¿™ä¸¤ä¸ªAPIè¿”å›çš„æ•°æ®ä¸åŒï¼Œä¸éœ€è¦æ”¹åŠ¨APIçš„è¾“å‡ºä»£ç ï¼Œè¦åœ¨è¾“
</code></pre><p>//å‡ºä»¥ååšé€‚é…ã€‚ æˆ‘ä»¬è‡ªå·±çš„APIå¯ä»¥æ”¹åŠ¨ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹çš„APIå°±<br>//æ²¡æœ‰åŠæ³•è¦æ±‚æ”¹åŠ¨è¾“å‡ºç»“æ„ã€‚æ‰€ä»¥æœ€å¥½æ˜¯åšé€‚é…ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯è¯´æ˜æœ‰è¿™ä¸ªæ€è·¯ã€‚</p>
<pre><code><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//new data</span></div><div class="line">  <span class="built_in">var</span> guangdongCity = &#123;</div><div class="line">	<span class="attribute">shenzhen</span>: <span class="number">11</span>,</div><div class="line">	<span class="attribute">guangzhou</span>: <span class="number">12</span>,</div><div class="line">	<span class="attribute">zhuhai</span>: <span class="number">13</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//æŒ‰ç…§éœ€è¦æŠŠä¸‹é¢çš„è¾“å‡ºæ ¼å¼æ”¹ä¸ºä¸Šé¢ä»£ç é‡Œçš„æ ¼å¼</span></div><div class="line"><span class="comment">//old data</span></div><div class="line"><span class="built_in">var</span> getGuangdongCity = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">var</span> guangdongCity = [</div><div class="line">	&#123;</div><div class="line">		<span class="attribute">name</span>: <span class="string">'shenzhen'</span>,</div><div class="line">		<span class="attribute">id:</span><span class="string"> 11,</span></div><div class="line">	&#125;, &#123;</div><div class="line">		name: <span class="string">'guangzhou'</span>,</div><div class="line">		<span class="attribute">id:</span><span class="string"> 12,</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	];</div><div class="line">	return guangdongCity;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//æ–°æ—§æ•°æ®ç»Ÿä¸€çš„æ¸²æŸ“æ–¹æ³•</span></div><div class="line"><span class="built_in">var</span> render = <span class="function"><span class="keyword">function</span>(<span class="params"> fn </span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹æ¸²æŸ“å¹¿ä¸œçœåœ°å›¾'</span> );</div><div class="line">	<span class="built_in">document</span>.write( <span class="built_in">JSON</span>.stringify( fn() ) );</div><div class="line">&#125;;</div><div class="line"> <span class="comment">//è¾“å‡ºæ•°æ®ç»“æ„çš„é€‚é…å™¨ï¼ŒæŠŠæ—§æ•°æ®æŒ‰ç…§æ–°æ•°æ®ç»“æ„çš„æ ¼å¼åšé€‚é…</span></div><div class="line"><span class="built_in">var</span> addressAdapter = <span class="function"><span class="keyword">function</span>(<span class="params"> oldAddressfn </span>)</span>&#123;</div><div class="line">	<span class="built_in">var</span> address = &#123;&#125;,</div><div class="line">	oldAddress = oldAddressfn();<span class="comment">//è·å–å°±æ•°æ®</span></div><div class="line">	<span class="comment">//é€‚é…çš„å…·ä½“ä»£ç </span></div><div class="line">	<span class="keyword">for</span> ( <span class="built_in">var</span> i = <span class="number">0</span>, c; c = oldAddress[ i++ ]; )&#123;</div><div class="line">		address[ c.name ] = c.id;ç”±æ•°ç»„å¯¹è±¡æ”¹ä¸ºå¯¹è±¡å­˜å‚¨</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> address;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//é€šè¿‡é€‚é…å™¨æ¸²æŸ“æ—§æ•°æ®ï¼Œè¾“å‡ºçš„æ˜¯æ–°æ•°æ®çš„ç»“æ„</span></div><div class="line">render( addressAdapter( getGuangdongCity ) );</div></pre></td></tr></table></figure>
</code></pre><p>  å°±æˆ‘ä¸ªäººæ¥çœ‹ï¼Œ é€‚é…å™¨çš„æ€è·¯æ˜¯æœ€ç®€å•çš„ï¼Œä½†æ˜¯å®é™…æ“ä½œèµ·æ¥å¯èƒ½æ˜¯æœ€å¤æ‚çš„ï¼Œæ•°æ®ä¹‹é—´çš„é€‚é…å¯èƒ½æ¯”æƒ³è±¡ä¸­çš„éº»çƒ¦å¾ˆå¤šã€‚ä½†æ˜¯äº†è§£åˆ°è¿™ä¸ªæ€è·¯å¯¹äºç¼–ç¨‹çš„çµæ´»æ€§æœ‰äº†è®¤è¯†ï¼Œå¦‚æœæ˜¯ä»¥å‰å¯èƒ½é‡åˆ°è¿™æ ·çš„é—®é¢˜çš„æ—¶å€™ï¼Œé¦–å…ˆè€ƒè™‘åˆ°çš„æ˜¯æ€ä¹ˆå»ä¿®æ”¹åŸæ¥çš„çš„ä»£ç ã€‚ä¸€ä¸ªå°æ€è·¯ï¼Œæ–¹æ³•å®Œå…¨ä¸åŒäº†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;é€‚é…å™¨æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹æ€§ã€‚ä½¿ç”¨é€‚é…å™¨ä»¥ååŸæœ¬ä¸å…¼å®¹çš„ä¸¤ä¸ªè½¯ä»¶çš„æ¥å£å¯ä»¥å·¥ä½œåœ¨ä¸€èµ·äº†ã€‚&lt;br&gt;å®—æ—¨æ˜¯ä¸è¦æ”¹å˜åŸè½¯ä»¶æ¥å£çš„ç¨‹åºä»£ç ï¼Œåœ¨å¤–éƒ¨ä½¿ç”¨é€‚é…å™¨å¯¹æ•°æ®ç»“æ„åšè°ƒæ•´ã€‚&lt;br&gt;å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬17ç« &lt;/
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘-Reduxçš„ä¸­é—´ä»¶-Reselect</title>
    <link href="http://yoursite.com/2017/03/09/%E7%BF%BB%E8%AF%91-Redux%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6-Reselect/"/>
    <id>http://yoursite.com/2017/03/09/ç¿»è¯‘-Reduxçš„ä¸­é—´ä»¶-Reselect/</id>
    <published>2017-03-09T00:04:10.000Z</published>
    <updated>2017-03-23T11:31:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p><strong>æœ¬æ–‡æ˜¯ç¿»è¯‘Reduxçš„ä¸€ä¸ªä¸­é—´ä»¶æ–‡æ¡£.Reduxæ˜¯Reactçš„ä¸€ä¸ªæ•°æ®å±‚,Reactç»„ä»¶çš„stateæœ‰å…³é€»è¾‘å¤„ç†éƒ½è¢«å•ç‹¬æ”¾åˆ°Reduxä¸­æ¥è¿›è¡Œ,åœ¨stateçš„æ“ä½œæµç¨‹ä¸­è¡ç”Ÿäº†å¾ˆå¤šä¸­é—´ä»¶,Reselectè¿™ä¸ªä¸­é—´ä»¶è¦è§£å†³çš„é—®é¢˜æ˜¯:`åœ¨ç»„ä»¶äº¤äº’æ“ä½œçš„æ—¶å€™,stateå‘ç”Ÿå˜åŒ–çš„æ—¶å€™å¦‚ä½•å‡å°‘æ¸²æŸ“çš„å‹åŠ›.åœ¨Reselectä¸­é—´ä¸­ä½¿ç”¨äº†ç¼“å­˜æœºåˆ¶,è¿™ä¸ªæœºåˆ¶å¯ä»¥åœ¨javascriptçš„æ¨¡å¼è®¾è®¡ä¸­åˆšçœ‹åˆ°ä»‹ç»,è¿™é‡Œå°±ä¸è¯¦ç»†è¯´äº†.</strong>ä»…ä¾›å‚è€ƒ,ä»¥åŸæ–‡ä¸ºå‡†.</p>
<hr>
<p>ä¸€æ—¦reduxä»reactçš„æ•°æ®å±‚æ¥ç†è§£ï¼Œå¾ˆå¤šé—®é¢˜éƒ½ä¼¼ä¹æ‰¾åˆ°äº†ç†è®ºä¾æ®ï¼Œæ‰€è°“åæ­£è¨€é¡ºã€‚åœ¨webæ¡†æ¶ä¸­éƒ½ä¼šç”¨æ•°æ®åº“åšæ•°æ®æŒä¹…å±‚ï¼Œåœ¨æŸ¥è¡¨çš„æ—¶å€™ä¼šä¸ºäº†æ•ˆç‡åšç¼“å­˜ï¼Œreselectæ˜¯åŒæ ·çš„ç›®çš„ã€‚Reactçš„ç»„ä»¶æœ‰è‡ªå·±çš„ç‰¹æ®Šæ€§ï¼Œé‡åˆ°ç‰¹æ®Šçš„ç‰¹æ€§çš„æ—¶å€™éœ€è¦æœ‰ç‰¹æ®Šçš„å¤„ç†<br>æ–¹æ³•.</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯è¯‘æ–‡å†…å®¹,<a href="https://github.com/reactjs/reselect" target="_blank" rel="external">åŸæ–‡è¯·å‚è§</a></p>
<hr>
<blockquote>
<p>â€œselectorâ€æ˜¯ä¸€ä¸ªç®€å•çš„Reduxåº“,çµæ„Ÿæ¥æºäº<code>NuclearJS</code>.</p>
<ul>
<li>Selectorå¯ä»¥è®¡ç®—è¡ç”Ÿçš„æ•°æ®,å¯ä»¥è®©Reduxåšåˆ°å­˜å‚¨å°½å¯èƒ½å°‘çš„stateã€‚</li>
<li>Selectoræ¯”è¾ƒé«˜æ•ˆ,åªæœ‰åœ¨æŸä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰å‘ç”Ÿè®¡ç®—è¿‡ç¨‹.</li>
<li>Selectoræ˜¯å¯ä»¥ç»„åˆçš„,ä»–ä»¬å¯ä»¥ä½œä¸ºè¾“å…¥,ä¼ é€’åˆ°å…¶ä»–çš„selector.</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿™ä¸ªä¾‹å­ä¸å¿…å¤ªåœ¨æ„,åé¢ä¼šæœ‰è¯¦ç»†çš„ä»‹ç»</span></div><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> shopItemsSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.items</div><div class="line"><span class="keyword">const</span> taxPercentSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.taxPercent</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  shopItemsSelector,</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> taxSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxPercentSelector,</div><div class="line">  (subtotal, taxPercent) =&gt; subtotal * (taxPercent / <span class="number">100</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxSelector,</div><div class="line">  (subtotal, tax) =&gt; (&#123; <span class="attr">total</span>: subtotal + tax &#125;)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">let</span> exampleState = &#123;</div><div class="line">  <span class="attr">shop</span>: &#123;</div><div class="line">    <span class="attr">taxPercent</span>: <span class="number">8</span>,</div><div class="line">    <span class="attr">items</span>: [</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'apple'</span>, <span class="attr">value</span>: <span class="number">1.20</span> &#125;,</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'orange'</span>, <span class="attr">value</span>: <span class="number">0.95</span> &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(subtotalSelector(exampleState)) <span class="comment">// 2.15</span></div><div class="line"><span class="built_in">console</span>.log(taxSelector(exampleState))      <span class="comment">// 0.172</span></div><div class="line"><span class="built_in">console</span>.log(totalSelector(exampleState))    <span class="comment">// &#123; total: 2.322 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ul>
<li><a href="#å®‰è£…">Installation</a></li>
<li><a href="#å®ä¾‹">å®ä¾‹</a><ul>
<li><a href="#motivation-for-memoized-selectors">Motivation for Memoized Selectors</a></li>
<li><a href="#creating-a-memoized-selector">Creating a Memoized Selector</a></li>
<li><a href="#composing-selectors">Composing Selectors</a></li>
<li><a href="#connecting-a-selector-to-the-redux-store">Connecting a Selector to the Redux Store</a></li>
<li><a href="#accessing-react-props-in-selectors">Accessing React Props in Selectors</a></li>
<li><a href="#sharing-selectors-with-props-across-multiple-components">Sharing Selectors with Props Across Multiple Components</a></li>
</ul>
</li>
<li><a href="#api">API</a><ul>
<li><a href="#createselectorinputselectors--inputselectors-resultfunc"><code>createSelector</code></a></li>
<li><a href="#defaultmemoizefunc-equalitycheck--defaultequalitycheck"><code>defaultMemoize</code></a></li>
<li><a href="#createselectorcreatormemoize-memoizeoptions"><code>createSelectorCreator</code></a></li>
<li><a href="#createstructuredselectorinputselectors-selectorcreator--createselector"><code>createStructuredSelector</code></a></li>
</ul>
</li>
<li><p><a href="#faq">FAQ</a></p>
<ul>
<li><a href="#q-why-isnt-my-selector-recomputing-when-the-input-state-changes">Why isnâ€™t my selector recomputing when the input state changes?</a></li>
<li><a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">Why is my selector recomputing when the input state stays the same?</a></li>
<li><a href="#q-can-i-use-reselect-without-redux">Can I use Reselect without Redux?</a></li>
<li><a href="#q-the-default-memoization-function-is-no-good-can-i-use-a-different-one">The default memoization function is no good, can I use a different one?</a></li>
<li><a href="#q-how-do-i-test-a-selector">How do I test a selector?</a></li>
<li><a href="#q-how-do-i-create-a-selector-that-takes-an-argument">How do I create a selector that takes an argument? </a></li>
<li><a href="#q-how-do-i-use-reselect-with-immutablejs">How do I use Reselect with Immutable.js?</a></li>
<li><a href="#q-can-i-share-a-selector-across-multiple-components">Can I share a selector across multiple components?</a></li>
<li><a href="#q-are-there-typescript-typings">Are there TypeScript typings?</a></li>
<li><a href="#q-how-can-i-make-a-curried-selector">How can I make a curried selector?</a></li>
</ul>
</li>
<li><p><a href="#related-projects">Related Projects</a></p>
</li>
<li><a href="#license">License</a><br>##å®‰è£…<br><code>npm install reselect</code></li>
</ul>
<p>##å®ä¾‹</p>
<p>###ç¼“å­˜Selcectosçš„åŠ¨æœº</p>
<blockquote>
<p>å®ä¾‹æ˜¯åŸºäº <a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux Todos List example</a>.</p>
</blockquote>
<h4 id="containers-VisibleTodoList-js"><a href="#containers-VisibleTodoList-js" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"></div><div class="line"><span class="comment">//ä¸‹é¢è¿™æ®µä»£ç æ˜¯æ ¹æ®è¿‡æ»¤å™¨çš„stateæ¥æ”¹å˜æ—¥ç¨‹stateçš„å‡½æ•°</span></div><div class="line"><span class="keyword">const</span> getVisibleTodos = <span class="function">(<span class="params">todos, filter</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (filter) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">      <span class="keyword">return</span> todos</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">//todosæ˜¯æ ¹æ®è¿‡æ»¤å‡½æ•°è¿”å›çš„stateï¼Œä¼ å…¥ä¸¤ä¸ªå®å‚</span></div><div class="line">    todos: getVisibleTodos(state.todos, state.visibilityFilter)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//mapDispatchToPropsæ¥ä¼ é€’dispatchçš„æ–¹æ³•</span></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//ä½¿ç”¨Reduxçš„connectå‡½æ•°æ³¨å…¥state,åˆ°TodoListç»„ä»¶</span></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,<code>mapStateToProps</code>è°ƒç”¨<code>getVisibleTodos</code>å»è®¡ç®—<code>todos</code>.è¿™ä¸ªå‡½æ•°è®¾è®¡çš„æ˜¯ç›¸å½“å¥½çš„,ä½†æ˜¯æœ‰ä¸ªç¼ºç‚¹ï¼š<code>todos</code>åœ¨æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½ä¼šé‡æ–°è®¡ç®—.å¦‚æœstateæ ‘çš„ç»“æ„æ¯”è¾ƒå¤§,æˆ–è€…è®¡ç®—æ¯”è¾ƒæ˜‚è´µ,æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½è¿›è¡Œè®¡ç®—çš„è¯,å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜.<code>Reselect</code>èƒ½å¤Ÿå¸®åŠ©reduxæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—è¿‡ç¨‹.</p>
<p>###åˆ›å»ºä¸€ä¸ªç¼“å­˜Selector<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®°å¿†ç¼“å­˜selectorä»£æ›¿<code>getVisibleTodos</code>,å¦‚æœ<code>state.todos</code>å’Œ<code>state.visibilityFilter</code>å‘ç”Ÿå˜åŒ–,ä»–ä¼šé‡æ–°è®¡ç®—<code>state</code>,ä½†æ˜¯å‘ç”Ÿåœ¨å…¶ä»–éƒ¨åˆ†çš„stateå˜åŒ–,å°±ä¸ä¼šé‡æ–°è®¡ç®—.</p>
<p>Reslectæä¾›ä¸€ä¸ªå‡½æ•°<code>createSelector</code>æ¥åˆ›å»ºä¸€ä¸ªè®°å¿†selectors.<code>createSelector</code>æ¥å—ä¸€ä¸ª<code>input-selectors</code>å’Œä¸€ä¸ªå˜æ¢å‡½æ•°ä½œä¸ºå‚æ•°.å¦‚æœReduxçš„stateå‘ç”Ÿæ”¹å˜é€ æˆ<code>input-selector</code>çš„å€¼å‘ç”Ÿæ”¹å˜,selectorä¼šè°ƒç”¨å˜æ¢å‡½æ•°,ä¾æ®<code>input-selector</code>åšå‚æ•°,è¿”å›ä¸€ä¸ªç»“æœ.å¦‚æœ<code>input-selector</code>è¿”å›çš„ç»“æœå’Œå‰é¢çš„ä¸€æ ·,é‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å›æœ‰å…³state,ä¼šçœç•¥å˜æ¢å‡½æ•°çš„è°ƒç”¨.</p>
<p>ä¸‹é¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè®°å¿†selector<code>getVisibleTodos</code>æ›¿ä»£éè®°å¿†çš„ç‰ˆæœ¬</p>
<h4 id="selectors-index-js"><a href="#selectors-index-js" class="headerlink" title="selectors/index.js"></a><code>selectors/index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state</span>) =&gt;</span> state.visibilityFilter</div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state</span>) =&gt;</span> state.todos</div><div class="line"><span class="comment">//ä¸‹é¢çš„å‡½æ•°æ˜¯ç»è¿‡åŒ…è£…çš„</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä¸Šé¢çš„çš„å®ä¾‹ä¸­,<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>æ˜¯input-selectors.è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æ™®é€šçš„éè®°å¿†selectorå‡½æ•°,å› ä¸ºä»–ä»¬æ²¡æœ‰å˜æ¢ä»–ä»¬selectçš„æ•°æ®.<code>getVisibleTodos</code>å¦ä¸€æ–¹é¢æ˜¯ä¸€ä¸ªè®°å¿†selector.ä»–æ¥æ”¶<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>ä½œä¸ºinput-selectors,å¹¶ä¸”ä½œä¸ºä¸€ä¸ªå˜æ¢å‡½æ•°è®¡ç®—ç­›é€‰çš„todo list.</p>
<p>###èšåˆselectors</p>
<p>ä¸€ä¸ªè®°å¿†æ€§selectoræœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªè®°å¿†æ€§selectorçš„input-selector.è¿™é‡Œ<code>getVisibleTodos</code>å¯ä»¥ä½œä¸ºinput-selectorä½œä¸ºå…³é”®å­—ç­›é€‰çš„input-selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> getKeyword = <span class="function">(<span class="params">state</span>) =&gt;</span> state.keyword</div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodosFilteredByKeyword = createSelector(</div><div class="line">  [ getVisibleTodos, getKeyword ],</div><div class="line">  (visibleTodos, keyword) =&gt; visibleTodos.filter(</div><div class="line">    <span class="function"><span class="params">todo</span> =&gt;</span> todo.text.indexOf(keyword) &gt; <span class="number">-1</span></div><div class="line">  )</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###è¿æ¥ä¸€ä¸ªSelectoråˆ°Redux Store<br>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ <a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">React Redux</a>, ä½ å¯ä»¥ç›´æ¥ä¼ é€’selectoråˆ° <code>mapStateToProps()</code>:</p>
<h4 id="containers-VisibleTodoList-js-1"><a href="#containers-VisibleTodoList-js-1" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>###åœ¨React Propsä¸­æ¥å…¥Selectors</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å‡è®¾ç¨‹åºå°†ä¼šæœ‰ä¸€ä¸ªæ‰©å±•,æˆ‘ä»¬å…è®¸selectoræ”¯æŒå¤štodo List.è¯·æ³¨æ„å¦‚æœè¦å®Œå…¨å®æ–½è¿™ä¸ªæ‰©å±•,reducers,components,actionsç­‰ç­‰éƒ½éœ€è¦ä½œå‡ºæ”¹å˜.è¿™äº›å†…å®¹å’Œä¸»é¢˜ä¸æ˜¯å¤ªç›¸å…³,æ‰€ä»¥è¿™é‡Œå°±çœç•¥æ‰äº†.</p>
</blockquote>
<p>ç›®å‰ä¸ºæ­¢,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°selectorsæ¥æ”¶storeçš„stateä½œä¸ºä¸€ä¸ªå‚æ•°,å…¶å®ä¸€ä¸ªselectorå¶å¯ä»¥æ¥å—props.</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ª<code>App</code>ç»„ä»¶,æ¸²æŸ“å‡ºä¸‰ä¸ª<code>VisibleTodoList</code>ç»„ä»¶,æ¯ä¸€ä¸ªç»„ä»¶æœ‰<code>ListId</code>å±æ€§.</p>
<h4 id="components-App-js"><a href="#components-App-js" class="headerlink" title="components/App.js"></a><code>components/App.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer'</span></div><div class="line"><span class="keyword">import</span> AddTodo <span class="keyword">from</span> <span class="string">'../containers/AddTodo'</span></div><div class="line"><span class="keyword">import</span> VisibleTodoList <span class="keyword">from</span> <span class="string">'../containers/VisibleTodoList'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;VisibleTodoList listId="1" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="2" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="3" /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ª<code>VisibleTodoList</code>containeråº”è¯¥æ ¹æ®å„è‡ªçš„<code>listId</code>å±æ€§è·å–stateçš„ä¸åŒéƒ¨åˆ†.æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code>getVisibilityFilter</code>å’Œ<code>getTodos</code>,ä¾¿äºæ¥å—ä¸€ä¸ªå±æ€§å‚æ•°</p>
<h4 id="selectors-todoSelectors-js"><a href="#selectors-todoSelectors-js" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos <span class="comment">//è¿™é‡Œæ˜¯ä¸ºäºŒç»´æ•°ç»„äº†</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> getVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p><code>props</code>å¯ä»¥ä»<code>mapStateToProps</code>ä¼ é€’åˆ°<code>getVisibleTodos</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨<code>getVisibleTodos</code>å¯ä»¥è·å–<code>props</code>,æ¯ä¸€éƒ¨åˆ†ä¼¼ä¹éƒ½å·¥ä½œçš„ä¸é”™.</p>
<p><em>**ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜</em><br>å½“<code>getVisibleTodos</code>selectorå’Œ<code>VisibleTodoList</code>containerçš„å¤šä¸ªå®ä¾‹ä¸€èµ·å·¥ä½œçš„æ—¶å€™,è®°å¿†åŠŸèƒ½å°±ä¸èƒ½æ­£å¸¸çš„è¿è¡Œ:</p>
<h4 id="containers-VisibleTodoList-js-2"><a href="#containers-VisibleTodoList-js-2" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">// WARNING: THE FOLLOWING SELECTOR DOES NOT CORRECTLY MEMOIZE</span></div><div class="line">    <span class="comment">//âš ï¸ä¸‹é¢çš„selectorä¸èƒ½æ­£ç¡®çš„è®°å¿†</span></div><div class="line">    todos: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ—¶å€™,å¦‚æœä»–çš„å‚æ•°é›†åˆå’Œä¸Šä¸€æ¬¡çš„å‚æ•°æœºä¼šæ˜¯ä¸€æ ·çš„,ä»…ä»…è¿”å›ç¼“å­˜çš„å€¼.å¦‚æœæˆ‘ä»¬äº¤æ›¿æ¸²æŸ“<code>&lt;VisibleTodoList listId=&quot;1&quot; /&gt;</code> å’Œ<code>&lt;VisibleTodoList listId=&quot;2&quot; /&gt;</code>æ—¶,å…±äº«çš„selectorå°†ä¼šäº¤æ›¿æ¥å—<code>{listIdï¼š1}</code>å’Œ<code>{listId:2}</code>ä½œä¸ºä»–çš„propsçš„å‚æ•°.è¿™å°†ä¼šå¯¼è‡´æ¯ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™çš„å‚æ•°éƒ½ä¸åŒ,å› æ­¤selectoræ¯æ¬¡éƒ½ä¼šé‡æ–°æ¥è®¡ç®—è€Œä¸æ˜¯è¿”å›ç¼“å­˜çš„å€¼.ä¸‹ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†ä¼šä»‹ç»æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜.</p>
<p>###è·¨è¶Šå¤šä¸ªç»„ä»¶ä½¿ç”¨selectorså…±æ€§props</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†çš„å®ä¾‹éœ€è¦React Redux v4.3.0æˆ–è€…æ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒ.</p>
</blockquote>
<p>åœ¨å¤šä¸ª<code>VisibleTodoList</code>ç»„ä»¶ä¸­å…±äº«selector,åŒæ—¶è¿˜è¦<strong>ä¿æŒ</strong>è®°å¿†æ€§,æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹éœ€è¦ä»–ä»¬è‡ªå·±çš„selectorå¤‡ä»½.</p>
<p>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°<code>makeGetVisibleTodos</code>,è¿™ä¸ªå‡½æ•°æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™è¿”å›ä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>çš„æ‹·è´:</p>
<h4 id="selectors-todoSelectors-js-1"><a href="#selectors-todoSelectors-js-1" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos</div><div class="line"></div><div class="line"><span class="keyword">const</span> makeGetVisibleTodos = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    [ getVisibilityFilter, getTodos ],</div><div class="line">    (visibilityFilter, todos) =&gt; &#123;</div><div class="line">      <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">          <span class="keyword">return</span> todos</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeGetVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦è®¾ç½®ç»™æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹ä»–ä»¬å„è‡ªè·å–ç§æœ‰çš„selectoræ–¹æ³•.<code>mapStateToProps</code>çš„<code>connect</code>å‡½æ•°å¯ä»¥å¸®åŠ©å®Œæˆè¿™ä¸ªåŠŸèƒ½.</p>
<p><em>**å¦‚æœ<code>mapStateToProps</code>æä¾›ç»™<code>connect</code>ä¸è¿”å›ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°,ä»–å°±å¯ä»¥è¢«ç”¨æ¥ä¸ºæ¯ä¸ªç»„ä»¶containeråˆ›å»ºä¸€ä¸ªç§æœ‰çš„<code>mapStateProps</code>å‡½æ•°.</em></p>
<p>åœ¨ä¸‹é¢çš„å®ä¾‹ä¸­,<code>mapStateProps</code>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>selector,ä»–è¿”å›ä¸€ä¸ª<code>mapStateToProps</code>å‡½æ•°,è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ¥å…¥æ–°çš„selector.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœæˆ‘ä»¬æŠŠ<code>makeMapStateToprops</code>ä¼ é€’åˆ°<code>connect</code>,æ¯ä¸€ä¸ª<code>visibleTodoList</code>containerå°†ä¼šè·å¾—å„è‡ªçš„å«æœ‰ç§æœ‰<code>getVisibleTodos</code>selectorçš„<code>mapStateToProps</code>çš„å‡½æ•°.è¿™æ ·ä¸€æ¥è®°å¿†å°±æ­£å¸¸äº†,ä¸ç®¡<code>VisibleTodoList</code>containersçš„æ¸²æŸ“é¡ºåºæ€ä¹ˆæ ·.</p>
<h4 id="containers-VisibleTodoList-js-3"><a href="#containers-VisibleTodoList-js-3" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; makeGetVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  makeMapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>##API</p>
<p>###createSelector(â€¦inputSelectors|[inputSelectors],resultFunc)</p>
<p>æ¥å—ä¸€ä¸ªæˆ–è€…å¤šä¸ªselectors,æˆ–è€…ä¸€ä¸ªselectorsæ•°ç»„,è®¡ç®—ä»–ä»¬çš„å€¼å¹¶ä¸”ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>resultFunc</code>.</p>
<p><code>createSelector</code>é€šè¿‡åˆ¤æ–­input-selectorä¹‹å‰è°ƒç”¨å’Œä¹‹åè°ƒç”¨çš„è¿”å›å€¼çš„å…¨ç­‰äº(===,è¿™ä¸ªåœ°æ–¹è‹±æ–‡æ–‡çŒ®å«reference equality,å¼•ç”¨ç­‰äº,è¿™ä¸ªå•è¯æ˜¯æœ¬è´¨,ä¸­æ–‡æ²¡æœ‰ç¿»è¯‘å‡ºæ¥).ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„selectoråº”è¯¥æ˜¯immutable(ä¸å˜çš„).</p>
<p>ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„Selectorsæœ‰ä¸€ä¸ªç¼“å­˜,å¤§å°æ˜¯1.è¿™æ„å‘³ç€å½“ä¸€ä¸ªinput-selectorå˜åŒ–çš„æ—¶å€™,ä»–ä»¬æ€»æ˜¯ä¼šé‡æ–°è®¡ç®—state,å› ä¸ºSelectorä»…ä»…å­˜å‚¨æ¯ä¸€ä¸ªinput-selectorå‰ä¸€ä¸ªå€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">  state =&gt; state.values.value2,</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// You can also pass an array of selectors</span></div><div class="line"><span class="comment">//å¯ä»¥å‡ºä¼ é€’ä¸€ä¸ªselectoræ•°ç»„</span></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  [</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">    state =&gt; state.values.value2</div><div class="line">  ],</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨selectorå†…éƒ¨è·å–ä¸€ä¸ªç»„ä»¶çš„propséå¸¸æœ‰ç”¨.å½“ä¸€ä¸ªselectoré€šè¿‡<code>connect</code>å‡½æ•°è¿æ¥åˆ°ä¸€ä¸ªç»„ä»¶ä¸Š,ç»„ä»¶çš„å±æ€§ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> abSelector = <span class="function">(<span class="params">state, props</span>) =&gt;</span> state.a * props.b</div><div class="line"></div><div class="line"><span class="comment">// props only (ignoring state argument)</span></div><div class="line"><span class="keyword">const</span> cSelector =  <span class="function">(<span class="params">_, props</span>) =&gt;</span> props.c</div><div class="line"></div><div class="line"><span class="comment">// state only (props argument omitted as not required)</span></div><div class="line"><span class="keyword">const</span> dSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.d</div><div class="line"></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  abSelector,</div><div class="line">  cSelector,</div><div class="line">  dSelector,</div><div class="line">  (ab, c, d) =&gt; (&#123;</div><div class="line">    <span class="attr">total</span>: ab + c + d</div><div class="line">  &#125;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###defaultMemoize(func, equalityCheck = defaultEqualityCheck)</p>
<p><code>defaultMemoize</code>èƒ½è®°ä½é€šè¿‡funcä¼ é€’çš„å‚æ•°.è¿™æ˜¯<code>createSelector</code>ä½¿ç”¨çš„è®°å¿†å‡½æ•°.</p>
<p><code>defaultMemoize</code> é€šè¿‡è°ƒç”¨<code>equalityCheck</code>å‡½æ•°æ¥å†³å®šä¸€ä¸ªå‚æ•°æ˜¯å¦å·²ç»å‘ç”Ÿæ”¹å˜.å› ä¸º<code>defaultMemoize</code>è®¾è®¡å‡ºæ¥å°±æ˜¯å’Œimmutableæ•°æ®ä¸€èµ·ä½¿ç”¨,é»˜è®¤çš„<code>equalityCheck</code>ä½¿ç”¨å¼•ç”¨å…¨ç­‰äºæ¥åˆ¤æ–­å˜åŒ–:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaultEqualityCheck</span>(<span class="params">currentVal, previousVal</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> currentVal === previousVal</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><code>defaultMemoize</code>å’Œ<code>createSelectorCreator</code>å»<a href="#é…ç½®-equalitycheck-for-defaultmemoize">é…ç½®<code>equalityCheck</code>å‡½æ•°</a>.</p>
<p>###createSelectorCreator(memoize,â€¦memoizeOptions)</p>
<p><code>createSelectorCreator</code>ç”¨æ¥é…ç½®å®šåˆ¶ç‰ˆæœ¬çš„<code>createSelector</code>.</p>
<p><code>memoize</code>å‚æ•°æ˜¯ä¸€ä¸ªæœ‰è®°å¿†åŠŸèƒ½çš„å‡½æ•°,æ¥ä»£æ›¿<code>defaultMemoize</code>.<br><code>â€¦memoizeOption</code>å±•å¼€çš„å‚æ•°æ˜¯0æˆ–è€…æ›´å¤šçš„é…ç½®é€‰é¡¹,è¿™äº›å‚æ•°ä¼ é€’ç»™<code>memoizeFunc</code>.selectors<code>resultFunc</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>memoize</code>,<code>memoizeOptions</code>ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(</div><div class="line">  customMemoize, <span class="comment">// function to be used to memoize resultFunc,è®°å¿†resultFunc</span></div><div class="line">  option1, <span class="comment">// option1 will be passed as second argument to customMemoize ç¬¬äºŒä¸ªæƒ¨å‘¼</span></div><div class="line">  option2, <span class="comment">// option2 will be passed as third argument to customMemoize ç¬¬ä¸‰ä¸ªå‚æ•°</span></div><div class="line">  option3 <span class="comment">// option3 will be passed as fourth argument to customMemoize   ç¬¬å››ä¸ªå‚æ•°</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> customSelector = customSelectorCreator(</div><div class="line">  input1,</div><div class="line">  input2,</div><div class="line">  resultFunc <span class="comment">// resultFunc will be passed as first argument to customMemoize  ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™customMomize</span></div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨<code>customSelecotr</code>å†…éƒ¨æ»´å•Šç”¨memoizeçš„å‡½æ•°çš„ä»£ç å¦‚ä¸‹:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">customMemoize(resultFunc, option1, option2, option3)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªå¯èƒ½ä¼šç”¨åˆ°çš„<code>createSelectorCreator</code>çš„å®ä¾‹:</p>
<p>####ä¸º<code>defaultMemoize</code>é…ç½®<code>equalityCheck</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.filter(<span class="function"><span class="params">val</span> =&gt;</span> val &lt; <span class="number">5</span>),</div><div class="line">  values =&gt; values.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>####ä½¿ç”¨loadshçš„memoizeå‡½æ•°æ¥ç¼“å­˜æœªç»‘å®šçš„ç¼“å­˜.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> called = <span class="number">0</span></div><div class="line"><span class="keyword">const</span> hashFn = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.reduce(</div><div class="line">  <span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + <span class="string">'-'</span> + <span class="built_in">JSON</span>.stringify(val),</div><div class="line">  <span class="string">''</span></div><div class="line">)</div><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(memoize, hashFn)</div><div class="line"><span class="keyword">const</span> selector = customSelectorCreator(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; &#123;</div><div class="line">    called++</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<h3 id="createStructuredSelector-inputSelectors-selectorCreator-createSelector"><a href="#createStructuredSelector-inputSelectors-selectorCreator-createSelector" class="headerlink" title="createStructuredSelector({inputSelectors}, selectorCreator = createSelector)"></a>createStructuredSelector({inputSelectors}, selectorCreator = createSelector)</h3><p>å¦‚æœåœ¨æ™®é€šçš„æ¨¡å¼ä¸‹ä½¿ç”¨<code>createStructuredSelector</code>å‡½æ•°å¯ä»¥æå‡ä¾¿åˆ©æ€§.ä¼ é€’åˆ°<code>connect</code>çš„selectorè£…é¥°è€…(è¿™æ˜¯jsè®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ,å¯ä»¥å‚è€ƒç›¸å…³çš„ä¹¦ç±)æ¥å—ä»–çš„input-selectors,å¹¶ä¸”åœ¨ä¸€ä¸ªå¯¹è±¡å†…æ˜ å°„åˆ°ä¸€ä¸ªé”®ä¸Š.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="comment">// The result function in the following selector</span></div><div class="line"><span class="comment">// is simply building an object from the input selectors ç”±selectorsæ„å»ºçš„ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"><span class="keyword">const</span> structuredSelector = createSelector(</div><div class="line">   mySelectorA,</div><div class="line">   mySelectorB,</div><div class="line">   mySelectorC,</div><div class="line">   (a, b, c) =&gt; (&#123;</div><div class="line">     a,</div><div class="line">     b,</div><div class="line">     c</div><div class="line">   &#125;)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p><code>createStructuredSelector</code>æ¥å—ä¸€ä¸ªå¯¹è±¡,è¿™ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯input-selectors,å‡½æ•°è¿”å›ä¸€ä¸ªç»“æ„æ€§çš„selector.è¿™ä¸ªç»“æ„æ€§çš„selectorè¿”å›ä¸€ä¸ªå¯¹è±¡,å¯¹è±¡çš„é”®å’Œ<code>inputSelectors</code>çš„å‚æ•°æ˜¯ç›¸åŒçš„,ä½†æ˜¯ä½¿ç”¨selectorsä»£æ›¿äº†å…¶ä¸­çš„å€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="keyword">const</span> structuredSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">x</span>: mySelectorA,</div><div class="line">  <span class="attr">y</span>: mySelectorB</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> result = structuredSelector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;) <span class="comment">// will produce &#123; x: 1, y: 2 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<p>ç»“æ„æ€§çš„selectorså¯ä»¥æ˜¯åµŒå¥—å¼çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nestedSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">subA</span>: createStructuredSelector(&#123;</div><div class="line">    selectorA,</div><div class="line">    selectorB</div><div class="line">  &#125;),</div><div class="line">  <span class="attr">subB</span>: createStructuredSelector(&#123;</div><div class="line">    selectorC,</div><div class="line">    selectorD</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>##FAQ</p>
<h3 id="Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"><a href="#Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ" class="headerlink" title="Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"></a>Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ</h3><p>A:æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†éŸ©å¼æ˜¯ä¸æ˜¯å’Œä½ çš„stateæ›´æ–°å‡½æ•°ç›¸å…¼å®¹(ä¾‹å¦‚:å¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux).ä¾‹å¦‚:ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŸæ¥æœŸå¾…çš„æ˜¯æ›´æ–°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡.<code>createSelector</code>ä½¿ç”¨(===)æ£€æµ‹è¾“å…¥æ˜¯å¦æ”¹å˜,å› æ­¤å¦‚æœæ”¹å˜ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡æ²¡æœ‰è§¦å‘selectoré‡æ–°è®¡ç®—çš„åŸå› æ˜¯æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™æ²¡æœ‰è§¦å‘ç›¸å…³çš„æ£€æµ‹.æç¤ºï¼šå¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux,æ”¹å˜ä¸€ä¸ªstateå¯¹è±¡çš„<a href="http://redux.js.org/docs/Troubleshooting.html" target="_blank" rel="external">é”™è¯¯å¯èƒ½æœ‰</a>.</p>
<p>ä¸‹é¢çš„å®ä¾‹å®šä¹‰äº†ä¸€ä¸ªselectorå¯ä»¥å†³å®šæ•°ç»„çš„ç¬¬ä¸€ä¸ªtodoé¡¹ç›®æ˜¯ä¸æ˜¯å·²ç»è¢«å®Œæˆ:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> isFirstTodoCompleteSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.todos[<span class="number">0</span>],</div><div class="line">  todo =&gt; todo &amp;&amp; todo.completed</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoCompleteSelector</code><strong>å°†ä¸ä¼š</strong>æ­£å¸¸å·¥ä½œå·¥ä½œ:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// BAD: mutating an existing object</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      todo.completed = !areAllMarked</div><div class="line">      <span class="keyword">return</span> todo</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoComplete</code>ä¸€èµ·<strong>å¯ä»¥</strong>æ­£å¸¸å·¥ä½œ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// GOOD: returning a new object each time with Object.assign</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, todo, &#123;</div><div class="line">      <span class="attr">completed</span>: !areAllMarked</div><div class="line">    &#125;))</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨Redux,ä½†æ˜¯æœ‰ä½¿ç”¨mutableæ•°æ®çš„éœ€æ±‚,ä½ å¯ä»¥ä½¿ç”¨<code>createSelectorCreator</code>ä»£æ›¿é»˜è®¤çš„è®°å¿†å‡½æ•°,å¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç­‰å€¼æ£€æµ‹å‡½æ•°.è¯·å‚çœ‹<a href="#use-memoize-function-from-lodash-for-an-unbounded-cache">è¿™é‡Œ</a> å’Œ <a href="#customize-equalitycheck-for-defaultmemoize">è¿™é‡Œ</a>ä½œä¸ºå‚è€ƒ.</p>
<p>###Q:ä¸ºä»€ä¹ˆinput stateæ²¡æœ‰æ”¹å˜çš„æ—¶å€™,selectorè¿˜æ˜¯ä¼šé‡æ–°è®¡ç®—?</p>
<p>A: æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†å‡½æ•°å’Œä½ ä½ çš„stateæ›´æ–°å‡½æ•°æ˜¯ä¸æ˜¯å…¼å®¹(å¦‚æœæ˜¯ä½¿ç”¨Reduxçš„æ—¶å€™,çœ‹çœ‹reducer).ä¾‹å¦‚:ä½¿ç”¨æ¯ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™,ä¸ç®¡å€¼æ˜¯ä¸æ˜¯å‘ç”Ÿæ”¹å˜,<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯ä¼šæ”¶åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡.<code>createSelector</code>å‡½æ•°ä½¿ç”¨(<code>===</code>)æ£€æµ‹inputçš„å˜åŒ–,ç”±æ­¤å¯çŸ¥å¦‚æœæ¯æ¬¡éƒ½è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,è¡¨ç¤ºselectoræ€»æ˜¯åœ¨æ¯æ¬¡æ›´æ–°çš„æ—¶å€™é‡æ–°è®¡ç®—.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">return</span> state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„selectoråœ¨æ¯ä¸€æ¬¡REMOVE_OLDè°ƒç”¨çš„æ—¶å€™,éƒ½ä¼šé‡æ–°è®¡ç®—,å› ä¸ºArray.filteræ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡.ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,REMOVE_OLD actionéƒ½ä¸ä¼šæ”¹å˜todoåˆ—è¡¨,æ‰€ä»¥é‡æ–°è®¡ç®—æ˜¯ä¸å¿…è¦çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> visibleTodosSelector = createSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä½ å¯ä»¥é€šè¿‡stateæ›´æ–°å‡½æ•°è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—æ“ä½œ,è¿™ä¸ªå¯¹è±¡æ‰§è¡Œæ·±åº¦ç­‰å€¼æ£€æµ‹,åªæœ‰æ·±åº¦ä¸ç›¸åŒçš„æ—¶å€™æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">const</span> updatedState =  state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">return</span> isEqual(updatedState, state) ? state : updatedState</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ›¿ä»£çš„æ–¹æ³•æ˜¯,åœ¨selectorä¸­ä½¿ç”¨æ·±åº¦æ£€æµ‹æ–¹æ³•æ›¿ä»£é»˜è®¤çš„<code>equalityCheck</code>å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ£€æŸ¥<code>equalityCheck</code>å‡½æ•°çš„æ›´æ›¿æˆ–è€…åœ¨stateæ›´æ–°å‡½æ•°ä¸­åšæ·±åº¦æ£€æµ‹å¹¶ä¸æ€»æ˜¯æ¯”é‡è®¡ç®—çš„èŠ±é”€å°.å¦‚æœæ¯æ¬¡é‡è®¡ç®—çš„èŠ±é”€æ€»æ˜¯æ¯”è¾ƒå°,å¯èƒ½çš„åŸå› æ˜¯Reselectæ²¡æœ‰é€šè¿‡<code>connect</code>å‡½æ•°ä¼ é€’<code>mapStateProps</code>å•çº¯å¯¹è±¡çš„åŸå› .</p>
<h3 id="Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"><a href="#Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ" class="headerlink" title="Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"></a>Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ</h3><p>A:å¯ä»¥.Reselectæ²¡æœ‰å…¶ä»–ä»»ä½•çš„ä¾èµ–åŒ…,å› æ­¤å°½ç®¡ä»–è®¾è®¡çš„å’ŒReduxæ¯”è¾ƒæ­é…,ä½†æ˜¯ç‹¬ç«‹ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„.ç›®å‰çš„ç‰ˆæœ¬åœ¨ä¼ ç»Ÿçš„Flux APPä¸‹ä½¿ç”¨æ˜¯æ¯”è¾ƒæˆåŠŸçš„.</p>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectors,éœ€è¦ç¡®ä¿ä»–çš„å‚æ•°æ˜¯immutableçš„.</p>
<p>çœ‹<a href="#createselectorinputselectors--inputselectors-resultfunc">è¿™é‡Œ</a></p>
</blockquote>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector"><a href="#Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector."></a>Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector.</h3><p>A:Reselectæ²¡æœ‰æ”¯æŒåˆ›å»ºæ¥æ”¶å‚æ•°çš„selectors,ä½†æ˜¯è¿™é‡Œæœ‰ä¸€äº›å®ç°ç±»ä¼¼å‡½æ•°åŠŸèƒ½çš„å»ºè®®.</p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯åŠ¨æ€çš„,ä½ å¯ä»¥ä½¿ç”¨å·¥å‚å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> expensiveItemSelectorFactory = <span class="function"><span class="params">minValue</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    shopItemsSelector,</div><div class="line">    items =&gt; items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  expensiveItemSelectorFactory(<span class="number">200</span>),</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ€»çš„è¾¾æˆå…±è¯†<a href="https://github.com/reactjs/reselect/issues/38" target="_blank" rel="external">çœ‹è¿™é‡Œ</a>å’Œ<a href="https://github.com/optimizely/nuclear-js/issues/14" target="_blank" rel="external">è¶…è¶Š neclear-js</a>æ˜¯:å¦‚æœä¸€ä¸ªselectoréœ€è¦åŠ¨æ€çš„å‚æ•°,é‚£ä¹ˆå‚æ•°åº”è¯¥æ˜¯storeä¸­çš„state.å¦‚æœä½ å†³å®šå¥½äº†åœ¨åº”ç”¨ä¸­ä½¿ç”¨åŠ¨æ€å‚æ•°,åƒä¸‹é¢è¿™æ ·è¿”å›ä¸€ä¸ªè®°å¿†å‡½æ•°æ˜¯æ¯”è¾ƒåˆé€‚çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.items,</div><div class="line">  items =&gt; memoize(</div><div class="line">    <span class="function"><span class="params">minValue</span> =&gt;</span> items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveFilter = expensiveSelector(state)</div><div class="line"></div><div class="line"><span class="keyword">const</span> slightlyExpensive = expensiveFilter(<span class="number">100</span>)</div><div class="line"><span class="keyword">const</span> veryExpensive = expensiveFilter(<span class="number">1000000</span>)</div></pre></td></tr></table></figure>
<hr>
<h3 id="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"><a href="#Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ" class="headerlink" title="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"></a>Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ</h3><p>A: æˆ‘è®¤ä¸ºè¿™ä¸ªè®°å¿†éŸ©å¼å·¥ä½œçš„è¿˜å¯ä»¥,ä½†æ˜¯å¦‚æœä½ éœ€è¦ä¸€ä¸ªå…¶ä»–çš„éŸ©å¼ä¹Ÿæ˜¯å¯ä»¥çš„.<br>å¯ä»¥çœ‹çœ‹è¿™ä¸ª<a href="#customize-equalitycheck-for-defaultmemoize">ä¾‹å­</a></p>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector"><a href="#Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?"></a>Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?</h3><p>A:å¯¹äºä¸€ä¸ªç»™å®šçš„input,ä¸€ä¸ªselectoræ€»æ˜¯äº§å‡ºç›¸åŒçš„ç»“æœ.åŸºäºè¿™ä¸ªåŸå› ,åšå•å…ƒæµ‹è¯•æ˜¯éå¸¸ç®€å•çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> selector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; (&#123;</div><div class="line">    <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">    <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">  &#125;)</div><div class="line">)</div><div class="line"></div><div class="line">test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">6</span> &#125;)</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">3</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨stateæ›´æ–°å‡½æ•°è°ƒç”¨çš„æ—¶å€™åŒæ—¶æ£€æµ‹selectorçš„è®°å¿†å‡½æ•°çš„åŠŸèƒ½ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„(ä¾‹å¦‚ ä½¿ç”¨Reduxçš„æ—¶å€™æ£€æŸ¥reducer).æ¯ä¸€ä¸ªselectoréƒ½æœ‰ä¸€ä¸ª<code>recomputations</code>æ–¹æ³•è¿”å›é‡æ–°è®¡ç®—çš„æ¬¡æ•°:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">suite(<span class="string">'selector'</span>, () =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> state = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> (</div><div class="line">    &#123;</div><div class="line">      <span class="attr">a</span>: action(state.a),</div><div class="line">      <span class="attr">b</span>: action(state.b)</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> selector = createSelector(</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">    state =&gt; state.b,</div><div class="line">    (a, b) =&gt; (&#123;</div><div class="line">      <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">      <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> plusOne = <span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span></div><div class="line">  <span class="keyword">const</span> id = <span class="function"><span class="params">x</span> =&gt;</span> x</div><div class="line"></div><div class="line">  test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    state = reducer(state, id)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">1</span>)</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">6</span>, <span class="attr">d</span>: <span class="number">12</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">2</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<hr>
<p>å¦å¤–,selectorsä¿ç•™äº†æœ€åä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æœçš„å¼•ç”¨,è¿™ä¸ªå¼•ç”¨ä½œä¸º<code>.resultFunc</code>.å¦‚æœä½ å·²ç»èšåˆäº†å…¶ä»–çš„selectors,è¿™ä¸ªå‡½æ•°å¼•ç”¨å¯ä»¥å¸®åŠ©ä½ æµ‹è¯•æ¯ä¸€ä¸ªselector,ä¸éœ€è¦ä»stateä¸­è§£è€¦æµ‹è¯•.</p>
<p>ä¾‹å¦‚å¦‚æœä½ çš„selectorsé›†åˆåƒä¸‹é¢è¿™æ ·:<br><strong>selectors.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> firstSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> secondSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> thirdSelector = createSelector( ... )</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> myComposedSelector = createSelector(</div><div class="line">  firstSelector,</div><div class="line">  secondSelector,</div><div class="line">  thirdSelector,</div><div class="line">  (first, second, third) =&gt; first * second &lt; third</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>å•å…ƒæµ‹è¯•å°±åƒä¸‹é¢è¿™æ ·:<br><strong>test/selectors.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests for the first three selectors...</span></div><div class="line">test(<span class="string">"firstSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"secondSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"thirdSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line"></div><div class="line"><span class="comment">// We have already tested the previous</span></div><div class="line"><span class="comment">// three selector outputs so we can just call `.resultFunc`</span></div><div class="line"><span class="comment">// with the values we want to test directly:</span></div><div class="line">test(<span class="string">"myComposedSelector unit test"</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// here instead of calling selector()</span></div><div class="line">  <span class="comment">// we just call selector.resultFunc()</span></div><div class="line">  assert(selector.resultFunc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="literal">true</span>)</div><div class="line">  assert(selector.resultFunc(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>), <span class="literal">false</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>æœ€å,æ¯ä¸€ä¸ªselectoræœ‰ä¸€ä¸ª<code>resetRecomputations</code>æ–¹æ³•,é‡ç½®recomputationsæ–¹æ³•ä¸º0,è¿™ä¸ªå‚æ•°çš„æ„å›¾æ˜¯åœ¨é¢å¯¹å¤æ‚çš„selectorçš„æ—¶å€™,éœ€è¦å¾ˆå¤šç‹¬ç«‹çš„æµ‹è¯•,ä½ ä¸éœ€è¦ç®¡ç†å¤æ‚çš„æ‰‹å·¥è®¡ç®—,æˆ–è€…ä¸ºæ¯ä¸€ä¸ªæµ‹è¯•åˆ›å»ºâ€å‚»ç“œâ€selector.</p>
<h3 id="Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨"><a href="#Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨" class="headerlink" title="Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?"></a>Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?</h3><p>A:<code>creatSelector</code>åˆ›å»ºçš„Selectorsåº”è¯¥å¯ä»¥å’ŒImmutable.jsæ•°æ®ç»“æ„ä¸€èµ·å®Œç¾çš„å·¥ä½œ.<br>å¦‚æœä½ çš„selectoræ­£åœ¨é‡è®¡ç®—,å¹¶ä¸”ä½ è®¤ä¸ºstateæ²¡æœ‰å‘ç”Ÿå˜åŒ–,ä¸€å®šè¦ç¡®ä¿çŸ¥é“å“ªä¸€ä¸ªImmutable.jsæ›´æ–°æ–¹æ³•,è¿™ä¸ªæ–¹æ³•åªè¦ä¸€æ›´æ–°<strong>æ€»æ˜¯</strong>è¿”å›æ–°å¯¹è±¡.å“ªä¸€ä¸ªæ–¹æ³•åªæœ‰<strong>é›†åˆå®é™…å‘ç”Ÿå˜åŒ–çš„æ—¶å€™</strong>æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Immutable <span class="keyword">from</span> <span class="string">'immutable'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = Immutable.Map(&#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"> <span class="comment">// set, merge and others only return a new obj when update changes collection</span></div><div class="line"><span class="keyword">let</span> newMap = myMap.set(<span class="string">'a'</span>, <span class="number">1</span>)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line">newMap = myMap.merge(&#123; <span class="string">'a'</span>, <span class="number">1</span> &#125;)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line"><span class="comment">// map, reduce, filter and others always return a new obj</span></div><div class="line">newMap = myMap.map(<span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">1</span>)</div><div class="line">assert.notEqual(myMap, newMap)</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä¸€ä¸ªæ“ä½œå¯¼è‡´çš„selectoræ›´æ–°æ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,å¯èƒ½ä¼šå‘ç”Ÿä¸å¿…è¦çš„é‡è®¡ç®—.<a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">çœ‹è¿™é‡Œ</a>.è¿™æ˜¯ä¸€ä¸ªå…³äºprosçš„è®¨è®º,ä½¿ç”¨æ·±å…¨ç­‰äºæ¥æ£€æµ‹ä¾‹å¦‚<code>immutable.js</code>æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—è¿‡ç¨‹.</p>
<h3 id="Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"><a href="#Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ" class="headerlink" title="Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"></a>Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ</h3><p>A: ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„Selectorçš„ç¼“å­˜çš„å¤§å°åªæœ‰1.è¿™ä¸ªè®¾å®šä½¿å¾—å¤šä¸ªç»„ä»¶çš„å®ä¾‹ä¹‹é—´çš„å‚æ•°ä¸åŒ,è·¨ç»„ä»¶å…±äº«selectorå˜å¾—ä¸åˆé€‚.è¿™é‡Œä¹Ÿæœ‰å‡ ç§åŠæ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜:</p>
<ul>
<li>ä½¿ç”¨å·¥ç¨‹å‡½æ•°æ–¹æ³•,ä¸ºæ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹åˆ›å»ºä¸€ä¸ªæ–°çš„selector.è¿™é‡Œæœ‰ä¸€ä¸ªå†…å»ºçš„å·¥å‚æ–¹æ³•,React Redux v4.3æˆ–è€…æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨. <a href="#sharing-selectors-with-props-across-multiple-components">çœ‹è¿™é‡Œ</a></li>
<li>åˆ›å»ºä¸€ä¸ªç¼“å­˜å°ºå¯¸å¤§äº1çš„å®šåˆ¶selector.</li>
</ul>
<h3 id="Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"><a href="#Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ" class="headerlink" title="Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"></a>Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ</h3><p>A: æ˜¯çš„ï¼ä»–ä»¬åŒ…å«åœ¨<code>package.json</code>é‡Œ.å¯ä»¥å¾ˆå¥½çš„å·¥ä½œ.</p>
<h3 id="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector"><a href="#Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector" class="headerlink" title="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector?"></a>Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ª<a href="https://github.com/hemanth/functional-programming-jargon#currying" target="_blank" rel="external">æŸ¯é‡ŒåŒ–</a>selector?</h3><p>Aï¼šå°è¯•ä¸€äº›è¿™é‡Œ<a href="https://github.com/reactjs/reselect/issues/159#issuecomment-238724788" target="_blank" rel="external">åŠ©æ‰‹å‡½æ•°</a>,ç”±<a href="https://github.com/MattSPalmer" target="_blank" rel="external">MattSPalmer</a>æä¾›</p>
<h2 id="æœ‰å…³çš„é¡¹ç›®"><a href="#æœ‰å…³çš„é¡¹ç›®" class="headerlink" title="æœ‰å…³çš„é¡¹ç›®"></a>æœ‰å…³çš„é¡¹ç›®</h2><h3 id="reselect-map"><a href="#reselect-map" class="headerlink" title="reselect-map"></a><a href="https://github.com/HeyImAlex/reselect-map" target="_blank" rel="external">reselect-map</a></h3><p>å› ä¸ºReselectä¸å¯èƒ½ä¿è¯ç¼“å­˜ä½ æ‰€æœ‰çš„éœ€æ±‚,åœ¨åš<strong>éå¸¸æ˜‚è´µçš„è®¡ç®—</strong>çš„æ—¶å€™,è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæœ‰ç”¨.æŸ¥çœ‹ä¸€ä¸‹reselect-maps readme</p>
<p><strong>reselect-mapçš„ä¼˜åŒ–æªæ–½ä»…ä»…ä½¿ç”¨åœ¨ä¸€äº›å°çš„æ¡ˆä¾‹ä¸­,å¦‚æœä½ ä¸ç¡®å®šæ˜¯ä¸æ˜¯éœ€è¦ä»–,å°±ä¸è¦ä½¿ç”¨å®ƒ</strong>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ¬æ–‡æ˜¯ç¿»è¯‘Reduxçš„ä¸€ä¸ªä¸­é—´ä»¶æ–‡æ¡£.Reduxæ˜¯Reactçš„ä¸€ä¸ªæ•°æ®å±‚,Reactç»„ä»¶çš„stateæœ‰å…³é€»è¾‘å¤„ç†éƒ½è¢«å•ç‹¬æ”¾åˆ°Reduxä¸­æ¥è¿›è¡Œ,åœ¨stateçš„æ“ä½œæµç¨‹ä¸­è¡ç”Ÿäº†å¾ˆå¤šä¸­é—´ä»¶,Reselectè¿™ä¸ªä¸­é—´ä»¶è¦è§£å†³çš„é—®é¢˜æ˜¯:`åœ¨
    
    </summary>
    
      <category term="ç¿»è¯‘" scheme="http://yoursite.com/categories/%E7%BF%BB%E8%AF%91/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptè®¾è®¡åŸåˆ™-å•ä¸€èŒè´£</title>
    <link href="http://yoursite.com/2017/03/09/javascript%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3/"/>
    <id>http://yoursite.com/2017/03/09/javascriptè®¾è®¡åŸåˆ™-å•ä¸€èŒè´£/</id>
    <published>2017-03-08T20:04:10.000Z</published>
    <updated>2017-03-23T12:14:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰é¢æŠŠjavascriptçš„è®¾è®¡æ¨¡å¼åŸºæœ¬è¿‡äº†ä¸€éï¼Œå¯ä»¥è¯´æ˜¯æ„Ÿæ…¨å¾ˆå¤šï¼Œè®¸å¤šçš„æ€æƒ³éƒ½æ˜¯ä»æœªæ¥è§¦è¿‡çš„ï¼Œå­¦èµ·æ¥éš¾åº¦ä¹Ÿä¸å°ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆå€¼å¾—çš„ã€‚å¦‚æœä»¥å‰æ˜¯åœ¨è¶³çƒåœºä¸Šè¸¢é‡çƒçš„è¯ï¼Œç°åœ¨æ€»ç®—æ‰¾åˆ°ä¸€ä¸ªåƒæ¨¡åƒæ ·çš„æ•™ç»ƒåœ¨æŒ‡å¯¼äº†ï¼Œä¸ä¸€å®šä¼šæˆä¸ºä¸€ä¸ªä¸–ç•Œçº§çš„çƒæ˜Ÿï¼Œä½†æ˜¯æ°´å¹³è‡³å°‘ä¹Ÿä¼šæ¯”ä»¥å‰æé«˜å¾ˆå¤šã€‚<br>æ¥ä¸‹æ¥ä¼šçœ‹çœ‹ä¸€äº›è®¾è®¡åŸåˆ™ï¼Œè®¾è®¡åŸåˆ™æ˜¯æ¯”æ¨¡å¼æ›´é«˜ä¸€çº§çš„æ–¹æ³•ï¼Œæ˜¯çº²é¢†æ€§çš„å†…å®¹ã€‚</p>
<blockquote>
<p>å•ä¸€èŒè´£(single responsable princple)è¢«å®šä¸ºä¸ºâ€œå¼•èµ·å˜åŒ–çš„åŸå› â€ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æ‰¿æ‹…äº†è¿‡å¤šçš„èŒè´£ï¼Œé‚£ä¹ˆåœ¨éœ€æ±‚å‘ç”Ÿå˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ”¹å†™è¿™ä¸ªæ–¹æ³•çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚<br>å› æ­¤SRPåŸåˆ™ä½“ç°ä¸ºï¼šä¸€ä¸ªå¯¹è±¡(æ–¹æ³•)åªåšä¸€ä»¶äº‹æƒ…ã€‚<br>å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬18ç« </p>
</blockquote>
<p>#####è®¾è®¡æ¨¡å¼ä¸­çš„SRPåŸåˆ™</p>
<p>ä»£ç†æ¨¡å¼<br>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯è¦åœ¨æ–‡æ¡£ä¸­åˆ›å»ºä¸€ä¸ªimgæ ‡ç­¾ï¼Œå¹¶ä¸”è¦æ’å…¥å›¾ç‰‡<br>åœ¨åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œç”±äºç½‘é€Ÿçš„é™åˆ¶éœ€è¦é¢„å…ˆåŠ è½½ä¸€å¼ æœ¬åœ°å›¾ç‰‡ï¼Œç¨åä¼šåŠ è½½ç½‘ç»œå›¾ç‰‡ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­<code>åˆ›å»ºimgæ ‡ç­¾</code>å’Œ<code>æ›´æ¢å›¾ç‰‡æº</code>æ˜¯<code>æ²¡æœ‰å…³ç³»</code>çš„ã€‚æ‰€ä»¥æœ€å¥½æ˜¯æŠŠè¿™ä¸¤ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªå¯¹è±¡æ¥å¤„ç†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºimgæ ‡ç­¾çš„å¯¹è±¡</span></div><div class="line"><span class="keyword">var</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement( <span class="string">'img'</span> );</div><div class="line">		<span class="built_in">document</span>.body.appendChild( imgNode );</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> src </span>)</span>&#123;</div><div class="line"></div><div class="line">				imgNode.src = src;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">  <span class="comment">//æ·»åŠ å›¾ç‰‡è·¯å¾„çš„å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> img = <span class="keyword">new</span> Image; <span class="comment">//å®ä¾‹åŒ–æ ‡ç­¾å¯¹è±¡</span></div><div class="line">		img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			myImage.setSrc( <span class="keyword">this</span>.src ); <span class="comment">//åŠ è½½é»˜è®¤å›¾ç‰‡</span></div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> src </span>)</span>&#123;</div><div class="line">				myImage.setSrc( <span class="string">'file:// /C:/Users/svenzeng/Desktop/loading.gif'</span> );</div><div class="line">				img.src = src;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">	<span class="comment">//æ›´æ”¹å›¾ç‰‡çš„è·¯å¾„ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å’Œimgæ ‡ç­¾çš„åˆ›å»ºå¯¹è±¡æ²¡æœ‰å…³ç³»äº†ã€‚</span></div><div class="line">	proxyImage.setSrc( <span class="string">'http:// imgcache.qq.com/music/photo/000GGDys0yA0Nk.jpg'</span> );</div></pre></td></tr></table></figure></p>
<p>è¿­ä»£å™¨æ¨¡å¼<br>çœ‹ä¸‹é¢æ®µä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿™æ®µä»£ç å¾€æ–‡æ¡£ä¸­æ·»åŠ divå…ƒç´ ï¼Œä½†æ˜¯æœ‰é™åˆ¶ï¼Œè¿™é‡Œå°±åªèƒ½æ·»åŠ æ•°ç»„</span></div><div class="line"><span class="comment">//æœ‰ä¸¤ä¸ªèŒè´£ä¸€ä¸ªæ˜¯æ·»åŠ å…ƒç´ ï¼Œä¸€ä¸ªæ˜¯éå†æ•°æ®ï¼Œæ‰€æœ‰æœ‰å¿…è¦åˆ†å¼€</span></div><div class="line"> <span class="keyword">var</span> appendDiv=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;l=data.length;i&lt;l;i++)&#123;</div><div class="line">   <span class="keyword">var</span> div=<span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">   div.innerHTML=data[i];</div><div class="line">   <span class="built_in">document</span>.body.appendChild(div);</div><div class="line">  &#125;</div><div class="line"> &#125;;</div><div class="line"> </div><div class="line"> appenDiv([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨å•ä¸€èŒè´£åŸåˆ™æ”¹å˜ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> each = <span class="function"><span class="keyword">function</span>(<span class="params"> obj, callback </span>) </span>&#123;<span class="comment">//éå†çš„æ–¹æ³•</span></div><div class="line"><span class="comment">//å¯¹è±¡å’Œæ•°ç»„éƒ½å¯ä»¥è¾“å…¥ï¼Œçµæ´»æ€§åŠ å¤§ï¼Œå¹¶ä¸”è¿˜å¯ä»¥ä¿®æ”¹</span></div><div class="line">		<span class="keyword">var</span> value,</div><div class="line">		i = <span class="number">0</span>,</div><div class="line">		length = obj.length,</div><div class="line">		isArray = isArraylike( obj ); <span class="comment">// isArraylike å‡½æ•°æœªå®ç°ï¼Œå¯ä»¥ç¿»é˜…jQuery æºä»£ç </span></div><div class="line">		<span class="keyword">if</span> ( isArray ) &#123; <span class="comment">// è¿­ä»£ç±»æ•°ç»„</span></div><div class="line">			<span class="keyword">for</span> ( ; i &lt; length; i++ ) &#123;</div><div class="line">				callback.call( obj[ i ], i, obj[ i ] );</div><div class="line">			&#125;</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">for</span> ( i <span class="keyword">in</span> obj ) &#123; <span class="comment">// è¿­ä»£object å¯¹è±¡</span></div><div class="line">				value = callback.call( obj[ i ], i, obj[ i ] );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> obj;</div><div class="line">	&#125;;</div><div class="line"> <span class="comment">//æ ¹æ®è¾“å…¥æ•°æ®çš„å…ƒç´ æ·»åŠ æ–¹æ³•</span></div><div class="line">	<span class="keyword">var</span> appendDiv = <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>)</span>&#123;</div><div class="line">		each( data, <span class="function"><span class="keyword">function</span>(<span class="params"> i, n </span>)</span>&#123; <span class="comment">//ä½¿ç”¨eachæ–¹æ³•æ¥æ‰§è¡Œéå†</span></div><div class="line">		<span class="comment">//åœ¨å›è°ƒå‡½æ•°ä¸­æ ¹æ®éå†æ•°æ®æ·»åŠ å…ƒç´ è‡³æ–‡æ¡£ä¸­</span></div><div class="line">			<span class="keyword">var</span> div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">			div.innerHTML = n;</div><div class="line">			<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">		&#125;);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	appendDiv( [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span> ] );<span class="comment">//æ•°ç»„æ•°æ®</span></div><div class="line">	appendDiv(&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>,<span class="attr">d</span>:<span class="number">4</span>&#125; ); <span class="comment">//å¯¹è±¡æ•°æ®</span></div></pre></td></tr></table></figure></p>
<p>å•ä¾‹æ¨¡å¼</p>
<p>åœ¨å‰é¢å·²ç»æœ‰ç¬”è®°äº†ã€‚å®é™…æ˜¯æŠŠå®é™…æ“ä½œå’Œåˆ›å»ºå•ä¾‹çš„æ–¹æ³•åˆ†åˆ«å°è£…åœ¨ä¸¤ä¸ªæ–¹æ³•é‡Œã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> createLoginLayer = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//åˆ›å»ºå…ƒç´ çš„æ–¹æ³•</span></div><div class="line">		<span class="keyword">var</span> div;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">if</span> ( !div )&#123;</div><div class="line">				div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">				div.innerHTML = <span class="string">'æˆ‘æ˜¯ç™»å½•æµ®çª—'</span>;</div><div class="line">				div.style.display = <span class="string">'none'</span>;</div><div class="line">				<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> div; <span class="comment">//å•ä¾‹çš„åˆ¤æ–­ä¾æ®</span></div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">  </div><div class="line">        <span class="comment">//åˆ›å»ºå’Œæ£€æµ‹å•ä¾‹çš„æ–¹æ³•ï¼Œå‚æ•°ä¸ºåˆ›å»ºå…ƒç´ çš„æ–¹æ³•</span></div><div class="line">	<span class="keyword">var</span> getSingle = <span class="function"><span class="keyword">function</span>(<span class="params"> fn </span>)</span>&#123; <span class="comment">// è·å–å•ä¾‹</span></div><div class="line">		<span class="keyword">var</span> result;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> result || ( result = fn .apply(<span class="keyword">this</span>, <span class="built_in">arguments</span> ) ); </div><div class="line">                        <span class="comment">//è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„applyå’Œargumentsçš„åº”ç”¨</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> createLoginLayer = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// åˆ›å»ºç™»å½•æµ®çª—</span></div><div class="line">		<span class="keyword">var</span> div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">		div.innerHTML = <span class="string">'æˆ‘æ˜¯ç™»å½•æµ®çª—'</span>;</div><div class="line">		<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">		<span class="keyword">return</span> div;</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="keyword">var</span> createSingleLoginLayer = getSingle( createLoginLayer );</div><div class="line">	<span class="keyword">var</span> loginLayer1 = createSingleLoginLayer();</div><div class="line">	<span class="keyword">var</span> loginLayer2 = createSingleLoginLayer();</div><div class="line">	alert ( loginLayer1 === loginLayer2 ); <span class="comment">// è¾“å‡ºï¼š true  //ä¸ºåŒä¸€å¯¹è±¡</span></div></pre></td></tr></table></figure></p>
<p>è£…é¥°è€…æ¨¡å¼<br>å‰é¢çš„è®¾è®¡æ¨¡å¼é‡Œä¹Ÿæœ‰ä»‹ç»<br>è£…é¥°è€…æ¨¡å¼å¯ä»¥åŠ¨æ€ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³•æˆ–æŒ‡è´£ã€‚ä»è€Œä¹Ÿä½¿çš„å¯¹è±¡çš„åŠŸèƒ½å•ä¸€åŒ–ã€‚<br>ä¸‹é¢ä¸¤ä¸ªå‡½æ•°è°ƒç”¨çš„æ—¶å€™æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			 <span class="comment">//æ‰§è¡ŒåŸå‡½æ•°</span></div><div class="line">			afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );<span class="comment">//æ‰§è¡Œafterå‡½æ•°</span></div><div class="line">			<span class="keyword">return</span> ret;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> showLogin = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç™»å½•æµ®å±‚'</span> );</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ä¸ŠæŠ¥æ ‡ç­¾ä¸º: '</span> + <span class="keyword">this</span>.getAttribute( <span class="string">'tag'</span> ) );</div><div class="line"></div><div class="line">	&#125;;</div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = showLogin.after( log );</div><div class="line"><span class="comment">// æ‰“å¼€ç™»å½•æµ®å±‚ä¹‹åä¸ŠæŠ¥æ•°æ®</span></div></pre></td></tr></table></figure></p>
<p>#####å•ä¸€èŒè´£åŸåˆ™å‡ä½äº†å•ä¸ªç±»æˆ–è€…å¯¹è±¡çš„å¤æ‚åº¦ï¼ŒæŒ‰ç…§æŒ‡è´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ã€‚æœ‰åŠ©äºä»£ç çš„å¤ç”¨ï¼Œä¿®æ”¹å’Œæµ‹è¯•ã€‚ä½†æ˜¯ä»£ç å¤æ‚åº¦æ˜¯æé«˜äº†ã€‚æ€ä¹ˆå¹³è¡¡å‘¢ï¼Ÿè¿™æ˜¯ä¸ªé—®é¢˜ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰é¢æŠŠjavascriptçš„è®¾è®¡æ¨¡å¼åŸºæœ¬è¿‡äº†ä¸€éï¼Œå¯ä»¥è¯´æ˜¯æ„Ÿæ…¨å¾ˆå¤šï¼Œè®¸å¤šçš„æ€æƒ³éƒ½æ˜¯ä»æœªæ¥è§¦è¿‡çš„ï¼Œå­¦èµ·æ¥éš¾åº¦ä¹Ÿä¸å°ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆå€¼å¾—çš„ã€‚å¦‚æœä»¥å‰æ˜¯åœ¨è¶³çƒåœºä¸Šè¸¢é‡çƒçš„è¯ï¼Œç°åœ¨æ€»ç®—æ‰¾åˆ°ä¸€ä¸ªåƒæ¨¡åƒæ ·çš„æ•™ç»ƒåœ¨æŒ‡å¯¼äº†ï¼Œä¸ä¸€å®šä¼šæˆä¸ºä¸€ä¸ªä¸–ç•Œçº§çš„çƒæ˜Ÿï¼Œä½†æ˜¯æ°´å¹³è‡³å°‘ä¹Ÿä¼šæ¯”ä»¥å‰æé«˜å¾ˆ
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptæœ€å°‘çŸ¥è¯†åŸåˆ™</title>
    <link href="http://yoursite.com/2017/03/09/javascript%E6%9C%80%E5%B0%91%E7%9F%A5%E8%AF%86%E5%8E%9F%E5%88%99/"/>
    <id>http://yoursite.com/2017/03/09/javascriptæœ€å°‘çŸ¥è¯†åŸåˆ™/</id>
    <published>2017-03-08T19:04:10.000Z</published>
    <updated>2017-03-23T12:19:51.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ€å°‘çŸ¥è¯†åŸåˆ™è¯´çš„æ˜¯ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½çš„ä¸å…¶ä»–å®ä½“å‡å°‘ç›¸äº’ä½œç”¨ã€‚<br>è¿™é‡Œçš„è½¯ä»¶å®ä½“æ˜¯ä¸€ä¸ªå¹¿ä¹‰æ¦‚å¿µï¼Œä¸ä»…åŒ…æ‹¬å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿï¼Œç±»ï¼Œæ¨¡å—ï¼Œå‡½æ•°ï¼Œå˜é‡ç¯ã€‚è¿™æ ·æ¥è¯´æœ€å°‘çŸ¥è¯†åŸåˆ™æ¶µç›–çš„èŒƒå›´å°±å¾ˆå¤§äº†ã€‚ä¸‹é¢çœ‹çœ‹å’Œjavascriptç›¸å…³çš„å†…å®¹<br>å‚è€ƒã€Šjavascirptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬19ç« </p>
</blockquote>
<ol>
<li><p>å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»<br>æœ€å°‘çŸ¥è¯†åŸåˆ™æŒ‡å¯¼æˆ‘ä»¬ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¸å¿…å½¼æ­¤é€šè®¯ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å°±ä¸è¦å‘ç”Ÿç›´æ¥è”ç³»ã€‚å¸¸è§çš„åšæ³•æ˜¯å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰è€…æ¥æ‰¿æ‹…å½¼æ­¤çš„é€šä¿¡ä»»åŠ¡ã€‚</p>
</li>
<li><p>javascriptè®¾è®¡æ¨¡å¼ä¸­çš„æœ€å°‘çŸ¥è¯†åŸåˆ™</p>
</li>
</ol>
<p><strong>ä¸­ä»‹è€…æ¨¡å¼</strong><br>è¿™ä¸ªæ¨¡å¼æ˜¯ä½¿ç”¨è€…ä»¬æ˜¯ä¸å‘ç”Ÿä»»ä½•è”ç³»çš„ï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯ç”±ä¸­ä»‹è€…æ¥å®Œæˆã€‚<br>reacté€šè¿‡å¼•å…¥reduxåº”è¯¥å°±æ˜¯è¿™ç§æ¨¡å¼ã€‚reactç»„ä»¶ä¹‹é—´ä¸å†å‘ç”Ÿä»»ä½•çš„è”ç³»ï¼Œæ‰€æœ‰ä¸ç»„ä»¶stateå˜åŒ–çš„é€šè®¯è¯·æ±‚éƒ½æ˜¯é€šè¿‡reduxæ¥å®Œæˆçš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œç»„ä»¶å¯ä»¥åº”å¯¹å¤æ‚çš„stateå˜åŒ–ã€‚</p>
<p><strong>å¤–è§‚æ¨¡å¼</strong><br>è¿™æ˜¯é’ˆå¯¹ä½¿ç”¨è€…è€Œè¨€çš„ã€‚å¤–è§‚æ¨¡å¼ä½œç”¨æ˜¯å¯¹äº¤äº’ä½¿ç”¨è€…éšè—å­ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</p>
<ul>
<li>[ ] å¤–è§‚æ¨¡å¼ä¸ºä¸€ç»„ç³»ç»Ÿæä¾›ä¸€ä¸ªä¾¿åˆ©çš„å…¥å£ã€‚åœ¨jqueryä¸­å…¼å®¹äº†æµè§ˆå™¨çš„å·®å¼‚ï¼Œä½†æ˜¯ä½¿ç”¨è€…ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªapiæ¥å£ï¼Œå°±æ˜¯ä¸€ä¸ªä½“ç°</li>
<li>[ ] éš”ç¦»ä½¿ç”¨è€…å’Œå¤æ‚ç³»ç»Ÿçš„è”ç³»ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å»äº†è§£å…·ä½“çš„å·®å¼‚</li>
</ul>
<p>javascriptçš„å‡½æ•°å°è£…</p>
<p>javascriptå‡½æ•°æœ‰ç€è‡³é«˜æ— ä¸Šçš„æƒåˆ©ï¼Œçµæ´»æ€§å¾ˆå¤§ã€‚é€šè¿‡ä½¿ç”¨é—­åŒ…éšè—å˜é‡ï¼Œé€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæ­ç¤ºæ¨¡å¼ï¼Œç­–ç•¥æ¨¡å¼.javascriptä½¿ç”¨å‡½æ•°å’Œå¯¹è±¡å­—é¢é‡çš„æ–¹æ³•éšè—å…·ä½“çš„å®ç°é€»è¾‘ã€‚åªæš´éœ²ç›¸å…³çš„æ–¹æ³•ã€‚</p>
<p>è¿™å°±æ˜¯æœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚è¿™ä¹Ÿæ˜¯åŸºç¡€åŸåˆ™åœ¨javascriptç¨‹åºè®¾è®¡ä¸­åº”è¯¥æ˜¯æ—¶åˆ»éƒ½è¦ä½“ç°è¿™ç§åŸåˆ™ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ€å°‘çŸ¥è¯†åŸåˆ™è¯´çš„æ˜¯ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½çš„ä¸å…¶ä»–å®ä½“å‡å°‘ç›¸äº’ä½œç”¨ã€‚&lt;br&gt;è¿™é‡Œçš„è½¯ä»¶å®ä½“æ˜¯ä¸€ä¸ªå¹¿ä¹‰æ¦‚å¿µï¼Œä¸ä»…åŒ…æ‹¬å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿï¼Œç±»ï¼Œæ¨¡å—ï¼Œå‡½æ•°ï¼Œå˜é‡ç¯ã€‚è¿™æ ·æ¥è¯´æœ€å°‘çŸ¥è¯†åŸåˆ™æ¶µç›–çš„èŒƒå›´å°±å¾ˆå¤§äº†ã€‚ä¸‹é¢çœ‹çœ‹å’Œjavascriptç›¸å…³çš„å†…å®¹&lt;br&gt;å‚è€ƒã€Š
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼</title>
    <link href="http://yoursite.com/2017/03/08/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/03/08/javascriptè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼/</id>
    <published>2017-03-08T11:04:10.000Z</published>
    <updated>2017-03-23T12:28:50.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å•ä¾‹æ¨¡å¼çš„å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®ä»–çš„å…¨å±€è®¿é—®ç‚¹<br>å‚è€ƒä¹¦ç±ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹<br>æœ‰ä¸€äº›å¯¹è±¡æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªï¼Œä¾‹å¦‚çº¿ç¨‹æ± ï¼Œå…¨å±€ç¼“å­˜ç­‰ã€‚</p>
</blockquote>
<ol>
<li>å®ä¾‹å•ä¾‹æ¨¡å¼</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Singleton = <span class="function"><span class="keyword">function</span>(<span class="params"> name </span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		<span class="keyword">this</span>.instance = <span class="literal">null</span>;</div><div class="line">	&#125;;</div><div class="line">	Singleton.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		alert ( <span class="keyword">this</span>.name );</div><div class="line">	&#125;;</div><div class="line">	Singleton.getInstance = <span class="function"><span class="keyword">function</span>(<span class="params"> name </span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span> ( !<span class="keyword">this</span>.instance )&#123;  <span class="comment">//å¯¹å®ä¾‹è¿›è¡Œæ£€æµ‹</span></div><div class="line">			<span class="keyword">this</span>.instance = <span class="keyword">new</span> Singleton( name ); <span class="comment">//å…¨å±€ç¼“å­˜new å¯¹è±¡</span></div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.instance;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> a = Singleton.getInstance( <span class="string">'sven1'</span> );  <span class="comment">//ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ï¼Œæ£€æµ‹æ²¡æœ‰å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œè‡ªå·±å®ä¾‹åŒ–ä¸€ä¸ªï¼Œç„¶åç¼“å­˜</span></div><div class="line">	<span class="keyword">var</span> b = Singleton.getInstance( <span class="string">'sven2'</span> );<span class="comment">//ç¬¬äºŒæ¬¡å®ä¾‹åŒ–ï¼Œæ£€æµ‹å·²ç»æœ‰å…¨å±€çš„å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œç›´æ¥è¿”å›ï¼Œä¸è¿›è¡Œå…·ä½“å®ä¾‹åŒ–</span></div><div class="line">	alert ( a === b ); <span class="comment">// true    //ç»Ÿä¸€å®ä¾‹å¯¹è±¡</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å•ä¾‹æ¨¡å¼çš„å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®ä»–çš„å…¨å±€è®¿é—®ç‚¹&lt;br&gt;å‚è€ƒä¹¦ç±ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹&lt;br&gt;æœ‰ä¸€äº›å¯¹è±¡æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªï¼Œä¾‹å¦‚çº¿ç¨‹æ± ï¼Œå…¨å±€ç¼“å­˜ç­‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å®ä¾‹å•ä¾‹
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>javascriptæ¡¥æ¥æ¨¡å¼(1)-é˜Ÿåˆ—æ•°æ®ç»“æ„</title>
    <link href="http://yoursite.com/2017/03/08/javascript%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F(1)-%E9%98%9F%E5%88%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    <id>http://yoursite.com/2017/03/08/javascriptæ¡¥æ¥æ¨¡å¼(1)-é˜Ÿåˆ—æ•°æ®ç»“æ„/</id>
    <published>2017-03-08T11:04:10.000Z</published>
    <updated>2017-03-23T12:11:27.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ ¹æ®ä¹¦ä¸Šä¾‹å­çš„å®é™…è¦æ±‚ï¼Œæ¶‰åŠåˆ°jsé˜Ÿåˆ—çš„é—®é¢˜ã€‚æ‰€ä»¥å…ˆæŠŠjsä¸­é˜Ÿåˆ—çš„å…·ä½“å®ç°æ•°æ®ç»“æ„è´´å‡ºæ¥ã€‚å…·ä½“å‚è€ƒã€Šå­¦ä¹ javascriptæ•°æ®ç»“æ„å’Œç®—æ³•ã€‹ç¬¬å››ç« ã€‚<br>é˜Ÿåˆ—æ•°æ®ç»“æ„éµå¾ªå…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚å…¥é˜Ÿæ“ä½œæ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œè¿”å›æ–°æ•°ç»„ã€‚å‡ºé˜Ÿæ“ä½œå¼¹å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›æ–°æ•°ç»„ã€‚ä¸¤ä¸ªæ“ä½œå¯¹äºæ•°ç»„éƒ½æœ‰ç»“æ„çš„æ”¹å˜</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//jsä¸­é˜Ÿåˆ—çš„å®ç°æ˜¯ä¾èµ–æ•°ç»„çš„æ•°æ®ç»“æ„</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];  <span class="comment">//åˆå§‹åŒ–ç©ºæ•°ç»„ï¼Œletå…³é”®å­—æ˜¯es6ä¸­çš„</span></div><div class="line">    <span class="comment">//ç”¨äºå½¢æˆå¤§æ‹¬å·åŒ…å›´çš„ä½œç”¨åŸŸ</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123; <span class="comment">//å…¥é˜Ÿæ“ä½œ</span></div><div class="line">        items.push(element); <span class="comment">//æ•°ç»„pushæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å‡ºå¯¹</span></div><div class="line">        <span class="keyword">return</span> items.shift(); <span class="comment">//æ•°ç»„shiftæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];     <span class="comment">//æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//åˆ¤æ–­é˜Ÿåˆ—æœ‰æ— æˆå‘˜</span></div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>; <span class="comment">//å¸ƒå°”å€¼åˆ¤æ–­</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ¸…ç©ºé˜Ÿåˆ—</span></div><div class="line">        items = [];   <span class="comment">//å˜é‡é‡æ–°èµ‹å€¼ç©ºæ•°ç»„</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è·å¾—é˜Ÿåˆ—çš„é•¿åº¦</span></div><div class="line">        <span class="keyword">return</span> items.length; </div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰“å°é˜Ÿåˆ—</span></div><div class="line">        <span class="built_in">console</span>.log(items.toString());</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ã€‚æ•°æ®æˆå‘˜å…¥é˜Ÿçš„æ—¶å€™è¦æºå¸¦æ•°æ®å’Œä¼˜å…ˆçº§ã€‚<br>ä¼˜å…ˆçº§åœ¨è¿™é‡Œçš„å®šä¹‰æ˜¯æ•°å­—è¶Šå¤§åœ¨æ•°ç»„ä¸­çš„ä½ç½®é åã€‚å½“æ’å…¥ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆè¦æ ¹æ®å®ƒçš„ä¼˜å…ˆçº§æ¥åˆ¤æ–­ï¼Œæœ€å°æ˜¯ç›´æ¥æ’å…¥åˆ°ç¬¬ä¸€ä½ï¼Œç´§é‚»ä¸€ä¸ªæ¯”ä»–å¤§çš„ä¼˜å…ˆçº§æ˜¯ï¼Œå°±æ’å…¥åˆ°è¿™ä¸ªé‚»å±…çš„å‰é¢ã€‚å¦‚æœæ˜¯æœ€å¤§çš„æ•°å­—å°±æ’åˆ°æ•°ç»„çš„æœ€åã€‚<br>ä¸€ç»´æ•°ç»„å˜æˆäº†äºŒä½æ•°ç»„ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PriorityQueue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">QueueElement</span> (<span class="params">element, priority</span>)</span>&#123; </div><div class="line">            <span class="keyword">this</span>.element = element;<span class="comment">//æˆå‘˜æœ¬èº«</span></div><div class="line">        <span class="keyword">this</span>.priority = priority;  <span class="comment">//ä¼˜å…ˆçº§</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element, priority</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> queueElement = <span class="keyword">new</span> QueueElement(element, priority);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> added = <span class="literal">false</span>; <span class="comment">//æ·»åŠ æ ‡è®°</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (queueElement.priority &lt;            </div><div class="line"> items[i].priority)&#123;  <span class="comment">//æ‰¾åˆ°ä¼˜å…ˆçº§æ•°å­—æ¯”ä»–å¤§çš„é‚£ä¸ªå…ƒç´ </span></div><div class="line"></div><div class="line">                items.splice(i,<span class="number">0</span>,queueElement);            </div><div class="line">             <span class="comment">// æ’åˆ°è¿™ä¸ªå…ƒç´ çš„å‰é¢</span></div><div class="line">                added = <span class="literal">true</span>;</div><div class="line">                <span class="keyword">break</span>; <span class="comment">// ç»ˆæ­¢</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!added)&#123; <span class="comment">//å¦‚æœæ˜¯ä¼˜å…ˆçº§æ•°å­—æ˜¯æœ€å¤§çš„ï¼Œç›´æ¥æ’å…¥åˆ°</span></div><div class="line">        <span class="comment">//æ•°ç»„çš„æœ«å°¾</span></div><div class="line">            items.push(queueElement); <span class="comment">//&#123;5&#125;</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="comment">//å…¶ä»–æ“ä½œå’Œæ™®é€šé˜Ÿåˆ—æ˜¯ä¸€æ ·çš„</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.shift();</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//printä½¿ç”¨äº†es6é‡Œçš„æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹æ³•</span></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;items[i].element&#125;</span>  - <span class="subst">$&#123;items[i].priority&#125;</span>`</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> priorityQueue = <span class="keyword">new</span> PriorityQueue();</div><div class="line">priorityQueue.enqueue(<span class="string">"John"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Jack"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Camila"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Maxwell"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Ana"</span>, <span class="number">3</span>);</div><div class="line">priorityQueue.print();</div><div class="line"><span class="comment">//=&gt;</span></div><div class="line"><span class="comment">//æ‰“å°å‡ºçš„ç»“æœ</span></div><div class="line">Jack  - <span class="number">1</span>  <span class="comment">//æ•°ç»„å…ƒç´ --ä¼˜å…ˆçº§</span></div><div class="line">Camila  - <span class="number">1</span></div><div class="line">John  - <span class="number">2</span></div><div class="line">Maxwell  - <span class="number">2</span></div><div class="line">Ana  - <span class="number">3</span></div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªé˜Ÿåˆ—çš„åŸºç¡€ä¸Šå¯ä»¥å®ç°javascriptä¸­æ¡¥æ¥æ¨¡å¼çš„ä¾‹å­ã€‚æœ¬æ–‡ç®—æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„javascripté˜Ÿåˆ—çš„ä»‹ç»ï¼Œä¹Ÿä½œä¸ºæ¡¥æ¥æ¨¡å¼ä¾‹å­çš„èƒŒæ™¯æ–¹æ³•ã€‚<br><a href="http://www.apress.com/cn/book/9781590599082" target="_blank" rel="external">javascriptè®¾è®¡æ¨¡å¼ ç¬¬å…«ç« -æ¡¥æ¥æ¨¡å¼</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ ¹æ®ä¹¦ä¸Šä¾‹å­çš„å®é™…è¦æ±‚ï¼Œæ¶‰åŠåˆ°jsé˜Ÿåˆ—çš„é—®é¢˜ã€‚æ‰€ä»¥å…ˆæŠŠjsä¸­é˜Ÿåˆ—çš„å…·ä½“å®ç°æ•°æ®ç»“æ„è´´å‡ºæ¥ã€‚å…·ä½“å‚è€ƒã€Šå­¦ä¹ javascriptæ•°æ®ç»“æ„å’Œç®—æ³•ã€‹ç¬¬å››ç« ã€‚&lt;br&gt;é˜Ÿåˆ—æ•°æ®ç»“æ„éµå¾ªå…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚å…¥é˜Ÿæ“ä½œæ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œè¿”å›æ–°æ•°ç»„ã€‚å‡ºé˜Ÿæ“ä½œå¼¹å‡ºæ•°ç»„ç¬¬ä¸€ä¸ª
    
    </summary>
    
      <category term="Designpattern" scheme="http://yoursite.com/categories/Designpattern/"/>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
  </entry>
  
</feed>
