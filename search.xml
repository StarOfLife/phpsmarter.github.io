<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[æµ‹è¯•æ–‡ä»¶]]></title>
      <url>http://yoursite.com/2017/03/23/new-article-2/</url>
      <content type="html"></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-å¦‚ä½•ä½¿ç”¨React,Reduxå’ŒImmutable-jsæ„å»ºTodo-App]]></title>
      <url>http://yoursite.com/2017/03/23/%E7%BF%BB%E8%AF%91-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8React,Redux%E5%92%8CImmutable-js%E6%9E%84%E5%BB%BATodo-App/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡æ˜¯ç¿»è¯‘ç‰ˆæœ¬,<a href="https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/" target="_blank" rel="external">åŸæ–‡è¯·è§</a><br><em>By Dan Prince  May 03, 2016</em></p>
</blockquote>
<p>Reactä½¿ç”¨ç»„ä»¶å’Œå•å‘æ•°æ®æµæ–¹å¼æè¿°ç”¨æˆ·ç•Œé¢,ä½†æ˜¯Reactå¯¹stateçš„å¤„ç†éå¸¸çš„ç®€å•.è¿™ä¸€ç‚¹è®©æˆ‘ä»¬çŸ¥é“,Reactä»…ä»…åªå½“äºä¼ ç»Ÿçš„<code>Model-View-Controller</code>æ„æ¶çš„<code>View</code>å±‚.</p>
<p>ä»…ä»…ä½¿ç”¨Reactä¹Ÿå¯ä»¥æ„å»ºå¤§å‹çš„app,ä½†æ˜¯å¾ˆå¿«æˆ‘ä»¬ä¼šå‘ç°,è¦ä¿æŒä»£ç çš„ç®€æ´,æˆ‘ä»¬éœ€è¦åœ¨å…¶ä»–åœ°æ–¹ç®¡ç†state(æŠŠstateçš„ç®¡ç†ç‹¬ç«‹å‡ºæ¥).</p>
<p>æ²¡æœ‰å®˜æ–¹ç®¡ç†åº”ç”¨stateçš„å·¥å…·,ä½†æ˜¯æœ‰å‡ ä¸ªåº“å·¥ä½œçš„çš„ä¸é”™.ä»Šå¤©æˆ‘ä»¬æ·»åŠ ä¸¤ä¸ªåº“å’ŒReactä¸€èµ·æ¥æ„å»ºä¸€ä¸ªç®€å•çš„app.</p>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>Reduxæ˜¯ä¸€ä¸ªå°å‹çš„jsåº“,ä½œä¸ºappçš„stateå®¹å™¨.ç³…åˆäº†Flucå’ŒElmçš„æ¦‚å¿µ.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reduxç®¡ç†ä»»ä½•appçš„state,åªè¦æˆ‘ä»¬ç´§æ‰£ä¸‹é¢çš„æŒ‡å¯¼ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„stateä¿æŒåœ¨ä¸€ä¸ªå•ä¸€çš„storeä¸­</li>
<li>stateçš„æ”¹å˜åªä¼šæ¥è‡ªäºactions</li>
</ol>
<p>Reduxçš„æ ¸å¿ƒ storeæ˜¯ä¸€ä¸ªå‡½æ•°,å®ƒæ¥æ”¶å½“å‰çš„applicationçš„stateå’Œä¸€ä¸ªaction,åˆå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„application state,è¿™ä¸ªå‡½æ•°å«åšReducer.</p>
<p>æˆ‘ä»¬çš„Reactç»„ä»¶è´Ÿè´£å‘é€actionsåˆ°æˆ‘ä»¬çš„store,åè¿‡æ¥,å¦‚æœç»„ä»¶éœ€è¦æ¸²æŸ“çš„æ—¶å€™,storeä¼šé€šçŸ¥ä»–.</p>
<h2 id="ImmutableJS"><a href="#ImmutableJS" class="headerlink" title="ImmutableJS"></a>ImmutableJS</h2><p>å› ä¸ºReduxä¸å…è®¸æˆ‘ä»¬mutateç¨‹åºçš„state,å¦‚æœå€ŸåŠ©immutableæ•°æ®ç»“æ„æ¨¡å‹åŒ–åº”ç”¨ç¨‹åºçš„stateå°†ä¼šéå¸¸çš„æœ‰ç”¨.<br><code>Immutable.js</code>ä½¿ç”¨çªå˜ç•Œé¢(mutative interfaces)æä¾›ä¸€äº›immutableæ•°æ®ç»“æ„,è¿™äº›ç•Œé¢å®æ–½æ—¶éå¸¸çš„é«˜æ•ˆ,çµæ„Ÿæ¥è‡ªäºClojureå’ŒScala.</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>æˆ‘ä»¬å°†ä¼šä½¿ç”¨React,Reduxå’ŒImmutableJSå»æ„å»ºä¸€ä¸ªç®€å•çš„todo list,å…è®¸æˆ‘ä»¬æ·»åŠ todos,åœ¨å®Œæˆå’Œæœªå®Œæˆä¹‹é—´åˆ‡æ¢.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//html</div><div class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">//css</div><div class="line"> html, body, input, button &#123;</div><div class="line">  font-family: Sawasdee;</div><div class="line">  font-size: 20px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__list &#123;</div><div class="line">  margin: 0;</div><div class="line">  padding: 0;</div><div class="line">  list-style-type: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item &#123;</div><div class="line">  padding: .5em .25em;</div><div class="line">  border-bottom: solid 1px #eee;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__item:hover &#123;</div><div class="line">  background: #f7f7f7;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__entry &#123;</div><div class="line">  border: solid 1px #ccc;</div><div class="line">  padding: .25em .5em;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #f3f3f3;</div><div class="line">  width: 100%;</div><div class="line">  box-sizing: border-box;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button &#123;</div><div class="line">  border: 0;</div><div class="line">  border-radius: .2em;</div><div class="line">  background: #71B7FF;  </div><div class="line">  color: #fff;</div><div class="line">  padding: .25em .5em;</div><div class="line">  margin: .5em 0;</div><div class="line">  margin-right: .25em;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.todo__button:hover &#123;</div><div class="line">  background: #B2D8FF;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//js</span></div><div class="line"><span class="keyword">const</span> &#123; <span class="built_in">Map</span>, List &#125; = Immutable;</div><div class="line"><span class="keyword">const</span> &#123; createStore &#125; = Redux;</div><div class="line"><span class="keyword">const</span> &#123; Provider, connect &#125; = reactRedux;</div><div class="line"></div><div class="line"><span class="keyword">const</span> components = &#123;</div><div class="line">  Todo(&#123; todo &#125;) &#123;</div><div class="line">    <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;  </div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  TodoList(&#123; todos, toggleTodo, addTodo &#125;) &#123;</div><div class="line">    <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> text = e.target.value;</div><div class="line">      <span class="keyword">if</span>(e.which === <span class="number">13</span> &amp;&amp; text.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        addTodo(text);</div><div class="line">        e.target.value = <span class="string">''</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> toggleClick = <span class="function">(<span class="params">id</span>) =&gt;</span> () =&gt; toggleTodo(id);</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> &#123; Todo &#125; = components;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='todo'&gt;</div><div class="line">        &lt;input type='text'</div><div class="line">               className='todo__entry'</div><div class="line">               placeholder='Add todo'</div><div class="line">               onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">        &lt;ul className='todo__list'&gt;</div><div class="line">          &#123;todos.map(t =&gt; (</div><div class="line">            &lt;li</div><div class="line">              key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">              &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">            &lt;/li&gt;</div><div class="line">          ))&#125; </div><div class="line">        &lt;/ul&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const actions = &#123;</div><div class="line">  addTodo(text) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'ADD_TODO',</div><div class="line">      payload: &#123;</div><div class="line">        id: Math.random().toString(34).slice(2),</div><div class="line">        isDone: false,</div><div class="line">        text</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  toggleTodo(id) &#123;</div><div class="line">    return &#123;</div><div class="line">      type: 'TOGGLE_TODO',</div><div class="line">      payload: id</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const init = List();</div><div class="line"></div><div class="line">const reducer = function(state=init, action) &#123;</div><div class="line">  switch(action.type) &#123;</div><div class="line">    case 'ADD_TODO':</div><div class="line">      return state.push(</div><div class="line">        Map(action.payload)</div><div class="line">      );</div><div class="line">    case 'TOGGLE_TODO':</div><div class="line">      return state.map(t =&gt; &#123;</div><div class="line">        if(t.get('id') == action.payload) &#123;</div><div class="line">          return t.update('isDone', isDone =&gt; !isDone);</div><div class="line">        &#125; else &#123;</div><div class="line">          return t;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    default:</div><div class="line">      return state;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const containers = &#123;</div><div class="line">  TodoList: connect(</div><div class="line">    function mapStateToProps(state) &#123;</div><div class="line">      return &#123;</div><div class="line">        todos: state</div><div class="line">      &#125;;</div><div class="line">    &#125;,</div><div class="line">    function mapDispatchToProps(dispatch) &#123;</div><div class="line">      return &#123;</div><div class="line">        toggleTodo: (id) =&gt; dispatch(actions.toggleTodo(id)),</div><div class="line">        addTodo: (text) =&gt; dispatch(actions.addTodo(text))</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">  )(components.TodoList)</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const &#123; TodoList &#125; = containers;</div><div class="line">const store = createStore(reducer);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    &lt;TodoList /&gt;</div><div class="line">  &lt;/Provider&gt;,</div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä»£ç åœ¨ <a href="https://github.com/sitepoint-editors/immutable-redux-todo" target="_blank" rel="external">Github</a></p>
<blockquote>
<p>å¯èƒ½æç¤ºbuildå¤±è´¥,<code>npm install babel-core</code>è¯•è¯•</p>
</blockquote>
<h2 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h2><p>ä»åˆ›å»ºé¡¹ç›®ğŸ“‚å¼€å§‹,å»ºç«‹ä¸€ä¸ªpackage.jsonæ–‡ä»¶.ç„¶åå®‰è£…éœ€è¦çš„ä¾èµ–åŒ….</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> npm install --save react react-dom redux react-redux immutable</div><div class="line">npm install --save-dev webpack babel-loader babel-preset-es2015 babel-preset-react</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨JSXå’ŒES2015,ç”¨Babelç¼–è¯‘ä»£ç ,ä½¿ç”¨Webpackæ¥å®Œæˆè¿™ä¸ªæ¨¡å—ç»‘å®šè¿‡ç¨‹.</p>
<p>åœ¨<code>webpack.config.js</code>æ–‡ä»¶ä¸­åˆ›å»ºWebpacké…ç½®æ–‡ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./src/app.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: __dirname,</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel'</span>,</div><div class="line">        <span class="attr">query</span>: &#123; <span class="attr">presets</span>: [ <span class="string">'es2015'</span>, <span class="string">'react'</span> ] &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<p>æœ€åæ‰©å±•ä¸€ä¸‹<code>package.json</code>,æ·»åŠ ä¸€ä¸ªnpm scriptä½¿ç”¨source mapsç¼–è¯‘æˆ‘ä»¬çš„ä»£ç .</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> "scripts": &#123;</div><div class="line">  "build": "webpack --debug"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯æ¬¡ç¼–è¯‘ä»£ç çš„æ—¶å€™,è¿è¡Œ<code>npm run build</code>.</p>
<h2 id="React-amp-Components"><a href="#React-amp-Components" class="headerlink" title="React&amp;Components"></a>React&amp;Components</h2><p>åœ¨å®æ–½é¡¹ç›®ä¹‹å‰,å…ˆåˆ›å»ºä¸€äº›å‚»ç“œæ•°æ®æœ‰å¾ˆå¤§çš„ç”¨å¤„,ä½†æˆ‘ä»¬æ„æ€éœ€è¦æ¸²æŸ“çš„ç»„ä»¶çš„æ—¶å€™,æœ‰ä¸€ç‚¹ç‚¹åˆæ­¥çš„æ„Ÿè§‰.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªReactç»„ä»¶<code>&lt;Todo/&gt;</code>å’Œ<code>&lt;TodoList&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/components.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Todo</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todo &#125; = props;</div><div class="line">  <span class="keyword">if</span>(todo.isDone) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">strike</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos &#125; = props;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text' placeholder='Add todo' /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.id&#125; className='todo__item'&gt;</div><div class="line">            &lt;Todo todo=&#123;t&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>åˆ°äº†è¿™ä¸€æ­¥,å¯ä»¥åˆ›å»º<code>index.html</code>æ–‡ä»¶æ¥æµ‹è¯•è¿™äº›ç»„ä»·,æ·»åŠ ä¸‹é¢çš„æ ‡è®°</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Immutable Todo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p>è¿˜æœ‰ä¸€ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶<code>src/app.js</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;dummyTodos&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>npm run build</code>ç¼–è¯‘æ–‡ä»¶,ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€index.htmlæ–‡ä»¶,ç¡®ä¿è¿è¡Œ.</p>
<h2 id="Redux-amp-ImmutableJS"><a href="#Redux-amp-ImmutableJS" class="headerlink" title="Redux&amp;ImmutableJS"></a>Redux&amp;ImmutableJS</h2><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å¾ˆå¥½çš„UI,å¯ä»¥å¼€å§‹è€ƒè™‘ç»„ä»¶æœ€åçš„state.å¼€å§‹åˆ›å»ºçš„å‚»ç“œæ•°æ®æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€ç«¯,æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“è½¬åŒ–ä¸ºImmutableJSé›†åˆ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> dummyTodos = List([</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">isDone</span>: <span class="literal">true</span>,  <span class="attr">text</span>: <span class="string">'make components'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'design actions'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'implement reducer'</span> &#125;),</div><div class="line">  <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">isDone</span>: <span class="literal">false</span>, <span class="attr">text</span>: <span class="string">'connect components'</span> &#125;)</div><div class="line">]);</div></pre></td></tr></table></figure>
<hr>
<p>ImmutableJS mapå’ŒJavascriptçš„å¯¹è±¡å·¥ä½œæ–¹å¼ä¸åŒ,æ‰€ä»¥æˆ‘ä»¬è¦å¯¹ç»„ä»¶åšä¸€ç‚¹è½»å¾®çš„æ”¹å˜.propertyæ¥å…¥çš„åœ°æ–¹(ä¾‹å¦‚ï¼štodo.id)éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•è°ƒç”¨æ¥ä»£æ›¿(ä¾‹å¦‚:<code>todo.get(â€˜idâ€™)</code>).</p>
<h2 id="è®¾è®¡Actions"><a href="#è®¾è®¡Actions" class="headerlink" title="è®¾è®¡Actions"></a>è®¾è®¡Actions</h2><p>ç°åœ¨æˆ‘ä»¬è·å¾—äº†æ•°æ®çš„ç‰¹å¾,å¯ä»¥è€ƒè™‘ä¸€ä¸‹actionsçš„æ›´æ–°.è¿™ä¸ªå®ä¾‹ä¸­,æˆ‘ä»¬ä»…ä»…éœ€è¦ä¸¤ä¸ªacions,ä¸€ä¸ªæ˜¯æ·»åŠ æ–°çš„todo,å¦ä¸€ä¸ªè½¬æ¢todoçš„çŠ¶æ€.</p>
<p>è®©æˆ‘ä»¬å®šä¹‰å‡ ä¸ªå‡½æ•°åˆ›å»ºè¿™äº›actions</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// src/actions.js</span></div><div class="line"></div><div class="line"><span class="comment">// succinct hack for generating passable unique ids</span></div><div class="line"><span class="keyword">const</span> uid = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random().toString(<span class="number">34</span>).slice(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'ADD_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: &#123;</div><div class="line">      <span class="attr">id</span>: uid(),</div><div class="line">      <span class="attr">isDone</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">text</span>: text</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'TOGGLE_TODO'</span>,</div><div class="line">    <span class="attr">payload</span>: id</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ªactionä»…ä»…æ˜¯ä¸€ä¸ªæœ‰typeå’Œpayloadçš„å±æ€§å¯¹è±¡.åœ¨æˆ‘ä»¬è§¦å‘actionå,typeå±æ€§å¸®åŠ©æˆ‘ä»¬ç”¨payloadæ¥ä½œä»€ä¹ˆ.</p>
<h2 id="è®¾è®¡ä¸€ä¸ªReducer"><a href="#è®¾è®¡ä¸€ä¸ªReducer" class="headerlink" title="è®¾è®¡ä¸€ä¸ªReducer"></a>è®¾è®¡ä¸€ä¸ªReducer</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†stateçš„ç‰¹æ€§å’Œæ›´æ–°stateçš„action,æˆ‘ä»¬å¯ä»¥åˆ›å»ºreduceräº†.ä»…ä»…æé†’ä¸€ä¸‹,reduceræ˜¯ä¸€ä¸ªæ¥æ”¶stateå’Œactionçš„å‡½æ•°,ç„¶åç”¨æ¥è®¡ç®—æ›´æ–°state.</p>
<p>è¿™é‡Œæ˜¯æˆ‘ä»¬reducerçš„åˆå§‹ç»“æ„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/reducer.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; List, <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> init = List([]);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">todos=init, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span>(action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> todos;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ“ä½œ<code>ADD_TODO</code>actionéå¸¸ç®€å•,å¯æ˜¯ä½¿ç”¨<code>.push()</code>æ–¹æ³•,è¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨,æ·»åŠ todoåˆ°æœ«å°¾.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.push(<span class="built_in">Map</span>(action.payload));</div></pre></td></tr></table></figure>
<hr>
<p>è®°ä½è¦pushåˆ°åˆ—è¡¨ä¹‹å‰,è¦æŠŠtodoå¯¹è±¡è½¬å˜ä¸ºimmutable map.</p>
<p>æˆ‘ä»¬éœ€è¦å¤„ç†çš„ç¨å¾®å¤æ‚çš„actionæ˜¯<code>TOOGLE_TODO</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line"> <span class="keyword">return</span> todos.map(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</div><div class="line">   <span class="keyword">if</span>(t.get(<span class="string">'id'</span>) === action.payload) &#123;</div><div class="line">     <span class="keyword">return</span> t.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line">   &#125; <span class="keyword">else</span> &#123;</div><div class="line">     <span class="keyword">return</span> t;</div><div class="line">   &#125;</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>.map()</code>éå†åˆ—è¡¨,æ‰¾åˆ°ä¸aciton<code>id</code>åŒ¹é…çš„todoé¡¹ç›®.ä¹‹åæˆ‘ä»¬è°ƒç”¨<code>.update()</code>æ–¹æ³•,æ¥æ”¶ä¸€ä¸ªé”®å’Œå‡½æ•°,ç„¶åè¿”å›ä¸€ä¸ªmapçš„æ–°æ‹·è´åˆ°updataå‡½æ•°,æ–°æ‹·è´ä¸­æ–°å€¼æ›¿æ¢äº†åˆå§‹å€¼.</p>
<p>å­—é¢é‡ç‰ˆæœ¬<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">const</span> todo = <span class="built_in">Map</span>(&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">'foo'</span>, <span class="attr">isDone</span>: <span class="literal">false</span> &#125;);</div><div class="line">todo.update(<span class="string">'isDone'</span>, isDone =&gt; !isDone);</div><div class="line"><span class="comment">// =&gt; &#123; id: 0, text: 'foo', isDone: true &#125;</span></div></pre></td></tr></table></figure></p>
<hr>
<h2 id="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"><a href="#æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·" class="headerlink" title="æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·"></a>æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¿ç³»åˆ°ä¸€èµ·</h2><p>actionså’Œreducerå‡†å¤‡å¥½äº†,å¯ä»¥åˆ›å»ºä¸€ä¸ªstore,è¿æ¥åˆ°æˆ‘ä»¬çš„Reactç»„ä»¶ä¸­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">TodoList</span> <span class="attr">todos</span>=<span class="string">&#123;store.getState()&#125;</span> /&gt;</span>,</span></div><div class="line">  document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<p>ä¸ºäº†ä¿æŒç»„ä»¶å’Œstoreçš„ç‹¬ç«‹,æˆ‘ä»¬ä½¿ç”¨<code>react-redux</code>å¸®åŠ©ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹.å®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºç‹¬ç«‹äºstoreçš„å®¹å™¨,åŒ…è£…æ‰€æœ‰çš„ç»„ä»¶,æˆ‘ä»¬ä¸éœ€è¦æ”¹å˜å…ˆå‰çš„è®¾è®¡.</p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¹å™¨åŒ…è£…<code>&lt;TodoList/&gt;</code>ç»„ä»¶,çœ‹çœ‹ä¸‹é¢çš„å†…å®¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/containers.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> components <span class="keyword">from</span> <span class="string">'./components'</span>;</div><div class="line"><span class="keyword">import</span> &#123; addTodo, toggleTodo &#125; <span class="keyword">from</span> <span class="string">'./actions'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> TodoList = connect(</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">)(components.TodoList);</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä½¿ç”¨<code>connect</code>å‡½æ•°åˆ›å»ºå®¹å™¨.å½“æˆ‘ä»¬è°ƒç”¨<code>connect()</code>å‡½æ•°,ä¼ é€’ä¸¤ä¸ªå‡½æ•°,<code>mapStateToProps()</code>å’Œ<code>mapDispatchToProps()</code>.</p>
<p><code>mapStateToProps()</code>å‡½æ•°æ¥æ”¶å½“å‰storeçš„stateä½œä¸ºå‚æ•°,æœŸå¾…è¿”å›ä¸€ä¸ªæˆ‘ä»¬åŒ…è£…ç»„ä»¶éœ€è¦çš„å¯¹è±¡æ˜ å°„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; <span class="attr">todos</span>: state &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢ä»£ç æ˜¯ä¸€ä¸ªåŒ…è£…ç»„ä»¶æ ¹æ®æ˜ å°„mapå¯è§†åŒ–çš„ç»“æœ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›<code>mapDispatchProps</code>å‡½æ•°,ä¼ é€’storeçš„<code>dispatch</code>æ–¹æ³•,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨action creatrosæ¥dispatch actions.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">addTodo</span>: <span class="function"><span class="params">text</span> =&gt;</span> dispatch(addTodo(text)),</div><div class="line">    <span class="attr">toggleTodo</span>: <span class="function"><span class="params">id</span> =&gt;</span> dispatch(toggleTodo(id))</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å†ä¸€æ¬¡å®ä¾‹åŒ–ç»„ä»¶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;TodoList todos=&#123;state&#125;</div><div class="line">         addTodo=&#123;text =&gt; dispatch(addTodo(text))&#125;</div><div class="line">         toggleTodo=&#123;id =&gt; dispatch(toggleTodo(id))&#125; /&gt;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠaction creatorsæ˜ å°„åˆ°ç»„ä»¶,å¯ä»¥ä»äº‹ä»¶ç›‘å¬ä¸­è°ƒç”¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">TodoList</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; todos, toggleTodo, addTodo &#125; = props;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> onSubmit = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> input = event.target;</div><div class="line">    <span class="keyword">const</span> text = input.value;</div><div class="line">    <span class="keyword">const</span> isEnterKey = (event.which == <span class="number">13</span>);</div><div class="line">    <span class="keyword">const</span> isLongEnough = text.length &gt; <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(isEnterKey &amp;&amp; isLongEnough) &#123;</div><div class="line">      input.value = <span class="string">''</span>;</div><div class="line">      addTodo(text);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> toggleClick = <span class="function"><span class="params">id</span> =&gt;</span> event =&gt; toggleTodo(id);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div className='todo'&gt;</div><div class="line">      &lt;input type='text'</div><div class="line">             className='todo__entry'</div><div class="line">             placeholder='Add todo'</div><div class="line">             onKeyDown=&#123;onSubmit&#125; /&gt;</div><div class="line">      &lt;ul className='todo__list'&gt;</div><div class="line">        &#123;todos.map(t =&gt; (</div><div class="line">          &lt;li key=&#123;t.get('id')&#125;</div><div class="line">              className='todo__item'</div><div class="line">              onClick=&#123;toggleClick(t.get('id'))&#125;&gt;</div><div class="line">            &lt;Todo todo=&#123;t.toJS()&#125; /&gt;</div><div class="line">          &lt;/li&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>containerå®¹å™¨è‡ªåŠ¨è®¢é˜…storeçš„å˜åŒ–,åªè¦çš„æ˜ å°„çš„propså˜åŒ–çš„æ—¶å€™,å®¹å™¨åŒ…è£…çš„ç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“.</p>
<p>æœ€å,éœ€è¦ä½¿å®¹å™¨ç»„ä»¶ç‹¬ç«‹äºstore,ä½¿ç”¨<code>&lt;Provider/&gt;</code>ç»„ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// src/app.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123; TodoList &#125; <span class="keyword">from</span> <span class="string">'./containers'</span>;</div><div class="line"><span class="comment">//                          ^^^^^^^^^^</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"></div><div class="line">render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">TodoList</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<hr>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>ä¸å¯å¦è®¤,å¯¹äºåˆå­¦è€…æ¥è¯´,Reactå’ŒReduxçš„ç”Ÿæ€ç³»ç»Ÿæ˜¯ç›¸å½“å¤æ‚å’Œä»¤äººè¿·æƒ‘çš„.<br>ä½†æ˜¯å¥½æ¶ˆæ¯æ˜¯è¿™äº›æ¦‚å¿µæ˜¯å¯ä»¥å¯ä»¥è½¬ç§»çš„.æˆ‘ä»¬ä»…ä»…ç²—ç•¥çš„æ¥è§¦äº†Reduxçš„åŸºç¡€æ„æ¶,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Elm æ„æ¶</code>,æˆ–è€…é€‰å–ClojureScriptåº“ä¾‹å¦‚ï¼š<code>Om</code>,<code>Re-frame</code>.ç±»ä¼¼çš„,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°immutableæ•°æ®ç»“æ„çš„åªè¨€ç‰‡è¯­,ä½†æ˜¯å·²ç»è¶³å¤Ÿæˆ‘ä»¬å­¦ä¹ <code>Clojure</code>æˆ–è€…<code>Haskell</code>.</p>
<p>ä¸ç®¡ä½ æ˜¯åˆšå¼€å§‹æ¢ç´¢æœ‰å…³stateçš„webç¼–ç¨‹å¼€å‘è€…,è¿˜æ˜¯ä½¿ç”¨javascriptå¾ˆé•¿æ—¶é—´çš„å¼€å‘è€…,åŸºäºactionæ„æ¶çš„åŠæˆå’Œimmutableæ•°æ®ç»“æ„å˜å¾—è‡³è§‚é‡è¦çš„æŠ€èƒ½.æ‰€ä»¥ç°åœ¨æ˜¯å­¦ä¹ è¿™äº›å†…å®¹çš„æ—¶é—´äº†.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-è®©æˆ‘ä»¬æŠŠReact-Containerç»„åˆèµ·æ¥]]></title>
      <url>http://yoursite.com/2017/03/21/%E7%BF%BB%E8%AF%91-%E8%AE%A9%E6%88%91%E4%BB%AC%E6%8A%8AReact-Container%E7%BB%84%E5%90%88%E8%B5%B7%E6%9D%A5/</url>
      <content type="html"><![CDATA[<blockquote>
<p><em>Arunoda Susiripala</em>  <a href="https://voice.kadira.io/let-s-compose-some-react-containers-3b91b6d9b7c8#.92sjwgug1" target="_blank" rel="external">è¯·å‚çœ‹åŸæ–‡</a></p>
</blockquote>
<p>è¿‘æ¥(Jan,2016),è‡ªç»™è‡ªè¶³çš„container(Reduxçš„å®¹å™¨)æ–¹æ³•åœ¨Reactçš„ç¤¾åŒºä¸­éå¸¸çš„æµè¡Œ.ä»–ä»¬åœ¨Realy,Reduxç”šè‡³æ˜¯åœ¨Meteorä¸­å¹¿æ³›ä½¿ç”¨.è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ·±å…¥containerå†…éƒ¨,äº†è§£ä¸€ä¸‹æ€ä¹ˆç®€ä¾¿çš„ç»„åˆcontainers.</p>
<h2 id="ä»€ä¹ˆæ˜¯Container"><a href="#ä»€ä¹ˆæ˜¯Container" class="headerlink" title="ä»€ä¹ˆæ˜¯Container?"></a>ä»€ä¹ˆæ˜¯Container?</h2><p>åœ¨Reactä¸­,æˆ‘ä»¬æœ‰propså’Œstatesæ¥ç®¡ç†ç»„ä»¶çš„æ•°æ®éœ€æ±‚.æœ€è¿‘æœ‰ä¸€ä¸ªè¶‹åŠ¿,åœ¨ç»„ä»¶ä¸­ä»…ä»…åªé€šè¿‡propsæ¥æ¥æ”¶æ•°æ®å’Œaction.æˆ‘ä»¬ä»…ä»…åœ¨ç»„ä»¶å†…éƒ¨ä¿ç•™state.</p>
<p>æˆ‘ä»¬æœ‰æ—¶å€™å«è¿™äº›ç»„ä»¶ä¸ºâ€œå•çº¯å±•ç¤ºç»„ä»¶â€.<br>æˆ‘ä¹Ÿä¸å¤ªç¡®å®šè°å‘æ˜çš„è¿™ä¸ªæœ¯è¯­.ä½†æ˜¯æˆ‘æ‰å¯èƒ½æ˜¯<a href="https://medium.com/@dan_abramov" target="_blank" rel="external">Dan Abramov</a>.<br>æŸ¥çœ‹ä¸€ä¸‹ä»–çš„æ–‡ç« â€œSmart and Dumb Componentsâ€.</p>
<p>ä½†æ˜¯æˆ‘è®¤ä¸ºå«åš<strong><code>UIç»„ä»¶</code></strong>æ›´å¥½ä¸€ç‚¹(æˆ–è€…ä»…ä»…å«åšç»„ä»¶).<br>æ¥ç€åˆå¦ä¸€å¥—ç»„ä»¶å®é™…ç®¡ç†æœ¬åœ°æ•°æ®å’Œè·å–è¿œç¨‹æ•°æ®.è¿™äº›ç»„ä»¶è¢«ç§°ä¸º<strong><code>containerç»„ä»¶</code></strong>.Relayå’ŒReduxçš„Reactç»‘å®šæ˜¯ä»–ä»¬æ›´æµè¡Œäº†.</p>
<p>ä¸‹é¢æ˜¯æ€ä¹ˆä½¿ç”¨Reat Devtoolsæ¥æŸ¥çœ‹ç»„ä»¶çš„è§†å›¾.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-f461d4894bfc06de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="1*QhMLf9dhu-cbAxN9Gc9dtg-2.png"></p>
<p>Container(BlogPost)æ¥æ”¶postId Props.ç„¶åä»–å°†ä¼šè·å–æ•°æ®ä¼ é€’åˆ°å®é™…UIç»„ä»¶ä¸­.</p>
<h2 id="Containerçš„å¸¸è§„ä»»åŠ¡"><a href="#Containerçš„å¸¸è§„ä»»åŠ¡" class="headerlink" title="Containerçš„å¸¸è§„ä»»åŠ¡"></a>Containerçš„å¸¸è§„ä»»åŠ¡</h2><p>containerçš„ä¸»è¦ä»»åŠ¡æ˜¯è·å–æ•°æ®,è¿™é‡Œé¢æœ‰ä¸€äº›äº‹æƒ…è¦åš,è®©æˆ‘ä»¬çœ‹çœ‹:</p>
<ul>
<li>è¯·æ±‚æ•°æ®(è°ƒç”¨è®¢é˜…æˆ–è€…ä»…ä»…è·å–æ•°æ®)</li>
<li>å½“æ•°æ®åŠ è½½çš„æ—¶å€™å±•ç¤ºåŠ è½½å›¾ç‰‡</li>
<li>ä¸€æ—¦æ•°æ®è¿”å›,æŠŠå®ƒä¼ é€’åˆ°UIç»„ä»¶ä¸­</li>
<li>å¦‚æœæœ‰é”™è¯¯,å±•ç¤ºç»™ç”¨æˆ·</li>
<li>å½“propsæ”¹å˜äº†,éœ€è¦é‡æ–°è·å–æˆ–è€…é‡æ–°è®¢é˜…</li>
<li>å½“containerå¸è½½çš„æ—¶å€™,éœ€è¦æ¸…é™¤èµ„æº.</li>
</ul>
<p>è¿™é‡Œcontaineræœ‰å¾ˆå¤šçš„ä»»åŠ¡è¦å®Œæˆ.å¦‚æœä½ æƒ³è‡ªå·±åšè¿™äº›ä»»åŠ¡,ä½ å°±ä¸å¾—ä¸åšä¸€äº›é‡å¤çš„å·¥ä½œ,å‘ç”Ÿé”™è¯¯çš„æ¥æºå°±ç”±æ­¤è¯ç”Ÿäº†.</p>
<h2 id="React-Komposerçš„ä»‹ç»"><a href="#React-Komposerçš„ä»‹ç»" class="headerlink" title="React Komposerçš„ä»‹ç»"></a>React Komposerçš„ä»‹ç»</h2><p>React Komposerè¯•å›¾å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“çš„åˆå¹¶containers.æœ‰äº†å®ƒ,ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®èµ„æº,ä¸ç®¡ä½ çš„æ•°æ®æ˜¯æ¥è‡ªäºPromise,Observableç”šè‡³æ˜¯Meteorâ€˜s Tracker.</p>
<h3 id="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3><p>åƒä¸‹é¢è¿™æ ·åˆ›å»ºä¸€ä¸ª<em>æ•°å­—æ—¶é’Ÿ</em>:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-10d84673aea28707.gif?imageMogr2/auto-orient/strip" alt="Digital clock"></p>
<p>è¿™æ˜¯ä¸€ä¸ªå¥½çš„å®ä¾‹,å› ä¸ºæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸ªcontainerçš„å‡ ä¹æ‰€æœ‰çš„åŠŸèƒ½.å¼€å§‹</p>
<p>é¦–å…ˆå®‰è£…react-komposer:</p>
<p><code>npm i â€” save react-komposer</code></p>
<p>ç„¶åè¾“å…¥composeå‡½æ•°ï¼š<br><code>import {compose} from â€˜react-komposerâ€™;</code></p>
<p>ç°åœ¨éœ€è¦ä¸€ä¸ªUIç»„ä»¶å»æ¸²æŸ“æ—¶é—´:</p>
<p><code>const Time = ({time}) =&gt; (&lt;div&gt;{time}&lt;/div&gt;);</code></p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„ç»„åˆå‡½æ•°:</p>
<p>è·å–æ—¶é—´çš„æ—¶å€™éœ€è¦è°ƒç”¨<code>onData</code>å›è°ƒå‡½æ•°(è¿™é‡Œæ²¡æœ‰å®é™…åšä»€ä¹ˆ.)</p>
<p>éœ€è¦è°ƒç”¨<code>onData</code>å‡½æ•°å¤šå°‘æ¬¡å¯ä»¥,åªè¦ç¨‹åºéœ€è¦.å¦‚æœæœ‰é”™è¯¯,å¯ä»¥æŠŠé”™è¯¯ä¿¡æ¯ä½œä¸º<code>onData</code>çš„ç¬¬ä¸€ä¸ªå€¼.</p>
<p>æœ€å,æˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ªæ¸…é™¤èµ„æºçš„é¢å‡½æ•°.åœ¨è¿™ä¸ªå®ä¾‹ä¸­ç”¨ä»–æ¥æ¸…é™¤setIntervaçš„å¥æŸ„.</p>
<p>å¥½äº†,ç°åœ¨æ¥åˆå¹¶ä¸€ä¸‹composer:<br><code>const Clock = compose(composerFunction)(Time);</code></p>
<p>ç„¶åæ¸²æŸ“åˆ°DOMä¸­:<br><code>ReactDOM.render(&lt;Clock /&gt;, document.body);</code></p>
<p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè‡ªæˆ‘ç®¡ç†(state)çš„æ—¶é’Ÿ.<a href="https://jsfiddle.net/arunoda/jxse2yw8/" target="_blank" rel="external">çœ‹çœ‹å®é™…æ¼”ç¤º</a>.</p>
<p>è¿™é‡Œæœ‰ä¸ª<a href="https://jsfiddle.net/arunoda/7qy1mxc7/" target="_blank" rel="external">æ›´å¤æ‚çš„ç‰ˆæœ¬</a>,ä½¿ç”¨props,å¤„ç†é”™è¯¯ä¿¡æ¯.</p>
<p>ä½ ä¹Ÿå¯ä»¥æ”¹å˜é»˜è®¤åŠ è½½å’Œé”™è¯¯ç»„ä»¶.æŸ¥çœ‹ä¸€ä¸‹<a href="https://github.com/kadirahq/react-komposer#api" target="_blank" rel="external">react-komposer æ–‡æ¡£</a>.</p>
<p>è·å¾—å¥½å¤„:æ›´å®¹æ˜“æµ‹è¯•</p>
<p>ä½œä¸ºè¿™ä¸ªç»„ä»¶çš„é™„åŠ æ•ˆæœ,æˆ‘ä»¬ç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“æµ‹è¯•UIä»£ç .</p>
<ul>
<li>å› ä¸ºUIç»„ä»¶ä»…ä»…é€šè¿‡propsæ¥æ”¶æ•°æ®(å’Œaction),æ˜¯çš„æµ‹è¯•å¾ˆå®¹æ˜“.</li>
<li>ä¹Ÿå¯ä»¥æµ‹è¯•ç»„åˆå‡½æ•°çš„æ•°æ®è·å–é€»è¾‘.</li>
</ul>
<h2 id="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"><a href="#å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ" class="headerlink" title="å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ"></a>å¯¹äºå¤šç§æ•°æ®æºçš„æ”¯æŒ</h2><p>æˆ‘å·²ç»æåˆ°è¿‡,å¯ä»¥ä½¿ç”¨è¿™ä¸ªç»„ä»¶å’Œä»»ä½•æ•°æ®æºä¸€èµ·å·¥ä½œ,å› ä¸ºç»„åˆçš„APIæ˜¯é€šç”¨çš„.æˆ‘ä»¬æœ‰å¤„ç†æµè¡Œæ•°æ®æºçš„ç‰¹å®šAPIS.<br> è¿™é‡Œæ˜¯:</p>
<ul>
<li><em>composeWithPromise</em>ç”¨äºPromise-baseed æ•°æ®æº</li>
<li><em>composeWithObservable</em>ç”¨äºRx.js Observalbe-basedæ•°æ®æº</li>
<li><em>composeWithTracker</em>å‡ºäº‹ç‰¹æ®Šçš„ä¸€äº›æ•°æ®æº.</li>
</ul>
<p>æœ‰äº†è¿™äº›API,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨react-komposerå»åˆå¹¶ä»»ä½•æ•°æ®æºçš„container.</p>
<p>çœ‹çœ‹<a href="https://github.com/kadirahq/react-komposer#using-with-xxx" target="_blank" rel="external">repo</a>,æœ‰æ›´å¤šçš„ä¾‹å­.</p>
<p>åœ¨ä½ çš„appä¸­ä½¿ç”¨ä¸€ä¸‹react-komposer,ä½ ä¼šå–œæ¬¢ä¸Šä»–çš„.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptåŠ¨æ€ç±»å‹ï¼Œé¸­å­ç»ˆäºç…®ç†Ÿäº†]]></title>
      <url>http://yoursite.com/2017/03/20/javascript%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%EF%BC%8C%E9%B8%AD%E5%AD%90%E7%BB%88%E4%BA%8E%E7%85%AE%E7%86%9F%E4%BA%86/</url>
      <content type="html"><![CDATA[<p>å†¬è‡³æ¥äº†ï¼Œåˆšå»åƒäº†ä¸€ç¢—èåœé¥ºå­ï¼Œæµ‘èº«å‘çƒ­ã€‚çªç„¶è§‰å¾—é¸­å­å·²ç»ç†Ÿäº†ã€‚</p>
<p>å¼€ä¸ªç©ç¬‘ã€‚è¿™é‡Œè¦è¯´çš„æ˜¯åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»å‹(ducking type)ã€‚ <code>è¿™ä¸ªè¯é¢˜åº”è¯¥æ˜¯æ•´ä¸ªjavascripté¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³</code>.ä¸çŸ¥é“ä¸‹è¿™ä¸ªç»“è®ºå¯¹ä¸å¯¹ï¼Ÿå¯æ˜¯åœ¨å‰é¢è¿˜ä¸å¤ªäº†è§£åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ã€‚çœ‹ä»£ç çš„æ—¶å€™æ€»æœ‰ç§æ„Ÿè§‰ï¼Œå°±æ˜¯javascriptå¤ªçµæ´»äº†ï¼Œæ€ä¹ˆä»€ä¹ˆå¯¹è±¡çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡å‚æ•°ä¼ é€’çš„æ–¹å¼æ¥åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ã€‚åœ¨æ¨¡å¼å­¦ä¹ æ—¶å¸¸çœ‹åˆ°è¿™ç§ä»£ç ã€‚<br>åˆšæ‰åˆé‡æ–°çœ‹è¿™éƒ¨åˆ†å†…å®¹æ—¶çªç„¶æ˜ç™½äº†ã€‚è¿™ä¸ªæ–¹æ³•å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹é‡Œçš„é¸­å­æ¨¡å‹ã€‚</p>
<p>ä»€ä¹ˆæ˜¯é¸­å­ç±»å‹å‘¢ï¼Ÿæˆ‘æ€»ç»“ä¸€å¥è¯ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦èƒ½å¹²æ´»å°±è¡Œã€‚javascripté‡Œé¢å¯¹è±¡éƒ½æ˜¯è“é¢†ï¼Œåªå¹²æ´»ï¼Œè‡³äºæ˜¯å°å­¦æ°´å¹³è¿˜æ˜¯åšå£«æ°´å¹³ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒï¼Œèƒ½å¹²æ´»å°±è¡Œã€‚ javaè¯­è¨€å°±ä¸æ˜¯ï¼Œjavaåœ¨ä½ å¹²æ´»ä¹‹å‰æƒ³è¦æŠŠä½ çš„ç¥–å®—åå…«ä»£éƒ½æŸ¥ä¸€éï¼Œæ ¹æ­£è‹—çº¢çš„æ‰èƒ½æ¥å¹²æ´»ã€‚æ‰€ä»¥javascriptå°±å¾ˆçµæ´»å•¦ã€‚</p>
<p>è¿™å°±æ˜¯é¸­å­ç±»å‹ã€‚<code>å¦‚æœå®ƒèµ°èµ·è·¯æ¥åƒé¸­å­ï¼Œå«èµ·æ¥å˜å˜çš„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­</code>ã€‚</p>
<p>é¸­å­ç±»å‹èµ‹äºˆäº†javascriptæå¤§çš„çµæ´»æ€§ï¼ŒåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„æ—¶å€™éå¸¸è‡ªç”±ã€‚ </p>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ ç¬¬ä¸€ç« </p>
<p>çœ‹ä¸‹é¢ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> duck = &#123;  <span class="comment">//é¸­å­å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> chicken = &#123;  <span class="comment">//é¸¡å¯¹è±¡</span></div><div class="line">		duckSinging: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å˜å˜å˜'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> choir = []; <span class="comment">// åˆå”±å›¢</span></div><div class="line">	<span class="keyword">var</span> joinChoir = <span class="function"><span class="keyword">function</span>(<span class="params"> animal </span>)</span>&#123; <span class="comment">//å®ä¾‹åŒ–åŠ¨ç‰©å¯¹è±¡</span></div><div class="line">		<span class="keyword">if</span> ( animal &amp;&amp; <span class="keyword">typeof</span> animal.duckSinging === <span class="string">'function'</span> )&#123; </div><div class="line">       <span class="comment">//ç¨ä½œæ£€æµ‹ï¼Œåªè¦æœ‰å”±æ­Œçš„æ–¹æ³•å°±å¯ä»¥ç”¨ã€‚</span></div><div class="line">			choir.push( animal );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ­å–œåŠ å…¥åˆå”±å›¢'</span> );</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'åˆå”±å›¢å·²æœ‰æˆå‘˜æ•°é‡:'</span> + choir.length );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	joinChoir( duck ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div><div class="line">	joinChoir( chicken ); <span class="comment">// æ­å–œåŠ å…¥åˆå”±å›¢</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªé¸­å­ç±»å‹çš„ä»£ç ï¼Œ é¸¡ä¹Ÿæ··å…¥åˆå”±å›¢äº†ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»ï¼Œè‹±é›„ä¸é—®å‡ºå¤„ï¼Œåªè¦ä½ èƒ½å”±æ­Œå°±è¡Œäº†ã€‚<br>å¾ˆæ–¹ä¾¿å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚ javascriptä»£ç ä¸­éå¸ƒè¿™æ ·çš„ä¾‹å­ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥ä¸€ç‚¹ä¹Ÿä¸å¥‡æ€ªäº†ã€‚å› ä¸ºè¿™é¸­å­ç±»å‹å°±æ˜¯åŠ¨æ€è¯­è¨€çš„ä¼˜åŠ¿ã€‚è€Œjavascriptå°±æ˜¯åŠ¨æ€è¯­è¨€ä¹‹ä¸€ï¼Œåªæ˜¯å®ç°äº†è¿™ç§æ¨¡å¼è€Œå·²ã€‚</p>
<p>å¯¹äºè¿™ä¸ªé—®é¢˜çš„è®¤è¯†ä¹Ÿç ´è´¹å‘¨æŠ˜ï¼Œä½†æ˜¯ç°åœ¨çœ‹æ¥æ˜¯å€¼å¾—çš„ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå¯¹javascriptçš„åº”ç”¨èƒ½åŠ›å°±æ›´åŠ æ·±äº†ä¸€æ­¥ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/19/javascript%E7%9A%84%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ç§åªéœ€è¦ä½¿ç”¨ç»§æ‰¿å°±å¯ä»¥å®ç°çš„éå¸¸ç®€å•çš„æ¨¡å¼<br> æ¨¡æ¿æ–¹æ³•ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€æ˜¯æŠ½è±¡çš„çˆ¶ç±»ï¼ŒäºŒæ˜¯å…·ä½“å®ç°çš„å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°ä¸€äº›å…¬å…±æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚</p>
</blockquote>
<p>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬11ç« </p>
<p>è¿™ä¸ªæ¨¡å¼æ–¹æ³•å¾ˆæœ‰æ„æ€,åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„é¢è¿‡ç¨‹ï¼Œæ˜¯å¯¹ç±»ä¼¼çš„ç”Ÿäº§è¿‡ç¨‹çš„å…·ä½“ç»†èŠ‚çš„ç†è§£ï¼Œæ‰¾å‡ºæµç¨‹ä¸­çš„å…±åŒç‚¹ä½œä¸ºæŠ½è±¡çš„çˆ¶ç±»ã€‚<br>å’–å•¡å’ŒèŒ¶çš„å†²æ³¡è¿‡ç¨‹</p>
<table>
<thead>
<tr>
<th style="text-align:left">æ³¡<code>å’–å•¡</code></th>
<th style="text-align:left">æ³¡<code>èŒ¶</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
<td style="text-align:left">æŠŠæ°´ç…®æ²¸</td>
</tr>
<tr>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æ³¡å’–å•¡</code></td>
<td style="text-align:left">ç”¨æ²¸æ°´<code>æµ¸æ³¡èŒ¶å¶</code></td>
</tr>
<tr>
<td style="text-align:left">æŠŠ<code>å’–å•¡</code>å€’è¿›æ¯å­</td>
<td style="text-align:left">æŠŠ<code>èŒ¶æ°´</code>å€’è¿›æ¯å­</td>
</tr>
<tr>
<td style="text-align:left">åŠ <code>ç³–å’Œç‰›å¥¶</code></td>
<td style="text-align:left">åŠ <code>æŸ æª¬</code></td>
</tr>
</tbody>
</table>
<p>æŠŠæ³¡å’–å•¡å’Œæ³¡èŒ¶çš„ä¸åŒç‚¹æ ‡ç¤ºå‡ºæ¥ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯å…±åŒçš„éƒ¨åˆ†</p>
<ul>
<li>[ ] åŸæ–™ä¸åŒï¼Œä¸€ä¸ªæ˜¯å’–å•¡ï¼Œä¸€ä¸ªæ˜¯èŒ¶ã€‚æŠ½è±¡ä¸ºé¥®æ–™</li>
<li>[ ] æ³¡çš„æ–¹å¼ä¸åŒï¼Œä¸€ä¸ªæ˜¯æ³¡ï¼Œä¸€ä¸ªæ˜¯æµ¸æ³¡ã€‚ç»Ÿä¸€æŠ½è±¡ä¸ºæ³¡</li>
<li>[ ] åŠ å…¥çš„è°ƒå‘³å“ä¸åŒï¼Œä¸€ä¸ªæ˜¯ç³–å’Œç‰›å¥¶ï¼Œä¸€ä¸ªæ˜¯æŸ æª¬ã€‚æŠ½è±¡ä¸ºè°ƒæ–™<br>æ•´ä¸ªå†²æ³¡é¥®æ–™çš„è¿‡ç¨‹å°±æŠ½è±¡ä¸ºä¸‹é¢çš„æµç¨‹</li>
</ul>
<ol>
<li>æŠŠæ°´ç…®æ²¸</li>
<li>ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</li>
<li>æŠŠé¥®æ–™å€’è¿›è¢«å­</li>
<li>åŠ è°ƒæ–™</li>
</ol>
<p>æŠ½è±¡çš„çˆ¶ç±»çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; </div><div class="line">Beverage.prototype.boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log( <span class="string">'æŠŠæ°´ç…®æ²¸'</span> );</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Beverage.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;; <span class="comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span></div><div class="line">Beverage.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å®šä¹‰å­ç±»çš„å‡½æ•°æ‰§è¡Œé¡ºåº</span></div><div class="line">	<span class="keyword">this</span>.boilWater();</div><div class="line">	<span class="keyword">this</span>.brew();</div><div class="line">	<span class="keyword">this</span>.pourInCup();</div><div class="line">	<span class="keyword">this</span>.addCondiments();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ‰äº†çˆ¶ç±»çš„æ¨¡æ¿ï¼Œåœ¨ç…®èŒ¶æ˜¯å°±ä¾ç…§çˆ¶ç±»çš„æ¨¡æ¿æ¥ä½¿ç”¨ï¼Œé€šç”¨éƒ¨åˆ†ä¸åŠ¨ï¼Œç‰¹æ®Šçš„åœ°æ–¹é‡å†™çˆ¶ç±»çš„æ–¹æ³•</p>
<p>èŒ¶å¶å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ¨¡æ¿</p>
<pre><code>var Tea = function(){}; //å®šä¹‰ç…®èŒ¶å­ç±»
Tea.prototype = new Beverage(); //ç»§æ‰¿çˆ¶ç±»
Tea.prototype.brew = function(){ //é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&apos; );
};
Tea.prototype.pourInCup = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;æŠŠèŒ¶å€’è¿›æ¯å­&apos; );
};
Tea.prototype.addCondiments = function(){ é‡å†™çˆ¶ç±»æ–¹æ³•
    console.log( &apos;åŠ æŸ æª¬&apos; );
};
var tea = new Tea(); //å®ä¾‹åŒ–å­ç±»
tea.init(); //ä¾ç…§çˆ¶ç±»çš„æ–¹æ³•æ‰§è¡Œé¡ºåºæ¥æ‰§è¡Œ

//ç”±äºjavascriptçš„å¯¹è±¡åŸå‹ç»§æ‰¿é“¾çš„æ–¹å¼å’Œjavaçš„ç»§æ‰¿æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¿™é‡Œä»£ç ç»“æ„å’Œjavaç±»ä¼¼ï¼Œä½†æ˜¯é‡Œé¢çš„æœºåˆ¶æ˜¯ä¸åŒçš„

<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line"></div><div class="line"><span class="clean">#####é’©å­æ–¹æ³•</span></div><div class="line"></div><div class="line"><span class="number">1.</span> æŠŠæ°´ç…®æ²¸</div><div class="line"><span class="number">2.</span> ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™</div><div class="line"><span class="number">3.</span> æŠŠé¥®æ–™å€’è¿›è¢«å­</div><div class="line"><span class="number">4.</span> åŠ è°ƒæ–™</div><div class="line"></div><div class="line">ä¸Šé¢æ˜¯ä¸€èˆ¬çš„å†²è°ƒé¥®æ–™çš„æµç¨‹ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚æœ‰çš„äººå¯èƒ½ä¸ä¼šåŠ è°ƒæ–™ã€‚é‡åˆ°è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨`é’©å­æ–¹æ³•`æ¥åœ¨éš”ç¦»æœ‰å˜åŒ–çš„æ­¥éª¤</div></pre></td></tr></table></figure>
</code></pre><p>var Beverage = function(){};<br>    Beverage.prototype.boilWater = function(){<br>        console.log( â€˜æŠŠæ°´ç…®æ²¸â€™ );<br>    };<br>    Beverage.prototype.brew = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™brew æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.pourInCup = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™pourInCup æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.addCondiments = function(){<br>        throw new Error( â€˜å­ç±»å¿…é¡»é‡å†™addCondiments æ–¹æ³•â€™ );<br>    };<br>    Beverage.prototype.customerWantsCondiments = function(){<br>        return true; // é»˜è®¤éœ€è¦è°ƒæ–™<br>    };<br>    Beverage.prototype.init = function(){<br>        this.boilWater();<br>        this.brew();<br>        this.pourInCup();<br>    if ( this.customerWantsCondiments() ){ // å¦‚æœæŒ‚é’©è¿”å›trueï¼Œåˆ™éœ€è¦è°ƒæ–™<br>        this.addCondiments(); //ç¬¬å››æ­¥å°±å˜ä¸ºå¯é€‰çš„æ–¹æ³•äº†<br>    }<br>};<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å®ä¾‹åŒ–å†²æ³¡å’–å•¡çš„å®ä¾‹</div></pre></td></tr></table></figure></p>
<p> var CoffeeWithHook = function(){};<br> CoffeeWithHook.prototype = new Beverage();<br>CoffeeWithHook.prototype.brew = function(){<br>    console.log( â€˜ç”¨æ²¸æ°´å†²æ³¡å’–å•¡â€™ );<br>};<br>CoffeeWithHook.prototype.pourInCup = function(){<br>    console.log( â€˜æŠŠå’–å•¡å€’è¿›æ¯å­â€™ );<br>};<br>CoffeeWithHook.prototype.addCondiments = function(){<br>    console.log( â€˜åŠ ç³–å’Œç‰›å¥¶â€™ );<br>};<br>CoffeeWithHook.prototype.customerWantsCondiments = function(){<br>    return window.confirm( â€˜è¯·é—®éœ€è¦è°ƒæ–™å—ï¼Ÿâ€™ );//å¯¹é¡¾å®¢é€‰æ‹©çš„åˆ¤æ–­æ¡ä»¶<br>};<br>var coffeeWithHook = new CoffeeWithHook();</p>
<p>```</p>
<p>æ¨¡æ¿æ–¹æ³•é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptç»„åˆæ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/18/javascript%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ç”±æ›´å°çš„å¯¹è±¡ç»„æˆçš„ã€‚è¿™é‡Œåªæ˜¯ç»„åˆï¼Œå¹¶æ²¡æœ‰ä»å±å…³ç³»ã€‚å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬åç« </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®å‘½ä»¤çš„ä»£ç </span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openPcCommand = &#123; <span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openQQCommand = &#123;<span class="comment">//ä½œä¸ºå¶å¯¹è±¡</span></div><div class="line">		execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//ç»„åˆæ¨¡å¼çš„æ ¹å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;<span class="comment">//å¶å¯¹è±¡ä½œä¸ºæ•°ç»„çš„å…ƒç´ ä¼ é€’åˆ°</span></div><div class="line">			<span class="comment">//æ•°ç»„ä¸­</span></div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰§è¡Œç»„åˆå‘½ä»¤</span></div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute(); <span class="comment">//å¶å¯¹è±¡éƒ½æœ‰executeæ–¹æ³•</span></div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> macroCommand = MacroCommand();</div><div class="line">	macroCommand.add( closeDoorCommand );<span class="comment">//æ·»åŠ åˆ°æ ¹å¯¹è±¡æ•°ç»„ä¸­</span></div><div class="line">	macroCommand.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.add( openQQCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">	macroCommand.execute();<span class="comment">//æ‰§è¡Œæ ¹å‘½ä»¤</span></div></pre></td></tr></table></figure>
<p><em>ä¸¤ä¸ªè¦ç‚¹</em>:1.jså¯¹è±¡å¼•ç”¨å¯ä»¥ä½œä¸ºæ•°ç»„å…ƒç´ åŠ å…¥åˆ°æ•°ç»„ä¸­ã€‚2. å¶å¯¹è±¡éƒ½æœ‰ä¸€æ ·çš„executeæ–¹æ³•ã€‚åœ¨æ ¹å¯¹è±¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨leaf.executeçš„æ¨¡å¼æ¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>åœ¨å¶å¯¹è±¡ä¸­è¿˜å¯ä»¥ç»§ç»­æ‰©å±•ä¹Ÿå¯¹è±¡ï¼Œç»„åˆçš„æ·±åº¦ç»§ç»­åŠ æ·±ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ ¹å¯¹è±¡çš„æ–¹æ³•ä¿æŒä¸å˜</span></div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">commandsList</span>: [],</div><div class="line">			<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">				<span class="keyword">this</span>.commandsList.push( command );</div><div class="line">			&#125;,</div><div class="line">			<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, command; command = <span class="keyword">this</span>.commandsList[ i++ ]; )&#123;</div><div class="line">					command.execute();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> openAcCommand = &#123;</div><div class="line">		<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç©ºè°ƒ'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"><span class="comment">/**********å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤</span></div><div class="line">*********/</div><div class="line"><span class="keyword">var</span> openTvCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç”µè§†'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openSoundCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€éŸ³å“'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand1 = MacroCommand(); <span class="comment">//ç¬¬ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openTvCommand ); <span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand1.add( openSoundCommand );<span class="comment">//åŒä¸Š</span></div><div class="line"><span class="comment">/*********å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½•QQ çš„å‘½ä»¤****************/</span></div><div class="line"><span class="keyword">var</span> closeDoorCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å…³é—¨'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openPcCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€ç”µè„‘'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> openQQCommand = &#123;</div><div class="line">	<span class="attr">execute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ç™»å½•QQ'</span> );</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> macroCommand2 = MacroCommand();<span class="comment">//ç¬¬äºŒä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( closeDoorCommand );<span class="comment">//æ·»åŠ ä¸‹ä¸€çº§å¶å¯¹è±¡</span></div><div class="line">macroCommand2.add( openPcCommand );<span class="comment">//åŒä¸Š</span></div><div class="line">macroCommand2.add( openQQCommand );</div><div class="line"><span class="comment">/*********ç°åœ¨æŠŠæ‰€æœ‰çš„å‘½ä»¤ç»„åˆæˆä¸€ä¸ªâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> macroCommand = MacroCommand(); <span class="comment">//é¡¶çº§æ ¹å¯¹è±¡</span></div><div class="line">macroCommand.add( openAcCommand ); <span class="comment">//ä¸€ä¸ªå¶å¯¹è±¡</span></div><div class="line">macroCommand.add( macroCommand1 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line">macroCommand.add( macroCommand2 ); <span class="comment">//å¦ä¸€ä¸ª</span></div><div class="line"><span class="comment">/*********æœ€åç»™é¥æ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€**********/</span></div><div class="line"><span class="keyword">var</span> setCommand = (<span class="function"><span class="keyword">function</span>(<span class="params"> command </span>)</span>&#123;</div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		command.execute();</div><div class="line">	&#125;</div><div class="line">&#125;)( macroCommand );</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//æœ€ç»ˆæ‰€æœ‰çš„å¶å¯¹è±¡çš„å¼•ç”¨éƒ½æ·»åŠ åˆ°commandlistæ•°ç»„ä¸­ï¼Œåœ¨æ ¹å¯¹è±¡ä¸Šæ‰§è¡Œ</span></div><div class="line"><span class="comment">//executeæ–¹æ³•æ—¶ï¼Œä¼šéå†æ‰€æœ‰çš„å¶å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œleaf.execute()æ–¹æ³•ã€‚</span></div><div class="line"><span class="comment">//å¾—åˆ°ç»“æœ</span></div></pre></td></tr></table></figure>
<p>#####æœ€ç»ˆè¿˜æ˜¯ä½¿ç”¨äº†javascriptçš„æ•°ç»„æ“ä½œå’Œå¯¹è±¡æ“ä½œçš„ä¾¿åˆ©æ€§ã€‚åœ¨javascriptçš„æ¨¡å¼è®¾è®¡ä¸­ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨æ“ä½œæ•°ç»„å’Œå¯¹è±¡ã€‚æ‰€æœ‰æœ‰å¿…è¦è¿˜å¥½åœ¨æ·±åˆ»ç†è§£ä¸€ä¸‹æ•°ç»„å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>è¿™ä¸ªç³»åˆ—å†™äº†å¥½å‡ ç¯‡æ–‡ç« äº†ã€‚å…¶å®å†™çš„æ—¶å€™å¥½å¤šåœ°æ–¹è¿˜ä¸å¤ªæ‡‚ï¼Œå†™ç€å†™ç€æœ‰äº›åœ°æ–¹å°±æ˜ç™½äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦åšæŒå†™ä¸‹å»ã€‚ç°åœ¨è§‰å¾—å†™çš„è¿˜ä¸é”™ï¼Œè¿‡åŠå¹´å¯èƒ½è§‰å¾—å°±å¾ˆå‚»äº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptæ¡¥æ¥æ¨¡å¼(2)]]></title>
      <url>http://yoursite.com/2017/03/17/javascript%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F(2)/</url>
      <content type="html"><![CDATA[<ol>
<li>äº‹ä»¶ç›‘å¬å™¨</li>
<li>æ¡¥æ¥æ¨¡å¼çš„å…¶ä»–ä¾‹å­<br>è¿™å®é™…å°±æ˜¯ä¸€ä¸ªé—­åŒ…çš„ä¾‹å­ï¼Œé€šè¿‡é—­åŒ…å‡½æ•°è·å–å¤–å±‚å‡½æ•°ä½œç”¨åŸŸå†…å®šä¹‰çš„ç§æœ‰å˜é‡ã€‚è¿™ä¸ªå‡½æ•°åˆå¯ä»¥å«åšç‰¹æƒå‡½æ•°ï¼Œgetterå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªgetä¸set.       </li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> <span class="keyword">Public</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">var</span> secret = <span class="number">3</span>;</div><div class="line">  this.privilegedGetter = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> secret;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="keyword">Public</span>;</div><div class="line"><span class="keyword">var</span> data = o.privilegedGetter();</div></pre></td></tr></table></figure>
<p>3 .  ç”¨æ¡¥æ¥æ¨¡å¼è”ç»“å¤šä¸ªç±».é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œå¦‚æœä»£ç ä»ä¸Šå¾€ä¸‹çœ‹æ˜¯èšåˆäº†è¿ä¸ªç±»ã€‚åœ¨æ¡¥æ¥ç±»ä¸­ç»Ÿä¸€è¿”å›ã€‚å¦‚æœæ˜¯ä»ä¸‹å¾€ä¸Šçœ‹ä»£ç ï¼Œå®é™…æ˜¯æŠŠä¸€ä¸ªå®Œæ•´çš„ä»£ç æ‹†æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„ç±»ï¼Œè¿™æ ·ä¸¤ä¸ªç‹¬ç«‹çš„ç±»å¯ä»¥ä¿®æ”¹è‡ªå·±çš„é€»è¾‘ï¼Œä¸ä¼šå½±å“åˆ°å¦ä¸€ç±»çš„å·¥ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">var</span> Class1 = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = a;</div><div class="line">  <span class="keyword">this</span>.b = b;</div><div class="line">  <span class="keyword">this</span>.c = c;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> Class2 = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.d = d;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> BridgeClass = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.one = <span class="keyword">new</span> Class1(a, b, c);</div><div class="line">  <span class="keyword">this</span>.two = <span class="keyword">new</span> Class2(d);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>4 . æ„å»ºXHRè¿æ¥é˜Ÿåˆ—</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptå•ä¾‹æ¨¡å¼(1)]]></title>
      <url>http://yoursite.com/2017/03/16/javascript%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F(1)/</url>
      <content type="html"><![CDATA[<blockquote>
<p>å•ä¾‹(singleton).è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ç§å°†ä»£ç ç»„ç»‡ä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒçš„æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡å•ä¸€å˜é‡æ¥è®¿é—®ã€‚é€šè¿‡ç¡®ä¿å•ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªæ‹·è´ï¼Œå¯ä»¥ç¡®ä¿ä»£ä¹°ä½¿ç”¨ç«¥é¢œçš„å…¨å±€èµ„æºã€‚å•ä¾‹å¯ä»¥ç”¨æ¥åˆ’åˆ†å‘½åç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ©å•ä¾‹æŠŠä»£ç ç»„ç»‡çš„æ›´ä¸ºä¸€è‡´ï¼Œä»è€Œæ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚</p>
</blockquote>
<pre><code>æœ¬æ–‡å‚ç…§è¿™æœ¬ä¹¦ç¬¬äº”ç« ï¼Œä»‹ç»çš„é‡ç‚¹å’Œå¦ä¸€æœ¬ä¹¦å¥½åƒæ˜¯ä¸åŒçš„ã€‚ç»“åˆç€çœ‹çœ‹    
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2044710-c97bcd5773f19459.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="s3398900.jpg"></p>
<p>####å•ä¾‹çš„åŸºæœ¬ç»“æ„<br>æœ€åŸºæœ¬çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯¹è±¡å­—é¢é‡ä½œä¸ºå•ä½“</span></div><div class="line"><span class="keyword">var</span> Singleton = &#123;</div><div class="line">  <span class="attr">attribute1</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">attribute2</span>: <span class="number">10</span>,</div><div class="line"></div><div class="line">  <span class="attr">method1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">method2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Singleton.attribute1 = <span class="literal">false</span>; <span class="comment">//ä¿®æ”¹</span></div><div class="line"><span class="keyword">var</span> total = Singleton.attribute2 + <span class="number">5</span>; <span class="comment">//ä½¿ç”¨å•ä¾‹</span></div><div class="line"><span class="keyword">var</span> result = Singleton.method1();</div></pre></td></tr></table></figure>
<p><code>æ–¹æ³•ä½äºå¯¹è±¡å­—é¢é‡ä¸­å°±æœ‰äº†å‘½åç©ºé—´ï¼Œå’Œå…¶ä»–åŒåçš„å‡½æ•°å°±ä¸ä¼šå†²çªäº†ã€‚å¯¹è±¡å­—é¢é‡é‡Œçš„æ–¹æ³•ç»Ÿä¸€ç”¨  nameSpace.methodçš„æ ¼å¼è°ƒç”¨</code><br>å¯¹è±¡å­—é¢é‡çš„å‘½åç©ºé—´è¿˜å¯ä»¥ç»§ç»­åˆ’åˆ†ä¾‹å¦‚parent.children.methodã€‚<br>è¿™æ ·ä¸ä»…å˜é‡å‘ç”Ÿå†²çªçš„æœºä¼šå¤§å¤§å‡å°‘ï¼Œè€Œä¸”å½’å±æ›´æ˜ç¡®äº†ã€‚</p>
<p>ä¸Šé¢çš„å¯¹è±¡å­—é¢é‡çš„å•ä¾‹æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Ÿ åœ¨nodeç¨‹åºä¸­çš„é…ç½®æ–‡ä»¶config.jsé‡Œé¢æ˜¯ä¸æ˜¯éƒ½æ˜¯è¿™ç§ä»£ç ï¼Ÿ é…ç½®é¡¹éƒ½æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚</p>
<p>#####æƒ°æ€§å®ä¾‹åŒ–<br>æœ¬æ¥å•ä¾‹æ˜¯æƒ³å†™è¿™ä¸ªå†…å®¹çš„ï¼Œä½†æ˜¯ä»Šå¤©ä¸€çœ‹ï¼Œè¿˜æ˜¯æ²¡çœ‹å…¨ã€‚æ›¾æ¢çš„jsæ¨¡å¼ä¹¦é‡Œçš„å•ä¾‹å…¶å®éƒ½æ˜¯è¿™ä¸ªéƒ¨åˆ†ã€‚<code>å®é™…çš„å•ä¾‹ä»£ç æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥ç¼“å­˜å®ä¾‹åŒ–çš„ä»£ç ï¼Œå¦‚æœå·²ç»å®ä¾‹åŒ–å°±ç›´æ¥è¿”å›ç¼“å­˜çš„ä»£ç ã€‚</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">  MyNamespace.Singleton = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">var</span> uniqueInstance; <span class="comment">// ç§æœ‰å˜é‡ç¼“å­˜å®ä¾‹åŒ–å•ä¾‹</span></div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">constructor</span>(<span class="params"></span>) </span>&#123; <span class="comment">// å…·ä½“éœ€è¦æŒ‰éœ€åŠ è½½çš„ä»£ç .</span></div><div class="line">    <span class="keyword">var</span> privateAttribute1 = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">var</span> privateAttribute2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod2</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">      ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123; <span class="comment">// Public members.</span></div><div class="line">      publicAttribute1: <span class="literal">true</span>,</div><div class="line">      <span class="attr">publicAttribute2</span>: <span class="number">10</span>,</div><div class="line">    </div><div class="line">      <span class="attr">publicMethod1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">publicMethod2</span>: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">        ...</div><div class="line">      &#125;</div><div class="line">    &#125;  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">getInstance</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>(!uniqueInstance) &#123; <span class="comment">// å•ä¾‹è‹¥ä¸å­˜åœ¨ï¼Œè°ƒç”¨constructorå‡½æ•°</span></div><div class="line">        uniqueInstance = <span class="keyword">constructor</span>(); //è°ƒç”¨<span class="keyword">constructor</span>å‡½æ•°åï¼Œç¼“å­˜è¿”å›å€¼</div><div class="line">      &#125;</div><div class="line">      return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-ä½¿ç”¨Reactæ„å»ºä½ çš„App]]></title>
      <url>http://yoursite.com/2017/03/12/%E7%BF%BB%E8%AF%91-%E4%BD%BF%E7%94%A8React%E6%9E%84%E5%BB%BA%E4%BD%A0%E7%9A%84App/</url>
      <content type="html"><![CDATA[<blockquote>
<p>è¿™ç¯‡æ–‡ç« æ—¶é—´æœ‰ç‚¹ä¹…è¿œ,ç¿»è¯‘è¯•è¯•çœ‹.ä½†æ˜¯æœ¬ç¯‡æ–‡ç« å¯¹äºReactçš„æ¸²æŸ“å·¥ä½œåŸç†è®²çš„æ¯”è¾ƒå¥½,ä½¿ç”¨ä¸€ä¸ªæ¸¸æˆå¼•æ“çš„æ¸²æŸ“æ–¹å¼æ¥ç±»æ¯”è§£é‡ŠReactçš„æ•°æ®æµç¨‹,å€¼å¾—å­¦ä¹ . <a href="http://konkle.us/architecting-your-app-react-part-1/" target="_blank" rel="external">åŸæ–‡åœ¨è¿™é‡Œ</a></p>
</blockquote>
<p>å»å¹´äº”æœˆ(2013å¹´5æœˆ),Facebookå‘å¸ƒäº†æ„å»ºå‰ç«¯ç»„ä»¶åº“çš„å¼€æºè½¯ä»¶-React.Reactå¯¹äºæµè§ˆå™¨å’Œappçš„ç»“æ„æ¥è¯´æœ‰ç‚¹å¼‚ç±».ä½†æ˜¯ç»è¿‡è¿™æ®µæ—¶é—´,å¼€å‘è€…é€æ¸çœ‹åˆ°äº†ä¸€äº›ä¼˜åŠ¿,Reactä¹Ÿå› æ­¤è·å–äº†å¾ˆå¤šçš„äººæ°”.Reactæœ€ä¸ºç›¸åŠ©çš„é¢ç‰¹å¾æ˜¯å¼•å…¥äº†virtual-DOMæ–¹æ³•,virtual-DOMä½¿å®é™…çš„æµè§ˆå™¨çš„DOMå˜åŒ–å‡åˆ°æœ€ä½,DOMçš„æ¸²æŸ“æ€§èƒ½å¤§å¹…æé«˜.</p>
<p>Reactå¹¶ä¸æ˜¯å®Œæ•´çš„MVCæ¡†æ¶,Reactå®é™…æ˜¯MVCçš„åŠ å¼ºç‰ˆ(è¿™ç‚¹,çœŸæ˜¯é›ªä¸­é€ç‚­,ä¸€ç›´éƒ½å¯¹è¿™ä¸ªæ¡†æ¶åˆ°åº•æ˜¯ä¸æ˜¯MVCè€Œå¿ƒå­˜ç–‘è™‘).å¾ˆå¤šå¼€å‘è€…é€‰æ‹©Reactä½œä¸ºMVCæ¡†æ¶çš„å»¶ä¼¸,ä¾‹å¦‚Backbone.Reactæœ¬èº«å¹¶æ²¡æœ‰è·¯ç”±å’Œæ•°æ®åŒæ­¥çš„å†…å®¹,æ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨å–œæ¬¢çš„å·¥å…·æ¥å®Œæˆç±»ä¼¼çš„åŠŸèƒ½.Reactä¹Ÿå¯ä»¥åœ¨å…¶ä»–çš„åº”ç”¨ä¸­ç®¡ç†ä¸€éƒ¨åˆ†ç‰¹å®šçš„ç»„ä»¶.ä½†æ˜¯å¦‚æœåœ¨åº”ç”¨çš„ç•Œé¢ä¸Šå…¨é¢ä½¿ç”¨React,å‘æŒ¥çš„åŠŸèƒ½ä¼šæ›´å¤§.</p>
<p>#####å°½å¯èƒ½çš„é¿å…DOM<br>Reactä½œä¸ºjavascriptçš„ä¸€ä¸ªç±»,æä¾›virtual-DOMå®æ–½æ–¹æ¡ˆ.è¿™æ„å‘³ç€ä½ å¯ä»¥é¢‘ç¹çš„æ›´æ–°ä½ çš„åº”ç”¨ç¨‹åºçš„å…ƒç´ æ ‘,ä½†æ˜¯å®é™…ä¸Šæ²¡æœ‰å‘ç”Ÿæµè§ˆå™¨çš„DOMæ“ä½œ.ç”±äºä½¿ç”¨äº†ç°ä»£çš„å¼•æ“,Javascriptçš„é€Ÿåº¦ç›¸å½“å¿«.å®é™…ç”±äºå¼•æ“çš„é€Ÿåº¦å¾ˆå¿«,å½“æ¯ä¸€æ¬¡æ•°æ®æ›´æ–°çš„æ—¶å€™,æ¸²æŸ“åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å¯ä»¥çš„,å‡å°‘äº†å®æ—¶å…ƒç´ æ“ä½œå’ŒåŒå‘æ•°æ®ç»‘å®šçš„éœ€æ±‚.Reactå‘¨æœŸæ€§çš„æ¯”è¾ƒvirtual-DOMå’Œæµè§ˆå™¨DOM,ä»…ä»…åšå‡ºæœ€æœ‰å¿…è¦çš„DOMåŒæ­¥.</p>
<p>#####å•å‘æ•°æ®æµ<br>å½“HTMLå…ƒç´ çš„æ¸²æŸ“èŠ±é”€å¤§å¹…åº¦é™ä½ä»¥å,ä½ ç°åœ¨éœ€è¦èŠ±è´¹æ›´å¤šçš„çš„æ–¹æ³•æ¥ç®¡ç†ä½ çš„ç•Œé¢.æ”¾å¼ƒé”™ç»¼å¤æ‚çš„å°±åœ°æ›´æ–°å…ƒç´ æ“ä½œå’Œæ•°æ®å˜åŒ–ä¸­çš„çš„å¤šä¸ªstateçš„åŒæ­¥,ä½ å¯ä»¥æŠŠçŠ¶æ€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹,åŸºäºé›†ä¸­çš„stateæ¥æè¿°ä½ çš„ç•Œé¢.åªè¦çŠ¶æ€ä»¥æ”¹å˜,Reactçš„ç»„ä»¶å°±å¯ä»¥è¿›è¡Œæ›´æ–°æ“ä½œ.<br>å½“ä½ çš„æ•´ä¸ªåº”ç”¨éƒ½åŸºäºè¿™ä¸ªæ€æƒ³æ¥è®¾è®¡,ä½ å¯ä»¥æŠŠimmutable æ•°æ®ä»é¡¶å±‚ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶,ç„¶åæ‰§è¡Œè‡ªé¡¶å‘ä¸‹çš„åº”ç”¨æ›´æ–°.Reactä»æ ¹æœ¬ä¸Šæ”¹å˜äº†ä½ å¯¹åº”ç”¨çš„æ€è·¯,è€Œä¸”ç»å¸¸ä¼šç®€åŒ–åº”ç”¨çš„è®¾è®¡.</p>
<p>#####æµè§ˆå™¨ä½œä¸ºæ¸²æŸ“å¼•æ“<br>è¿™ä¸€ç‚¹æ˜¯å¯¹MVCæ¡†æ¶éå¸¸æ¿€è¿›çš„æ”¹å˜,å®ƒå¼ºè°ƒä½¿ç”¨åŒå‘æ•°æ®ç»‘å®š,å°½å¯èƒ½å¤šè‡ªåŠ¨å°±åœ°é‡æ–°æ¸²æŸ“.å½“æˆ‘åˆšå¼€å§‹äº†è§£Reactçš„æ—¶å€™,æˆ‘è¿˜ä¸æ˜¯å¤ªç¡®å®š.è½¬æŠ˜ç‚¹æ˜¯æˆ‘çœ‹äº†ä¸€ä¸ªPete Huntçš„è§†é¢‘:æ¯”è¾ƒReactå’ŒDoom3æ¸²æŸ“å¼•æ“.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-a1553d287e86aebb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="doom3çš„æ¸²æŸ“ç¤ºæ„å›¾"><br>åœ¨å›¾è¡¨ä¸­,æ¸¸æˆçš„sateç»è¿‡åº•å±‚çš„å›¾å½¢ä»£ç å¯¼å…¥å‰ç«¯é€»è¾‘å’ŒæŠ½è±¡å±‚.è¿™ä¸ªæ“ä½œä¼šåˆ›å»ºä¸€ä¸ªâ€œåœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚â€(scene intermediate representation),è¿™ä¸ªè¡¨ç¤ºå±‚è¡¨ç°å‡ºç”¨æˆ·åº”è¯¥çœ‹åˆ°çš„å†…å®¹.è¿™ä¸ªè¡¨ç¤ºå±‚ä¼šä¼ é€’ç»™â€backendâ€(åç«¯),åç«¯æ¥æ”¶è¡¨ç¤ºå±‚å†…å®¹,éšä¹‹è½¬æ¢ä¸ºOpenGLæ“ä½œ,OpenGLä½¿ç”¨å›¾å½¢å¡(ç”µè„‘æ˜¾å¡)æ¸²æŸ“å‡ºå†…å®¹.Reactçš„å·¥ä½œåŸç†å’ŒDoom3çš„æ¸²æŸ“æ–¹å¼æ˜¯ä¸€æ ·çš„.(doom3æ˜¯æ—©æœŸä¸€æ¬¾æ¯”è¾ƒè‘—åçš„ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆ,è¿™é‡Œä½¿ç”¨doom3çš„å›¾å½¢æ¸²æŸ“æ–¹å¼æ¥è¯´æ˜Reactçš„å·¥ä½œæ–¹å¼).</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-73a98731bc9d6411.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Reactç»„ä»¶æ¸²æŸ“"></p>
<p>å½“ç¨‹åºçš„stateç”±äºæµè§ˆå™¨æˆ–è€…å®æ—¶äº‹ä»¶å‘ç”Ÿå˜åŒ–,Reactç¨‹åºæ¥æ”¶è¿™äº›å˜åŒ–,å¹¶ä¸”ä¼ é€’ç»™ç»„ä»¶ä»¬,æ¥ç€ä½¿ç”¨virtual-DOMæ–¹å¼ç”Ÿæˆä¸­é—´è¡¨ç¤ºå±‚.æµè§ˆå™¨çš„DOMå¹¶ä¸ä¼šå‘ç”Ÿç«‹å³çš„å˜åŒ–.ç„¶è€ŒReactä¼šå‘¨æœŸæ€§çš„æ¥æ”¶virtual DOM,è®¡ç®—å‡ºå¿…è¦çš„DOMæ“ä½œ.è¿™ä¸€ç‚¹å’Œæ¸¸æˆå¼•æ“æ¥å—åœºæ™¯ä¸­é—´è¡¨ç¤ºå±‚,å†³å®šæ˜¯å¦ä½¿ç”¨OpenGLæ¸²æŸ“åœºæ™¯ç±»ä¼¼.Reactæ˜¯æ¥æ”¶DOM,æŠŠå®ƒæ¸²æŸ“åˆ°ç”¨æˆ·å±å¹•ä¸Š.(å¯è§ä¸¤è€…æ¸²æŸ“çš„æ€è·¯æ˜¯ä¸€æ ·çš„,Reactä½¿ç”¨äº†æµè§ˆå™¨æ¥åšè¿™ä¸ªå·¥ä½œ).</p>
<p>æµè§ˆå™¨å’Œæ¸¸æˆå¼•æ“ä¸€æ ·,æœ€æ…¢çš„éƒ¨åˆ†å®é™…æ˜¯ä¸­é—´è¡¨ç¤ºå±‚åˆ°å±å¹•çš„æ¸²æŸ“éƒ¨åˆ†.ä½ å¯ä»¥å¯¹virtual-DOMåšå‡ºè®¸å¤šç»†å°çš„æ”¹å˜,Reactä¼˜åŒ–äº†è¿™ä¸ªéƒ¨åˆ†,æ‰€ä»¥ä¸ä¼šå› æ­¤è€Œç‰ºç‰²æ¸²æŸ“çš„æ€§èƒ½.</p>
<p>#####æ›´å¤šçš„èµ„æº<br>åœ¨ç¬¬äºŒéƒ¨åˆ†,æˆ‘å°†ä¼šæ¼”ç¤ºæ€ä¹ˆæŠŠReactçš„è®¾è®¡å“²å­¦ä»˜è¯¸å®è·µ.æˆ‘ä¼šåˆ†äº«æ€ä¹ˆæ›´å…·ä¸åŒçš„åŠŸèƒ½è´£ä»»,æ¸²æŸ“ä¸€ä¸ªç”±å°ç»„ä»¶ç»„æˆçš„é¡¶çº§ç»„ä»¶çš„ç•Œé¢.æˆ‘ä¹Ÿä¼šæ¼”ç¤ºæ€ä¹ˆåœ¨Reactåº”ç”¨ä¸­æ•´åˆè·¯ç”±åŠŸèƒ½å’Œæ•°æ®åŒæ­¥åŠŸèƒ½.</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„Reactå†…å®¹,æƒ³çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„,çœ‹çœ‹ä¸‹é¢çš„èµ„æºåˆ—è¡¨.</p>
<ul>
<li><a href="http://facebook.github.io/react/" target="_blank" rel="external">Reactä¸»é¡µ</a></li>
<li><a href="http://facebook.github.io/react/docs/videos.html" target="_blank" rel="external">è§†é¢‘</a></li>
<li><a href="http://facebook.github.io/react/docs/examples.html" target="_blank" rel="external">å®ä¾‹</a></li>
<li><a href="https://groups.google.com/forum/#!forum/reactjs" target="_blank" rel="external">React Google Group</a></li>
<li>#reactjs on Freenode-å®˜æ–¹ IRCé¢‘é“,æ¯”è¾ƒæ´»è·ƒ</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptä»£ç†æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/12/javascript%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>ä»£ç†æ¨¡å¼æ˜¯ç»™å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®<br>   å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<p><code>ç¼“å­˜ä»£ç†</code></p>
<p>  ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€æ¯”è¾ƒå¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œä¸‹ä¸€æ¬¡è¿ç®—æ—¶å¦‚æœä¼ é€’å‚æ•°å’Œç¼“å­˜çš„å‚æ•°ä¸€è‡´ï¼Œåˆ™å¯æ˜¯ç›´æ¥è¿”å›å‰é¢å­˜å‚¨çš„è¿ç®—ç»“æœ</p>
<p>è®¡ç®—ä¹˜ç§¯çš„å®ä¾‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//é»˜è®¤ä¼ é€’çš„argumentså‚æ•°åˆ—è¡¨</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹è®¡ç®—ä¹˜ç§¯'</span> );</div><div class="line">		<span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++ )&#123;</div><div class="line">			a = a * <span class="built_in">arguments</span>[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> a;</div><div class="line">	&#125;;</div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span> ); <span class="comment">// è¾“å‡ºï¼š6</span></div><div class="line">	mult( <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24</span></div><div class="line">	<span class="comment">//ç°åœ¨åŠ å…¥ç¼“å­˜ä»£ç†å‡½æ•°ï¼š</span></div><div class="line"></div><div class="line">	<span class="keyword">var</span> proxyMult = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> cache = &#123;&#125;;  <span class="comment">//ç¼“å­˜å¯¹è±¡</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.join.call( <span class="built_in">arguments</span>, <span class="string">','</span> ); </div><div class="line">			<span class="keyword">if</span> ( args <span class="keyword">in</span> cache )&#123; <span class="comment">//å¦‚æœåˆå¹¶çš„å‚æ•°åœ¨ç¼“å­˜ä¸­</span></div><div class="line">				<span class="keyword">return</span> cache[ args ]; <span class="comment">//ç›´æ¥åˆ†ä¼šç¼“å­˜æ•°æ®</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> cache[ args ] = mult.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> ); </div><div class="line">                        <span class="comment">//è°ƒç”¨å‡½æ•°ä¹‹åå­˜å‚¨åˆ°ç¼“å­˜å¯¹è±¡ä¸­</span></div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line"></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24  //ç¬¬ä¸€æ¬¡è®¡ç®—</span></div><div class="line">	proxyMult( <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ); <span class="comment">// è¾“å‡ºï¼š24 //ç¬¬äºŒæ¬¡è®¡ç®—ï¼Œç›´æ¥å­˜ç¼“å­˜ä¸­è·å–</span></div><div class="line"></div><div class="line"><span class="comment">//è¿™é‡Œçš„ä¸¤ä¸ªå‡½æ•°ï¼Œmultiè´Ÿè´£è®¡ç®—ï¼ŒproxyMultiè´Ÿè´£ç¼“å­˜çš„å­˜å‚¨å’Œè¯»å–ã€‚</span></div><div class="line"><span class="comment">//ä¸¤ä¸ªå‡½æ•°åˆ†åŠŸèƒ½å®Œæˆå¯¹åº”çš„åŠŸèƒ½</span></div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptå¼€æ”¾-å°é—­åŸåˆ™-NBAå¸¸è§„èµ›ç»“æŸ]]></title>
      <url>http://yoursite.com/2017/03/11/javascript%E5%BC%80%E6%94%BE-%E5%B0%81%E9%97%AD%E5%8E%9F%E5%88%99-NBA%E5%B8%B8%E8%A7%84%E8%B5%9B%E7%BB%93%E6%9D%9F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åœ¨é¢å‘å¯¹è±¡ç¨‹åº(OOP)è®¾è®¡ä¸­ï¼Œå¼€æ”¾-å°é—­åŸåˆ™(OCP)æ˜¯æœ€é‡è¦çš„åŸåˆ™ï¼Œä¸€ä¸ªoopçš„ç¨‹åºå…·æœ‰è‰¯å¥½çš„è®¾è®¡ï¼Œå¾€å¾€è¯´æ˜å®ƒæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™çš„.<br>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬20ç« <br>é¦–å…ˆçœ‹ä¸€ä¸ªä»£ç .å¼€æ”¾å°é—­æ˜¯ç›¸äº’å…³è”çš„åœ¨ä¸€æ®µä»£ç ä¸­æ—¢è¦ä½“ç°å°é—­åˆè¦ä½“ç°å¼€æ”¾ã€‚å°é—­ä¸ç ´åæ—§åŠŸèƒ½ï¼Œå¼€æ”¾æœ‰å¯ä»¥æ·»åŠ æ–°åŠŸèƒ½ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸ªå‡½æ•°æ˜¯ä¿®é¥°æ¨¡å¼ï¼Œåœ¨å‡½æ•°è¿è¡Œåæ·»åŠ åŠŸèƒ½</span></div><div class="line"><span class="comment">//é€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œæ·»åŠ çš„åŠŸèƒ½ä¸å½±å“åŸå‡½æ•°çš„åŠŸèƒ½</span></div><div class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			<span class="keyword">return</span> ret;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="comment">//å¦‚æœå¤šäººå¼€å‘ï¼Œéƒ½è¦åœ¨window.onloadä¸‹æŒ‚è½½å‡½æ•°åŠŸèƒ½(åŸç”Ÿçš„jsä»£ç </span></div><div class="line">	<span class="comment">//åªèƒ½åŠ è½½ä¸€æ¬¡window.loadå‡½æ•°)ã€‚å¾ˆæœ‰å¯èƒ½åˆ«äººä¹Ÿåœ¨ä½¿ç”¨.</span></div><div class="line">	<span class="comment">//è¦è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ç»“åˆafterå‡½æ•°å’Œå‡½æ•°å¼•ç”¨èµ‹å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜</span></div><div class="line">	<span class="comment">//å¦‚æœwindoW.loadå·²ç»æŒ‚è½½æœ‰å†…å®¹ï¼Œå°±å¼•ç”¨èµ‹å€¼ï¼Œç„¶åä½¿ç”¨after</span></div><div class="line">	<span class="comment">//å¦‚æœæ²¡æœ‰ä½¿ç”¨åˆ™ç›´æ¥å¼•ç”¨ç©ºå‡½æ•°å¯¹è±¡ï¼Œç„¶åæŒ‚è½½afterå‡½æ•°</span></div><div class="line">	<span class="comment">//æ— è®ºå“ªç§æƒ…å†µï¼Œé€šè¿‡afterå‡½æ•°çš„</span></div><div class="line">	<span class="built_in">window</span>.onload = ( <span class="built_in">window</span>.onload || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125; ).after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="built_in">document</span>.getElementsByTagName( <span class="string">'*'</span> ).length );</div><div class="line">	&#125;);</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨å¼€æ”¾-å°é—­åŸåˆ™å¾ˆå›°éš¾ï¼Œå…³é”®æ˜¯è¦æ‰¾åˆ°ç¨‹åºåœ¨å“ªé‡Œå‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸æ˜¯ä¸€æœä¸€å¤•ä¹‹åŠŸã€‚æ‰€ä»¥é“ç†å¾ˆç®€å•ï¼Œä½†æ˜¯åº”ç”¨èµ·æ¥å¯èƒ½å¾ˆå›°éš¾ã€‚é•¿è·¯æ¼«æ¼«å•Šã€‚</p>
<p>è‡³æ­¤æœ¬äººåŸºæœ¬æŠŠjavascriptçš„æ¨¡å¼è®¾è®¡çš„å†…å®¹è¿‡äº†ä¸€éã€‚å¯ä»¥è¯´æ”¶è·è‰¯å¤šï¼Œå­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚é˜…è¯»ä»£ç å’Œåˆ†æä»£ç çš„èƒ½åŠ›æœ‰äº†æé«˜ï¼Œå¥½åƒæ˜¯åœ¨NBAçš„èµ›åœºä¸Šï¼Œé€šè¿‡è§£è¯´å‘˜çš„ä¸€äº›æˆ˜æœ¯åˆ†æï¼Œæ…¢æ…¢çœ‹æ˜ç™½äº†ä¸€äº›è·‘ä½å’Œæˆ˜æœ¯ï¼Œå¯¹äºä¸€ä¸ªçƒè¿·æ¥è¯´åœ¨è¿™ç§æƒ…å†µä¸‹çœ‹æ¯”èµ›å°±ä¸å…‰å…‰æ˜¯çœ‹çƒ­é—¹äº†ï¼Œæ¯”èµ›æœ‰äº†æ›´æ·±å±‚æ¬¡çš„æ„ä¹‰ï¼Œæ­¤æ—¶çš„å¿ƒæƒ…å°±æ˜¯æœ‰æƒ³çœ‹æ›´å¤šæ¯”èµ›æ¥éªŒè¯ä¸‹ä¸€åœºæ¯”èµ›æ˜¯å¦ä¹Ÿä¼šå‡ºç°åŒæ ·çš„æˆ˜æœ¯ã€‚<br>ä½†è¿™ä¹Ÿåªæ˜¯ä¸€ä¸ªèµ·ç‚¹è€Œå·²ï¼Œè¿‡ä¸€å¹´è‚¯èƒ½ä¼šè§‰å¾—ç°åœ¨å†™çš„è¿™äº›æ–‡ç« å¾ˆå¹¼ç¨šå¾ˆå‚»æ¯”ã€‚å°±æ‹¿è¿™äº›å­¦ä¹ ç¬”è®°è®°å½•è¿™ä¸ªå‚»é€¼çš„è¿‡ç¨‹å§.</p>
<p>NBAå¸¸è§„èµ›ç»“æŸäº†ï¼Œè¿˜æœ‰å­£åèµ›å’Œä¸‹ä¸€èµ›å­£ç­‰ç€å‘¢ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptå·¥å‚æ¨¡å¼-XHRå·¥å‚]]></title>
      <url>http://yoursite.com/2017/03/11/javascript%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-XHR%E5%B7%A5%E5%8E%82/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2044710-f56a2c10764090f7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="s3398900.jpg"></p>
<blockquote>
<p>ä¸€ä¸ªç±»æˆ–å¯¹è±¡ä¸­å¾€å¾€åŒ…æ‹¬åˆ«çš„å¯¹è±¡ã€‚åœ¨åˆ›å»ºè¿™ç§æˆå‘˜å¯¹è±¡æ—¶ï¼Œä½ å¯èƒ½ä¹ æƒ¯äºä½¿ç”¨å¸¸è§„æ–¹å¼ï¼Œå³ç”¨newå…³é”®å­—å’Œç±»æ„é€ å‡½æ•°ã€‚é—®é¢˜æ˜¯è¿™æ ·ä¼šå¯¼è‡´ä¸¤ä¸ªç±»ä¹‹é—´äº§ç”Ÿä¾èµ–æ€§ã€‚é€šè¿‡å·¥å‚æ¨¡å¼å¯ä»¥æ¶ˆé™¤ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»–ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•æ¥å†³å®šç©¶ç«Ÿè¦å®ä¾‹åŒ–å“ªä¸ªç±»ã€‚å‚ç…§ä¸Šå›¾é‚£æœ¬ä¹¦ï¼Œç¬¬7ç« å†…å®¹</p>
</blockquote>
<p>#####XHRå·¥å‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> AjaxHandler = <span class="keyword">new</span> Interface(<span class="string">'AjaxHandler'</span>, [<span class="string">'request'</span>, <span class="string">'createXhrObject'</span>]);</div><div class="line"></div><div class="line"><span class="comment">/* SimpleHandler class. */</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> SimpleHandler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// implements AjaxHandler</span></div><div class="line">SimpleHandler.prototype = &#123;</div><div class="line">  <span class="comment">//requestå‡½æ•°è´Ÿè´£æ‰§è¡Œå‘å‡ºçš„è¯·æ±‚å’Œå¤„ç†ç›¸åº”ç»“æœæ‰€éœ€çš„ä¸€ç³»åˆ—æ“ä½œ</span></div><div class="line">  <span class="comment">//ä»–å…ˆä½¿ç”¨createXhrObject()å‡½æ•°å¹¶å¯¹å…¶è¿›è¡Œé…ç½®ï¼Œç„¶åå‘é€è¯·æ±‚</span></div><div class="line">  request: <span class="function"><span class="keyword">function</span>(<span class="params">method, url, callback, postVars</span>) </span>&#123;</div><div class="line">    <span class="comment">//é¦–æ¬¡è¿è¡Œæˆ–è€…æ˜¯æ²¡æœ‰è·å¾—XHRå¯¹è±¡æ—¶æ‰§è¡Œå…·ä½“çš„æ–¹æ³•ã€‚</span></div><div class="line">    <span class="comment">//ä¸€æ—¦è·å–äº†XHRå¯¹è±¡ï¼Œå°±ä¼šç¼“å­˜èµ·æ¥ï¼Œåç»­æ‰§è¡Œç›´æ¥ä»å˜é‡å¼•ç”¨ä¸­è·å–XHRå¯¹è±¡</span></div><div class="line">    <span class="keyword">var</span> xhr = <span class="keyword">this</span>.createXhrObject();</div><div class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span>(xhr.readyState !== <span class="number">4</span>) <span class="keyword">return</span>;</div><div class="line">      (xhr.status === <span class="number">200</span>) ? </div><div class="line">        callback.success(xhr.responseText, xhr.responseXML) : </div><div class="line">        callback.failure(xhr.status);</div><div class="line">    &#125;;</div><div class="line">    xhr.open(method, url, <span class="literal">true</span>);</div><div class="line">    <span class="keyword">if</span>(method !== <span class="string">'POST'</span>) postVars = <span class="literal">null</span>;</div><div class="line">    xhr.send(postVars);</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">//createXhrObject()è¿™ä¸ªå·¥å‚æ–¹æ³•æ ¹æ®å½“å‰å…·ä½“ç¯å¢ƒè¿”å›ä¸€ä¸ªXHRå¯¹è±¡</span></div><div class="line">  <span class="comment">//é¦–æ¬¡æ‰§è¡Œæ—¶ï¼Œä»–ä¼šä¾æ¬¡å°è¯•æ‰§è¡Œä¸‰ç§ç”¨äºåˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•ï¼Œä¸€æ—¦é‡åˆ°</span></div><div class="line">  <span class="comment">//ç®¡ç”¨çš„ï¼Œä»–å°±ä¼šè¿”å›æ‰€åˆ›å»ºçš„å¯¹è±¡ï¼ŒåŒæ—¶æŠŠè‡ªå·±ä¹Ÿæ”¹ä¸ºè¿”å›çš„é‚£ä¸ªå¯¹è±¡</span></div><div class="line">  createXhrObject: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//å·¥å‚æ–¹æ³•.</span></div><div class="line">    <span class="keyword">var</span> methods = [<span class="comment">//ä¸‰ç§åˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•ç»„æˆæ•°ç»„</span></div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest(); &#125;,</div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>); &#125;,</div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>); &#125;</div><div class="line">    ];</div><div class="line">    <span class="comment">//ä¸‹é¢éå†æ•°ç»„æ–¹æ³•ï¼Œå°è¯•è·å¾—XHRå¯¹è±¡</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = methods.length; i &lt; len; i++) &#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        methods[i](); <span class="comment">//å°è¯•è·å¾—XHRå¯¹è±¡</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">catch</span>(e) &#123;</div><div class="line">        <span class="keyword">continue</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// If we reach this point, method[i] worked.</span></div><div class="line">      <span class="comment">//å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œæ•°ç»„ä¸­æœ‰æ–¹æ³•å¯ä»¥åˆ›å»ºXHRå¯¹è±¡</span></div><div class="line">      <span class="keyword">this</span>.createXhrObject = methods[i]; <span class="comment">//ç›´æ¥æŠŠå¯¹è±¡ç»™ç¬¬ä¸€ç§å¯ä»¥è·å–</span></div><div class="line"><span class="comment">//å¯¹è±¡çš„æ–¹æ³•ï¼Œç¼“å­˜èµ·æ¥      </span></div><div class="line">        <span class="keyword">return</span> methods[i];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// If we reach this point, none of the methods worked.</span></div><div class="line">    <span class="comment">//å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œè¡¨ç¤ºæ²¡æœ‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼ŒæŠ›å‡ºé”™è¯¯</span></div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'SimpleHandler: Could not create an XHR object.'</span>);</div><div class="line">  &#125; </div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/* Usage. å…·ä½“çš„ä½¿ç”¨æ–¹æ³•*/</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> myHandler = <span class="keyword">new</span> SimpleHandler(); <span class="comment">//çœ‹ä¸åˆ°å·¥å‚åŒ–çš„è¿‡ç¨‹</span></div><div class="line"><span class="keyword">var</span> callback = &#123; </div><div class="line">  <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">responseText</span>) </span>&#123; alert(<span class="string">'Success: '</span> + responseText); &#125;, </div><div class="line">  <span class="attr">failure</span>: <span class="function"><span class="keyword">function</span>(<span class="params">statusCode</span>) </span>&#123; alert(<span class="string">'Failure: '</span> + statusCode); &#125; </div><div class="line">&#125;;</div><div class="line">myHandler.request(<span class="string">'GET'</span>, <span class="string">'script.php'</span>, callback);</div></pre></td></tr></table></figure>
<p>createXhrObject()è¿™ä¸ªå‡½æ•°å°±æ˜¯å¯¹è±¡å·¥å‚æ–¹æ³•ï¼Œç”±äºéœ€è¦è€ƒè™‘åˆ°ä¸åŒæµè§ˆå™¨å¯¹äºajaxå¯¹è±¡çš„å·®å¼‚æ€§ï¼Œåœ¨è·å–XHRå¯¹è±¡æ˜¯æœ‰æ ¹æ®ä¸åŒçš„æ¡ä»¶æ¥è¿›è¡Œã€‚ä½†æ˜¯è¿™ä¸ª<code>æ ¹æ®ä¸åŒæ¡ä»¶å®ä¾‹åŒ–XHRå¯¹è±¡çš„æ–¹æ³•</code>å’Œå®é™…çš„<code>ajaxè¯·æ±‚æ–¹æ³•</code>æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ã€‚æ‰€ä»¥åœ¨è¿™é‡ŒæŠŠå®ä¾‹åŒ–XHRå¯¹è±¡çš„è¿‡ç¨‹å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡å·¥å‚é‡Œã€‚åœ¨ajaxæ–¹æ³•ä¸­åªéœ€è¦ä½¿ç”¨XHRå¯¹è±¡å°±å¯ä»¥äº†ã€‚ </p>
<p>ä¸¤ä¸ªç‹¬ç«‹çš„å¯¹è±¡ä¹‹é—´å®ç°äº†è§£è€¦å’Œã€‚å…¶å®åœ¨jsæ¨¡å¼è®¾è®¡ä¸­æ¯ç§æ¨¡å¼åŸºæœ¬éƒ½æ˜¯å›´ç»•åŠŸèƒ½çš„è§£è€¦å’Œæ¥å±•å¼€ã€‚è¦è§£å†³é—®é¢˜é¦–å…ˆè¦ç®€åŒ–é—®é¢˜ï¼Œåœ¨ç®€åŒ–è¿‡ç¨‹ä¸­æ‰èƒ½è¯†åˆ«å‡ºæ¨¡å¼ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptä¸­ä»‹è€…æ¨¡å¼-å’¸é±¼ç½‘çš„æ€è€ƒ]]></title>
      <url>http://yoursite.com/2017/03/11/javascript%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F-%E5%92%B8%E9%B1%BC%E7%BD%91%E7%9A%84%E6%80%9D%E8%80%83/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åœ¨å­—å…¸é‡Œï¼Œä¸­ä»‹è€…æ˜¯æŒ‡â€œååŠ©è°ˆåˆ¤å’Œè§£å†³å†²çªçš„ä¸­ç«‹æ–¹â€ã€‚åœ¨æ¨¡å¼è®¾è®¡é‡Œï¼Œä¸­ä»‹è€…æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬å…¬å¼€ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç³»ç»Ÿä¸åŒéƒ¨åˆ†å¯ä»¥é€šè¿‡è¯¥æ¥å£è¿›è¡Œé€šè®¯ã€‚<br>ä¹Ÿè®¸ä¸€ä¸ªå¯¹è±¡å¯ä»¥å’Œåä¸ªå¯¹è±¡ä¹‹é—´å‘ç”Ÿè”ç³»ï¼Œåä¸ªå¯¹è±¡ä¹‹é—´æœ‰å¯ä»¥å‘ç”Ÿç›¸äº’è”ç³»ï¼Œä»è€Œå½¢æˆä¸€å¼ å·¨å¤§çš„å…³ç³»ç½‘ï¼Œè¦æƒ³åœ¨è¿™ä¹ˆå¤æ‚çš„å…³ç³»ç½‘ä¸­ç†æ¸…å…³ç³»ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚<br>ä¸­ä»‹è€…æ¨¡å¼å°±æ˜¯è¦æŠŠå¯¹è±¡ä¹‹é—´çš„ç›¸äº’è€¦åˆå…³ç³»è§£é™¤ã€‚é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å’Œä¸­ä»‹è€…å¯¹è±¡é€šè®¯ï¼Œå¯¹è±¡ä¹‹é—´ä¸ç›´æ¥å‘ç”Ÿè”ç³»ã€‚<br>ä¸­ä»‹è€…å¯¹è±¡æ˜¯çš„å¯¹è±¡ä¹‹é—´çš„ç½‘çŠ¶ç»“æ„å˜ä¸ºä¸€å¯¹å¤šçš„å…³ç³»ã€‚</p>
</blockquote>
<p>æ‹¿å’¸é±¼ç½‘æ¥è¯´ã€‚ä»¥å‰å¦‚æœæˆ‘ä»¬æœ‰é—²ç½®çš„ä¸œè¥¿ï¼Œå¯ä»¥åœ¨å°åŒºçš„è·¯ä¸Šæ‘†ä¸ªæ‘Šå­ï¼Œè¿™æ ·çœ‹åˆ°ä¸œè¥¿çš„é‚»å±…å¯èƒ½ä¼šæ¥ä¹°ã€‚å¯æ˜¯è¿™ç§å…³ç³»æ˜¯ååˆ†ä¸ç¨³å®šå’Œå¤æ‚çš„ï¼Œäº¤æ˜“å‘ç”Ÿéƒ½æœ‰å¶ç„¶æ€§ã€‚<br>å¦‚æœæˆ‘ä»¬æŠŠé—²ç½®å‘å¸ƒåˆ°å’¸é±¼ï¼Œé‚£ä¹ˆå‘å¸ƒè€…å’Œè´­ä¹°è€…ä¸ä¼šç›´æ¥å‘ç”Ÿè”ç³»ã€‚ä¹‹é—´çš„å…³ç³»éƒ½æ˜¯é€šè¿‡å’¸é±¼æ¥å®Œæˆçš„ã€‚è¿™æ ·çš„æ¨¡å¼å°±æ¯”ç›´æ¥äº¤æ˜“ä¾¿åˆ©çš„å¤šã€‚</p>
<p>å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬14ç« ã€‚ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹åŠ¨ç‰©ä¹¦ ç¬¬9ç« ã€‚9.6</p>
<p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­<br>è¿™æ˜¯ä¸€ä¸ªæ‰å¯¹å®æ€çš„æ¸¸æˆã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params"> name </span>)</span>&#123; <span class="comment">//ç©å®¶æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.name = name <span class="comment">//ç©å®¶åå­—</span></div><div class="line">		<span class="keyword">this</span>.enemy = <span class="literal">null</span>; <span class="comment">// æ•Œäºº</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è·èƒœå‡½æ•°</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="keyword">this</span>.name + <span class="string">' won '</span> );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å¤±è´¥å‡½æ•°</span></div><div class="line">		<span class="built_in">console</span>.log( <span class="keyword">this</span>.name +<span class="string">' lost'</span> );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.die = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å¤±è´¥å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.lose();</div><div class="line">		<span class="keyword">this</span>.enemy.win();</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//æ¥ä¸‹æ¥åˆ›å»º2 ä¸ªç©å®¶å¯¹è±¡ï¼š</span></div><div class="line">	<span class="keyword">var</span> player1 = <span class="keyword">new</span> Player( <span class="string">'çš®è›‹'</span> );</div><div class="line">	<span class="keyword">var</span> player2 = <span class="keyword">new</span> Player( <span class="string">'å°ä¹–'</span> );</div><div class="line">	<span class="comment">//ç»™ç©å®¶ç›¸äº’è®¾ç½®æ•Œäººï¼š</span></div><div class="line">	player1.enemy = player2;</div><div class="line">	player2.enemy = player1;</div><div class="line"></div><div class="line">	player1.die();<span class="comment">// è¾“å‡ºï¼šçš®è›‹ lostã€å°ä¹– won</span></div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„ç›¸äº’ä½œç”¨è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚<br>å½“å¢åŠ ç©å®¶ç»„é˜Ÿçš„æ—¶å€™ï¼Œå°±æ¯”è¾ƒå¤æ‚äº†ï¼Œçœ‹çœ‹ä¾ç…§ä¸Šé¢çš„æ€è·¯çš„ä»£ç <br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> players = []; <span class="comment">//ç©å®¶çš„æ•°ç»„ï¼Œä½¿ç”¨çš„æ—¶å€™æ˜¯äºŒç»´æ•°ç»„ï¼Œä¸€ç»´æ˜¯é˜Ÿé¢œè‰²</span></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">Player</span></span>( name, teamColor )&#123;<span class="comment">//æ„é€ å‡½æ•°</span></div><div class="line">		<span class="built_in">this</span>.partners = []; <span class="comment">// é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">		<span class="built_in">this</span>.enemies = []; <span class="comment">// æ•Œäººåˆ—è¡¨</span></div><div class="line">		<span class="built_in">this</span>.state = <span class="string">'live'</span>; <span class="comment">// ç©å®¶çŠ¶æ€</span></div><div class="line">		<span class="built_in">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></div><div class="line">		<span class="built_in">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿèƒœåˆ©</span></div><div class="line">		console.log( <span class="string">'winner: '</span> + <span class="built_in">this</span>.name );</div><div class="line">	&#125;;</div><div class="line">	Player.prototype.lose = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿå¤±è´¥</span></div><div class="line">		console.log( <span class="string">'loser: '</span> + <span class="built_in">this</span>.name );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.die = <span class="function"><span class="keyword">function</span></span>()&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></div><div class="line">		<span class="keyword">var</span> all_dead = <span class="literal">true</span>;</div><div class="line"></div><div class="line">		<span class="built_in">this</span>.state = <span class="string">'dead'</span>; <span class="comment">// è®¾ç½®ç©å®¶çŠ¶æ€ä¸ºæ­»äº¡ï¼Œæ ‡è®°å˜é‡</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[ i++ ]; )&#123; </div><div class="line">      <span class="comment">// éå†é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">			<span class="keyword">if</span> ( partner.state !== <span class="string">'dead'</span> )&#123; </div><div class="line">    <span class="comment">// å¦‚æœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æœªå¤±è´¥</span></div><div class="line">				all_dead = <span class="literal">false</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> ( all_dead === <span class="literal">true</span> )&#123; <span class="comment">// å¦‚æœé˜Ÿå‹å…¨éƒ¨æ­»äº¡</span></div><div class="line">			<span class="built_in">this</span>.lose(); <span class="comment">// é€šçŸ¥è‡ªå·±æ¸¸æˆå¤±è´¥</span></div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰é˜Ÿå‹ç©å®¶æ¸¸æˆå¤±è´¥</span></div><div class="line">				partner.lose();</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, enemy; enemy = <span class="built_in">this</span>.enemies[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰æ•Œäººæ¸¸æˆèƒœåˆ©</span></div><div class="line">				enemy.win();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">var</span> playerFactory = <span class="function"><span class="keyword">function</span></span>( name, teamColor )&#123;<span class="comment">//ç©å®¶å¯¹è±¡å·¥å‚</span></div><div class="line">		<span class="keyword">var</span> <span class="keyword">new</span><span class="type">Player</span> = <span class="keyword">new</span> <span class="type">Player</span>( name, teamColor ); </div><div class="line"><span class="comment">// åˆ›å»ºæ–°ç©å®¶</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = players[ i++ ]; )&#123;</div><div class="line"> <span class="comment">// é€šçŸ¥æ‰€æœ‰çš„ç©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥</span></div><div class="line">			<span class="keyword">if</span> ( player.teamColor === <span class="keyword">new</span><span class="type">Player</span>.teamColor )&#123; </div><div class="line"><span class="comment">// å¦‚æœæ˜¯åŒä¸€é˜Ÿçš„ç©å®¶</span></div><div class="line">				player.partners.push( <span class="keyword">new</span><span class="type">Player</span> ); </div><div class="line"><span class="comment">// ç›¸äº’æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨</span></div><div class="line">				<span class="keyword">new</span><span class="type">Player</span>.partners.push( player );</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				player.enemies.push( <span class="keyword">new</span><span class="type">Player</span> ); </div><div class="line"><span class="comment">// ç›¸äº’æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨</span></div><div class="line">				<span class="keyword">new</span><span class="type">Player</span>.enemies.push( player );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		players.push( <span class="keyword">new</span><span class="type">Player</span> );</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span><span class="type">Player</span>;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment">//çº¢é˜Ÿï¼š4ä¸ªç©å®¶</span></div><div class="line">	<span class="keyword">var</span> player1 = playerFactory( <span class="string">'çš®è›‹'</span>, <span class="string">'red'</span> ),</div><div class="line">	player2 = playerFactory( <span class="string">'å°ä¹–'</span>, <span class="string">'red'</span> ),</div><div class="line">	player3 = playerFactory( <span class="string">'å®å®'</span>, <span class="string">'red'</span> ),</div><div class="line">	player4 = playerFactory( <span class="string">'å°å¼º'</span>, <span class="string">'red'</span> );</div><div class="line">	<span class="comment">//è“é˜Ÿï¼š4ä¸ªç©å®¶</span></div><div class="line">	<span class="keyword">var</span> player5 = playerFactory( <span class="string">'é»‘å¦'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player6 = playerFactory( <span class="string">'è‘±å¤´'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player7 = playerFactory( <span class="string">'èƒ–å¢©'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player8 = playerFactory( <span class="string">'æµ·ç›—'</span>, <span class="string">'blue'</span> );</div><div class="line"></div><div class="line">	player1.die();</div><div class="line">	player2.die();</div><div class="line">	player4.die();</div><div class="line">	player3.die();</div></pre></td></tr></table></figure></p>
<blockquote>
<p>ä»¥ä¸Šçš„ä»£ç å°±æœ‰ç‚¹å¤æ‚äº†ã€‚å½“ç©å®¶å¤±è´¥(æ­»äº¡)ä»¥åè¦éå†å…¶ä»–é˜Ÿå‹ç­‰ç­‰ã€‚åŠ å…¥é˜Ÿä¼çš„æ—¶å€™ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œè¦ç›¸äº’ç¡®è®¤ã€‚é˜Ÿå‹ä¹‹é—´çš„ç›¸äº’äº¤å‰å˜åŒ–å¾ˆéº»çƒ¦ã€‚</p>
</blockquote>
<p>ä¸‹é¢çœ‹çœ‹ä¸­ä»‹è€…æ¨¡å¼æ”¹é€ çš„ä»£ç ã€‚<br>é‡è¦çš„æ˜¯æ·»åŠ äº†playerDirectorè¿™ä¸ªä¸­ä»‹è€…å¯¹è±¡ã€‚<br>playerDirectorä¸­ä»‹è€…å¯¹è±¡ä¸­æ·»åŠ æ¥å£ï¼ŒreceiveMessage()é€šçŸ¥ä¸­ä»‹è€…æ¥è¿›è¡Œç›¸å…³æ“ä½œã€‚å¯ä»¥å…ˆåœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­çœ‹çœ‹è¿™ä¸ªæ–¹æ³•<br>reciveMessage( â€˜playerDeadâ€™, this )ï¼›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é€šçŸ¥ä¸­ä»‹è€…çš„æ–¹æ³•ã€‚ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ›å»ºçš„ç©å®¶å¯¹è±¡ã€‚<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">  <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>ä¸­ä»‹è€…æ¨¡å¼<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line"> function Player( name, teamColor )&#123;<span class="comment">//æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></div><div class="line">		<span class="keyword">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²ï¼Œç©å®¶æ•°ç»„çš„ç¬¬ä¸€ç»´</span></div><div class="line">		<span class="keyword">this</span>.state = <span class="string">'alive'</span>; <span class="comment">// ç©å®¶ç”Ÿå­˜çŠ¶æ€</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.win = function()&#123;<span class="comment">//èƒœåˆ©</span></div><div class="line">		console.log( <span class="keyword">this</span>.name + <span class="string">' won '</span> );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Player.prototype.lose = function()&#123; <span class="comment">//å¤±è´¥</span></div><div class="line">		console.log( <span class="keyword">this</span>.name +<span class="string">' lost'</span> );</div><div class="line">	&#125;;</div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç©å®¶æ­»äº¡**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.die = function()&#123;</div><div class="line">		<span class="keyword">this</span>.state = <span class="string">'dead'</span>;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'playerDead'</span>, <span class="keyword">this</span> ); </div><div class="line">              <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ­»äº¡</span></div><div class="line">	&#125;;</div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç§»é™¤ç©å®¶**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.remove = function()&#123;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'removePlayer'</span>, <span class="keyword">this</span> );     </div><div class="line">               <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªç©å®¶</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****ç©å®¶æ¢é˜Ÿ**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></div><div class="line">	Player.prototype.changeTeam = function( color )&#123;</div><div class="line">		playerDirector.reciveMessage( <span class="string">'changeTeam'</span>, <span class="keyword">this</span>, color );     </div><div class="line">          <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ¢é˜Ÿ</span></div><div class="line">	&#125;;</div><div class="line">       </div><div class="line">	<span class="keyword">var</span> playerDirector= ( function()&#123; <span class="comment">//ä¸­ä»‹è€…æ„é€ å‡½æ•°</span></div><div class="line">		<span class="keyword">var</span> players = &#123;&#125;, <span class="comment">// ä¿å­˜æ‰€æœ‰ç©å®¶</span></div><div class="line">			operations = &#123;&#125;; <span class="comment">// ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ</span></div><div class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*æ–°å¢ä¸€ä¸ªç©å®¶*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">		operations.addPlayer = function( player )&#123;</div><div class="line">			<span class="keyword">var</span> teamColor = player.teamColor; <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></div><div class="line">			players[ teamColor ] = players[ teamColor ] || []; </div><div class="line">                   <span class="comment">// å¦‚æœè¯¥é¢œè‰²çš„ç©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™åˆ›å»º</span></div><div class="line"></div><div class="line">			players[ teamColor ].push( player ); <span class="comment">// æ·»åŠ ç©å®¶è¿›é˜Ÿä¼</span></div><div class="line">		&#125;;</div><div class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ç§»é™¤ä¸€ä¸ªç©å®¶*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">	operations.removePlayer = function( player )&#123;</div><div class="line">		<span class="keyword">var</span> teamColor = player.teamColor, <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></div><div class="line">		teamPlayers = players[ teamColor ] || []; <span class="comment">// è¯¥é˜Ÿä¼æ‰€æœ‰æˆå‘˜</span></div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = teamPlayers.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- )&#123; <span class="comment">// éå†åˆ é™¤</span></div><div class="line">			<span class="keyword">if</span> ( teamPlayers[ i ] === player )&#123;</div><div class="line">				teamPlayers.splice( i, <span class="number">1</span> );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ç©å®¶æ¢é˜Ÿ*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></div><div class="line">	operations.changeTeam = function( player, newTeamColor )&#123; <span class="comment">// ç©å®¶æ¢é˜Ÿ</span></div><div class="line">		operations.removePlayer( player ); <span class="comment">// ä»åŸé˜Ÿä¼ä¸­åˆ é™¤</span></div><div class="line">		player.teamColor = newTeamColor; <span class="comment">// æ”¹å˜é˜Ÿä¼é¢œè‰²</span></div><div class="line">		operations.addPlayer( player ); <span class="comment">// å¢åŠ åˆ°æ–°é˜Ÿä¼ä¸­</span></div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	operations.playerDead = function( player )&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></div><div class="line">		<span class="keyword">var</span> teamColor = player.teamColor,</div><div class="line">		teamPlayers = players[ teamColor ]; <span class="comment">// ç©å®¶æ‰€åœ¨é˜Ÿä¼</span></div><div class="line">		<span class="keyword">var</span> all_dead = <span class="keyword">true</span>;</div><div class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">			<span class="keyword">if</span> ( player.state !== <span class="string">'dead'</span> )&#123;</div><div class="line">				all_dead = <span class="keyword">false</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> ( all_dead === <span class="keyword">true</span> )&#123; <span class="comment">// å…¨éƒ¨æ­»äº¡</span></div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">				player.lose(); <span class="comment">// æœ¬é˜Ÿæ‰€æœ‰ç©å®¶lose</span></div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span> ( <span class="keyword">var</span> color <span class="keyword">in</span> players )&#123;</div><div class="line">				<span class="keyword">if</span> ( color !== teamColor )&#123;</div><div class="line">					<span class="keyword">var</span> teamPlayers = players[ color ]; </div><div class="line">                                         <span class="comment">// å…¶ä»–é˜Ÿä¼çš„ç©å®¶</span></div><div class="line">					<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, player; player = teamPlayers[ i++ ]; )&#123;</div><div class="line">						player.win(); <span class="comment">// å…¶ä»–é˜Ÿä¼æ‰€æœ‰ç©å®¶win</span></div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">         </div><div class="line">	   <span class="keyword">var</span> reciveMessage = function()&#123;</div><div class="line">            <span class="comment">//è¢«ä¸­ä»‹è€…ä¸­ä½¿ç”¨é€šçŸ¥ä¸­ä»‹è€…çš„æ–¹æ³•</span></div><div class="line">		<span class="keyword">var</span> message = Array.prototype.shift.call( arguments ); <span class="comment">// arguments çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¶ˆæ¯åç§°</span></div><div class="line">		operations[ message ].apply( <span class="keyword">this</span>, arguments );</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		reciveMessage: reciveMessage<span class="comment">//æ­ç¤ºæ¨¡å¼çš„æ–¹æ³•</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;)();</div><div class="line"></div><div class="line">	<span class="comment">// çº¢é˜Ÿï¼š</span></div><div class="line">	<span class="keyword">var</span> player1 = playerFactory( <span class="string">'çš®è›‹'</span>, <span class="string">'red'</span> ),</div><div class="line">	player2 = playerFactory( <span class="string">'å°ä¹–'</span>, <span class="string">'red'</span> ),</div><div class="line">	player3 = playerFactory( <span class="string">'å®å®'</span>, <span class="string">'red'</span> ),</div><div class="line">	player4 = playerFactory( <span class="string">'å°å¼º'</span>, <span class="string">'red'</span> );</div><div class="line">	<span class="comment">// è“é˜Ÿï¼š</span></div><div class="line">	<span class="keyword">var</span> player5 = playerFactory( <span class="string">'é»‘å¦'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player6 = playerFactory( <span class="string">'è‘±å¤´'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player7 = playerFactory( <span class="string">'èƒ–å¢©'</span>, <span class="string">'blue'</span> ),</div><div class="line">	player8 = playerFactory( <span class="string">'æµ·ç›—'</span>, <span class="string">'blue'</span> );</div><div class="line">	player1.die();</div><div class="line">	player2.die();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div><div class="line"></div><div class="line">	player1.remove();</div><div class="line">	player2.remove();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div><div class="line"></div><div class="line">	player1.changeTeam( <span class="string">'blue'</span> );</div><div class="line">	player2.die();</div><div class="line">	player3.die();</div><div class="line">	player4.die();</div></pre></td></tr></table></figure></p>
<p>ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œä½¿ç”¨è€…ä¹‹é—´æ˜¯ä¸å‘ç”Ÿä»»ä½•å…³ç³»çš„ã€‚å‘ç”Ÿä»»ä½•çš„æ“ä½œéƒ½æ˜¯é€šçŸ¥ä¸­ä»‹è€…ã€‚ä¸­ä»‹è€…å†é€šçŸ¥å…¶ä»–ä½¿ç”¨è€…ã€‚<br>ä½¿ç”¨è€…ä¹‹é—´çš„è€¦åˆè§£é™¤äº†ã€‚</p>
<p>æ•°ç»„çš„ä½¿ç”¨ä¸Šçµæ´»åº¦å¾ˆå¤§è¦æ³¨æ„ï¼Œå…¶ä»–çš„åœ°æ–¹è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ã€‚</p>
<p>æˆ‘æ„Ÿè§‰reactç»„ä»¶å’Œreduxæ¨¡å—çš„ç›¸äº’å…³ç³»å°±æ˜¯ä¸­ä»‹è€…æ¨¡å¼ï¼Œæ‚¨è§‰å¾—å‘¢ï¼Ÿ</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/10/javascript%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>è¿™ä¸ªæ¨¡å¼çœ‹äº†å¾ˆé•¿æ—¶é—´ï¼Œå¡åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œå…¶ä»–çš„æ¨¡å¼ä¸ºäº†ç®€åŒ–ç¼–ç¨‹çš„å¤æ‚æ€§ï¼Œéƒ½æ˜¯é¼“åŠ±å‡½æ•°æˆ–è€…å¯¹è±¡é—´<code>è§£è€¦å’Œ</code>çš„ï¼Œä½†æ˜¯å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼è™½ç„¶å‘å¸ƒè€…å’Œè®¢é˜…è€…å¯¹è±¡åˆ†å¼€äº†ï¼Œä½†æ˜¯ä¹‹é—´çš„ä¾èµ–å…³ç³»åè€Œæ›´å¼ºäº†ã€‚ </p>
</blockquote>
<p><em>å…³é”®ç‚¹</em>ï¼š1.è®¢é˜…è€…åœ¨è®¢é˜…äº‹ä»¶çš„æ—¶å€™å®é™…æ˜¯åœ¨å‘å¸ƒè€…å¯¹è±¡çš„æ•°ç»„ä¸­å†™å…¥è¦è®¢é˜…çš„äº‹ä»¶ã€‚ 2.å‘å¸ƒè€…åœ¨å‘å¸ƒæˆ–è€…å«triggeräº‹ä»¶çš„æ—¶å€™ï¼Œå®é™…æ˜¯åœ¨å‘å¸ƒè€…ä¸­éå†æ•°ç»„ä¸­è®¢é˜…è€…çš„äº‹ä»¶æ–¹æ³•ã€‚<code>æ¶‰åŠçš„æ˜¯æ¶ˆæ¯æ•°ç»„çš„å†™å…¥å’Œéå†è¯»å‡ºè¿‡ç¨‹</code>ã€‚</p>
<p>å¦å¤–ä¸€ç‚¹å°±æ˜¯ï¼Œç”±äºjavascriptçš„å‡½æ•°ä¸€ç±»å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥å†™å…¥æ•°ç»„ï¼Œè¿™æ ·å’‹å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼ä¸­æ“ä½œèµ·æ¥ç›¸å½“çš„æ–¹ä¾¿ï¼ŒjsçœŸæ˜¯å‰å®³ã€‚</p>
<p>å…³äºå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼çš„åŒºåˆ«æˆ‘æ²¡ææ‡‚ã€‚è¿™é‡Œçš„ä¾‹å­æˆ–è®¸æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæˆ–è®¸æ˜¯å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼ã€‚</p>
<blockquote>
<p>å‚è€ƒ ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹<code>pro javascript design patterns</code> ç¬¬åäº”ç« </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å‘å¸ƒè€…æ„é€ å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Publisher</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subscribers = []; <span class="comment">//è®¢é˜…å’Œå‘å¸ƒéƒ½æ˜¯å›´ç»•è¿™ä¸ªæ•°ç»„è¿›é¡¹</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//æ‰§è¡Œå‘å¸ƒçš„æ–¹æ³•ï¼Œéå†è®¢é˜…è€…å¯¹æ–¹æ³•</span></div><div class="line">Publisher.prototype.deliver = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subscribers.forEach(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</div><div class="line">      fn(data);</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//è®¢é˜…çš„æ–¹æ³•ï¼Œè®¢é˜…è€…å¯¹è±¡å†™å…¥subscribersæ•°ç»„</span></div><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸¤ä¸ªæ–¹æ³•æŒ‚è½½åœ¨FunctionåŸå‹ä¸Š</span></div><div class="line"><span class="built_in">Function</span>.prototype.subscribe = <span class="function"><span class="keyword">function</span>(<span class="params">publisher</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">var</span> alreadyExists = publisher.subscribers.some(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> ( el === that ) &#123; <span class="comment">//å¦‚æœå·²ç»è®¢é˜…çš„è¯ï¼Œç«‹å³è¿”å›</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">if</span> ( !alreadyExists ) &#123; <span class="comment">//è®¢é˜…è€…çš„è®¢é˜…å¯¹è±¡æ’å…¥æ•°ç»„</span></div><div class="line">    publisher.subscribers.push(<span class="keyword">this</span>);<span class="comment">//æ³¨æ„å‘½åç©ºé—´</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//å–æ¶ˆè®¢é˜…çš„æ–¹æ³•</span></div><div class="line"><span class="built_in">Function</span>.prototype.unsubscribe = <span class="function"><span class="keyword">function</span>(<span class="params">publisher</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  publisher.subscribers = publisher.subscribers.filter(</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> ( el !== that ) &#123; <span class="comment">//å¦‚æœæ˜¯è®¢é˜…å¯¹è±¡å°±è¿‡æ»¤æ‰</span></div><div class="line">        <span class="keyword">return</span> el;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> publisherObject = <span class="keyword">new</span> Publisher;<span class="comment">//å‘å¸ƒè€…å¯¹è±¡</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> observerObject = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;<span class="comment">//è®¢é˜…è€…å¯¹è±¡ </span></div><div class="line">  <span class="comment">// process data</span></div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">  <span class="comment">// unsubscribe from this publisher</span></div><div class="line">  <span class="built_in">arguments</span>.callee.unsubscribe(publisherObject);</div><div class="line">  <span class="comment">//åœ¨è®¢é˜…å¯¹è±¡ä¸­å–æ¶ˆè®¢é˜…ï¼Œå…¶å®å°±æ˜¯åªæ‰§è¡Œä¸€æ¬¡å‘å¸ƒæ“ä½œ</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">observerObject.subscribe(publisherObject);  </div><div class="line"><span class="comment">//æ‰§è¡Œè®¢é˜…ï¼Œæ³¨æ„è¿™ä¸ªè®¢é˜…æ–¹æ³•æŒ‚è½½çš„åŸå‹ï¼Œæˆ‘å¼€å§‹ææ··äº†ï¼Œä»¥ä¸ºä»£ç æœ‰é”™</span></div></pre></td></tr></table></figure>
<blockquote>
<p>jsçš„æ•°ç»„æ“ä½œå’Œé«˜é˜¶å‡½æ•°çš„ç‰¹æ€§ä½¿å¾—å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼å¾ˆå¥½å®ç°ã€‚<br>  è¿™ä¸ªæ¨¡å¼æˆ‘åœ¨react/reduxçš„æ•°æ®æµç¨‹ä¸­è§‰å¾—æ˜¯æœ‰çš„ï¼Œä½†æ˜¯åè€Œåœ¨æ¨¡å¼å­¦ä¹ ä¸­æ˜¯æœ€éš¾çš„ã€‚è§£è€¦å’Œä¹Ÿä¸æ˜¯ç»å¯¹çš„ä¸€ç‚¹è”ç³»éƒ½æ²¡æœ‰ï¼Œå…³ç³»æ˜¯<code>è—•æ–­ä¸è¿</code>ï¼Œè¦çœ‹åˆ°æ–­å¼€çš„<code>ä¸¤èŠ‚è—•</code>ï¼Œè¿˜è¦çœ‹åˆ°ä¹‹é—´çš„çš„<code>ä¸</code>.react/reduxçš„å­¦ä¹ ä¸­å°±è¦æ‰¾åˆ°è¿™å±‚å…³ç³»ã€‚</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascripté€‚é…å™¨æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/10/javascript%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>é€‚é…å™¨æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹æ€§ã€‚ä½¿ç”¨é€‚é…å™¨ä»¥ååŸæœ¬ä¸å…¼å®¹çš„ä¸¤ä¸ªè½¯ä»¶çš„æ¥å£å¯ä»¥å·¥ä½œåœ¨ä¸€èµ·äº†ã€‚<br>å®—æ—¨æ˜¯ä¸è¦æ”¹å˜åŸè½¯ä»¶æ¥å£çš„ç¨‹åºä»£ç ï¼Œåœ¨å¤–éƒ¨ä½¿ç”¨é€‚é…å™¨å¯¹æ•°æ®ç»“æ„åšè°ƒæ•´ã€‚<br>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬17ç« </p>
</blockquote>
<p>ç¬¬ä¸€æ®µä»£ç ï¼Œä¸¤ä¸ªåœ°å›¾æ¥å£ä¹‹é—´çš„é€‚é…</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> googleMap = &#123;</div><div class="line">		<span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)æ–¹æ³•æ˜¯<span class="title">show</span></span></div><div class="line">			<span class="title">console</span>.<span class="title">log</span>(<span class="params"> <span class="string">'å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾'</span> </span>);</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="title">var</span> <span class="title">baiduMap</span> = &#123;</div><div class="line">		display: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ–¹æ³•æ˜¯display</span></div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> baiduMapAdapter = &#123;</div><div class="line">		<span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//é€‚é…å™¨ä¹Ÿæ”¹ä¸ºshow,è¿”å›çš„æ˜¯display</span></div><div class="line">			<span class="keyword">return</span> baiduMap.display();</div><div class="line"></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">//ä¸‹é¢æ˜¯æ¸²æŸ“åœ°å›¾çš„æ–¹æ³•ï¼Œä¼ å…¥åœ°å›¾å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> renderMap = <span class="function"><span class="keyword">function</span>(<span class="params"> map </span>)</span>&#123;<span class="comment">//ä¼ å…¥åœ°å›¾å¯¹è±¡</span></div><div class="line">		<span class="keyword">if</span> ( map.show <span class="keyword">instanceof</span> <span class="built_in">Function</span> )&#123; <span class="comment">//åˆ¤æ–­</span></div><div class="line">			map.show();  <span class="comment">//åœ°å›¾å¯¹è±¡çš„showæ–¹æ³•</span></div><div class="line">			<span class="comment">//åœ¨ä¼ å…¥baiduMapAdapterå¯¹è±¡çš„æ—¶å€™ï¼Œè°ƒç”¨showæ–¹æ³•ï¼Œè¿”å›çš„</span></div><div class="line">			<span class="comment">//å®é™…æ˜¯baiduMapçš„displayæ–¹æ³•ã€‚</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	renderMap( googleMap ); <span class="comment">// è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾</span></div><div class="line">	renderMap( baiduMapAdapter ); <span class="comment">// è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ </span></div><div class="line"> </div><div class="line"> <span class="string">``</span><span class="string">`   </span></div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">æ•°æ®ç»“æ„å¦‚æœä¸åŒï¼Œä¹Ÿå¯ä»¥ä¸è¦æ”¹åŠ¨APIçš„è¾“å‡ºä»£ç ï¼Œåªæ”¹åŠ¨è¾“å‡ºä»¥åçš„æ•°æ®å‘ˆç°ç»“æ„</div></pre></td></tr></table></figure>
<p> //å…¶ä¸­ä¸€ä¸ªAPIè¿”å›çš„æ•°æ®<br> var getGuangdongCity = function(){<br>        var guangdongCity = [<br>        {<br>            name: â€˜shenzhenâ€™,<br>            id: 11,<br>        }, {<br>            name: â€˜guangzhouâ€™,<br>            id: 12,<br>        }<br>        ];<br>        return guangdongCity;<br>    };<br>    var render = function( fn ){<br>        console.log( â€˜å¼€å§‹æ¸²æŸ“å¹¿ä¸œçœåœ°å›¾â€™ );<br>        document.write( JSON.stringify( fn() ) );<br>    };<br>    render( getGuangdongCity );</p>
<pre><code>//å¦ä¸€ä¸ªapiè·å¾—çš„æ•°æ®
var guangdongCity = {
    shenzhen: 11,
    guangzhou: 12,
    zhuhai: 13
};

//è¿™ä¸¤ä¸ªAPIè¿”å›çš„æ•°æ®ä¸åŒï¼Œä¸éœ€è¦æ”¹åŠ¨APIçš„è¾“å‡ºä»£ç ï¼Œè¦åœ¨è¾“
</code></pre><p>//å‡ºä»¥ååšé€‚é…ã€‚ æˆ‘ä»¬è‡ªå·±çš„APIå¯ä»¥æ”¹åŠ¨ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹çš„APIå°±<br>//æ²¡æœ‰åŠæ³•è¦æ±‚æ”¹åŠ¨è¾“å‡ºç»“æ„ã€‚æ‰€ä»¥æœ€å¥½æ˜¯åšé€‚é…ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯è¯´æ˜æœ‰è¿™ä¸ªæ€è·¯ã€‚</p>
<pre><code><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//new data</span></div><div class="line">  <span class="built_in">var</span> guangdongCity = &#123;</div><div class="line">	<span class="attribute">shenzhen</span>: <span class="number">11</span>,</div><div class="line">	<span class="attribute">guangzhou</span>: <span class="number">12</span>,</div><div class="line">	<span class="attribute">zhuhai</span>: <span class="number">13</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//æŒ‰ç…§éœ€è¦æŠŠä¸‹é¢çš„è¾“å‡ºæ ¼å¼æ”¹ä¸ºä¸Šé¢ä»£ç é‡Œçš„æ ¼å¼</span></div><div class="line"><span class="comment">//old data</span></div><div class="line"><span class="built_in">var</span> getGuangdongCity = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">var</span> guangdongCity = [</div><div class="line">	&#123;</div><div class="line">		<span class="attribute">name</span>: <span class="string">'shenzhen'</span>,</div><div class="line">		<span class="attribute">id:</span><span class="string"> 11,</span></div><div class="line">	&#125;, &#123;</div><div class="line">		name: <span class="string">'guangzhou'</span>,</div><div class="line">		<span class="attribute">id:</span><span class="string"> 12,</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	];</div><div class="line">	return guangdongCity;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//æ–°æ—§æ•°æ®ç»Ÿä¸€çš„æ¸²æŸ“æ–¹æ³•</span></div><div class="line"><span class="built_in">var</span> render = <span class="function"><span class="keyword">function</span>(<span class="params"> fn </span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log( <span class="string">'å¼€å§‹æ¸²æŸ“å¹¿ä¸œçœåœ°å›¾'</span> );</div><div class="line">	<span class="built_in">document</span>.write( <span class="built_in">JSON</span>.stringify( fn() ) );</div><div class="line">&#125;;</div><div class="line"> <span class="comment">//è¾“å‡ºæ•°æ®ç»“æ„çš„é€‚é…å™¨ï¼ŒæŠŠæ—§æ•°æ®æŒ‰ç…§æ–°æ•°æ®ç»“æ„çš„æ ¼å¼åšé€‚é…</span></div><div class="line"><span class="built_in">var</span> addressAdapter = <span class="function"><span class="keyword">function</span>(<span class="params"> oldAddressfn </span>)</span>&#123;</div><div class="line">	<span class="built_in">var</span> address = &#123;&#125;,</div><div class="line">	oldAddress = oldAddressfn();<span class="comment">//è·å–å°±æ•°æ®</span></div><div class="line">	<span class="comment">//é€‚é…çš„å…·ä½“ä»£ç </span></div><div class="line">	<span class="keyword">for</span> ( <span class="built_in">var</span> i = <span class="number">0</span>, c; c = oldAddress[ i++ ]; )&#123;</div><div class="line">		address[ c.name ] = c.id;ç”±æ•°ç»„å¯¹è±¡æ”¹ä¸ºå¯¹è±¡å­˜å‚¨</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> address;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//é€šè¿‡é€‚é…å™¨æ¸²æŸ“æ—§æ•°æ®ï¼Œè¾“å‡ºçš„æ˜¯æ–°æ•°æ®çš„ç»“æ„</span></div><div class="line">render( addressAdapter( getGuangdongCity ) );</div></pre></td></tr></table></figure>
</code></pre><p>  å°±æˆ‘ä¸ªäººæ¥çœ‹ï¼Œ é€‚é…å™¨çš„æ€è·¯æ˜¯æœ€ç®€å•çš„ï¼Œä½†æ˜¯å®é™…æ“ä½œèµ·æ¥å¯èƒ½æ˜¯æœ€å¤æ‚çš„ï¼Œæ•°æ®ä¹‹é—´çš„é€‚é…å¯èƒ½æ¯”æƒ³è±¡ä¸­çš„éº»çƒ¦å¾ˆå¤šã€‚ä½†æ˜¯äº†è§£åˆ°è¿™ä¸ªæ€è·¯å¯¹äºç¼–ç¨‹çš„çµæ´»æ€§æœ‰äº†è®¤è¯†ï¼Œå¦‚æœæ˜¯ä»¥å‰å¯èƒ½é‡åˆ°è¿™æ ·çš„é—®é¢˜çš„æ—¶å€™ï¼Œé¦–å…ˆè€ƒè™‘åˆ°çš„æ˜¯æ€ä¹ˆå»ä¿®æ”¹åŸæ¥çš„çš„ä»£ç ã€‚ä¸€ä¸ªå°æ€è·¯ï¼Œæ–¹æ³•å®Œå…¨ä¸åŒäº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-Reduxçš„ä¸­é—´ä»¶-Reselect]]></title>
      <url>http://yoursite.com/2017/03/09/%E7%BF%BB%E8%AF%91-Redux%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6-Reselect/</url>
      <content type="html"><![CDATA[<blockquote>
<p><strong>æœ¬æ–‡æ˜¯ç¿»è¯‘Reduxçš„ä¸€ä¸ªä¸­é—´ä»¶æ–‡æ¡£.Reduxæ˜¯Reactçš„ä¸€ä¸ªæ•°æ®å±‚,Reactç»„ä»¶çš„stateæœ‰å…³é€»è¾‘å¤„ç†éƒ½è¢«å•ç‹¬æ”¾åˆ°Reduxä¸­æ¥è¿›è¡Œ,åœ¨stateçš„æ“ä½œæµç¨‹ä¸­è¡ç”Ÿäº†å¾ˆå¤šä¸­é—´ä»¶,Reselectè¿™ä¸ªä¸­é—´ä»¶è¦è§£å†³çš„é—®é¢˜æ˜¯:`åœ¨ç»„ä»¶äº¤äº’æ“ä½œçš„æ—¶å€™,stateå‘ç”Ÿå˜åŒ–çš„æ—¶å€™å¦‚ä½•å‡å°‘æ¸²æŸ“çš„å‹åŠ›.åœ¨Reselectä¸­é—´ä¸­ä½¿ç”¨äº†ç¼“å­˜æœºåˆ¶,è¿™ä¸ªæœºåˆ¶å¯ä»¥åœ¨javascriptçš„æ¨¡å¼è®¾è®¡ä¸­åˆšçœ‹åˆ°ä»‹ç»,è¿™é‡Œå°±ä¸è¯¦ç»†è¯´äº†.</strong>ä»…ä¾›å‚è€ƒ,ä»¥åŸæ–‡ä¸ºå‡†.</p>
<hr>
<p>ä¸€æ—¦reduxä»reactçš„æ•°æ®å±‚æ¥ç†è§£ï¼Œå¾ˆå¤šé—®é¢˜éƒ½ä¼¼ä¹æ‰¾åˆ°äº†ç†è®ºä¾æ®ï¼Œæ‰€è°“åæ­£è¨€é¡ºã€‚åœ¨webæ¡†æ¶ä¸­éƒ½ä¼šç”¨æ•°æ®åº“åšæ•°æ®æŒä¹…å±‚ï¼Œåœ¨æŸ¥è¡¨çš„æ—¶å€™ä¼šä¸ºäº†æ•ˆç‡åšç¼“å­˜ï¼Œreselectæ˜¯åŒæ ·çš„ç›®çš„ã€‚Reactçš„ç»„ä»¶æœ‰è‡ªå·±çš„ç‰¹æ®Šæ€§ï¼Œé‡åˆ°ç‰¹æ®Šçš„ç‰¹æ€§çš„æ—¶å€™éœ€è¦æœ‰ç‰¹æ®Šçš„å¤„ç†<br>æ–¹æ³•.</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯è¯‘æ–‡å†…å®¹,<a href="https://github.com/reactjs/reselect" target="_blank" rel="external">åŸæ–‡è¯·å‚è§</a></p>
<hr>
<blockquote>
<p>â€œselectorâ€æ˜¯ä¸€ä¸ªç®€å•çš„Reduxåº“,çµæ„Ÿæ¥æºäº<code>NuclearJS</code>.</p>
<ul>
<li>Selectorå¯ä»¥è®¡ç®—è¡ç”Ÿçš„æ•°æ®,å¯ä»¥è®©Reduxåšåˆ°å­˜å‚¨å°½å¯èƒ½å°‘çš„stateã€‚</li>
<li>Selectoræ¯”è¾ƒé«˜æ•ˆ,åªæœ‰åœ¨æŸä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰å‘ç”Ÿè®¡ç®—è¿‡ç¨‹.</li>
<li>Selectoræ˜¯å¯ä»¥ç»„åˆçš„,ä»–ä»¬å¯ä»¥ä½œä¸ºè¾“å…¥,ä¼ é€’åˆ°å…¶ä»–çš„selector.</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿™ä¸ªä¾‹å­ä¸å¿…å¤ªåœ¨æ„,åé¢ä¼šæœ‰è¯¦ç»†çš„ä»‹ç»</span></div><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> shopItemsSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.items</div><div class="line"><span class="keyword">const</span> taxPercentSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.taxPercent</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  shopItemsSelector,</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> taxSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxPercentSelector,</div><div class="line">  (subtotal, taxPercent) =&gt; subtotal * (taxPercent / <span class="number">100</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxSelector,</div><div class="line">  (subtotal, tax) =&gt; (&#123; <span class="attr">total</span>: subtotal + tax &#125;)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">let</span> exampleState = &#123;</div><div class="line">  <span class="attr">shop</span>: &#123;</div><div class="line">    <span class="attr">taxPercent</span>: <span class="number">8</span>,</div><div class="line">    <span class="attr">items</span>: [</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'apple'</span>, <span class="attr">value</span>: <span class="number">1.20</span> &#125;,</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'orange'</span>, <span class="attr">value</span>: <span class="number">0.95</span> &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(subtotalSelector(exampleState)) <span class="comment">// 2.15</span></div><div class="line"><span class="built_in">console</span>.log(taxSelector(exampleState))      <span class="comment">// 0.172</span></div><div class="line"><span class="built_in">console</span>.log(totalSelector(exampleState))    <span class="comment">// &#123; total: 2.322 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ul>
<li><a href="#å®‰è£…">Installation</a></li>
<li><a href="#å®ä¾‹">å®ä¾‹</a><ul>
<li><a href="#motivation-for-memoized-selectors">Motivation for Memoized Selectors</a></li>
<li><a href="#creating-a-memoized-selector">Creating a Memoized Selector</a></li>
<li><a href="#composing-selectors">Composing Selectors</a></li>
<li><a href="#connecting-a-selector-to-the-redux-store">Connecting a Selector to the Redux Store</a></li>
<li><a href="#accessing-react-props-in-selectors">Accessing React Props in Selectors</a></li>
<li><a href="#sharing-selectors-with-props-across-multiple-components">Sharing Selectors with Props Across Multiple Components</a></li>
</ul>
</li>
<li><a href="#api">API</a><ul>
<li><a href="#createselectorinputselectors--inputselectors-resultfunc"><code>createSelector</code></a></li>
<li><a href="#defaultmemoizefunc-equalitycheck--defaultequalitycheck"><code>defaultMemoize</code></a></li>
<li><a href="#createselectorcreatormemoize-memoizeoptions"><code>createSelectorCreator</code></a></li>
<li><a href="#createstructuredselectorinputselectors-selectorcreator--createselector"><code>createStructuredSelector</code></a></li>
</ul>
</li>
<li><p><a href="#faq">FAQ</a></p>
<ul>
<li><a href="#q-why-isnt-my-selector-recomputing-when-the-input-state-changes">Why isnâ€™t my selector recomputing when the input state changes?</a></li>
<li><a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">Why is my selector recomputing when the input state stays the same?</a></li>
<li><a href="#q-can-i-use-reselect-without-redux">Can I use Reselect without Redux?</a></li>
<li><a href="#q-the-default-memoization-function-is-no-good-can-i-use-a-different-one">The default memoization function is no good, can I use a different one?</a></li>
<li><a href="#q-how-do-i-test-a-selector">How do I test a selector?</a></li>
<li><a href="#q-how-do-i-create-a-selector-that-takes-an-argument">How do I create a selector that takes an argument? </a></li>
<li><a href="#q-how-do-i-use-reselect-with-immutablejs">How do I use Reselect with Immutable.js?</a></li>
<li><a href="#q-can-i-share-a-selector-across-multiple-components">Can I share a selector across multiple components?</a></li>
<li><a href="#q-are-there-typescript-typings">Are there TypeScript typings?</a></li>
<li><a href="#q-how-can-i-make-a-curried-selector">How can I make a curried selector?</a></li>
</ul>
</li>
<li><p><a href="#related-projects">Related Projects</a></p>
</li>
<li><a href="#license">License</a><br>##å®‰è£…<br><code>npm install reselect</code></li>
</ul>
<p>##å®ä¾‹</p>
<p>###ç¼“å­˜Selcectosçš„åŠ¨æœº</p>
<blockquote>
<p>å®ä¾‹æ˜¯åŸºäº <a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux Todos List example</a>.</p>
</blockquote>
<h4 id="containers-VisibleTodoList-js"><a href="#containers-VisibleTodoList-js" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"></div><div class="line"><span class="comment">//ä¸‹é¢è¿™æ®µä»£ç æ˜¯æ ¹æ®è¿‡æ»¤å™¨çš„stateæ¥æ”¹å˜æ—¥ç¨‹stateçš„å‡½æ•°</span></div><div class="line"><span class="keyword">const</span> getVisibleTodos = <span class="function">(<span class="params">todos, filter</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (filter) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">      <span class="keyword">return</span> todos</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">//todosæ˜¯æ ¹æ®è¿‡æ»¤å‡½æ•°è¿”å›çš„stateï¼Œä¼ å…¥ä¸¤ä¸ªå®å‚</span></div><div class="line">    todos: getVisibleTodos(state.todos, state.visibilityFilter)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//mapDispatchToPropsæ¥ä¼ é€’dispatchçš„æ–¹æ³•</span></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//ä½¿ç”¨Reduxçš„connectå‡½æ•°æ³¨å…¥state,åˆ°TodoListç»„ä»¶</span></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,<code>mapStateToProps</code>è°ƒç”¨<code>getVisibleTodos</code>å»è®¡ç®—<code>todos</code>.è¿™ä¸ªå‡½æ•°è®¾è®¡çš„æ˜¯ç›¸å½“å¥½çš„,ä½†æ˜¯æœ‰ä¸ªç¼ºç‚¹ï¼š<code>todos</code>åœ¨æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½ä¼šé‡æ–°è®¡ç®—.å¦‚æœstateæ ‘çš„ç»“æ„æ¯”è¾ƒå¤§,æˆ–è€…è®¡ç®—æ¯”è¾ƒæ˜‚è´µ,æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½è¿›è¡Œè®¡ç®—çš„è¯,å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜.<code>Reselect</code>èƒ½å¤Ÿå¸®åŠ©reduxæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—è¿‡ç¨‹.</p>
<p>###åˆ›å»ºä¸€ä¸ªç¼“å­˜Selector<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®°å¿†ç¼“å­˜selectorä»£æ›¿<code>getVisibleTodos</code>,å¦‚æœ<code>state.todos</code>å’Œ<code>state.visibilityFilter</code>å‘ç”Ÿå˜åŒ–,ä»–ä¼šé‡æ–°è®¡ç®—<code>state</code>,ä½†æ˜¯å‘ç”Ÿåœ¨å…¶ä»–éƒ¨åˆ†çš„stateå˜åŒ–,å°±ä¸ä¼šé‡æ–°è®¡ç®—.</p>
<p>Reslectæä¾›ä¸€ä¸ªå‡½æ•°<code>createSelector</code>æ¥åˆ›å»ºä¸€ä¸ªè®°å¿†selectors.<code>createSelector</code>æ¥å—ä¸€ä¸ª<code>input-selectors</code>å’Œä¸€ä¸ªå˜æ¢å‡½æ•°ä½œä¸ºå‚æ•°.å¦‚æœReduxçš„stateå‘ç”Ÿæ”¹å˜é€ æˆ<code>input-selector</code>çš„å€¼å‘ç”Ÿæ”¹å˜,selectorä¼šè°ƒç”¨å˜æ¢å‡½æ•°,ä¾æ®<code>input-selector</code>åšå‚æ•°,è¿”å›ä¸€ä¸ªç»“æœ.å¦‚æœ<code>input-selector</code>è¿”å›çš„ç»“æœå’Œå‰é¢çš„ä¸€æ ·,é‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å›æœ‰å…³state,ä¼šçœç•¥å˜æ¢å‡½æ•°çš„è°ƒç”¨.</p>
<p>ä¸‹é¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè®°å¿†selector<code>getVisibleTodos</code>æ›¿ä»£éè®°å¿†çš„ç‰ˆæœ¬</p>
<h4 id="selectors-index-js"><a href="#selectors-index-js" class="headerlink" title="selectors/index.js"></a><code>selectors/index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state</span>) =&gt;</span> state.visibilityFilter</div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state</span>) =&gt;</span> state.todos</div><div class="line"><span class="comment">//ä¸‹é¢çš„å‡½æ•°æ˜¯ç»è¿‡åŒ…è£…çš„</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä¸Šé¢çš„çš„å®ä¾‹ä¸­,<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>æ˜¯input-selectors.è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æ™®é€šçš„éè®°å¿†selectorå‡½æ•°,å› ä¸ºä»–ä»¬æ²¡æœ‰å˜æ¢ä»–ä»¬selectçš„æ•°æ®.<code>getVisibleTodos</code>å¦ä¸€æ–¹é¢æ˜¯ä¸€ä¸ªè®°å¿†selector.ä»–æ¥æ”¶<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>ä½œä¸ºinput-selectors,å¹¶ä¸”ä½œä¸ºä¸€ä¸ªå˜æ¢å‡½æ•°è®¡ç®—ç­›é€‰çš„todo list.</p>
<p>###èšåˆselectors</p>
<p>ä¸€ä¸ªè®°å¿†æ€§selectoræœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªè®°å¿†æ€§selectorçš„input-selector.è¿™é‡Œ<code>getVisibleTodos</code>å¯ä»¥ä½œä¸ºinput-selectorä½œä¸ºå…³é”®å­—ç­›é€‰çš„input-selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> getKeyword = <span class="function">(<span class="params">state</span>) =&gt;</span> state.keyword</div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodosFilteredByKeyword = createSelector(</div><div class="line">  [ getVisibleTodos, getKeyword ],</div><div class="line">  (visibleTodos, keyword) =&gt; visibleTodos.filter(</div><div class="line">    <span class="function"><span class="params">todo</span> =&gt;</span> todo.text.indexOf(keyword) &gt; <span class="number">-1</span></div><div class="line">  )</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###è¿æ¥ä¸€ä¸ªSelectoråˆ°Redux Store<br>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ <a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">React Redux</a>, ä½ å¯ä»¥ç›´æ¥ä¼ é€’selectoråˆ° <code>mapStateToProps()</code>:</p>
<h4 id="containers-VisibleTodoList-js-1"><a href="#containers-VisibleTodoList-js-1" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>###åœ¨React Propsä¸­æ¥å…¥Selectors</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å‡è®¾ç¨‹åºå°†ä¼šæœ‰ä¸€ä¸ªæ‰©å±•,æˆ‘ä»¬å…è®¸selectoræ”¯æŒå¤štodo List.è¯·æ³¨æ„å¦‚æœè¦å®Œå…¨å®æ–½è¿™ä¸ªæ‰©å±•,reducers,components,actionsç­‰ç­‰éƒ½éœ€è¦ä½œå‡ºæ”¹å˜.è¿™äº›å†…å®¹å’Œä¸»é¢˜ä¸æ˜¯å¤ªç›¸å…³,æ‰€ä»¥è¿™é‡Œå°±çœç•¥æ‰äº†.</p>
</blockquote>
<p>ç›®å‰ä¸ºæ­¢,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°selectorsæ¥æ”¶storeçš„stateä½œä¸ºä¸€ä¸ªå‚æ•°,å…¶å®ä¸€ä¸ªselectorå¶å¯ä»¥æ¥å—props.</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ª<code>App</code>ç»„ä»¶,æ¸²æŸ“å‡ºä¸‰ä¸ª<code>VisibleTodoList</code>ç»„ä»¶,æ¯ä¸€ä¸ªç»„ä»¶æœ‰<code>ListId</code>å±æ€§.</p>
<h4 id="components-App-js"><a href="#components-App-js" class="headerlink" title="components/App.js"></a><code>components/App.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer'</span></div><div class="line"><span class="keyword">import</span> AddTodo <span class="keyword">from</span> <span class="string">'../containers/AddTodo'</span></div><div class="line"><span class="keyword">import</span> VisibleTodoList <span class="keyword">from</span> <span class="string">'../containers/VisibleTodoList'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;VisibleTodoList listId="1" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="2" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="3" /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ª<code>VisibleTodoList</code>containeråº”è¯¥æ ¹æ®å„è‡ªçš„<code>listId</code>å±æ€§è·å–stateçš„ä¸åŒéƒ¨åˆ†.æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code>getVisibilityFilter</code>å’Œ<code>getTodos</code>,ä¾¿äºæ¥å—ä¸€ä¸ªå±æ€§å‚æ•°</p>
<h4 id="selectors-todoSelectors-js"><a href="#selectors-todoSelectors-js" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos <span class="comment">//è¿™é‡Œæ˜¯ä¸ºäºŒç»´æ•°ç»„äº†</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> getVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p><code>props</code>å¯ä»¥ä»<code>mapStateToProps</code>ä¼ é€’åˆ°<code>getVisibleTodos</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨<code>getVisibleTodos</code>å¯ä»¥è·å–<code>props</code>,æ¯ä¸€éƒ¨åˆ†ä¼¼ä¹éƒ½å·¥ä½œçš„ä¸é”™.</p>
<p><em>**ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜</em><br>å½“<code>getVisibleTodos</code>selectorå’Œ<code>VisibleTodoList</code>containerçš„å¤šä¸ªå®ä¾‹ä¸€èµ·å·¥ä½œçš„æ—¶å€™,è®°å¿†åŠŸèƒ½å°±ä¸èƒ½æ­£å¸¸çš„è¿è¡Œ:</p>
<h4 id="containers-VisibleTodoList-js-2"><a href="#containers-VisibleTodoList-js-2" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">// WARNING: THE FOLLOWING SELECTOR DOES NOT CORRECTLY MEMOIZE</span></div><div class="line">    <span class="comment">//âš ï¸ä¸‹é¢çš„selectorä¸èƒ½æ­£ç¡®çš„è®°å¿†</span></div><div class="line">    todos: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ—¶å€™,å¦‚æœä»–çš„å‚æ•°é›†åˆå’Œä¸Šä¸€æ¬¡çš„å‚æ•°æœºä¼šæ˜¯ä¸€æ ·çš„,ä»…ä»…è¿”å›ç¼“å­˜çš„å€¼.å¦‚æœæˆ‘ä»¬äº¤æ›¿æ¸²æŸ“<code>&lt;VisibleTodoList listId=&quot;1&quot; /&gt;</code> å’Œ<code>&lt;VisibleTodoList listId=&quot;2&quot; /&gt;</code>æ—¶,å…±äº«çš„selectorå°†ä¼šäº¤æ›¿æ¥å—<code>{listIdï¼š1}</code>å’Œ<code>{listId:2}</code>ä½œä¸ºä»–çš„propsçš„å‚æ•°.è¿™å°†ä¼šå¯¼è‡´æ¯ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™çš„å‚æ•°éƒ½ä¸åŒ,å› æ­¤selectoræ¯æ¬¡éƒ½ä¼šé‡æ–°æ¥è®¡ç®—è€Œä¸æ˜¯è¿”å›ç¼“å­˜çš„å€¼.ä¸‹ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†ä¼šä»‹ç»æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜.</p>
<p>###è·¨è¶Šå¤šä¸ªç»„ä»¶ä½¿ç”¨selectorså…±æ€§props</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†çš„å®ä¾‹éœ€è¦React Redux v4.3.0æˆ–è€…æ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒ.</p>
</blockquote>
<p>åœ¨å¤šä¸ª<code>VisibleTodoList</code>ç»„ä»¶ä¸­å…±äº«selector,åŒæ—¶è¿˜è¦<strong>ä¿æŒ</strong>è®°å¿†æ€§,æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹éœ€è¦ä»–ä»¬è‡ªå·±çš„selectorå¤‡ä»½.</p>
<p>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°<code>makeGetVisibleTodos</code>,è¿™ä¸ªå‡½æ•°æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™è¿”å›ä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>çš„æ‹·è´:</p>
<h4 id="selectors-todoSelectors-js-1"><a href="#selectors-todoSelectors-js-1" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos</div><div class="line"></div><div class="line"><span class="keyword">const</span> makeGetVisibleTodos = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    [ getVisibilityFilter, getTodos ],</div><div class="line">    (visibilityFilter, todos) =&gt; &#123;</div><div class="line">      <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">          <span class="keyword">return</span> todos</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeGetVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦è®¾ç½®ç»™æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹ä»–ä»¬å„è‡ªè·å–ç§æœ‰çš„selectoræ–¹æ³•.<code>mapStateToProps</code>çš„<code>connect</code>å‡½æ•°å¯ä»¥å¸®åŠ©å®Œæˆè¿™ä¸ªåŠŸèƒ½.</p>
<p><em>**å¦‚æœ<code>mapStateToProps</code>æä¾›ç»™<code>connect</code>ä¸è¿”å›ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°,ä»–å°±å¯ä»¥è¢«ç”¨æ¥ä¸ºæ¯ä¸ªç»„ä»¶containeråˆ›å»ºä¸€ä¸ªç§æœ‰çš„<code>mapStateProps</code>å‡½æ•°.</em></p>
<p>åœ¨ä¸‹é¢çš„å®ä¾‹ä¸­,<code>mapStateProps</code>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>selector,ä»–è¿”å›ä¸€ä¸ª<code>mapStateToProps</code>å‡½æ•°,è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ¥å…¥æ–°çš„selector.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœæˆ‘ä»¬æŠŠ<code>makeMapStateToprops</code>ä¼ é€’åˆ°<code>connect</code>,æ¯ä¸€ä¸ª<code>visibleTodoList</code>containerå°†ä¼šè·å¾—å„è‡ªçš„å«æœ‰ç§æœ‰<code>getVisibleTodos</code>selectorçš„<code>mapStateToProps</code>çš„å‡½æ•°.è¿™æ ·ä¸€æ¥è®°å¿†å°±æ­£å¸¸äº†,ä¸ç®¡<code>VisibleTodoList</code>containersçš„æ¸²æŸ“é¡ºåºæ€ä¹ˆæ ·.</p>
<h4 id="containers-VisibleTodoList-js-3"><a href="#containers-VisibleTodoList-js-3" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; makeGetVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  makeMapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>##API</p>
<p>###createSelector(â€¦inputSelectors|[inputSelectors],resultFunc)</p>
<p>æ¥å—ä¸€ä¸ªæˆ–è€…å¤šä¸ªselectors,æˆ–è€…ä¸€ä¸ªselectorsæ•°ç»„,è®¡ç®—ä»–ä»¬çš„å€¼å¹¶ä¸”ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>resultFunc</code>.</p>
<p><code>createSelector</code>é€šè¿‡åˆ¤æ–­input-selectorä¹‹å‰è°ƒç”¨å’Œä¹‹åè°ƒç”¨çš„è¿”å›å€¼çš„å…¨ç­‰äº(===,è¿™ä¸ªåœ°æ–¹è‹±æ–‡æ–‡çŒ®å«reference equality,å¼•ç”¨ç­‰äº,è¿™ä¸ªå•è¯æ˜¯æœ¬è´¨,ä¸­æ–‡æ²¡æœ‰ç¿»è¯‘å‡ºæ¥).ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„selectoråº”è¯¥æ˜¯immutable(ä¸å˜çš„).</p>
<p>ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„Selectorsæœ‰ä¸€ä¸ªç¼“å­˜,å¤§å°æ˜¯1.è¿™æ„å‘³ç€å½“ä¸€ä¸ªinput-selectorå˜åŒ–çš„æ—¶å€™,ä»–ä»¬æ€»æ˜¯ä¼šé‡æ–°è®¡ç®—state,å› ä¸ºSelectorä»…ä»…å­˜å‚¨æ¯ä¸€ä¸ªinput-selectorå‰ä¸€ä¸ªå€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">  state =&gt; state.values.value2,</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// You can also pass an array of selectors</span></div><div class="line"><span class="comment">//å¯ä»¥å‡ºä¼ é€’ä¸€ä¸ªselectoræ•°ç»„</span></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  [</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">    state =&gt; state.values.value2</div><div class="line">  ],</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨selectorå†…éƒ¨è·å–ä¸€ä¸ªç»„ä»¶çš„propséå¸¸æœ‰ç”¨.å½“ä¸€ä¸ªselectoré€šè¿‡<code>connect</code>å‡½æ•°è¿æ¥åˆ°ä¸€ä¸ªç»„ä»¶ä¸Š,ç»„ä»¶çš„å±æ€§ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> abSelector = <span class="function">(<span class="params">state, props</span>) =&gt;</span> state.a * props.b</div><div class="line"></div><div class="line"><span class="comment">// props only (ignoring state argument)</span></div><div class="line"><span class="keyword">const</span> cSelector =  <span class="function">(<span class="params">_, props</span>) =&gt;</span> props.c</div><div class="line"></div><div class="line"><span class="comment">// state only (props argument omitted as not required)</span></div><div class="line"><span class="keyword">const</span> dSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.d</div><div class="line"></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  abSelector,</div><div class="line">  cSelector,</div><div class="line">  dSelector,</div><div class="line">  (ab, c, d) =&gt; (&#123;</div><div class="line">    <span class="attr">total</span>: ab + c + d</div><div class="line">  &#125;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###defaultMemoize(func, equalityCheck = defaultEqualityCheck)</p>
<p><code>defaultMemoize</code>èƒ½è®°ä½é€šè¿‡funcä¼ é€’çš„å‚æ•°.è¿™æ˜¯<code>createSelector</code>ä½¿ç”¨çš„è®°å¿†å‡½æ•°.</p>
<p><code>defaultMemoize</code> é€šè¿‡è°ƒç”¨<code>equalityCheck</code>å‡½æ•°æ¥å†³å®šä¸€ä¸ªå‚æ•°æ˜¯å¦å·²ç»å‘ç”Ÿæ”¹å˜.å› ä¸º<code>defaultMemoize</code>è®¾è®¡å‡ºæ¥å°±æ˜¯å’Œimmutableæ•°æ®ä¸€èµ·ä½¿ç”¨,é»˜è®¤çš„<code>equalityCheck</code>ä½¿ç”¨å¼•ç”¨å…¨ç­‰äºæ¥åˆ¤æ–­å˜åŒ–:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaultEqualityCheck</span>(<span class="params">currentVal, previousVal</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> currentVal === previousVal</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><code>defaultMemoize</code>å’Œ<code>createSelectorCreator</code>å»<a href="#é…ç½®-equalitycheck-for-defaultmemoize">é…ç½®<code>equalityCheck</code>å‡½æ•°</a>.</p>
<p>###createSelectorCreator(memoize,â€¦memoizeOptions)</p>
<p><code>createSelectorCreator</code>ç”¨æ¥é…ç½®å®šåˆ¶ç‰ˆæœ¬çš„<code>createSelector</code>.</p>
<p><code>memoize</code>å‚æ•°æ˜¯ä¸€ä¸ªæœ‰è®°å¿†åŠŸèƒ½çš„å‡½æ•°,æ¥ä»£æ›¿<code>defaultMemoize</code>.<br><code>â€¦memoizeOption</code>å±•å¼€çš„å‚æ•°æ˜¯0æˆ–è€…æ›´å¤šçš„é…ç½®é€‰é¡¹,è¿™äº›å‚æ•°ä¼ é€’ç»™<code>memoizeFunc</code>.selectors<code>resultFunc</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>memoize</code>,<code>memoizeOptions</code>ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(</div><div class="line">  customMemoize, <span class="comment">// function to be used to memoize resultFunc,è®°å¿†resultFunc</span></div><div class="line">  option1, <span class="comment">// option1 will be passed as second argument to customMemoize ç¬¬äºŒä¸ªæƒ¨å‘¼</span></div><div class="line">  option2, <span class="comment">// option2 will be passed as third argument to customMemoize ç¬¬ä¸‰ä¸ªå‚æ•°</span></div><div class="line">  option3 <span class="comment">// option3 will be passed as fourth argument to customMemoize   ç¬¬å››ä¸ªå‚æ•°</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> customSelector = customSelectorCreator(</div><div class="line">  input1,</div><div class="line">  input2,</div><div class="line">  resultFunc <span class="comment">// resultFunc will be passed as first argument to customMemoize  ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™customMomize</span></div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨<code>customSelecotr</code>å†…éƒ¨æ»´å•Šç”¨memoizeçš„å‡½æ•°çš„ä»£ç å¦‚ä¸‹:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">customMemoize(resultFunc, option1, option2, option3)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªå¯èƒ½ä¼šç”¨åˆ°çš„<code>createSelectorCreator</code>çš„å®ä¾‹:</p>
<p>####ä¸º<code>defaultMemoize</code>é…ç½®<code>equalityCheck</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.filter(<span class="function"><span class="params">val</span> =&gt;</span> val &lt; <span class="number">5</span>),</div><div class="line">  values =&gt; values.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>####ä½¿ç”¨loadshçš„memoizeå‡½æ•°æ¥ç¼“å­˜æœªç»‘å®šçš„ç¼“å­˜.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> called = <span class="number">0</span></div><div class="line"><span class="keyword">const</span> hashFn = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.reduce(</div><div class="line">  <span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + <span class="string">'-'</span> + <span class="built_in">JSON</span>.stringify(val),</div><div class="line">  <span class="string">''</span></div><div class="line">)</div><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(memoize, hashFn)</div><div class="line"><span class="keyword">const</span> selector = customSelectorCreator(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; &#123;</div><div class="line">    called++</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<h3 id="createStructuredSelector-inputSelectors-selectorCreator-createSelector"><a href="#createStructuredSelector-inputSelectors-selectorCreator-createSelector" class="headerlink" title="createStructuredSelector({inputSelectors}, selectorCreator = createSelector)"></a>createStructuredSelector({inputSelectors}, selectorCreator = createSelector)</h3><p>å¦‚æœåœ¨æ™®é€šçš„æ¨¡å¼ä¸‹ä½¿ç”¨<code>createStructuredSelector</code>å‡½æ•°å¯ä»¥æå‡ä¾¿åˆ©æ€§.ä¼ é€’åˆ°<code>connect</code>çš„selectorè£…é¥°è€…(è¿™æ˜¯jsè®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ,å¯ä»¥å‚è€ƒç›¸å…³çš„ä¹¦ç±)æ¥å—ä»–çš„input-selectors,å¹¶ä¸”åœ¨ä¸€ä¸ªå¯¹è±¡å†…æ˜ å°„åˆ°ä¸€ä¸ªé”®ä¸Š.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="comment">// The result function in the following selector</span></div><div class="line"><span class="comment">// is simply building an object from the input selectors ç”±selectorsæ„å»ºçš„ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"><span class="keyword">const</span> structuredSelector = createSelector(</div><div class="line">   mySelectorA,</div><div class="line">   mySelectorB,</div><div class="line">   mySelectorC,</div><div class="line">   (a, b, c) =&gt; (&#123;</div><div class="line">     a,</div><div class="line">     b,</div><div class="line">     c</div><div class="line">   &#125;)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p><code>createStructuredSelector</code>æ¥å—ä¸€ä¸ªå¯¹è±¡,è¿™ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯input-selectors,å‡½æ•°è¿”å›ä¸€ä¸ªç»“æ„æ€§çš„selector.è¿™ä¸ªç»“æ„æ€§çš„selectorè¿”å›ä¸€ä¸ªå¯¹è±¡,å¯¹è±¡çš„é”®å’Œ<code>inputSelectors</code>çš„å‚æ•°æ˜¯ç›¸åŒçš„,ä½†æ˜¯ä½¿ç”¨selectorsä»£æ›¿äº†å…¶ä¸­çš„å€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="keyword">const</span> structuredSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">x</span>: mySelectorA,</div><div class="line">  <span class="attr">y</span>: mySelectorB</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> result = structuredSelector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;) <span class="comment">// will produce &#123; x: 1, y: 2 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<p>ç»“æ„æ€§çš„selectorså¯ä»¥æ˜¯åµŒå¥—å¼çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nestedSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">subA</span>: createStructuredSelector(&#123;</div><div class="line">    selectorA,</div><div class="line">    selectorB</div><div class="line">  &#125;),</div><div class="line">  <span class="attr">subB</span>: createStructuredSelector(&#123;</div><div class="line">    selectorC,</div><div class="line">    selectorD</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>##FAQ</p>
<h3 id="Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"><a href="#Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ" class="headerlink" title="Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"></a>Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ</h3><p>A:æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†éŸ©å¼æ˜¯ä¸æ˜¯å’Œä½ çš„stateæ›´æ–°å‡½æ•°ç›¸å…¼å®¹(ä¾‹å¦‚:å¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux).ä¾‹å¦‚:ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŸæ¥æœŸå¾…çš„æ˜¯æ›´æ–°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡.<code>createSelector</code>ä½¿ç”¨(===)æ£€æµ‹è¾“å…¥æ˜¯å¦æ”¹å˜,å› æ­¤å¦‚æœæ”¹å˜ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡æ²¡æœ‰è§¦å‘selectoré‡æ–°è®¡ç®—çš„åŸå› æ˜¯æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™æ²¡æœ‰è§¦å‘ç›¸å…³çš„æ£€æµ‹.æç¤ºï¼šå¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux,æ”¹å˜ä¸€ä¸ªstateå¯¹è±¡çš„<a href="http://redux.js.org/docs/Troubleshooting.html" target="_blank" rel="external">é”™è¯¯å¯èƒ½æœ‰</a>.</p>
<p>ä¸‹é¢çš„å®ä¾‹å®šä¹‰äº†ä¸€ä¸ªselectorå¯ä»¥å†³å®šæ•°ç»„çš„ç¬¬ä¸€ä¸ªtodoé¡¹ç›®æ˜¯ä¸æ˜¯å·²ç»è¢«å®Œæˆ:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> isFirstTodoCompleteSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.todos[<span class="number">0</span>],</div><div class="line">  todo =&gt; todo &amp;&amp; todo.completed</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoCompleteSelector</code><strong>å°†ä¸ä¼š</strong>æ­£å¸¸å·¥ä½œå·¥ä½œ:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// BAD: mutating an existing object</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      todo.completed = !areAllMarked</div><div class="line">      <span class="keyword">return</span> todo</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoComplete</code>ä¸€èµ·<strong>å¯ä»¥</strong>æ­£å¸¸å·¥ä½œ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// GOOD: returning a new object each time with Object.assign</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, todo, &#123;</div><div class="line">      <span class="attr">completed</span>: !areAllMarked</div><div class="line">    &#125;))</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨Redux,ä½†æ˜¯æœ‰ä½¿ç”¨mutableæ•°æ®çš„éœ€æ±‚,ä½ å¯ä»¥ä½¿ç”¨<code>createSelectorCreator</code>ä»£æ›¿é»˜è®¤çš„è®°å¿†å‡½æ•°,å¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç­‰å€¼æ£€æµ‹å‡½æ•°.è¯·å‚çœ‹<a href="#use-memoize-function-from-lodash-for-an-unbounded-cache">è¿™é‡Œ</a> å’Œ <a href="#customize-equalitycheck-for-defaultmemoize">è¿™é‡Œ</a>ä½œä¸ºå‚è€ƒ.</p>
<p>###Q:ä¸ºä»€ä¹ˆinput stateæ²¡æœ‰æ”¹å˜çš„æ—¶å€™,selectorè¿˜æ˜¯ä¼šé‡æ–°è®¡ç®—?</p>
<p>A: æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†å‡½æ•°å’Œä½ ä½ çš„stateæ›´æ–°å‡½æ•°æ˜¯ä¸æ˜¯å…¼å®¹(å¦‚æœæ˜¯ä½¿ç”¨Reduxçš„æ—¶å€™,çœ‹çœ‹reducer).ä¾‹å¦‚:ä½¿ç”¨æ¯ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™,ä¸ç®¡å€¼æ˜¯ä¸æ˜¯å‘ç”Ÿæ”¹å˜,<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯ä¼šæ”¶åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡.<code>createSelector</code>å‡½æ•°ä½¿ç”¨(<code>===</code>)æ£€æµ‹inputçš„å˜åŒ–,ç”±æ­¤å¯çŸ¥å¦‚æœæ¯æ¬¡éƒ½è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,è¡¨ç¤ºselectoræ€»æ˜¯åœ¨æ¯æ¬¡æ›´æ–°çš„æ—¶å€™é‡æ–°è®¡ç®—.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">return</span> state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„selectoråœ¨æ¯ä¸€æ¬¡REMOVE_OLDè°ƒç”¨çš„æ—¶å€™,éƒ½ä¼šé‡æ–°è®¡ç®—,å› ä¸ºArray.filteræ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡.ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,REMOVE_OLD actionéƒ½ä¸ä¼šæ”¹å˜todoåˆ—è¡¨,æ‰€ä»¥é‡æ–°è®¡ç®—æ˜¯ä¸å¿…è¦çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> visibleTodosSelector = createSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä½ å¯ä»¥é€šè¿‡stateæ›´æ–°å‡½æ•°è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—æ“ä½œ,è¿™ä¸ªå¯¹è±¡æ‰§è¡Œæ·±åº¦ç­‰å€¼æ£€æµ‹,åªæœ‰æ·±åº¦ä¸ç›¸åŒçš„æ—¶å€™æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">const</span> updatedState =  state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">return</span> isEqual(updatedState, state) ? state : updatedState</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ›¿ä»£çš„æ–¹æ³•æ˜¯,åœ¨selectorä¸­ä½¿ç”¨æ·±åº¦æ£€æµ‹æ–¹æ³•æ›¿ä»£é»˜è®¤çš„<code>equalityCheck</code>å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ£€æŸ¥<code>equalityCheck</code>å‡½æ•°çš„æ›´æ›¿æˆ–è€…åœ¨stateæ›´æ–°å‡½æ•°ä¸­åšæ·±åº¦æ£€æµ‹å¹¶ä¸æ€»æ˜¯æ¯”é‡è®¡ç®—çš„èŠ±é”€å°.å¦‚æœæ¯æ¬¡é‡è®¡ç®—çš„èŠ±é”€æ€»æ˜¯æ¯”è¾ƒå°,å¯èƒ½çš„åŸå› æ˜¯Reselectæ²¡æœ‰é€šè¿‡<code>connect</code>å‡½æ•°ä¼ é€’<code>mapStateProps</code>å•çº¯å¯¹è±¡çš„åŸå› .</p>
<h3 id="Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"><a href="#Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ" class="headerlink" title="Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"></a>Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ</h3><p>A:å¯ä»¥.Reselectæ²¡æœ‰å…¶ä»–ä»»ä½•çš„ä¾èµ–åŒ…,å› æ­¤å°½ç®¡ä»–è®¾è®¡çš„å’ŒReduxæ¯”è¾ƒæ­é…,ä½†æ˜¯ç‹¬ç«‹ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„.ç›®å‰çš„ç‰ˆæœ¬åœ¨ä¼ ç»Ÿçš„Flux APPä¸‹ä½¿ç”¨æ˜¯æ¯”è¾ƒæˆåŠŸçš„.</p>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectors,éœ€è¦ç¡®ä¿ä»–çš„å‚æ•°æ˜¯immutableçš„.</p>
<p>çœ‹<a href="#createselectorinputselectors--inputselectors-resultfunc">è¿™é‡Œ</a></p>
</blockquote>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector"><a href="#Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector."></a>Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector.</h3><p>A:Reselectæ²¡æœ‰æ”¯æŒåˆ›å»ºæ¥æ”¶å‚æ•°çš„selectors,ä½†æ˜¯è¿™é‡Œæœ‰ä¸€äº›å®ç°ç±»ä¼¼å‡½æ•°åŠŸèƒ½çš„å»ºè®®.</p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯åŠ¨æ€çš„,ä½ å¯ä»¥ä½¿ç”¨å·¥å‚å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> expensiveItemSelectorFactory = <span class="function"><span class="params">minValue</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    shopItemsSelector,</div><div class="line">    items =&gt; items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  expensiveItemSelectorFactory(<span class="number">200</span>),</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ€»çš„è¾¾æˆå…±è¯†<a href="https://github.com/reactjs/reselect/issues/38" target="_blank" rel="external">çœ‹è¿™é‡Œ</a>å’Œ<a href="https://github.com/optimizely/nuclear-js/issues/14" target="_blank" rel="external">è¶…è¶Š neclear-js</a>æ˜¯:å¦‚æœä¸€ä¸ªselectoréœ€è¦åŠ¨æ€çš„å‚æ•°,é‚£ä¹ˆå‚æ•°åº”è¯¥æ˜¯storeä¸­çš„state.å¦‚æœä½ å†³å®šå¥½äº†åœ¨åº”ç”¨ä¸­ä½¿ç”¨åŠ¨æ€å‚æ•°,åƒä¸‹é¢è¿™æ ·è¿”å›ä¸€ä¸ªè®°å¿†å‡½æ•°æ˜¯æ¯”è¾ƒåˆé€‚çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.items,</div><div class="line">  items =&gt; memoize(</div><div class="line">    <span class="function"><span class="params">minValue</span> =&gt;</span> items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveFilter = expensiveSelector(state)</div><div class="line"></div><div class="line"><span class="keyword">const</span> slightlyExpensive = expensiveFilter(<span class="number">100</span>)</div><div class="line"><span class="keyword">const</span> veryExpensive = expensiveFilter(<span class="number">1000000</span>)</div></pre></td></tr></table></figure>
<hr>
<h3 id="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"><a href="#Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ" class="headerlink" title="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"></a>Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ</h3><p>A: æˆ‘è®¤ä¸ºè¿™ä¸ªè®°å¿†éŸ©å¼å·¥ä½œçš„è¿˜å¯ä»¥,ä½†æ˜¯å¦‚æœä½ éœ€è¦ä¸€ä¸ªå…¶ä»–çš„éŸ©å¼ä¹Ÿæ˜¯å¯ä»¥çš„.<br>å¯ä»¥çœ‹çœ‹è¿™ä¸ª<a href="#customize-equalitycheck-for-defaultmemoize">ä¾‹å­</a></p>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector"><a href="#Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?"></a>Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?</h3><p>A:å¯¹äºä¸€ä¸ªç»™å®šçš„input,ä¸€ä¸ªselectoræ€»æ˜¯äº§å‡ºç›¸åŒçš„ç»“æœ.åŸºäºè¿™ä¸ªåŸå› ,åšå•å…ƒæµ‹è¯•æ˜¯éå¸¸ç®€å•çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> selector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; (&#123;</div><div class="line">    <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">    <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">  &#125;)</div><div class="line">)</div><div class="line"></div><div class="line">test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">6</span> &#125;)</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">3</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨stateæ›´æ–°å‡½æ•°è°ƒç”¨çš„æ—¶å€™åŒæ—¶æ£€æµ‹selectorçš„è®°å¿†å‡½æ•°çš„åŠŸèƒ½ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„(ä¾‹å¦‚ ä½¿ç”¨Reduxçš„æ—¶å€™æ£€æŸ¥reducer).æ¯ä¸€ä¸ªselectoréƒ½æœ‰ä¸€ä¸ª<code>recomputations</code>æ–¹æ³•è¿”å›é‡æ–°è®¡ç®—çš„æ¬¡æ•°:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">suite(<span class="string">'selector'</span>, () =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> state = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> (</div><div class="line">    &#123;</div><div class="line">      <span class="attr">a</span>: action(state.a),</div><div class="line">      <span class="attr">b</span>: action(state.b)</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> selector = createSelector(</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">    state =&gt; state.b,</div><div class="line">    (a, b) =&gt; (&#123;</div><div class="line">      <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">      <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> plusOne = <span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span></div><div class="line">  <span class="keyword">const</span> id = <span class="function"><span class="params">x</span> =&gt;</span> x</div><div class="line"></div><div class="line">  test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    state = reducer(state, id)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">1</span>)</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">6</span>, <span class="attr">d</span>: <span class="number">12</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">2</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<hr>
<p>å¦å¤–,selectorsä¿ç•™äº†æœ€åä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æœçš„å¼•ç”¨,è¿™ä¸ªå¼•ç”¨ä½œä¸º<code>.resultFunc</code>.å¦‚æœä½ å·²ç»èšåˆäº†å…¶ä»–çš„selectors,è¿™ä¸ªå‡½æ•°å¼•ç”¨å¯ä»¥å¸®åŠ©ä½ æµ‹è¯•æ¯ä¸€ä¸ªselector,ä¸éœ€è¦ä»stateä¸­è§£è€¦æµ‹è¯•.</p>
<p>ä¾‹å¦‚å¦‚æœä½ çš„selectorsé›†åˆåƒä¸‹é¢è¿™æ ·:<br><strong>selectors.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> firstSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> secondSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> thirdSelector = createSelector( ... )</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> myComposedSelector = createSelector(</div><div class="line">  firstSelector,</div><div class="line">  secondSelector,</div><div class="line">  thirdSelector,</div><div class="line">  (first, second, third) =&gt; first * second &lt; third</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>å•å…ƒæµ‹è¯•å°±åƒä¸‹é¢è¿™æ ·:<br><strong>test/selectors.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests for the first three selectors...</span></div><div class="line">test(<span class="string">"firstSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"secondSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"thirdSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line"></div><div class="line"><span class="comment">// We have already tested the previous</span></div><div class="line"><span class="comment">// three selector outputs so we can just call `.resultFunc`</span></div><div class="line"><span class="comment">// with the values we want to test directly:</span></div><div class="line">test(<span class="string">"myComposedSelector unit test"</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// here instead of calling selector()</span></div><div class="line">  <span class="comment">// we just call selector.resultFunc()</span></div><div class="line">  assert(selector.resultFunc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="literal">true</span>)</div><div class="line">  assert(selector.resultFunc(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>), <span class="literal">false</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>æœ€å,æ¯ä¸€ä¸ªselectoræœ‰ä¸€ä¸ª<code>resetRecomputations</code>æ–¹æ³•,é‡ç½®recomputationsæ–¹æ³•ä¸º0,è¿™ä¸ªå‚æ•°çš„æ„å›¾æ˜¯åœ¨é¢å¯¹å¤æ‚çš„selectorçš„æ—¶å€™,éœ€è¦å¾ˆå¤šç‹¬ç«‹çš„æµ‹è¯•,ä½ ä¸éœ€è¦ç®¡ç†å¤æ‚çš„æ‰‹å·¥è®¡ç®—,æˆ–è€…ä¸ºæ¯ä¸€ä¸ªæµ‹è¯•åˆ›å»ºâ€å‚»ç“œâ€selector.</p>
<h3 id="Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨"><a href="#Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨" class="headerlink" title="Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?"></a>Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?</h3><p>A:<code>creatSelector</code>åˆ›å»ºçš„Selectorsåº”è¯¥å¯ä»¥å’ŒImmutable.jsæ•°æ®ç»“æ„ä¸€èµ·å®Œç¾çš„å·¥ä½œ.<br>å¦‚æœä½ çš„selectoræ­£åœ¨é‡è®¡ç®—,å¹¶ä¸”ä½ è®¤ä¸ºstateæ²¡æœ‰å‘ç”Ÿå˜åŒ–,ä¸€å®šè¦ç¡®ä¿çŸ¥é“å“ªä¸€ä¸ªImmutable.jsæ›´æ–°æ–¹æ³•,è¿™ä¸ªæ–¹æ³•åªè¦ä¸€æ›´æ–°<strong>æ€»æ˜¯</strong>è¿”å›æ–°å¯¹è±¡.å“ªä¸€ä¸ªæ–¹æ³•åªæœ‰<strong>é›†åˆå®é™…å‘ç”Ÿå˜åŒ–çš„æ—¶å€™</strong>æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Immutable <span class="keyword">from</span> <span class="string">'immutable'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = Immutable.Map(&#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"> <span class="comment">// set, merge and others only return a new obj when update changes collection</span></div><div class="line"><span class="keyword">let</span> newMap = myMap.set(<span class="string">'a'</span>, <span class="number">1</span>)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line">newMap = myMap.merge(&#123; <span class="string">'a'</span>, <span class="number">1</span> &#125;)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line"><span class="comment">// map, reduce, filter and others always return a new obj</span></div><div class="line">newMap = myMap.map(<span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">1</span>)</div><div class="line">assert.notEqual(myMap, newMap)</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä¸€ä¸ªæ“ä½œå¯¼è‡´çš„selectoræ›´æ–°æ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,å¯èƒ½ä¼šå‘ç”Ÿä¸å¿…è¦çš„é‡è®¡ç®—.<a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">çœ‹è¿™é‡Œ</a>.è¿™æ˜¯ä¸€ä¸ªå…³äºprosçš„è®¨è®º,ä½¿ç”¨æ·±å…¨ç­‰äºæ¥æ£€æµ‹ä¾‹å¦‚<code>immutable.js</code>æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—è¿‡ç¨‹.</p>
<h3 id="Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"><a href="#Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ" class="headerlink" title="Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"></a>Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ</h3><p>A: ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„Selectorçš„ç¼“å­˜çš„å¤§å°åªæœ‰1.è¿™ä¸ªè®¾å®šä½¿å¾—å¤šä¸ªç»„ä»¶çš„å®ä¾‹ä¹‹é—´çš„å‚æ•°ä¸åŒ,è·¨ç»„ä»¶å…±äº«selectorå˜å¾—ä¸åˆé€‚.è¿™é‡Œä¹Ÿæœ‰å‡ ç§åŠæ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜:</p>
<ul>
<li>ä½¿ç”¨å·¥ç¨‹å‡½æ•°æ–¹æ³•,ä¸ºæ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹åˆ›å»ºä¸€ä¸ªæ–°çš„selector.è¿™é‡Œæœ‰ä¸€ä¸ªå†…å»ºçš„å·¥å‚æ–¹æ³•,React Redux v4.3æˆ–è€…æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨. <a href="#sharing-selectors-with-props-across-multiple-components">çœ‹è¿™é‡Œ</a></li>
<li>åˆ›å»ºä¸€ä¸ªç¼“å­˜å°ºå¯¸å¤§äº1çš„å®šåˆ¶selector.</li>
</ul>
<h3 id="Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"><a href="#Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ" class="headerlink" title="Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"></a>Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ</h3><p>A: æ˜¯çš„ï¼ä»–ä»¬åŒ…å«åœ¨<code>package.json</code>é‡Œ.å¯ä»¥å¾ˆå¥½çš„å·¥ä½œ.</p>
<h3 id="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector"><a href="#Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector" class="headerlink" title="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector?"></a>Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ª<a href="https://github.com/hemanth/functional-programming-jargon#currying" target="_blank" rel="external">æŸ¯é‡ŒåŒ–</a>selector?</h3><p>Aï¼šå°è¯•ä¸€äº›è¿™é‡Œ<a href="https://github.com/reactjs/reselect/issues/159#issuecomment-238724788" target="_blank" rel="external">åŠ©æ‰‹å‡½æ•°</a>,ç”±<a href="https://github.com/MattSPalmer" target="_blank" rel="external">MattSPalmer</a>æä¾›</p>
<h2 id="æœ‰å…³çš„é¡¹ç›®"><a href="#æœ‰å…³çš„é¡¹ç›®" class="headerlink" title="æœ‰å…³çš„é¡¹ç›®"></a>æœ‰å…³çš„é¡¹ç›®</h2><h3 id="reselect-map"><a href="#reselect-map" class="headerlink" title="reselect-map"></a><a href="https://github.com/HeyImAlex/reselect-map" target="_blank" rel="external">reselect-map</a></h3><p>å› ä¸ºReselectä¸å¯èƒ½ä¿è¯ç¼“å­˜ä½ æ‰€æœ‰çš„éœ€æ±‚,åœ¨åš<strong>éå¸¸æ˜‚è´µçš„è®¡ç®—</strong>çš„æ—¶å€™,è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæœ‰ç”¨.æŸ¥çœ‹ä¸€ä¸‹reselect-maps readme</p>
<p><strong>reselect-mapçš„ä¼˜åŒ–æªæ–½ä»…ä»…ä½¿ç”¨åœ¨ä¸€äº›å°çš„æ¡ˆä¾‹ä¸­,å¦‚æœä½ ä¸ç¡®å®šæ˜¯ä¸æ˜¯éœ€è¦ä»–,å°±ä¸è¦ä½¿ç”¨å®ƒ</strong>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptè®¾è®¡åŸåˆ™-å•ä¸€èŒè´£]]></title>
      <url>http://yoursite.com/2017/03/09/javascript%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3/</url>
      <content type="html"><![CDATA[<p>å‰é¢æŠŠjavascriptçš„è®¾è®¡æ¨¡å¼åŸºæœ¬è¿‡äº†ä¸€éï¼Œå¯ä»¥è¯´æ˜¯æ„Ÿæ…¨å¾ˆå¤šï¼Œè®¸å¤šçš„æ€æƒ³éƒ½æ˜¯ä»æœªæ¥è§¦è¿‡çš„ï¼Œå­¦èµ·æ¥éš¾åº¦ä¹Ÿä¸å°ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆå€¼å¾—çš„ã€‚å¦‚æœä»¥å‰æ˜¯åœ¨è¶³çƒåœºä¸Šè¸¢é‡çƒçš„è¯ï¼Œç°åœ¨æ€»ç®—æ‰¾åˆ°ä¸€ä¸ªåƒæ¨¡åƒæ ·çš„æ•™ç»ƒåœ¨æŒ‡å¯¼äº†ï¼Œä¸ä¸€å®šä¼šæˆä¸ºä¸€ä¸ªä¸–ç•Œçº§çš„çƒæ˜Ÿï¼Œä½†æ˜¯æ°´å¹³è‡³å°‘ä¹Ÿä¼šæ¯”ä»¥å‰æé«˜å¾ˆå¤šã€‚<br>æ¥ä¸‹æ¥ä¼šçœ‹çœ‹ä¸€äº›è®¾è®¡åŸåˆ™ï¼Œè®¾è®¡åŸåˆ™æ˜¯æ¯”æ¨¡å¼æ›´é«˜ä¸€çº§çš„æ–¹æ³•ï¼Œæ˜¯çº²é¢†æ€§çš„å†…å®¹ã€‚</p>
<blockquote>
<p>å•ä¸€èŒè´£(single responsable princple)è¢«å®šä¸ºä¸ºâ€œå¼•èµ·å˜åŒ–çš„åŸå› â€ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æ‰¿æ‹…äº†è¿‡å¤šçš„èŒè´£ï¼Œé‚£ä¹ˆåœ¨éœ€æ±‚å‘ç”Ÿå˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ”¹å†™è¿™ä¸ªæ–¹æ³•çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚<br>å› æ­¤SRPåŸåˆ™ä½“ç°ä¸ºï¼šä¸€ä¸ªå¯¹è±¡(æ–¹æ³•)åªåšä¸€ä»¶äº‹æƒ…ã€‚<br>å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ç¬¬18ç« </p>
</blockquote>
<p>#####è®¾è®¡æ¨¡å¼ä¸­çš„SRPåŸåˆ™</p>
<p>ä»£ç†æ¨¡å¼<br>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯è¦åœ¨æ–‡æ¡£ä¸­åˆ›å»ºä¸€ä¸ªimgæ ‡ç­¾ï¼Œå¹¶ä¸”è¦æ’å…¥å›¾ç‰‡<br>åœ¨åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œç”±äºç½‘é€Ÿçš„é™åˆ¶éœ€è¦é¢„å…ˆåŠ è½½ä¸€å¼ æœ¬åœ°å›¾ç‰‡ï¼Œç¨åä¼šåŠ è½½ç½‘ç»œå›¾ç‰‡ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­<code>åˆ›å»ºimgæ ‡ç­¾</code>å’Œ<code>æ›´æ¢å›¾ç‰‡æº</code>æ˜¯<code>æ²¡æœ‰å…³ç³»</code>çš„ã€‚æ‰€ä»¥æœ€å¥½æ˜¯æŠŠè¿™ä¸¤ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªå¯¹è±¡æ¥å¤„ç†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºimgæ ‡ç­¾çš„å¯¹è±¡</span></div><div class="line"><span class="keyword">var</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement( <span class="string">'img'</span> );</div><div class="line">		<span class="built_in">document</span>.body.appendChild( imgNode );</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> src </span>)</span>&#123;</div><div class="line"></div><div class="line">				imgNode.src = src;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">  <span class="comment">//æ·»åŠ å›¾ç‰‡è·¯å¾„çš„å¯¹è±¡</span></div><div class="line">	<span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> img = <span class="keyword">new</span> Image; <span class="comment">//å®ä¾‹åŒ–æ ‡ç­¾å¯¹è±¡</span></div><div class="line">		img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			myImage.setSrc( <span class="keyword">this</span>.src ); <span class="comment">//åŠ è½½é»˜è®¤å›¾ç‰‡</span></div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> &#123;</div><div class="line">			<span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> src </span>)</span>&#123;</div><div class="line">				myImage.setSrc( <span class="string">'file:// /C:/Users/svenzeng/Desktop/loading.gif'</span> );</div><div class="line">				img.src = src;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">	<span class="comment">//æ›´æ”¹å›¾ç‰‡çš„è·¯å¾„ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å’Œimgæ ‡ç­¾çš„åˆ›å»ºå¯¹è±¡æ²¡æœ‰å…³ç³»äº†ã€‚</span></div><div class="line">	proxyImage.setSrc( <span class="string">'http:// imgcache.qq.com/music/photo/000GGDys0yA0Nk.jpg'</span> );</div></pre></td></tr></table></figure></p>
<p>è¿­ä»£å™¨æ¨¡å¼<br>çœ‹ä¸‹é¢æ®µä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿™æ®µä»£ç å¾€æ–‡æ¡£ä¸­æ·»åŠ divå…ƒç´ ï¼Œä½†æ˜¯æœ‰é™åˆ¶ï¼Œè¿™é‡Œå°±åªèƒ½æ·»åŠ æ•°ç»„</span></div><div class="line"><span class="comment">//æœ‰ä¸¤ä¸ªèŒè´£ä¸€ä¸ªæ˜¯æ·»åŠ å…ƒç´ ï¼Œä¸€ä¸ªæ˜¯éå†æ•°æ®ï¼Œæ‰€æœ‰æœ‰å¿…è¦åˆ†å¼€</span></div><div class="line"> <span class="keyword">var</span> appendDiv=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;l=data.length;i&lt;l;i++)&#123;</div><div class="line">   <span class="keyword">var</span> div=<span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">   div.innerHTML=data[i];</div><div class="line">   <span class="built_in">document</span>.body.appendChild(div);</div><div class="line">  &#125;</div><div class="line"> &#125;;</div><div class="line"> </div><div class="line"> appenDiv([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨å•ä¸€èŒè´£åŸåˆ™æ”¹å˜ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> each = <span class="function"><span class="keyword">function</span>(<span class="params"> obj, callback </span>) </span>&#123;<span class="comment">//éå†çš„æ–¹æ³•</span></div><div class="line"><span class="comment">//å¯¹è±¡å’Œæ•°ç»„éƒ½å¯ä»¥è¾“å…¥ï¼Œçµæ´»æ€§åŠ å¤§ï¼Œå¹¶ä¸”è¿˜å¯ä»¥ä¿®æ”¹</span></div><div class="line">		<span class="keyword">var</span> value,</div><div class="line">		i = <span class="number">0</span>,</div><div class="line">		length = obj.length,</div><div class="line">		isArray = isArraylike( obj ); <span class="comment">// isArraylike å‡½æ•°æœªå®ç°ï¼Œå¯ä»¥ç¿»é˜…jQuery æºä»£ç </span></div><div class="line">		<span class="keyword">if</span> ( isArray ) &#123; <span class="comment">// è¿­ä»£ç±»æ•°ç»„</span></div><div class="line">			<span class="keyword">for</span> ( ; i &lt; length; i++ ) &#123;</div><div class="line">				callback.call( obj[ i ], i, obj[ i ] );</div><div class="line">			&#125;</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">for</span> ( i <span class="keyword">in</span> obj ) &#123; <span class="comment">// è¿­ä»£object å¯¹è±¡</span></div><div class="line">				value = callback.call( obj[ i ], i, obj[ i ] );</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> obj;</div><div class="line">	&#125;;</div><div class="line"> <span class="comment">//æ ¹æ®è¾“å…¥æ•°æ®çš„å…ƒç´ æ·»åŠ æ–¹æ³•</span></div><div class="line">	<span class="keyword">var</span> appendDiv = <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>)</span>&#123;</div><div class="line">		each( data, <span class="function"><span class="keyword">function</span>(<span class="params"> i, n </span>)</span>&#123; <span class="comment">//ä½¿ç”¨eachæ–¹æ³•æ¥æ‰§è¡Œéå†</span></div><div class="line">		<span class="comment">//åœ¨å›è°ƒå‡½æ•°ä¸­æ ¹æ®éå†æ•°æ®æ·»åŠ å…ƒç´ è‡³æ–‡æ¡£ä¸­</span></div><div class="line">			<span class="keyword">var</span> div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">			div.innerHTML = n;</div><div class="line">			<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">		&#125;);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	appendDiv( [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span> ] );<span class="comment">//æ•°ç»„æ•°æ®</span></div><div class="line">	appendDiv(&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>,<span class="attr">d</span>:<span class="number">4</span>&#125; ); <span class="comment">//å¯¹è±¡æ•°æ®</span></div></pre></td></tr></table></figure></p>
<p>å•ä¾‹æ¨¡å¼</p>
<p>åœ¨å‰é¢å·²ç»æœ‰ç¬”è®°äº†ã€‚å®é™…æ˜¯æŠŠå®é™…æ“ä½œå’Œåˆ›å»ºå•ä¾‹çš„æ–¹æ³•åˆ†åˆ«å°è£…åœ¨ä¸¤ä¸ªæ–¹æ³•é‡Œã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> createLoginLayer = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//åˆ›å»ºå…ƒç´ çš„æ–¹æ³•</span></div><div class="line">		<span class="keyword">var</span> div;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">if</span> ( !div )&#123;</div><div class="line">				div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">				div.innerHTML = <span class="string">'æˆ‘æ˜¯ç™»å½•æµ®çª—'</span>;</div><div class="line">				div.style.display = <span class="string">'none'</span>;</div><div class="line">				<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> div; <span class="comment">//å•ä¾‹çš„åˆ¤æ–­ä¾æ®</span></div><div class="line">		&#125;</div><div class="line">	&#125;)();</div><div class="line">  </div><div class="line">        <span class="comment">//åˆ›å»ºå’Œæ£€æµ‹å•ä¾‹çš„æ–¹æ³•ï¼Œå‚æ•°ä¸ºåˆ›å»ºå…ƒç´ çš„æ–¹æ³•</span></div><div class="line">	<span class="keyword">var</span> getSingle = <span class="function"><span class="keyword">function</span>(<span class="params"> fn </span>)</span>&#123; <span class="comment">// è·å–å•ä¾‹</span></div><div class="line">		<span class="keyword">var</span> result;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> result || ( result = fn .apply(<span class="keyword">this</span>, <span class="built_in">arguments</span> ) ); </div><div class="line">                        <span class="comment">//è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„applyå’Œargumentsçš„åº”ç”¨</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> createLoginLayer = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// åˆ›å»ºç™»å½•æµ®çª—</span></div><div class="line">		<span class="keyword">var</span> div = <span class="built_in">document</span>.createElement( <span class="string">'div'</span> );</div><div class="line">		div.innerHTML = <span class="string">'æˆ‘æ˜¯ç™»å½•æµ®çª—'</span>;</div><div class="line">		<span class="built_in">document</span>.body.appendChild( div );</div><div class="line">		<span class="keyword">return</span> div;</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="keyword">var</span> createSingleLoginLayer = getSingle( createLoginLayer );</div><div class="line">	<span class="keyword">var</span> loginLayer1 = createSingleLoginLayer();</div><div class="line">	<span class="keyword">var</span> loginLayer2 = createSingleLoginLayer();</div><div class="line">	alert ( loginLayer1 === loginLayer2 ); <span class="comment">// è¾“å‡ºï¼š true  //ä¸ºåŒä¸€å¯¹è±¡</span></div></pre></td></tr></table></figure></p>
<p>è£…é¥°è€…æ¨¡å¼<br>å‰é¢çš„è®¾è®¡æ¨¡å¼é‡Œä¹Ÿæœ‰ä»‹ç»<br>è£…é¥°è€…æ¨¡å¼å¯ä»¥åŠ¨æ€ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³•æˆ–æŒ‡è´£ã€‚ä»è€Œä¹Ÿä½¿çš„å¯¹è±¡çš„åŠŸèƒ½å•ä¸€åŒ–ã€‚<br>ä¸‹é¢ä¸¤ä¸ªå‡½æ•°è°ƒç”¨çš„æ—¶å€™æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">			 <span class="comment">//æ‰§è¡ŒåŸå‡½æ•°</span></div><div class="line">			afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );<span class="comment">//æ‰§è¡Œafterå‡½æ•°</span></div><div class="line">			<span class="keyword">return</span> ret;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> showLogin = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç™»å½•æµ®å±‚'</span> );</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ä¸ŠæŠ¥æ ‡ç­¾ä¸º: '</span> + <span class="keyword">this</span>.getAttribute( <span class="string">'tag'</span> ) );</div><div class="line"></div><div class="line">	&#125;;</div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = showLogin.after( log );</div><div class="line"><span class="comment">// æ‰“å¼€ç™»å½•æµ®å±‚ä¹‹åä¸ŠæŠ¥æ•°æ®</span></div></pre></td></tr></table></figure></p>
<p>#####å•ä¸€èŒè´£åŸåˆ™å‡ä½äº†å•ä¸ªç±»æˆ–è€…å¯¹è±¡çš„å¤æ‚åº¦ï¼ŒæŒ‰ç…§æŒ‡è´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ã€‚æœ‰åŠ©äºä»£ç çš„å¤ç”¨ï¼Œä¿®æ”¹å’Œæµ‹è¯•ã€‚ä½†æ˜¯ä»£ç å¤æ‚åº¦æ˜¯æé«˜äº†ã€‚æ€ä¹ˆå¹³è¡¡å‘¢ï¼Ÿè¿™æ˜¯ä¸ªé—®é¢˜ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptæœ€å°‘çŸ¥è¯†åŸåˆ™]]></title>
      <url>http://yoursite.com/2017/03/09/javascript%E6%9C%80%E5%B0%91%E7%9F%A5%E8%AF%86%E5%8E%9F%E5%88%99/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æœ€å°‘çŸ¥è¯†åŸåˆ™è¯´çš„æ˜¯ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½çš„ä¸å…¶ä»–å®ä½“å‡å°‘ç›¸äº’ä½œç”¨ã€‚<br>è¿™é‡Œçš„è½¯ä»¶å®ä½“æ˜¯ä¸€ä¸ªå¹¿ä¹‰æ¦‚å¿µï¼Œä¸ä»…åŒ…æ‹¬å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿï¼Œç±»ï¼Œæ¨¡å—ï¼Œå‡½æ•°ï¼Œå˜é‡ç¯ã€‚è¿™æ ·æ¥è¯´æœ€å°‘çŸ¥è¯†åŸåˆ™æ¶µç›–çš„èŒƒå›´å°±å¾ˆå¤§äº†ã€‚ä¸‹é¢çœ‹çœ‹å’Œjavascriptç›¸å…³çš„å†…å®¹<br>å‚è€ƒã€Šjavascirptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬19ç« </p>
</blockquote>
<ol>
<li><p>å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»<br>æœ€å°‘çŸ¥è¯†åŸåˆ™æŒ‡å¯¼æˆ‘ä»¬ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¸å¿…å½¼æ­¤é€šè®¯ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å°±ä¸è¦å‘ç”Ÿç›´æ¥è”ç³»ã€‚å¸¸è§çš„åšæ³•æ˜¯å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰è€…æ¥æ‰¿æ‹…å½¼æ­¤çš„é€šä¿¡ä»»åŠ¡ã€‚</p>
</li>
<li><p>javascriptè®¾è®¡æ¨¡å¼ä¸­çš„æœ€å°‘çŸ¥è¯†åŸåˆ™</p>
</li>
</ol>
<p><strong>ä¸­ä»‹è€…æ¨¡å¼</strong><br>è¿™ä¸ªæ¨¡å¼æ˜¯ä½¿ç”¨è€…ä»¬æ˜¯ä¸å‘ç”Ÿä»»ä½•è”ç³»çš„ï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯ç”±ä¸­ä»‹è€…æ¥å®Œæˆã€‚<br>reacté€šè¿‡å¼•å…¥reduxåº”è¯¥å°±æ˜¯è¿™ç§æ¨¡å¼ã€‚reactç»„ä»¶ä¹‹é—´ä¸å†å‘ç”Ÿä»»ä½•çš„è”ç³»ï¼Œæ‰€æœ‰ä¸ç»„ä»¶stateå˜åŒ–çš„é€šè®¯è¯·æ±‚éƒ½æ˜¯é€šè¿‡reduxæ¥å®Œæˆçš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œç»„ä»¶å¯ä»¥åº”å¯¹å¤æ‚çš„stateå˜åŒ–ã€‚</p>
<p><strong>å¤–è§‚æ¨¡å¼</strong><br>è¿™æ˜¯é’ˆå¯¹ä½¿ç”¨è€…è€Œè¨€çš„ã€‚å¤–è§‚æ¨¡å¼ä½œç”¨æ˜¯å¯¹äº¤äº’ä½¿ç”¨è€…éšè—å­ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</p>
<ul>
<li>[ ] å¤–è§‚æ¨¡å¼ä¸ºä¸€ç»„ç³»ç»Ÿæä¾›ä¸€ä¸ªä¾¿åˆ©çš„å…¥å£ã€‚åœ¨jqueryä¸­å…¼å®¹äº†æµè§ˆå™¨çš„å·®å¼‚ï¼Œä½†æ˜¯ä½¿ç”¨è€…ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªapiæ¥å£ï¼Œå°±æ˜¯ä¸€ä¸ªä½“ç°</li>
<li>[ ] éš”ç¦»ä½¿ç”¨è€…å’Œå¤æ‚ç³»ç»Ÿçš„è”ç³»ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å»äº†è§£å…·ä½“çš„å·®å¼‚</li>
</ul>
<p>javascriptçš„å‡½æ•°å°è£…</p>
<p>javascriptå‡½æ•°æœ‰ç€è‡³é«˜æ— ä¸Šçš„æƒåˆ©ï¼Œçµæ´»æ€§å¾ˆå¤§ã€‚é€šè¿‡ä½¿ç”¨é—­åŒ…éšè—å˜é‡ï¼Œé€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæ­ç¤ºæ¨¡å¼ï¼Œç­–ç•¥æ¨¡å¼.javascriptä½¿ç”¨å‡½æ•°å’Œå¯¹è±¡å­—é¢é‡çš„æ–¹æ³•éšè—å…·ä½“çš„å®ç°é€»è¾‘ã€‚åªæš´éœ²ç›¸å…³çš„æ–¹æ³•ã€‚</p>
<p>è¿™å°±æ˜¯æœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚è¿™ä¹Ÿæ˜¯åŸºç¡€åŸåˆ™åœ¨javascriptç¨‹åºè®¾è®¡ä¸­åº”è¯¥æ˜¯æ—¶åˆ»éƒ½è¦ä½“ç°è¿™ç§åŸåˆ™ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptæ¡¥æ¥æ¨¡å¼(1)-é˜Ÿåˆ—æ•°æ®ç»“æ„]]></title>
      <url>http://yoursite.com/2017/03/08/javascript%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F(1)-%E9%98%9F%E5%88%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æ ¹æ®ä¹¦ä¸Šä¾‹å­çš„å®é™…è¦æ±‚ï¼Œæ¶‰åŠåˆ°jsé˜Ÿåˆ—çš„é—®é¢˜ã€‚æ‰€ä»¥å…ˆæŠŠjsä¸­é˜Ÿåˆ—çš„å…·ä½“å®ç°æ•°æ®ç»“æ„è´´å‡ºæ¥ã€‚å…·ä½“å‚è€ƒã€Šå­¦ä¹ javascriptæ•°æ®ç»“æ„å’Œç®—æ³•ã€‹ç¬¬å››ç« ã€‚<br>é˜Ÿåˆ—æ•°æ®ç»“æ„éµå¾ªå…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚å…¥é˜Ÿæ“ä½œæ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œè¿”å›æ–°æ•°ç»„ã€‚å‡ºé˜Ÿæ“ä½œå¼¹å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›æ–°æ•°ç»„ã€‚ä¸¤ä¸ªæ“ä½œå¯¹äºæ•°ç»„éƒ½æœ‰ç»“æ„çš„æ”¹å˜</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//jsä¸­é˜Ÿåˆ—çš„å®ç°æ˜¯ä¾èµ–æ•°ç»„çš„æ•°æ®ç»“æ„</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];  <span class="comment">//åˆå§‹åŒ–ç©ºæ•°ç»„ï¼Œletå…³é”®å­—æ˜¯es6ä¸­çš„</span></div><div class="line">    <span class="comment">//ç”¨äºå½¢æˆå¤§æ‹¬å·åŒ…å›´çš„ä½œç”¨åŸŸ</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123; <span class="comment">//å…¥é˜Ÿæ“ä½œ</span></div><div class="line">        items.push(element); <span class="comment">//æ•°ç»„pushæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å‡ºå¯¹</span></div><div class="line">        <span class="keyword">return</span> items.shift(); <span class="comment">//æ•°ç»„shiftæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];     <span class="comment">//æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//åˆ¤æ–­é˜Ÿåˆ—æœ‰æ— æˆå‘˜</span></div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>; <span class="comment">//å¸ƒå°”å€¼åˆ¤æ–­</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ¸…ç©ºé˜Ÿåˆ—</span></div><div class="line">        items = [];   <span class="comment">//å˜é‡é‡æ–°èµ‹å€¼ç©ºæ•°ç»„</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è·å¾—é˜Ÿåˆ—çš„é•¿åº¦</span></div><div class="line">        <span class="keyword">return</span> items.length; </div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰“å°é˜Ÿåˆ—</span></div><div class="line">        <span class="built_in">console</span>.log(items.toString());</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ã€‚æ•°æ®æˆå‘˜å…¥é˜Ÿçš„æ—¶å€™è¦æºå¸¦æ•°æ®å’Œä¼˜å…ˆçº§ã€‚<br>ä¼˜å…ˆçº§åœ¨è¿™é‡Œçš„å®šä¹‰æ˜¯æ•°å­—è¶Šå¤§åœ¨æ•°ç»„ä¸­çš„ä½ç½®é åã€‚å½“æ’å…¥ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆè¦æ ¹æ®å®ƒçš„ä¼˜å…ˆçº§æ¥åˆ¤æ–­ï¼Œæœ€å°æ˜¯ç›´æ¥æ’å…¥åˆ°ç¬¬ä¸€ä½ï¼Œç´§é‚»ä¸€ä¸ªæ¯”ä»–å¤§çš„ä¼˜å…ˆçº§æ˜¯ï¼Œå°±æ’å…¥åˆ°è¿™ä¸ªé‚»å±…çš„å‰é¢ã€‚å¦‚æœæ˜¯æœ€å¤§çš„æ•°å­—å°±æ’åˆ°æ•°ç»„çš„æœ€åã€‚<br>ä¸€ç»´æ•°ç»„å˜æˆäº†äºŒä½æ•°ç»„ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PriorityQueue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">QueueElement</span> (<span class="params">element, priority</span>)</span>&#123; </div><div class="line">            <span class="keyword">this</span>.element = element;<span class="comment">//æˆå‘˜æœ¬èº«</span></div><div class="line">        <span class="keyword">this</span>.priority = priority;  <span class="comment">//ä¼˜å…ˆçº§</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element, priority</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> queueElement = <span class="keyword">new</span> QueueElement(element, priority);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> added = <span class="literal">false</span>; <span class="comment">//æ·»åŠ æ ‡è®°</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (queueElement.priority &lt;            </div><div class="line"> items[i].priority)&#123;  <span class="comment">//æ‰¾åˆ°ä¼˜å…ˆçº§æ•°å­—æ¯”ä»–å¤§çš„é‚£ä¸ªå…ƒç´ </span></div><div class="line"></div><div class="line">                items.splice(i,<span class="number">0</span>,queueElement);            </div><div class="line">             <span class="comment">// æ’åˆ°è¿™ä¸ªå…ƒç´ çš„å‰é¢</span></div><div class="line">                added = <span class="literal">true</span>;</div><div class="line">                <span class="keyword">break</span>; <span class="comment">// ç»ˆæ­¢</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!added)&#123; <span class="comment">//å¦‚æœæ˜¯ä¼˜å…ˆçº§æ•°å­—æ˜¯æœ€å¤§çš„ï¼Œç›´æ¥æ’å…¥åˆ°</span></div><div class="line">        <span class="comment">//æ•°ç»„çš„æœ«å°¾</span></div><div class="line">            items.push(queueElement); <span class="comment">//&#123;5&#125;</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="comment">//å…¶ä»–æ“ä½œå’Œæ™®é€šé˜Ÿåˆ—æ˜¯ä¸€æ ·çš„</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.shift();</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//printä½¿ç”¨äº†es6é‡Œçš„æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹æ³•</span></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;items[i].element&#125;</span>  - <span class="subst">$&#123;items[i].priority&#125;</span>`</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> priorityQueue = <span class="keyword">new</span> PriorityQueue();</div><div class="line">priorityQueue.enqueue(<span class="string">"John"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Jack"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Camila"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Maxwell"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Ana"</span>, <span class="number">3</span>);</div><div class="line">priorityQueue.print();</div><div class="line"><span class="comment">//=&gt;</span></div><div class="line"><span class="comment">//æ‰“å°å‡ºçš„ç»“æœ</span></div><div class="line">Jack  - <span class="number">1</span>  <span class="comment">//æ•°ç»„å…ƒç´ --ä¼˜å…ˆçº§</span></div><div class="line">Camila  - <span class="number">1</span></div><div class="line">John  - <span class="number">2</span></div><div class="line">Maxwell  - <span class="number">2</span></div><div class="line">Ana  - <span class="number">3</span></div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªé˜Ÿåˆ—çš„åŸºç¡€ä¸Šå¯ä»¥å®ç°javascriptä¸­æ¡¥æ¥æ¨¡å¼çš„ä¾‹å­ã€‚æœ¬æ–‡ç®—æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„javascripté˜Ÿåˆ—çš„ä»‹ç»ï¼Œä¹Ÿä½œä¸ºæ¡¥æ¥æ¨¡å¼ä¾‹å­çš„èƒŒæ™¯æ–¹æ³•ã€‚<br><a href="http://www.apress.com/cn/book/9781590599082" target="_blank" rel="external">javascriptè®¾è®¡æ¨¡å¼ ç¬¬å…«ç« -æ¡¥æ¥æ¨¡å¼</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/08/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>å•ä¾‹æ¨¡å¼çš„å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®ä»–çš„å…¨å±€è®¿é—®ç‚¹<br>å‚è€ƒä¹¦ç±ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹<br>æœ‰ä¸€äº›å¯¹è±¡æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªï¼Œä¾‹å¦‚çº¿ç¨‹æ± ï¼Œå…¨å±€ç¼“å­˜ç­‰ã€‚</p>
</blockquote>
<ol>
<li>å®ä¾‹å•ä¾‹æ¨¡å¼</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Singleton = <span class="function"><span class="keyword">function</span>(<span class="params"> name </span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		<span class="keyword">this</span>.instance = <span class="literal">null</span>;</div><div class="line">	&#125;;</div><div class="line">	Singleton.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		alert ( <span class="keyword">this</span>.name );</div><div class="line">	&#125;;</div><div class="line">	Singleton.getInstance = <span class="function"><span class="keyword">function</span>(<span class="params"> name </span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span> ( !<span class="keyword">this</span>.instance )&#123;  <span class="comment">//å¯¹å®ä¾‹è¿›è¡Œæ£€æµ‹</span></div><div class="line">			<span class="keyword">this</span>.instance = <span class="keyword">new</span> Singleton( name ); <span class="comment">//å…¨å±€ç¼“å­˜new å¯¹è±¡</span></div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.instance;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> a = Singleton.getInstance( <span class="string">'sven1'</span> );  <span class="comment">//ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ï¼Œæ£€æµ‹æ²¡æœ‰å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œè‡ªå·±å®ä¾‹åŒ–ä¸€ä¸ªï¼Œç„¶åç¼“å­˜</span></div><div class="line">	<span class="keyword">var</span> b = Singleton.getInstance( <span class="string">'sven2'</span> );<span class="comment">//ç¬¬äºŒæ¬¡å®ä¾‹åŒ–ï¼Œæ£€æµ‹å·²ç»æœ‰å…¨å±€çš„å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œç›´æ¥è¿”å›ï¼Œä¸è¿›è¡Œå…·ä½“å®ä¾‹åŒ–</span></div><div class="line">	alert ( a === b ); <span class="comment">// true    //ç»Ÿä¸€å®ä¾‹å¯¹è±¡</span></div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptçš„applyå’Œcallæ–¹æ³•]]></title>
      <url>http://yoursite.com/2017/03/08/javascript-%E4%B8%AD%E7%9A%84apply%E5%92%8Ccall%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åœ¨javascriptæ¨¡å¼è®¾è®¡çš„å­¦ä¹ ä¸­ï¼Œæ·±æ„Ÿjavascriptçš„è¯­æ³•çš„çµæ´»æ€§ï¼Œåœ¨æ¨¡å¼è®¾è®¡çš„æ–¹æ³•ä¸­å¯¹äºé«˜é˜¶å‡½æ•°çš„ä½¿ç”¨åˆ°äº†ä»¤äººå‘æŒ‡çš„åœ°æ­¥ï¼Œå‡ ä¹æ¯ä¸ªç¤ºä¾‹ä¸­éƒ½ç¦»ä¸å¼€å‡½æ•°ä½œä¸ºå‚æ•°çš„è°ƒç”¨æ–¹æ³•ï¼Œapplyå’Œcallæ–¹æ³•æ˜¯ä½¿ç”¨æœ€å¤šçš„ã€‚è¿™ä¸¤ä¸ªå‡½æ•°è°ƒç”¨å½¢å¼ä¸å¤ªä¸€æ ·ï¼Œä½†æ˜¯ç›®çš„éƒ½æ˜¯ä¸€æ ·çš„ã€‚applyå’Œcallå‡½æ•°æ˜¯javascriptä¸­çš„ç¡¬ç»‘å®šæ–¹å¼ï¼Œå¯ä»¥çµæ´»,åŠ¨æ€çš„æ”¹å˜å‡½æ•°è¿è¡Œæ—¶å€™çš„ä½œç”¨åŸŸå¯¹è±¡ã€‚å¹¶ä¸”å’Œargumentå¯¹è±¡ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œå¨åŠ›ä¼šæ›´å¤§ã€‚<br>ç»“åˆã€Šjavascriptå‡½æ•°å¼ç¼–ç¨‹ã€‹çš„ä¸€ä¸ªä¾‹å­è¯´è¯´ã€‚ p2<br>ä½¿ç”¨applyæ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œä»–æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”è¿”å›å¦ä¸€å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ç”¨applyæ¥æ‰§è¡Œå‡½æ•°</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function  splat(<span class="function"><span class="keyword">fun</span>)&#123; //splatå‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°</span></div><div class="line">  <span class="keyword">return</span> function(array)&#123; <span class="comment">//è¿”å›å¦ä¸€ä¸ªå‡½æ•°ï¼Œarrayä½œä¸ºå½¢å‚</span></div><div class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">fun</span>.<span class="title">apply</span><span class="params">(<span class="literal">null</span>,array)</span></span>;<span class="comment">//applyæ–¹æ³•ä¼ å…¥æ•°ç»„å‚æ•°</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> addArrayElements=splat(function(x,y)&#123;<span class="keyword">return</span> x+y;&#125;); <span class="comment">//ä¼ å…¥å‡½æ•°åŠ </span></div><div class="line"><span class="comment">//æ³•å‡½æ•°ä½œä¸ºå‚æ•°</span></div><div class="line"></div><div class="line">addArrayElements([<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">//è°ƒç”¨å‡½æ•°ï¼Œ=&gt;3</span></div></pre></td></tr></table></figure>
<blockquote>
<p>å¦å¤–ä¸€ä¸ªå±•ç°jsçµæ´»æ€§çš„åœ°æ–¹æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶ä»¥ä»»æ„å¤šä¸ªä»»æ„ç±»å‹çš„å‚æ•°æ¥è°ƒç”¨ä»»æ„ä¸€ä¸ªå‡½æ•°ã€‚è¿™é‡Œçš„ä¸‰ä¸ªä»»æ„ä½“ç°äº†jså‡½æ•°ä½¿ç”¨çš„çµæ´»æ€§ã€‚<br>æ¯ä¸ªjså‡½æ•°éƒ½å¯ä»¥è®¿é—®ä¸€ä¸ªargumentså±€éƒ¨å¯¹è±¡ï¼Œä»–ç±»ä¼¼æ•°ç»„ï¼Œå­˜å‚¨äº†è°ƒç”¨å‡½æ•°æ˜¯çš„å®é™…å‚æ•°ã€‚</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">   function  unsplat(<span class="function"><span class="keyword">fun</span>)&#123;//æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°</span></div><div class="line">  <span class="keyword">return</span> function()&#123;<span class="comment">//è¿”å›å¦ä¸€ä¸ªå‡½æ•°</span></div><div class="line">     <span class="comment">//è¿”å›çš„å‡½æ•°ä¸ºä¼ å…¥çš„å‡½æ•°ç»‘å®šargumentså¯¹è±¡ï¼Œè¿™é‡Œç»è¿‡</span></div><div class="line">     <span class="comment">//underscoreçš„toArrayæ–¹æ³•è½¬ä¸ºæ•°ç»„å¯¹è±¡</span></div><div class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">fun</span>.<span class="title">call</span><span class="params">(<span class="literal">null</span>,_.toArray(arguments)</span></span>);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> joinElements=unsplat(function(array)&#123;<span class="keyword">return</span> array.join(<span class="string">' '</span>);&#125;); <span class="comment">//è°ƒç”¨</span></div><div class="line"><span class="comment">//æ—¶ä¼ å…¥å‡½æ•°å®å‚</span></div><div class="line"></div><div class="line">alert(joinElements(<span class="number">1</span>,<span class="number">2</span>)); <span class="comment">//ä¼ å…¥è°ƒç”¨çš„å‚æ•°ï¼Œå‚æ•°é•¿åº¦æ˜¯ä¸å®šçš„</span></div></pre></td></tr></table></figure>
<p>#####è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨æ¨¡å¼è®¾è®¡çš„ä»£ç é‡Œç”¨çš„å¤ªå¤šäº†ï¼Œæ‰€ä»¥è¦å¥½å¥½ç ”ç©¶ç ”ç©¶.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascript èŒè´£é“¾æ¨¡å¼-ç´§å¯†è€¦åˆåˆ¤è¯»å˜å¤šå‡½æ•°åˆ†å¼€å¤„ç†]]></title>
      <url>http://yoursite.com/2017/03/08/javascript-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>èŒè´£é“¾æ¨¡å¼æ˜¯ï¼šæ˜¯å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å¦‚æœæ˜¯åœ¨jvascriptä¸­å¾ˆå¥½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä»ç¼–ç¨‹ä¸Šæ¥è¯´å°±æ˜¯æŠŠæ¯”è¾ƒå¤æ‚çš„if-elseåµŒå¥—ç´§å¯†çš„åˆ¤æ–­-æ‰§è¡Œé€»è¾‘ä½¿ç”¨é«˜é˜¶å‡½æ•°æŠŠåˆ¤æ–­è¯­å¥ä¸­æ‰€åšçš„äº‹æƒ…æ”¾åˆ°å‡½æ•°ä¸­å¤„ç†ã€‚</p>
</blockquote>
<p>é€»è¾‘å¤„ç†çš„å¤æ‚åº¦å¹¶æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯å„ä¸ªå¤„ç†éƒ¨åˆ†å°±åˆ†æ•£åˆ°å‡½æ•°ä¸­å»äº†ã€‚æ¯ä¸ªå‡½æ•°åªåšä¸¤ä»¶äº‹æƒ…ï¼Œèƒ½å¤„ç†å°±å¤„ç†ï¼Œä¸èƒ½å¤„ç†å°±äº¤ç»™å…¶ä»–å‡½æ•°ï¼Œæˆ–è€…æŠŠè‡ªå·±çš„é€»è¾‘ï¼Œé€šè¿‡å¼‚æ­¥å†é€šçŸ¥ä¸‹ä¸€ä¸ªå‡½æ•°è¿›è¡Œå¤„ç†ã€‚ è¿™æ ·é€šè¿‡å•ä¸ªå‡½æ•°å†…éƒ¨çš„æŒ‡é’ˆç®€åŒ–ç´§å¯†åµŒå¥—çš„é€»è¾‘ã€‚<br>æˆ‘ä½œä¸ºåˆå­¦è€…æ„Ÿè§‰åˆ°è¿™æ ·å¤„ç†ï¼Œä»£ç è¯»èµ·æ¥éå¸¸æ¸…æ™°ã€‚ä½†æ˜¯æ‰§è¡Œçš„æ•ˆç‡æ˜¯ä¸æ˜¯å’Œç´§å¯†åµŒå¥—çš„é€»è¾‘ä¸€æ ·æˆ‘å°±ä¸çŸ¥é“äº†ã€‚æˆ–è®¸æ˜¯ç”¨æ—¶é—´æ¢ä»£ç çš„æ˜“è¯»æ€§ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">//å®ä¾‹æ¥è‡ªã€Šjsè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="keyword">var</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params"> orderType, pay, stock </span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span> ( orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span> )&#123;<span class="comment">//æ ¹æ®orderType,payè¿›è¡Œä»»åŠ¡åˆ†é…</span></div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸'</span> ); <span class="comment">//ç¬¦åˆorder500æ¡ä»¶ï¼Œç›´æ¥æ‰§è¡Œé€»è¾‘</span></div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">		   <span class="comment">//ä¸ç¬¦åˆorder500æ¡ä»¶äº¤ä¸ªorder200å¤„ç†ï¼Œorder500ä»»åŠ¡å®Œæˆ</span></div><div class="line">			order200( orderType, pay, stock ); <span class="comment">// å°†è¯·æ±‚ä¼ é€’ç»™200 å…ƒè®¢å•</span></div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;;</div><div class="line">	<span class="comment">// 200 å…ƒè®¢å•</span></div><div class="line">	<span class="keyword">var</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params"> orderType, pay, stock </span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span> ( orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span> )&#123;<span class="comment">//ç¬¦åˆorder200æ¡ä»¶</span></div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°50 ä¼˜æƒ åˆ¸'</span> ); <span class="comment">//æ‰§è¡Œé€»è¾‘</span></div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">		   <span class="comment">//æ¡ä»¶ä¸ç¬¦åˆï¼Œä¼ ç»™ä¸‹ä¸€ä¸ªå‡½æ•°å¤„ç†</span></div><div class="line">			orderNormal( orderType, pay, stock ); <span class="comment">// å°†è¯·æ±‚ä¼ é€’ç»™æ™®é€šè®¢å•</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="comment">// æ™®é€šè´­ä¹°è®¢å•</span></div><div class="line">	<span class="keyword">var</span> orderNormal = <span class="function"><span class="keyword">function</span>(<span class="params"> orderType, pay, stock </span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span> ( stock &gt; <span class="number">0</span> )&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸'</span> );</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log( <span class="string">'æ‰‹æœºåº“å­˜ä¸è¶³'</span> );</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment">// æµ‹è¯•ç»“æœï¼š</span></div><div class="line">	order500( <span class="number">1</span> , <span class="literal">true</span>, <span class="number">500</span>); <span class="comment">// è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸</span></div><div class="line">	order500( <span class="number">1</span>, <span class="literal">false</span>, <span class="number">500</span> ); <span class="comment">// è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸</span></div><div class="line">	order500( <span class="number">2</span>, <span class="literal">true</span>, <span class="number">500</span> ); <span class="comment">// è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°500 ä¼˜æƒ åˆ¸</span></div><div class="line">	order500( <span class="number">3</span>, <span class="literal">false</span>, <span class="number">500</span> ); <span class="comment">// è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸</span></div><div class="line">	order500( <span class="number">3</span>, <span class="literal">false</span>, <span class="number">0</span> ); <span class="comment">// è¾“å‡ºï¼šæ‰‹æœºåº“å­˜ä¸è¶³</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Redux-reselect]]></title>
      <url>http://yoursite.com/2017/03/08/Reselect/</url>
      <content type="html"><![CDATA[<p><a href="https://travis-ci.org/reactjs/reselect" target="_blank" rel="external"><img src="https://img.shields.io/travis/reactjs/reselect/master.svg?style=flat-square" alt="Travis"></a><br><a href="https://www.npmjs.org/package/reselect" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/reselect.svg?style=flat-square" alt="npm package"></a><br><a href="https://coveralls.io/github/reactjs/reselect" target="_blank" rel="external"><img src="https://img.shields.io/coveralls/reactjs/reselect/master.svg?style=flat-square" alt="Coveralls"></a></p>
<p>Simple â€œselectorâ€ library for Redux inspired by getters in <a href="https://github.com/optimizely/nuclear-js.git" target="_blank" rel="external">NuclearJS</a>, <a href="https://github.com/Day8/re-frame#just-a-read-only-cursor" target="_blank" rel="external">subscriptions</a> in <a href="https://github.com/Day8/re-frame" target="_blank" rel="external">re-frame</a> and this <a href="https://github.com/gaearon/redux/pull/169" target="_blank" rel="external">proposal</a> from <a href="https://github.com/speedskater" target="_blank" rel="external">speedskater</a>.</p>
<ul>
<li>Selectors can compute derived data, allowing Redux to store the minimal possible state.</li>
<li>Selectors are efficient. A selector is not recomputed unless one of its arguments change.</li>
<li>Selectors are composable. They can be used as input to other selectors.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> shopItemsSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.items</div><div class="line"><span class="keyword">const</span> taxPercentSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.taxPercent</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  shopItemsSelector,</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> taxSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxPercentSelector,</div><div class="line">  (subtotal, taxPercent) =&gt; subtotal * (taxPercent / <span class="number">100</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxSelector,</div><div class="line">  (subtotal, tax) =&gt; (&#123; <span class="attr">total</span>: subtotal + tax &#125;)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">let</span> exampleState = &#123;</div><div class="line">  <span class="attr">shop</span>: &#123;</div><div class="line">    <span class="attr">taxPercent</span>: <span class="number">8</span>,</div><div class="line">    <span class="attr">items</span>: [</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'apple'</span>, <span class="attr">value</span>: <span class="number">1.20</span> &#125;,</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'orange'</span>, <span class="attr">value</span>: <span class="number">0.95</span> &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(subtotalSelector(exampleState)) <span class="comment">// 2.15</span></div><div class="line"><span class="built_in">console</span>.log(taxSelector(exampleState))      <span class="comment">// 0.172</span></div><div class="line"><span class="built_in">console</span>.log(totalSelector(exampleState))    <span class="comment">// &#123; total: 2.322 &#125;</span></div></pre></td></tr></table></figure>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#example">Example</a><ul>
<li><a href="#motivation-for-memoized-selectors">Motivation for Memoized Selectors</a></li>
<li><a href="#creating-a-memoized-selector">Creating a Memoized Selector</a></li>
<li><a href="#composing-selectors">Composing Selectors</a></li>
<li><a href="#connecting-a-selector-to-the-redux-store">Connecting a Selector to the Redux Store</a></li>
<li><a href="#accessing-react-props-in-selectors">Accessing React Props in Selectors</a></li>
<li><a href="#sharing-selectors-with-props-across-multiple-components">Sharing Selectors with Props Across Multiple Components</a></li>
</ul>
</li>
<li><a href="#api">API</a><ul>
<li><a href="#createselectorinputselectors--inputselectors-resultfunc"><code>createSelector</code></a></li>
<li><a href="#defaultmemoizefunc-equalitycheck--defaultequalitycheck"><code>defaultMemoize</code></a></li>
<li><a href="#createselectorcreatormemoize-memoizeoptions"><code>createSelectorCreator</code></a></li>
<li><a href="#createstructuredselectorinputselectors-selectorcreator--createselector"><code>createStructuredSelector</code></a></li>
</ul>
</li>
<li><p><a href="#faq">FAQ</a></p>
<ul>
<li><a href="#q-why-isnt-my-selector-recomputing-when-the-input-state-changes">Why isnâ€™t my selector recomputing when the input state changes?</a></li>
<li><a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">Why is my selector recomputing when the input state stays the same?</a></li>
<li><a href="#q-can-i-use-reselect-without-redux">Can I use Reselect without Redux?</a></li>
<li><a href="#q-the-default-memoization-function-is-no-good-can-i-use-a-different-one">The default memoization function is no good, can I use a different one?</a></li>
<li><a href="#q-how-do-i-test-a-selector">How do I test a selector?</a></li>
<li><a href="#q-how-do-i-create-a-selector-that-takes-an-argument">How do I create a selector that takes an argument? </a></li>
<li><a href="#q-how-do-i-use-reselect-with-immutablejs">How do I use Reselect with Immutable.js?</a></li>
<li><a href="#q-can-i-share-a-selector-across-multiple-components">Can I share a selector across multiple components?</a></li>
<li><a href="#q-are-there-typescript-typings">Are there TypeScript typings?</a></li>
<li><a href="#q-how-can-i-make-a-curried-selector">How can I make a curried selector?</a></li>
</ul>
</li>
<li><p><a href="#related-projects">Related Projects</a></p>
</li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><pre><code>npm install reselect
</code></pre><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><h3 id="Motivation-for-Memoized-Selectors"><a href="#Motivation-for-Memoized-Selectors" class="headerlink" title="Motivation for Memoized Selectors"></a>Motivation for Memoized Selectors</h3><blockquote>
<p>The examples in this section are based on the <a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux Todos List example</a>.</p>
</blockquote>
<h4 id="containers-VisibleTodoList-js"><a href="#containers-VisibleTodoList-js" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodos = <span class="function">(<span class="params">todos, filter</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (filter) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">      <span class="keyword">return</span> todos</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state.todos, state.visibilityFilter)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<p>In the above example, <code>mapStateToProps</code> calls <code>getVisibleTodos</code> to calculate <code>todos</code>. This works great, but there is a drawback: <code>todos</code> is calculated every time the component is updated. If the state tree is large, or the calculation expensive, repeating the calculation on every update may cause performance problems. Reselect can help to avoid these unnecessary recalculations.</p>
<h3 id="Creating-a-Memoized-Selector"><a href="#Creating-a-Memoized-Selector" class="headerlink" title="Creating a Memoized Selector"></a>Creating a Memoized Selector</h3><p>We would like to replace <code>getVisibleTodos</code> with a memoized selector that recalculates <code>todos</code> when the value of <code>state.todos</code> or <code>state.visibilityFilter</code> changes, but not when changes occur in other (unrelated) parts of the state tree.</p>
<p>Reselect provides a function <code>createSelector</code> for creating memoized selectors. <code>createSelector</code> takes an array of input-selectors and a transform function as its arguments. If the Redux state tree is mutated in a way that causes the value of an input-selector to change, the selector will call its transform function with the values of the input-selectors as arguments and return the result. If the values of the input-selectors are the same as the previous call to the selector, it will return the previously computed value instead of calling the transform function.</p>
<p>Letâ€™s define a memoized selector named <code>getVisibleTodos</code> to replace the non-memoized version above:</p>
<h4 id="selectors-index-js"><a href="#selectors-index-js" class="headerlink" title="selectors/index.js"></a><code>selectors/index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state</span>) =&gt;</span> state.visibilityFilter</div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state</span>) =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>In the example above, <code>getVisibilityFilter</code> and <code>getTodos</code> are input-selectors. They are created as ordinary non-memoized selector functions because they do not transform the data they select. <code>getVisibleTodos</code> on the other hand is a memoized selector. It takes <code>getVisibilityFilter</code> and <code>getTodos</code> as input-selectors, and a transform function that calculates the filtered todos list.</p>
<h3 id="Composing-Selectors"><a href="#Composing-Selectors" class="headerlink" title="Composing Selectors"></a>Composing Selectors</h3><p>A memoized selector can itself be an input-selector to another memoized selector. Here is <code>getVisibleTodos</code> being used as an input-selector to a selector that further filters the todos by keyword:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> getKeyword = <span class="function">(<span class="params">state</span>) =&gt;</span> state.keyword</div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodosFilteredByKeyword = createSelector(</div><div class="line">  [ getVisibleTodos, getKeyword ],</div><div class="line">  (visibleTodos, keyword) =&gt; visibleTodos.filter(</div><div class="line">    <span class="function"><span class="params">todo</span> =&gt;</span> todo.text.indexOf(keyword) &gt; <span class="number">-1</span></div><div class="line">  )</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="Connecting-a-Selector-to-the-Redux-Store"><a href="#Connecting-a-Selector-to-the-Redux-Store" class="headerlink" title="Connecting a Selector to the Redux Store"></a>Connecting a Selector to the Redux Store</h3><p>If you are using <a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">React Redux</a>, you can call selectors as regular functions inside <code>mapStateToProps()</code>:</p>
<h4 id="containers-VisibleTodoList-js-1"><a href="#containers-VisibleTodoList-js-1" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<h3 id="Accessing-React-Props-in-Selectors"><a href="#Accessing-React-Props-in-Selectors" class="headerlink" title="Accessing React Props in Selectors"></a>Accessing React Props in Selectors</h3><blockquote>
<p>This section introduces a hypothetical extension to our app that allows it to support multiple Todo Lists. Please note that a full implementation of this extension requires changes to the reducers, components, actions etc. that arenâ€™t directly relevant to the topics discussed and have been omitted for brevity.</p>
</blockquote>
<p>So far we have only seen selectors receive the Redux store state as an argument, but a selector can receive props too.</p>
<p>Here is an <code>App</code> component that renders three <code>VisibleTodoList</code> components, each of which has a <code>listId</code> prop:</p>
<h4 id="components-App-js"><a href="#components-App-js" class="headerlink" title="components/App.js"></a><code>components/App.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer'</span></div><div class="line"><span class="keyword">import</span> AddTodo <span class="keyword">from</span> <span class="string">'../containers/AddTodo'</span></div><div class="line"><span class="keyword">import</span> VisibleTodoList <span class="keyword">from</span> <span class="string">'../containers/VisibleTodoList'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;VisibleTodoList listId="1" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="2" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="3" /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>Each <code>VisibleTodoList</code> container should select a different slice of the state depending on the value of the <code>listId</code> prop, so letâ€™s modify <code>getVisibilityFilter</code> and <code>getTodos</code> to accept a props argument:</p>
<h4 id="selectors-todoSelectors-js"><a href="#selectors-todoSelectors-js" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos</div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> getVisibleTodos</div></pre></td></tr></table></figure>
<p><code>props</code> can be passed to <code>getVisibleTodos</code> from <code>mapStateToProps</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>So now <code>getVisibleTodos</code> has access to <code>props</code>, and everything seems to be working fine.</p>
<p><strong>But there is a problem!</strong></p>
<p>Using the <code>getVisibleTodos</code> selector with multiple instances of the <code>VisibleTodoList</code> container will not correctly memoize:</p>
<h4 id="containers-VisibleTodoList-js-2"><a href="#containers-VisibleTodoList-js-2" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">// WARNING: THE FOLLOWING SELECTOR DOES NOT CORRECTLY MEMOIZE</span></div><div class="line">    todos: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<p>A selector created with <code>createSelector</code> only returns the cached value when its set of arguments is the same as its previous set of arguments. If we alternate between rendering <code>&lt;VisibleTodoList listId=&quot;1&quot; /&gt;</code> and <code>&lt;VisibleTodoList listId=&quot;2&quot; /&gt;</code>, the shared selector will alternate between receiving <code>{listId: 1}</code> and <code>{listId: 2}</code> as its <code>props</code> argument. This will cause the arguments to be different on each call, so the selector will always recompute instead of returning the cached value. Weâ€™ll see how to overcome this limitation in the next section.</p>
<h3 id="Sharing-Selectors-with-Props-Across-Multiple-Components"><a href="#Sharing-Selectors-with-Props-Across-Multiple-Components" class="headerlink" title="Sharing Selectors with Props Across Multiple Components"></a>Sharing Selectors with Props Across Multiple Components</h3><blockquote>
<p>The examples in this section require React Redux v4.3.0 or greater</p>
</blockquote>
<p>To share a selector across multiple <code>VisibleTodoList</code> components while passing in <code>props</code> <strong>and</strong> retaining memoization, each instance of the component needs its own private copy of the selector.</p>
<p>Letâ€™s create a function named <code>makeGetVisibleTodos</code> that returns a new copy of the <code>getVisibleTodos</code> selector each time it is called:</p>
<h4 id="selectors-todoSelectors-js-1"><a href="#selectors-todoSelectors-js-1" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos</div><div class="line"></div><div class="line"><span class="keyword">const</span> makeGetVisibleTodos = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    [ getVisibilityFilter, getTodos ],</div><div class="line">    (visibilityFilter, todos) =&gt; &#123;</div><div class="line">      <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">          <span class="keyword">return</span> todos</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeGetVisibleTodos</div></pre></td></tr></table></figure>
<p>We also need a way to give each instance of a container access to its own private selector. The <code>mapStateToProps</code> argument of <code>connect</code> can help with this.</p>
<p><strong>If the <code>mapStateToProps</code> argument supplied to <code>connect</code> returns a function instead of an object, it will be used to create an individual <code>mapStateToProps</code> function for each instance of the container.</strong></p>
<p>In the example below <code>makeMapStateToProps</code> creates a new <code>getVisibleTodos</code> selector, and returns a <code>mapStateToProps</code> function that has exclusive access to the new selector:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If we pass <code>makeMapStateToProps</code> to <code>connect</code>, each instance of the <code>VisibleTodosList</code> container will get its own <code>mapStateToProps</code> function with a private <code>getVisibleTodos</code> selector. Memoization will now work correctly regardless of the render order of the <code>VisibleTodoList</code> containers.</p>
<h4 id="containers-VisibleTodoList-js-3"><a href="#containers-VisibleTodoList-js-3" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; makeGetVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  makeMapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><h3 id="createSelector-â€¦inputSelectors-inputSelectors-resultFunc"><a href="#createSelector-â€¦inputSelectors-inputSelectors-resultFunc" class="headerlink" title="createSelector(â€¦inputSelectors | [inputSelectors], resultFunc)"></a>createSelector(â€¦inputSelectors | [inputSelectors], resultFunc)</h3><p>Takes one or more selectors, or an array of selectors, computes their values and passes them as arguments to <code>resultFunc</code>.</p>
<p><code>createSelector</code> determines if the value returned by an input-selector has changed between calls using reference equality (<code>===</code>). Inputs to selectors created with <code>createSelector</code> should be immutable.</p>
<p>Selectors created with <code>createSelector</code> have a cache size of 1. This means they always recalculate when the value of an input-selector changes, as a selector only stores the preceding value of each input-selector.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">  state =&gt; state.values.value2,</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// You can also pass an array of selectors</span></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  [</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">    state =&gt; state.values.value2</div><div class="line">  ],</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div></pre></td></tr></table></figure>
<p>It can be useful to access the props of a component from within a selector. When a selector is connected to a component with <code>connect</code>, the component props are passed as the second argument to the selector:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> abSelector = <span class="function">(<span class="params">state, props</span>) =&gt;</span> state.a * props.b</div><div class="line"></div><div class="line"><span class="comment">// props only (ignoring state argument)</span></div><div class="line"><span class="keyword">const</span> cSelector =  <span class="function">(<span class="params">_, props</span>) =&gt;</span> props.c</div><div class="line"></div><div class="line"><span class="comment">// state only (props argument omitted as not required)</span></div><div class="line"><span class="keyword">const</span> dSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.d</div><div class="line"></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  abSelector,</div><div class="line">  cSelector,</div><div class="line">  dSelector,</div><div class="line">  (ab, c, d) =&gt; (&#123;</div><div class="line">    <span class="attr">total</span>: ab + c + d</div><div class="line">  &#125;)</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="defaultMemoize-func-equalityCheck-defaultEqualityCheck"><a href="#defaultMemoize-func-equalityCheck-defaultEqualityCheck" class="headerlink" title="defaultMemoize(func, equalityCheck = defaultEqualityCheck)"></a>defaultMemoize(func, equalityCheck = defaultEqualityCheck)</h3><p><code>defaultMemoize</code> memoizes the function passed in the func parameter. It is the memoize function used by <code>createSelector</code>.</p>
<p><code>defaultMemoize</code> has a cache size of 1. This means it always recalculates when the value of an argument changes.</p>
<p><code>defaultMemoize</code> determines if an argument has changed by calling the <code>equalityCheck</code> function. As <code>defaultMemoize</code> is designed to be used with immutable data, the default <code>equalityCheck</code> function checks for changes using reference equality:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaultEqualityCheck</span>(<span class="params">currentVal, previousVal</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> currentVal === previousVal</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>defaultMemoize</code> can be used with <code>createSelectorCreator</code> to <a href="#customize-equalitycheck-for-defaultmemoize">customize the <code>equalityCheck</code> function</a>.</p>
<h3 id="createSelectorCreator-memoize-â€¦memoizeOptions"><a href="#createSelectorCreator-memoize-â€¦memoizeOptions" class="headerlink" title="createSelectorCreator(memoize, â€¦memoizeOptions)"></a>createSelectorCreator(memoize, â€¦memoizeOptions)</h3><p><code>createSelectorCreator</code> can be used to make a customized version of <code>createSelector</code>.</p>
<p>The <code>memoize</code> argument is a memoization function to replace <code>defaultMemoize</code>.</p>
<p>The <code>...memoizeOptions</code> rest parameters are zero or more configuration options to be passed to <code>memoizeFunc</code>. The selectors <code>resultFunc</code> is passed as the first argument to <code>memoize</code> and the <code>memoizeOptions</code> are passed as the second argument onwards:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(</div><div class="line">  customMemoize, <span class="comment">// function to be used to memoize resultFunc</span></div><div class="line">  option1, <span class="comment">// option1 will be passed as second argument to customMemoize</span></div><div class="line">  option2, <span class="comment">// option2 will be passed as third argument to customMemoize</span></div><div class="line">  option3 <span class="comment">// option3 will be passed as fourth argument to customMemoize</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> customSelector = customSelectorCreator(</div><div class="line">  input1,</div><div class="line">  input2,</div><div class="line">  resultFunc <span class="comment">// resultFunc will be passed as first argument to customMemoize</span></div><div class="line">)</div></pre></td></tr></table></figure>
<p>Internally <code>customSelector</code> calls the memoize function as follows:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">customMemoize(resultFunc, option1, option2, option3)</div></pre></td></tr></table></figure>
<p>Here are some examples of how you might use <code>createSelectorCreator</code>:</p>
<h4 id="Customize-equalityCheck-for-defaultMemoize"><a href="#Customize-equalityCheck-for-defaultMemoize" class="headerlink" title="Customize equalityCheck for defaultMemoize"></a>Customize <code>equalityCheck</code> for <code>defaultMemoize</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.filter(<span class="function"><span class="params">val</span> =&gt;</span> val &lt; <span class="number">5</span>),</div><div class="line">  values =&gt; values.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<h4 id="Use-memoize-function-from-lodash-for-an-unbounded-cache"><a href="#Use-memoize-function-from-lodash-for-an-unbounded-cache" class="headerlink" title="Use memoize function from lodash for an unbounded cache"></a>Use memoize function from lodash for an unbounded cache</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> called = <span class="number">0</span></div><div class="line"><span class="keyword">const</span> hashFn = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.reduce(</div><div class="line">  <span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + <span class="string">'-'</span> + <span class="built_in">JSON</span>.stringify(val),</div><div class="line">  <span class="string">''</span></div><div class="line">)</div><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(memoize, hashFn)</div><div class="line"><span class="keyword">const</span> selector = customSelectorCreator(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; &#123;</div><div class="line">    called++</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="createStructuredSelector-inputSelectors-selectorCreator-createSelector"><a href="#createStructuredSelector-inputSelectors-selectorCreator-createSelector" class="headerlink" title="createStructuredSelector({inputSelectors}, selectorCreator = createSelector)"></a>createStructuredSelector({inputSelectors}, selectorCreator = createSelector)</h3><p><code>createStructuredSelector</code> is a convenience function for a common pattern that arises when using Reselect. The selector passed to a <code>connect</code> decorator often just takes the values of its input-selectors and maps them to keys in an object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="comment">// The result function in the following selector</span></div><div class="line"><span class="comment">// is simply building an object from the input selectors</span></div><div class="line"><span class="keyword">const</span> structuredSelector = createSelector(</div><div class="line">   mySelectorA,</div><div class="line">   mySelectorB,</div><div class="line">   mySelectorC,</div><div class="line">   (a, b, c) =&gt; (&#123;</div><div class="line">     a,</div><div class="line">     b,</div><div class="line">     c</div><div class="line">   &#125;)</div><div class="line">)</div></pre></td></tr></table></figure>
<p><code>createStructuredSelector</code> takes an object whose properties are input-selectors and returns a structured selector. The structured selector returns an object with the same keys as the <code>inputSelectors</code> argument, but with the selectors replaced with their values.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="keyword">const</span> structuredSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">x</span>: mySelectorA,</div><div class="line">  <span class="attr">y</span>: mySelectorB</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> result = structuredSelector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;) <span class="comment">// will produce &#123; x: 1, y: 2 &#125;</span></div></pre></td></tr></table></figure>
<p>Structured selectors can be nested:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nestedSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">subA</span>: createStructuredSelector(&#123;</div><div class="line">    selectorA,</div><div class="line">    selectorB</div><div class="line">  &#125;),</div><div class="line">  <span class="attr">subB</span>: createStructuredSelector(&#123;</div><div class="line">    selectorC,</div><div class="line">    selectorD</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q-Why-isnâ€™t-my-selector-recomputing-when-the-input-state-changes"><a href="#Q-Why-isnâ€™t-my-selector-recomputing-when-the-input-state-changes" class="headerlink" title="Q: Why isnâ€™t my selector recomputing when the input state changes?"></a>Q: Why isnâ€™t my selector recomputing when the input state changes?</h3><p>A: Check that your memoization function is compatible with your state update function (i.e. the reducer if you are using Redux). For example, a selector created with <code>createSelector</code> will not work with a state update function that mutates an existing object instead of creating a new one each time. <code>createSelector</code> uses an identity check (<code>===</code>) to detect that an input has changed, so mutating an existing object will not trigger the selector to recompute because mutating an object does not change its identity. Note that if you are using Redux, mutating the state object is <a href="http://redux.js.org/docs/Troubleshooting.html" target="_blank" rel="external">almost certainly a mistake</a>.</p>
<p>The following example defines a simple selector that determines if the first todo item in an array of todos has been completed:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> isFirstTodoCompleteSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.todos[<span class="number">0</span>],</div><div class="line">  todo =&gt; todo &amp;&amp; todo.completed</div><div class="line">)</div></pre></td></tr></table></figure>
<p>The following state update function <strong>will not</strong> work with <code>isFirstTodoCompleteSelector</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// BAD: mutating an existing object</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      todo.completed = !areAllMarked</div><div class="line">      <span class="keyword">return</span> todo</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The following state update function <strong>will</strong> work with <code>isFirstTodoCompleteSelector</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// GOOD: returning a new object each time with Object.assign</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, todo, &#123;</div><div class="line">      <span class="attr">completed</span>: !areAllMarked</div><div class="line">    &#125;))</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If you are not using Redux and have a requirement to work with mutable data, you can use <code>createSelectorCreator</code> to replace the default memoization function and/or use a different equality check function. See <a href="#use-memoize-function-from-lodash-for-an-unbounded-cache">here</a> and <a href="#customize-equalitycheck-for-defaultmemoize">here</a> for examples.</p>
<h3 id="Q-Why-is-my-selector-recomputing-when-the-input-state-stays-the-same"><a href="#Q-Why-is-my-selector-recomputing-when-the-input-state-stays-the-same" class="headerlink" title="Q: Why is my selector recomputing when the input state stays the same?"></a>Q: Why is my selector recomputing when the input state stays the same?</h3><p>A: Check that your memoization function is compatible with your state update function (i.e. the reducer if you are using Redux). For example, a selector created with <code>createSelector</code> that recomputes unexpectedly may be receiving a new object on each update whether the values it contains have changed or not. <code>createSelector</code> uses an identity check (<code>===</code>) to detect that an input has changed, so returning a new object on each update means that the selector will recompute on each update.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">return</span> state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The following selector is going to recompute every time REMOVE_OLD is invoked because Array.filter always returns a new object. However, in the majority of cases the REMOVE_OLD action will not change the list of todos so the recomputation is unnecessary.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> visibleTodosSelector = createSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>You can eliminate unnecessary recomputations by returning a new object from the state update function only when a deep equality check has found that the list of todos has actually changed:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">const</span> updatedState =  state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">return</span> isEqual(updatedState, state) ? state : updatedState</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Alternatively, the default <code>equalityCheck</code> function in the selector can be replaced by a deep equality check:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>Always check that the cost of an alternative <code>equalityCheck</code> function or deep equality check in the state update function is not greater than the cost of recomputing every time. If recomputing every time does work out to be the cheaper option, it may be that for this case Reselect is not giving you any benefit over passing a plain <code>mapStateToProps</code> function to <code>connect</code>.</p>
<h3 id="Q-Can-I-use-Reselect-without-Redux"><a href="#Q-Can-I-use-Reselect-without-Redux" class="headerlink" title="Q: Can I use Reselect without Redux?"></a>Q: Can I use Reselect without Redux?</h3><p>A: Yes. Reselect has no dependencies on any other package, so although it was designed to be used with Redux it can be used independently. It is currently being used successfully in traditional Flux apps.</p>
<blockquote>
<p>If you create selectors using <code>createSelector</code> make sure its arguments are immutable.<br>See <a href="#createselectorinputselectors--inputselectors-resultfunc">here</a></p>
</blockquote>
<h3 id="Q-How-do-I-create-a-selector-that-takes-an-argument"><a href="#Q-How-do-I-create-a-selector-that-takes-an-argument" class="headerlink" title="Q: How do I create a selector that takes an argument?"></a>Q: How do I create a selector that takes an argument?</h3><p>A: Reselect doesnâ€™t have built-in support for creating selectors that accepts arguments, but here are some suggestions for implementing similar functionalityâ€¦</p>
<p>If the argument is not dynamic you can use a factory function:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> expensiveItemSelectorFactory = <span class="function"><span class="params">minValue</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    shopItemsSelector,</div><div class="line">    items =&gt; items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  expensiveItemSelectorFactory(<span class="number">200</span>),</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<p>The general consensus <a href="https://github.com/reactjs/reselect/issues/38" target="_blank" rel="external">here</a> and <a href="https://github.com/optimizely/nuclear-js/issues/14" target="_blank" rel="external">over at nuclear-js</a> is that if a selector needs a dynamic argument, then that argument should probably be state in the store. If you decide that you do require a selector with a dynamic argument, then a selector that returns a memoized function may be suitable:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.items,</div><div class="line">  items =&gt; memoize(</div><div class="line">    <span class="function"><span class="params">minValue</span> =&gt;</span> items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveFilter = expensiveSelector(state)</div><div class="line"></div><div class="line"><span class="keyword">const</span> slightlyExpensive = expensiveFilter(<span class="number">100</span>)</div><div class="line"><span class="keyword">const</span> veryExpensive = expensiveFilter(<span class="number">1000000</span>)</div></pre></td></tr></table></figure>
<h3 id="Q-The-default-memoization-function-is-no-good-can-I-use-a-different-one"><a href="#Q-The-default-memoization-function-is-no-good-can-I-use-a-different-one" class="headerlink" title="Q: The default memoization function is no good, can I use a different one?"></a>Q: The default memoization function is no good, can I use a different one?</h3><p>A: We think it works great for a lot of use cases, but sure. See <a href="#customize-equalitycheck-for-defaultmemoize">these examples</a>.</p>
<h3 id="Q-How-do-I-test-a-selector"><a href="#Q-How-do-I-test-a-selector" class="headerlink" title="Q: How do I test a selector?"></a>Q: How do I test a selector?</h3><p>A: For a given input, a selector should always produce the same output. For this reason they are simple to unit test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> selector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; (&#123;</div><div class="line">    <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">    <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">  &#125;)</div><div class="line">)</div><div class="line"></div><div class="line">test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">6</span> &#125;)</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">3</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>It may also be useful to check that the memoization function for a selector works correctly with the state update function (i.e. the reducer if you are using Redux). Each selector has a <code>recomputations</code> method that will return the number of times it has been recomputed:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">suite(<span class="string">'selector'</span>, () =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> state = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> (</div><div class="line">    &#123;</div><div class="line">      <span class="attr">a</span>: action(state.a),</div><div class="line">      <span class="attr">b</span>: action(state.b)</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> selector = createSelector(</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">    state =&gt; state.b,</div><div class="line">    (a, b) =&gt; (&#123;</div><div class="line">      <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">      <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> plusOne = <span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span></div><div class="line">  <span class="keyword">const</span> id = <span class="function"><span class="params">x</span> =&gt;</span> x</div><div class="line"></div><div class="line">  test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    state = reducer(state, id)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">1</span>)</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">6</span>, <span class="attr">d</span>: <span class="number">12</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">2</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Additionally, selectors keep a reference to the last result function as <code>.resultFunc</code>. If you have selectors composed of many other selectors this can help you test each selector without coupling all of your tests to the shape of your state.</p>
<p>For example if you have a set of selectors like this:</p>
<p><strong>selectors.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> firstSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> secondSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> thirdSelector = createSelector( ... )</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> myComposedSelector = createSelector(</div><div class="line">  firstSelector,</div><div class="line">  secondSelector,</div><div class="line">  thirdSelector,</div><div class="line">  (first, second, third) =&gt; first * second &lt; third</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>And then a set of unit tests like this:</p>
<p><strong>test/selectors.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests for the first three selectors...</span></div><div class="line">test(<span class="string">"firstSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"secondSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"thirdSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line"></div><div class="line"><span class="comment">// We have already tested the previous</span></div><div class="line"><span class="comment">// three selector outputs so we can just call `.resultFunc`</span></div><div class="line"><span class="comment">// with the values we want to test directly:</span></div><div class="line">test(<span class="string">"myComposedSelector unit test"</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// here instead of calling selector()</span></div><div class="line">  <span class="comment">// we just call selector.resultFunc()</span></div><div class="line">  assert(selector.resultFunc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="literal">true</span>)</div><div class="line">  assert(selector.resultFunc(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>), <span class="literal">false</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Finally, each selector has a <code>resetRecomputations</code> method that sets<br>recomputations back to 0.  The intended use is for a complex selector that may<br>have many independent tests and you donâ€™t want to manually manage the<br>computation count or create a â€œdummyâ€ selector for each test.</p>
<h3 id="Q-How-do-I-use-Reselect-with-Immutable-js"><a href="#Q-How-do-I-use-Reselect-with-Immutable-js" class="headerlink" title="Q: How do I use Reselect with Immutable.js?"></a>Q: How do I use Reselect with Immutable.js?</h3><p>A: Selectors created with <code>createSelector</code> should work just fine with Immutable.js data structures.</p>
<p>If your selector is recomputing and you donâ€™t think the state has changed, make sure you are aware of which Immutable.js update methods <strong>always</strong> return a new object and which update methods only return a new object <strong>when the collection actually changes</strong>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Immutable <span class="keyword">from</span> <span class="string">'immutable'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = Immutable.Map(&#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"> <span class="comment">// set, merge and others only return a new obj when update changes collection</span></div><div class="line"><span class="keyword">let</span> newMap = myMap.set(<span class="string">'a'</span>, <span class="number">1</span>)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line">newMap = myMap.merge(&#123; <span class="string">'a'</span>, <span class="number">1</span> &#125;)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line"><span class="comment">// map, reduce, filter and others always return a new obj</span></div><div class="line">newMap = myMap.map(<span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">1</span>)</div><div class="line">assert.notEqual(myMap, newMap)</div></pre></td></tr></table></figure>
<p>If a selectorâ€™s input is updated by an operation that always returns a new object, it may be performing unnecessary recomputations. See <a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">here</a> for a discussion on the pros and cons of using a deep equality check like <code>Immutable.is</code> to eliminate unnecessary recomputations.</p>
<h3 id="Q-Can-I-share-a-selector-across-multiple-components"><a href="#Q-Can-I-share-a-selector-across-multiple-components" class="headerlink" title="Q: Can I share a selector across multiple components?"></a>Q: Can I share a selector across multiple components?</h3><p>A: Selectors created using <code>createSelector</code> only have a cache size of one. This can make them unsuitable for sharing across multiple components if the arguments to the selector are different for each instance of the component. There are a couple of ways to get around this:</p>
<ul>
<li><p>Create a factory function which returns a new selector for each instance of the component. There is built-in support for factory functions in React Redux v4.3 or higher. See <a href="#sharing-selectors-with-props-across-multiple-components">here</a> for an example.</p>
</li>
<li><p>Create a custom selector with a cache size greater than one.</p>
</li>
</ul>
<h3 id="Q-Are-there-TypeScript-Typings"><a href="#Q-Are-there-TypeScript-Typings" class="headerlink" title="Q: Are there TypeScript Typings?"></a>Q: Are there TypeScript Typings?</h3><p>A: Yes! They are included and referenced in <code>package.json</code>. They should Just Workâ„¢.</p>
<h3 id="Q-How-can-I-make-a-curried-selector"><a href="#Q-How-can-I-make-a-curried-selector" class="headerlink" title="Q: How can I make a curried selector?"></a>Q: How can I make a <a href="https://github.com/hemanth/functional-programming-jargon#currying" target="_blank" rel="external">curried</a> selector?</h3><p>A: Try these <a href="https://github.com/reactjs/reselect/issues/159#issuecomment-238724788" target="_blank" rel="external">helper functions</a> courtesy of <a href="https://github.com/MattSPalmer" target="_blank" rel="external">MattSPalmer</a></p>
<h2 id="Related-Projects"><a href="#Related-Projects" class="headerlink" title="Related Projects"></a>Related Projects</h2><p>###<a href="https://github.com/HeyImAlex/reselect-map" target="_blank" rel="external">reselect-map</a></p>
<p>Can be useful when doing <strong>very expensive</strong> computations on elements of a collection because Reselect might not give you the granularity of caching that you need. Check out the reselect-maps README for examples.</p>
<p><strong>The optimizations in reselect-map only apply in a small number of cases. If you are unsure whether you need it, you donâ€™t!</strong></p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptä¸­çš„thiså…³é”®å­—]]></title>
      <url>http://yoursite.com/2017/03/08/javascript%E4%B8%AD%E7%9A%84this%E5%85%B3%E9%94%AE%E5%AD%97/</url>
      <content type="html"><![CDATA[<p>å‰é¢å¯¹è¿™ä¸ªé—®é¢˜æ€»æ˜¯é›¾é‡Œçœ‹èŠ±ï¼ŒåƒğŸŒ§åƒé›¾åˆåƒé£ã€‚æœ€è¿‘ç»¼åˆç€çœ‹äº†ä¸€äº›ä¹¦å’Œæ–‡ç« æ‰ç®—æ˜¯åŸºæœ¬ææ¸…æ¥šäº†ã€‚<br>ä¸»è¦å‚è€ƒã€Šjavascrptè®¾è®¡æ¨¡å¼ä¸å¼€å‘æŒ‡å—ã€‹</p>
<p>javascript(ç¼©å†™js)è¯­è¨€ä¸­çš„thiså’Œjava,phpä¸­çš„thisæ˜¯å®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚<br>jsä¸­çš„thisæ˜¯åŠ¨æ€çš„ï¼Œæ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯è°ï¼Œéœ€è¦æ ¹æ®å‡½æ•°çš„è°ƒç”¨ä¸Šä¸‹æ–‡æ¥å†³å®šã€‚</p>
<ol>
<li>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨(æ˜¾ç¤ºç»‘å®š)</li>
<li>ä½œä¸ºæ™®é€šçš„å‡½æ•°æ¥è°ƒç”¨(é»˜è®¤ç»‘å®š)</li>
<li>ä½œä¸ºæ„é€ å™¨æ¥è°ƒç”¨</li>
<li>callå’Œapplyæ–¹æ³•è°ƒç”¨</li>
</ol>
<p>1ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">		<span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">		<span class="attr">getA</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			alert ( <span class="keyword">this</span> === obj ); <span class="comment">// è¾“å‡ºï¼štrue</span></div><div class="line">			alert ( <span class="keyword">this</span>.a ); <span class="comment">// è¾“å‡º: 1</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	obj.getA();  <span class="comment">//å‡½æ•°è¢«ç»‘å®šåœ¨å¯¹è±¡objä¸Šï¼ŒthisæŒ‡å‘objå¯¹è±¡</span></div><div class="line">	<span class="comment">//è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥ç«‹å³çœ‹åˆ°ç»‘å®šçš„å¯¹è±¡æ˜¯é‚£ä¸€ä¸ªï¼Œæ‰€ä»¥æ˜¯æœ€ç®€å•çš„</span></div></pre></td></tr></table></figure></p>
<p>2ä½œä¸ºæ™®é€šå‡½æ•°çš„è°ƒç”¨<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åœ¨æµè§ˆå™¨çš„JavaScript é‡Œï¼Œè¿™ä¸ªå…¨å±€å¯¹è±¡æ˜¯window å¯¹è±¡ã€‚</span></div><div class="line">	<span class="built_in">window</span>.name = <span class="string">'globalName'</span>;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è¿™ä¸ªå‡½æ•°æ²¡æœ‰æŒ‡å®šå¯¹è±¡ï¼Œé»˜è®¤ç»‘å®šåœ¨windowå¯¹è±¡ä¸Š</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">	&#125;;</div><div class="line">	<span class="built_in">console</span>.log( getName() ); <span class="comment">// è¾“å‡ºï¼šglobalName</span></div><div class="line"></div><div class="line">	<span class="comment">//æˆ–è€…ï¼š</span></div><div class="line">	<span class="built_in">window</span>.name = <span class="string">'globalName'</span>;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> myObject = &#123;</div><div class="line">		<span class="attr">name</span>: <span class="string">'sven'</span>,</div><div class="line">		<span class="attr">getName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">  <span class="comment">//ä¸‹é¢è¿™ä¸ªå¼•ç”¨æ˜¯æ¯”è¾ƒè¿·æƒ‘äººçš„ï¼Œåœ¨ç”¨å˜é‡å¼•ç”¨ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•æ—¶å€™ï¼Œå˜é‡ä»…ä»…æŒ‡å‘å‡½æ•°æœ¬èº«ï¼Œå’ŒåŸæ¥å‡½æ•°å®šä¹‰åœ¨å“ªä¸ªå¯¹è±¡é‡Œæ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè¿™ä¸€ç‚¹è¦æ³¨æ„</span></div><div class="line">	<span class="keyword">var</span> getName = myObject.getName; <span class="comment">//getNameå‡½æ•°ä»»ç„¶æ˜¯é»˜è®¤ç»‘å®šåœ¨windowå…¨å±€å¯¹è±¡ä¸Š</span></div><div class="line">	<span class="built_in">console</span>.log( getName() ); <span class="comment">// globalName</span></div></pre></td></tr></table></figure></p>
<p><code>ä¸‹é¢è¿™ä¸ªå®ä¾‹ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæ˜¯js thisä¸­æœ€ä¸ºè¿·æƒ‘çš„åœ°æ–¹ï¼Œéœ€è¦æ³¨æ„ï¼Œå¯èƒ½å­¦äº†å¾ˆé•¿æ—¶é—´éƒ½å¯¹è¿™ä¸ªåœ°æ–¹è¿·æƒ‘ï¼Œæ²¡æœ‰ä»€ä¹ˆåŸå› ï¼Œjså°±æ˜¯è¿™ä¹ˆè§„å®šçš„ã€‚</code></p>
<p><code>é‚£ï¼Œåˆ°åº•è§„å®šä»€ä¹ˆäº†ï¼Ÿå°±æ˜¯ å‡½æ•°å†…éƒ¨çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é—­åŒ…å‡½æ•°çš„å¯¹è±¡æ˜¯é»˜è®¤ç»‘å®šåœ¨å…¨å±€ï¼Œå…¨å±€ï¼Œå…¨å±€ å¯¹è±¡ä¸Šçš„ï¼Œä¸€å®šï¼Œä¸€å®šï¼Œä¸€å®š è¦è®°ä½è¿™ä¸€ç‚¹</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªdiv<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"></div><div class="line">	<span class="built_in">window</span>.id = <span class="string">'window'</span>;</div><div class="line"></div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'div1'</span> ).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		alert ( <span class="keyword">this</span>.id ); <span class="comment">// è¾“å‡ºï¼š'div1'</span></div><div class="line">		<span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//è¿™ä¸ªå‡½æ•°å†…éƒ¨çš„å‡½æ•°ï¼Œä»–æ˜¯é»˜è®¤ç»‘å®šåœ¨windowä¸Šçš„</span></div><div class="line">			alert ( <span class="keyword">this</span>.id ); <span class="comment">// è¾“å‡ºï¼š'window' </span></div><div class="line">		&#125;</div><div class="line">		callback();</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">  <span class="comment">//é‚£ä¹ˆè¦æ˜¯å†…éƒ¨å‡½æ•°è¦ä½¿ç”¨å¤–éƒ¨å‡½æ•°ç»‘å®šçš„å¯¹è±¡æ€ä¹ˆåŠã€‚</span></div><div class="line">  <span class="comment">//å¥½åŠï¼Œå°±æ˜¯æŠŠå¤–éƒ¨å‡½æ•°çš„å¯¹è±¡ä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­</span></div><div class="line">  <span class="comment">//ç»å¸¸åœ¨ä»£ç ä¸­çœ‹åˆ°çš„ var that=thiså°±æ˜¯è¿™ä¸ªä½œç”¨</span></div><div class="line">  <span class="comment">//åœ¨å†…éƒ¨å‡½æ•°è¦ä½¿ç”¨åŒä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥ç”¨thatäº†ã€‚æˆ–è€…ç”¨ var  self=this </span></div><div class="line">  <span class="comment">//è¿™ä»…ä»…æ˜¯å˜é‡çš„åå­—ä¸åŒï¼Œé“ç†éƒ½ä¸€æ ·</span></div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'div1'</span> ).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> that = <span class="keyword">this</span>; <span class="comment">// ä¿å­˜div çš„å¼•ç”¨</span></div><div class="line">		<span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			alert ( that.id ); <span class="comment">// è¾“å‡ºï¼š'div1'  //thatæŒ‡å‘äº†å¤–éƒ¨å‡½æ•°çš„å¯¹è±¡</span></div><div class="line">		&#125;</div><div class="line">		callback();</div><div class="line">	&#125;;</div></pre></td></tr></table></figure>
<p>åœ¨ ECMA es5çš„ä¸¥æ ¼æ¨¡å¼ä¸‹<br>é—®é¢˜åˆæœ‰æ”¹å˜äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">use strict </div><div class="line"></div><div class="line">è¿™æ—¶å€™ï¼Œå†…éƒ¨å‡½æ•°çš„<span class="keyword">this</span>ä¸åœ¨é»˜è®¤æŒ‡å‘<span class="built_in">window</span>å¯¹è±¡ï¼Œè€Œæ˜¯æŒ‡å‘undefineï¼Œå®é™…å°±æ˜¯æ²¡æœ‰é»˜è®¤ç»‘å®šå¯¹è±¡ã€‚</div></pre></td></tr></table></figure>
<p>3æ„é€ å™¨è°ƒç”¨<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MyClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = <span class="string">'sven'</span>;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> obj = <span class="keyword">new</span> MyClass();  <span class="comment">//å½“ä½¿ç”¨æ„é€ å™¨è°ƒç”¨çš„æ—¶å€™ï¼Œæ„é€ å™¨è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œthiså°±æŒ‡å‘è¿™ä¸ªå¯¹è±¡</span></div><div class="line">	alert ( obj.name ); <span class="comment">// è¾“å‡ºï¼šsven</span></div><div class="line"></div><div class="line">	<span class="keyword">var</span> MyClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = <span class="string">'sven'</span>;</div><div class="line">		<span class="keyword">return</span> &#123; <span class="comment">// æ˜¾å¼åœ°è¿”å›ä¸€ä¸ªå¯¹è±¡</span></div><div class="line">			name: <span class="string">'anne'</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div></pre></td></tr></table></figure></p>
<p>4call apply è°ƒç”¨<br>ç¡¬å¼ç»‘å®šï¼Œé€šè¿‡ä¼ å‚æ–¹å¼åŠ¨æ€æ”¹å˜å‡½æ•°çš„ç»‘å®šå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> obj1 = &#123;</div><div class="line">	<span class="attr">name</span>: <span class="string">'sven'</span>,</div><div class="line">	<span class="attr">getName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj2 = &#123;</div><div class="line">	<span class="attr">name</span>: <span class="string">'anne'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( obj1.getName() ); <span class="comment">// è¾“å‡º: sven</span></div><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸ªå‡½æ•°ç¡¬å¼ç»‘å®šåˆ°obj2å¯¹è±¡ä¸Š</span></div><div class="line"><span class="built_in">console</span>.log( obj1.getName.call( obj2 ) ); <span class="comment">// è¾“å‡ºï¼šanne</span></div></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯thisã€‚</p>
<p>å…³é”®å­—çš„å†…å®¹ï¼Œå…³é”®çš„åœ°æ–¹æ˜¯å¯¹æ¦‚å¿µæœ‰ä¸€å®šåƒé€ï¼Œå‡ºé—®é¢˜éƒ½æ˜¯æ¦‚å¿µä¸æ¸…æ¥šå¼•èµ·çš„</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptæ¡¥æ¥æ¨¡å¼(1)-é˜Ÿåˆ—æ•°æ®ç»“æ„]]></title>
      <url>http://yoursite.com/2017/03/08/JavaScript%E7%9A%84%E9%98%9F%E5%88%97%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æ ¹æ®ä¹¦ä¸Šä¾‹å­çš„å®é™…è¦æ±‚ï¼Œæ¶‰åŠåˆ°jsé˜Ÿåˆ—çš„é—®é¢˜ã€‚æ‰€ä»¥å…ˆæŠŠjsä¸­é˜Ÿåˆ—çš„å…·ä½“å®ç°æ•°æ®ç»“æ„è´´å‡ºæ¥ã€‚å…·ä½“å‚è€ƒã€Šå­¦ä¹ javascriptæ•°æ®ç»“æ„å’Œç®—æ³•ã€‹ç¬¬å››ç« ã€‚<br>é˜Ÿåˆ—æ•°æ®ç»“æ„éµå¾ªå…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚å…¥é˜Ÿæ“ä½œæ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œè¿”å›æ–°æ•°ç»„ã€‚å‡ºé˜Ÿæ“ä½œå¼¹å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›æ–°æ•°ç»„ã€‚ä¸¤ä¸ªæ“ä½œå¯¹äºæ•°ç»„éƒ½æœ‰ç»“æ„çš„æ”¹å˜</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//jsä¸­é˜Ÿåˆ—çš„å®ç°æ˜¯ä¾èµ–æ•°ç»„çš„æ•°æ®ç»“æ„</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];  <span class="comment">//åˆå§‹åŒ–ç©ºæ•°ç»„ï¼Œletå…³é”®å­—æ˜¯es6ä¸­çš„</span></div><div class="line">    <span class="comment">//ç”¨äºå½¢æˆå¤§æ‹¬å·åŒ…å›´çš„ä½œç”¨åŸŸ</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123; <span class="comment">//å…¥é˜Ÿæ“ä½œ</span></div><div class="line">        items.push(element); <span class="comment">//æ•°ç»„pushæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//å‡ºå¯¹</span></div><div class="line">        <span class="keyword">return</span> items.shift(); <span class="comment">//æ•°ç»„shiftæ“ä½œ</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];     <span class="comment">//æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//åˆ¤æ–­é˜Ÿåˆ—æœ‰æ— æˆå‘˜</span></div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>; <span class="comment">//å¸ƒå°”å€¼åˆ¤æ–­</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ¸…ç©ºé˜Ÿåˆ—</span></div><div class="line">        items = [];   <span class="comment">//å˜é‡é‡æ–°èµ‹å€¼ç©ºæ•°ç»„</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è·å¾—é˜Ÿåˆ—çš„é•¿åº¦</span></div><div class="line">        <span class="keyword">return</span> items.length; </div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ‰“å°é˜Ÿåˆ—</span></div><div class="line">        <span class="built_in">console</span>.log(items.toString());</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ã€‚æ•°æ®æˆå‘˜å…¥é˜Ÿçš„æ—¶å€™è¦æºå¸¦æ•°æ®å’Œä¼˜å…ˆçº§ã€‚<br>ä¼˜å…ˆçº§åœ¨è¿™é‡Œçš„å®šä¹‰æ˜¯æ•°å­—è¶Šå¤§åœ¨æ•°ç»„ä¸­çš„ä½ç½®é åã€‚å½“æ’å…¥ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆè¦æ ¹æ®å®ƒçš„ä¼˜å…ˆçº§æ¥åˆ¤æ–­ï¼Œæœ€å°æ˜¯ç›´æ¥æ’å…¥åˆ°ç¬¬ä¸€ä½ï¼Œç´§é‚»ä¸€ä¸ªæ¯”ä»–å¤§çš„ä¼˜å…ˆçº§æ˜¯ï¼Œå°±æ’å…¥åˆ°è¿™ä¸ªé‚»å±…çš„å‰é¢ã€‚å¦‚æœæ˜¯æœ€å¤§çš„æ•°å­—å°±æ’åˆ°æ•°ç»„çš„æœ€åã€‚<br>ä¸€ç»´æ•°ç»„å˜æˆäº†äºŒä½æ•°ç»„ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PriorityQueue</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> items = [];</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">QueueElement</span> (<span class="params">element, priority</span>)</span>&#123; </div><div class="line">            <span class="keyword">this</span>.element = element;<span class="comment">//æˆå‘˜æœ¬èº«</span></div><div class="line">        <span class="keyword">this</span>.priority = priority;  <span class="comment">//ä¼˜å…ˆçº§</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">element, priority</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> queueElement = <span class="keyword">new</span> QueueElement(element, priority);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> added = <span class="literal">false</span>; <span class="comment">//æ·»åŠ æ ‡è®°</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (queueElement.priority &lt;             items[i].priority)&#123;  <span class="comment">//æ‰¾åˆ°ä¼˜å…ˆçº§æ•°å­—æ¯”ä»–å¤§çš„é‚£ä¸ªå…ƒç´ </span></div><div class="line"></div><div class="line">                items.splice(i,<span class="number">0</span>,queueElement);             <span class="comment">// æ’åˆ°è¿™ä¸ªå…ƒç´ çš„å‰é¢</span></div><div class="line">                added = <span class="literal">true</span>;</div><div class="line">                <span class="keyword">break</span>; <span class="comment">// ç»ˆæ­¢</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!added)&#123; <span class="comment">//å¦‚æœæ˜¯ä¼˜å…ˆçº§æ•°å­—æ˜¯æœ€å¤§çš„ï¼Œç›´æ¥æ’å…¥åˆ°</span></div><div class="line">        <span class="comment">//æ•°ç»„çš„æœ«å°¾</span></div><div class="line">            items.push(queueElement); <span class="comment">//&#123;5&#125;</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="comment">//å…¶ä»–æ“ä½œå’Œæ™®é€šé˜Ÿåˆ—æ˜¯ä¸€æ ·çš„</span></div><div class="line"></div><div class="line">    <span class="keyword">this</span>.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.shift();</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.front = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items[<span class="number">0</span>];</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length == <span class="number">0</span>;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> items.length;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//printä½¿ç”¨äº†es6é‡Œçš„æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹æ³•</span></div><div class="line">    <span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;items.length; i++)&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;items[i].element&#125;</span>  - <span class="subst">$&#123;items[i].priority&#125;</span>`</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> priorityQueue = <span class="keyword">new</span> PriorityQueue();</div><div class="line">priorityQueue.enqueue(<span class="string">"John"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Jack"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Camila"</span>, <span class="number">1</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Maxwell"</span>, <span class="number">2</span>);</div><div class="line">priorityQueue.enqueue(<span class="string">"Ana"</span>, <span class="number">3</span>);</div><div class="line">priorityQueue.print();</div><div class="line"><span class="comment">//=&gt;</span></div><div class="line"><span class="comment">//æ‰“å°å‡ºçš„ç»“æœ</span></div><div class="line">Jack  - <span class="number">1</span></div><div class="line">Camila  - <span class="number">1</span></div><div class="line">John  - <span class="number">2</span></div><div class="line">Maxwell  - <span class="number">2</span></div><div class="line">Ana  - <span class="number">3</span></div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨React,Redux,redux-sageæ„å»ºå›¾ç‰‡åº“(ç¿»è¯‘)]]></title>
      <url>http://yoursite.com/2017/03/08/Getting%20Started%20with%20React,%20Redux%20and%20Immutable:%20a%20Test-Driven%20Tutorial%20(Part%202)%20/</url>
      <content type="html"><![CDATA[<p>ç¿»è¯‘ç‰ˆæœ¬,<a href="http://www.theodo.fr/blog/2016/03/getting-started-with-react-redux-and-immutable-a-test-driven-tutorial-part-2/" target="_blank" rel="external">åŸæ–‡è¯·è§</a></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNc79ly1fds4960hm8j30xc0b4weu.jpg" alt="Imageç”±[egghead.ioæä¾›](http://egghead.io/)"></p>
<p>è¿™æ˜¯ç¬¬äºŒéƒ¨åˆ†çš„å†…å®¹.</p>
<p>åœ¨ç¬¬ä¸€éƒ¨åˆ†,æˆ‘ä»¬ç½—åˆ—äº†appçš„UI,å¼€å‘å’Œå•å…ƒæµ‹è¯•çš„åŸºç¡€.</p>
<p>æˆ‘ä»¬çœ‹åˆ°äº†appçš„stateé€šè¿‡Reactçš„<code>props</code>å‘ä¸‹ä¼ é€’åˆ°å•ä¸ªçš„ç»„ä»¶,ç”¨æˆ·çš„actionså£°æ˜ä¸ºå›è°ƒå‡½æ•°,å› æ­¤appçš„é€»è¾‘å’ŒUIåˆ†ç¦»å¼€æ¥äº†.</p>
<h2 id="Reduxçš„å·¥ä½œæµä»‹ç»"><a href="#Reduxçš„å·¥ä½œæµä»‹ç»" class="headerlink" title="Reduxçš„å·¥ä½œæµä»‹ç»"></a>Reduxçš„å·¥ä½œæµä»‹ç»</h2><p>åœ¨è¿™ä¸€ç‚¹ä¸Š,æˆ‘ä»¬çš„UIæ˜¯æ²¡æœ‰äº¤äº’æ“ä½œçš„:å°½ç®¡æˆ‘ä»¬å·²ç»æµ‹è¯•äº†å¦‚æœä¸€ä¸ªitemå¦‚æœè¢«è®¾å®šä¸º<code>completed</code>,å®ƒå°†ç»™æ–‡æœ¬åˆ’çº¿,ä½†æ˜¯è¿™é‡Œè¿˜æ²¡æœ‰æ–¹æ³•é‚€è¯·ç”¨æˆ·æ¥å®Œæˆå®ƒ:</p>
<ol>
<li>state treeé€šè¿‡<code>props</code>å®šä¹‰äº†UIå’Œactionå›è°ƒå‡½æ•°.</li>
<li>ç”¨æˆ·çš„actions,ä¾‹å¦‚ç‚¹å‡»,è¢«å‘é€åˆ°action creator,actionè¢«å®ƒèŒƒå¼åŒ–.</li>
<li>redux actionè¢«ä¼ é€’åˆ°reducerå®ç°å®é™…çš„appé€»è¾‘</li>
<li>reduceræ›´æ–°state tree,dispatch stateåˆ°store.</li>
<li>UIæ ¹æ®storeé‡Œçš„æ–°state treeæ¥æ›´æ–°UI</li>
</ol>
<p><img src="https://ww3.sinaimg.cn/large/006tNc79ly1fdua9bq152j30f10870sn.jpg" alt="Redux working flos"></p>
<h2 id="è®¾å®šåˆå§‹åŒ–state"><a href="#è®¾å®šåˆå§‹åŒ–state" class="headerlink" title="è®¾å®šåˆå§‹åŒ–state"></a>è®¾å®šåˆå§‹åŒ–state</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/be48d4d610b3438aeb1dfcd07d317b3c72fbdb3e" target="_blank" rel="external">è¿™éƒ¨åˆ†çš„ä»£ç æäº¤åœ¨è¿™é‡Œ</a></p>
<p>æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªactionå°†ä¼šå…è®¸æˆ‘ä»¬åœ¨Redux storeé‡Œæ­£ç¡®çš„è®¾ç½®åˆå§‹åŒ–state<br>,æˆ‘ä»¬å°†ä¼šåˆ›å»ºstore.</p>
<p>Reduxä¸­çš„actionæ˜¯ä¸€ä¸ªä¿¡æ¯çš„è½½ä½“(payload).actionç”±ä¸€ä¸ªJSONå¯¹è±¡æœ‰ä¸€ä¸ª<code>type</code>å±æ€§,æè¿°actionåˆ°åº•æ˜¯åšä»€ä¹ˆçš„,è¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯appéœ€è¦çš„ä¿¡æ¯.åœ¨æˆ‘ä»¬çš„å®ä¾‹ä¸­,typeè¢«è®¾å®šä¸º<code>SET_STATE</code>,æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªstateå¯¹è±¡åŒ…å«éœ€è¦çš„state:<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attribute">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">  <span class="attribute">state</span>: &#123;</div><div class="line">    <span class="attribute">todos</span>: [</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">1</span>, <span class="attribute">text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">2</span>, <span class="attribute">text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">3</span>, <span class="attribute">text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">    ],</div><div class="line">    <span class="attribute">filter</span>: <span class="string">'all'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªactionä¼šè¢«dispatchåˆ°ä¸€ä¸ªreducer,reducerè§’è‰²çš„æ˜¯è¯†åˆ«å’Œå®æ–½å’Œactionå¯¹åº”çš„é€»è¾‘ä»£ç .</p>
<p>è®©æˆ‘ä»¬ä¸ºreduceræ¥å†™å•å…ƒæµ‹è¯•ä»£ç <br><code>test/reducer_spec.js</code><br><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"> <span class="title">import</span> &#123;List, <span class="built_in">Map</span>, fromJS&#125; from <span class="string">'immutable'</span>;</div><div class="line"><span class="title">import</span> &#123;expect&#125; from <span class="string">'chai'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> reducer from <span class="string">'../src/reducer'</span>;</div><div class="line"></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line"></div><div class="line">  it(<span class="string">'handles SET_STATE'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = <span class="built_in">Map</span>();</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attribute">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">      <span class="attribute">state</span>: <span class="built_in">Map</span>(&#123;</div><div class="line">        <span class="attribute">todos</span>: List.of(</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 1, text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;),</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 2, text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;),</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 3, text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'completed'</span>&#125;)</div><div class="line">        )</div><div class="line">      &#125;)</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line"></div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attribute">todos</span>: [</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 1, text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 2, text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 3, text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†æ–¹ä¾¿ä¸€ç‚¹,<code>state</code>ä½¿ç”¨å•çº¯JSå¯¹è±¡,è€Œä¸æ˜¯ä½¿ç”¨Immutableæ•°æ®ç»“æ„.è®©æˆ‘ä»¬çš„reduceræ¥å¤„ç†è½¬å˜.æœ€å,reducerå°†ä¼šä¼˜é›…çš„å¤„ç†<code>undefined</code>åˆå§‹åŒ–state:<br><code>test/reducer_spec.js</code><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles SET_STATE with plain JS payload'</span>, () =&gt; &#123;</div><div class="line">    const initialState = Map();</div><div class="line">    const action = &#123;</div><div class="line"><span class="symbol">      type:</span> <span class="string">'SET_STATE'</span>,</div><div class="line"><span class="symbol">      state:</span> &#123;</div><div class="line"><span class="symbol">        todos:</span> [</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    const nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line"><span class="symbol">      todos:</span> [</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles SET_STATE without initial state'</span>, () =&gt; &#123;</div><div class="line">    const action = &#123;</div><div class="line"><span class="symbol">      type:</span> <span class="string">'SET_STATE'</span>,</div><div class="line"><span class="symbol">      state:</span> &#123;</div><div class="line"><span class="symbol">        todos:</span> [</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    const nextState = reducer(undefined, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line"><span class="symbol">      todos:</span> [</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çš„reducerå°†ä¼šåŒ¹é…æ¥æ”¶çš„actionsçš„<code>type</code>,å¦‚æœtypeæ˜¯<code>SET_STATE</code>,å½“å‰çš„stateå’Œactionè¿è½½çš„stateèåˆåœ¨ä¸€èµ·:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;<span class="built_in">Map</span>&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setState</span>(<span class="params">state, newState</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.merge(newState);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬ä¸å¾—ä¸æŠŠreducerè¿æ¥åˆ°æˆ‘ä»¬çš„app,æ‰€ä»¥å½“appå¯åŠ¨åˆå§‹åŒ–state.è¿™é‡Œå®é™…æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨Reduxåº“,å®‰è£…ä¸€ä¸‹<br><code>npm install â€”save redux@3.3.1 react-redux@4.4.1</code></p>
<p><code>src/index.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123;List, <span class="built_in">Map</span>&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123;TodoAppContainer&#125; <span class="keyword">from</span> <span class="string">'./components/TodoApp'</span>;</div><div class="line"></div><div class="line"><span class="comment">// We instantiate a new Redux store</span></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"><span class="comment">// We dispatch the SET_STATE action holding the desired state</span></div><div class="line">store.dispatch(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">  <span class="attr">state</span>: &#123;</div><div class="line">    <span class="attr">todos</span>: [</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">    ],</div><div class="line">    <span class="attr">filter</span>: <span class="string">'all'</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">require</span>(<span class="string">'../node_modules/todomvc-app-css/index.css'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="comment">// We wrap our app in a Provider component to pass the store down to the components</span></div><div class="line">  &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">TodoAppContainer</span> /&gt;</span></span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ çœ‹çœ‹ä¸Šé¢çš„ä»£ç æ®µ,ä½ å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬çš„<code>TodoApp</code>ç»„ä»¶å®é™…æ˜¯è¢«<code>TodoAppContainer</code>ä»£æ›¿.åœ¨Reduxé‡Œ,æœ‰ä¸¤ç§ç±»å‹çš„ç»„ä»¶:å±•ç¤ºç»„ä»¶å’Œå®¹å™¨.æˆ‘æ¨èä½ é˜…è¯»ä¸€ä¸‹ç”±Dan Abramov(Reduxçš„ä½œè€…)å†™ä½œçš„<a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.e5z2vws8e" target="_blank" rel="external">é«˜ä¿¡æ¯é‡çš„æ–‡ç« </a>,å¼ºè°ƒäº†å±•ç¤ºç»„ä»¶å’Œå®¹å™¨çš„å·®å¼‚æ€§.</p>
<p>å¦‚æœæˆ‘æƒ³æ€»ç»“å¾—å¿«ä¸€ç‚¹,æˆ‘å°†å¼•ç”¨<a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux æ–‡æ¡£</a>çš„å†…å®¹ï¼š</p>
<p>â€œå±•ç¤ºç»„ä»¶æ˜¯å…³äºäº‹ä»¶çš„æ ·å­(æ¨¡æ¿å’Œæ ·å¼),å®¹å™¨ç»„ä»¶æ˜¯å…³äºäº‹æƒ…æ˜¯æ€ä¹ˆå·¥ä½œçš„(æ•°æ®è·å–,stateæ›´æ–°)â€.</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ›å»ºstore,ä¼ é€’ç»™<code>TodoAppContainer</code>.ç„¶è€Œä¸ºäº†å­ç»„ä»¶å¯ä»¥ä½¿ç”¨store,æˆ‘ä»¬æŠŠstateæ˜ å°„æˆä¸ºReactç»„ä»¶<code>TodoApp</code>çš„<code>props</code>.<br><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: state.get(<span class="string">'todos'</span>),</div><div class="line">    <span class="attr">filter</span>: state.get(<span class="string">'filter'</span>)</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> TodoAppContainer = connect(mapStateToProps)(TodoApp);</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ åœ¨æµè§ˆå™¨ä¸­é‡æ–°åŠ è½½app,ä½ åº”è¯¥å¯ä»¥çœ‹åˆ°å®ƒåˆå§‹åŒ–å’Œä¹‹å‰ä¸€æ ·,ä¸è¿‡ç°åœ¨ä½¿ç”¨Redux tools.</p>
<h2 id="Redux-dev-å·¥å…·"><a href="#Redux-dev-å·¥å…·" class="headerlink" title="Redux dev å·¥å…·"></a>Redux dev å·¥å…·</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/9e82a2bf7ffaea5d0fda6af361a126517aecc115" target="_blank" rel="external">è¿™ä¸€éƒ¨åˆ†çš„æäº¤ä»£ç </a></p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®äº†redux storeå’Œreducer.æˆ‘ä»¬å¯ä»¥é…ç½®Redux dev toolsæ¥å±•ç°æ•°æ®æµå¼€å‘.</p>
<p>é¦–å…ˆ,è·å–<a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd" target="_blank" rel="external">Redux dev tools Chrome extension</a></p>
<p>dev toolså¯ä»¥åœ¨Storeåˆ›å»ºçš„æ—¶å€™å¯ä»¥åŠ è½½.</p>
<p><code>src/index.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> &#123;compose, createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> createStoreDevTools = compose(</div><div class="line">  <span class="built_in">window</span>.devToolsExtension ? <span class="built_in">window</span>.devToolsExtension() : <span class="function"><span class="params">f</span> =&gt;</span> f</div><div class="line">)(createStore);</div><div class="line"><span class="keyword">const</span> store = createStoreDevTools(reducer);</div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure></p>
<p><img src="https://ww2.sinaimg.cn/large/006tNc79ly1fdubya02s9j31cy0v6dgk.jpg" alt="Redux dev tools"></p>
<p>é‡æ–°åŠ è½½app,ç‚¹å‡»Reduxå›¾æ ‡,æœ‰äº†.</p>
<p>æœ‰ä¸‰ä¸ªä¸åŒçš„ç›‘è§†å™¨å¯ä»¥ä½¿ç”¨:Diffç›‘è§†å™¨,æ—¥å¿—ç›‘è§†å™¨,Sliderç›‘è§†å™¨.</p>
<h2 id="ä½¿ç”¨Action-Creatorsé…ç½®æˆ‘ä»¬çš„actions"><a href="#ä½¿ç”¨Action-Creatorsé…ç½®æˆ‘ä»¬çš„actions" class="headerlink" title="ä½¿ç”¨Action Creatorsé…ç½®æˆ‘ä»¬çš„actions"></a>ä½¿ç”¨Action Creatorsé…ç½®æˆ‘ä»¬çš„actions</h2><p>åˆ‡æ¢itemçš„ä¸åŒçŠ¶æ€.</p>
<p><a href="https://github.com/phacks/redux-todomvc/commit/7a2dc0963684b569c11f92e41a324324dfb21bdc" target="_blank" rel="external">è¿™éƒ¨åˆ†çš„æäº¤ä»£ç åœ¨è¿™é‡Œ</a></p>
<p>ä¸‹ä¸€æ­¥æ˜¯å…è®¸ç”¨æˆ·åœ¨<code>active</code>å’Œ<code>completed</code>ä¹‹å‰åˆ‡æ¢çŠ¶æ€ï¼š<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123;List, <span class="built_in">Map</span>, fromJS&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"><span class="keyword">import</span> &#123;expect&#125; <span class="keyword">from</span> <span class="string">'chai'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'../src/reducer'</span>;</div><div class="line"></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles TOGGLE_COMPLETE by changing the status from active to completed'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles TOGGLE_COMPLETE by changing the status from completed to active'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">3</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†é€šè¿‡è¿™äº›æµ‹è¯•,æˆ‘ä»¬æ›´æ–°reducer:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="comment">// We find the index associated with the itemId</span></div><div class="line">  <span class="keyword">const</span> itemIndex = state.get(<span class="string">'todos'</span>).findIndex(</div><div class="line">    <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">  );</div><div class="line">  <span class="comment">// We update the todo at this index</span></div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .update(<span class="string">'status'</span>, status =&gt; status === <span class="string">'active'</span> ? <span class="string">'completed'</span> : <span class="string">'active'</span>);</div><div class="line"></div><div class="line">  <span class="comment">// We update the state to account for the modified todo</span></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_COMPLETE'</span>:</div><div class="line">      <span class="keyword">return</span> toggleComplete(state, action.itemId);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å’Œ<code>SET_STATE</code>çš„actionåŒä¸€ä¸ªåœ°æ–¹,æˆ‘ä»¬éœ€è¦è®©<code>TodoAppContainer</code>ç»„ä»¶æ„ŸçŸ¥åˆ°action,æ‰€ä»¥<code>toggleComplete</code>å›è°ƒå‡½æ•°ä¼šè¢«ä¼ é€’åˆ°<code>TodoItem</code>ç»„ä»¶(å®é™…è°ƒç”¨å‡½æ•°çš„åœ°æ–¹).</p>
<p>åœ¨Reduxä¸­,æœ‰æ ‡å‡†çš„æ–¹æ³•æ¥åšè¿™ä»¶äº‹ï¼šAction Creators.</p>
<p>action creatorsæ˜¯ç®€å•çš„å‡½æ•°,è¿”å›åˆé€‚çš„actionï¼Œè¿™äº›éŸ©å¼æ˜¯Reactçš„<code>props</code>çš„ä¸€äº›æ˜ å°„ä¹‹ä¸€.<br>è®©æˆ‘ä»¬åˆ›å»ºç¬¬ä¸€ä¸ªaction creator:<br><code>src/action_creators.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨,å°½ç®¡<code>TodoAppcontainer</code>ç»„ä»¶ä¸­çš„<code>connect</code>å‡½æ•°çš„è°ƒç”¨å¯ä»¥ç”¨æ¥è·å–store,æˆ‘ä»¬å‘Šè¯‰ç»„ä»¶ä½¿ç”¨æ˜ å°„<code>props</code>çš„å›è°ƒå‡½æ•°:<br><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'../action_creators'</span>;</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      // ...</div><div class="line">        // We use the spread operator for better lisibility</div><div class="line">        <span class="tag">&lt;<span class="name">TodoList</span>  &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></div><div class="line">      // ...</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">export const TodoAppContainer = connect(mapStateToProps, actionCreators)(TodoApp);</div></pre></td></tr></table></figure></p>
<p>é‡å¯ä½ çš„webserver,åˆ·æ–°ä¸€ä¸‹ä½ çš„æµè§ˆå™¨:å½“å½“.åœ¨æ¡ç›®ä¸Šç‚¹å‡»ç°åœ¨å¯ä»¥åˆ‡æ¢å®ƒçš„çŠ¶æ€.å¦‚æœä½ æŸ¥çœ‹Redux dev tools,ä½ å¯ä»¥çœ‹åˆ°è§¦å‘çš„actionå’Œåç»§çš„æ›´æ–°.</p>
<h2 id="æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨"><a href="#æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨" class="headerlink" title="æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨"></a>æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/3949d4f38912e4b6b8e60fc4c553614d4076028c" target="_blank" rel="external">ç›¸å…³ä»£ç åœ¨åœ¨è¿™é‡Œ</a></p>
<p>ç°åœ¨æ¯ä»¶äº‹æƒ…éƒ½å·²ç»é…ç½®å®Œæ¯•,å†™å…¶ä»–çš„actionæ˜¯ä»¶å°äº‹.æˆ‘ä»¬ç»§ç»­åˆ›å»ºä½ å¸Œæœ›çš„<code>CHANGE_FILTER</code>action,æ”¹å˜å½“å‰stateçš„filter,ç”±æ­¤ä»…ä»…æ˜¾ç¤ºè¿‡æ»¤è¿‡çš„æ¡ç›®.<br>å¼€å§‹åˆ›å»ºaction creatorï¼š<br><code>src/action_creators.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">changeFilter</span>(<span class="params">filter</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CHANGE_FILTER'</span>,</div><div class="line">    filter</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨å†™reducerçš„å•å…ƒæµ‹è¯•:<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles CHANGE_FILTER by changing the filter'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ],</div><div class="line">      <span class="attr">filter</span>: <span class="string">'all'</span></div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CHANGE_FILTER'</span>,</div><div class="line">      <span class="attr">filter</span>: <span class="string">'active'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ],</div><div class="line">      <span class="attr">filter</span>: <span class="string">'active'</span></div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>å…³è”çš„reducerå‡½æ•°:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeFilter</span>(<span class="params">state, filter</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.set(<span class="string">'filter'</span>, filter);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_COMPLETE'</span>:</div><div class="line">      <span class="keyword">return</span> toggleComplete(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'CHANGE_FILTER'</span>:</div><div class="line">      <span class="keyword">return</span> changeFilter(state, action.filter);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æœ€åæˆ‘ä»¬æŠŠ<code>changeFilter</code>å›è°ƒå‡½æ•°ä¼ é€’ç»™<code>TodoTools</code>ç»„ä»¶:<br><code>TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">className</span>=<span class="string">"todoapp"</span>&gt;</span></div><div class="line">        // ...</div><div class="line">        <span class="tag">&lt;<span class="name">TodoTools</span> <span class="attr">changeFilter</span>=<span class="string">&#123;this.props.changeFilter&#125;</span></span></div><div class="line">                   <span class="attr">filter</span>=<span class="string">&#123;this.props.filter&#125;</span></div><div class="line">                   <span class="attr">nbActiveItems</span>=<span class="string">&#123;this.getNbActiveItems()&#125;</span> /&gt;</div><div class="line">      <span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>å®Œæˆäº†,ç¬¬ä¸€ä¸ªfilter selectorå·¥ä½œå®Œç¾</p>
<h2 id="Itemç¼–è¾‘"><a href="#Itemç¼–è¾‘" class="headerlink" title="Itemç¼–è¾‘"></a>Itemç¼–è¾‘</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/2a7b1138f778524d4aa7eac193c995258d28c5a3" target="_blank" rel="external">ä»£ç åœ¨è¿™é‡Œ</a><br> å½“ç”¨æˆ·ç¼–è¾‘ä¸€ä¸ªæ¡ç›®,å®é™…ä¸Šæ˜¯ä¸¤ä¸ªactionsè§¦å‘çš„ä¸‰ä¸ªå¯èƒ½æ€§:</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥ç¼–è¾‘æ¨¡å¼:<code>EDIT_ITEM</code></li>
<li>ç”¨æˆ·é€€å‡ºç¼–è¾‘æ¨¡å¼(ä¸ä¿å­˜å˜åŒ–):<code>CANCEL_EDITING</code></li>
<li>ç”¨æˆ·éªŒè¯ä»–çš„ç¼–è¾‘(ä¿å­˜å˜åŒ–):<code>DONE_EDITING</code></li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä¸ºä¸‰ä¸ªactionsç¼–å†™action creatorsï¼š<br><code>src/action_creators.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">editItem</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'EDIT_ITEM'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">cancelEditing</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CANCEL_EDITING'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">doneEditing</span>(<span class="params">itemId, newText</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'DONE_EDITING'</span>,</div><div class="line">    itemId,</div><div class="line">    newText</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä¸ºè¿™äº›actionsç¼–å†™å•å…ƒæµ‹è¯•:<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles EDIT_ITEM by setting editing to true'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'EDIT_ITEM'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles CANCEL_EDITING by setting editing to false'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CANCEL_EDITING'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles DONE_EDITING by setting by updating the text'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'DONE_EDITING'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">newText</span>: <span class="string">'Redux'</span>,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å‘reducerå‡½æ•°,å®é™…æ“ä½œä¸‰ä¸ªactions:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">findItemIndex</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.get(<span class="string">'todos'</span>).findIndex(</div><div class="line">    <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// We can refactor the toggleComplete function to use findItemIndex</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .update(<span class="string">'status'</span>, status =&gt; status === <span class="string">'active'</span> ? <span class="string">'completed'</span> : <span class="string">'active'</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">editItem</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cancelEditing</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doneEditing</span>(<span class="params">state, itemId, newText</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">false</span>)</div><div class="line">    .set(<span class="string">'text'</span>, newText);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'EDIT_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> editItem(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'CANCEL_EDITING'</span>:</div><div class="line">      <span class="keyword">return</span> cancelEditing(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'DONE_EDITING'</span>:</div><div class="line">      <span class="keyword">return</span> doneEditing(state, action.itemId, action.newText);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ¸…é™¤å®Œæˆ-æ·»åŠ å’Œåˆ é™¤æ¡ç›®"><a href="#æ¸…é™¤å®Œæˆ-æ·»åŠ å’Œåˆ é™¤æ¡ç›®" class="headerlink" title="æ¸…é™¤å®Œæˆ,æ·»åŠ å’Œåˆ é™¤æ¡ç›®"></a>æ¸…é™¤å®Œæˆ,æ·»åŠ å’Œåˆ é™¤æ¡ç›®</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/c89059a6767903fdf8b9827209f92e1f7385bdb7" target="_blank" rel="external">ä»£ç åœ¨è¿™é‡Œ</a></p>
<p>ä¸‰ä¸ªå‰©ä¸‹çš„actionæ˜¯:</p>
<ol>
<li><code>CLEAR_COMPLETED</code>,åœ¨<code>TodoTools</code>ç»„ä»¶ä¸­è§¦å‘,ä»åˆ—è¡¨ä¸­æ¸…é™¤å®Œæˆçš„æ¡ç›®</li>
<li><code>ADD_ITEM</code>,åœ¨<code>TodoHeader</code>ä¸­è§¦å‘,æ ¹æ®ç”¨æˆ·çš„çš„è¾“å…¥æ–‡æœ¬æ¥æ·»åŠ æ¡ç›®</li>
<li><code>DELETE_ITEM</code>,ç›¸ä¼¼<code>TodoItem</code>ä¸­è°ƒç”¨,åˆ é™¤ä¸€ä¸ªæ¡ç›®</li>
</ol>
<p>æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„å·¥ä½œæµæ˜¯:æ·»åŠ action creators,å•å…ƒæµ‹è¯•reducerå’Œä»£ç é€»è¾‘,æœ€ç»ˆé€šè¿‡propsä¼ é€’å›è°ƒå‡½æ•°:<br><code>src/action_creators.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">clearCompleted</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CLEAR_COMPLETED'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addItem</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'ADD_ITEM'</span>,</div><div class="line">    text</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteItem</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'DELETE_ITEM'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles CLEAR_COMPLETED by removing all the completed items'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CLEAR_COMPLETED'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles ADD_ITEM by adding the item'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'ADD_ITEM'</span>,</div><div class="line">      <span class="attr">text</span>: <span class="string">'Redux'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles DELETE_ITEM by removing the item'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'DELETE_ITEM'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">2</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCompleted</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>,</div><div class="line">    (todos) =&gt; todos.filterNot(</div><div class="line">      <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'status'</span>) === <span class="string">'completed'</span></div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addItem</span>(<span class="params">state, text</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemId = state.get(<span class="string">'todos'</span>).reduce(<span class="function">(<span class="params">maxId, item</span>) =&gt;</span> <span class="built_in">Math</span>.max(maxId,item.get(<span class="string">'id'</span>)), <span class="number">0</span>) + <span class="number">1</span>;</div><div class="line">  <span class="keyword">const</span> newItem = <span class="built_in">Map</span>(&#123;<span class="attr">id</span>: itemId, <span class="attr">text</span>: text, <span class="attr">status</span>: <span class="string">'active'</span>&#125;);</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, (todos) =&gt; todos.push(newItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteItem</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>,</div><div class="line">    (todos) =&gt; todos.filterNot(</div><div class="line">      <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'CLEAR_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> clearCompleted(state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> addItem(state, action.text);</div><div class="line">    <span class="keyword">case</span> <span class="string">'DELETE_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> deleteItem(state, action.itemId);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;</div><div class="line">      &lt;section className="todoapp"&gt;</div><div class="line">        // We pass down the addItem callback</div><div class="line">        &lt;TodoHeader addItem=&#123;this.props.addItem&#125;/&gt;</div><div class="line">        &lt;TodoList &#123;...this.props&#125; /&gt;</div><div class="line">        // We pass down the clearCompleted callback</div><div class="line">        &lt;TodoTools changeFilter=&#123;this.props.changeFilter&#125;</div><div class="line">                    filter=&#123;this.props.filter&#125;</div><div class="line">                    nbActiveItems=&#123;this.getNbActiveItems()&#125;</div><div class="line">                    clearCompleted=&#123;this.props.clearCompleted&#125;/&gt;</div><div class="line">      &lt;/section&gt;</div><div class="line">      &lt;Footer /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çš„TodoMVC appç°åœ¨å®Œæˆäº†.</p>
<h2 id="åŒ…è£…èµ·æ¥"><a href="#åŒ…è£…èµ·æ¥" class="headerlink" title="åŒ…è£…èµ·æ¥"></a>åŒ…è£…èµ·æ¥</h2><p>è¿™æˆ‘ä»¬çš„æµ‹è¯•é©±åŠ¨çš„React,Redux&amp;Immutable æŠ€æœ¯æ ˆ</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå†…å®¹,æœ‰æ›´å¤šçš„äº‹æƒ…ç­‰ç€ä½ å»æŒ–æ˜<br>ä¾‹å¦‚:</p>
<ul>
<li><a href="https://github.com/reactjs/react-router-redux" target="_blank" rel="external">React Redux router</a>åˆ›å»ºå®Œå…¨çš„å•é¡µé¢åº”ç”¨</li>
<li>æ˜¯ç”±Reduxåœ¨åå°åŒæ„Redux,çœ‹è¿™<a href="http://teropa.info/blog/2015/09/10/full-stack-redux-tutorial.html" target="_blank" rel="external">1æ•™ç¨‹</a>,<a href="https://blog.diacode.com/trello-clone-with-phoenix-and-react-pt-1" target="_blank" rel="external">2æ•™ç¨‹</a></li>
<li><a href="https://github.com/Ghirro/gambit" target="_blank" rel="external">Gambie</a>,ç®€å•çš„åŒ…è£…å™¨ç®€åŒ–åˆ°APIçš„è¿æ¥</li>
<li><a href="https://egghead.io/series/getting-started-with-redux" target="_blank" rel="external">ç³»åˆ—è§†é¢‘</a>,ä½œè€…æ˜¯Dan Abramov(Reduxçš„åˆ›å»ºè€…)</li>
<li>Redux <a href="http://redux.js.org/docs/introduction/Ecosystem.html" target="_blank" rel="external">ç½‘ç«™ä¸Šæ›´å¤šçš„å†…å®¹</a>!</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-ä½¿ç”¨Reselectæ”¹è¿›Reactå’ŒReduxç¨‹åºæ€§èƒ½]]></title>
      <url>http://yoursite.com/2017/03/08/%E7%BF%BB%E8%AF%91-%E4%BD%BF%E7%94%A8Reselect%E6%94%B9%E8%BF%9BReact%E5%92%8CRedux%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD/</url>
      <content type="html"><![CDATA[<blockquote>
<p><em>Written by Neil Fenton16 June 2016</em><br>  <a href="http://blog.rangle.io/react-and-redux-performance-with-reselect/" target="_blank" rel="external">åŸæ–‡è¯·è§</a></p>
</blockquote>
<p> <img src="https://ww2.sinaimg.cn/large/006tKfTcly1fdnldaaddyg31040g4747.gif" alt="å›¾1"></p>
<p>Reactå’ŒReduxç»„åˆæ˜¯éå¸¸æ£’çš„,å½“ä»–ä»¬ä¸¤ä¸ªä¸€èµ·ä½¿ç”¨æ—¶,å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç¨‹åºç»“æ„ä¸­åˆ†ç¦»å…³æ³¨ç‚¹.å³ä½¿Reactæ˜“ç”¨æ€§éå¸¸å¼º,ä½†æ˜¯æ€»ä¼šé‡åˆ°é«˜æ€§èƒ½éœ€æ±‚çš„æ—¶é—´.</p>
<p>åœ¨Reactä¸­æœ€æ˜‚è´µçš„æ“ä½œå°±æ˜¯æ¸²æŸ“å›è·¯.å½“ç»„ä»¶æ£€æµ‹åˆ°è¾“å…¥çš„å˜åŒ–,æ¸²æŸ“å›è·¯å°±ä¼šè¢«è§¦å‘(è¯‘æ³¨ï¼šè¿™é‡Œçš„æ„æ€çš„ç»„ä»¶çš„actionä¼šæ”¹å˜reduxçš„state,å˜å›æœ€ç»ˆåˆå›åˆ°ç»„ä»¶äº†).</p>
<p>å½“æˆ‘ä»¬åˆæ¬¡å¼€å§‹Reactç¨‹åºçš„æ—¶å€™,æˆ‘ä»¬ä¸ä¼šæ‹…å¿ƒæ¸²æŸ“å›è·¯çš„èŠ±é”€é—®é¢˜.ä½†æ˜¯å½“æˆ‘ä»¬çš„UIå˜å¾—å¤æ‚çš„æ—¶å€™,æˆ‘ä»¬éœ€è¦è€ƒè™‘è¿™ä¸€ç‚¹.Reactæä¾›äº†ä¸€äº›å·¥å…·è®©æˆ‘ä»¬èƒ½åŠ«æŒæ¸²æŸ“å›è·¯,å¦‚æœæ¸²æŸ“çœ‹ä¸Šå»ä¸å¿…è¦,æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å·¥å…·æ¥é˜»æ­¢é‡æ¸²æŸ“çš„å‘ç”Ÿ.ä¸ºäº†è¿™ä¹ˆåš,æˆ‘ä»¬è¦æ•²å…¥<code>componentShouldUpdate</code>ç”Ÿå‘½å‘¨æœŸäº‹ä»¶,è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼,é€šçŸ¥ç»„ä»¶æ˜¯å¦åº”è¯¥è¿›è¡Œæ›´æ–°.è¿™æ˜¯ä»¥<code>PureRenderMixin</code>ä½œä¸ºåŸºç¡€,å®ƒæ¯”è¾ƒè¾“å…¥çš„propså’Œstateå’Œå…ˆå‰çš„propså’Œstate,å¦‚æœä¸¤è€…ç›¸ç­‰å°±è¿”å›false.</p>
<p> è¿™ä¸ªç”Ÿå‘½å‘¨æœŸäº‹ä»¶å’ŒImmutableé›†åˆä¸€èµ·å¯ä»¥å®å®åœ¨åœ¨çš„æ”¹è¿›æ€§èƒ½,å› ä¸ºæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å†³å®šæ˜¯æ¸²æŸ“è¿˜æ˜¯ä¸æ¸²æŸ“ç»„ä»¶.<br> ä¸å¹¸çš„æ˜¯,ä»…æ­¤è€Œå·².</p>
<p> è€ƒè™‘åˆ°ç´§æ¥ç€çš„é—®é¢˜:æˆ‘ä»¬æ„å»ºä¸€ä¸ªè´­ç‰©è½¦,æœ‰ä¸‰ä¸ªè¾“å…¥ç±»å‹ï¼š</p>
<ul>
<li>è´­ç‰©è½¦é‡Œçš„è´§ç‰©</li>
<li>è´§ç‰©çš„æ•°é‡</li>
<li>ç›¸åº”çš„ç¨ç‡(åŸºäºå·æˆ–è€…çœ)</li>
</ul>
<p>é—®é¢˜æ˜¯æ— è®ºåªè¦è¾“å…¥çš„çŠ¶æ€ä¸€æ”¹å˜(æ–°è´§ç‰©åŠ å…¥,æ•°é‡çš„å˜åŒ–,é€‰æ‹©å·çš„å˜å“ˆ),æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½è¦è¢«é‡æ–°è®¡ç®—å’Œæ¸²æŸ“.å¦‚æœæˆ‘ä»¬çš„è´­ç‰©è½¦é‡Œæœ‰å‡ ç™¾ä¸ªä¸œè¥¿,ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹è¿™å°†ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜.æ”¹å˜ç¨ç‡è‚¯èƒ½ä¼šè§¦å‘è´­ç‰©è½¦çš„é‡æ–°è®¡ç®—,ä½†æ˜¯æ˜¯ä¸åº”è¯¥å‘ç”Ÿçš„.ç¨ç‡çš„å˜åŒ–ä»…ä»…ä¼šå½±å“è¡ç”Ÿçš„æ•°æ®.ä»…ä»…æ€»æ•°,ç¨çš„æ€»æ•°åº”è¯¥å‘ç”Ÿå˜åŒ–,å¹¶ä¸”å‘ç”Ÿåç»§çš„æ›´æ–°.æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æ€ä¹ˆä¿®å¤è¿™ä¸ªé—®é¢˜.(è¯‘æ³¨ï¼šè¿™æ®µçš„æ„æ€æ˜¯å¦‚æœç¨ç‡å˜åŒ–,åœ¨UIç»„ä»¶ä¸­æ˜¯ä¸åº”è¯¥å‘ç”Ÿæ¸²æŸ“çš„,åªæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦å‘ç”Ÿå˜åŒ–)</p>
<h2 id="Reselectå‰æ¥æ•‘æ´"><a href="#Reselectå‰æ¥æ•‘æ´" class="headerlink" title="Reselectå‰æ¥æ•‘æ´"></a>Reselectå‰æ¥æ•‘æ´</h2><p>Reselectç”¨æ¥è®°å¿†selectorsçš„åº“.æˆ‘ä»¬å®šä¹‰çš„selectorsæ˜¯ä½œä¸ºå‡½æ•°è·å–Redux stateçš„æŸä¸€éƒ¨åˆ†.ä½¿ç”¨è®°å¿†èƒ½åŠ›,æˆ‘ä»¬å¯ä»¥ç»„ç»‡ä¸å¿…è¦çš„è¡ç”Ÿæ•°æ®çš„é‡æ¸²æŸ“å’Œè®¡ç®—è¿‡ç¨‹,ç”±æ­¤åŠ é€Ÿäº†æˆ‘ä»¬çš„app.</p>
<p>è€ƒè™‘ä¸‹é¢è¿™ä¸ªç¤ºä¾‹:<br><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fdnmmp9vlrj30nr0we75c.jpg" alt=""></p>
<p>å¦‚æœæˆ‘ä»¬æœ‰å‡ ç™¾ç”šè‡³ä¸Šåƒä¸ªæ¡ç›®,æ¸²æŸ“è´­ç‰©è½¦ä¸­çš„æ‰€æœ‰é¡¹ç›®èŠ±è´¹ä¼šéå¸¸çš„å¤§,å³ä½¿æ˜¯ç¨ç‡çš„å˜åŒ–.ç”¨æˆ·æ¯ä¸€æ¬¡æœç´¢çš„ä»–çš„è´­ç‰©è½¦çš„æ—¶å€™,æˆ‘ä»¬æ˜¯å¦åº”è¯¥ä¸€éä¸€éçš„é‡è®¡ç®—ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®°å¿†æ€§çš„selectorsæ¥é˜»æ­¢æ˜‚è´µçš„è®¡ç®—è¿‡ç¨‹.ä½¿ç”¨è®°å¿†selectors,å¦‚æœReduxä¸­çš„stateçš„æ ‘å¾ˆå¤§,æˆ‘ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒæ²¡åƒstateå˜åŒ–çš„è®¡ç®—é—®é¢˜.æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å‰ç«¯å¢åŠ é¢å¤–çš„çµæ´»æ€§,æŠŠè¿™äº›selectorsåˆ†æ•£åˆ°å•ä¸ªçš„ç»„ä»¶ä¸­.</p>
<p>ç°åœ¨çœ‹çœ‹ä¸€ä¸ªä½¿ç”¨Reselectçš„ç®€å•selector:<br><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fdnrzja9zgj30nk080q31.jpg" alt="selector using Reselect"></p>
<p> åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­,æˆ‘ä»¬æŠŠitemçš„è·å–å‡½æ•°åˆ†æˆä¸¤ä¸ªå‡½æ•°,ç¬¬ä¸€ä¸ªå‡½æ•°(ç¬¬3è¡Œ)ç®€å•çš„é¢è·å–è´­ç‰©è½¦ä¸­æ‰€æœ‰çš„items,ç¬¬äºŒä¸ªå‡½æ•°ä»£è¡¨ä¸€ä¸ªè®°å¿†æ€§selector.Reselectæš´éœ²äº†<code>createSelector</code>API,æˆ‘ä»¬å¯ä»¥å€Ÿæ­¤åˆ›å»ºä¸€ä¸ªè®°å¿†æ€§çš„selector.è¿™ä¸ªæ„æ€æ˜¯<code>getItemWithTotals</code>åœ¨ç¬¬ä¸€æ¬¡å‡½æ•°è¿è¡Œçš„æ—¶å€™å°†ä¼šè¿›è¡Œè¿ç®—.å¦‚æœåŒä¸€ä¸ªå‡½æ•°å†æ¬¡è¢«è°ƒç”¨,ä½†æ˜¯è¾“å…¥å€¼(<code>getItems</code>çš„å€¼)æ²¡æœ‰å˜åŒ–,å‡½æ•°å°†ä¼šè¿”å›ä¸€ä¸ªç¼“å­˜(cached)çš„è®¡ç®—ç»“æœ.å¦‚æœitemsè¢«ä¿®æ”¹äº†(ä¾‹å¦‚ï¼šitemæ·»åŠ ,æ•°é‡çš„å˜åŒ–,ä»»ä½•äº‹æƒ…æ“ä½œäº†<code>getItems</code>çš„ç»“æœ),å‡½æ•°å°†ä¼šå†æ¬¡æ‰§è¡Œ.</p>
<p> è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„æ¦‚å¿µ,å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªç»„ä»¶çš„stateéœ€è¦é‡è®¡ç®—çš„æ—¶å€™,å®Œå…¨çš„ä¼˜åŒ–åº”è¯¥è¢«æ¸²æŸ“çš„ç»„ä»¶.è¿™æ„å‘³ç€æˆ‘ä»¬ä¸åœ¨æ‹…å¿ƒ<code>getItems</code>å’Œåç»§çš„æ¯ä¸€æ¬¡ä¸­ä»·æ ¼çš„è®¡ç®—,ä½†æ“ä½œçš„æ—¶å€™,ä¸ä¼šå½±å“stateçš„æ‰§è¡Œ.</p>
<p> æˆ‘ä»¬ç»§ç»­è¿™ä¸ªæ–¹å¼æ¥åˆ›å»ºå››ä¸ªè¡ç”Ÿæ•°æ®çš„selectors.åŒ…æ‹¬å°è®¡,ç¨é¢æ€»è®¡å’Œæ€»ä»·æ ¼.<br> <img src="https://ww3.sinaimg.cn/large/006tKfTcly1fdnshe7qxtj30ng0es0t4.jpg" alt="å››ä¸ªselectors"></p>
<h2 id="ä½¿ç”¨selector"><a href="#ä½¿ç”¨selector" class="headerlink" title="ä½¿ç”¨selector"></a>ä½¿ç”¨selector</h2><p>  selectorsä»£ç å®Œæˆä»¥å,è®©æˆ‘ä»¬çœ‹çœ‹æ€ä¹ˆåœ¨ç»„ä»¶ä¸­ä½¿ç”¨<code>getItemWithTitals</code>selector:</p>
<p>  <img src="https://ww3.sinaimg.cn/large/006tKfTcly1fdnskl1pn9j30s8106gms.jpg" alt=""></p>
<p>   ç°åœ¨æˆ‘ä»¬æœ‰äº†æœ‰äº†ä¸€ä¸ªç»„ä»¶,ä»…ä»…æ„ŸçŸ¥è´­ç‰©è½¦ä¸­çš„items.è¿™æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹å¼å› ä¸ºå®ƒå’Œæ€»è®¡å’Œå°è®¡æ²¡æœ‰ä»»ä½•å…³è”.ä»–ä¸æ˜¯å¯ä»¥é‡ç”¨çš„ç»„ä»¶,ä½†æ˜¯æ˜¯æ€§èƒ½éå¸¸å¥½çš„ç»„ä»¶.å’Œè¿™ä¸ªç»„ä»¶æ— å…³çš„å˜åŒ–ä¸ä¼šå¼•èµ·é¢å¤–çš„é‡æ¸²æŸ“.</p>
<p>   è¿™ä¸ªæ–¹å¼åº”ç”¨åˆ°å…¶ä»–çš„è´­ç‰©è½¦ä¸Šæ„å‘³ç€æˆ‘ä»¬å°†ä¼šæœ‰ä¸€ä¸ªç»„ä»¶è´Ÿè´£æ˜¾ç¤ºå°è®¡,æ€»è®¡å’Œç¨é¢è®¡ç®—.</p>
<p>   æ—©ä¸€ç‚¹åœ¨åº”ç”¨ä¸­ä½¿ç”¨è¿™äº›ä¼˜åŒ–æªæ–½æ„å‘³ç€æœªæ¥éœ€è¦ä¿®æ­£æ€§èƒ½é—®é¢˜çš„æ—¶å€™åšçš„å·¥ä½œå°±æ¯”è¾ƒå°‘.æˆ‘å»ºè®®å°½å¯èƒ½æ—©çš„ä½¿ç”¨reselect.åœ¨ç»„ä»¶ä¹‹å¤–ä½¿ç”¨Selectorsæ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®¹æ˜“çš„æµ‹è¯•è¿™äº›æ•°æ®è¡ç”Ÿè®¡ç®—.åœ¨Reduxä¸­ä½¿ç”¨ç®€å•çš„æ¨¡æ‹Ÿæ•°æ®,åŸºäºæä¾›çš„æ•°æ®æµ‹è¯•æœŸå¾…çš„è¾“å‡ºç»“æœ.</p>
<p> è¿›ä¸€æ­¥äº†è§£è¿™äº›æ¦‚å¿µ,å‚è€ƒ<a href="https://github.com/neilff/react-redux-performance" target="_blank" rel="external">demo</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptç­–ç•¥æ¨¡å¼-å¹´åº•ç»©æ•ˆçš„è®¡ç®—]]></title>
      <url>http://yoursite.com/2017/03/08/javascript%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F-%E5%B9%B4%E5%BA%95%E7%BB%A9%E6%95%88%E7%9A%84%E8%AE%A1%E7%AE%97/</url>
      <content type="html"><![CDATA[<blockquote>
<p>ç­–ç•¥æ¨¡å¼ï¼šå®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠä»–ä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”å¯ä»¥ç›¸äº’æ›¿æ¢<br>å‚è§ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<p>è§£å†³é—®é¢˜ï¼šå…¬å¸çš„ç»©æ•ˆæ ¹æ®å‘˜å·¥çš„å·¥èµ„å’Œå¹´åº¦ç»©æ•ˆæ¥å†³å®šã€‚æ¯ä¸ªäººçš„å·¥èµ„å’Œç»©æ•ˆæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯è®¡ç®—æ–¹æ³•æ˜¯ç›¸åŒçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> jsç‰ˆçš„ç­–ç•¥æ¨¡å¼</div><div class="line"></div><div class="line"><span class="comment">//å®šä¹‰ä¸‰ä¸ªä¸åŒç»©æ•ˆçš„ç­–ç•¥ï¼Œæ¯ä¸ªç»©æ•ˆçš„ç­–ç•¥å®é™…çš„è®¡ç®—ç»“æœè¿˜æœ‰ä¼ å…¥çš„å‚æ•°æ¥è®¡ç®—</span></div><div class="line"><span class="keyword">var</span> strategies = &#123;</div><div class="line">		<span class="string">"S"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;  <span class="comment">//sæ˜¯ç»©æ•ˆï¼Œsalaryæ˜¯ä¼ å…¥çš„å·¥èµ„å‚æ•°ï¼Œä¸‹åŒ</span></div><div class="line">			<span class="keyword">return</span> salary * <span class="number">4</span>;</div><div class="line">		&#125;,</div><div class="line">		<span class="string">"A"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> salary * <span class="number">3</span>;</div><div class="line">		&#125;,</div><div class="line">		<span class="string">"B"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> salary * <span class="number">2</span>;</div><div class="line"></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">        <span class="comment">//ä½¿ç”¨ç­–ç•¥çš„è®¡ç®—å‡½æ•°ï¼Œä¼ å…¥ç»©æ•ˆå’Œå·¥èµ„å‚æ•°</span></div><div class="line">	<span class="keyword">var</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params"> level, salary </span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> strategies[ level ]( salary );  <span class="comment">//æ ¹æ®å‚æ•°é€‰ç”¨ä¸åŒçš„ç­–ç•¥</span></div><div class="line">	&#125;;</div><div class="line">       <span class="comment">//ä½¿ç”¨æ—¶ä¼ å…¥ç»©æ•ˆç­‰çº§å’Œå·¥èµ„é¢</span></div><div class="line">	<span class="built_in">console</span>.log( calculateBonus( <span class="string">'S'</span>, <span class="number">20000</span> ) ); <span class="comment">// è¾“å‡ºï¼š80000</span></div><div class="line">	<span class="built_in">console</span>.log( calculateBonus( <span class="string">'A'</span>, <span class="number">10000</span> ) ); <span class="comment">// è¾“å‡ºï¼š30000</span></div></pre></td></tr></table></figure>
<p>é€šè¿‡ç­–ç•¥æ¨¡å¼ï¼Œç­–ç•¥å’Œå®é™…çš„è®¡ç®—æ–¹æ³•åˆ†å·¥æ˜ç¡®ï¼Œå…³ç³»è§£è€¦å’Œï¼Œå„è‡ªå‘ç”Ÿæ”¹å˜éƒ½ä¸æ”¹å˜å¦ä¸€éƒ¨åˆ†çš„ä»£ç ç»“æ„å’Œå†…å®¹ã€‚åœ¨å…·ä½“ç­–ç•¥ä¸­ä¹Ÿä¸ä¼šå‡ºç°ç´§è€¦åˆçš„åˆ¤è¯»é€‰æ‹©è¯­å¥ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascript-è£…é¥°è€…æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/08/javascript-%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>è£…é¥°è€…æ¨¡å¼ï¼šç»™å¯¹è±¡åŠ¨æ€æ·»åŠ èŒè´£çš„æ–¹å¼å°±æ˜¯è£…é¥°è€…æ¨¡å¼ï¼Œèƒ½å¤Ÿåœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ç»™å¯¹è±¡æ·»åŠ æ–°çš„èŒè´£ã€‚<br>å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<p>###è£…é¥°å‡½æ•°<br>å¦‚æœåœ¨ç»™ä¸€ä¸ªå‡½æ•°æˆ–å¯¹è±¡æ·»åŠ åŠŸèƒ½çš„æ—¶å€™ä¸æƒ³åŠ¨åŸå‡½æ•°ï¼Œæˆ–è€…åŸå‡½æ•°æ˜¯åˆ«çš„ç¨‹åºå‘˜å†™çš„ï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡å¼•ç”¨æ¥å¢åŠ å‡½æ•°åŠŸèƒ½</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">var</span> a=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//æ„é€ å‡½æ•°</span></div><div class="line">    alert(<span class="number">1</span>);</div><div class="line"> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> _a=a; <span class="comment">//_aä½œä¸ºä¸­é—´å˜é‡</span></div><div class="line"></div><div class="line">a=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//é‡æ–°èµ‹å€¼aå˜é‡</span></div><div class="line">   _a();  <span class="comment">//æ‰§è¡Œaå‡½æ•°</span></div><div class="line">   alert(<span class="number">2</span>); <span class="comment">//æ·»åŠ çš„åŠŸèƒ½</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢é‡ç‚¹æ˜¯ä»‹ç»ä¸€ä¸ªAOPçš„ä¾‹å­ï¼ŒAOPæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œåœ¨ä¸‹é¢çš„å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ç»™æŠŠå‡½æ•°çœ‹åšæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œåˆ†ä¸º è¿è¡Œå‰ï¼ˆbeforeï¼‰ï¼Œè¿è¡Œä¸­ï¼Œè¿è¡Œåï¼ˆafterï¼‰ã€‚åœ¨è¿è¡Œå‰ï¼Œè¿è¡Œåå¯ä»¥ç»™å‡½æ•°å¯¹è±¡æ·»åŠ ä¸åŒçš„èŒè´£ï¼Œè¿™äº›æ·»åŠ çš„èŒè´£ä¸ä¼šå½±å“åŸå‡½æ•°å¯¹è±¡çš„è¿è¡Œã€‚</p>
<p>åœ¨javascriptä¸­å‡ ä¹ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œå‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡ï¼Œå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’ï¼Œæ‰€ä»¥åœ¨jsä¸­ä½¿ç”¨è£…é¥°è€…æ¨¡å¼çš„æ—¶å€™åå¾ˆå¤§çš„ä¾¿åˆ©æ€§ã€‚</p>
<p>#####AOPçš„æ ‡å‡†æ¨¡å‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//argumentå¯¹è±¡æ˜¯å‡½æ•°è°ƒç”¨æ—¶ï¼Œéšå¼ä¼ é€’çš„å‡½æ•°å‚æ•°</span></div><div class="line"><span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span>(<span class="params"> beforefn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>; <span class="comment">// ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„"ä»£ç†"å‡½æ•°</span></div><div class="line">			beforefn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> ); <span class="comment">// æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯this</span></div><div class="line"><span class="comment">// ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•°ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ</span></div><div class="line">			<span class="keyword">return</span> __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> ); <span class="comment">// æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”</span></div><div class="line"><span class="comment">//å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ å¹¶ä¸”ä¿è¯this ä¸è¢«åŠ«æŒ		</span></div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> __self = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">		afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">		<span class="keyword">return</span> ret;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å®ä¾‹ï¼šç‚¹å‡»æŒ‰é’®æ—¶å¼¹æ¡†ä¹‹åç»Ÿè®¡å¼¹æ¡†çš„å‚æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//logå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’  </span></div><div class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params"> afterfn </span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> __self = <span class="keyword">this</span>; <span class="comment">//ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ï¼Œ_åœ¨jsä¸­æ˜¯å¯ä»¥ä½¿ç”¨çš„å¯ä»¥ä½œä¸ºä¸€ä¸ªç§æœ‰æ–¹æ³•å’Œå˜é‡çš„èµ·å§‹æ ‡å¿—</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è¿”å›å‡½æ•°å¤åˆä½“</span></div><div class="line">			<span class="keyword">var</span> ret = __self.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );<span class="comment">//åŸå‡½æ•°è°ƒç”¨</span></div><div class="line">			afterfn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );<span class="comment">//afterå‡½æ•°è°ƒç”¨</span></div><div class="line">			<span class="keyword">return</span> ret; <span class="comment">//è¿”å›åŸå‡½æ•°</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> showLogin = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'æ‰“å¼€ç™»å½•æµ®å±‚'</span> );</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'ä¸ŠæŠ¥æ ‡ç­¾ä¸º: '</span> + <span class="keyword">this</span>.getAttribute( <span class="string">'tag'</span> ) );</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	showLogin = showLogin.after( log ); <span class="comment">// æ‰“å¼€ç™»å½•æµ®å±‚ä¹‹åä¸ŠæŠ¥æ•°æ®</span></div><div class="line">	<span class="built_in">document</span>.getElementById( <span class="string">'button'</span> ).onclick = showLogin;</div></pre></td></tr></table></figure></p>
<p>åœ¨javascriptä¸­ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸çŸ›ç›¾çš„ã€‚ä¸¤è€…ç»“åˆèµ·æ¥å¨åŠ›æ›´å¤§ã€‚éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œä½ ä¼šè§‰å¾—æ»¡æ»¡çš„éƒ½æ˜¯å¥—è·¯å’Œæ¨¡å¼ã€‚åˆ°äº†è¿™ä¸€æ­¥å­¦ä¹ æœ‰ç‚¹æ¬²ç½¢ä¸èƒ½äº†ã€‚å­¦ä¹ javascriptçœŸæ˜¯æœ‰æ„æ€ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptçŠ¶æ€æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/08/Javascript%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>çŠ¶æ€æ¨¡å¼æ˜¯è§£å†³æŸäº›éœ€æ±‚åœºæ™¯çš„æœ€å¥½æ–¹æ³•ã€‚çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œäº‹ç‰©å†…éƒ¨çš„çŠ¶æ€çš„æ”¹å˜å¾€å¾€ä¼šå¸¦æ¥äº‹ç‰©çš„è¡Œä¸ºçš„æ”¹å˜<br>å‚è€ƒã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹ç¬¬16ç« </p>
</blockquote>
<p>æˆ‘åœ¨å‰é¢å†™äº†ä¸€ä¸ªç®€å•çš„æ•™ç¨‹ï¼Œä¸ºäº†è¯´æ˜react/reduxä¸­çš„çŠ¶æ€ç®¡ç†ï¼Œã€Šjavascriptæ¨¡å¼è®¾è®¡ä¸å¼€å‘å®è·µã€‹é‡Œé¢æœ‰è¿™æ ·çš„æ¨¡å¼ã€‚åœ¨ä¸‹ä¸€æ­¥çš„é‡æ„ä¸­ï¼Œå¦‚æœä»ç®€å•ç”µç¯çš„å¼€å…³æ”¹ä¸ºå¤šçº§è°ƒå…‰çš„ç”µç¯å¯ä»¥å€Ÿé‰´è¿™æ ·çš„æ¨¡å¼ã€‚åœ¨ç®€å•çš„å¤šä¸ªçŠ¶æ€ä¹‹é—´åˆ‡æ¢çš„æ—¶å€™ï¼Œè¿™æ ·çš„æ¨¡å¼æ˜¯éå¸¸æ¸…æ™°çš„ã€‚</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">//ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢ï¼Œä½¿ç”¨if-elseæ¥åˆ‡æ¢ï¼Œåœ¨æœ‰å¤šä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œè¿™æ ·çš„åˆ‡æ¢å°±ä¼šåµŒå¥—å¾ˆå¤šçš„æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œå¦‚æœåŠ å…¥æ–°çš„çŠ¶æ€ï¼Œä¿®æ”¹ä»£ç ä¹Ÿæ¯”è¾ƒå›°éš¾</div><div class="line">Light.prototype.buttonWasPressed = function()&#123;</div><div class="line">		if ( this.<span class="keyword">state</span> === 'off' )&#123;</div><div class="line">			console.<span class="keyword">log</span>( 'å¼€ç¯' );</div><div class="line">			this.<span class="keyword">state</span> = '<span class="keyword">on</span>';</div><div class="line">		&#125;else if ( this.<span class="keyword">state</span> === '<span class="keyword">on</span>' )&#123;</div><div class="line">			console.<span class="keyword">log</span>( 'å…³ç¯' );</div><div class="line">			this.<span class="keyword">state</span> = 'off';</div><div class="line">		&#125;</div><div class="line">	&#125;;</div></pre></td></tr></table></figure>
<blockquote>
<p>çŠ¶æ€æ¨¡å¼çš„å…³é”®å°±æ˜¯ï¼šæŠŠäº‹ç‰©çš„æ¯ç§çŠ¶æ€éƒ½å°è£…æˆå•ç‹¬çš„ç±»ï¼Œè·Ÿæ­¤çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½è¢«å°è£…åœ¨è¿™ä¸ªç±»çš„å†…éƒ¨ã€‚åªè¦æœ‰äº¤äº’è¡Œä¸ºï¼Œåªéœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€å¯¹è±¡å³å¯ï¼Œè¯¥çŠ¶æ€å¯¹è±¡ä¼šè´Ÿè´£æ¸²æŸ“å®ƒè‡ªèº«çš„è¡Œä¸ºã€‚</p>
<ol>
<li>å°è£…çŠ¶æ€</li>
</ol>
</blockquote>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> OffLightState = <span class="function"><span class="keyword">function</span>(<span class="params"> light </span>)</span>&#123;</div><div class="line">		    <span class="keyword">this</span>.light = light;</div><div class="line">		    &#125;;</div><div class="line">	     </div><div class="line">	OffLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼±å…‰'</span> ); <span class="comment">// offLightState å¯¹åº”çš„è¡Œä¸º</span></div><div class="line">		  <span class="keyword">this</span>.light.setState( <span class="keyword">this</span>.light.weakLightState ); <span class="comment">// åˆ‡æ¢çŠ¶æ€åˆ°weakLightState</span></div><div class="line">     &#125;;</div><div class="line">    <span class="comment">// WeakLightStateï¼š</span></div><div class="line">    <span class="keyword">var</span> WeakLightState = <span class="function"><span class="keyword">function</span>(<span class="params"> light </span>)</span>&#123;</div><div class="line">	  <span class="keyword">this</span>.light = light;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    WeakLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å¼ºå…‰'</span> ); <span class="comment">// weakLightState å¯¹åº”çš„è¡Œä¸º</span></div><div class="line">		<span class="keyword">this</span>.light.setState( <span class="keyword">this</span>.light.strongLightState ); <span class="comment">// åˆ‡æ¢çŠ¶æ€åˆ°strongLightState</span></div><div class="line">	   &#125;;</div><div class="line">	<span class="comment">// StrongLightStateï¼š</span></div><div class="line">	  <span class="keyword">var</span> StrongLightState = <span class="function"><span class="keyword">function</span>(<span class="params"> light </span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.light = light;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	 StrongLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log( <span class="string">'å…³ç¯'</span> ); <span class="comment">// strongLightState å¯¹åº”çš„è¡Œä¸º</span></div><div class="line">		<span class="keyword">this</span>.light.setState( <span class="keyword">this</span>.light.offLightState ); <span class="comment">// åˆ‡æ¢çŠ¶æ€åˆ°offLightState</span></div><div class="line">	&#125;;</div></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨Lightç±»ä¸­ä¸ºæ¯ä¸ªçŠ¶æ€ç±»éƒ½åˆ›å»ºä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°ç”µç¯ä¸€å…±æœ‰å¤šå°‘ä¸ªçŠ¶æ€</p>
</blockquote>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">var</span> Light = <span class="function"><span class="keyword">function</span></span>()&#123;</div><div class="line">	<span class="built_in">this</span>.offLightState = <span class="keyword">new</span> <span class="type">OffLightState</span>( <span class="built_in">this</span> );</div><div class="line">	<span class="built_in">this</span>.weakLightState = <span class="keyword">new</span> <span class="type">WeakLightState</span>( <span class="built_in">this</span> );</div><div class="line">	<span class="built_in">this</span>.strongLightState = <span class="keyword">new</span> <span class="type">StrongLightState</span>( <span class="built_in">this</span> );</div><div class="line">	<span class="built_in">this</span>.button = <span class="literal">null</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨buttonæŒ‰é’®è¢«æŒ‰ä¸‹çš„æ—¶å€™ï¼Œé€šè¿‡self.currState.buttonWasPressed()å°†è¯·æ±‚å§”æ‰˜ä¸ºå½“å‰çš„çŠ¶æ€å»æ‰§è¡Œã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> button = <span class="built_in">document</span>.createElement( <span class="string">'button'</span> ),</div><div class="line">	self = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">this</span>.button = <span class="built_in">document</span>.body.appendChild( button );</div><div class="line">	<span class="keyword">this</span>.button.innerHTML = <span class="string">'å¼€å…³'</span>;</div><div class="line">	<span class="keyword">this</span>.currState = <span class="keyword">this</span>.offLightState; <span class="comment">// è®¾ç½®å½“å‰çŠ¶æ€</span></div><div class="line">	<span class="keyword">this</span>.button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		self.currState.buttonWasPressed();</div><div class="line">	&#125;	</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ€åæä¾›ä¸€ä¸ªsetStateçš„æ–¹æ³•ï¼ŒçŠ¶æ€å¯¹è±¡é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥åˆ‡æ¢lightå¯¹è±¡çš„çŠ¶æ€ã€‚çŠ¶æ€å¯¹è±¡çš„åˆ‡æ¢è§„å¾‹è¢«å®šä¹‰åœ¨å„ä¸ªçŠ¶æ€ç±»ä¸­ã€‚<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Light.prototype.setState = <span class="function"><span class="keyword">function</span></span>( <span class="keyword">new</span><span class="type">State</span> )&#123;</div><div class="line">		<span class="built_in">this</span>.currState = <span class="keyword">new</span><span class="type">State</span>; <span class="comment">//è®¾ç½®ä¸‹ä¸€ä¸ªçŠ¶æ€</span></div><div class="line">	&#125;;</div></pre></td></tr></table></figure></p>
<p>#####Javascriptç‰ˆæœ¬çš„çŠ¶æ€æœº</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Light = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">this</span>.currState = FSM.off; <span class="comment">// è®¾ç½®å½“å‰çŠ¶æ€</span></div><div class="line">		<span class="keyword">this</span>.button = <span class="literal">null</span>;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> button = <span class="built_in">document</span>.createElement( <span class="string">'button'</span> ),</div><div class="line">		self = <span class="keyword">this</span>;</div><div class="line">		button.innerHTML = <span class="string">'å·²å…³ç¯'</span>;</div><div class="line">		<span class="keyword">this</span>.button = <span class="built_in">document</span>.body.appendChild( button );</div><div class="line">		<span class="keyword">this</span>.button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="comment">//åˆå§‹åŒ–ä¸‹å°±æ˜¯è°ƒç”¨FSM.offçš„æ–¹æ³•è®¾ç½®å†…éƒ¨çŠ¶æ€self.currState.buttonWasPressed.call( self ); // æŠŠè¯·æ±‚å§”æ‰˜ç»™FSM çŠ¶æ€æœº</span></div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> FSM = &#123;</div><div class="line">		<span class="attr">off</span>: &#123;</div><div class="line">			<span class="attr">buttonWasPressed</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log( <span class="string">'å…³ç¯'</span> );</div><div class="line">				<span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼€ç¯'</span>;</div><div class="line">				<span class="keyword">this</span>.currState = FSM.on;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		<span class="attr">on</span>: &#123;</div><div class="line">			<span class="attr">buttonWasPressed</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log( <span class="string">'å¼€ç¯'</span> );</div><div class="line">				<span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'</span>;</div><div class="line">				<span class="keyword">this</span>.currState = FSM.off;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">var</span> light = <span class="keyword">new</span> Light();</div><div class="line">	light.init();</div></pre></td></tr></table></figure>
<p>å…·ä½“çš„å®ä¾‹è¯¦ç»†çœ‹çœ‹ä¹¦ä¸­çš„ä¾‹å­</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-Redux-Saga-å®Œæˆæ—¶é’Ÿæ¼”ç¤ºApp]]></title>
      <url>http://yoursite.com/2017/03/08/-%E7%BF%BB%E8%AF%91-Redux-Saga-%E5%AE%8C%E6%88%90%E6%97%B6%E9%92%9F%E6%BC%94%E7%A4%BAApp/</url>
      <content type="html"><![CDATA[<blockquote>
<p>ç¿»è¯‘ç‰ˆæœ¬ï¼Œ<a href="http://ohyayanotherblog.ghost.io/redux-saga-finishing-the-clock-demo-app/" target="_blank" rel="external">åŸæ–‡è¯·è§</a><br><em>14 NOVEMBER 2016</em></p>
</blockquote>
<h2 id="å®ç°Sagaä»£ç "><a href="#å®ç°Sagaä»£ç " class="headerlink" title="å®ç°Sagaä»£ç "></a>å®ç°Sagaä»£ç </h2><p>è¿™ç¯‡æ–‡ç« æ˜¯ä¸‰ç¯‡å…³äºRedux Sagaç³»åˆ—æ–‡ç« çš„ç¬¬ä¸‰ç¯‡,ä¹Ÿæ˜¯æœ€åä¸€ç¯‡.åœ¨ç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬å…ˆå¯¹æœ‰å…³çš„æ¦‚å¿µè¿›è¡Œäº†çƒ­èº«.åœ¨ç¬¬äºŒéƒ¨åˆ†,æˆ‘ä»¬å’ŒReduxå…³ç³»æ¨è¿›åˆ°äº†å¦ä¸€ä¸ªé«˜åº¦.æˆ‘ä»¬æŠŠSagaä»˜è¯¸å®æ–½.åœ¨æœ€åä¸€ç¯‡æ–‡ç« ,æˆ‘ä»¬æŠŠæœ€åä¸€éƒ¨åˆ†å†…å®¹å†™å®Œ.å¦‚æœä½ æ²¡æœ‰å…‹éš†app repoï¼Œå¯ä»¥åœ¨è¿™ä¸ª<a href="https://github.com/granmoe/redux-saga-clock-tutorial" target="_blank" rel="external">åœ°å€å…‹éš†</a>,å¦‚æœä¸æƒ³çœ‹è¿™ä¸ªrepo,æƒ³ç›´æ¥è·³åˆ°æœ€ç»ˆçš„appä»£ç ,å¯ä»¥<a href="https://github.com/granmoe/redux-saga-clock.git" target="_blank" rel="external">çœ‹è¿™ä¸ªrepo</a>.   <a href="https://granmoe.github.io/redux-saga-clock/" target="_blank" rel="external">live demoçœ‹è¿™é‡Œ</a>.</p>
<hr>
<p><a href="http://www.jianshu.com/p/6f8678a6ad78" target="_blank" rel="external">ç¬¬ä¸€éƒ¨åˆ†è¯‘æ–‡è¯·è§</a>ï¼Œ<br><a href="http://www.jianshu.com/p/fad0136e77c0" target="_blank" rel="external">ç¬¬äºŒéƒ¨åˆ†è¯‘æ–‡è¯·è§</a>ï¼Œ<br><a href="http://www.jianshu.com/p/88fc4236b505" target="_blank" rel="external">ç¬¬ä¸‰éƒ¨åˆ†è¯‘æ–‡è¯·è§</a>.</p>
<hr>
<h2 id="Whatâ€™s-my-name-agian"><a href="#Whatâ€™s-my-name-agian" class="headerlink" title="Whatâ€™s my name agian?"></a>Whatâ€™s my name agian?</h2><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­,æˆ‘ä»¬è®¾è®¡äº†åŸºç¡€ä½†æ˜¯æœ‰ç‚¹å¹¼ç¨šçš„éœ€æ±‚,åˆ›å»ºäº†å¾ˆåˆçº§æ—¶é’Ÿ,å¯ä»¥å¯¹ç”¨æˆ·çš„äº¤äº’æ“ä½œåšå‡ºä¸€äº›å“åº”.(è¯‘è€…ï¼šåé¢æœ‰å‡ å¥ä¼¼ä¹å’ŒæŠ€æœ¯æ²¡æœ‰å¤ªå¤§å…³ç³»,æˆ‘å°±æ²¡æœ‰ç¿»è¯‘äº†.è¯·å‚è§åŸæ–‡).</p>
<p>æˆ‘ä»¬å†³å®šåªä½¿ç”¨æœ€å°åŒ–çš„redux stateå€¼æœ‰ä¸€ä¸ªå­—æ®µâ€œmillisecondsâ€æ¥ä»£è¡¨æ—¶é’Ÿçš„æ—¶é—´.å› ä¸ºæˆ‘ä»¬çš„æ—¶é’Ÿéœ€è¦å‘å‰,å‘å,é‡ç½®,æ‰€ä»¥åˆ›å»ºäº†ç›¸åº”çš„redux actionå»æ‰§è¡Œå¢,å‡,é‡ç½®actions,è¿™äº›actionså¯ä»¥æ”¹å˜state.<br>å½“æˆ‘ä»¬è¿›å…¥æŸäº›saga codeä»£ç ,åˆ›å»ºä¸€ä¸ªsagaç›‘å¬ä¸‰ä¸ªactions(å¼€å§‹,æš‚åœ,å›æ‹¨),åªæœ‰æ”¶åˆ°ç›¸åº”actionçš„æ—¶å€™,è¾“å‡ºæ—¥å¿—å†…å®¹.æœ€å,æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŠŠæ—¥å¿—è¾“å‡ºæ›¿æ¢æˆæ—¶é’Ÿå®é™…è¿è¡Œçš„æµç¨‹,ä¾‹å¦‚æ¯ä¸€ç§’ç§å‘é€ä¸€ä¸ªé€’å‡çš„action,å› æ­¤app stateçš„å¼‚æ­¥æ“ä½œéœ€è¦å¥½å¥½çš„è®¾è®¡.æœ€åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„Reactç»„ä»¶,å¯ä»¥è®©æˆ‘ä»¬æ ¹æ®æœŸæœ›çš„sagaä»£ç çš„å·¥ä½œæµç¨‹æµ‹è¯•reduxå’Œsaga action,è§‚å¯Ÿstateçš„æ›´æ–°.</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥å®Œæˆè¿™ä»¶äº‹,æˆ‘ä»¬æƒ³ç»™æœ‹å‹ç•™ä¸‹æ·±åˆ»çš„å°è±¡,çœ‹ä¸Šå»æœ‰æ„æ€ä¸€ç‚¹,æ‰€ä»¥ä¼šä½¿ç”¨ä¸€äº›éå¸¸é…·çš„SVGæŠ€æœ¯,å½“æ—¶é—´å¢åŠ çš„æ—¶å€™,æ—¶é’Ÿå¯ä»¥ç”»å‡ºä¸€äº›å›¾å½¢.ä½†æ˜¯æœ€é‡è¦çš„æ˜¯ä½¿ç”¨Sagaå¯ä»¥æ˜¯appå”±æ­Œ,è·³èˆ.å¼€å§‹ç¼–ç .</p>
<p>##å®ç°Saga<br>æˆ‘ä»¬çš„duck.jsæ˜¯éå¸¸å°çš„,å®é™…ä¸Šä»…ä»…éœ€è¦å¾ˆå°‘å‡ è¡Œä»£ç å»å®Œæˆsaga/redux.ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„duckä»£ç æ˜¯è¿™æ ·çš„:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">export</span> <span class="function"><span class="keyword">function</span>* <span class="title">rootSaga</span> (<span class="params"></span>) </span>&#123;  </div><div class="line">  <span class="keyword">yield</span> takeLatest([<span class="string">'start-clock'</span>, <span class="string">'pause-clock'</span>, <span class="string">'rewind-clock'</span>], handleClockAction)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Pushed this action to handleClockAction: '</span>, type)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>æ­£å¦‚æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« æ‰€è®¨è®ºçš„,<code>takeLatest</code>å°†ä¼šç›‘å¬action typeæ•°ç»„ä¸­çš„ä»»ä½•ä¸€ä¸ªaction type,å½“æ¯æ¬¡å‘é€çš„actionå’Œaction typeä¹‹ä¸€åŒ¹é…çš„æ—¶å€™,ä¼šè¿è¡Œå¦ä¸€ä¸ªæµç¨‹(åœ¨æˆ‘ä»¬çš„appä¸­,æ˜¯<code>handleClockAction</code>).<code>takeLatest</code>ä¹Ÿä¼šå–æ¶ˆä¹‹å‰çš„è¿è¡Œæµç¨‹,ä»–ä¹Ÿä¼šä¼ é€’æ•´ä¸ªactionå¯¹è±¡,æˆ‘ä»¬å¯ä»¥åœ¨<code>handleClockAction</code>ä½¿ç”¨è¿™ä¸ªå¯¹è±¡.</p>
<p>ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ•´ä¸ªappåº”è¯¥æ€ä¹ˆå·¥ä½œ.æ‰€æœ‰çš„å®é™…æµç¨‹éƒ½æ˜¯åœ¨<code>handelClockAction</code>ä¸­,åœ¨ä¸‰ä¸ªsaga actionsä¸­,æ¯ä¸€ä¸ªactionæˆ‘ä»¬éƒ½åšä¸€äº›ä¸åŒçš„å·¥ä½œ.æ·±å…¥åˆ°ä»£ç çš„åŸºç¡€æ„æ¶ä¸­.ä½¿ç”¨<code>if/else if</code>ä»£ç å—æ›¿æ¢<code>handleClockAction</code>çš„å•è¡Œä»£ç .è¿™ä¸ªä»£ç å—ä¸ºæ¯ä¸ªaction typeæä¾›åˆ†æ”¯åˆ¤æ–­é€»è¾‘,å¹¶ä¸”è¾“å‡ºä¸€äº›æ–‡æœ¬æ—¥å¿—,éªŒè¯ä»£ç çš„æ­£ç¡®æ€§.</p>
<p>ç»™ä½ å‡ ç§’é’Ÿ,è€å¿ƒç­‰å¾…ä¸€ä¸‹.</p>
<p>å¥½äº†,ä¸‹é¢çš„æ˜¯æˆ‘çš„<code>handelClockAction</code>çš„å®é™…æ ·å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//if else ifä»£ç å—è¿›è¡Œåˆ†æ”¯åˆ¤æ–­æ‰§è¡Œæµç¨‹</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock forward here.`</span>)</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock backwards here.`</span>)</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'pause-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. Guess what needs to be done here?`</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨è¿è¡Œapp(npm start),è½¬åˆ°localhost:8080,æ‰“å¼€javascriptç»ˆç«¯,æµ‹è¯•ä¸€äº›saga actions(ä»–ä»¬å’ŒSVGå›¾ä¸‹é¢çš„æŒ‰é’®æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„).æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯æ¬¡actionæ‰§è¡Œæ—¶,æœ‰ç›¸åº”çš„æ—¥å¿—è¾“å‡º.</p>
<p>å½“æˆ‘ä»¬å¼€å§‹clock action,æˆ‘ä»¬æƒ³è®©æ—¶é’Ÿæ¯100æ¯«ç§’é€’å¢ä¸€æ¬¡.ä¸ºäº†è¿™æ ·åš,ä»sagaå¯¼å…¥åŠ©æ‰‹å‡½æ•°â€delayâ€.ç¼–è¾‘redux-sagaæ–‡ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; delay, takeLatest &#125; <span class="keyword">from</span> <span class="string">'redux-saga'</span></div></pre></td></tr></table></figure>
<hr>
<p>delayéå¸¸ç®€å•ï¼ŒåŠŸèƒ½ä¸è¨€è‡ªæ˜.å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°,æ¯«ç§’æ•°,ç„¶åæš‚åœæ‰§è¡Œå¯¹åº”çš„æ—¶é—´.ä¾‹å¦‚<code>yield delay(50)</code>.åœ¨<code>if/else if</code>ä»£ç å—ä¸­æ·»åŠ ä¸€äº›é€»è¾‘ä»£ç ,æ¯1000ms,è¾“å‡ºæ—¥å¿—.è¯·è®°ä½,ä½ éœ€è¦è¿™ä¸ªè¿‡ç¨‹æ— é™åˆ¶çš„é‡å¤.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨éå¸¸ç®€å•çš„åŸç”Ÿjavascriptä»£ç æ§åˆ¶æµæ¥å®ç°.æˆ‘æƒ³è®©ä½ å…ˆçŒœçŒœæ€ä¹ˆå®ç°.</p>
<p>ä¸è¦å·çœ‹.</p>
<p>èŠ±ç‚¹æ—¶é—´è€ƒè™‘ä¸€ä¸‹.</p>
<p>å¥½äº†,ä¸‹é¢æ˜¯æˆ‘çš„ä»£ç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;<span class="comment">//å°±æ˜¯è¿™ä¸ªwhile(true)è¯­å¥ä¿æŒå§‹ç»ˆè¿è¡Œ</span></div><div class="line">      <span class="keyword">yield</span> delay(<span class="number">1000</span>)</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock forward here.`</span>)</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock backwards here.`</span>)</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'pause-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. Guess what needs to be done here?`</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨è¿™ä¸€ç‚¹ä¸Š,æ‰“å¼€jsç»ˆç«¯,æŸ¥çœ‹æ—¥å¿—è¾“å‡º,å¯ä»¥å¾—åˆ°ç›´è§‚çš„ä¿¡æ¯.ä½ å°†çœ‹åˆ°,start clock actionæš‚åœ100æ¯«ç§’,ç„¶åè¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯,ä¹‹åæ— é™åœ°é‡å¤è¿™ä¸ªè¿‡ç¨‹.æ³¨æ„ä¸€ä¸ªå…³é”®äº‹å®,æ— è®ºä»€ä¹ˆæ—¶é—´æˆ‘ä»¬çš„<code>takeLatest</code>å‡½æ•°æ¥æ”¶åˆ°åŒ¹é…çš„actionçš„æ—¶å€™,å®ƒä¼šé€€å‡ºå½“å‰è¿è¡Œçš„<code>handleClockAction</code>.å¦‚æœæ˜¯æš‚åœçš„action,ä»€ä¹ˆäº‹æƒ…ä¹Ÿä¸åš,ä½†æ˜¯è¿˜æ˜¯è¦é€€å‡ºå½“å‰ä»»ä½•çš„action,çŒœçŒœæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿåˆ é™¤ä¸€ç‚¹ä»£ç ï¼æš‚åœçš„æ—¶é’Ÿå°†ä¼šè‡ªåŠ¨å¼€å§‹å·¥ä½œ,å› ä¸º<code>takeLatest</code>ä¼šé€€å‡ºå½“å‰çš„<code>handleClockAction</code>,ä¸ç®¡æ—¶é’Ÿæ˜¯å‘å‰è¿˜æ˜¯å‘åè¿è¡Œ,æ—¶é’Ÿéƒ½ä¼šåœæ­¢.<br>ç¡®ä¿¡ä½ ç†è§£<code>takeLatest</code>çš„å…³é”®ç‰¹æ€§.åœ¨<code>handleClockAction</code>ä¸­åšå‡ºåˆé€‚çš„æ”¹å˜.åº”è¯¥æƒ³ä¸‹é¢è¿™æ ·åš:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(<span class="number">1000</span>)</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock forward here.`</span>)</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock backwards here.`</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨è®©æˆ‘ä»¬åœ¨å¾ªç¯å†…çœŸæ­£çš„dispatchä¸€ä¸ªaction.<br>ï¼ˆæ—ç™½ï¼šæˆ‘ä»¬æ²¡æœ‰å®é™…dispatchä¸€ä¸ªactionï¼Œä»…ä»…è¯·æ±‚ä¸­é—´ä»¶æ¥åšè¿™ä»¶äº‹,æš‚æ—¶ä¸è¦æ‹…å¿ƒ,æˆ‘åé¢ä¼šè§£é‡Šæ¸…æ¥šçš„.)</p>
<p>åœ¨Sagaé‡Œé¢dispatchä¸€ä¸ªaction,æˆ‘ä»¬è¦ä½¿ç”¨<code>put</code> side effects,æ·»åŠ ä¸€è¡Œä»£ç åˆ°duckæ–‡ä»¶é‡Œ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; put &#125; <span class="keyword">from</span> <span class="string">'redux-saga/effects'</span></div></pre></td></tr></table></figure>
<hr>
<p>é€šè¿‡<code>put</code>è¯·æ±‚ä¸€ä¸ªdispatchçš„action,ç®€å•çš„ä½¿ç”¨<code>yield put({ type: &#39;hi&#39;, data: &#39;I am an action&#39; })</code>å°±å¯ä»¥äº†.æ„æ€æ˜¯åœ¨<code>put</code>é‡Œ,å¯ä»¥è°ƒç”¨ä¸€ä¸ªaction creator è¿”å›ä¸€ä¸ªå•çº¯å¯¹è±¡,åƒè¿™æ ·<code>yield put(someAction())</code>.(åœ¨javascriptä¸­å‡½æ•°çš„å‚æ•°ä¼šç«‹å³æ±‚å€¼).è¿˜è®°å¾—æˆ‘ä»¬åœ¨å¼€å§‹åˆ›å»ºçš„é‚£äº›redux actionå—ï¼Ÿæˆ‘ä»¬è¦ä½¿ç”¨ä¸€ä¸ª,è½¬åˆ°whileå¾ªç¯,è¯•è¯•<code>put</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(<span class="number">1000</span>)</div><div class="line">      <span class="keyword">yield</span> put(incrementMilliseconds())<span class="comment">//æ³¨æ„è¿™ä¸€å¥</span></div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Received <span class="subst">$&#123;type&#125;</span>. We need to run the clock backwards here.`</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨ä½ çš„æµè§ˆå™¨é‡Œè¯•è¯•.æ³¨æ„åœ¨SVGä¸‹é¢çš„æ—¶é’Ÿæ—¶é—´æ˜¯é€’å¢çš„.</p>
<p>ä¸ºäº†è®©æ—¶é’Ÿåé€€,å¯ä»¥é‡ç”¨start æ—¶é’Ÿçš„å¤§éƒ¨åˆ†ä»£ç .</p>
<p>ä¸‹é¢æ˜¯å›é€€çš„ä»£ç :<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(<span class="number">1000</span>)</div><div class="line">      <span class="keyword">yield</span> put(incrementMilliseconds())</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(<span class="number">1000</span>)</div><div class="line">      <span class="keyword">yield</span> put(decrementMilliseconds())<span class="comment">//é€’å‡</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>ç°åœ¨æµ‹è¯•ä¸€ä¸‹æ‰€æœ‰çš„saga actions,ç¡®ä¿æ¯ä»¶äº‹æƒ…éƒ½å·¥ä½œæ­£å¸¸.å¦‚æœå·¥ä½œä¸æ­£å¸¸,é‚£ç»å¯¹æ˜¯ä½ çš„é”™,ä¸æ˜¯æˆ‘çš„é”™.å¼€ä¸ªç©ç¬‘.(è¯‘è€…:åé¢å‡ å¥æ²¡æœ‰ç¿»è¯‘)</p>
<p>æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»æ˜¯è¿è¡Œsagaä»£ç å¹¶ä¸”é€šè¿‡å®éªŒå­¦åˆ°çš„äº†ä¸€äº›ä¸œè¥¿.ä¸€ä¸ªæç¤ºï¼š<code>delay</code>æ˜¯é˜»å¡çš„,å…¶ä»–çš„effectè¯­å¥éƒ½æ˜¯éé˜»å¡çš„.è¯•ç€ä½¿ç”¨<code>for</code>å¾ªç¯.è¦ä¹ˆæŠŠ<code>while</code>æ¡ä»¶æ”¹ä¸ºfalse.æˆ‘ä»¬å·²ç»æ”¾å¼ƒäº†promiseçš„ä¸–ç•Œ,ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ç®€å•çš„,å¯é¢„æµ‹çš„,åŸç”Ÿçš„javascriptæ¥è¡¨ç°å‡ºæ‰€æœ‰çš„æ§åˆ¶æµè¯­å¥.</p>
<p>å¥½äº†,æŠŠsagaä»£ç æ¢å¤åˆ°ä¸Šé¢çš„æ ·å­.</p>
<p>åšå¥½äº†ä¸Šé¢çš„æ¢å¤,æˆ‘çš„sagaä»£ç å·²ç»å®Œæˆ,å¯ä»¥æ“ä½œäº†(æ³¨æ„äº‹é¡¹ï¼šåœ¨æœ€ç»ˆç‰ˆæœ¬ä¸Š,æˆ‘å·²ç»æŠŠä»£ç é‡æ–°ç»„ç»‡äº†ä¸€ä¸‹,ä»¥ä¾¿äºé˜…è¯»).</p>
<h2 id="Sagaâ€™sçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œ"><a href="#Sagaâ€™sçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œ" class="headerlink" title="Sagaâ€™sçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œ"></a>Sagaâ€™sçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œ</h2><p>å¥½äº†.ç°åœ¨è®©æˆ‘ä»¬å†åšä¸€äº›äº‹æƒ…,è®©æˆ‘ä»¬è°ˆè°ˆä»£ç æ˜¯æ€ä¹ˆå·¥ä½œçš„.Redux Sagaä¸­æ ¸å¿ƒçš„æ¦‚å¿µæ˜¯:æˆ‘ä»¬å®é™…æ²¡æœ‰åƒdispatchä¸€ä¸ªactionåˆ°storeä¸€æ ·æ‰§è¡Œå¼‚æ­¥æ“ä½œ.æ›¿ä»£æ–¹æ³•æ˜¯:æˆ‘ä»¬yieldå¼‚æ­¥æ“ä½œåˆ°saga middleware,ç„¶åmiddlewareæ‰§è¡Œä»–ä»¬.ç®€å•çš„è¯´,æˆ‘ä»¬ç»™Sagaä¸€ä¸ªæŒ‡ç¤º,å‘Šè¯‰ä»–æˆ‘ä»¬å¸Œæœ›å‘ç”Ÿä»€ä¹ˆ.è¿™äº›å¼‚æ­¥æ“ä½œæè¿°æ˜¯éµå¾ªæ ‡å‡†generatorè¾“å‡ºçš„å•çº¯å¯¹è±¡:<code>{value:any,done:boolean}</code>,è¿™å’Œæˆ‘ä»¬åœ¨ç¬¬ä¸€éƒ¨åˆ†çœ‹åˆ°çš„å®Œå…¨ä¸€æ ·.<br>ä¾‹å¦‚,<code>yield put</code>å‘é€ä¸€ä¸ªå¯¹è±¡åˆ°ä¸­é—´ä»¶,è¿™ä¸ªä¸­é—´ä»¶åŒ…å«ä¸€ä¸ªactionå¯¹è±¡,å¯ä»¥dispatchä¸€äº›å†…å®¹ç»™æˆ‘ä»¬(è¯‘è€…:è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹ç»•,å…¶å®æ˜¯åœ¨å¼‚æ­¥æ“ä½œå®Œæˆä»¥å,éœ€è¦å†æ¬¡dispatchè¿”å›çš„ç»“æœ,ä»è€Œæ”¹å˜stateï¼Œè¿™æ ·æˆ‘ä»¬çš„ç»„ä»¶æ‰å¯ä»¥æ ¹æ®stateçš„æ”¹å˜æ¥æ¸²æŸ“æ•ˆæœ,ä¾‹å¦‚ä»è¿œç¨‹èµ„æºè¯·æ±‚æ•°æ®,é€šå¸¸éƒ½éœ€è¦æŠŠæ•´ä¸ªæ“ä½œåˆ†æˆå‡ æ­¥æ¥å®Œæˆ,æ¯ä¸€æ­¥è¦æ”¹å˜ä¸åŒçš„state,åœ¨dispatchä¸­å†dispatch)è¿™æ ·å®šä¹‰å¼‚æ­¥æ•°æ®æµæœ‰å¾ˆå¤šå¥½å¤„,å…¶ä¸­ä¹‹ä¸€æ˜¯å¯æµ‹è¯•æ€§.æˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„åœ¨æ¯ä¸€ä¸ªside effectè¿”å›ä¸­é—´ä»¶çš„æ—¶å€™åˆ›å»ºæ–­è¨€(ç»§ç»­å…³æ³¨åç»­çš„å†…å®¹,æœ‰æµ‹è¯•çš„æ·±å…¥ä»‹ç»)</p>
<p> æˆ‘ä»¬åº”è¯¥éµå¾ªredux-sagaçš„æœ€ä½³å®è·µ,åšäº›å°å°çš„æ›´æ–°,ä»redux-saga/effectsä¸­å¯¼å…¥<code>call</code>,æŠŠ<code>yield delay(100)</code>æ”¹ä¸º<code>yield call(delay,100)</code>.å› ä¸ºæˆ‘ä»¬åªæƒ³è¿”å›side-effectsåˆ°sagaä¸­é—´ä»¶,sagaæä¾›äº†<code>call</code>effectæŠŠnon-effectsè½¬å˜ä¸ºeffects.ä¸ä»…ä»…yield<code>delay</code>è‡ªå·±(promiseå¯¹è±¡)ä¸åŒ,æˆ‘ä»¬é€šè¿‡<code>call</code>æŠŠ<code>delay</code>è½¬å˜ä¸ºeffect,ç„¶åyieldå®ƒ.æ‰€æœ‰çš„non-effectéƒ½åº”è¯¥åšç›¸åŒçš„å¤„ç†.<code>call</code>çš„è¯­æ³•è°ƒç”¨ä¸€ä¸ªå‡½æ•°,å¹¶ä¸”ä¼ é€’å‚æ•°åˆ—è¡¨.ä¾‹å¦‚:<code>yield call(fetch,url,options)</code>.æœ€å,æ³¨æ„,<code>call</code>å¯ä»¥è¢«promiseå¯¹è±¡,generators,æˆ–è€…å‡½æ•°ä½¿ç”¨.</p>
<h2 id="ä»£ç ä¸è¦å¤ªä¸‘é™‹"><a href="#ä»£ç ä¸è¦å¤ªä¸‘é™‹" class="headerlink" title="ä»£ç ä¸è¦å¤ªä¸‘é™‹"></a>ä»£ç ä¸è¦å¤ªä¸‘é™‹</h2><p> æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ä½œä¸ºappçš„é…ç½®,åŒ…å«ä¸€äº›å¸¸é‡.ä¸ºä»€ä¹ˆä¸å«åšâ€œconfig.jsâ€åœ¨/srcç›®å½•ä¸‹åˆ›å»º,ç²˜è´´ä¸‹é¢çš„å†…å®¹.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">const</span> MAX_RADIUS = <span class="number">40</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> hands = [  </div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">144000</span>, <span class="attr">maxTicks</span>: <span class="number">1</span> &#125;,</div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">36000</span>, <span class="attr">maxTicks</span>: <span class="number">4</span> &#125;,</div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">12000</span>, <span class="attr">maxTicks</span>: <span class="number">3</span> &#125;,</div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">2000</span>, <span class="attr">maxTicks</span>: <span class="number">6</span> &#125;,</div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">400</span>, <span class="attr">maxTicks</span>: <span class="number">5</span> &#125;,</div><div class="line">  &#123; <span class="attr">ms</span>: <span class="number">100</span>, <span class="attr">maxTicks</span>: <span class="number">4</span> &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> STROKE_WIDTH = MAX_RADIUS / hands.length</div><div class="line"></div><div class="line">hands = hands.map(<span class="function">(<span class="params">hand, idx</span>) =&gt;</span> &#123;  </div><div class="line">  <span class="keyword">const</span> radius = STROKE_WIDTH * (hands.length - idx)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    ...hand,</div><div class="line">    radius,</div><div class="line">    <span class="attr">circumference</span>: <span class="number">2</span> * <span class="built_in">Math</span>.PI * radius,</div><div class="line">    <span class="attr">alpha</span>: <span class="number">1</span> - idx / hands.length</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> CLOCK_HANDS = hands</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> MINIMUM_MS = <span class="number">100</span></div></pre></td></tr></table></figure>
<hr>
<p> è¿™é‡Œé¢éƒ½æœ‰ä»€ä¹ˆå†…å®¹ï¼Ÿè®©æˆ‘è§£é‡Šä¸€ä¸‹,å®ƒæ˜¯ä¸€ç»„å¸¸é‡å’Œè®¡ç®—é‡,æè¿°SVGçš„å¤–è§‚.<br> æˆ‘ä¸ä¼šè¯¦ç»†è®²è¿™ä¸ªå†…å®¹,ä¸æ˜¯è¿™é‡Œçš„é‡ç‚¹.</p>
<p> å¥½äº†,ç°åœ¨æˆ‘ä»¬çš„sagaä»£ç å·²ç»å°±ç»ª,æˆ‘ä»¬ä¹Ÿå®šä¹‰äº†æ‰€æœ‰SVGéœ€è¦çš„é…ç½®æ–‡ä»¶.å†æ›´æ–°ä¸€ä¸‹SVGå†…å®¹,å¥½å®Œæˆapp.jsxçš„ä»£ç .</p>
<h2 id="å®Œæˆ-HIM"><a href="#å®Œæˆ-HIM" class="headerlink" title="å®Œæˆ HIM"></a>å®Œæˆ HIM</h2><p> ä¸‹é¢æ˜¯ç›®å‰çš„app.jsxä»£ç <br> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>  </div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; incrementMilliseconds, decrementMilliseconds, resetClock, startClock, pauseClock, rewindClock &#125; <span class="keyword">from</span> <span class="string">'duck'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;  </div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">const</span> &#123;</div><div class="line">      milliseconds,</div><div class="line">      incrementMilliseconds,</div><div class="line">      decrementMilliseconds,</div><div class="line">      resetClock,</div><div class="line">      startClock,</div><div class="line">      pauseClock,</div><div class="line">      rewindClock</div><div class="line">    &#125; = <span class="keyword">this</span>.props</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;svg onClick=&#123; incrementMilliseconds &#125; onDoubleClick=&#123; resetClock &#125; onMouseLeave=&#123; decrementMilliseconds &#125;</div><div class="line">          className="clock" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="500"&gt;</div><div class="line">          &lt;circle cx="50" cy="50" r=&#123; 30 &#125; stroke=&#123; 'rgba(1,1,1,1)' &#125; fill="orange" /&gt;</div><div class="line">        &lt;/svg&gt;</div><div class="line">        &lt;p&gt;&#123; milliseconds &#125;&lt;/p&gt;</div><div class="line">        &lt;p&gt;</div><div class="line">          &lt;button type="button" onClick=&#123; startClock &#125;&gt;Start Clock&lt;/button&gt;</div><div class="line">          &lt;button type="button" onClick=&#123; pauseClock &#125;&gt;Pause Clock&lt;/button&gt;</div><div class="line">          &lt;button type="button" onClick=&#123; rewindClock &#125;&gt;Rewind Clock&lt;/button&gt;</div><div class="line">        &lt;/p&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default connect(state =&gt; (&#123;  </div><div class="line">  milliseconds: state.milliseconds</div><div class="line">&#125;), (&#123;</div><div class="line">  incrementMilliseconds,</div><div class="line">  decrementMilliseconds,</div><div class="line">  resetClock,</div><div class="line">  startClock,</div><div class="line">  pauseClock,</div><div class="line">  rewindClock</div><div class="line">&#125;))(Clock)</div></pre></td></tr></table></figure></p>
<hr>
<p> æˆ‘ä»¬éœ€è¦å¯¼å…¥conifgå†…å®¹,é€šè¿‡propsä¼ é€’åˆ°ç»„ä»¶.åˆ é™¤ä¸€äº›ä¸å¿…è¦çš„å¯¼å…¥æ–‡ä»¶.ä¸å†ç›´æ¥è°ƒç”¨ç‰¹å®šçš„actions,å› ä¸ºæˆ‘ä»¬ä»…ä»…åœ¨sagaä¸­å‘å‡ºaction.æ›´æ–°ä¸€ä¸‹ä»£ç .<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>  </div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; startClock, rewindClock, pauseClock, resetClock &#125; <span class="keyword">from</span> <span class="string">'duck'</span>  </div><div class="line"><span class="keyword">import</span> &#123; CLOCK_HANDS, STROKE_WIDTH &#125; <span class="keyword">from</span> <span class="string">'config'</span></div></pre></td></tr></table></figure></p>
<hr>
<p> ç°åœ¨æˆ‘ä»¬æœ‰äº†æ•°æ®,å¯ä»¥åœ¨SVGå†…ç”»å‡ºæ¼‚äº®çš„åœ†ç¯.ç®€å•ç‚¹çš„è¯´æˆ‘ä»¬ä½¿ç”¨åŒå¿ƒåœ†ä»£è¡¨å°æ—¶/åˆ†é’Ÿ/ç§’.æ—¶é—´æµé€çš„æ—¶å€™,æ”¹å˜æ¯ä¸€ä¸ªåœ†ç¯çš„é•¿åº¦.ä¸ºäº†åšSVGå›¾ç‰‡,ä½¿ç”¨äº†ä¸€äº›å°æŠ€å·§<a href="https://css-tricks.com/svg-line-animation-works/" target="_blank" rel="external">CSS Trick blog post</a></p>
<p> æˆ‘ä»¬ä¸å†é€šè¿‡propsæ‰‹æ®µä¼ é€’millsecondså­—æ®µ.æ¯æ¬¡æ›´æ–°millisecondsæ—¶,æˆ‘ä»¬è®¡ç®—æ¯ä¸€ä¸ªæ—¶é’ŸæŒ‡é’ˆçš„ä½ç½®.è¿™åƒæ˜¯çƒ¦äººçš„æ•°å­¦è®¡ç®—.åŸºæœ¬ä¸Šæˆ‘ä»¬éå†æ¯ä¸€ä¸ªæŒ‡é’ˆ,ç„¶ååœ¨ä¸‹ä¸€ä¸ªæŒ‡é’ˆé‡å¤åŒæ ·çš„è¿‡ç¨‹,(æ—¶é’ˆå°±å‡æ‰å°æ—¶çš„æ•´å€å¥½ç§’æ•°,åˆ†é’Ÿå’Œç§’ä¸€æ ·å¤„ç†),æŠŠå‰©ä½™çš„æ—¶é—´ä¼ é€’ç»™ä¸‹å».æœ€å°çš„æŒ‡é’ˆå¯¹åº”çš„æœ€å°çš„ç²¾åº¦å•ä½,100ms(config.jsä¸­çš„MAXIMUM_MS),æ›´æ–°ä½ çš„<code>connect</code></p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">export</span> <span class="keyword">default</span> connect(<span class="function"><span class="params">state</span> =&gt;</span> &#123;  </div><div class="line">  <span class="keyword">const</span> currentTime = state.milliseconds</div><div class="line">  <span class="keyword">let</span> remainingTime = currentTime</div><div class="line"></div><div class="line">  <span class="keyword">const</span> getTicks = <span class="function">(<span class="params">hands, timeRemaining</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> [hand, ...tailHands] = hands</div><div class="line">    hand.ticks = <span class="built_in">Math</span>.floor(timeRemaining / hand.ms)</div><div class="line">    <span class="keyword">return</span> tailHands.length ? [hand, ...getTicks(tailHands, timeRemaining % hand.ms)] : [hand]</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> hands = getTicks(CLOCK_HANDS, remainingTime)</div><div class="line">    .map(<span class="function">(<span class="params">hand, idx</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> offset = state.milliseconds &gt;= hand.ms ? <span class="number">1</span> : <span class="number">0</span></div><div class="line">      <span class="keyword">const</span> position = hand.circumference - ((hand.ticks + offset) / hand.maxTicks * hand.circumference)</div><div class="line"></div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        ...hand,</div><div class="line">        position</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    hands</div><div class="line">  &#125;</div><div class="line">&#125;, (&#123;</div><div class="line">  startClock,</div><div class="line">  rewindClock,</div><div class="line">  resetClock,</div><div class="line">  pauseClock</div><div class="line">&#125;))(Clock)</div></pre></td></tr></table></figure>
<hr>
<p> ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶ä¸­å¯¼å…¥æ–°çš„<code>æŒ‡é’ˆ</code>å±æ€§.åœ¨æ¸²æŸ“æ–¹æ³•ä¸­ç»™propsè§£æ„èµ‹å€¼:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">render () &#123;  </div><div class="line"><span class="keyword">const</span> &#123;</div><div class="line">  hands,</div><div class="line">  startClock,</div><div class="line">  rewindClock,</div><div class="line">  resetClock,</div><div class="line">  pauseClock</div><div class="line">&#125; = <span class="keyword">this</span>.props</div></pre></td></tr></table></figure>
<hr>
<p> ä¸ºäº†æœ€ç»ˆç‰ˆæœ¬,æˆ‘ä»¬åšä¸€ä¸‹æœ€ç»ˆçš„æ”¹å˜.æˆ‘ä»¬æ›´æ–°SVG,å¯åŠ¨<code>onMouseEnter</code>,å›é€€<code>onMouseLeave</code>,æš‚åœ<code>onClick</code>.æ·»åŠ ä¸€ä¸‹è¿™äº›å˜åŒ–.</p>
<p> ï¼ˆè¯‘è€…ï¼šè¿™ä¸€æ®µä¹Ÿä¸ç¿»äº†,åŸä½œè€…è¦å–ä¼ç‰¹åŠ ).</p>
<p>  åšå¥½äº†å§,ç°åœ¨æˆ‘ä»¬åœ¨SVGå†…åˆ›å»ºåŒå¿ƒåœ†,éå†<code>hands</code>å¹¶ä¸”åˆ›å»º<code>&lt;circle&gt;</code>SVGå…ƒç´ ,ä½¿ç”¨æˆ‘ä»¬çš„è®¡ç®—å€¼è®¾ç½®æ¯ä¸ªæŒ‡é’ˆçš„åŠå¾„,ä½ç½®å’Œé€æ˜åº¦.</p>
<p>  è¿™æ˜¯æœ€ç»ˆçš„æ›´æ–°,ä¸‹é¢æ˜¯<code>render()</code>å‡½æ•°è¿”å›çš„å†…å®¹ï¼š<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">return</span> (  </div><div class="line">  &lt;svg onMouseEnter=&#123; startClock &#125; onMouseLeave=&#123; rewindClock &#125; onDoubleClick=&#123; resetClock &#125;</div><div class="line">    onClick=&#123; pauseClock &#125; className="clock" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="500"&gt;</div><div class="line">    &#123; hands.map((hand, index) =&gt; &#123;</div><div class="line">      const &#123; radius, circumference, position, alpha &#125; = hand</div><div class="line">      return (</div><div class="line">        &lt;circle key=&#123; index &#125; cx="50" cy="50" r=&#123; radius &#125; stroke=&#123; `rgba(1,1,1,$&#123;alpha&#125;)` &#125; fill="none"</div><div class="line">          strokeWidth=&#123; STROKE_WIDTH &#125; strokeDasharray=&#123; circumference &#125; strokeDashoffset=&#123; position &#125; /&gt;</div><div class="line">      )</div><div class="line">    &#125;) &#125;</div><div class="line">  &lt;/svg&gt;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p> å¿˜äº†ä»¶äº‹æƒ…,è¿”å›duck.jsæ–‡ä»¶,ä»configå¯¼å…¥MINIMUM_MS:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; MINIMUM_MS &#125; <span class="keyword">from</span> <span class="string">'config'</span></div></pre></td></tr></table></figure>
<hr>
<p> ç°åœ¨åœ¨delayå‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨<code>MINIMUM_MS</code>æ›¿æ¢<code>1000</code>.<br> æ—¶é’Ÿæ¯100mså°±ä¼šæ»´ç­”ä¸€ä¸‹:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'start-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(MINIMUM_MS)</div><div class="line">      <span class="keyword">yield</span> put(incrementMilliseconds())</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rewind-clock'</span>) &#123;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> delay(MINIMUM_MS)</div><div class="line">      <span class="keyword">yield</span> put(decrementMilliseconds())</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p> çœ‹çœ‹åœ¨sagaä¸­æ§åˆ¶æµç¨‹çš„é€»è¾‘æœ‰å¤šå®¹æ˜“ï¼Ÿ</p>
<h2 id="ç»™ä½ çš„æ—¶é’Ÿä¸Šå‘æ¡"><a href="#ç»™ä½ çš„æ—¶é’Ÿä¸Šå‘æ¡" class="headerlink" title="ç»™ä½ çš„æ—¶é’Ÿä¸Šå‘æ¡"></a>ç»™ä½ çš„æ—¶é’Ÿä¸Šå‘æ¡</h2><p> ç°åœ¨ç»™è¿™æ®µä»£ç æ‹§å‘æ¡,<code>npm start</code>,æµè§ˆå™¨ä¸­æ‰“å¼€localhost:8080.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-a754703b38f36735.gif?imageMogr2/auto-orient/strip" alt="redux-saga-clock.gif"></p>
<p> è¿™æ˜¯ä¸€ä¸ªèƒ½æš‚åœ,æ¢å¤,å‘å‰,å‘åå’Œé‡ç½®.çœ‹ä¸Šå»ä¹Ÿå¾ˆé…·.</p>
<h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p> æ„Ÿè°¢é˜…è¯»è¿™ä¸ªæ•™ç¨‹,æˆ‘ä»¬æ¶‰åŠåˆ°äº†js generatorå’ŒRedux sagaçš„æœ‰å…³å†…å®¹.æˆ‘å¸Œæœ›èƒ½å¸®åŠ©ä½ ç†è§£æ€ä¹ˆä½¿ç”¨Redux Saga,åŒæ—¶è¿˜æœ‰ä½¿ç”¨çš„å¥½å¤„å’ŒèƒŒåçš„åˆç†æ€§.</p>
<p> å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„Redux Sagaçš„å†…å®¹,è¿™é‡Œè¿˜æœ‰ä¸€äº›å¾ˆå¥½çš„æ•™ç¨‹.ä¸‹é¢æ˜¯æˆ‘å¼€å§‹å­¦ä¹ redux sagaçš„æ—¶å€™å¸®åŠ©æˆ‘å…¥é—¨çš„å†…å®¹.</p>
<ul>
<li><a href="http://yelouafi.github.io/redux-saga/docs/introduction/BeginnerTutorial.html" target="_blank" rel="external">Reduxçš„å®˜æ–¹æ–‡æ¡£</a>æ˜¯æ— ä»·ä¹‹å®</li>
<li><a href="http://wecodetheweb.com/2016/01/23/handling-async-in-redux-with-sagas/" target="_blank" rel="external">Niels Gerritsenâ€™sçš„Redux Sagaå…¥é—¨æ•™ç¨‹</a>.è¿™æ˜¯æˆ‘æœ€å¼€å§‹å­¦ä¹ Redux sagaçš„æ•™ç¨‹ä¹‹ä¸€,ç»“æ„å¾ˆæ¸…æ™°,å¸®åŠ©æˆ‘è·¨å›½ä¸€äº›æ¦‚å¿µéšœç¢.</li>
<li><a href="http://joelhooks.com/blog/2016/03/20/build-an-image-gallery-using-redux-saga" target="_blank" rel="external">Joel Hooksçš„æ•™ç¨‹</a></li>
<li><a href="http://jaysoo.ca/2016/01/03/managing-processes-in-redux-using-sagas/" target="_blank" rel="external">Jack Hsuçš„æ–‡ç« </a>.æˆ‘çš„å®ä¾‹å®é™…æ˜¯è¿™ä¸ªæ•™ç¨‹çš„æ‰©å±•.</li>
</ul>
<p>æˆ‘ä¹Ÿå–œæ¬¢ä¸‹é¢çš„æ–‡ç« ,è§£å¯†generators,æ¿€åŠ±æˆ‘å†™è¿™ç¯‡æ–‡ç« ,æ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ç« ,æˆ‘éƒ½ä¸çŸ¥é“generatorsè®²çš„æ˜¯ä»€ä¹ˆç©æ„.</p>
<ul>
<li><a href="https://davidwalsh.name/es6-generators" target="_blank" rel="external">David Walshçš„åšå®¢,å…³äºES6 generatorçš„å†…å®¹,ä½œè€…æ˜¯kyle Simpson</a></li>
<li><a href="http://www.2ality.com/2015/03/es6-generators.html2ality" target="_blank" rel="external">Axel Rauschmeyerçš„ES6 generatorsçš„æ–‡ç« </a></li>
</ul>
<p>æ„Ÿè°¢é˜…è¯»!</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘|Reselect-Reduxçš„ä¸­é—´ä»¶]]></title>
      <url>http://yoursite.com/2017/03/08/Redux-Reselect/</url>
      <content type="html"><![CDATA[<blockquote>
<p>â€œselectorâ€æ˜¯ä¸€ä¸ªç®€å•çš„Reduxåº“,çµæ„Ÿæ¥æºäº<code>NuclearJS</code>.</p>
<ul>
<li>Selectorå¯ä»¥è®¡ç®—è¡ç”Ÿçš„æ•°æ®,å¯ä»¥è®©Reduxåšåˆ°å­˜å‚¨å°½å¯èƒ½å°‘çš„stateã€‚</li>
<li>Selectoræ¯”è¾ƒé«˜æ•ˆ,åªæœ‰åœ¨æŸä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰å‘ç”Ÿè®¡ç®—è¿‡ç¨‹.</li>
<li>Selectoræ˜¯å¯ä»¥ç»„åˆçš„,ä»–ä»¬å¯ä»¥ä½œä¸ºè¾“å…¥,ä¼ é€’åˆ°å…¶ä»–çš„selector.</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿™ä¸ªä¾‹å­ä¸å¿…å¤ªåœ¨æ„,åé¢ä¼šæœ‰è¯¦ç»†çš„ä»‹ç»</span></div><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> shopItemsSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.items</div><div class="line"><span class="keyword">const</span> taxPercentSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.shop.taxPercent</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  shopItemsSelector,</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> taxSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxPercentSelector,</div><div class="line">  (subtotal, taxPercent) =&gt; subtotal * (taxPercent / <span class="number">100</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  subtotalSelector,</div><div class="line">  taxSelector,</div><div class="line">  (subtotal, tax) =&gt; (&#123; <span class="attr">total</span>: subtotal + tax &#125;)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">let</span> exampleState = &#123;</div><div class="line">  <span class="attr">shop</span>: &#123;</div><div class="line">    <span class="attr">taxPercent</span>: <span class="number">8</span>,</div><div class="line">    <span class="attr">items</span>: [</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'apple'</span>, <span class="attr">value</span>: <span class="number">1.20</span> &#125;,</div><div class="line">      &#123; <span class="attr">name</span>: <span class="string">'orange'</span>, <span class="attr">value</span>: <span class="number">0.95</span> &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(subtotalSelector(exampleState)) <span class="comment">// 2.15</span></div><div class="line"><span class="built_in">console</span>.log(taxSelector(exampleState))      <span class="comment">// 0.172</span></div><div class="line"><span class="built_in">console</span>.log(totalSelector(exampleState))    <span class="comment">// &#123; total: 2.322 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ul>
<li><a href="#å®‰è£…">Installation</a></li>
<li><a href="#å®ä¾‹">å®ä¾‹</a><ul>
<li><a href="#motivation-for-memoized-selectors">Motivation for Memoized Selectors</a></li>
<li><a href="#creating-a-memoized-selector">Creating a Memoized Selector</a></li>
<li><a href="#composing-selectors">Composing Selectors</a></li>
<li><a href="#connecting-a-selector-to-the-redux-store">Connecting a Selector to the Redux Store</a></li>
<li><a href="#accessing-react-props-in-selectors">Accessing React Props in Selectors</a></li>
<li><a href="#sharing-selectors-with-props-across-multiple-components">Sharing Selectors with Props Across Multiple Components</a></li>
</ul>
</li>
<li><a href="#api">API</a><ul>
<li><a href="#createselectorinputselectors--inputselectors-resultfunc"><code>createSelector</code></a></li>
<li><a href="#defaultmemoizefunc-equalitycheck--defaultequalitycheck"><code>defaultMemoize</code></a></li>
<li><a href="#createselectorcreatormemoize-memoizeoptions"><code>createSelectorCreator</code></a></li>
<li><a href="#createstructuredselectorinputselectors-selectorcreator--createselector"><code>createStructuredSelector</code></a></li>
</ul>
</li>
<li><p><a href="#faq">FAQ</a></p>
<ul>
<li><a href="#q-why-isnt-my-selector-recomputing-when-the-input-state-changes">Why isnâ€™t my selector recomputing when the input state changes?</a></li>
<li><a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">Why is my selector recomputing when the input state stays the same?</a></li>
<li><a href="#q-can-i-use-reselect-without-redux">Can I use Reselect without Redux?</a></li>
<li><a href="#q-the-default-memoization-function-is-no-good-can-i-use-a-different-one">The default memoization function is no good, can I use a different one?</a></li>
<li><a href="#q-how-do-i-test-a-selector">How do I test a selector?</a></li>
<li><a href="#q-how-do-i-create-a-selector-that-takes-an-argument">How do I create a selector that takes an argument? </a></li>
<li><a href="#q-how-do-i-use-reselect-with-immutablejs">How do I use Reselect with Immutable.js?</a></li>
<li><a href="#q-can-i-share-a-selector-across-multiple-components">Can I share a selector across multiple components?</a></li>
<li><a href="#q-are-there-typescript-typings">Are there TypeScript typings?</a></li>
<li><a href="#q-how-can-i-make-a-curried-selector">How can I make a curried selector?</a></li>
</ul>
</li>
<li><p><a href="#related-projects">Related Projects</a></p>
</li>
<li><a href="#license">License</a><br>##å®‰è£…<br><code>npm install reselect</code></li>
</ul>
<p>##å®ä¾‹</p>
<p>###ç¼“å­˜Selcectosçš„åŠ¨æœº</p>
<blockquote>
<p>å®ä¾‹æ˜¯åŸºäº <a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux Todos List example</a>.</p>
</blockquote>
<h4 id="containers-VisibleTodoList-js"><a href="#containers-VisibleTodoList-js" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"></div><div class="line"><span class="comment">//ä¸‹é¢è¿™æ®µä»£ç æ˜¯æ ¹æ®è¿‡æ»¤å™¨çš„stateæ¥æ”¹å˜æ—¥ç¨‹stateçš„å‡½æ•°</span></div><div class="line"><span class="keyword">const</span> getVisibleTodos = <span class="function">(<span class="params">todos, filter</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (filter) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">      <span class="keyword">return</span> todos</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">    <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">      <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">//todosæ˜¯æ ¹æ®è¿‡æ»¤å‡½æ•°è¿”å›çš„stateï¼Œä¼ å…¥ä¸¤ä¸ªå®å‚</span></div><div class="line">    todos: getVisibleTodos(state.todos, state.visibilityFilter)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//mapDispatchToPropsæ¥ä¼ é€’dispatchçš„æ–¹æ³•</span></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//ä½¿ç”¨Reduxçš„connectå‡½æ•°æ³¨å…¥state,åˆ°TodoListç»„ä»¶</span></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,<code>mapStateToProps</code>è°ƒç”¨<code>getVisibleTodos</code>å»è®¡ç®—<code>todos</code>.è¿™ä¸ªå‡½æ•°è®¾è®¡çš„æ˜¯ç›¸å½“å¥½çš„,ä½†æ˜¯æœ‰ä¸ªç¼ºç‚¹ï¼š<code>todos</code>åœ¨æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½ä¼šé‡æ–°è®¡ç®—.å¦‚æœstateæ ‘çš„ç»“æ„æ¯”è¾ƒå¤§,æˆ–è€…è®¡ç®—æ¯”è¾ƒæ˜‚è´µ,æ¯ä¸€æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½è¿›è¡Œè®¡ç®—çš„è¯,å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜.<code>Reselect</code>èƒ½å¤Ÿå¸®åŠ©reduxæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—è¿‡ç¨‹.</p>
<p>###åˆ›å»ºä¸€ä¸ªç¼“å­˜Selector<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®°å¿†ç¼“å­˜selectorä»£æ›¿<code>getVisibleTodos</code>,å¦‚æœ<code>state.todos</code>å’Œ<code>state.visibilityFilter</code>å‘ç”Ÿå˜åŒ–,ä»–ä¼šé‡æ–°è®¡ç®—<code>state</code>,ä½†æ˜¯å‘ç”Ÿåœ¨å…¶ä»–éƒ¨åˆ†çš„stateå˜åŒ–,å°±ä¸ä¼šé‡æ–°è®¡ç®—.</p>
<p>Reslectæä¾›ä¸€ä¸ªå‡½æ•°<code>createSelector</code>æ¥åˆ›å»ºä¸€ä¸ªè®°å¿†selectors.<code>createSelector</code>æ¥å—ä¸€ä¸ª<code>input-selectors</code>å’Œä¸€ä¸ªå˜æ¢å‡½æ•°ä½œä¸ºå‚æ•°.å¦‚æœReduxçš„stateå‘ç”Ÿæ”¹å˜é€ æˆ<code>input-selector</code>çš„å€¼å‘ç”Ÿæ”¹å˜,selectorä¼šè°ƒç”¨å˜æ¢å‡½æ•°,ä¾æ®<code>input-selector</code>åšå‚æ•°,è¿”å›ä¸€ä¸ªç»“æœ.å¦‚æœ<code>input-selector</code>è¿”å›çš„ç»“æœå’Œå‰é¢çš„ä¸€æ ·,é‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å›æœ‰å…³state,ä¼šçœç•¥å˜æ¢å‡½æ•°çš„è°ƒç”¨.</p>
<p>ä¸‹é¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè®°å¿†selector<code>getVisibleTodos</code>æ›¿ä»£éè®°å¿†çš„ç‰ˆæœ¬</p>
<h4 id="selectors-index-js"><a href="#selectors-index-js" class="headerlink" title="selectors/index.js"></a><code>selectors/index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state</span>) =&gt;</span> state.visibilityFilter</div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state</span>) =&gt;</span> state.todos</div><div class="line"><span class="comment">//ä¸‹é¢çš„å‡½æ•°æ˜¯ç»è¿‡åŒ…è£…çš„</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ALL'</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä¸Šé¢çš„çš„å®ä¾‹ä¸­,<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>æ˜¯input-selectors.è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æ™®é€šçš„éè®°å¿†selectorå‡½æ•°,å› ä¸ºä»–ä»¬æ²¡æœ‰å˜æ¢ä»–ä»¬selectçš„æ•°æ®.<code>getVisibleTodos</code>å¦ä¸€æ–¹é¢æ˜¯ä¸€ä¸ªè®°å¿†selector.ä»–æ¥æ”¶<code>getVisibilityfilter</code>å’Œ<code>getTodos</code>ä½œä¸ºinput-selectors,å¹¶ä¸”ä½œä¸ºä¸€ä¸ªå˜æ¢å‡½æ•°è®¡ç®—ç­›é€‰çš„todo list.</p>
<p>###èšåˆselectors</p>
<p>ä¸€ä¸ªè®°å¿†æ€§selectoræœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªè®°å¿†æ€§selectorçš„input-selector.è¿™é‡Œ<code>getVisibleTodos</code>å¯ä»¥ä½œä¸ºinput-selectorä½œä¸ºå…³é”®å­—ç­›é€‰çš„input-selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> getKeyword = <span class="function">(<span class="params">state</span>) =&gt;</span> state.keyword</div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodosFilteredByKeyword = createSelector(</div><div class="line">  [ getVisibleTodos, getKeyword ],</div><div class="line">  (visibleTodos, keyword) =&gt; visibleTodos.filter(</div><div class="line">    <span class="function"><span class="params">todo</span> =&gt;</span> todo.text.indexOf(keyword) &gt; <span class="number">-1</span></div><div class="line">  )</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###è¿æ¥ä¸€ä¸ªSelectoråˆ°Redux Store<br>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ <a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">React Redux</a>, ä½ å¯ä»¥ç›´æ¥ä¼ é€’selectoråˆ° <code>mapStateToProps()</code>:</p>
<h4 id="containers-VisibleTodoList-js-1"><a href="#containers-VisibleTodoList-js-1" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>###åœ¨React Propsä¸­æ¥å…¥Selectors</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å‡è®¾ç¨‹åºå°†ä¼šæœ‰ä¸€ä¸ªæ‰©å±•,æˆ‘ä»¬å…è®¸selectoræ”¯æŒå¤štodo List.è¯·æ³¨æ„å¦‚æœè¦å®Œå…¨å®æ–½è¿™ä¸ªæ‰©å±•,reducers,components,actionsç­‰ç­‰éƒ½éœ€è¦ä½œå‡ºæ”¹å˜.è¿™äº›å†…å®¹å’Œä¸»é¢˜ä¸æ˜¯å¤ªç›¸å…³,æ‰€ä»¥è¿™é‡Œå°±çœç•¥æ‰äº†.</p>
</blockquote>
<p>ç›®å‰ä¸ºæ­¢,æˆ‘ä»¬ä»…ä»…çœ‹åˆ°selectorsæ¥æ”¶storeçš„stateä½œä¸ºä¸€ä¸ªå‚æ•°,å…¶å®ä¸€ä¸ªselectorå¶å¯ä»¥æ¥å—props.</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ª<code>App</code>ç»„ä»¶,æ¸²æŸ“å‡ºä¸‰ä¸ª<code>VisibleTodoList</code>ç»„ä»¶,æ¯ä¸€ä¸ªç»„ä»¶æœ‰<code>ListId</code>å±æ€§.</p>
<h4 id="components-App-js"><a href="#components-App-js" class="headerlink" title="components/App.js"></a><code>components/App.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'./Footer'</span></div><div class="line"><span class="keyword">import</span> AddTodo <span class="keyword">from</span> <span class="string">'../containers/AddTodo'</span></div><div class="line"><span class="keyword">import</span> VisibleTodoList <span class="keyword">from</span> <span class="string">'../containers/VisibleTodoList'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;VisibleTodoList listId="1" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="2" /&gt;</div><div class="line">    &lt;VisibleTodoList listId="3" /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ¯ä¸€ä¸ª<code>VisibleTodoList</code>containeråº”è¯¥æ ¹æ®å„è‡ªçš„<code>listId</code>å±æ€§è·å–stateçš„ä¸åŒéƒ¨åˆ†.æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code>getVisibilityFilter</code>å’Œ<code>getTodos</code>,ä¾¿äºæ¥å—ä¸€ä¸ªå±æ€§å‚æ•°</p>
<h4 id="selectors-todoSelectors-js"><a href="#selectors-todoSelectors-js" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos <span class="comment">//è¿™é‡Œæ˜¯ä¸ºäºŒç»´æ•°ç»„äº†</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibleTodos = createSelector(</div><div class="line">  [ getVisibilityFilter, getTodos ],</div><div class="line">  (visibilityFilter, todos) =&gt; &#123;</div><div class="line">    <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">      <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">        <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> todos</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> getVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p><code>props</code>å¯ä»¥ä»<code>mapStateToProps</code>ä¼ é€’åˆ°<code>getVisibleTodos</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ç°åœ¨<code>getVisibleTodos</code>å¯ä»¥è·å–<code>props</code>,æ¯ä¸€éƒ¨åˆ†ä¼¼ä¹éƒ½å·¥ä½œçš„ä¸é”™.</p>
<p><em>**ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜</em><br>å½“<code>getVisibleTodos</code>selectorå’Œ<code>VisibleTodoList</code>containerçš„å¤šä¸ªå®ä¾‹ä¸€èµ·å·¥ä½œçš„æ—¶å€™,è®°å¿†åŠŸèƒ½å°±ä¸èƒ½æ­£å¸¸çš„è¿è¡Œ:</p>
<h4 id="containers-VisibleTodoList-js-2"><a href="#containers-VisibleTodoList-js-2" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; getVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="comment">// WARNING: THE FOLLOWING SELECTOR DOES NOT CORRECTLY MEMOIZE</span></div><div class="line">    <span class="comment">//âš ï¸ä¸‹é¢çš„selectorä¸èƒ½æ­£ç¡®çš„è®°å¿†</span></div><div class="line">    todos: getVisibleTodos(state, props)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ—¶å€™,å¦‚æœä»–çš„å‚æ•°é›†åˆå’Œä¸Šä¸€æ¬¡çš„å‚æ•°æœºä¼šæ˜¯ä¸€æ ·çš„,ä»…ä»…è¿”å›ç¼“å­˜çš„å€¼.å¦‚æœæˆ‘ä»¬äº¤æ›¿æ¸²æŸ“<code>&lt;VisibleTodoList listId=&quot;1&quot; /&gt;</code> å’Œ<code>&lt;VisibleTodoList listId=&quot;2&quot; /&gt;</code>æ—¶,å…±äº«çš„selectorå°†ä¼šäº¤æ›¿æ¥å—<code>{listIdï¼š1}</code>å’Œ<code>{listId:2}</code>ä½œä¸ºä»–çš„propsçš„å‚æ•°.è¿™å°†ä¼šå¯¼è‡´æ¯ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™çš„å‚æ•°éƒ½ä¸åŒ,å› æ­¤selectoræ¯æ¬¡éƒ½ä¼šé‡æ–°æ¥è®¡ç®—è€Œä¸æ˜¯è¿”å›ç¼“å­˜çš„å€¼.ä¸‹ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†ä¼šä»‹ç»æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜.</p>
<p>###è·¨è¶Šå¤šä¸ªç»„ä»¶ä½¿ç”¨selectorså…±æ€§props</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†çš„å®ä¾‹éœ€è¦React Redux v4.3.0æˆ–è€…æ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒ.</p>
</blockquote>
<p>åœ¨å¤šä¸ª<code>VisibleTodoList</code>ç»„ä»¶ä¸­å…±äº«selector,åŒæ—¶è¿˜è¦<strong>ä¿æŒ</strong>è®°å¿†æ€§,æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹éœ€è¦ä»–ä»¬è‡ªå·±çš„selectorå¤‡ä»½.</p>
<p>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°<code>makeGetVisibleTodos</code>,è¿™ä¸ªå‡½æ•°æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™è¿”å›ä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>çš„æ‹·è´:</p>
<h4 id="selectors-todoSelectors-js-1"><a href="#selectors-todoSelectors-js-1" class="headerlink" title="selectors/todoSelectors.js"></a><code>selectors/todoSelectors.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> getVisibilityFilter = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].visibilityFilter</div><div class="line"></div><div class="line"><span class="keyword">const</span> getTodos = <span class="function">(<span class="params">state, props</span>) =&gt;</span></div><div class="line">  state.todoLists[props.listId].todos</div><div class="line"></div><div class="line"><span class="keyword">const</span> makeGetVisibleTodos = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    [ getVisibilityFilter, getTodos ],</div><div class="line">    (visibilityFilter, todos) =&gt; &#123;</div><div class="line">      <span class="keyword">switch</span> (visibilityFilter) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_COMPLETED'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">        <span class="keyword">case</span> <span class="string">'SHOW_ACTIVE'</span>:</div><div class="line">          <span class="keyword">return</span> todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> !todo.completed)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">          <span class="keyword">return</span> todos</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeGetVisibleTodos</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘ä»¬ä¹Ÿéœ€è¦è®¾ç½®ç»™æ¯ä¸€ä¸ªç»„ä»¶çš„å®ä¾‹ä»–ä»¬å„è‡ªè·å–ç§æœ‰çš„selectoræ–¹æ³•.<code>mapStateToProps</code>çš„<code>connect</code>å‡½æ•°å¯ä»¥å¸®åŠ©å®Œæˆè¿™ä¸ªåŠŸèƒ½.</p>
<p><em>**å¦‚æœ<code>mapStateToProps</code>æä¾›ç»™<code>connect</code>ä¸è¿”å›ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°,ä»–å°±å¯ä»¥è¢«ç”¨æ¥ä¸ºæ¯ä¸ªç»„ä»¶containeråˆ›å»ºä¸€ä¸ªç§æœ‰çš„<code>mapStateProps</code>å‡½æ•°.</em></p>
<p>åœ¨ä¸‹é¢çš„å®ä¾‹ä¸­,<code>mapStateProps</code>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>getVisibleTodos</code>selector,ä»–è¿”å›ä¸€ä¸ª<code>mapStateToProps</code>å‡½æ•°,è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ¥å…¥æ–°çš„selector.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœæˆ‘ä»¬æŠŠ<code>makeMapStateToprops</code>ä¼ é€’åˆ°<code>connect</code>,æ¯ä¸€ä¸ª<code>visibleTodoList</code>containerå°†ä¼šè·å¾—å„è‡ªçš„å«æœ‰ç§æœ‰<code>getVisibleTodos</code>selectorçš„<code>mapStateToProps</code>çš„å‡½æ•°.è¿™æ ·ä¸€æ¥è®°å¿†å°±æ­£å¸¸äº†,ä¸ç®¡<code>VisibleTodoList</code>containersçš„æ¸²æŸ“é¡ºåºæ€ä¹ˆæ ·.</p>
<h4 id="containers-VisibleTodoList-js-3"><a href="#containers-VisibleTodoList-js-3" class="headerlink" title="containers/VisibleTodoList.js"></a><code>containers/VisibleTodoList.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../actions'</span></div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../components/TodoList'</span></div><div class="line"><span class="keyword">import</span> &#123; makeGetVisibleTodos &#125; <span class="keyword">from</span> <span class="string">'../selectors'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> makeMapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> getVisibleTodos = makeGetVisibleTodos()</div><div class="line">  <span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">todos</span>: getVisibleTodos(state, props)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapStateToProps</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">onTodoClick</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">      dispatch(toggleTodo(id))</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">  makeMapStateToProps,</div><div class="line">  mapDispatchToProps</div><div class="line">)(TodoList)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</div></pre></td></tr></table></figure>
<hr>
<p>##API</p>
<p>###createSelector(â€¦inputSelectors|[inputSelectors],resultFunc)</p>
<p>æ¥å—ä¸€ä¸ªæˆ–è€…å¤šä¸ªselectors,æˆ–è€…ä¸€ä¸ªselectorsæ•°ç»„,è®¡ç®—ä»–ä»¬çš„å€¼å¹¶ä¸”ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>resultFunc</code>.</p>
<p><code>createSelector</code>é€šè¿‡åˆ¤æ–­input-selectorä¹‹å‰è°ƒç”¨å’Œä¹‹åè°ƒç”¨çš„è¿”å›å€¼çš„å…¨ç­‰äº(===,è¿™ä¸ªåœ°æ–¹è‹±æ–‡æ–‡çŒ®å«reference equality,å¼•ç”¨ç­‰äº,è¿™ä¸ªå•è¯æ˜¯æœ¬è´¨,ä¸­æ–‡æ²¡æœ‰ç¿»è¯‘å‡ºæ¥).ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„selectoråº”è¯¥æ˜¯immutable(ä¸å˜çš„).</p>
<p>ç»è¿‡<code>createSelector</code>åˆ›å»ºçš„Selectorsæœ‰ä¸€ä¸ªç¼“å­˜,å¤§å°æ˜¯1.è¿™æ„å‘³ç€å½“ä¸€ä¸ªinput-selectorå˜åŒ–çš„æ—¶å€™,ä»–ä»¬æ€»æ˜¯ä¼šé‡æ–°è®¡ç®—state,å› ä¸ºSelectorä»…ä»…å­˜å‚¨æ¯ä¸€ä¸ªinput-selectorå‰ä¸€ä¸ªå€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">  state =&gt; state.values.value2,</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// You can also pass an array of selectors</span></div><div class="line"><span class="comment">//å¯ä»¥å‡ºä¼ é€’ä¸€ä¸ªselectoræ•°ç»„</span></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  [</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.values.value1,</div><div class="line">    state =&gt; state.values.value2</div><div class="line">  ],</div><div class="line">  (value1, value2) =&gt; value1 + value2</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨selectorå†…éƒ¨è·å–ä¸€ä¸ªç»„ä»¶çš„propséå¸¸æœ‰ç”¨.å½“ä¸€ä¸ªselectoré€šè¿‡<code>connect</code>å‡½æ•°è¿æ¥åˆ°ä¸€ä¸ªç»„ä»¶ä¸Š,ç»„ä»¶çš„å±æ€§ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™selector:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> abSelector = <span class="function">(<span class="params">state, props</span>) =&gt;</span> state.a * props.b</div><div class="line"></div><div class="line"><span class="comment">// props only (ignoring state argument)</span></div><div class="line"><span class="keyword">const</span> cSelector =  <span class="function">(<span class="params">_, props</span>) =&gt;</span> props.c</div><div class="line"></div><div class="line"><span class="comment">// state only (props argument omitted as not required)</span></div><div class="line"><span class="keyword">const</span> dSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.d</div><div class="line"></div><div class="line"><span class="keyword">const</span> totalSelector = createSelector(</div><div class="line">  abSelector,</div><div class="line">  cSelector,</div><div class="line">  dSelector,</div><div class="line">  (ab, c, d) =&gt; (&#123;</div><div class="line">    <span class="attr">total</span>: ab + c + d</div><div class="line">  &#125;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>###defaultMemoize(func, equalityCheck = defaultEqualityCheck)</p>
<p><code>defaultMemoize</code>èƒ½è®°ä½é€šè¿‡funcä¼ é€’çš„å‚æ•°.è¿™æ˜¯<code>createSelector</code>ä½¿ç”¨çš„è®°å¿†å‡½æ•°.</p>
<p><code>defaultMemoize</code> é€šè¿‡è°ƒç”¨<code>equalityCheck</code>å‡½æ•°æ¥å†³å®šä¸€ä¸ªå‚æ•°æ˜¯å¦å·²ç»å‘ç”Ÿæ”¹å˜.å› ä¸º<code>defaultMemoize</code>è®¾è®¡å‡ºæ¥å°±æ˜¯å’Œimmutableæ•°æ®ä¸€èµ·ä½¿ç”¨,é»˜è®¤çš„<code>equalityCheck</code>ä½¿ç”¨å¼•ç”¨å…¨ç­‰äºæ¥åˆ¤æ–­å˜åŒ–:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaultEqualityCheck</span>(<span class="params">currentVal, previousVal</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> currentVal === previousVal</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><code>defaultMemoize</code>å’Œ<code>createSelectorCreator</code>å»<a href="#é…ç½®-equalitycheck-for-defaultmemoize">é…ç½®<code>equalityCheck</code>å‡½æ•°</a>.</p>
<p>###createSelectorCreator(memoize,â€¦memoizeOptions)</p>
<p><code>createSelectorCreator</code>ç”¨æ¥é…ç½®å®šåˆ¶ç‰ˆæœ¬çš„<code>createSelector</code>.</p>
<p><code>memoize</code>å‚æ•°æ˜¯ä¸€ä¸ªæœ‰è®°å¿†åŠŸèƒ½çš„å‡½æ•°,æ¥ä»£æ›¿<code>defaultMemoize</code>.<br><code>â€¦memoizeOption</code>å±•å¼€çš„å‚æ•°æ˜¯0æˆ–è€…æ›´å¤šçš„é…ç½®é€‰é¡¹,è¿™äº›å‚æ•°ä¼ é€’ç»™<code>memoizeFunc</code>.selectors<code>resultFunc</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>memoize</code>,<code>memoizeOptions</code>ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(</div><div class="line">  customMemoize, <span class="comment">// function to be used to memoize resultFunc,è®°å¿†resultFunc</span></div><div class="line">  option1, <span class="comment">// option1 will be passed as second argument to customMemoize ç¬¬äºŒä¸ªæƒ¨å‘¼</span></div><div class="line">  option2, <span class="comment">// option2 will be passed as third argument to customMemoize ç¬¬ä¸‰ä¸ªå‚æ•°</span></div><div class="line">  option3 <span class="comment">// option3 will be passed as fourth argument to customMemoize   ç¬¬å››ä¸ªå‚æ•°</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> customSelector = customSelectorCreator(</div><div class="line">  input1,</div><div class="line">  input2,</div><div class="line">  resultFunc <span class="comment">// resultFunc will be passed as first argument to customMemoize  ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™customMomize</span></div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨<code>customSelecotr</code>å†…éƒ¨æ»´å•Šç”¨memoizeçš„å‡½æ•°çš„ä»£ç å¦‚ä¸‹:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">customMemoize(resultFunc, option1, option2, option3)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªå¯èƒ½ä¼šç”¨åˆ°çš„<code>createSelectorCreator</code>çš„å®ä¾‹:</p>
<p>####ä¸º<code>defaultMemoize</code>é…ç½®<code>equalityCheck</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.values.filter(<span class="function"><span class="params">val</span> =&gt;</span> val &lt; <span class="number">5</span>),</div><div class="line">  values =&gt; values.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>####ä½¿ç”¨loadshçš„memoizeå‡½æ•°æ¥ç¼“å­˜æœªç»‘å®šçš„ç¼“å­˜.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> called = <span class="number">0</span></div><div class="line"><span class="keyword">const</span> hashFn = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.reduce(</div><div class="line">  <span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + <span class="string">'-'</span> + <span class="built_in">JSON</span>.stringify(val),</div><div class="line">  <span class="string">''</span></div><div class="line">)</div><div class="line"><span class="keyword">const</span> customSelectorCreator = createSelectorCreator(memoize, hashFn)</div><div class="line"><span class="keyword">const</span> selector = customSelectorCreator(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; &#123;</div><div class="line">    called++</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<h3 id="createStructuredSelector-inputSelectors-selectorCreator-createSelector"><a href="#createStructuredSelector-inputSelectors-selectorCreator-createSelector" class="headerlink" title="createStructuredSelector({inputSelectors}, selectorCreator = createSelector)"></a>createStructuredSelector({inputSelectors}, selectorCreator = createSelector)</h3><p>å¦‚æœåœ¨æ™®é€šçš„æ¨¡å¼ä¸‹ä½¿ç”¨<code>createStructuredSelector</code>å‡½æ•°å¯ä»¥æå‡ä¾¿åˆ©æ€§.ä¼ é€’åˆ°<code>connect</code>çš„selectorè£…é¥°è€…(è¿™æ˜¯jsè®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ,å¯ä»¥å‚è€ƒç›¸å…³çš„ä¹¦ç±)æ¥å—ä»–çš„input-selectors,å¹¶ä¸”åœ¨ä¸€ä¸ªå¯¹è±¡å†…æ˜ å°„åˆ°ä¸€ä¸ªé”®ä¸Š.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="comment">// The result function in the following selector</span></div><div class="line"><span class="comment">// is simply building an object from the input selectors ç”±selectorsæ„å»ºçš„ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"><span class="keyword">const</span> structuredSelector = createSelector(</div><div class="line">   mySelectorA,</div><div class="line">   mySelectorB,</div><div class="line">   mySelectorC,</div><div class="line">   (a, b, c) =&gt; (&#123;</div><div class="line">     a,</div><div class="line">     b,</div><div class="line">     c</div><div class="line">   &#125;)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p><code>createStructuredSelector</code>æ¥å—ä¸€ä¸ªå¯¹è±¡,è¿™ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯input-selectors,å‡½æ•°è¿”å›ä¸€ä¸ªç»“æ„æ€§çš„selector.è¿™ä¸ªç»“æ„æ€§çš„selectorè¿”å›ä¸€ä¸ªå¯¹è±¡,å¯¹è±¡çš„é”®å’Œ<code>inputSelectors</code>çš„å‚æ•°æ˜¯ç›¸åŒçš„,ä½†æ˜¯ä½¿ç”¨selectorsä»£æ›¿äº†å…¶ä¸­çš„å€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> mySelectorA = <span class="function"><span class="params">state</span> =&gt;</span> state.a</div><div class="line"><span class="keyword">const</span> mySelectorB = <span class="function"><span class="params">state</span> =&gt;</span> state.b</div><div class="line"></div><div class="line"><span class="keyword">const</span> structuredSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">x</span>: mySelectorA,</div><div class="line">  <span class="attr">y</span>: mySelectorB</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> result = structuredSelector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;) <span class="comment">// will produce &#123; x: 1, y: 2 &#125;</span></div></pre></td></tr></table></figure>
<hr>
<p>ç»“æ„æ€§çš„selectorså¯ä»¥æ˜¯åµŒå¥—å¼çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nestedSelector = createStructuredSelector(&#123;</div><div class="line">  <span class="attr">subA</span>: createStructuredSelector(&#123;</div><div class="line">    selectorA,</div><div class="line">    selectorB</div><div class="line">  &#125;),</div><div class="line">  <span class="attr">subB</span>: createStructuredSelector(&#123;</div><div class="line">    selectorC,</div><div class="line">    selectorD</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>##FAQ</p>
<h3 id="Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"><a href="#Q-ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™-selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ" class="headerlink" title="Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ"></a>Q:ä¸ºä»€ä¹ˆå½“è¾“å…¥çš„stateå‘ç”Ÿæ”¹å˜çš„æ—¶å€™,selectorä¸é‡æ–°è®¡ç®—ï¼Ÿ</h3><p>A:æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†éŸ©å¼æ˜¯ä¸æ˜¯å’Œä½ çš„stateæ›´æ–°å‡½æ•°ç›¸å…¼å®¹(ä¾‹å¦‚:å¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux).ä¾‹å¦‚:ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŸæ¥æœŸå¾…çš„æ˜¯æ›´æ–°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡.<code>createSelector</code>ä½¿ç”¨(===)æ£€æµ‹è¾“å…¥æ˜¯å¦æ”¹å˜,å› æ­¤å¦‚æœæ”¹å˜ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡æ²¡æœ‰è§¦å‘selectoré‡æ–°è®¡ç®—çš„åŸå› æ˜¯æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™æ²¡æœ‰è§¦å‘ç›¸å…³çš„æ£€æµ‹.æç¤ºï¼šå¦‚æœä½ æ­£åœ¨ä½¿ç”¨Redux,æ”¹å˜ä¸€ä¸ªstateå¯¹è±¡çš„<a href="http://redux.js.org/docs/Troubleshooting.html" target="_blank" rel="external">é”™è¯¯å¯èƒ½æœ‰</a>.</p>
<p>ä¸‹é¢çš„å®ä¾‹å®šä¹‰äº†ä¸€ä¸ªselectorå¯ä»¥å†³å®šæ•°ç»„çš„ç¬¬ä¸€ä¸ªtodoé¡¹ç›®æ˜¯ä¸æ˜¯å·²ç»è¢«å®Œæˆ:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> isFirstTodoCompleteSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.todos[<span class="number">0</span>],</div><div class="line">  todo =&gt; todo &amp;&amp; todo.completed</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoCompleteSelector</code><strong>å°†ä¸ä¼š</strong>æ­£å¸¸å·¥ä½œå·¥ä½œ:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// BAD: mutating an existing object</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      todo.completed = !areAllMarked</div><div class="line">      <span class="keyword">return</span> todo</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„stateæ›´æ–°å‡½æ•°å’Œ<code>isFirstTodoComplete</code>ä¸€èµ·<strong>å¯ä»¥</strong>æ­£å¸¸å·¥ä½œ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> COMPLETE_ALL:</div><div class="line">    <span class="keyword">const</span> areAllMarked = state.every(<span class="function"><span class="params">todo</span> =&gt;</span> todo.completed)</div><div class="line">    <span class="comment">// GOOD: returning a new object each time with Object.assign</span></div><div class="line">    <span class="keyword">return</span> state.map(<span class="function"><span class="params">todo</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, todo, &#123;</div><div class="line">      <span class="attr">completed</span>: !areAllMarked</div><div class="line">    &#125;))</div><div class="line"></div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨Redux,ä½†æ˜¯æœ‰ä½¿ç”¨mutableæ•°æ®çš„éœ€æ±‚,ä½ å¯ä»¥ä½¿ç”¨<code>createSelectorCreator</code>ä»£æ›¿é»˜è®¤çš„è®°å¿†å‡½æ•°,å¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç­‰å€¼æ£€æµ‹å‡½æ•°.è¯·å‚çœ‹<a href="#use-memoize-function-from-lodash-for-an-unbounded-cache">è¿™é‡Œ</a> å’Œ <a href="#customize-equalitycheck-for-defaultmemoize">è¿™é‡Œ</a>ä½œä¸ºå‚è€ƒ.</p>
<p>###Q:ä¸ºä»€ä¹ˆinput stateæ²¡æœ‰æ”¹å˜çš„æ—¶å€™,selectorè¿˜æ˜¯ä¼šé‡æ–°è®¡ç®—?</p>
<p>A: æ£€æŸ¥ä¸€ä¸‹ä½ çš„è®°å¿†å‡½æ•°å’Œä½ ä½ çš„stateæ›´æ–°å‡½æ•°æ˜¯ä¸æ˜¯å…¼å®¹(å¦‚æœæ˜¯ä½¿ç”¨Reduxçš„æ—¶å€™,çœ‹çœ‹reducer).ä¾‹å¦‚:ä½¿ç”¨æ¯ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™,ä¸ç®¡å€¼æ˜¯ä¸æ˜¯å‘ç”Ÿæ”¹å˜,<code>createSelector</code>åˆ›å»ºçš„selectoræ€»æ˜¯ä¼šæ”¶åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡.<code>createSelector</code>å‡½æ•°ä½¿ç”¨(<code>===</code>)æ£€æµ‹inputçš„å˜åŒ–,ç”±æ­¤å¯çŸ¥å¦‚æœæ¯æ¬¡éƒ½è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,è¡¨ç¤ºselectoræ€»æ˜¯åœ¨æ¯æ¬¡æ›´æ–°çš„æ—¶å€™é‡æ–°è®¡ç®—.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">return</span> state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¸‹é¢çš„selectoråœ¨æ¯ä¸€æ¬¡REMOVE_OLDè°ƒç”¨çš„æ—¶å€™,éƒ½ä¼šé‡æ–°è®¡ç®—,å› ä¸ºArray.filteræ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡.ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,REMOVE_OLD actionéƒ½ä¸ä¼šæ”¹å˜todoåˆ—è¡¨,æ‰€ä»¥é‡æ–°è®¡ç®—æ˜¯ä¸å¿…è¦çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> visibleTodosSelector = createSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>ä½ å¯ä»¥é€šè¿‡stateæ›´æ–°å‡½æ•°è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—æ“ä½œ,è¿™ä¸ªå¯¹è±¡æ‰§è¡Œæ·±åº¦ç­‰å€¼æ£€æµ‹,åªæœ‰æ·±åº¦ä¸ç›¸åŒçš„æ—¶å€™æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REMOVE_OLD &#125; <span class="keyword">from</span> <span class="string">'../constants/ActionTypes'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> initialState = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">text</span>: <span class="string">'Use Redux'</span>,</div><div class="line">    <span class="attr">completed</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">id</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">timestamp</span>: <span class="built_in">Date</span>.now()</div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">  <span class="keyword">case</span> REMOVE_OLD:</div><div class="line">    <span class="keyword">const</span> updatedState =  state.filter(<span class="function"><span class="params">todo</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> todo.timestamp + <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> &gt; <span class="built_in">Date</span>.now()</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">return</span> isEqual(updatedState, state) ? state : updatedState</div><div class="line">  <span class="keyword">default</span>:</div><div class="line">    <span class="keyword">return</span> state</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ›¿ä»£çš„æ–¹æ³•æ˜¯,åœ¨selectorä¸­ä½¿ç”¨æ·±åº¦æ£€æµ‹æ–¹æ³•æ›¿ä»£é»˜è®¤çš„<code>equalityCheck</code>å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelectorCreator, defaultMemoize &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> isEqual <span class="keyword">from</span> <span class="string">'lodash.isEqual'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> todosSelector = <span class="function"><span class="params">state</span> =&gt;</span> state.todos</div><div class="line"></div><div class="line"><span class="comment">// create a "selector creator" that uses lodash.isEqual instead of ===</span></div><div class="line"><span class="keyword">const</span> createDeepEqualSelector = createSelectorCreator(</div><div class="line">  defaultMemoize,</div><div class="line">  isEqual</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// use the new "selector creator" to create a selector</span></div><div class="line"><span class="keyword">const</span> mySelector = createDeepEqualSelector(</div><div class="line">  todosSelector,</div><div class="line">  (todos) =&gt; &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ£€æŸ¥<code>equalityCheck</code>å‡½æ•°çš„æ›´æ›¿æˆ–è€…åœ¨stateæ›´æ–°å‡½æ•°ä¸­åšæ·±åº¦æ£€æµ‹å¹¶ä¸æ€»æ˜¯æ¯”é‡è®¡ç®—çš„èŠ±é”€å°.å¦‚æœæ¯æ¬¡é‡è®¡ç®—çš„èŠ±é”€æ€»æ˜¯æ¯”è¾ƒå°,å¯èƒ½çš„åŸå› æ˜¯Reselectæ²¡æœ‰é€šè¿‡<code>connect</code>å‡½æ•°ä¼ é€’<code>mapStateProps</code>å•çº¯å¯¹è±¡çš„åŸå› .</p>
<h3 id="Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"><a href="#Q-æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ" class="headerlink" title="Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ"></a>Q:æ²¡æœ‰Reduxçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Reselectå—ï¼Ÿ</h3><p>A:å¯ä»¥.Reselectæ²¡æœ‰å…¶ä»–ä»»ä½•çš„ä¾èµ–åŒ…,å› æ­¤å°½ç®¡ä»–è®¾è®¡çš„å’ŒReduxæ¯”è¾ƒæ­é…,ä½†æ˜¯ç‹¬ç«‹ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„.ç›®å‰çš„ç‰ˆæœ¬åœ¨ä¼ ç»Ÿçš„Flux APPä¸‹ä½¿ç”¨æ˜¯æ¯”è¾ƒæˆåŠŸçš„.</p>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„selectors,éœ€è¦ç¡®ä¿ä»–çš„å‚æ•°æ˜¯immutableçš„.</p>
<p>çœ‹<a href="#createselectorinputselectors--inputselectors-resultfunc">è¿™é‡Œ</a></p>
</blockquote>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector"><a href="#Q-æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector."></a>Q:æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ¥æ”¶å‚æ•°çš„selector.</h3><p>A:Reselectæ²¡æœ‰æ”¯æŒåˆ›å»ºæ¥æ”¶å‚æ•°çš„selectors,ä½†æ˜¯è¿™é‡Œæœ‰ä¸€äº›å®ç°ç±»ä¼¼å‡½æ•°åŠŸèƒ½çš„å»ºè®®.</p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯åŠ¨æ€çš„,ä½ å¯ä»¥ä½¿ç”¨å·¥å‚å‡½æ•°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> expensiveItemSelectorFactory = <span class="function"><span class="params">minValue</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> createSelector(</div><div class="line">    shopItemsSelector,</div><div class="line">    items =&gt; items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> subtotalSelector = createSelector(</div><div class="line">  expensiveItemSelectorFactory(<span class="number">200</span>),</div><div class="line">  items =&gt; items.reduce(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item.value, <span class="number">0</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<hr>
<p>æ€»çš„è¾¾æˆå…±è¯†<a href="https://github.com/reactjs/reselect/issues/38" target="_blank" rel="external">çœ‹è¿™é‡Œ</a>å’Œ<a href="https://github.com/optimizely/nuclear-js/issues/14" target="_blank" rel="external">è¶…è¶Š neclear-js</a>æ˜¯:å¦‚æœä¸€ä¸ªselectoréœ€è¦åŠ¨æ€çš„å‚æ•°,é‚£ä¹ˆå‚æ•°åº”è¯¥æ˜¯storeä¸­çš„state.å¦‚æœä½ å†³å®šå¥½äº†åœ¨åº”ç”¨ä¸­ä½¿ç”¨åŠ¨æ€å‚æ•°,åƒä¸‹é¢è¿™æ ·è¿”å›ä¸€ä¸ªè®°å¿†å‡½æ•°æ˜¯æ¯”è¾ƒåˆé€‚çš„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">'reselect'</span></div><div class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">'lodash.memoize'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveSelector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.items,</div><div class="line">  items =&gt; memoize(</div><div class="line">    <span class="function"><span class="params">minValue</span> =&gt;</span> items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.value &gt; minValue)</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> expensiveFilter = expensiveSelector(state)</div><div class="line"></div><div class="line"><span class="keyword">const</span> slightlyExpensive = expensiveFilter(<span class="number">100</span>)</div><div class="line"><span class="keyword">const</span> veryExpensive = expensiveFilter(<span class="number">1000000</span>)</div></pre></td></tr></table></figure>
<hr>
<h3 id="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"><a href="#Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½-æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ" class="headerlink" title="Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ"></a>Qï¼šé»˜è®¤çš„è®°å¿†å‡½æ•°ä¸å¤ªå¥½,æˆ‘èƒ½ç”¨ä¸ªå…¶ä»–çš„å—ï¼Ÿ</h3><p>A: æˆ‘è®¤ä¸ºè¿™ä¸ªè®°å¿†éŸ©å¼å·¥ä½œçš„è¿˜å¯ä»¥,ä½†æ˜¯å¦‚æœä½ éœ€è¦ä¸€ä¸ªå…¶ä»–çš„éŸ©å¼ä¹Ÿæ˜¯å¯ä»¥çš„.<br>å¯ä»¥çœ‹çœ‹è¿™ä¸ª<a href="#customize-equalitycheck-for-defaultmemoize">ä¾‹å­</a></p>
<h3 id="Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector"><a href="#Q-æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector" class="headerlink" title="Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?"></a>Q:æ€ä¹ˆæ‰èƒ½æµ‹è¯•ä¸€ä¸ªselector?</h3><p>A:å¯¹äºä¸€ä¸ªç»™å®šçš„input,ä¸€ä¸ªselectoræ€»æ˜¯äº§å‡ºç›¸åŒçš„ç»“æœ.åŸºäºè¿™ä¸ªåŸå› ,åšå•å…ƒæµ‹è¯•æ˜¯éå¸¸ç®€å•çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> selector = createSelector(</div><div class="line">  <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">  state =&gt; state.b,</div><div class="line">  (a, b) =&gt; (&#123;</div><div class="line">    <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">    <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">  &#125;)</div><div class="line">)</div><div class="line"></div><div class="line">test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">6</span> &#125;)</div><div class="line">  assert.deepEqual(selector(&#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">3</span> &#125;), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>åœ¨stateæ›´æ–°å‡½æ•°è°ƒç”¨çš„æ—¶å€™åŒæ—¶æ£€æµ‹selectorçš„è®°å¿†å‡½æ•°çš„åŠŸèƒ½ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„(ä¾‹å¦‚ ä½¿ç”¨Reduxçš„æ—¶å€™æ£€æŸ¥reducer).æ¯ä¸€ä¸ªselectoréƒ½æœ‰ä¸€ä¸ª<code>recomputations</code>æ–¹æ³•è¿”å›é‡æ–°è®¡ç®—çš„æ¬¡æ•°:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">suite(<span class="string">'selector'</span>, () =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> state = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> (</div><div class="line">    &#123;</div><div class="line">      <span class="attr">a</span>: action(state.a),</div><div class="line">      <span class="attr">b</span>: action(state.b)</div><div class="line">    &#125;</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> selector = createSelector(</div><div class="line">    <span class="function"><span class="params">state</span> =&gt;</span> state.a,</div><div class="line">    state =&gt; state.b,</div><div class="line">    (a, b) =&gt; (&#123;</div><div class="line">      <span class="attr">c</span>: a * <span class="number">2</span>,</div><div class="line">      <span class="attr">d</span>: b * <span class="number">3</span></div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line"></div><div class="line">  <span class="keyword">const</span> plusOne = <span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span></div><div class="line">  <span class="keyword">const</span> id = <span class="function"><span class="params">x</span> =&gt;</span> x</div><div class="line"></div><div class="line">  test(<span class="string">"selector unit test"</span>, () =&gt; &#123;</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    state = reducer(state, id)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">4</span>, <span class="attr">d</span>: <span class="number">9</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">1</span>)</div><div class="line">    state = reducer(state, plusOne)</div><div class="line">    assert.deepEqual(selector(state), &#123; <span class="attr">c</span>: <span class="number">6</span>, <span class="attr">d</span>: <span class="number">12</span> &#125;)</div><div class="line">    assert.equal(selector.recomputations(), <span class="number">2</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<hr>
<p>å¦å¤–,selectorsä¿ç•™äº†æœ€åä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æœçš„å¼•ç”¨,è¿™ä¸ªå¼•ç”¨ä½œä¸º<code>.resultFunc</code>.å¦‚æœä½ å·²ç»èšåˆäº†å…¶ä»–çš„selectors,è¿™ä¸ªå‡½æ•°å¼•ç”¨å¯ä»¥å¸®åŠ©ä½ æµ‹è¯•æ¯ä¸€ä¸ªselector,ä¸éœ€è¦ä»stateä¸­è§£è€¦æµ‹è¯•.</p>
<p>ä¾‹å¦‚å¦‚æœä½ çš„selectorsé›†åˆåƒä¸‹é¢è¿™æ ·:<br><strong>selectors.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> firstSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> secondSelector = createSelector( ... )</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> thirdSelector = createSelector( ... )</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> myComposedSelector = createSelector(</div><div class="line">  firstSelector,</div><div class="line">  secondSelector,</div><div class="line">  thirdSelector,</div><div class="line">  (first, second, third) =&gt; first * second &lt; third</div><div class="line">)</div></pre></td></tr></table></figure></p>
<hr>
<p>å•å…ƒæµ‹è¯•å°±åƒä¸‹é¢è¿™æ ·:<br><strong>test/selectors.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests for the first three selectors...</span></div><div class="line">test(<span class="string">"firstSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"secondSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line">test(<span class="string">"thirdSelector unit test"</span>, () =&gt; &#123; ... &#125;)</div><div class="line"></div><div class="line"><span class="comment">// We have already tested the previous</span></div><div class="line"><span class="comment">// three selector outputs so we can just call `.resultFunc`</span></div><div class="line"><span class="comment">// with the values we want to test directly:</span></div><div class="line">test(<span class="string">"myComposedSelector unit test"</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// here instead of calling selector()</span></div><div class="line">  <span class="comment">// we just call selector.resultFunc()</span></div><div class="line">  assert(selector.resultFunc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="literal">true</span>)</div><div class="line">  assert(selector.resultFunc(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>), <span class="literal">false</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>æœ€å,æ¯ä¸€ä¸ªselectoræœ‰ä¸€ä¸ª<code>resetRecomputations</code>æ–¹æ³•,é‡ç½®recomputationsæ–¹æ³•ä¸º0,è¿™ä¸ªå‚æ•°çš„æ„å›¾æ˜¯åœ¨é¢å¯¹å¤æ‚çš„selectorçš„æ—¶å€™,éœ€è¦å¾ˆå¤šç‹¬ç«‹çš„æµ‹è¯•,ä½ ä¸éœ€è¦ç®¡ç†å¤æ‚çš„æ‰‹å·¥è®¡ç®—,æˆ–è€…ä¸ºæ¯ä¸€ä¸ªæµ‹è¯•åˆ›å»ºâ€å‚»ç“œâ€selector.</p>
<h3 id="Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨"><a href="#Q-Reselectæ€ä¹ˆå’ŒImmutble-jsä¸€èµ·ä½¿ç”¨" class="headerlink" title="Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?"></a>Q:Reselectæ€ä¹ˆå’ŒImmutble.jsä¸€èµ·ä½¿ç”¨?</h3><p>A:<code>creatSelector</code>åˆ›å»ºçš„Selectorsåº”è¯¥å¯ä»¥å’ŒImmutable.jsæ•°æ®ç»“æ„ä¸€èµ·å®Œç¾çš„å·¥ä½œ.<br>å¦‚æœä½ çš„selectoræ­£åœ¨é‡è®¡ç®—,å¹¶ä¸”ä½ è®¤ä¸ºstateæ²¡æœ‰å‘ç”Ÿå˜åŒ–,ä¸€å®šè¦ç¡®ä¿çŸ¥é“å“ªä¸€ä¸ªImmutable.jsæ›´æ–°æ–¹æ³•,è¿™ä¸ªæ–¹æ³•åªè¦ä¸€æ›´æ–°<strong>æ€»æ˜¯</strong>è¿”å›æ–°å¯¹è±¡.å“ªä¸€ä¸ªæ–¹æ³•åªæœ‰<strong>é›†åˆå®é™…å‘ç”Ÿå˜åŒ–çš„æ—¶å€™</strong>æ‰è¿”å›æ–°å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Immutable <span class="keyword">from</span> <span class="string">'immutable'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = Immutable.Map(&#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"> <span class="comment">// set, merge and others only return a new obj when update changes collection</span></div><div class="line"><span class="keyword">let</span> newMap = myMap.set(<span class="string">'a'</span>, <span class="number">1</span>)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line">newMap = myMap.merge(&#123; <span class="string">'a'</span>, <span class="number">1</span> &#125;)</div><div class="line">assert.equal(myMap, newMap)</div><div class="line"><span class="comment">// map, reduce, filter and others always return a new obj</span></div><div class="line">newMap = myMap.map(<span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">1</span>)</div><div class="line">assert.notEqual(myMap, newMap)</div></pre></td></tr></table></figure>
<hr>
<p>å¦‚æœä¸€ä¸ªæ“ä½œå¯¼è‡´çš„selectoræ›´æ–°æ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,å¯èƒ½ä¼šå‘ç”Ÿä¸å¿…è¦çš„é‡è®¡ç®—.<a href="#q-why-is-my-selector-recomputing-when-the-input-state-stays-the-same">çœ‹è¿™é‡Œ</a>.è¿™æ˜¯ä¸€ä¸ªå…³äºprosçš„è®¨è®º,ä½¿ç”¨æ·±å…¨ç­‰äºæ¥æ£€æµ‹ä¾‹å¦‚<code>immutable.js</code>æ¥å‡å°‘ä¸å¿…è¦çš„é‡è®¡ç®—è¿‡ç¨‹.</p>
<h3 id="Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"><a href="#Q-å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ" class="headerlink" title="Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ"></a>Q:å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«selectorå—ï¼Ÿ</h3><p>A: ä½¿ç”¨<code>createSelector</code>åˆ›å»ºçš„Selectorçš„ç¼“å­˜çš„å¤§å°åªæœ‰1.è¿™ä¸ªè®¾å®šä½¿å¾—å¤šä¸ªç»„ä»¶çš„å®ä¾‹ä¹‹é—´çš„å‚æ•°ä¸åŒ,è·¨ç»„ä»¶å…±äº«selectorå˜å¾—ä¸åˆé€‚.è¿™é‡Œä¹Ÿæœ‰å‡ ç§åŠæ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜:</p>
<ul>
<li>ä½¿ç”¨å·¥ç¨‹å‡½æ•°æ–¹æ³•,ä¸ºæ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹åˆ›å»ºä¸€ä¸ªæ–°çš„selector.è¿™é‡Œæœ‰ä¸€ä¸ªå†…å»ºçš„å·¥å‚æ–¹æ³•,React Redux v4.3æˆ–è€…æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨. <a href="#sharing-selectors-with-props-across-multiple-components">çœ‹è¿™é‡Œ</a></li>
<li>åˆ›å»ºä¸€ä¸ªç¼“å­˜å°ºå¯¸å¤§äº1çš„å®šåˆ¶selector.</li>
</ul>
<h3 id="Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"><a href="#Q-æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ" class="headerlink" title="Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ"></a>Q:æœ‰TypeScriptçš„ç±»å‹å—ï¼Ÿ</h3><p>A: æ˜¯çš„ï¼ä»–ä»¬åŒ…å«åœ¨<code>package.json</code>é‡Œ.å¯ä»¥å¾ˆå¥½çš„å·¥ä½œ.</p>
<h3 id="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector"><a href="#Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector" class="headerlink" title="Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–selector?"></a>Qï¼šæ€ä¹ˆæ„å»ºä¸€ä¸ª<a href="https://github.com/hemanth/functional-programming-jargon#currying" target="_blank" rel="external">æŸ¯é‡ŒåŒ–</a>selector?</h3><p>Aï¼šå°è¯•ä¸€äº›è¿™é‡Œ<a href="https://github.com/reactjs/reselect/issues/159#issuecomment-238724788" target="_blank" rel="external">åŠ©æ‰‹å‡½æ•°</a>,ç”±<a href="https://github.com/MattSPalmer" target="_blank" rel="external">MattSPalmer</a>æä¾›</p>
<h2 id="æœ‰å…³çš„é¡¹ç›®"><a href="#æœ‰å…³çš„é¡¹ç›®" class="headerlink" title="æœ‰å…³çš„é¡¹ç›®"></a>æœ‰å…³çš„é¡¹ç›®</h2><h3 id="reselect-map"><a href="#reselect-map" class="headerlink" title="reselect-map"></a><a href="https://github.com/HeyImAlex/reselect-map" target="_blank" rel="external">reselect-map</a></h3><p>å› ä¸ºReselectä¸å¯èƒ½ä¿è¯ç¼“å­˜ä½ æ‰€æœ‰çš„éœ€æ±‚,åœ¨åš<strong>éå¸¸æ˜‚è´µçš„è®¡ç®—</strong>çš„æ—¶å€™,è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæœ‰ç”¨.æŸ¥çœ‹ä¸€ä¸‹reselect-maps readme</p>
<p><strong>reselect-mapçš„ä¼˜åŒ–æªæ–½ä»…ä»…ä½¿ç”¨åœ¨ä¸€äº›å°çš„æ¡ˆä¾‹ä¸­,å¦‚æœä½ ä¸ç¡®å®šæ˜¯ä¸æ˜¯éœ€è¦ä»–,å°±ä¸è¦ä½¿ç”¨å®ƒ</strong>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>MIT</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘|Redux Persist]]></title>
      <url>http://yoursite.com/2017/03/08/translate%7Credux-persist/</url>
      <content type="html"><![CDATA[<p>Redux Persist<br>æŒä¹…åŒ–å’Œè„±æ°´ä¸€ä¸ªredux store<br>Redux Persistæ˜¯æ€§èƒ½å¥½,å®¹æ˜“å®æ–½,å®¹æ˜“æ‰©å±•</p>
<p><code>npm i - -save redux-persist</code></p>
<p><a href="https://travis-ci.org/rt2zz/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/travis/rt2zz/redux-persist/master.svg?style=flat-square" alt="build status"></a><br><a href="https://www.npmjs.com/package/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-persist.svg?style=flat-square" alt="npm version"></a><br><a href="https://www.npmjs.com/package/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/npm/dm/redux-persist.svg?style=flat-square" alt="npm downloads"></a></p>
<h2 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h2><p>åŸºæœ¬ä½¿ç”¨æ–¹æ³•è¦åœ¨ä¼ ç»Ÿçš„reduxä¸­æ·»åŠ ä»£ç :<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123;compose, applyMiddleware, createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> &#123;persistStore, autoRehydrate&#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"></div><div class="line"><span class="comment">// add `autoRehydrate` as an enhancer to your store </span></div><div class="line">(note: <span class="string">`autoRehydrate`</span> is not a middleware)</div><div class="line"><span class="comment">//æ·»åŠ `autoRehydrateåˆ°store`,ä¸æ˜¯ä¸­é—´ä»¶</span></div><div class="line"><span class="keyword">const</span> store = createStore(</div><div class="line">  reducer,</div><div class="line">  <span class="literal">undefined</span>,</div><div class="line">  compose(</div><div class="line">    applyMiddleware(...),</div><div class="line">    autoRehydrate()</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// begin periodically persisting the store</span></div><div class="line"><span class="comment">//å‘¨æœŸæ€§çš„æŒä¹…åŒ–store</span></div><div class="line">persistStore(store)</div></pre></td></tr></table></figure></p>
<hr>
<p>å¦‚æœä¸ºæ¯ä¸€ä¸ªreducerè®¾è®¡ rehydraretionçš„é€»è¾‘,éœ€è¦åœ¨reducerä¸­æ·»åŠ å¥æŸ„<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;REHYDRATE&#125; <span class="keyword">from</span> <span class="string">'redux-persist/constants'</span></div><div class="line"><span class="comment">//...</span></div><div class="line"><span class="keyword">case</span> REHYDRATE:</div><div class="line">  <span class="keyword">var</span> incoming = action.payload.myReducer</div><div class="line">  <span class="keyword">if</span> (incoming) <span class="keyword">return</span> &#123;...state, ...incoming, <span class="attr">specialKey</span>: processSpecial(incoming.specialKey)&#125;</div><div class="line">  <span class="keyword">return</span> state</div></pre></td></tr></table></figure></p>
<hr>
<p>ä¹Ÿå¯ä»¥é…ç½®ä¸€ä¸ªæŒä¹…åŒ–å±‚,æˆ–è€…åœ¨è„±æ°´å®Œæˆåæ¥å—ä¸€ä¸ªaction<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">persistStore(store, &#123;<span class="attr">blacklist</span>: [<span class="string">'someTransientReducer'</span>]&#125;, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'rehydration complete'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<hr>
<p>å¦‚æœäº‹æƒ…å˜ç³Ÿ,åªéœ€è¦æ¸…æ´—ä¸€ä¸‹å­˜å‚¨:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">persistStore(store, config, callback).purge()</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><h4 id="persistStore-store-config-callback"><a href="#persistStore-store-config-callback" class="headerlink" title="persistStore(store,[config,callback])"></a><code>persistStore(store,[config,callback])</code></h4><ul>
<li>å‚æ•°<ul>
<li></li>
</ul>
</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascript-Thiså…¨é¢è§£æ]]></title>
      <url>http://yoursite.com/2017/03/08/javascript-This%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2044710-9f870a42dbc62877.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/200" alt="cover.jpg"><br>ã€Šä½ ä¸çŸ¥é“çš„javascriptã€‹è¿™æœ¬ä¹¦è¯»äº†æœ‰å¥½å‡ éäº†ï¼Œä¼¼ä¹æ¯ä¸€æ¬¡è¯»éƒ½æœ‰æ–°å‘ç°ï¼Œæœ‰äº›å†…å®¹å¹¶ä¸æ˜¯ä¸€ä¸‹å­å¯ä»¥å¼„æ‡‚çš„ï¼Œæ¯æ¬¡è¯»ä¼¼ä¹éƒ½èƒ½æ˜ç™½ä¸€äº›æ¦‚å¿µã€‚<br>å†é‡è¯»ä¸€ä¸‹<code>this</code>å…³é”®å­—ã€‚è¿™ä¸ªæ¦‚å¿µéå¸¸çµæ´»ï¼Œä¹Ÿéå¸¸éš¾æŒæ¡ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ç»å¸¸è¯»è¯»æ²¡æœ‰åå¤„ã€‚æœŸå¾…javascriptä¸€æ¡¶æ±Ÿæ¹–ï¼Œè¿™æ ·å­¦ä¹ çš„æˆæœ¬å°±ä½å•¦ï¼<br>å‚è€ƒæœ¬ä¹¦çš„ç¬¬äºŒéƒ¨åˆ†çš„ç¬¬ä¸€ç« ï¼Œç¬¬äºŒç« ã€‚</p>
<blockquote>
<p>thiså…³é”®å­—æ˜¯jsä¸­æœ€æœ€å¤æ‚çš„æœºåˆ¶ä¹‹ä¸€ã€‚ä»–è¢«è‡ªåŠ¨å®šä¹‰åˆ°æ‰€æœ‰å‡½æ•°çš„ä½œç”¨åŸŸä¸­ã€‚</p>
</blockquote>
<p>åœ¨å­¦ä¹ è¿™ä¸ªå…³é”®å­—çš„è¿‡ç¨‹ä¸­ä¼¼ä¹ä¹Ÿèµ°äº†å¾ˆé•¿æ—¶é—´çš„å¼¯è·¯ã€‚ä½ è¦é—®æˆ‘ä¸ºä»€ä¹ˆèµ°äº†å¾ˆé•¿æ—¶é—´çš„å¼¯è·¯ï¼Œå…³é”®çš„åœ°æ–¹è¿˜æ˜¯æ²¡æœ‰å¯¹æ ¸å¿ƒçš„æ¦‚å¿µå½»åº•å­¦ä¹ å’Œé¢†ä¼šï¼Œè¿™ä¸€ç‚¹å’Œå°å­¦ç”Ÿå­¦ä¹ æ–°çŸ¥è¯†æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚è¦æƒ³æŒæ¡thisè¿™ä¸ªå…³é”®å­—ï¼Œéœ€è¦ç´§æ‰£å…³é”®æ¦‚å¿µï¼Œä¸è¦å‡­ç©ºæƒ³è±¡è¿™åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚</p>
<p><strong>å…³é”®æ¦‚å¿µï¼šjsä¸­çš„å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œä¸€å®šï¼Œä¸€å®šï¼Œä¸€å®šä¼šç»‘å®šåœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œåœ¨åˆ†æthiså…³é”®å­—çš„æ—¶å€™ï¼Œä¸€å®šè¦çŸ¥é“å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™è¿™ä¸ªå¯¹è±¡åˆ°åº•æ˜¯è°ï¼Ÿ</strong>ã€‚<br><strong>åˆ‡è®°ï¼šjsä¸­å‡½æ•°çš„è°ƒç”¨å’Œå®šä¹‰æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ï¼Œå‡½æ•°æ‰€ç»‘å®šçš„å¯¹è±¡ç›´åˆ°ä»–è¢«è°ƒç”¨çš„æ—¶å€™æ‰èƒ½çŸ¥é“ã€‚</strong></p>
<p>thiså…³é”®å­—çš„ä¸ç¡®å®šå®šæ˜¯æŠŠåŒåˆƒå‰‘ï¼Œä¸€æ˜¯å‡½æ•°è°ƒç”¨æ—¶çš„å¯¹è±¡ä¸ç¡®å®šæ€§ï¼Œæ˜¯jsä¸­å‡½æ•°çš„ä½¿ç”¨å…·æœ‰å¾ˆå¤§çµæ´»æ€§ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥å€Ÿç”¨å…¶ä»–å‡½æ•°æ¥å®ŒæˆåŠŸèƒ½ã€‚äºŒæ˜¯è¿™ä¹Ÿé€ æˆäº†thiså­¦ä¹ çš„ä¸€äº›å›°æ‰°ã€‚æ‰€ä»¥åœ¨å­¦ä¹ çš„æ—¶å€™å…ˆè¦ç†è§£thiså…³é”®å­—çš„ä¼˜ç‚¹ï¼Œç„¶åå†å»å­¦ä¹ é€ æˆå›°æ‰°çš„åœ°æ–¹</p>
<p>é¦–å…ˆçœ‹çœ‹ç¬¬ä¸€æ®µä»£ç <br>page 75<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ³¨æ„åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æœªè°ƒç”¨ï¼Œè¿™æ—¶å€™å‡½æ•°æ˜¯æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">identify</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.name.toUpperCase();</div><div class="line">&#125;</div><div class="line"><span class="comment">//åŒä¸Šé¢çš„å‡½æ•°,ä½†æ˜¯è¿™ä¸ªå‡½æ•°å†…éƒ¨æœ‰ç‚¹å¤æ‚ï¼Œå¦‚æœä¸‹é¢çš„ä»£ç çœ‹ä¸æ‡‚</span></div><div class="line"><span class="comment">//å¯ä»¥åªçœ‹ä¸Šé¢çš„å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> greeting = <span class="string">"Hello, I'm "</span> + identify.call( <span class="keyword">this</span> );</div><div class="line">	<span class="built_in">console</span>.log( greeting );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> me = &#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå­—é¢é‡å¯¹è±¡</span></div><div class="line">	name: <span class="string">"Kyle"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> you = &#123;<span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå­—é¢é‡å¯¹è±¡</span></div><div class="line">	name: <span class="string">"Reader"</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">//é€šè¿‡callæ–¹å¼æŠŠå‡½æ•°identifyåˆ†åˆ«ç»‘å®šåˆ°ä¸¤ä¸ªå¯¹è±¡ä¸Š</span></div><div class="line"><span class="comment">//è¿™æ—¶çš„thisæ˜¯æŒ‡å‘meå¯¹è±¡ï¼Œå’Œyouå¯¹è±¡</span></div><div class="line">identify.call( me ); <span class="comment">// KYLE  </span></div><div class="line">identify.call( you ); <span class="comment">// READER</span></div><div class="line"></div><div class="line"><span class="comment">//é€šè¿‡callæ–¹å¼æŠŠå‡½æ•°callåˆ†åˆ«ç»‘å®šåˆ°ä¸¤ä¸ªå¯¹è±¡ä¸Š</span></div><div class="line"><span class="comment">//è¿™æ—¶çš„thisæ˜¯æŒ‡å‘meå¯¹è±¡ï¼Œå’Œyouå¯¹è±¡</span></div><div class="line">speak.call( me ); <span class="comment">// Hello, I'm KYLE</span></div><div class="line">speak.call( you ); <span class="comment">// Hello, I'm READER</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>åœ¨javascriptä¸­å®šä¹‰å‡½æ•°çš„æ—¶å€™ï¼Œå‡½æ•°æ˜¯ä¸å±äºä»»ä½•å¯¹è±¡çš„ã€‚è¿™ä¸€ç‚¹éå¸¸çš„å…³é”®ï¼Œéå¸¸çš„å…³é”®ï¼Œéå¸¸çš„å…³é”®ã€‚è¿™æ˜¯ç†è§£thiså…³é”®å­—çš„ç¬¬ä¸€ä¸ªéšœç¢ã€‚</p>
</blockquote>
<p>thiså…³é”®å­—åœ¨jså‡½æ•°å®šä¹‰çš„æ—¶å€™çš„ä¸ç¡®å®šæ€§ä½¿å¾—jså‡½æ•°ä½¿ç”¨æœ‰æå¤§çš„çµæ´»æ€§ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ä»–ã€‚</p>
<p>###thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>thisçš„ç»‘å®šå’Œå‡½æ•°å®šä¹‰çš„ä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåª<code>å–å†³äºå‡½æ•°è°ƒç”¨çš„æ–¹å¼</code>.<br>javascriptä¸­å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ´»åŠ¨è®°å½•(æœ‰æ—¶ä¹Ÿç§°ä¸Šä¸‹æ–‡)ã€‚è¿™ä¸ªè®°å½•åŒ…æ‹¬å‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼Œå‡½æ•°çš„è°ƒç”¨æ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ã€‚thiså°±æ˜¯è®°å½•ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚</p>
<p>è¿™æ ·åœ¨å­¦ä¹ javascriptå…³é”®å­—çš„<code>é¦–è¦é—®é¢˜æ˜¯è¦è§£å†³æ€ä¹ˆçŸ¥é“åˆ°å‡½æ•°çš„è°ƒç”¨ä½ç½®</code>.</p>
<p>###jså¯¹è±¡ç»‘å®šè§„åˆ™</p>
<p>æ¯ä¸ªjså‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ä¸€å®šè¦æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>ç»‘å®š</code>ä»¥åæ‰èƒ½ä½¿ç”¨ã€‚ è¿™é‡Œæ˜¯ç†è§£äº†jså‡½æ•°çš„å®šä¹‰å’Œè°ƒç”¨çš„åŒºåˆ«ä»¥åéœ€è¦æŒæ¡çš„ä¸€ä¸ªè§„æ¨¡æœ€åºå¤§çš„æ¦‚å¿µï¼Œåœ¨jsä¸­ä¸€å…±æœ‰å››ç§ç»‘å®šæ–¹å¼.å°±æˆ‘ä¸ªäººæ¥çœ‹ï¼Œç»‘å®šè§„åˆ™å¹¶ä¸éš¾ï¼Œ<code>éš¾ç‚¹è¿˜æ˜¯åœ¨jsçš„å‡½æ•°ä½œç”¨åŸŸçš„ç†è§£</code>. å°¤å…¶æ˜¯<code>é»˜è®¤ç»‘å®š</code>.è¿™ä¸ªç»‘å®šæ–¹å¼æœ‰æå¤§çš„è¿·æƒ‘æ€§ã€‚</p>
<p>####é»˜è®¤ç»‘å®š<br>è¿™ä¸ªæ˜¯å‡½æ•°çš„ç‹¬ç«‹è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°ç›´æ¥è°ƒç”¨çš„æ—¶å€™ï¼Œä¼¼ä¹æ˜¯æ²¡æœ‰ç»‘å®šåˆ°å¯¹è±¡ä¸Šçš„ï¼Œä½†æ˜¯æ ¹æ®å‰é¢çš„ä»‹ç»ï¼Œjsä¸­å‡½æ•°è°ƒç”¨æ—¶å¿…é¡»è¦ç»‘å®šåˆ°ä¸€ä¸ªå¯¹è±¡ä¸Šã€‚<br>çœ‹ä¸‹é¢ä»£ç  page 83<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">//è¿™æ˜¯å‡½æ•°çš„å®šä¹‰ä½ç½®</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;<span class="comment">//è¿™ä¸ªå˜é‡å®šä¹‰çš„å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä»…ä»…æ˜¯èµ‹å€¼ç»™aå—ï¼Ÿ</span></div><div class="line"></div><div class="line">  foo(); <span class="comment">// 2  //è¿™æ˜¯å‡½æ•°çš„è°ƒç”¨ä½ç½®ã€‚ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡º2å‘¢ï¼Ÿ</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>å¾ˆå¤šå‡½æ•°éƒ½æ˜¯è¿™ä¹ˆè°ƒç”¨çš„ï¼Œç…§çŒ«ç”»è™ä¹Ÿå¯ä»¥å†™å‡ºæ¥ï¼Œä½†æ˜¯ç†è§£äº†å…·ä½“çš„å«ä¹‰å°±ä¸ä¸€æ ·äº†ã€‚<br>fooè¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸä¸­(windowä½œç”¨åŸŸä¸­)ï¼Œå·§åˆçš„æ˜¯ä»–çš„è°ƒç”¨ä¹Ÿæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæ³¨æ„è¿™ä»…ä»…æ˜¯å·§åˆï¼Œå·§åˆã€‚ é‚£ä¹ˆfoo()è°ƒç”¨çš„æ—¶å€™ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡ºå˜é‡ açš„å€¼å‘¢ï¼Ÿå°½ç®¡ä½¿ç”¨äº†varè¿™ä¸ªå…³é”®å­—ï¼Œä½†æ˜¯åˆ†æä½œç”¨åŸŸå¯ä»¥çŸ¥é“ï¼Œaè¿™ä¸ªå˜é‡å®é™…æ˜¯å…¨å±€å˜é‡ï¼Œè¯´çš„å†æ˜ç™½ä¸€ç‚¹ï¼Œaå®é™…æ˜¯windowè¿™ä¸ªå…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œ2æ˜¯è¿™ä¸ªå±æ€§çš„å±æ€§å€¼ã€‚<br>foo()è°ƒç”¨çš„æ—¶å€™æ˜¯ä¸€ä¸ä¸æŒ‚çš„å…¨è£¸çŠ¶æ€ï¼Œä»…ä»…æ˜¯å‡½æ•°æœ¬èº«ï¼Œæ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™ä»–ä¹Ÿæ²¡æœ‰ä»»ä½•å‡½æ•°åŒ…è£¹ï¼Œå¤„åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹é¢ï¼Œæ‰€ä»¥foo()é‡Œé¢çš„thisæ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡çš„ï¼Œå½“è¦æ‰“å°this.açš„æ—¶å€™ï¼Œå¯»æ‰¾foo()è°ƒç”¨ä½ç½®ä¼šæ‰¾åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ‰¾å…¨å±€ä½œç”¨åŸŸçš„å±æ€§this.açš„æ—¶å€™ä¼šæ‰“å°å‡º2è¿™ä¸ªå±æ€§å€¼ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨setTimeout,setIntervalå‡½æ•°çš„æ—¶å€™ï¼Œå®é™…è¿™ä¸¤ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ä¸æŒ‚çš„ï¼ŒåŒæ ·ç»‘å®šåœ¨windowå¯¹è±¡ä¸Šã€‚</p>
<p>####éšå¼ç»‘å®š</p>
<p>å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™è¢«æ·»åŠ äº†ä¿®é¥°ç¬¦ã€‚çœ‹ä¸‹é¢è¿™ä¸ªä»£ç <br>page 85<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">//å®šä¹‰åœ¨å…¨å±€ä½œç”¨ä¸‹çš„å‡½æ•°ï¼Œä»…ä»…æ˜¯å®šä¹‰ï¼Œä¸æ˜¯è°ƒç”¨ä½ç½®</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="comment">//å®šä¹‰ä¸€ä¸ªå¯¹è±¡</span></div><div class="line">	a: <span class="number">2</span>,</div><div class="line">	<span class="attr">foo</span>: foo</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.foo(); <span class="comment">// 2  ç»™foo()å‡½æ•°æ‰¾äº†ä¸€ä¸ªå¯¹è±¡ï¼Œthiså°±æŒ‡å‘è¿™ä¸ªå¯¹è±¡äº†</span></div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼äº†ï¼Œå¦‚æœä¸å†™å‰é¢çš„objæ˜¯ä¸æ˜¯å°±æ˜¯ä¸Šé¢çš„é»˜è®¤ç»‘å®šäº†ï¼Ÿ</p>
<p><code>éšå¼ä¸¢å¤±</code><br>ç»å¸¸åœ¨jsä»£ç çš„åµŒå¥—å›è°ƒå‡½æ•°ä¸­çœ‹åˆ°åœ¨å¤–å±‚å‡½æ•°å¼€å§‹çš„ä¸€å¥ </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span>  that=<span class="keyword">this</span>; <span class="comment">//è¿™æ˜¯ä»€ä¹ˆå«ä¹‰</span></div></pre></td></tr></table></figure>
<p>æˆ–è®¸ä½ å·²ç»ä¼šç”¨äº†ï¼Œä½†æ˜¯ç†è§£äº†å…¶ä¸­æ„ä¹‰ç”¨èµ·æ¥ä¼šæ›´åŠ å¾—å¿ƒåº”æ‰‹å•Š</p>
<p>çœ‹ä¸‹é¢æ®µä»£ç .è¿™æ®µä»£ç å…¶å®ä»¥å‰æˆ‘ä¹Ÿä¸å¤ªç†è§£ï¼Œé—®é¢˜è¿˜æ˜¯æ²¡æœ‰å½»åº•é¢†æ‚Ÿjså‡½æ•°å®šä¹‰å’Œè°ƒç”¨ä¹‹é—´æ˜¯æ²¡æœ‰å…³ç³»çš„è¿™ä¸€ç‚¹ã€‚<br>page 86</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å­—é¢é‡</span></div><div class="line">	a: <span class="number">2</span>,</div><div class="line">	<span class="attr">foo</span>: foo  <span class="comment">//å‡½æ•°ä½œä¸ºå¯¹å¯¹è±¡çš„å±æ€§</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bar = obj.foo; <span class="comment">//æŠŠobjå¯¹è±¡çš„å‡½æ•°fooå±æ€§èµ‹å€¼ç»™barå˜é‡</span></div><div class="line"><span class="comment">//è¿™é‡Œå°±æ˜¯ç†è§£è¿™ä¸ªé—®é¢˜çš„å…³é”®ï¼Œå¦‚æœä½ ç°åœ¨è®¤ä¸ºè°ƒç”¨bar()çš„æ—¶å€™ç»‘å®šçš„å¯¹è±¡</span></div><div class="line"><span class="comment">//æ˜¯objé‚£å°±å®Œå…¨æé”™äº†ã€‚è¿™ä¸ªæ—¶å€™ä»…ä»…æ˜¯æŠŠå‡½æ•°fooèµ‹å€¼ç»™äº†varå˜é‡ï¼Œ</span></div><div class="line"><span class="comment">//å¹¶æ²¡æœ‰æŠŠå¯¹è±¡ä¹Ÿç»™barå˜é‡ï¼Œå› ä¸ºè¿™é‡Œè¿˜ä¸æ˜¯foo()å‡½æ•°çš„è°ƒç”¨ä½ç½®ï¼Œç°åœ¨</span></div><div class="line"><span class="comment">//fooå‡½æ•°è¿˜æ²¡æœ‰ç»‘å®šå¯¹è±¡ï¼Œé‚£ä¹ˆè°ƒç”¨bar()çš„æ—¶å€™å¯¹è±¡åˆ°åº•æ˜¯è°ï¼Ÿä¸çŸ¥é“ã€‚</span></div><div class="line"><span class="comment">//è°ƒç”¨çš„æ—¶å€™æ‰çŸ¥é“ã€‚</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="string">"oops, global"</span>; <span class="comment">// ä»»ç„¶æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§</span></div><div class="line">bar(); <span class="comment">// "oops, global" è¿™é‡Œæ‰§è¡Œçš„æ˜¯é»˜è®¤ç»‘å®šï¼Œthiså°±æ˜¯å»å…¨å±€å¯¹è±¡å•¦</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿™æ®µä»£ç å°±æ˜¯ä½¿ç”¨var that=thisçš„åœºæ™¯<br>åœ¨ä½¿ç”¨å›è°ƒå‡½æ•°çš„æ—¶å€™è¦ç•™å¿ƒã€‚jsä¸­å‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ï¼Œå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¼ å…¥å‡½æ•°ã€‚ é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œäº†ï¼Œå‡½æ•°ä¸€æ—¦ä½œä¸ºå®å‚ä»£æ›¿å½¢å‚çš„æ—¶å€™ï¼Œå®é™…ä¹Ÿæ‰§è¡Œäº†å’Œä¸Šé¢ä»£ç ä¸€æ ·çš„èµ‹å€¼è¿‡ç¨‹ï¼Œå®é™…åªæ˜¯ä¼ é€’äº†å‡½æ•°æœ¬èº«ï¼ŒåŸå…ˆçš„å¯¹è±¡å°±æ²¡æœ‰äº†ã€‚</p>
<p>page 86</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doFoo</span>(<span class="params">fn</span>) </span>&#123; <span class="comment">//fnæ˜¯å½¢å‚</span></div><div class="line">	<span class="comment">// å¦‚æœå‡½æ•°ä½œä¸ºå®å‚ä¼ å…¥ç›¸å½“äºä»£ç  var fn=obj.foo</span></div><div class="line">	<span class="comment">//å’Œä¸Šé¢ä¸€æ®µä»£ç æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œåªæ˜¯å‡½æ•°æœ¬èº«ï¼Œå¹¶æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡</span></div><div class="line"></div><div class="line">	fn(); <span class="comment">// åœ¨è¿™é‡Œè°ƒç”¨çš„æ—¶å€™ï¼Œç”±äºfnåªä»£è¡¨foo()å‡½æ•°ï¼Œè¢«ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šäº†</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">	<span class="attr">a</span>: <span class="number">2</span>,</div><div class="line">	<span class="attr">foo</span>: foo</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="string">"oops, global"</span>; <span class="comment">// `a` also property on global object</span></div><div class="line"></div><div class="line">doFoo( obj.foo ); <span class="comment">// "oops, global"ä¸è¦è¢«obj.fooè¿·æƒ‘äº†</span></div><div class="line"><span class="comment">//æ²¡æœ‰å®é™…æ‰§è¡Œå‡½æ•°çš„è°ƒç”¨ï¼Œæ­¤æ—¶obj.fooä»…ä»…ä»£è¡¨æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡çš„å‡½æ•°</span></div><div class="line"></div><div class="line"><span class="comment">//è¿™ä¸ªä»£ç å—çœ‹ç€çœ¼ç†Ÿä¹ˆï¼Ÿè¿™å°±æ˜¯javascriptä¸­å›è°ƒå‡½æ•°çš„æ ·å­ï¼Œå½“</span></div><div class="line"><span class="comment">//ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›å¦ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™,è¿™ä¸ªå‚æ•°å‡½æ•°å°±æ‰¾ä¸åˆ°è‡ªå·±ç»‘å®šçš„å¯¹è±¡æ˜¯è°äº†ï¼Œ</span></div><div class="line"><span class="comment">//æ‰€ä»¥å°±é»˜è®¤ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šäº†ã€‚ä½†æ˜¯æˆ‘ä»¬æ—¢ç„¶åœ¨ä¸€ä¸ªå‡½æ•°é‡Œè°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œè‚¯å®šæ˜¯è¦ç”¨è¿™ä¸ªå‡½æ•°æ“ä½œå½“å‰çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ—¢ç„¶æ‰¾ä¸åˆ°äº†ï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨ç»™ä»–æŒ‡å®šä¸€ä¸ªå¯¹è±¡å§ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ä½¿ç”¨</span></div><div class="line"><span class="comment">//var  that=thisçš„åŸå› ã€‚æˆ‘è§‰å¾—ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œjsçš„åŠŸåŠ›è‡³å°‘ä¼šå¢åŠ 5%ğŸ˜ã€‚è‡³äºå…·ä½“ä½¿ç”¨ï¼Œæˆ‘æƒ³å†™å‡ºæ¥å…¶å®æ²¡æœ‰ä»€ä¹ˆå¿…è¦äº†ã€‚è¿™æ ·çš„ä»£</span></div><div class="line"><span class="comment">//ç éšå¤„å¯è§.</span></div></pre></td></tr></table></figure>
<p>æœ€åæˆ‘ä»¬ä¼šè¿”å›æ¥çœ‹çœ‹æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>####æ˜¾ç¤ºç»‘å®š</p>
<p>ç›´æ¥ä½¿ç”¨apply()å’Œcall()æ–¹æ³•æ¥ç»™å‡½æ•°æŒ‡å®šä¸€ä¸ªå¯¹è±¡<br>page 88<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;  <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;  <span class="comment">//å¯¹è±¡å­—é¢é‡å®šä¹‰</span></div><div class="line">	a: <span class="number">2</span> </div><div class="line">&#125;;</div><div class="line"></div><div class="line">foo.call( obj ); <span class="comment">// 2  å¼ºåˆ¶ç»‘å®šåˆ°objå¯¹è±¡ä¸Š</span></div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨æ˜¾ç¤ºç»‘å®šè¿˜ä¸èƒ½è§£å†³thisçš„ä¸¢å¤±é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…è£¹å‡½æ•°</p>
<p>page 89</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">something</span>) </span>&#123; <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a, something );</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a + something;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="comment">//å¯¹è±¡å­—é¢é‡</span></div><div class="line">	a: <span class="number">2</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; åŒ…è£¹å‡½æ•°ï¼Œæ˜¾ç¤ºç»‘å®š</div><div class="line">	<span class="keyword">return</span> foo.apply( obj, <span class="built_in">arguments</span> );</div><div class="line"> <span class="comment">//è¿”å›ç»‘å®šäº†å¯¹è±¡å’Œä¼ å…¥å‚æ•°çš„å‡½æ•°è°ƒç”¨</span></div><div class="line"> <span class="comment">//è¿™ä¸ªè¯­å¥åœ¨jsçš„ä»£ç ä¸­éå¸¸çš„å¸¸è§</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = bar( <span class="number">3</span> ); <span class="comment">// 2, 3  </span></div><div class="line"><span class="built_in">console</span>.log( b ); <span class="comment">// 5</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//å¯ä»¥æŠŠç»‘å®šå‡½æ•°ç‹¬ç«‹å‡ºæ¥</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">fn, obj</span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> fn.apply( obj, <span class="built_in">arguments</span> );</div><div class="line">	&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>####new ç»‘å®š</p>
<blockquote>
<p>jsä¸­çš„newå…³é”®å­—å’Œjavaä¸­å®Œå…¨ä¸åŒï¼Œjsä¸­æ²¡æœ‰ç±»ï¼Œåªæœ‰å¯¹è±¡ï¼Œåœ¨jsä¸­ä½¿ç”¨new å…³é”®å­—çš„æ—¶å€™åªæ˜¯è¢«è°ƒç”¨çš„æ™®é€šå‡½æ•°</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>) </span>&#123;  <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	<span class="keyword">this</span>.a = a;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bar = <span class="keyword">new</span> foo( <span class="number">2</span> ); <span class="comment">//ä»…ä»…æ˜¯è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°</span></div><div class="line"><span class="built_in">console</span>.log( bar.a ); <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>å¥½äº†ä»¥ä¸Šå°±æ˜¯js thisç»‘å®šçš„å››ç§æ–¹å¼ã€‚  è§£å†³çš„å…³é”®é—®é¢˜æ˜¯jsä¸­åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™åˆ°åº•æ˜¯å±äºå“ªä¸ªå¯¹è±¡çš„é—®é¢˜ã€‚ </p>
<p>åé¢è¿˜æœ‰ä¸€ç‚¹å†…å®¹ï¼Œä½†æ˜¯ä¸Šé¢çš„å†…å®¹æ˜¯æœ€é‡è¦çš„ã€‚  2017å¹´1æœˆ17æ—¥<br><code>çš„ç¡®åŒ…è£¹å‡½æ•°é‚£é‡Œå¥½åƒæ˜¯æ²¡æœ‰è®²æ¸…æ¥šï¼Œæˆ‘ä¹Ÿå¿˜äº†å½“åˆæ˜¯æ€ä¹ˆç†è§£çš„ï¼Œç­‰æˆ‘å†çœ‹çœ‹ï¼Œç„¶åæ›´æ–°ã€‚æœ‰äº›åœ°æ–¹å·²ç»åšäº†æ›´æ–°!</code></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Redux-awesome]]></title>
      <url>http://yoursite.com/2017/03/08/Awesome%20Redux/</url>
      <content type="html"><![CDATA[<h1 id="Awesome-Redux"><a href="#Awesome-Redux" class="headerlink" title="Awesome Redux "></a>Awesome Redux <a href="https://github.com/sindresorhus/awesome" target="_blank" rel="external"><img src="https://cdn.rawgit.com/sindresorhus/awesome/d7305f38d29fed78fa85652e3a63e154dd8e8829/media/badge.svg" alt="Awesome"></a></h1><blockquote>
<p>List of repositories which use Redux</p>
</blockquote>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a><a href="https://github.com/reactjs/redux" target="_blank" rel="external">Redux</a></h2><h2 id="Documentation-of-Redux"><a href="#Documentation-of-Redux" class="headerlink" title="Documentation of Redux"></a><a href="http://redux.js.org" target="_blank" rel="external">Documentation of Redux</a></h2><h2 id="Documentation-of-Redux-Simple-Chinese-version"><a href="#Documentation-of-Redux-Simple-Chinese-version" class="headerlink" title="Documentation of Redux(Simple Chinese version)"></a><a href="https://github.com/camsong/redux-in-chinese" target="_blank" rel="external">Documentation of Redux(Simple Chinese version)</a></h2><h2 id="Documentation-of-Redux-Russian-version-Work-in-progress"><a href="#Documentation-of-Redux-Russian-version-Work-in-progress" class="headerlink" title="Documentation of Redux(Russian version) (Work in progress)"></a><a href="https://rajdee.gitbooks.io/redux-in-russian/" target="_blank" rel="external">Documentation of Redux(Russian version)</a> (Work in progress)</h2><h2 id="Documentation-of-Redux-Traditional-Chinese-version"><a href="#Documentation-of-Redux-Traditional-Chinese-version" class="headerlink" title="Documentation of Redux(Traditional Chinese version)"></a><a href="http://chentsulin.github.io/redux/index.html" target="_blank" rel="external">Documentation of Redux(Traditional Chinese version)</a></h2><h2 id="Documentation-of-Redux-Japanese-version-Work-in-progress"><a href="#Documentation-of-Redux-Japanese-version-Work-in-progress" class="headerlink" title="Documentation of Redux(Japanese version) (Work in progress)"></a><a href="https://github.com/jposts/redux" target="_blank" rel="external">Documentation of Redux(Japanese version)</a> (Work in progress)</h2><h2 id="Documentation-of-Redux-Portuguese-version-Work-in-progress"><a href="#Documentation-of-Redux-Portuguese-version-Work-in-progress" class="headerlink" title="Documentation of Redux(Portuguese version) (Work in progress)"></a><a href="https://github.com/franzejr/redux-in-portuguese/" target="_blank" rel="external">Documentation of Redux(Portuguese version)</a> (Work in progress)</h2><h2 id="Documentation-of-Redux-Spanish-version-Work-in-progress"><a href="#Documentation-of-Redux-Spanish-version-Work-in-progress" class="headerlink" title="Documentation of Redux(Spanish version) (Work in progress)"></a><a href="https://sergiodxa.gitbooks.io/redux-en-espanol/content/" target="_blank" rel="external">Documentation of Redux(Spanish version)</a> (Work in progress)</h2><h2 id="Documentation-of-Redux-Korean-version"><a href="#Documentation-of-Redux-Korean-version" class="headerlink" title="Documentation of Redux(Korean version)"></a><a href="http://dobbit.github.io/redux/" target="_blank" rel="external">Documentation of Redux(Korean version)</a></h2><h2 id="Documentation-of-Redux-Sinhala-à·ƒà·’à¶‚à·„à¶½-version-Work-in-progress"><a href="#Documentation-of-Redux-Sinhala-à·ƒà·’à¶‚à·„à¶½-version-Work-in-progress" class="headerlink" title="Documentation of Redux(Sinhala|à·ƒà·’à¶‚à·„à¶½ version) (Work in progress)"></a><a href="https://sandaruny.github.io/redux-sin/" target="_blank" rel="external">Documentation of Redux(Sinhala|à·ƒà·’à¶‚à·„à¶½ version)</a> (Work in progress)</h2><blockquote>
<p>Predictable state container for JavaScript apps</p>
</blockquote>
<h2 id="Marks"><a href="#Marks" class="headerlink" title="Marks"></a>Marks</h2><ul>
<li><a href="http://isomorphic.net" target="_blank" rel="external">Universal (Isomorphic)</a> - :metal:</li>
<li><a href="https://github.com/gaearon/react-transform-hmr" target="_blank" rel="external">Hot Reload</a> - :fire:</li>
</ul>
<h3 id="Presentations"><a href="#Presentations" class="headerlink" title="Presentations"></a>Presentations</h3><ul>
<li><a href="https://www.youtube.com/watch?v=d0oUGmSE6IY&amp;list=PLJBrYU54JD2pTblB20OmV7GL6H5J-p2g8" target="_blank" rel="external">Letâ€™s learn React and Redux with Javascriptâ€™s new ES6 syntax, from Beginner to Intermediate to Advanced.</a></li>
<li><a href="https://github.com/chentsulin/redux-intro" target="_blank" rel="external">A introduction about Redux</a></li>
<li><a href="https://speakerdeck.com/chrisui/real-world-redux" target="_blank" rel="external">Real World Redux</a></li>
<li><a href="http://slides.com/omnidan/hor" target="_blank" rel="external">The power of higher-order reducers</a></li>
<li><a href="http://slides.com/evanschultz-1/reactive-angular" target="_blank" rel="external">Reactive Architecture with Redux and Angular</a></li>
<li><a href="http://slides.com/vladimirnovick/reduxinternals" target="_blank" rel="external">Redux Internals</a></li>
<li><a href="http://slides.com/scottprue-2/deck" target="_blank" rel="external">Replacing Angular 1 with React and Redux</a></li>
<li><a href="http://slides.com/cguedes/a-tour-on-react-ecosystem" target="_blank" rel="external">A tour on the React ecosystem</a></li>
<li><a href="http://slides.com/jenyaterpil/redux-from-twitter-hype-to-production#/" target="_blank" rel="external">Redux from Twitter hype to production</a></li>
</ul>
<hr>
<h3 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h3><ul>
<li><a href="https://github.com/redux-effects" target="_blank" rel="external">Many tools and middlewares</a></li>
<li><a href="https://github.com/paulwittmann/redux-offline-docs" target="_blank" rel="external">Redux offline docs</a></li>
<li><a href="https://github.com/staltz/flux-challenge" target="_blank" rel="external">Flux challenge</a></li>
<li><a href="https://github.com/andrewngu/sound-redux" target="_blank" rel="external">Sound Redux - a simple Soundcloud client</a></li>
<li><a href="https://github.com/rwieruch/favesound-redux" target="_blank" rel="external">Favesound Redux - SoundCloud Client for Artists</a></li>
<li><a href="https://github.com/ipselon/structor" target="_blank" rel="external">Structor - a user interface builder for React</a></li>
<li><a href="https://github.com/banderson/generator-redux" target="_blank" rel="external">generator-redux - CLI tools for Redux: next-gen functional Flux/React with devtools</a></li>
<li><a href="https://github.com/Jackong/generator-reactapp" target="_blank" rel="external">generator-reactapp - Yeoman generator for react app with redux</a></li>
<li><a href="http://rekit.js.org" target="_blank" rel="external">Rekit - Toolkit for building scalable web apps with React, Redux and React-router</a></li>
<li><a href="https://github.com/FormidableLabs/spectacle" target="_blank" rel="external">Spectacle - ReactJS based Presentation Library</a></li>
<li><a href="https://github.com/tayiorbeii/egghead.io_redux_course_notes" target="_blank" rel="external">Notes (and partial transcription) of Dan Abramovâ€™s Redux course videos on http://egghead.io</a></li>
<li><a href="https://github.com/dwyl/learn-redux" target="_blank" rel="external">Comprehensive Notes for Learning (how to use) Redux to manage state in your Web/Mobile Apps</a></li>
<li><a href="https://maxfarseer.gitbooks.io/redux-course-ru/content/" target="_blank" rel="external">React Redux [RU tutorial]</a></li>
<li><a href="https://tonyhb.gitbooks.io/redux-without-profanity/content/index.html" target="_blank" rel="external">Redux without profanity</a></li>
<li><a href="https://medium.com/@sapegin/react-and-redux-single-page-applications-resources-22cd859b0c1d#.o66rolp0p" target="_blank" rel="external">React and Redux Single Page Applications Resources</a></li>
<li><a href="https://github.com/markerikson/redux-ecosystem-links" target="_blank" rel="external">A categorized list of Redux-related addons, libraries, and utilities</a></li>
<li><a href="http://makeitopen.com/tutorials/building-the-f8-app/planning/" target="_blank" rel="external">Building the F8 2016 App (Redux, GraphQL, React Native)</a></li>
<li><a href="https://github.com/salsita/redux-elm" target="_blank" rel="external">The Elm Architecture in JavaScript</a></li>
</ul>
<hr>
<h3 id="Articles-And-Tutorials"><a href="#Articles-And-Tutorials" class="headerlink" title="Articles And Tutorials"></a>Articles And Tutorials</h3><ul>
<li><a href="https://app.pluralsight.com/library/courses/react-redux-react-router-es6" target="_blank" rel="external">Building Applications with React and Redux in ES6 on Pluralsight</a></li>
<li><a href="http://davidandsuzi.com/writing-a-basic-app-in-redux" target="_blank" rel="external">Writing a Basic App in Redux</a></li>
<li><a href="https://github.com/happypoulp/redux-tutorial" target="_blank" rel="external">Learn how to use Redux step by step</a></li>
<li><a href="https://medium.com/@bananaoomarang/handcrafting-an-isomorphic-redux-application-with-love-40ada4468af4" target="_blank" rel="external">Tutorial: Handcrafting an Isomorphic Redux Application (With Love)</a></li>
<li><a href="http://www.jchapron.com/2015/08/14/getting-started-with-redux" target="_blank" rel="external">0 to 1 : Getting started with Redux</a></li>
<li><a href="https://github.com/camsong/redux-in-chinese" target="_blank" rel="external">Redux Chinese Document</a></li>
<li><a href="https://github.com/chentsulin/redux" target="_blank" rel="external">Redux Document (Traditional Chinese)</a></li>
<li><a href="https://medium.com/@cpojer/relay-and-routing-36b5439bad9" target="_blank" rel="external">Relay and Routing</a></li>
<li><a href="https://medium.com/@meagle/understanding-87566abcfb7a" target="_blank" rel="external">Understanding Redux Middleware</a></li>
<li><a href="https://www.livecoding.tv/ekosz/videos" target="_blank" rel="external">Several videos about Redux + Falcor</a> and <a href="https://github.com/ekosz/postcard-sender" target="_blank" rel="external">Example code</a></li>
<li><a href="http://briantroncone.com/?p=529" target="_blank" rel="external">Redux Middleware: Behind the Scenes</a></li>
<li><a href="https://github.com/erikras/ducks-modular-redux" target="_blank" rel="external">A proposal for bundling reducers, action types and actions when using Redux</a></li>
<li><a href="http://teropa.info/blog/2015/09/10/full-stack-redux-tutorial.html" target="_blank" rel="external">Full-Stack Redux Tutorial - A Comprehensive Guide to Test-First Development with Redux, React, and Immutable</a> Source <a href="https://github.com/teropa/redux-voting-server" target="_blank" rel="external">Server</a> + <a href="https://github.com/teropa/redux-voting-client" target="_blank" rel="external">Client</a></li>
<li><a href="https://medium.com/lexical-labs-engineering/redux-best-practices-64d59775802e" target="_blank" rel="external">Redux best practices</a></li>
<li><a href="http://blog.workshape.io/the-3ree-stack-react-redux-rethinkdb-express-js" target="_blank" rel="external">The 3REE Stack: React + Redux + RethinkDB + Express.js</a></li>
<li><a href="http://engineering.wework.com/process/2015/10/01/react-reflux-to-redux" target="_blank" rel="external">React Tutorial - Converting Reflux to Redux</a></li>
<li><a href="https://github.com/yildizberkay/redux-example" target="_blank" rel="external">Redux example using 500px API (with ES6)</a></li>
<li><a href="http://blog.joanboixados.com/building-a-boilerplate-for-a-koa-redux-react-application-including-webpack-mocha-and-sass/" target="_blank" rel="external">Building a boilerplate for a Koa, Redux, React application including Webpack, Mocha and SASS</a> - This article explains in detail how <a href="https://github.com/mezod/boilerplate-koa-redux-react" target="_blank" rel="external">this koa-redux-react-boilerplate</a> was built and the technologies it uses.</li>
<li><a href="http://jaysoo.ca/2015/09/26/typed-react-and-redux" target="_blank" rel="external">Typed React and Redux</a></li>
<li><a href="https://code-cartoons.com/a-cartoon-intro-to-redux-3afb775501a6#.8k7536uqu" target="_blank" rel="external">A cartoon intro to Redux</a></li>
<li><a href="http://jamesknelson.com/join-the-dark-side-of-the-flux-responding-to-actions-with-actors" target="_blank" rel="external">Join The Dark Side Of The Flux: Responding to Actions with Actors</a></li>
<li><a href="http://jamesknelson.com/can-i-dispatch-multiple-actions-from-redux-action-creators" target="_blank" rel="external">Can I dispatch multiple actions from Redux action creators?</a></li>
<li><a href="http://www.youhavetolearncomputers.com/blog/2015/9/15/a-conceptual-overview-of-redux-or-how-i-fell-in-love-with-a-javascript-state-container" target="_blank" rel="external">Understanding Redux (or, How I Fell in Love with a JavaScript State Container)</a></li>
<li><a href="http://reactjsnews.com/your-first-redux-app" target="_blank" rel="external">Your First Immutable React &amp; Redux App</a></li>
<li><a href="https://egghead.io/series/getting-started-with-redux" target="_blank" rel="external">Getting Started with Redux - Eggheadâ€™s video lessons from Dan Abramov</a></li>
<li><a href="https://egghead.io/series/react-testing-cookbook" target="_blank" rel="external">Redux Testing Video Lessons - a few short Egghead video lessons (some free, some require a subscription)</a></li>
<li><a href="https://medium.com/@dorsha/implement-login-modal-with-redux-reselect-and-reactjs-668c468bcbe3#.lnwisap8c" target="_blank" rel="external">Implementing a smart Login Modal with Redux, reselect and ReactJS</a></li>
<li><a href="http://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js" target="_blank" rel="external">How to Build a Todo App Using React, Redux, and Immutable.js</a></li>
<li><a href="https://voice.kadira.io/rethinking-redux-f1e96daba60c#.hp5v516ie" target="_blank" rel="external">Rethinking Redux</a></li>
<li><a href="http://jaysoo.ca/2016/01/03/managing-processes-in-redux-using-sagas" target="_blank" rel="external">Managing Side Effects In React + Redux Using Sagas</a></li>
<li><a href="https://auth0.com/blog/2016/01/04/secure-your-react-and-redux-app-with-jwt-authentication" target="_blank" rel="external">Secure Your React and Redux App with JWT Authentication</a></li>
<li><a href="https://medium.com/@thisbejim/getting-started-with-redux-and-graphql-8384b3b25c56#.3anuh1m7x" target="_blank" rel="external">Getting started with Redux and GraphQL</a></li>
<li><a href="http://www.sitepoint.com/data-flows-angular-2-redux" target="_blank" rel="external">Data Flows with Angular 2 and Redux</a></li>
<li><a href="http://jamesknelson.com/simple-routing-redux-react" target="_blank" rel="external">Simple Routing with Redux and React</a></li>
<li><a href="https://riadbenguella.com/2015/12/28/redux-nowadays-from-actions-creators-to-sagas/" target="_blank" rel="external">Redux nowadays : From actions creators to sagas</a></li>
<li><a href="http://konkle.us/master-complex-redux-workflows-with-sagas" target="_blank" rel="external">Master Complex Redux Workflows with Sagas</a></li>
<li><a href="http://blog.jhades.org/angular-2-application-architecture-building-flux-like-apps-using-redux-and-immutable-js-js" target="_blank" rel="external">Angular 2 Application Architecture - Building Flux Apps with Redux and Immutable.js</a></li>
<li><a href="http://www.toptal.com/react/react-redux-and-immutablejs" target="_blank" rel="external">React, Redux and Immutable.js: Ingredients for Efficient Web Applications</a></li>
<li><a href="https://shellmonger.com/2016/02/16/an-introduction-to-react-redux-part-1" target="_blank" rel="external">An Introduction to React Redux (Part 1)</a></li>
<li><a href="https://shellmonger.com/2016/02/19/an-introduction-to-react-redux-part-2" target="_blank" rel="external">An Introduction to React Redux (Part 2)</a></li>
<li><a href="http://jaysoo.ca/2016/02/28/organizing-redux-application" target="_blank" rel="external">Rules For Structuring (Redux) Applications</a></li>
<li><a href="http://toranbillups.com/blog/archive/2016/01/22/redux-for-the-very-beginner" target="_blank" rel="external">Redux for the very beginner</a></li>
<li><a href="http://www.zohaib.me/redux-call-service-async/" target="_blank" rel="external">Redux - Calling web service asynchronously</a></li>
<li><a href="http://swizec.com/blog/animating-with-react-redux-and-d3/swizec/6775" target="_blank" rel="external">Animating with React, Redux, and d3</a></li>
<li><a href="http://joelhooks.com/blog/2016/03/20/build-an-image-gallery-using-redux-saga/" target="_blank" rel="external">Build an Image Gallery Using React, Redux and redux-saga</a></li>
<li><a href="https://medium.com/@matt.krick/introducing-redux-operations-332ab56e468b#.7e30nsxne" target="_blank" rel="external">Introducing redux-operations</a></li>
<li><a href="https://medium.com/@matt.krick/solving-redux-s-shortcoming-in-150-locs-540979ce6cf9#.sw0s478j6" target="_blank" rel="external">Solving Reduxâ€™s shortcoming in 150 LOCs</a></li>
<li><a href="https://medium.com/@rajaraodv/the-anatomy-of-a-react-redux-app-759282368c5a#.h05vq2uaj" target="_blank" rel="external">The Anatomy Of A React Redux App</a></li>
<li><a href="http://www.theodo.fr/blog/2016/03/getting-started-with-react-redux-and-immutable-a-test-driven-tutorial-part-2/" target="_blank" rel="external">Getting Started with React, Redux and Immutable: a Test-Driven Tutorial (Part 2)</a></li>
<li><a href="https://css-tricks.com/learning-react-redux/" target="_blank" rel="external">Leveling Up with React: Redux</a></li>
<li><a href="http://btholt.github.io/complete-intro-to-react/" target="_blank" rel="external">Complete intro to react</a></li>
<li><a href="https://medium.com/@nicktho/recreating-redux-behind-the-magic-curtain-c21edd542c9c#.a93sgufyi" target="_blank" rel="external">Recreating Reduxâ€Šâ€”â€ŠBehind the magic curtain</a></li>
<li><a href="https://stormpath.com/blog/build-a-redux-powered-react-application/" target="_blank" rel="external">Letâ€™s Build a Redux Powered React Application</a></li>
<li><a href="https://www.codementor.io/reactjs/tutorial/intro-to-react-redux-pros" target="_blank" rel="external">Deep Introduction to Redux - Seriese 1/3</a></li>
<li><a href="https://www.codementor.io/reactjs/tutorial/redux-server-rendering-react-router-universal-web-app" target="_blank" rel="external">Universal Rendering with Redux and React-Router - Seriese 2/3</a></li>
<li><a href="https://www.codementor.io/reactjs/tutorial/redux-unit-test-mocha-mocking" target="_blank" rel="external">Unit Testing Redux Apps - Seriese 3/3</a></li>
<li><a href="https://zen.id.au/using-aurelia-and-redux-together-for-good-times-all-around/" target="_blank" rel="external">Using Aurelia and Redux together for good times all around</a></li>
<li><a href="https://www.reindex.io/blog/redux-and-relay/" target="_blank" rel="external">Comparing Redux and Relay</a></li>
<li><a href="https://egghead.io/courses/building-react-applications-with-idiomatic-redux" target="_blank" rel="external">Building React Applications with Idiomatic Redux</a></li>
<li><a href="http://www.robinwieruch.de/the-soundcloud-client-in-react-redux" target="_blank" rel="external">The SoundCloud Client in React + Redux</a></li>
<li><a href="https://github.com/berwin/Blog/issues/4" target="_blank" rel="external">æ·±å…¥æµ…å‡º Redux</a></li>
<li><a href="http://houssein.me/redux/immutablejs/angular2/2016/07/04/angular2-with-immutablejs-and-redux.html" target="_blank" rel="external">Building Angular 2 applications with Immutable.js and Redux</a></li>
<li><a href="http://blog.ng-book.com/introduction-to-redux-with-typescript-and-angular-2/" target="_blank" rel="external">Tutorial: Building Redux in TypeScript with Angular 2</a></li>
<li><a href="http://blog.rangle.io/react-and-redux-performance-with-reselect/" target="_blank" rel="external">Improving React and Redux performance with Reselect</a></li>
<li><a href="http://blog.rangle.io/recipes-for-redux/" target="_blank" rel="external">Recipes for Redux</a></li>
<li><a href="http://blog.rangle.io/getting-started-with-redux-and-angular-2/" target="_blank" rel="external">Getting Started with Redux &amp; Angular 2</a></li>
<li><a href="https://el-tramo.be/blog/react-swift/" target="_blank" rel="external">Universal/Isomorphic React+Redux on a Swift Web Backend</a></li>
<li><a href="http://engineering.datadoghq.com/redux-doghouse--creating-reusable-react-redux-components-through-scoping/" target="_blank" rel="external">Creating Reusable React-Redux Components Through Scoping</a></li>
<li><a href="https://github.com/lewis617/react-redux-tutorial" target="_blank" rel="external">React+Reduxç³»åˆ—æ•™ç¨‹</a></li>
<li><a href="https://lewis617.github.io/2016/11/20/r2-book/" target="_blank" rel="external">ä¹¦ç±ï¼šã€ŠReact ä¸ Redux å¼€å‘å®ä¾‹ç²¾è§£ã€‹</a></li>
</ul>
<hr>
<h3 id="Boilerplate"><a href="#Boilerplate" class="headerlink" title="Boilerplate"></a>Boilerplate</h3><ul>
<li><a href="http://redux-minimal.js.org/" target="_blank" rel="external"><strong>redux-minimal</strong> - Minimalist react-redux starter kit which letâ€™s you build rich real world apps</a></li>
<li><a href="https://github.com/nicksp/redux-webpack-es6-boilerplate" target="_blank" rel="external"><strong>Modern and Scalable React/Redux Boilerplate</strong> - Flexible starter kit using Webpack 2 (tree-shaking) / React Hot Loader v3 / Code Splitting for React Router / PostCSS / CSS Modules / custom <em>Ducks pattern</em> app architecture / best practices / Sentry error tracking / Enzyme test environment</a> :rocket:</li>
<li><a href="https://github.com/jaredpalmer/react-production-starter" target="_blank" rel="external"><strong>react-production-starter</strong> - React boilerplate with isomorphic rendering, async react-router routes, async redux reducers, async data fetching, and code-splitting.</a> :metal: :fire:</li>
<li><a href="https://github.com/hashnode/mern-starter" target="_blank" rel="external"><strong>mern.io</strong> - Simple full-stack boilerplate to get started with building isomorphic/universal apps, handles api part and also offers a cli to generate the boilerplate</a> :metal: :fire:</li>
<li><a href="https://github.com/combine/universal-react-redux" target="_blank" rel="external"><strong>universal-react-redux</strong> - Opinionated Universal React/Redux/Webpack with HMR. Continually updated.</a> :metal: :fire:</li>
<li><a href="https://github.com/coryhouse/react-slingshot" target="_blank" rel="external"><strong>react-slingshot</strong> - React Redux Starter Kit with hot reloading, tests and example app</a></li>
<li><a href="https://github.com/knowbody/react-redux-boilerplate" target="_blank" rel="external"><strong>react-redux-boilerplate</strong> - React Redux Boilerplate</a></li>
<li><a href="https://github.com/Keats/react-boilerplate" target="_blank" rel="external"><strong>react-boilerplate</strong> - React + Typescript + Sass boilerplate</a></li>
<li><a href="https://github.com/lcjnil/react-redux-scaffold" target="_blank" rel="external"><strong>react-redux-scaffold</strong> - Combination of redux, react-router and ES6+ support</a></li>
<li><a href="https://github.com/tsaiDavid/simple-redux-boilerplate" target="_blank" rel="external"><strong>simple-redux-boilerplate</strong> - Simple and guided React, Redux boilerplate w/ Transform HMR! :fire:</a></li>
<li><a href="https://github.com/Amorino/reactv" target="_blank" rel="external"><strong>reactv</strong> - React Redux example</a></li>
<li><a href="https://github.com/ellbee/redux-boilerplate" target="_blank" rel="external"><strong>redux-boilerplate</strong> - Boilerplate for Redux</a></li>
<li><a href="https://github.com/davezuko/react-redux-starter-kit" target="_blank" rel="external"><strong>react-redux-starter-kit</strong> - Get started with React, Redux, and React-Router.</a></li>
<li><a href="https://github.com/jackielii/simplest-redux-example" target="_blank" rel="external"><strong>simplest-redux-example</strong> - Simplest Redux + React example for beginners</a></li>
<li><a href="https://github.com/anorudes/redux-easy-boilerplate" target="_blank" rel="external"><strong>redux-easy-boilerplate</strong> - React Redux easy boilerplate</a></li>
<li><a href="https://github.com/dictyBase/dicty-redux" target="_blank" rel="external"><strong>dicty-redux</strong> - Starter kit to bootstrap React and Redux (Flux) based web application</a></li>
<li><a href="https://github.com/GordyD/3ree" target="_blank" rel="external"><strong>3ree</strong> - Boilerplate &amp; Demo for Universal Realtime Apps built with React + Redux + RethinkDB + Express</a></li>
<li><a href="https://github.com/rafaelchiti/react_scaffolding" target="_blank" rel="external"><strong>react_scaffolding</strong> - React + React Router 1.0 + Redux + Webpack &amp; Hot Module Replacement</a></li>
<li><a href="https://github.com/aybmab/express-redux-sample" target="_blank" rel="external"><strong>express-redux-sample</strong> - Express-Redux-PassportJs-MySQL Boilerplate</a></li>
<li><a href="https://github.com/GetExpert/redux-blog-example" target="_blank" rel="external"><strong>redux-blog-example</strong> - Redux-Webpack-Babel Blog Platform boilerplate</a></li>
<li><a href="https://github.com/omnidan/redux-undo-boilerplate" target="_blank" rel="external"><strong>redux-undo-boilerplate</strong> - a magical boilerplate with hot reloading and awesome error handling</a></li>
<li><a href="https://github.com/gpbl/redux500" target="_blank" rel="external"><strong>redux500</strong> - The Redux version of isomorphic500</a></li>
<li><a href="https://github.com/survivejs/redux-demo" target="_blank" rel="external"><strong>redux-demo</strong> - Redux port of SurviveJS - Webpack and React Kanban app</a></li>
<li><a href="https://github.com/erikras/react-redux-universal-hot-example" target="_blank" rel="external"><strong>react-redux-universal-hot-example</strong> - A starter boilerplate for a universal webapp using express, react, redux, webpack, and react-hot-loader</a> :metal:</li>
<li><a href="https://github.com/levjj/rde" target="_blank" rel="external"><strong>rde</strong> - Reactive Live Programming Environment</a></li>
<li><a href="https://github.com/cloudmu/react-redux-starter-kit" target="_blank" rel="external"><strong>React Redux Starter Kit</strong> - Yet another React and Redux based web application starter kit</a></li>
<li><a href="https://github.com/sullenor/skeleton" target="_blank" rel="external"><strong>skeleton</strong> - A simple project-stub to show the basic ideas. Also serves you as a quick start for your project (Mori + Redux)</a></li>
<li><a href="https://github.com/zalmoxisus/browser-redux" target="_blank" rel="external"><strong>browser-redux</strong> - Building Chrome apps and cross-browser extensions with Redux and Webpack</a></li>
<li><a href="https://github.com/chicoxyzzy/react-for-hipsters-boilerplate" target="_blank" rel="external"><strong>react-for-hipsters-boilerplate</strong> - Fresh boilerplate with brand new hot reloading confing and other hipster stuff</a></li>
<li><a href="https://github.com/mezod/boilerplate-koa-redux-react" target="_blank" rel="external"><strong>Documented Koa Redux React Webpack boilerplate</strong></a>- The building process of this boilerplate is deeply documented from 0 for learning purposes. <a href="http://blog.joanboixados.com/building-a-boilerplate-for-a-koa-redux-react-application-including-webpack-mocha-and-sass/" target="_blank" rel="external">You can find the docs here</a>.</li>
<li><a href="https://github.com/tuommii/err" target="_blank" rel="external"><strong>err</strong> - Electron, React, Redux-devtools boilerplate for building cross-platform apps.</a></li>
<li><a href="https://github.com/banzay/friends-app-redux" target="_blank" rel="external"><strong>friends-app-redux</strong> - React Redux Universal Hot Example</a></li>
<li><a href="https://github.com/caljrimmer/isomorphic-redux-app" target="_blank" rel="external"><strong>isomorphic-redux-app</strong> - Redux Isomorphic App (with async content)</a></li>
<li><a href="https://github.com/unicorn-standard/starter-kit" target="_blank" rel="external"><strong>starter-kit</strong> - Project boilerplate using React, Redux and Uniloc http://unicornstandard.com/packages/boilerplate.html</a></li>
<li><a href="https://github.com/tngan/loopback-redux-react-boilerplate" target="_blank" rel="external"><strong>loopback-redux-react-boilerplate</strong> - A boilerplate for a Redux-React application using LoopBack</a></li>
<li><a href="https://github.com/tomatau/breko-hub" target="_blank" rel="external"><strong>breko-hub</strong> - <strong>B</strong>abel <strong>Rea</strong>ct <strong>Ko</strong>a <strong>H</strong>ot <strong>U</strong>niversal <strong>B</strong>oilerplate â€“ A simple, clean and consistent boilerplate for creating universal webapps with universal data fetching and SocketIO integration</a></li>
<li><a href="https://github.com/inderps/react-redux-cordova-boilerplate" target="_blank" rel="external"><strong>React Redux Cordova Boilerplate</strong></a></li>
<li><a href="https://github.com/mxstbr/react-boilerplate" target="_blank" rel="external"><strong>react-boilerplate</strong> - Performance orientated, offline-first boilerplate feat. hot-reloading, PostCSS and the best developer experience.</a></li>
<li><a href="https://github.com/choonkending/react-webpack-node" target="_blank" rel="external"><strong>react-webpack-node</strong> - Boilerplate for an universal React + Redux/alt Flux application using Webpack running on a node express server</a></li>
<li>[<strong>Hapi React Starter Kit</strong> - Universal, Redux, Redis, Socket.io, Intl] (<a href="https://github.com/Dindaleon/hapi-react-starter-kit" target="_blank" rel="external">https://github.com/Dindaleon/hapi-react-starter-kit</a>)</li>
<li>[<strong>Universal Redux Template</strong> - A clean, extensible react + redux boilerplate with universal rendering, testing and more] (<a href="https://github.com/mz026/universal-redux-template" target="_blank" rel="external">https://github.com/mz026/universal-redux-template</a>)</li>
<li><a href="https://github.com/colinmeinke/universal-js" target="_blank" rel="external"><strong>universal-js</strong> - A universal Javascript starter kit inc. React, Redux, Redux Dev Tools, Universal Redux Router, CSS Modules, hot module reloading, Babel for ES2015+ and ESLint</a></li>
<li><a href="https://github.com/WapGeaR/redux-react-material-boilerplate" target="_blank" rel="external"><strong>redux-react-material-boilerplate</strong> - Simple boilerplate inc. React, Redux, Hot reload and Material-ui</a></li>
<li><a href="https://github.com/exeto/react-redux-starter" target="_blank" rel="external"><strong>react-redux-starter</strong> - React Redux Starter</a></li>
<li><a href="https://github.com/Pitzcarraldo/reduxible" target="_blank" rel="external"><strong>Reduxible</strong> - The Fast and Easy way to make a React + Redux apps</a></li>
<li><a href="https://github.com/chen844033231/react-workflow" target="_blank" rel="external"><strong>react-workflow</strong> - A large SPA boilerplate for web development built on top of Facebookâ€™s React library,use redux architecture</a></li>
<li><a href="https://github.com/PBRT/reactogo" target="_blank" rel="external"><strong>ReacToGo</strong> - A simple ES6 boilerplate with Redux architecture and ImmutableJS: Hot Reload, React UI Comp, Firebase, Router</a></li>
<li><a href="https://github.com/cristianszwarc/react_crud_localStorage" target="_blank" rel="external"><strong>React/Redux simple CRUD</strong> with persistent state and local async actions (add a manifest file and you get an offline webapp) </a></li>
<li><a href="https://github.com/FredericHeem/starhackit" target="_blank" rel="external"><strong>StarHackIt</strong> - An React/Redux Node full-stack starter kit with authentication and authorization code</a></li>
<li><a href="https://github.com/andrewcoelho/react-seed" target="_blank" rel="external"><strong>React Seed</strong> - A barebones scalable directory structure and package.json for facilitating new React + Redux projects. No fat to trim here!</a></li>
<li>[<strong>React/Redux with Auth boilerplate</strong> - Very simple boilerplate, good for fast creating admin panels / dashboard. Included: React, Redux, ReduxForm, React-Router, Simple Authenticate, Hot Reload and Webpack (with babel) :fire:] (<a href="https://github.com/WapGeaR/react-redux-boilerplate-auth" target="_blank" rel="external">https://github.com/WapGeaR/react-redux-boilerplate-auth</a>)</li>
<li><a href="https://github.com/Producters/docker-node-react-starter" target="_blank" rel="external"><strong>Docker + React/Redux + Node + PostgreSQL</strong> - full stack boilerplate with fully dockerized workflows for development, deployment, testing</a></li>
<li><a href="https://github.com/ufocoder/redux-universal-boilerplate" target="_blank" rel="external"><strong>Redux universal boilerplate</strong> - boilerplate for react universal application building on flux architecture based on redux implementation.</a></li>
<li><a href="https://github.com/kiki-le-singe/react-redux-universal-boilerplate" target="_blank" rel="external"><strong>React Redux Universal Boilerplate</strong> - An Universal ReactJS/Redux Boilerplate.</a></li>
<li><a href="https://github.com/douglascorrea/react-hot-redux-firebase-starter" target="_blank" rel="external"><strong>react-hot-redux-firebase-starter</strong> - Starter boilerplate for using React/Redux with Firebase 3.0 API, include the new React Hot Loader 3.0 :fire:</a></li>
<li><a href="https://github.com/btomashvili/react-redux-firebase-boilerplate" target="_blank" rel="external"><strong>React Redux Firebase Boilerplate</strong> - Designed for quickly spin up your apps with Firebase, using bunch of awesome new front-end technologies includes webpack build system, hot reloading, routing &amp; sass support. :fire:</a></li>
<li><a href="https://github.com/xkawi/react-universal-saga" target="_blank" rel="external"><strong>React Universal Saga</strong> - Universal React Starter Kit ft. Redux Saga</a></li>
<li><a href="https://github.com/rwieruch/react-redux-soundcloud" target="_blank" rel="external"><strong>React Redux SoundCloud Client</strong> - Seed Project for a SoundCloud Client with working Login + Extension Seed Projects</a></li>
<li><a href="https://github.com/barbar/vortigern" target="_blank" rel="external"><strong>vortigern</strong> - A universal boilerplate for building web applications w/ TypeScript, React, Redux and more.</a></li>
<li><a href="https://github.com/hdjirdeh/angular2-redux-contact-list" target="_blank" rel="external"><strong>angular2-redux-contact-list</strong> - Simple contact list built with Angular 2, Immutable.js and Redux</a></li>
<li><a href="https://github.com/lewis617/react-redux-seed" target="_blank" rel="external"><strong>react-redux-seed</strong> - ä½¿ç”¨ React ä¸ Redux å®ç° Universal æ¸²æŸ“çš„ç§å­å·¥ç¨‹</a></li>
<li><a href="https://arc.js.org" target="_blank" rel="external"><strong>ARc</strong> - A progressive React starter kit based on Atomic Design with redux, redux-saga and redux-form</a></li>
<li><a href="https://github.com/dogada/edux" target="_blank" rel="external"><strong>edux</strong> - fast Redux without constants and switches. Actions and reducers are generated from single source.</a></li>
</ul>
<hr>
<h3 id="React-Native-A-framework-for-building-native-apps-using-React"><a href="#React-Native-A-framework-for-building-native-apps-using-React" class="headerlink" title="React Native - A framework for building native apps using React"></a><a href="https://facebook.github.io/react-native" target="_blank" rel="external">React Native - A framework for building native apps using React</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/nikgraf/CarteJaune" target="_blank" rel="external">CarteJaune - An open source Redux/ExponentJS (React Native) app leveraging redux-saga to keep track of your vaccinations</a></li>
<li><a href="https://github.com/soliury/noder-react-native" target="_blank" rel="external">noder-react-native - The mobile app of cnodejs.org written in React Native</a></li>
<li><a href="https://github.com/hzyIO/react-native-redux-counter" target="_blank" rel="external">react-native-redux-counter</a></li>
<li><a href="https://github.com/chentsulin/react-native-counter-ios-android" target="_blank" rel="external">react-native-counter-ios-android</a></li>
<li><a href="https://github.com/bruz/react-native-redux-groceries" target="_blank" rel="external">react-native-redux-groceries - An example app using React Native, Redux, Firebase, and AsyncStorage for offline data</a></li>
<li><a href="https://github.com/fraserxu/soundredux-native" target="_blank" rel="external">react-native-sound-cloud</a></li>
<li><a href="https://github.com/bartonhammond/snowflake" target="_blank" rel="external">snowflake - mobile app starter: Login, Logout, Reset Password, Update Profile, Hot Reload</a></li>
<li><a href="https://github.com/just4fun/uestc-bbs-react-native" target="_blank" rel="external">uestc-bbs-react-native - An iOS client for http://bbs.uestc.edu.cn/ written in React Native with Redux</a></li>
<li><a href="https://github.com/nara/movies-redux" target="_blank" rel="external">movies-redux - redux implementation of react-native movies example that is included in react-native source</a></li>
<li><a href="https://github.com/uiheros/react-native-redux-todo-list" target="_blank" rel="external">react-native-redux-todo-list - A sample todo list app developed by using react-native and redux</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="React-A-JavaScript-library-for-building-user-interfaces"><a href="#React-A-JavaScript-library-for-building-user-interfaces" class="headerlink" title="React - A JavaScript library for building user interfaces"></a><a href="http://facebook.github.io/react" target="_blank" rel="external">React - A JavaScript library for building user interfaces</a></h3><ul>
<li><p>Containers</p>
<ul>
<li><a href="https://github.com/LouisBarranqueiro/reapop" target="_blank" rel="external"><strong>reapop</strong> - A React &amp; Redux notifications system</a></li>
</ul>
</li>
<li><p>Middlewares</p>
<ul>
<li><a href="https://github.com/therewillbecode/redux-cheerio" target="_blank" rel="external"><strong>redux-cheerio</strong> - Make HTTP requests and then parse the responses with jQuery selectors using Cheerio</a><ul>
<li><a href="https://github.com/ezekielchentnik/redux-reporter" target="_blank" rel="external"><strong>redux-reporter</strong> - Report actions &amp; metadata to 3rd party providers, extremely useful for analytics and error handling (New Relic, Sentry, Adobe DTM, Keen, etc.)</a></li>
<li><a href="https://github.com/acdlite/redux-transduce" target="_blank" rel="external"><strong>redux-transduce</strong> - Transducer utilities for Redux</a></li>
<li><a href="https://github.com/acdlite/redux-actions" target="_blank" rel="external"><strong>redux-actions</strong> - Flux Standard Action utilities for Redux</a></li>
<li><a href="https://github.com/acdlite/redux-promise" target="_blank" rel="external"><strong>redux-promise</strong> - FSA-compliant promise middleware for Redux</a></li>
<li><a href="https://github.com/shanhaichik/redux-sync-promise" target="_blank" rel="external"><strong>redux-sync-promise</strong> - Middleware for writing asynchronous actions in synchronous style</a></li>
<li><a href="https://github.com/alanrubin/redux-simple-promise" target="_blank" rel="external"><strong>redux-simple-promise</strong> - FSA-compliant promise middleware for Redux with simple behaviour with minimal boilerplate declarations</a></li>
<li><a href="https://github.com/symbiont-io/redux-async" target="_blank" rel="external"><strong>redux-async</strong> - FSA-compliant promise property middleware for Redux</a></li>
<li><a href="https://github.com/zackargyle/redux-async-queue" target="_blank" rel="external"><strong>redux-async-queue</strong> - Manage queues of thunk actions</a></li>
<li><a href="https://github.com/KELiON/redux-async-initial-state" target="_blank" rel="external"><strong>redux-async-initial-state</strong> - Set initial Redux state asynchronously</a></li>
<li><a href="https://github.com/kolodny/redux-await" target="_blank" rel="external"><strong>redux-await</strong> - Manage async redux actions sanely</a></li>
<li><a href="https://github.com/acdlite/redux-rx" target="_blank" rel="external"><strong>redux-rx</strong> - RxJS utilities for Redux</a></li>
<li><a href="https://github.com/faassen/reselect" target="_blank" rel="external"><strong>reselect</strong> - Selector library for Redux like in NuclearJS</a></li>
<li><a href="https://github.com/rackt/react-redux" target="_blank" rel="external"><strong>react-redux</strong> - React bindings for Redux</a></li>
<li><a href="https://github.com/acdlite/redux-react-router" target="_blank" rel="external"><strong>redux-react-router</strong> - Redux bindings for React Router â€“ keep your router state inside your Redux store</a></li>
<li><a href="https://github.com/pburtchaell/redux-promise-middleware" target="_blank" rel="external"><strong>redux-promise-middleware</strong> - Redux middleware for resolving and rejecting promises</a></li>
<li><a href="https://github.com/gaearon/redux-thunk" target="_blank" rel="external"><strong>redux-thunk</strong> - Thunk middleware for Redux</a></li>
<li><a href="https://github.com/acdlite/redux-batched-updates" target="_blank" rel="external"><strong>redux-batched-updates</strong> - Batch React updates that occur as a result of Redux dispatches, to prevent cascading renders.</a></li>
<li><a href="https://github.com/itsmepetrov/redux-combine-actions" target="_blank" rel="external"><strong>redux-combine-actions</strong> - Redux middleware that allows you to easy combine actions and dispatch them sequentially</a></li>
<li><a href="https://github.com/DenisIzmaylov/redux-catch-promise" target="_blank" rel="external"><strong>redux-catch-promise</strong> - Extended replacement of redux-thunk middleware to supporting async-await functions and implement server-side rendering for React components with async state</a></li>
<li><a href="https://github.com/lapanoid/redux-delegator" target="_blank" rel="external"><strong>redux-delegator</strong> - Compose redux reducers in a structured way</a></li>
<li><a href="https://github.com/michalkvasnicak/routex" target="_blank" rel="external"><strong>routex</strong> - Simple router for Redux universal applications. Can be used with React too</a></li>
<li><a href="https://github.com/rt2zz/redux-persist-store" target="_blank" rel="external"><strong>redux-persist-store</strong> - Persist and rehydrate a redux store</a></li>
<li><a href="https://github.com/gyzerok/adrenaline" target="_blank" rel="external"><strong>adrenaline</strong> - React bindings for Redux with Relay in mind</a></li>
<li><a href="https://github.com/elgerlambert/redux-localstorage" target="_blank" rel="external"><strong>redux-localstorage</strong> - Store enhancer that syncs (a subset) of your Redux store state to localstorage.</a></li>
<li><a href="https://github.com/michaelcontento/redux-storage" target="_blank" rel="external"><strong>redux-storage</strong> - Persistence layer for redux with flexible backends</a></li>
<li><a href="https://github.com/vicentedealencar/redux-pouchdb" target="_blank" rel="external"><strong>redux-pouchdb</strong> - sync store state to pouchdb</a></li>
<li><a href="https://github.com/vslinko/redux-vstack-router" target="_blank" rel="external"><strong>redux-vstack-router</strong> - Helpers to bind vstack-router to redux</a></li>
<li><a href="https://github.com/phated/redux-create-store" target="_blank" rel="external"><strong>redux-create-store</strong></a></li>
<li><a href="https://github.com/tappleby/redux-batched-subscribe" target="_blank" rel="external"><strong>redux-batched-subscribe</strong> - Batch calls to subscribe handlers with a custom function, including debouncing or React batched updates.</a></li>
<li><a href="https://github.com/fcomb/redux-logger" target="_blank" rel="external"><strong>redux-logger</strong> - Logger middleware for Redux</a></li>
<li><a href="https://github.com/low-ghost/redux-node-logger" target="_blank" rel="external"><strong>redux-node-logger</strong> - A Redux Logger for Node Environments</a></li>
<li><a href="https://github.com/fcomb/redux-diff-logger" target="_blank" rel="external"><strong>redux-diff-logger</strong> - Diff logger between states for Redux</a></li>
<li><a href="https://github.com/lapwinglabs/redux-debug" target="_blank" rel="external"><strong>redux-debug</strong> - debug(â€¦) middleware for Redux</a></li>
<li><a href="https://github.com/idolize/redux-requests" target="_blank" rel="external"><strong>redux-requests</strong> - Avoid issuing duplicate HTTP requests</a></li>
<li><a href="https://github.com/rt2zz/redux-owl" target="_blank" rel="external"><strong>redux-owl</strong> - Redux One Way Linking</a></li>
<li><a href="https://github.com/pauldijou/redux-act" target="_blank" rel="external"><strong>redux-act</strong> - An opinionated lib to create actions and reducers for Redux</a></li>
<li><a href="https://github.com/FredericHeem/redux-act-async" target="_blank" rel="external"><strong>redux-act-async</strong> - Reducing boilerplate when creating asynchronous actions in Redux</a></li>
<li><a href="https://github.com/ngokevin/redux-raven-middleware" target="_blank" rel="external"><strong>redux-raven-middleware</strong> - Redux middleware for sending error reports to Sentry through raven-js</a></li>
<li><a href="https://github.com/callum/redux-routing" target="_blank" rel="external"><strong>redux-routing</strong> - Universal routing built on top of redux</a></li>
<li><a href="https://github.com/omnidan/redux-undo" target="_blank" rel="external"><strong>redux-undo</strong> - Simple undo/redo functionality for redux state containers</a></li>
<li><a href="https://github.com/danscan/rn-redux-mixpanel" target="_blank" rel="external"><strong>rn-redux-mixpanel</strong> - Configurable Redux middleware that sends your actions &amp; user profile data to Mixpanel</a></li>
<li><a href="https://github.com/ekosz/redux-falcor" target="_blank" rel="external"><strong>redux-falcor</strong> - Connect your redux front-end to your falcor back-end</a></li>
<li><a href="https://github.com/markdalgleish/redux-analytics" target="_blank" rel="external"><strong>redux-analytics</strong> - Trigger analytics events based on your event metadata</a></li>
<li><a href="https://github.com/omnidan/redux-ignore" target="_blank" rel="external"><strong>redux-ignore</strong> - Ignore redux actions by array or filter function</a></li>
<li><a href="https://github.com/omnidan/redux-recycle" target="_blank" rel="external"><strong>redux-recycle</strong> - Reset the redux state on certain actions</a></li>
<li><a href="https://github.com/indexiatech/re-notif" target="_blank" rel="external"><strong>re-notif</strong></a> A notification center based on React &amp; Redux.</li>
<li><a href="https://github.com/swennemans/redux-lunr" target="_blank" rel="external"><strong>redux-lunr</strong> - Make your redux store searchable with Lunr.js</a></li>
<li><a href="https://github.com/meadow/redux-ensure-fsa" target="_blank" rel="external"><strong>redux-ensure-fsa</strong> - Development middleware to check for FSA-compliant actions</a></li>
<li><a href="https://github.com/alexkuz/redux-pagan" target="_blank" rel="external"><strong>redux-pagan</strong> - internationalization via redux</a></li>
<li><a href="//github.com/wyze/redux-debounce"><strong>redux-debounce</strong></a> - Debounce your actions!</li>
<li><a href="https://github.com/stoeffel/redux-future" target="_blank" rel="external"><strong>redux-future</strong> - FSA-compliant future monad middleware for redux</a></li>
<li><a href="https://github.com/stoeffel/redux-io" target="_blank" rel="external"><strong>redux-io</strong> - FSA-compliant io monad middleware for redux</a></li>
<li><a href="https://github.com/stoeffel/redux-either" target="_blank" rel="external"><strong>redux-either</strong> - FSA-compliant either monad middleware for redux</a></li>
<li><a href="https://github.com/gpfunk/redux-timeout" target="_blank" rel="external"><strong>redux-timeout</strong> - Trigger actions based on timeouts</a></li>
<li><a href="https://github.com/d6u/redux-observable-middleware" target="_blank" rel="external"><strong>redux-observable-middleware</strong> - Redux middleware for subscribing to observables</a></li>
<li><a href="https://github.com/redux-observable/redux-observable" target="_blank" rel="external"><strong>redux-observable</strong> - RxJS 5-based middleware for Redux. Compose and cancel actions as epics.</a></li>
<li><a href="https://github.com/wyvernnot/redux-deferred" target="_blank" rel="external"><strong>redux-deferred</strong> - Redux middleware for jQuery Deferred Object</a></li>
<li><a href="https://github.com/sskyy/redux-task" target="_blank" rel="external"><strong>redux-task</strong> - A simple Side Effects manager for redux</a></li>
<li><a href="https://github.com/weo-edu/redux-gen" target="_blank" rel="external"><strong>redux-gen</strong> - Generator based middleware for redux</a></li>
<li><a href="https://github.com/Jackong/redux-authentication" target="_blank" rel="external"><strong>redux-authentication</strong> - Authentication component for Redux</a></li>
<li><a href="https://github.com/sergiodxa/socket.io-redux" target="_blank" rel="external"><strong>socket.io-redux</strong> - Redux middleware to emit action via socket.io</a></li>
<li><a href="https://github.com/sergiodxa/redux-catch" target="_blank" rel="external"><strong>redux-catch</strong> - Error catcher middleware for Redux reducers and middlewares</a></li>
<li><a href="https://github.com/stoeffel/redux-elm-middleware" target="_blank" rel="external"><strong>redux-elm-middleware</strong> - Elm middleware for redux</a></li>
<li><a href="https://github.com/agraboso/redux-api-middleware" target="_blank" rel="external"><strong>redux-api-middleware</strong> - Redux API middleware based on the real-world example</a></li>
<li><a href="https://github.com/Yaska/redux-mediaquery" target="_blank" rel="external"><strong>redux-mediaquery</strong> - Redux ActionCreator to put responsive-design breakpoints in your store</a></li>
<li><a href="https://github.com/lewis617/redux-amrc" target="_blank" rel="external"><strong>redux-amrc</strong> - Redux async middleware and reducer creator</a></li>
<li><a href="https://github.com/zslucky/redux-fetch-middleware" target="_blank" rel="external"><strong>redux-fetch-middleware</strong> - Redux middleware that help user to treat simple request via fetch api</a></li>
</ul>
</li>
</ul>
</li>
<li><p>Tools</p>
<ul>
<li><a href="https://github.com/skellock/reactotron" target="_blank" rel="external"><strong>reactotron</strong> - Control, monitor, and instrument your React Native apps from the comfort of your TTY</a></li>
<li><a href="https://github.com/conorhastings/redux-test-recorder" target="_blank" rel="external"><strong>redux-test-recorder</strong> - Redux test recorder is a redux middleware + included component for automagically generating tests for your reducers based on the actions in your app</a></li>
<li><a href="https://github.com/gaearon/redux-devtools" target="_blank" rel="external"><strong>redux-devtools</strong> - DevTools for Redux with hot reloading, action replay, and customizable UI</a></li>
<li><a href="https://github.com/rackt/react-router-redux" target="_blank" rel="external"><strong>react-router-redux</strong> - Ruthlessly simple bindings to keep react-router and redux in sync</a></li>
<li><a href="https://github.com/Agamennon/redux-tiny-router" target="_blank" rel="external"><strong>redux-tiny-router</strong> - A Router made for Redux, stop using the router as a controller itâ€™s just state!</a></li>
<li><a href="https://github.com/lapanoid/redux-devtools-gentest-plugin" target="_blank" rel="external"><strong>redux-devtools-gentest-plugin</strong> - Generate mocha like tests from redux-devtools session</a></li>
<li><a href="https://github.com/banderson/generator-redux" target="_blank" rel="external"><strong>generator-redux</strong> - CLI tools for Redux: next-gen functional Flux/React with devtools</a></li>
<li><a href="https://github.com/Jackong/generator-reactapp" target="_blank" rel="external"><strong>generator-reactapp</strong> - Yeoman generator for react app with redux</a></li>
<li><a href="https://github.com/chentsulin/generator-redux-app" target="_blank" rel="external"><strong>generator-redux-app</strong> - Scaffold out a redux app with counter example and react-router</a></li>
<li><a href="https://github.com/sporto/redux-loader" target="_blank" rel="external"><strong>redux-loader</strong> - A high order component for Redux. This components loads resources and passes them to the child components via props</a></li>
<li><a href="https://github.com/Kvoti/redux-rest" target="_blank" rel="external"><strong>redux-rest</strong> - Automatically create Flux action constants, action creators and Redux reducers for your REST API</a></li>
<li><a href="https://github.com/kennetpostigo/react-reach" target="_blank" rel="external"><strong>react-reach</strong> - A library to communicate with Graphql through Redux</a></li>
<li><a href="https://github.com/lexich/redux-api" target="_blank" rel="external"><strong>redux-api</strong> - Flux REST API for redux infrastructure</a></li>
<li><a href="https://github.com/alixander/redux-store-validator" target="_blank" rel="external"><strong>redux-store-validator</strong> - Add validation to your Redux reducers</a></li>
<li><a href="https://github.com/adjohnson916/firedux" target="_blank" rel="external"><strong>firedux</strong> - Firebase + Redux for ReactJS</a></li>
<li><a href="https://github.com/vslinko/vstack-router" target="_blank" rel="external"><strong>vstack-router</strong> - Universal router</a></li>
<li><a href="https://github.com/Tom-Alexander/redux-ecommerce" target="_blank" rel="external"><strong>redux-ecommerce</strong> - E-commerce flux with redux</a></li>
<li><a href="https://github.com/erikras/redux-form" target="_blank" rel="external"><strong>redux-form</strong> - An ES7 decorator for forms using Redux and React</a></li>
<li><a href="https://github.com/posabsolute/redux-form-validator" target="_blank" rel="external"><strong>redux-form-validation</strong> - Form validation for controlled &amp; uncontrolled inputs</a></li>
<li><a href="https://github.com/mihirsoni/simple-redux-form" target="_blank" rel="external"><strong>simple-redux-form</strong> - A tiny redux-form alternative Higher Order Component for forms</a>.</li>
<li><a href="https://github.com/calesce/redux-slider-monitor" target="_blank" rel="external"><strong>redux-slider-monitor</strong> - A custom monitor for Redux DevTools to replay recorded Redux actions</a></li>
<li><a href="https://github.com/substantial/updeep" target="_blank" rel="external"><strong>updeep</strong> - Easily update nested frozen objects and arrays in a declarative and immutable manner</a></li>
<li><a href="https://github.com/gajus/redux-immutable" target="_blank" rel="external"><strong>redux-immutable</strong> - Streamlines use of Immutable.js with Redux reducers.</a></li>
<li><a href="https://github.com/lapanoid/redux-import-export-monitor" target="_blank" rel="external"><strong>redux-import-export-monitor</strong> - A monitor for copying your serialized action log to the clipboard, as well as pasting it in from somewhere else</a></li>
<li><a href="https://github.com/winkler1/icedam" target="_blank" rel="external"><strong>icedam</strong> - Just-in-time immutability: freezes data sent to views.</a></li>
<li><a href="https://github.com/broucz/react-inline-grid" target="_blank" rel="external"><strong>react-inline-grid</strong> - Predictable flexbox based grid for React using Redux and Immutable-js.</a></li>
<li><a href="https://github.com/grigory-leonenko/redux-easy-actions" target="_blank" rel="external"><strong>redux-easy-actions</strong> - Sugar library for creating Redux or Flux actions</a></li>
<li><a href="https://github.com/popc0rn/redux-mount" target="_blank" rel="external"><strong>redux-mount</strong> - Mount state data and change its state values on the fly</a></li>
<li><a href="https://github.com/ashaffer/redux-multi" target="_blank" rel="external"><strong>redux-multi</strong> - Dispatch multiple actions from one action creator</a></li>
<li><a href="https://github.com/scottcorgan/immu" target="_blank" rel="external"><strong>immu</strong> - A tiny, fail-fast, lazy, immutable Javascript objects library</a></li>
<li><a href="https://github.com/Versent/redux-crud" target="_blank" rel="external"><strong>Generate standard action creators and reducers for CRUD applications</strong></a></li>
<li><a href="https://github.com/indexiatech/redux-immutablejs" target="_blank" rel="external"><strong>Redux &amp; ImmutableJs</strong> - Integration of Redux &amp; ImmutableJs that 100% conforms Redux standards</a></li>
<li><a href="https://github.com/gcanti/redux-tcomb" target="_blank" rel="external"><strong>redux-tcomb</strong> - Immutable and type-checked state and actions for Redux</a></li>
<li><a href="https://github.com/johanneslumpe/redux-react-router-transitions" target="_blank" rel="external"><strong>redux-react-router-transitions</strong> - Attach react-router transitions to arbitrary actions</a></li>
<li><a href="https://github.com/ForbesLindesay/redux-optimist" target="_blank" rel="external"><strong>redux-optimist</strong> - Optimistically apply actions that can be later commited or reverted.</a></li>
<li><a href="https://github.com/whetstone/redux-devtools-diff-monitor" target="_blank" rel="external"><strong>redux-devtools-diff-monitor</strong> - Redux DevTools â€“ Diff Monitor</a></li>
<li><a href="https://github.com/romseguy/redux-store-visualizer" target="_blank" rel="external"><strong>redux-store-visualizer</strong> - Visualize Redux store in real time</a></li>
<li><a href="https://github.com/banderson/generator-redux" target="_blank" rel="external"><strong>generator-redux</strong> - CLI tools for Redux: next-gen functional Flux/React with devtools</a></li>
<li><a href="https://github.com/Jackong/generator-reactapp" target="_blank" rel="external"><strong>generator-reactapp</strong> - Yeoman generator for react app with redux</a></li>
<li><a href="https://github.com/tdzl2003/redux-viewmodel" target="_blank" rel="external"><strong>redux-viewmodel</strong> - ViewModel wrapping for Redux &amp; React</a></li>
<li><a href="https://github.com/newtack/redux-utils" target="_blank" rel="external"><strong>redux-utils</strong> - Utility functions for Redux</a></li>
<li><a href="https://github.com/erikras/multireducer" target="_blank" rel="external"><strong>multireducer</strong> - A utility to wrap many copies of a single Redux reducer into a single key-based reducer</a></li>
<li><a href="https://github.com/philholden/subdivide" target="_blank" rel="external"><strong>subdivide</strong> - User defined UI layout: Every pane can be subdivided and any widget assigned to any pane</a></li>
<li><a href="https://github.com/gregthebusker/replux" target="_blank" rel="external"><strong>replux</strong> - Self contained components and enhancements for Redux</a></li>
<li><a href="https://github.com/aparticka/redux-immutable-utils" target="_blank" rel="external"><strong>redux-immutable-utils</strong> - Utilities for using Immutable with Redux</a></li>
<li><a href="https://github.com/acdlite/recompose" target="_blank" rel="external"><strong>recompose</strong> - A microcomponentization toolkit for React</a></li>
<li><a href="https://github.com/izaakschroeder/redux-lift" target="_blank" rel="external"><strong>redux-lift</strong> - Lifting for Redux</a></li>
<li><a href="https://github.com/router5/redux-router5" target="_blank" rel="external"><strong>redux-router5</strong> - router5 integration with Redux</a></li>
<li><a href="https://github.com/zalmoxisus/redux-devtools-extension" target="_blank" rel="external"><strong>redux-devtools-extension</strong> - Redux DevTools Extension</a></li>
<li><a href="https://github.com/colinmeinke/universal-redux-router" target="_blank" rel="external"><strong>universal-redux-router</strong> - A very simple router for Redux and React that works on both server and client</a></li>
<li><a href="https://github.com/jprichardson/redux-watch" target="_blank" rel="external"><strong>redux-watch</strong> - Watch/monitor for state changes on an object path</a></li>
<li><a href="https://github.com/bvaughn/redux-devtools-filterable-log-monitor" target="_blank" rel="external"><strong>redux-devtools-filterable-log-monitor</strong> - Filterable tree view monitor for Redux DevTools</a></li>
<li><a href="https://github.com/posabsolute/redux-flash-notification" target="_blank" rel="external"><strong>redux-flash-notification</strong> -  A flash notification component for Redux</a></li>
<li><a href="https://github.com/yelouafi/redux-saga" target="_blank" rel="external"><strong>redux-saga</strong> - An alternative side effect model for Redux apps</a></li>
<li><a href="https://github.com/zalmoxisus/remote-redux-devtools" target="_blank" rel="external"><strong>remote-redux-devtools</strong> - Use Redux DevTools remotely for React Native, hybrid, desktop and server side Redux apps</a></li>
<li><a href="https://github.com/YoruNoHikage/redux-devtools-dispatch" target="_blank" rel="external"><strong>redux-devtools-dispatch</strong> - Dispatch your actions manually to test if your app reacts well</a></li>
<li><a href="https://github.com/raisemarketplace/redux-loop" target="_blank" rel="external"><strong>redux-loop</strong> - Sequence your effects naturally and purely by returning them from your reducers</a></li>
<li><a href="https://github.com/tommikaikkonen/redux-orm" target="_blank" rel="external"><strong>redux-orm</strong> - A small, simple and immutable ORM to manage data in your Redux store</a></li>
<li><a href="https://github.com/aparticka/redux-bacon" target="_blank" rel="external"><strong>redux-bacon</strong> - Utilities for attaching Bacon.js to Redux</a></li>
<li><a href="https://github.com/slorber/rereduce" target="_blank" rel="external"><strong>rereduce</strong> - Reducer library for Redux</a></li>
<li><a href="https://github.com/KarlPurk/redux-decorators" target="_blank" rel="external"><strong>redux-decorators</strong> - A ridiculously good syntax for working with Redux and TypeScript. Currently limited to Angular 2 but could potentially be used elsewhere</a></li>
<li><a href="https://github.com/amsardesai/redux-test-reducer" target="_blank" rel="external"><strong>redux-test-reducer</strong> - Simple and clean testing mechanism for Redux reducers</a></li>
<li><a href="https://github.com/alexkuz/redux-devtools-inspector" target="_blank" rel="external"><strong>redux-devtools-inspector</strong> - Another Redux DevTools Monitor</a></li>
<li><a href="https://github.com/sotojuan/redux-ava" target="_blank" rel="external"><strong>redux-ava</strong> - Helpers for writing Redux tests in AVA</a></li>
<li><a href="https://github.com/SpencerCDixon/redux-cli" target="_blank" rel="external"><strong>redux-cli</strong> - An opinionated CLI for building redux/react apps quicker</a></li>
<li><a href="https://github.com/salsita/redux-saga-rxjs" target="_blank" rel="external"><strong>redux-saga-rxjs</strong> - RxJS implementation of Saga pattern for redux</a></li>
<li><a href="https://github.com/dmitry-zaets/redux-actions-assertions" target="_blank" rel="external"><strong>redux-actions-assertions</strong> - Assertions for redux actions testing</a></li>
<li><a href="https://github.com/sergiodxa/redux-duck" target="_blank" rel="external"><strong>redux-duck</strong> - Helper function to create Redux modules using the ducks-modular-redux proposal</a></li>
<li><a href="https://github.com/jhen0409/redux-dispatch-cli" target="_blank" rel="external"><strong>redux-dispatch-cli</strong> - A CLI tool for Redux remote dispatch. Used in remote-redux-devtools</a></li>
<li><a href="https://github.com/zackargyle/redux-immutable-reducer" target="_blank" rel="external"><strong>redux-immutable-reducer</strong> - Immutable reducer states with Redux</a></li>
<li><a href="https://github.com/redux-bootstrap/redux-bootstrap" target="_blank" rel="external"><strong>redux-bootstrap</strong> - configure React + React-Router + Redux + Immutable.js with one function!</a></li>
<li><a href="https://github.com/mandeepbrar/redux-director" target="_blank" rel="external"><strong>redux-director</strong> - Redux bindings to director router</a></li>
<li><a href="https://github.com/ConciergeAuctions/redux-q" target="_blank" rel="external"><strong>redux-q</strong> - Provides a way to queue callbacks until an action is dispatched</a></li>
<li><a href="https://github.com/exeto/redux-apist" target="_blank" rel="external"><strong>redux-apist</strong> - Creator API actions for redux-thunk</a></li>
<li><a href="https://github.com/chiefGui/reswitch" target="_blank" rel="external"><strong>reswitch</strong> â€” Write reducers with less boilerplate</a></li>
<li><a href="https://github.com/redux-autoform/redux-autoform" target="_blank" rel="external"><strong>redux-autoform</strong> - Create Redux-Forms dynamically out of metadata</a></li>
<li><a href="https://github.com/clarus/redux-ship" target="_blank" rel="external"><strong>redux-ship</strong> - Composable, testable and typable side effects</a></li>
</ul>
</li>
<li><p>Frameworks</p>
<ul>
<li><a href="https://github.com/jumpsuit/jumpsuit" target="_blank" rel="external"><strong>Jumpsuit</strong> - A powerful &amp; efficient React framework. Jump in. Zip up. Build great apps.</a></li>
<li><a href="https://github.com/jumpsuit/jumpstate" target="_blank" rel="external"><strong>Jumpstate</strong> - Simple and powerful state management for Redux</a></li>
<li><a href="https://github.com/sorrycc/dva" target="_blank" rel="external"><strong>dva</strong> - Front-end framework based on react, redux, react-redux, react-router and redux-saga.</a></li>
<li><a href="https://github.com/ashaffer/vdux" target="_blank" rel="external"><strong>Vdux</strong> - Worldâ€™s smallest framework.  Stateless Virtual DOM &lt;-&gt; Redux</a></li>
<li><a href="https://github.com/esex/esex" target="_blank" rel="external"><strong>Esex</strong> - Full-stack Universal JavaScript Framework (Redux+RxJs)</a></li>
<li><a href="https://github.com/vslinko/ripster" target="_blank" rel="external"><strong>Ripster</strong></a></li>
<li><a href="https://github.com/este/este" target="_blank" rel="external"><strong>Este</strong> - The most complete minimal dev stack / boilerplate for React &amp; Redux universal web apps</a></li>
<li><a href="https://github.com/littlstar/stardux" target="_blank" rel="external"><strong>stardux</strong> - Functional DOM containers based on starplate, IncrementalDOM, and redux</a></li>
<li><a href="https://github.com/marknutter/nux" target="_blank" rel="external"><strong>nux</strong> - A Push-Based Functional Reactive Web Application Framework</a></li>
<li><a href="https://github.com/Wildhoney/Keo" target="_blank" rel="external"><strong>Keo</strong> - Plain functions for a more functional Deku approach to creating React components, with functional goodies such as compose, memoize, etcâ€¦ for free</a></li>
<li><a href="https://github.com/wildlyinaccurate/plait" target="_blank" rel="external"><strong>plait</strong> - A minimal JavaScript framework for building reactive web components</a></li>
<li><a href="https://github.com/reactuate/reactuate" target="_blank" rel="external"><strong>reactuate</strong> â€” A React/Redux stack (not a boilerplate!) with a focus on Domain-Driven Design</a></li>
<li><a href="https://github.com/mattkrick/meatier" target="_blank" rel="external"><strong>meatier</strong> - Like meteor, but meatier</a></li>
<li><a href="https://github.com/relax/relax" target="_blank" rel="external"><strong>relax</strong> - New generation CMS on top of React, Redux and GraphQL</a></li>
<li><a href="https://github.com/flipace/lovli.js" target="_blank" rel="external"><strong>lovli.js</strong> - A boilerplate for developing react+redux applications with rethinkdb/horizon as realtime database and express for the server</a></li>
<li><a href="https://github.com/mariusandra/kea-logic" target="_blank" rel="external"><strong>kea</strong> - Well-readable, self-documenting and easily refactorable framework that brings your data to life! Comes with scaffolding tools</a> :bird:</li>
<li><a href="https://github.com/tianche/feeble" target="_blank" rel="external"><strong>Feeble</strong> - A framework built on top of React/Redux/redux-saga which aims to make building React/Redux applications easier and better.</a></li>
<li><a href="https://github.com/mjaneczek/conventional-redux" target="_blank" rel="external"><strong>Conventional-Redux</strong> - A wrapper for react-redux which provides API based on convention over configuration pattern.</a></li>
<li><a href="https://github.com/derzunov/redux-react-i18n" target="_blank" rel="external"><strong>redux-react-i18n</strong> - An i18n solution for redux/reactâœŒğŸ¿âœŠğŸ½ğŸ¤˜ğŸ»</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a><a href="examples/README.md">Examples</a></h3><hr>
<h3 id="Similar-libraries"><a href="#Similar-libraries" class="headerlink" title="Similar libraries"></a>Similar libraries</h3><ul>
<li><a href="https://github.com/BobBuehler/flux-ts" target="_blank" rel="external"><strong>flux-ts</strong> - A small flux implementation heavily inspired by redux</a></li>
<li><a href="https://github.com/acstll/chopped-redux" target="_blank" rel="external"><strong>chopped-redux</strong> - A very small Flux implementation based on Redux</a></li>
<li><a href="https://github.com/edge/fluxette" target="_blank" rel="external"><strong>fluxette</strong> - Minimalist, functional, and concise Flux</a></li>
<li><a href="https://github.com/jas-chen/rx-redux" target="_blank" rel="external"><strong>rx-redux</strong> - A reimplementation of redux using RxJS</a></li>
<li><a href="https://github.com/johnhenry/understate" target="_blank" rel="external"><strong>understate</strong> - A simple state manager</a></li>
<li><a href="https://github.com/Lucifier129/refer" target="_blank" rel="external"><strong>refer</strong> - Redux-like library for handling global state on functional style</a></li>
<li><a href="https://github.com/karelsteinmetz/bobflux" target="_blank" rel="external"><strong>bobflux</strong> - Bobflux is pure functional implementation of FLUX pattern and is fitted to Bobril</a></li>
<li><a href="https://github.com/mobxjs/mobx" target="_blank" rel="external"><strong>mobx</strong> - Simple, scalable state management</a></li>
</ul>
<hr>
<h3 id="Deku-Functional-view-library-for-building-UI-components-as-an-alternative-to-React"><a href="#Deku-Functional-view-library-for-building-UI-components-as-an-alternative-to-React" class="headerlink" title="Deku - Functional view library for building UI components as an alternative to React"></a><a href="https://github.com/dekujs/deku" target="_blank" rel="external">Deku - Functional view library for building UI components as an alternative to React</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/nivanson/deku-redux-universal-hot-example" target="_blank" rel="external">Deku + Express + Redux + Crossroads Router</a></li>
<li><a href="https://github.com/troch/deku-redux" target="_blank" rel="external">deku-redux - Bindings for redux in deku (Standalone plugin)</a><br>)</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Incremental-DOM-Incremental-DOM-is-a-library-for-building-up-DOM-trees-and-updating-them-in-place-when-data-changes"><a href="#Incremental-DOM-Incremental-DOM-is-a-library-for-building-up-DOM-trees-and-updating-them-in-place-when-data-changes" class="headerlink" title="Incremental DOM - Incremental DOM is a library for building up DOM trees and updating them in-place when data changes"></a><a href="http://google.github.io/incremental-dom" target="_blank" rel="external">Incremental DOM - Incremental DOM is a library for building up DOM trees and updating them in-place when data changes</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/joshthecoder/idom-redux-todomvc-app" target="_blank" rel="external">Incremental DOM + Redux Flux = Todo App</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="WinJS-Windows-Library-for-JavaScript"><a href="#WinJS-Windows-Library-for-JavaScript" class="headerlink" title="WinJS - Windows Library for JavaScript"></a><a href="http://try.buildwinjs.com" target="_blank" rel="external">WinJS - Windows Library for JavaScript</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/unindented/react-redux-winjs-example" target="_blank" rel="external">react-redux-winjs-example</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Angular-HTML-enhanced-for-web-apps"><a href="#Angular-HTML-enhanced-for-web-apps" class="headerlink" title="Angular - HTML enhanced for web apps"></a><a href="https://angularjs.org" target="_blank" rel="external">Angular - HTML enhanced for web apps</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/wbuchwalter/tsRedux" target="_blank" rel="external">Angular + Typescript + Redux</a></li>
<li><a href="https://github.com/wbuchwalter/ng-redux" target="_blank" rel="external">ng-redux - Standalone plugin</a></li>
<li><a href="https://github.com/neilff/redux-ui-router" target="_blank" rel="external">redux-ui-router - ngRedux middleware for Angular UI Router</a></li>
<li><a href="https://github.com/r-park/todo-angular-redux" target="_blank" rel="external">Todo app with ng-redux â€¢ ES6 â€¢ Webpack</a></li>
<li><a href="https://github.com/InfomediaLtd/angular2-redux-example" target="_blank" rel="external">https://github.com/InfomediaLtd/angular2-redux-example</a></li>
<li><a href="https://github.com/tomusdrw/angular2-redux-example" target="_blank" rel="external">https://github.com/tomusdrw/angular2-redux-example</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Angular-2-One-framework-Mobile-and-desktop"><a href="#Angular-2-One-framework-Mobile-and-desktop" class="headerlink" title="Angular 2 - One framework. Mobile and desktop"></a><a href="https://angular.io/" target="_blank" rel="external">Angular 2 - One framework. Mobile and desktop</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/InfomediaLtd/angular2-redux-example" target="_blank" rel="external">angular2-redux-example - Example project for using pure Redux with Angular 2 and TypeScript</a></li>
<li><a href="https://github.com/angular-redux/store" target="_blank" rel="external">@angular-redux/store - Angular 2 bindings for Redux</a></li>
<li><a href="https://github.com/InfomediaLtd/angular2-redux" target="_blank" rel="external">angular2-redux - Wrapper components for using Redux in an Angular2 application</a></li>
<li><a href="https://github.com/forforeach/ng2redux" target="_blank" rel="external">ng2redux - Angular 2 bindings for Redux implemented with TypeScript and decorators</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Vue-A-library-for-building-modern-web-interfaces"><a href="#Vue-A-library-for-building-modern-web-interfaces" class="headerlink" title="Vue - A library for building modern web interfaces"></a><a href="http://vuejs.org" target="_blank" rel="external">Vue - A library for building modern web interfaces</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/revue/revue" target="_blank" rel="external">Revue - Redux binding for Vue</a></li>
<li><a href="https://github.com/yang-wei/vue-flux" target="_blank" rel="external">Vue + Redux</a></li>
<li><a href="https://github.com/zhongqf/meteor-vue-redux-example" target="_blank" rel="external">Meteor + Vue + Redux</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Polymer-Build-modern-apps-using-web-components"><a href="#Polymer-Build-modern-apps-using-web-components" class="headerlink" title="Polymer - Build modern apps using web components"></a><a href="https://www.polymer-project.org" target="_blank" rel="external">Polymer - Build modern apps using web components</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/tur-nr/polymer-redux" target="_blank" rel="external">polymer-redux</a></li>
<li><a href="https://github.com/lastmjs/redux-store-element" target="_blank" rel="external">redux-store-element</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Ember-A-framework-for-creating-ambitious-web-applications"><a href="#Ember-A-framework-for-creating-ambitious-web-applications" class="headerlink" title="Ember - A framework for creating ambitious web applications"></a><a href="http://emberjs.com" target="_blank" rel="external">Ember - A framework for creating ambitious web applications</a></h3><ul>
<li>Examples</li>
</ul>
<hr>
<h3 id="Meteor-Build-apps-that-are-a-delight-to-use-faster-than-you-ever-thought-possible"><a href="#Meteor-Build-apps-that-are-a-delight-to-use-faster-than-you-ever-thought-possible" class="headerlink" title="Meteor - Build apps that are a delight to use, faster than you ever thought possible"></a><a href="https://www.meteor.com" target="_blank" rel="external">Meteor - Build apps that are a delight to use, faster than you ever thought possible</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/zhongqf/meteor-react-redux-example" target="_blank" rel="external">meteor-react-redux-example</a></li>
<li><a href="https://github.com/AdamBrodzinski/meteor-flux-leaderboard/tree/redux" target="_blank" rel="external">meteor-flux-leaderboard</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Mithril-A-Javascript-Framework-for-Building-Brilliant-Applications"><a href="#Mithril-A-Javascript-Framework-for-Building-Brilliant-Applications" class="headerlink" title="Mithril - A Javascript Framework for Building Brilliant Applications"></a><a href="http://mithril.js.org/" target="_blank" rel="external">Mithril - A Javascript Framework for Building Brilliant Applications</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/mijime/mithril-redux-starter-hmr" target="_blank" rel="external">mithril-redux-starter-hmr</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Backbone-Give-your-JS-App-some-Backbone-with-Models-Views-Collections-and-Events"><a href="#Backbone-Give-your-JS-App-some-Backbone-with-Models-Views-Collections-and-Events" class="headerlink" title="Backbone - Give your JS App some Backbone with Models, Views, Collections, and Events"></a><a href="http://backbonejs.org/" target="_blank" rel="external">Backbone - Give your JS App some Backbone with Models, Views, Collections, and Events</a></h3><ul>
<li>Tools<ul>
<li><a href="https://github.com/redbooth/backbone-redux" target="_blank" rel="external">backbone-redux â€” The easy way to keep your backbone collections and redux store in sync</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Aurelia-is-a-next-gen-JavaScript-client-framework-for-mobile-desktop-and-web-that-leverages-simple-conventions-to-empower-your-creativity"><a href="#Aurelia-is-a-next-gen-JavaScript-client-framework-for-mobile-desktop-and-web-that-leverages-simple-conventions-to-empower-your-creativity" class="headerlink" title="Aurelia - is a next gen JavaScript client framework for mobile, desktop and web that leverages simple conventions to empower your creativity"></a><a href="http://aurelia.io" target="_blank" rel="external">Aurelia - is a next gen JavaScript client framework for mobile, desktop and web that leverages simple conventions to empower your creativity</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/voidberg/aurelia-redux-todo" target="_blank" rel="external">aurelia-redux-todo - An implementation of the Redux todo demo app using Aurelia</a></li>
<li><a href="https://www.sitepoint.com/managing-state-aurelia-with-redux/" target="_blank" rel="external">Managing State in Aurelia: How to Use Aurelia with Redux</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Riot-A-React-like-user-interface-micro-library"><a href="#Riot-A-React-like-user-interface-micro-library" class="headerlink" title="Riot - A React-like user interface micro-library"></a><a href="http://riotjs.com" target="_blank" rel="external">Riot - A React-like user interface micro-library</a></h3><ul>
<li>Examples<ul>
<li><a href="https://github.com/remyhonig/riotredux-budget" target="_blank" rel="external">riotredux-budget</a></li>
<li><a href="https://github.com/zesty-io/app-skeleton" target="_blank" rel="external">app-skeleton</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Electron-Build-cross-platform-desktop-apps-with-web-technologies"><a href="#Electron-Build-cross-platform-desktop-apps-with-web-technologies" class="headerlink" title="Electron - Build cross platform desktop apps with web technologies"></a><a href="http://electron.atom.io/" target="_blank" rel="external">Electron - Build cross platform desktop apps with web technologies</a></h3><ul>
<li><a href="https://github.com/chentsulin/electron-react-boilerplate" target="_blank" rel="external">electron-react-boilerplate (Electron + Redux + Hot Reload)</a></li>
</ul>
<hr>
<h3 id="A-Frame-A-web-framework-for-building-VR-experiences"><a href="#A-Frame-A-web-framework-for-building-VR-experiences" class="headerlink" title="A-Frame - A web framework for building VR experiences"></a><a href="https://aframe.io" target="_blank" rel="external">A-Frame - A web framework for building VR experiences</a></h3><ul>
<li><a href="https://github.com/ngokevin/kframe/tree/master/components/redux" target="_blank" rel="external">aframe-redux-component</a></li>
</ul>
<hr>
<h3 id="Chrome-Extensions"><a href="#Chrome-Extensions" class="headerlink" title="Chrome Extensions"></a>Chrome Extensions</h3><ul>
<li><a href="https://github.com/Dharmoslap/redux-chrome-extension" target="_blank" rel="external">Redux Chrome Extension</a></li>
<li><p><a href="https://github.com/jhen0409/react-chrome-extension-boilerplate" target="_blank" rel="external">React Chrome Extension Boilerplate (Webpack + Redux + Babel and etc</a></p>
</li>
<li><p>Examples</p>
<ul>
<li><a href="https://github.com/Pumgrana/plugin" target="_blank" rel="external">Pumgrana Plugin</a></li>
</ul>
</li>
</ul>
<h2 id="Ruby-on-Rails-Resources"><a href="#Ruby-on-Rails-Resources" class="headerlink" title="Ruby on Rails Resources"></a>Ruby on Rails Resources</h2><ul>
<li><a href="https://github.com/shakacode/react-webpack-rails-tutorial" target="_blank" rel="external">React Webpack Rails Tutorial Using Redux</a></li>
<li><a href="https://github.com/shakacode/react_on_rails" target="_blank" rel="external">react_on_rails gem</a></li>
</ul>
<h2 id="Other-languages"><a href="#Other-languages" class="headerlink" title="Other languages"></a>Other languages</h2><ul>
<li><p>.NET</p>
<ul>
<li><a href="https://github.com/GuillaumeSalles/redux.NET" target="_blank" rel="external">https://github.com/GuillaumeSalles/redux.NET</a></li>
<li><a href="https://github.com/pshomov/reducto" target="_blank" rel="external">https://github.com/pshomov/reducto</a></li>
</ul>
</li>
<li><p>Java</p>
<ul>
<li><a href="https://github.com/glung/redux-java" target="_blank" rel="external">https://github.com/glung/redux-java</a></li>
<li><a href="https://github.com/trikita/jedux" target="_blank" rel="external">https://github.com/trikita/jedux</a></li>
<li><a href="https://github.com/izumin5210/Droidux" target="_blank" rel="external">https://github.com/izumin5210/Droidux</a></li>
</ul>
</li>
<li><p>Swift</p>
<ul>
<li><a href="https://github.com/ReSwift/reduxSwift" target="_blank" rel="external">https://github.com/ReSwift/reduxSwift</a></li>
<li><a href="https://github.com/Swift-Flow/Swift-Flow" target="_blank" rel="external">https://github.com/Swift-Flow/Swift-Flow</a></li>
<li><a href="https://github.com/ReSwift/ReSwift" target="_blank" rel="external">https://github.com/ReSwift/ReSwift</a> and <a href="http://reswift.github.io/ReSwift/master" target="_blank" rel="external">docs</a></li>
</ul>
</li>
<li><p>Purescript</p>
<ul>
<li><a href="https://github.com/brakmic/purescript-redux" target="_blank" rel="external">https://github.com/brakmic/purescript-redux</a></li>
<li><a href="https://github.com/faber/purescript-purdux" target="_blank" rel="external">https://github.com/faber/purescript-purdux</a></li>
</ul>
</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å­¦ä¹ æ¨¡å¼è®¾è®¡çš„å¯ç¤º-çŒ®ç»™å’Œæˆ‘ä¸€æ ·çš„react-reduxçš„åˆå­¦è€…]]></title>
      <url>http://yoursite.com/2017/03/08/%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%90%AF%E7%A4%BA-%E7%8C%AE%E7%BB%99%E5%92%8C%E6%88%91%E4%B8%80%E6%A0%B7%E7%9A%84react-redux%E7%9A%84%E5%88%9D%E5%AD%A6%E8%80%85/</url>
      <content type="html"><![CDATA[<p>è¿™é‡Œæˆ‘ä¸è°ˆåˆ°åº•å“ªå®¶çš„ä¹¦å¥½ï¼Œé‚£ç§å­¦ä¹ æ–¹æ³•å¥½ã€‚ä½œä¸ºä¸€ä¸ªè½¯ä»¶å¼€å‘çš„åˆå­¦è€…å·²ç»ä¸¤å¹´äº†ï¼Œå‰ä¸€ä¸ªæœˆæ„Ÿè§‰åˆ°å¾ˆç„¦è™‘ï¼Œæ„Ÿè§‰åˆ°å¥½å¤šä»£ç éƒ½è¿˜è¯»ä¸æ‡‚ï¼Œè€Œä¸”å¹´é¾„ä¹Ÿæ¯”è¾ƒå¤§ã€‚ä½†æ˜¯è‡ªä»æ¥è§¦äº†å‡ æœ¬javascrptæ¨¡å¼è®¾è®¡çš„ä¹¦ä»¥åï¼Œç„¦è™‘æ¶ˆå¤±äº†ï¼Œå°½ç®¡ä»»ç„¶æœ‰å¾ˆå¤šçš„ä»£ç ç­‰ç€å»è¯»ï¼Œä½†æ˜¯å¿ƒé‡Œæ„Ÿè§‰éå¸¸æœ‰åº•ï¼Œä»¥å‰å¦‚æœæ˜¯èµ¤æ‰‹åœ¨è’åŸä¸Šæ‰“çŒçš„è¯ï¼Œç°åœ¨æ‰‹ä¸Šå°±ä¸€æŠŠçŒæªã€‚</p>
<p>ç°åœ¨è¯´è¯´è¯»è¿‡æ¨¡å¼è®¾è®¡ä»¥åçš„æ„Ÿå—ã€‚è¿™ä¸ªè¯»çš„è¿‡ç¨‹æœ¬èº«åˆæ˜¯åµŒå¥—å‡½æ•°ï¼Œè¯»æ¨¡å¼è®¾è®¡çš„è¿‡ç¨‹ä¸­ä¹Ÿåœ¨åˆ©ç”¨æ¨¡å¼çš„æ–¹æ³•æ¥ä¸æ–­çš„é’ˆå¯¹ä¸€ä¸ªé—®é¢˜ï¼Œç»§ç»­æ·±å…¥çš„å­¦ä¹ ï¼Œé‡æ„ã€‚ä¸æ–­çš„åå¤ã€‚</p>
<p>1æ‹¿ç€æ¦”å¤´çš„äººï¼Œçœ‹åˆ°ä»»ä½•ä¸œè¥¿éƒ½æ˜¯é’‰å­ï¼Ÿ</p>
<p>æˆ‘ä¸Šå‘¨æœ‰æ®µæ—¶é—´ï¼Œæ„Ÿè§‰çœ‹åˆ°ä»»ä½•çš„ä»£ç éƒ½åœ¨è€ƒè™‘ä»–é‡Œé¢æœ‰ä»€ä¹ˆæ¨¡å¼ï¼Œç”šè‡³å½±å“åˆ°äº†æˆ‘çš„å…¶ä»–å’Œç¼–ç¨‹ä¸ç›¸å¹²çš„é¢†åŸŸï¼Œæ¯”å¦‚æˆ‘ä»¥å‰çš„ä¸“ä¸šçŸ¥è¯†å’Œä¸šä½™çˆ±å¥½ï¼Œå‘ç°çŸ­æ—¶é—´å†…ï¼Œé€šè¿‡æŠŠæ¨¡å¼è®¾è®¡çš„æ€æƒ³(æˆ‘è¯´çš„è€Œæ˜¯æ€æƒ³ï¼Œä¸æ˜¯æ€è·¯ï¼Œæ˜¯å®è§‚çš„çœ‹æ³•)æ¥é‡æ–°å®¡è§†å­¦è¿‡æˆ–è€…äº†è§£çš„ä¸œè¥¿ï¼Œç»“æœè·å¾—äº†å’Œä»¥å‰å®Œå…¨ä¸åŒçš„ä¸œè¥¿ï¼Œä¼¼ä¹å¥½å¤šé—®é¢˜çœ‹å¾—å¾ˆé€å½»äº†ã€‚ </p>
<p>ç»“æœä¹æ­¤ä¸ç–²ï¼Œä½†æ˜¯å†·é™ä¸‹æ¥æƒ³ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘æ˜¯å¦æœ‰ç‚¹çŸ«æ‰è¿‡æ­£äº†ï¼Ÿæˆ‘é‡æ–°åæ€ä»¥åå‘ç°ï¼Œå¹¶æ²¡æœ‰çŸ«æ‰è¿‡æ­£ï¼Œæ¨¡å¼å°±æ˜¯è§£å†³é—®é¢˜çš„ä¸‡èƒ½æ–¹å¼ï¼Œåªè¦ä½ æ˜¯åœ¨ä¸»åŠ¨çš„æ ¹æ®å®é™…æƒ…å†µè§£å†³é—®é¢˜ï¼Œä¸»åŠ¨çš„æ€»ç»“è§£å†³é—®é¢˜çš„è¿‡ç¨‹ä¸­å„ç§åˆ©å¼Šå’Œè§„å¾‹ï¼Œå°±æ˜¯æ¨¡å¼ã€‚<br>ä½ å†æ¬¡æŠŠè¿™ä¸ªå·²ç»æˆå‹çš„æ¨¡å¼åº”ç”¨åˆ°ç±»ä¼¼é—®é¢˜çš„è§£å†³å’Œè®¾è®¡ä¸­å°±æ˜¯<code>æ¨¡å¼è®¾è®¡</code>ã€‚<br>è¿™é‡Œé¢æœ€ä¸­çš„æ˜¯çœ‹æ¸…æ¥šå½“å‰è¦è§£å†³çš„é—®é¢˜å’Œå“ªäº›å·²çŸ¥çš„æ¨¡å¼ç›¸ç±»ä¼¼ã€‚è¿™æ˜¯ç¬¬ä¸€æ­¥ï¼Œå¯ä»¥ç§°ä¸º<code>æ¨¡å¼è¯†åˆ«</code>ã€‚æ¯”å¦‚ä½ è¦å¼€å‘æ±½è½¦å·ç‰Œä¹‹åˆ«ç³»ç»Ÿï¼Œä½ è¦å…ˆè¯†åˆ«å‡ºå·ç ï¼Œæ‰èƒ½åšåä¸€æ­¥çš„å·¥ä½œï¼Œåä¸€æ­¥çš„é€»è¾‘å†ç®€å•ï¼Œæ²¡æœ‰è¯†åˆ«å‡ºé—®é¢˜å°±ï¼Œåé¢çš„é—®é¢˜å°±æ— ä»è§£å†³ã€‚</p>
<p>ä½œä¸ºç¨‹åºå‘˜çš„ä½ æ˜¯å¦è€ƒè™‘è¿‡ï¼šâ€œæˆ‘çš„ç”Ÿæ´»ï¼Œä½“è‚²çˆ±å¥½ï¼Œè¯»ä¹¦ï¼Œå†™ä½œï¼ŒåŒ…æ‹¬æ‰¾å¯¹è±¡ï¼Œç»“å©šï¼Œç”šè‡³æ˜¯çº¦ç‚®è¿‡ç¨‹ä¸­æ˜¯ä¸æ˜¯æ€»ç»“äº†ä¸€äº›è§„å¾‹æˆ–è€…ä½¿ç”¨äº†åˆ«äººæ€»ç»“çš„ä¸€äº›è§„å¾‹ï¼Œåœ¨ä½¿ç”¨è¿™äº›è§„å¾‹çš„è¿‡ç¨‹ä¸­é‚£äº›æœ‰æ•ˆï¼Œé‚£äº›æ˜¯è´Ÿåˆ†ï¼Ÿâ€  æ˜¯çš„ï¼æ— å¤„ä¸åœ¨çš„ç»éªŒï¼Œåˆ°å¤„éƒ½æ˜¯ã€‚ä½†æ˜¯è¯·ä¸è¦å¿˜äº†ï¼Œè¿™äº›è§„å¾‹æ˜¯éƒ½æœ‰è‡ªå·±çš„ä½¿ç”¨ç‰¹æ®Šæ€§çš„ã€‚ä¸è€ƒè™‘ç¯å¢ƒæˆ–è€…ä¸Šä¸‹æ–‡çš„è§„å¾‹å°±ä¹±ç”¨è¿™äº›ç»éªŒå°±æ˜¯è€æµæ°“ï¼Œå¯èƒ½ä¸ä»…èµ·ä¸åˆ°è‰¯å¥½æ•ˆæœï¼Œåè€Œéª‚ç»éªŒæ€»ç»“è€…å‚»é€¼ã€‚<br>   æˆ‘ä»¬ä¸­å›½è¶³çƒå°±æ˜¯å…¸å‹çš„ä¹±ç”¨ç»éªŒçš„ä¾‹å­ã€‚ æˆ‘ä»¬çš„è¶³çƒç®¡ç†è€…æ€»æ˜¯æ‡’æ”¿ï¼Œæƒ³çŸ­å¹³å¿«çš„è§£å†³é—®é¢˜ï¼ŒæœŸæœ›ç”¨åˆ«äººç°æˆçš„æ¨¡å¼æ¥è§£å†³é—®é¢˜ã€‚<br>   ä¹Ÿå¯è°“æ˜¯å°è¯•äº†ä¸å°‘ï¼Œæ¯”å¦‚ç¬¬ä¸€äººå¤–ç±ä¸»å¸…ï¼Œå¾·å›½äººæ˜¯é‚£æ™®åˆ©ã€‚å½“æ—¶ä¸¾å›½å…´å¥‹ï¼Œä»¥ä¸ºæ‰¾åˆ°äº†è§£å†³ä¸­å›½è¶³çƒéš¾é¢˜çš„è‰¯è¯ã€‚ç»“æœå›½äººå…¨éƒ¨éƒ½é™·å…¥ä¸€ç§å¦„æƒ³ç—‡ä¸­ã€‚  ä½†æ˜¯å¿˜è®°äº†ä¸¤å›½è¶³çƒèƒŒæ™¯çš„å·®åˆ«ï¼Œ<br>   ä¸¤å›½å›½æ°‘èº«ä½“å¥åº·ï¼Œèº«ä½“ç´ è´¨å¹³å‡æƒ…å†µï¼Œè¶³çƒæ™®åŠæƒ…å†µï¼Œé’è®­æ™®åŠæƒ…å†µï¼Œè”èµ›å¼€å±•æƒ…å†µï¼Œå›½å®¶ç»æµæ”¶å…¥æƒ…å†µã€‚å½“ç•Œé˜Ÿå‘˜çš„å¤©èµ‹æƒ…å†µã€‚è¿™äº›éƒ½è¦ç»¼åˆè€ƒè™‘ã€‚é—®é¢˜å²‚æ˜¯åŒºåŒºä¸€ä¸ªè¶³çƒæ•™ç»ƒå°±èƒ½è§£å†³çš„ï¼Ÿç»“æœå¸Œæœ›è¶Šå¤§ï¼Œå¤±æœ›è¶Šå¤§ã€‚<br>   é¢†å¯¼ä»ä¸æ­»å¿ƒï¼Œæ¥ç€ç ¸é’±ï¼Œè¶³çƒè¦ä»å¨ƒå¨ƒæŠ“èµ·ï¼Œæ´¾äº†ä¸€å¯¹å°çƒå‘˜å»å·´è¥¿å­¦ä¹ ï¼Œä»¥ä¸ºè¿™æ ·é—®é¢˜å°±èƒ½è§£å†³äº†ã€‚å½“æ—¶çœ‹çºªå½•ç‰‡ä»‹ç»ï¼Œæ¡ä»¶é‚£ä¸ªå·®å‘€ã€‚ä½†æ˜¯å½“æ—¶å·´è¥¿å°±æ˜¯é‚£ä¸ªæ¡ä»¶ï¼Œä¸ºä»€ä¹ˆäººå®¶å°±æˆåŠŸäº†ï¼Œå±¡å¤ºä¸–ç•Œå† å†›å‘¢ï¼Ÿã€‚è¸¢çƒäººå¤ªå¤šäº†ï¼Œçƒåœºè™½ç„¶å¾ˆå·®ï¼Œä½†æ˜¯è¸¢çƒäººåŸºæ•°å¤§ï¼Œå¤©æ‰è¿˜æ˜¯èƒ½åœ¨è¿™æ ·çš„æ¡ä»¶ä¸‹è¯ç”Ÿã€‚æ‰€ä»¥è¿™æ ·çš„è®¡åˆ’å¿…å®šå¤±è´¥ã€‚</p>
<p>   å¦‚æœä¸è€ƒè™‘è¿™äº›ç»¼åˆé—®é¢˜ï¼Œå¤–ç±æ•™ç»ƒå’Œé’è®­ç³»ç»Ÿæ¥ä¸€ä¸ªæ­»ä¸€ä¸ªï¼ŒæˆåŠŸçš„éƒ½æ˜¯èµŒå¾’ã€‚</p>
<p>   å®é™…ä¸Šæˆ‘ä»¥ä¸Šçš„åˆ†æä¹Ÿæ˜¯ç«™åœ¨æ—è§‚è€…çš„è§’åº¦ä¸Šçœ‹é—®é¢˜ï¼Œè§£å†³é—®é¢˜è‚¯å®šä¸ä¼šè¿™ä¹ˆç®€å•ï¼Œå¦‚æœèƒ½çœ‹åˆ°é—®é¢˜å°±èƒ½è§£å†³é—®é¢˜ï¼Œé‚£å°±ä¸æ˜¯é—®é¢˜äº†ã€‚</p>
<p>   2.åŠ¨æ‰‹ï¼Œé˜…è¯»ä¹‹åçš„æ„Ÿå—ã€‚æ¨¡å¼æ˜¯ä½ è‡ªå·±çš„ä½“éªŒ</p>
<p>   åœ¨å­¦ä¹ äº†æ¨¡å¼è®¾è®¡çš„ä¹¦ä»¥åï¼Œè¯•ç€å†™äº†ä¸€ç¯‡æœ‰å…³react/reduxä¸­æ½œè—çš„ä¸€äº›æ¨¡å¼çš„æ–‡ç« ã€‚å†™è¿™ä¸ªæ–‡ç« çš„è¿‡ç¨‹å®é™…æ˜¯åŸºäºæˆ‘å¯¹è¿™ä¸ªæ¡†æ¶ä¹‹é—´çš„å…³ç³»çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘æ˜¯åˆå­¦è€…ï¼Œåœ¨reduxçš„å­¦ä¹ ä¸­ç¡®å®æ˜¯å¡äº†å¾ˆé•¿æ—¶é—´ã€‚å¾ˆå¤šä»£ç å…·ä½“é€»è¾‘çœ‹çš„æ‡‚ï¼Œä½†æ˜¯å°±æ˜¯æ„Ÿè§‰ä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼Œåœ¨å­¦äº›reduxä¸­ï¼Œåˆšå¼€å§‹ä¸çŸ¥é“æ•°æ®æ€ä¹ˆæµåŠ¨çš„ã€‚ ç°åœ¨çœ‹æ¥è¿™äº›å­¦ä¹ ä¸­çš„æ‘¸ç´¢è¿‡ç¨‹ä¹Ÿè¿˜æœ‰ä¸€å®šçš„å¥½å¤„ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡æ„è¯†åˆ° React UI Componentçš„ç»„ä»¶æ˜¯åŒ…å«åœ¨containerè¿™ä¸ªç½å­ä¸­çš„æ—¶å€™ï¼Œé—®é¢˜ä¼¼ä¹ä¸€ä¸‹å˜å¾—ç®€å•äº†ã€‚çœ‹åˆ°äº†ç»„ä»¶react-reduxä¹‹é—´çš„é‚£ç§ä¸ºäº†åŠŸèƒ½åˆ’åˆ†è€Œè¿›è¡Œ<code>è§£è€¦å’Œ</code>çš„è¿‡ç¨‹ï¼Œå½“æˆ‘æƒ³åˆ°<code>è§£è€¦å’Œ</code>çš„è¿‡ç¨‹ï¼Œä¼¼ä¹å…¶ä»–ç”¨åˆ°<code>è§£è€¦å’Œ</code>æ¦‚å¿µçš„åœ°æ–¹ï¼Œè®¤è¯†æ›´åŠ æ¸…æ¥šäº†å’Œæ˜æ™°äº†ï¼Œç»“æœæ˜¯åœ¨æˆ‘ç»§ç»­å­¦ä¹ ã€Šjsæ¨¡å¼è®¾è®¡ã€‹çš„æ—¶å€™ï¼Œéš¾åº¦å’Œå¹¿åº¦éƒ½é™äº†äº†å¥½å¤šï¼ŒåŸå› æ˜¯è¿™ç§<code>è§£è€¦å’Œ</code>æ€æƒ³æ˜¯ç¼–ç¨‹ä¸­æŠŠå¤æ‚é—®é¢˜åˆ†è§£æˆç®€å•é—®é¢˜çš„æœ€æœ‰æ•ˆçš„æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥æŠŠå¤æ‚çš„é€»è¾‘åˆ¤æ–­åˆ†è§£å¼€ã€‚æ¨¡å¼è®¾è®¡ä¸­å¤§é‡ä½¿ç”¨è¿™ç§æ€æƒ³ï¼Œæ‰€ä»¥å¾ˆå¤šé—®é¢˜å°±å¾ˆå®¹æ˜“çœ‹æ‡‚äº†ã€‚</p>
<p>   ä½†æ˜¯æˆ‘å›å¤´ä¸€æƒ³ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯åŸºäºæˆ‘è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹æ¥é€æ¸ç†è§£çš„ï¼Œå¦‚æœæ²¡æœ‰å‰é¢çš„æŒ«æŠ˜ï¼Œå¯èƒ½ä¹Ÿä¸ä¼šå¾—å‡º containeræ˜¯ä¸ªç½å­è¿™ä¸ªå½¢è±¡çš„ä¾‹å­ã€‚å¦‚æœåœ¨åˆšé‡åˆ°æŒ«æŠ˜çš„æ—¶å€™ï¼Œåˆ«äººå‘Šè¯‰æˆ‘ï¼Œè¿™ä¸ªå®¹å™¨å°±æ˜¯ä¸ªç½å­ï¼Œä½ å»çœ‹çœ‹å§ã€‚ ä¸å¯èƒ½çš„äº‹ï¼Œå’Œç›²äººæ‘¸è±¡ä¸€æ ·ï¼Œç»™ä½ è¯´é¢å‰æ˜¯ä¸€å¤´å¤§è±¡ï¼Œåœ¨ä½ æ²¡æœ‰å®Œå…¨æ‘¸é€çš„æƒ…å†µä¸‹ï¼Œä½ çš„æ„Ÿè§‰æ˜¯åƒå¥‡ç™¾æ€ªçš„ã€‚</p>
<p>   ä¹Ÿè®¸ä½ è‡ªå·±å®Œå…¨ç†è§£äº†ä»¥åï¼Œè¿™ä¸ªcontainerå¯ä»¥æ˜¯ä¸€ä¸ªé“ç½ï¼Œä¸€ä¸ªç¯®å­ï¼Œå…¶ä»–ä»€ä¹ˆçš„ä¸œè¥¿ã€‚ä¸é‡è¦<code>æœ€ç»ˆéƒ½ä¼šæŠ½è±¡æˆä¸€ä¸ªå®¹å™¨</code>ã€‚  å®¹å™¨å°±æ˜¯å¤§è±¡,è¦ä½ è‡ªå·±å»æ„Ÿå—</p>
<p>   3.æ¨¡å¼è®¾è®¡å’Œæ¨¡å¼è¯†åˆ«æ˜¯ä¸€ä¸ªæ€è€ƒè¿‡ç¨‹ã€‚</p>
<p>   æˆ‘æ„Ÿè§‰åœ¨å­¦ä¹ ä¸­æ…¢æ…¢æ„Ÿè§‰åˆ°äº†ç¼–ç¨‹æ€è€ƒçš„ä¹è¶£ã€‚åœ¨è¿™äº›ä¹¦ä¸Šï¼Œä¸€äº›å¾ˆå¤æ‚çš„ä»£ç ï¼Œç»è¿‡é‡æ„å˜ä¸ºå®¹æ˜“ç»´æŠ¤ï¼Œå®¹æ˜“é˜…è¯»ï¼Œå®¹æ˜“æ‰©å±•çš„è¿‡ç¨‹ï¼ŒçœŸæ˜¯ä¸€å¼ äº«å—è¿‡ç¨‹ã€‚ä»é˜…è¯»ä¸­æ„Ÿå—åˆ°äº†æ€è€ƒçš„å¼ºå¤§ã€‚<br>   å¦‚æœå‰ä¸€æ®µæ—¶é—´çš„å­¦ä¹ æ˜¯åŸºäºåˆ«äººçš„ä»£ç çš„ä¸€ç§å½¢å¼çš„æ¨¡ä»¿ï¼Œé‚£ä¹ˆä»é˜…è¯»è¿™äº›æ¨¡å¼è®¾è®¡çš„ä¹¦ä»¥åï¼Œåé¢å°±è¦è€ƒè™‘åˆ°å¯¹è¿™äº›ä½œè€…æ€æƒ³çš„æ¨¡ä»¿ï¼Œäººå®¶æ˜¯æ€ä¹ˆåšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘æ€ä¹ˆæ‰èƒ½è¾¾åˆ°ã€‚å¤§è¨€ä¸æƒ­çš„è¯´ï¼Œå¦‚æœåˆ°äº†è¿™ä¸€ä¸ªå¢ƒç•Œï¼Œæˆ‘æƒ³æˆ‘çš„ç¼–ç¨‹æ–¹æ³•å’Œèƒ½åŠ›éƒ½èƒ½æœ‰å¾ˆå¤§çš„æé«˜ã€‚<br>   4.ä»…ä»…æ˜¯ä¸ºäº†ç¼–ç¨‹è€Œç¼–ç¨‹å—ï¼Ÿ</p>
<p>   æ¨¡å¼è®¾è®¡çš„ä¹¦ä¸Šå®é™…è®²äº†å¾ˆå¤šçš„æ—¥å¸¸ç”Ÿæ´»ä¸­çš„äº‹ç‰©è¿è½¬åŸç†çš„æ¨¡æ‹Ÿè§£å†³è¿‡ç¨‹ã€‚ æˆ‘æƒ³çš„æ˜¯ç¼–ç¨‹éƒ½æ˜¯è§£å†³å®é™…é—®é¢˜ï¼Œè¦æƒ³ç¼–ç¨‹æ€æƒ³èƒ½æœ‰å¾ˆå¤§çš„æé«˜ï¼Œå¿…é¡»è¦å…³æ³¨è¿™äº›å…·ä½“äº‹ç‰©è¿è½¬çš„é€»è¾‘ã€‚<br>   5.ä¸æ–­çš„è®°å½•è‡ªå·±çš„æ„Ÿæ‚Ÿ<br>      äººçš„è®°å¿†æ˜¯å¾ˆè„†å¼±çš„ï¼Œç¨‹åºå‘˜è¦å­¦çš„ä¸œè¥¿é‚£ä¹ˆå¤šï¼Œä½ ä¸å¯èƒ½éƒ½è®°ä½ï¼Œé”™è¯¯çš„è®°å½•ä¸‹æ¥ä¹Ÿå¥½ã€‚</p>
<hr>
<p>   å¥½äº†ï¼Œå°±å†™è¿™ä¹ˆå¤šï¼Œåˆå­¦è€…æ°´å¹³ï¼Œå¯èƒ½è¿‡ä¸€æ®µæ—¶é—´å°±è§‰å¾—è¿™ä¸ªæ–‡ç« å¾ˆå‚»æ¯”äº†ã€‚å€Ÿæ­¤æ–‡è®°å½•è¿™ä¸ªå‚»é€¼çš„è¿‡ç¨‹ã€‚å‘µå‘µ</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å†å†è®¿javascripté—­åŒ…]]></title>
      <url>http://yoursite.com/2017/03/08/%E5%86%8D%E5%86%8D%E8%AE%BFjavascript%E9%97%AD%E5%8C%85/</url>
      <content type="html"><![CDATA[<blockquote>
<p>è¿˜æ˜¯é—­åŒ…ï¼Œé—­åŒ…åœ¨javascriptçš„ç¼–ç¨‹ä¸­ä½œç”¨å¤ªå¤§ã€‚ä»ç„¶è¿˜æ˜¯è¦åŠ æ·±ç†è§£<br>  è¿™æ¬¡çš„ä¾‹å­æ˜¯æ¥è‡ªã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹<br><a href="http://jsdesignpatterns.com" target="_blank" rel="external">pro javascript design patterns  sourcecode</a> è¿™æœ¬ä¹¦ç®—æ˜¯æ¯”è¾ƒè€çš„äº†ã€‚ä¸Šå¸è¦æˆ‘å­¦å¥½javascriptï¼ŒèŠ±äº†ä¸å°‘åŠ›æ°”ã€‚æœ¬åœ°å›¾ä¹¦é¦†çš„ javascriptçš„è®¾è®¡æ¨¡å¼çš„ä¹¦ç±å°½ç„¶æ‚‰æ•°å°½æ”¶äº†ã€‚åå­—ç›´æ¥å¸¦js è®¾è®¡æ¨¡å¼çš„ä¹¦å››æœ¬éƒ½æœ‰ï¼Œã€Šç²¾é€šjavascriptã€‹,ã€Šjavascripté¢å‘å¯¹è±¡ç¼–ç¨‹ã€‹æœ‰å†…å®¹æ¶‰åŠã€‚å‡ æœ¬javascriptçš„åŠ¨ç‰©ä¹¦éƒ½æœ‰ã€‚</p>
</blockquote>
<p>ç›´æ¥çœ‹ä»£ç ï¼Œè¿™ä¸ªä»£ç çš„é—®é¢˜ï¼Œå…¶å®åœ¨tabç¼–ç¨‹çš„æ—¶å€™ï¼Œå·²ç»åœ¨ç”¨äº†ï¼Œä½†æ˜¯è¿˜ä¸æ˜¯å¤ªæ¸…æ¥šã€‚<code>å…³é”®ç‚¹ï¼šæ¯æ¬¡è°ƒç”¨é—­åŒ…çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œæˆ–è€…å«ä½œç”¨åŸŸæ°”æ³¡ï¼Œè¿™ä¸ªä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå…¶ä»–é—­åŒ…çš„å˜é‡æ˜¯éš”ç»çš„ï¼Œæ‰€ä»¥å«æ°”æ³¡</code>ã€‚javascripté€šè¿‡é—­åŒ…å¯ä»¥è¾¾åˆ°éšè—å’Œå°è£…ä¿¡æ¯çš„ç”¨é€”ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//foo()å‡½æ•°æ˜¯å¤–éƒ¨å‡½æ•°ã€‚bar()æ˜¯å†…éƒ¨å‡½æ•°ï¼Œvar a=10æ˜¯ä½¿ç”¨var å…³é”®å­—</span></div><div class="line"><span class="comment">//å®šä¹‰çš„å˜é‡ï¼Œè€Œä¸”ä½äºfoo()å‡½æ•°å†…éƒ¨ï¼Œåœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æ˜¯è®¿é—®ä¸åˆ°çš„</span></div><div class="line"><span class="comment">//æ‰€ä»¥æ˜¯ç§æœ‰å˜é‡ã€‚bar()å‡½æ•°ä½äºfoo()å‡½æ•°å†…éƒ¨ï¼Œæ‹¥æœ‰è®¿é—®foo()ä½œç”¨åŸŸçš„æƒåˆ©ã€‚</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">   <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line"> </div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;<span class="comment">//bar()å‡½æ•°æ˜¯å†…éƒ¨å‡½æ•°ï¼Œå¯ä»¥è®¿é—®åˆ°var a å˜é‡ï¼Œæˆ–è€…å«æ•è·</span></div><div class="line">     a *= <span class="number">2</span>; </div><div class="line">     <span class="keyword">return</span> a; <span class="comment">//return  å±€éƒ¨å˜é‡</span></div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="keyword">return</span> bar;     <span class="comment">//è¿”å›å†…éƒ¨å‡½æ•°ï¼Œè¿™æ ·åœ¨foo()ä½œç”¨åŸŸå¤–ä¹Ÿå¯ä»¥è®¿é—®åˆ°bar</span></div><div class="line">           <span class="comment">//å‡½æ•°ï¼Œç”±äºå˜é‡aä¹Ÿä»bar()å‡½æ•°è¿”å›ï¼Œå˜é‡ä» foo()ä½œç”¨åŸŸä¸­è„±é€ƒå‡ºæ¥ã€‚</span></div><div class="line">  </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> baz = foo(); <span class="comment">// bazæ˜¯å‡½æ•°foo()çš„å¼•ç”¨</span></div><div class="line">baz(); <span class="comment">// returns 20. //å¥‡å¦™çš„åœ°æ–¹åœ¨è¿™é‡Œ</span></div><div class="line">baz(); <span class="comment">// returns 40.//ä¹Ÿæ˜¯</span></div><div class="line">baz(); <span class="comment">// returns 80.//ä¹Ÿæ˜¯</span></div><div class="line"><span class="comment">//æŒç»­è°ƒç”¨bazå®é™…ä¸Šåœ¨åŒä¸€ä¸ªfoo()ä½œç”¨åŸŸé‡Œé¢çš„æ“ä½œ.è¿™é‡Œå°±åªæœ‰ä¸€ä¸ª</span></div><div class="line"><span class="comment">//ä½œç”¨åŸŸå­˜åœ¨ï¼Œå˜é‡aä¹Ÿå°±å¯ä»¥ä¸€ç›´ä¿å­˜æ”¹å˜çš„å€¼äº†ã€‚</span></div><div class="line"></div><div class="line"><span class="comment">//ä¸‹é¢å°±ä¸åŒäº†ï¼Œblaté‡æ–°å¼•ç”¨äº†foo()å‡½æ•°ï¼Œé‡æ–°åˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…ä½œç”¨</span></div><div class="line"><span class="comment">//åŸŸï¼Œå˜é‡aæ˜¯ä»10å¼€å§‹çš„ï¼Œå¯ä»¥ç†è§£ä¸ºåˆå§‹åŒ–ã€‚</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> blat = foo();   <span class="comment">//è¿™æ˜¯foo()çš„å¦ä¸€å¼•ç”¨ã€‚è¿™é‡Œæœ‰ç‚¹ç»•äº†ã€‚</span></div><div class="line"><span class="comment">//é—­åŒ…çš„å˜é‡æ˜¯åœ¨å®šä¹‰é—­åŒ…æ—¶å€™å°±å®šä¹‰å¥½çš„ï¼Œä¸è¿è¡Œæ—¶æ˜¯æ— å…³çš„ã€‚</span></div><div class="line"><span class="comment">//æ‰€ä»¥åœ¨ç¬¬äºŒæ¬¡å¼•ç”¨é—­åŒ…æ˜¯å˜é‡çš„åˆå§‹å€¼è¿˜æ˜¯10</span></div><div class="line"><span class="comment">//è¿™ä¸ªåœ°æ–¹æ˜¯ä¸æ˜¯æœ‰äº›ç†Ÿæ‚‰ï¼Ÿæ˜¯çš„ï¼Œå’Œå‡½æ•°ç»‘å®šçš„å¯¹è±¡åˆšå¥½æ˜¯ç›¸åçš„ï¼Œ</span></div><div class="line"><span class="comment">//å‡½æ•°ç»‘å®šçš„ä½œç”¨åŸŸå¯¹è±¡æ˜¯åœ¨è¿è¡Œæ—¶ç»‘å®šçš„ï¼Œä¸å®šä¹‰å‡½æ•°æ—¶çš„ä½œç”¨åŸŸæ— å…³</span></div><div class="line">blat();    <span class="comment">// returns 20</span></div><div class="line">blat();    <span class="comment">// returns 40</span></div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æœ¬åœ°Node-jsæœåŠ¡å™¨ä½œä¸ºapiæœåŠ¡å™¨çš„è§£å†³åŠæ³•]]></title>
      <url>http://yoursite.com/2017/03/08/%E6%9C%AC%E5%9C%B0Node-js%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%9C%E4%B8%BAapi%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åœ¨çœ‹react-nativeæ•™ç¨‹çš„æ—¶å€™ï¼Œé‡åˆ°è¦åœ¨æ‰‹æœºç«¯è°ƒè¯•ï¼Œéœ€è¦apiæœåŠ¡å™¨ï¼Œä½†æ˜¯ç”±äºNode.jsè‡ªå·±å°±ä½œä¸ºæœåŠ¡å™¨ï¼Œæ²¡æœ‰apacheæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨apacheå’Œnginxä¹Ÿå¯ä»¥è§£å†³ï¼Œä½†æ˜¯æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨nodeå·²æœ‰çš„æ¨¡å—è§£å†³è¿™ä¸ªé—®é¢˜.<br>æ¦‚å¿µ:ç”µè„‘çš„åœ°å€æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æœ¬åœ°ç¯å›åœ°å€ï¼Œå°±æ˜¯127.0.0.1æˆ–localhost,è¿™ä¸ªåœ°å€æœ¬æœºä»¥å¤–æ˜¯ä¸èƒ½è®¿é—®çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ°å€æ˜¯è·¯ç”±å™¨æˆ–äº¤æ¢æœºåˆ†é…çš„ipåœ°å€ï¼Œè¿™ä¸ªåœ°å€å…¶ä»–ç”µè„‘å¯ä»¥è®¿é—®ã€‚<br>åœ¨node.jsä¸­è¦æŠŠipåœ°å€è½¬ä¸ºæœ¬åœ°ç¯å›åœ°å€æ‰å¯ä»¥è®¿é—®ã€‚åŸç†å°±æ˜¯è¿™æ ·ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//æœåŠ¡å™¨ç«¯çš„ä»£ç </span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="comment">// set up handlebars view engine</span></div><div class="line"><span class="keyword">var</span> handlebars = <span class="built_in">require</span>(<span class="string">'express3-handlebars'</span>)</div><div class="line">	.create(&#123; <span class="attr">defaultLayout</span>:<span class="string">'main'</span> &#125;);</div><div class="line">app.engine(<span class="string">'handlebars'</span>, handlebars.engine);</div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'handlebars'</span>);</div><div class="line"></div><div class="line">app.set(<span class="string">'port'</span>, process.env.PORT || <span class="number">3000</span>);</div><div class="line"></div><div class="line">app.use(express.static(__dirname + <span class="string">'/public'</span>));</div><div class="line"></div><div class="line"><span class="keyword">var</span> fortuneCookies = [</div><div class="line">	<span class="string">"Conquer your fears or they will conquer you."</span>,</div><div class="line">	<span class="string">"Rivers need springs."</span>,</div><div class="line">	<span class="string">"Do not fear what you don't know."</span>,</div><div class="line">	<span class="string">"You will have a pleasant surprise."</span>,</div><div class="line">	<span class="string">"Whenever possible, keep it simple."</span>,</div><div class="line">];</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">	res.render(<span class="string">'home'</span>);</div><div class="line">&#125;);</div><div class="line">app.get(<span class="string">'/about'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> randomFortune = </div><div class="line">		fortuneCookies[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * fortuneCookies.length)];</div><div class="line">	res.render(<span class="string">'about'</span>, &#123; <span class="attr">fortune</span>: randomFortune &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 404 catch-all handler (middleware)</span></div><div class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</div><div class="line">	res.status(<span class="number">404</span>);</div><div class="line">	res.render(<span class="string">'404'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 500 error handler (middleware)</span></div><div class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">err, req, res, next</span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.error(err.stack);</div><div class="line">	res.status(<span class="number">500</span>);</div><div class="line">	res.render(<span class="string">'500'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.listen(app.get(<span class="string">'port'</span>), <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log( <span class="string">'Express started on http://localhost:'</span> + </div><div class="line">    app.get(<span class="string">'port'</span>) + <span class="string">'; press Ctrl-C to terminate.'</span> );</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<hr>
<p>ä¸Šé¢è¿™æ®µä»£ç åœ¨127.0.0.1:3000ç«¯å£å¯åŠ¨ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨,ä½†æ˜¯åœ¨æ‰‹æœºç«¯æ˜¯ä¸èƒ½è®¿é—®çš„.</p>
<p>æˆ‘ä»¬å†å¯åŠ¨å¦ä¸€ä¸ªnode.jsæœåŠ¡å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//proxy.js</span></div><div class="line">   <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>), </div><div class="line">         httpProxy = <span class="built_in">require</span>(<span class="string">'http-proxy'</span>);  <span class="comment">//å¼•å…¥è¿™ä¸ªæ¨¡å—</span></div><div class="line">  </div><div class="line"><span class="comment">// æ–°å»ºä¸€ä¸ªä»£ç† Proxy Server å¯¹è±¡  </span></div><div class="line"><span class="keyword">var</span> proxy = httpProxy.createProxyServer(&#123;&#125;);  </div><div class="line">  </div><div class="line"><span class="comment">// æ•è·å¼‚å¸¸  </span></div><div class="line">proxy.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, req, res</span>) </span>&#123;  </div><div class="line">  res.writeHead(<span class="number">500</span>, &#123;  </div><div class="line">    <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>  </div><div class="line">  &#125;);  </div><div class="line">  res.end(<span class="string">'Something went wrong. And we are reporting a custom error message.'</span>);  </div><div class="line">&#125;);  </div><div class="line">  </div><div class="line"><span class="comment">// å¦å¤–æ–°å»ºä¸€ä¸ª HTTP 80 ç«¯å£çš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯å¸¸è§„ Node åˆ›å»º HTTP æœåŠ¡å™¨çš„æ–¹æ³•ã€‚  </span></div><div class="line"><span class="comment">// åœ¨æ¯æ¬¡è¯·æ±‚ä¸­ï¼Œè°ƒç”¨ proxy.web(req, res config) æ–¹æ³•è¿›è¡Œè¯·æ±‚åˆ†å‘  </span></div><div class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'http'</span>).createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </div><div class="line">  <span class="comment">// åœ¨è¿™é‡Œå¯ä»¥è‡ªå®šä¹‰ä½ çš„è·¯ç”±åˆ†å‘  </span></div><div class="line">  <span class="keyword">var</span> host = req.headers.host, ip = req.headers[<span class="string">'x-forwarded-for'</span>] || req.connection.remoteAddress;  </div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"client ip:"</span> + ip + <span class="string">", host:"</span> + host);  </div><div class="line">    </div><div class="line">  <span class="keyword">switch</span>(host)&#123;  <span class="comment">//æ„æ€æ˜¯ç›‘å¬ä¸‹é¢çš„ipåœ°å€,å¦‚æœåŒ¹é…å°±è½¬åˆ°</span></div><div class="line"><span class="comment">//127.0.0.1:3000åœ°å€</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'192.168.0.101:8080'</span>:    <span class="comment">//ç›‘å¬è¿™ä¸ªåœ°å€</span></div><div class="line">   <span class="comment">//è¿™ä¸ªåœ°å€åœ¨windowä¸Šç”¨ipconfigæŸ¥çœ‹,mac/linuxç”¨ifconfigæŸ¥çœ‹</span></div><div class="line">   </div><div class="line">    <span class="keyword">case</span> <span class="string">'bbs.aaaa.com'</span>:  </div><div class="line">        proxy.web(req, res, &#123; <span class="attr">target</span>: <span class="string">'http://127.0.0.1:3000'</span> &#125;);  <span class="comment">//è½¬åˆ°è¿™ä¸ªåœ°å€</span></div><div class="line">    <span class="keyword">break</span>;  </div><div class="line">    </div><div class="line">    <span class="keyword">default</span>:  </div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;  </div><div class="line">            <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>  </div><div class="line">        &#125;);  </div><div class="line">        res.end(<span class="string">'Welcome to my server!'</span>);  </div><div class="line">  &#125;  </div><div class="line">&#125;);  </div><div class="line">  </div><div class="line"><span class="built_in">console</span>.log(<span class="string">"listening on port 8080"</span>)  </div><div class="line">server.listen(<span class="number">8080</span>);</div></pre></td></tr></table></figure></p>
<p>node proxy.js ä»¥åå¯åŠ¨äº†proxyæœåŠ¡å™¨.å¯ä»¥é€šè¿‡ç”µè„‘çš„ipåœ°å€è®¿é—®127.0.0.1çš„apiè·¯ç”±äº†ã€‚</p>
<p>å¦‚æœæ˜¯ä½¿ç”¨nginxä¹Ÿå¯ä»¥è¾¾åˆ°è¦æ±‚ï¼Œ<br>åœ¨macä¸Šä½¿ç”¨homebrewåŒ…ç®¡ç†ç›¸å½“æ–¹ä¾¿<br> bashä¸‹  å®‰è£… brew install nginx<br>                å¯åŠ¨ brew services start nginx<br>  å¦‚æœå®‰è£…äº†atomç¼–è¾‘å™¨<br>  bashåœ¨ ç›´æ¥  atom /usr/local/etc/nginx/nginx.conf æ‰“å¼€é…ç½®æ–‡ä»¶æœ¬åˆ†ä»¥ååšå‡ºä¿®æ”¹</p>
<p>ä¸‹é¢æ˜¯nginx.confçš„é…ç½®æ–‡ä»¶</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//nginx.conf</span></div><div class="line"></div><div class="line"> #åŸæ¥çš„æ–‡ä»¶å¦å­˜åã€‚ç›´æ¥ä½¿ç”¨ä¸‹é¢å†…å®¹æ›¿æ¢nginx.<span class="keyword">conf</span>çš„å†…å®¹</div><div class="line"></div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections  1024;</div><div class="line">&#125;</div><div class="line">http &#123;</div><div class="line">    <span class="keyword">include</span>       mime.types;</div><div class="line">    default_type  application/octet-stream;</div><div class="line"></div><div class="line">    #log_format  main  '<span class="variable">$remote_addr</span> - <span class="variable">$remote_user</span> [<span class="variable">$time_local</span>] <span class="string">"$request"</span> '</div><div class="line">    #                  '<span class="variable">$status</span> <span class="variable">$body_bytes_sent</span> <span class="string">"$http_referer"</span> '</div><div class="line">    #                  '<span class="string">"$http_user_agent"</span> <span class="string">"$http_x_forwarded_for"</span>';</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    sendfile        <span class="keyword">on</span>;</div><div class="line">    #tcp_nopush     <span class="keyword">on</span>;</div><div class="line"></div><div class="line">    #keepalive_timeout  0;</div><div class="line">    keepalive_timeout  65;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    server &#123;</div><div class="line">        listen 8080;  #ç›‘å¬80880ç«¯å£</div><div class="line">        server_name www.penguu.com 192.168.1.100;  #è¿™é‡Œæ˜¯çœŸæœºè¦è®¿é—®çš„åœ°å€ã€‚</div><div class="line">        # <span class="keyword">Mac</span> é€šè¿‡ç»ˆç«¯ ifconfig æŸ¥çœ‹ã€‚æ¯”å¦‚æˆ‘æŸ¥çœ‹çš„å°±æ˜¯192.168.1.100</div><div class="line">        #æ‰‹æœºè®¿é—®çš„æ¥å£å°±æ˜¯ 192.168.1.100:8080</div><div class="line">        #å®é™…åœ¨23è¡Œç›‘å¬çš„ç«¯å£å¯ä»¥æ˜¯80ç«¯å£ï¼Œç”±äºæµè§ˆå™¨é»˜è®¤å°±æ˜¯80ç«¯å£ã€‚ä½†æ˜¯åœ¨<span class="keyword">mac</span>ä¸­æœ‰æƒé™é—®é¢˜ã€‚æ‰€#ä»¥å°±ä½¿ç”¨8080ç«¯å£</div><div class="line">        # address_bookä¸­çš„serviceä¸­çš„åœ°å€ä¹Ÿè¦ä¿®æ”¹è·¯å¾„æ˜¯</div><div class="line">        # <span class="keyword">view</span>/service.js-&gt;host,ä¿®æ”¹ä¸º 192.168.1.100ï¼š8080</div><div class="line"></div><div class="line">        #access_log /<span class="keyword">var</span>/<span class="keyword">log</span>/nginx/<span class="keyword">test</span>.<span class="keyword">log</span>;</div><div class="line">        location / &#123;</div><div class="line">            proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</div><div class="line">            proxy_set_header X-Forwarded-<span class="keyword">For</span> <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">            proxy_set_header Host  <span class="variable">$http_host</span>;</div><div class="line">            proxy_set_header X-Nginx-Proxy true;</div><div class="line">            proxy_set_header Connection <span class="string">""</span>;</div><div class="line">            proxy_pass      http:<span class="comment">//127.0.0.1:3000;  # address_bookçš„ serveråœ°å€ï¼Œå°±æ˜¯æœ¬åœ°node.jsæœåŠ¡å™¨çš„ipåœ°å€</span></div><div class="line">            #node.jsé»˜è®¤å°±æ˜¯127.0.0.1 ï¼Œport:3000æ˜¯åœ¨<span class="keyword">app</span>.jsä¸­è®¾å®šçš„ã€‚å¯ä»¥ä¿®æ”¹ã€‚</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç”¨javascriptæ¥ç”Ÿäº§ä¸€éƒ¨iPhone8]]></title>
      <url>http://yoursite.com/2017/03/08/%E7%94%A8javascript%E6%9D%A5%E7%94%9F%E4%BA%A7%E4%B8%80%E9%83%A8iPhone8/</url>
      <content type="html"><![CDATA[<p>å…¶å®è¦è°ˆè°ˆjavascriptçš„å¯¹è±¡é“¾ã€‚</p>
<p>å”çº³å¾·.å·æ™® å½“é€‰ç¾å›½ç¬¬å››åäº”ä»»æ€»ç»Ÿã€‚å½“é€‰ä»¥åï¼Œå·æ™®ç«‹å³ç»™è’‚å§†.åº“å…‹æ‰“ç”µè¯<br>   <em>å·æ™®(Trump)</em>ï¼šâ€œæˆ‘è¯´å¨å­å•Šï¼Œæˆ‘æ˜¯ç¾å›½æ€»ç»Ÿï¼Œæˆ‘ç°åœ¨å‘½ä»¤ä½ æŠŠåœ¨ä¸­å›½çš„appleå·¥å‚æ¬å›ç¾å›½ï¼ŒiPhone8å°±åœ¨å›½å†…ç”Ÿäº§ï¼Œå¥½å…‘ç°æˆ‘å¯¹å¹¿å¤§è“é¢†é€‰æ°‘çš„æ‰¿è¯ºå•Šâ€.<br>  <em>åº“å…‹(Cook)</em>:â€œå‘µå‘µï¼Œè¿™æ˜¯ä¸€ä¸ªé¹…å¦¹å­å˜¤çš„å»ºè®®å—·ï¼Œbut noâ€.å»ºåœ¨ä¸­å›½çš„å·¥å‚æ˜¯æ¬ä¸å›æ¥äº†ã€‚</p>
<p>   å¼€ä¸ªç©ç¬‘ç®—æ˜¯å¼€åœºç™½ã€‚ç»è¿‡å‡ å¤©çš„ç†è§£ï¼Œå‘ç°javascriptçš„å¯¹è±¡<br>   é“¾å±…ç„¶å’Œç°ä»£ä¼ä¸šçš„ç”Ÿäº§é“¾å±…ç„¶ååˆ†çš„ç›¸ä¼¼ã€‚å­—é¢éƒ½å¸¦é“¾å•Šã€‚è¿™é‡Œå°±å€Ÿappleçš„iPhone8çš„ç”Ÿäº§æ¥ç†è§£jsçš„å¯¹è±¡é“¾ã€‚å¯èƒ½ä¸æ˜¯ååˆ†è´´åˆ‡ã€‚ä½†æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¸®ä½ ç†è§£ç›¸å…³æ¦‚å¿µã€‚</p>
<p>   è¦å­¦ä¹ jsåŠŸï¼Œå¿…å…ˆè‡ªå®«ï¼Œå¦‚ä¸è‡ªå®«ï¼Œå¿…ä¸æˆåŠŸã€‚  å¦‚æœä½ å¸¦ç€java,C++,phpçš„å¯¹è±¡åŸç†æ¥å­¦ä¹ jsçš„å¯¹è±¡ç»§æ‰¿ï¼Œä¼šæ’å¾—æ»¡å¤´åŒ…ï¼Œå°¤å…¶æ˜¯çœ‹åˆ°å’Œå…¶ä»–è¯­è¨€ä¸€æ ·çš„å…³é”®å­—æ—¶ï¼Œåƒä¸‡ä¸èƒ½æ‹¿è€æ¦‚å¿µæ¥å¥—ã€‚jsè‡ªæˆä½“ç³»ï¼Œæ‰€ä»¥å­¦ä¹ jsçš„å¯¹è±¡é“¾è¦ç†è§£å…¶è‡ªèº«çš„ç‰¹ç‚¹ã€‚æˆ‘å…ˆæ‘†å‡ºæ¥ã€‚1jsä¸­æ˜¯æ²¡æœ‰ç±»è¿™ä¸ªæŠ½è±¡æ¦‚å¿µçš„ï¼Œ<code>jsä¸­éƒ½æ˜¯å¯¹è±¡</code>ã€‚2 jså¯¹è±¡ç»§æ‰¿å®é™…å‘ç”Ÿçš„æ˜¯ä¸€ç§â€œ<em>å§”æ‰˜å…³ç³»</em>â€ã€‚è¿™ç§å§”æ‰˜å…³ç³»æ˜¯jsçš„å¯¹è±¡é“¾çš„ç²¾åæ‰€åœ¨ã€‚</p>
<p>  è¿™ä¸ªâ€œ<em>å§”æ‰˜å…³ç³»</em>â€å¬ç€è€³ç†Ÿå—ï¼Ÿä»€ä¹ˆ?ä¸ç†Ÿã€‚é‚£ä¹ˆå¬è¿‡<code>OEM</code>ä¹ˆï¼Ÿä»€ä¹ˆ?ä¹Ÿæ²¡æœ‰å¬è¿‡<code>OEM</code>ã€‚å¥½å§çŸ¥é“å¯Œå£«åº·ä¹ˆï¼Ÿä»€ä¹ˆï¼Ÿæ²¡å¬è¿‡ï¼ŸåŒå­¦ç«æ˜Ÿå†¬å¤©å†·å—ï¼Ÿ<br>  å¥½å§ï¼ŒOEMå°±æ˜¯ä»£å·¥å·¥å‚ã€‚è¿™æµç¨‹å°±æ˜¯ä¸€ä¸ªå…¬å¸æ“…é•¿è®¾è®¡ï¼Œä½†æ˜¯ä»–ä¸ç”Ÿäº§äº§å“ï¼Œä»–<code>å§”æ‰˜</code>å¦ä¸€ä¸ªæ“…é•¿åˆ¶é€ çš„å·¥å‚ç”Ÿäº§äº§å“ã€‚å¦ä¸€ä¸ªå·¥å‚åˆä¼šæŠŠå…¶ä¸­ä¸€éƒ¨åˆ†ç”Ÿäº§è¿‡ç¨‹<code>å§”æ‰˜</code> ç»™å…¶ä»–å·¥å‚ï¼Œè¿™ä¸ªå§”æ‰˜å…³ç³»å¯ä»¥ä¸€ç›´æŒç»­ä¸‹å»ã€‚å¦‚æœç†è§£jså¯¹è±¡ç»§æ‰¿é“¾çš„äººç«‹åˆ»ä¼šçŸ¥é“æˆ‘è¯´çš„åŸç†ã€‚æ²¡æœ‰ç†è§£ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œä¸‹é¢å°±å€Ÿç€iPhone8çš„ç”Ÿäº§æ¥çœ‹çœ‹è¿™ä¸ª<code>å§”æ‰˜å…³ç³»</code>ã€‚</p>
<p> æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹ç¨å¾®ç®€åŒ–ä¸€ä¸‹ï¼Œè¦ä¸å…¨è¿‡ç¨‹å†™å®Œæˆ‘ä¹Ÿæ²¡æœ‰é‚£ä¸ªèƒ½åŠ›ï¼Œå†™å…¨è¿‡ç¨‹è¦æ‰¾éƒ­æ˜æ± æ¥å†™ã€‚ </p>
<p>  æˆ‘æŠŠip8çš„ç”Ÿäº§ç®€åŒ–ä¸º:<br>    1.ç¡¬ä»¶è®¾è®¡<br>    2.è½¯ä»¶è®¾è®¡<br>    3.åˆè¯•</p>
<pre><code>4. æ•´æœºç”Ÿäº§
5. ç”µæ± ç”Ÿäº§
6. å±å¹•ç”Ÿäº§
7.  å¤–è®¾ç”Ÿäº§
</code></pre><p>ä¸‹é¢ä¼šç”¨ä¸€äº›ä¼ªä»£ç æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚jsä¸­éƒ½æ˜¯å¯¹è±¡ï¼Œæ²¡æœ‰ç±»ã€‚ç±»éƒ½æ˜¯å®ä½“ï¼Œæ˜¯åœ¨å†…å­˜ä¸­å®é™…å­˜åœ¨çš„ã€‚åœ¨æ•´ä¸ªç”Ÿäº§ä¸­çš„å…¬å¸éƒ½æ˜¯å¯¹è±¡ã€‚ç°åœ¨æˆ‘ä»¬çœ‹çœ‹è¿™äº›å¯¹è±¡<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">//è‹¹æœå…¬å¸å¯¹è±¡   </span></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> &#123;</span></div><div class="line">        init()&#123;  <span class="comment">//åˆå§‹åŒ–appleå…¬å¸</span></div><div class="line">             founderï¼š<span class="string">"Steve Jobs"</span>;</div><div class="line">             current <span class="string">leader:</span><span class="string">"Tim Cook"</span>;</div><div class="line"><span class="symbol">             Designer:</span><span class="string">"Ivy"</span>;</div><div class="line">             <span class="string">Location :</span><span class="string">"South. CA"</span></div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         programSoftware()&#123;  <span class="comment">//è½¯ä»¶åˆ¶ä½œå’Œè®¾è®¡</span></div><div class="line">             <span class="keyword">return</span> (<span class="string">" make ios11"</span>)ï¼›</div><div class="line">         &#125;</div><div class="line"></div><div class="line">         designHardware()&#123; <span class="comment">//ç¡¬ä»¶åŸå‹è®¾è®¡</span></div><div class="line">            (<span class="string">" make ios11"</span>)ï¼›  </div><div class="line">            (<span class="string">" make  protype of ip8"</span>)ï¼›</div><div class="line">            (<span class="string">"design cpu of a11 "</span>)ï¼›</div><div class="line">   </div><div class="line">      &#125;</div><div class="line"></div><div class="line">         legalGroup()&#123;  <span class="comment">//æ³•åŠ¡éƒ¨ è´Ÿè´£å’Œåä¸ºæ‰“å®˜å¸</span></div><div class="line">           (<span class="string">"lawsuit with huawei"</span>)</div><div class="line">        &#125;               </div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="comment">//è¿™å°±åœ¨javascripté‡Œé¢ç»™appleå…¬å¸å»ºç«‹äº†ä¸€ä¸ªå¯¹è±¡ï¼Œæ•´ä¸ªå¯¹è±¡æœ‰åˆå§‹åŒ–çš„å±æ€§ï¼Œ è¿˜æœ‰ä¸‰ä¸ªè‡ªå·±æ“…é•¿çš„æ–¹æ³•ã€‚</span></div></pre></td></tr></table></figure></p>
<p> è¯è¯´2007å¹´ï¼Œä¹”å¸ƒæ–¯è¿˜åœ¨ä¸–çš„æ—¶å€™ï¼Œä»–æ‰¾åˆ°å¯Œå£«åº·å…¬å¸è€æ¿éƒ­å°é“­è¯´ï¼šâ€æˆ‘è¯´å°é“­å•Šï¼Œæˆ‘æƒ³æ‰¾ä¸ªå·¥å‚ç”Ÿäº§æ‰‹æœºï¼Œä»¥å‰å¯Œå£«åº·ç”Ÿäº§çš„imacä¸é”™ï¼Œè¿™æ‰è¿˜æ˜¯å§”æ‰˜ä½ ä»¬æ¥ç”Ÿäº§å§â€œ ã€‚éƒ­å°é“­æ˜¯ï¼šå¥½å§ã€‚æˆ‘é©¬ä¸Šå»ºç«‹<code>å¯Œå£«åº·è‹¹æœæ‰‹æœºå·¥å‚</code>ã€‚ä¸ºäº†å¥½ç†è§£æˆ‘åŠ äº†<code>å‘½åç©ºé—´</code>ï¼Œçœ‹è§äº†ä¹ˆ^_^ã€‚2017å¹´ï¼ŒAppleæ¨å‡ºiphone 10å‘¨å¹´äº†ï¼Œåˆè¦å¼€å§‹ç”Ÿäº§äº†ã€‚</p>
  <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//FskAppleè¿™ä¸ªå¯¹è±¡å°±æ˜¯Appleçš„ç»§æ‰¿è€…ï¼Œä»–æœ¬èº«æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸æ˜¯å®ä¾‹åŒ–å‡ºæ¥çš„</span></div><div class="line"><span class="comment">//FskAppleå’ŒAppleå°½ç®¡ç”¨äº†extendså…³é”®å­—ï¼Œä½†æ˜¯ä»–ä»¬æ²¡æœ‰ä»å±å…³ç³»ï¼Œä»…ä»…æ˜¯å§”æ‰˜å…³ç³»è€Œå·²</span></div><div class="line">   FskApple <span class="function"><span class="keyword">extends</span> <span class="title">Apple</span> <span class="params">()</span></span>&#123;</div><div class="line">        init()&#123;  <span class="comment">//fskçš„åˆå§‹åŒ–å±æ€§</span></div><div class="line">           founder:<span class="string">"éƒ­å°é“­"</span>ï¼›</div><div class="line">           location:<span class="string">"éƒ‘å·"</span>ï¼›            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">          makeHardware()&#123; <span class="comment">//ç¡¬ä»¶ç”Ÿäº§    </span></div><div class="line">            (<span class="string">" make  module ip8"</span>)ï¼›     <span class="comment">//ç”Ÿäº§æ¨¡å…·ï¼Œè¿™æ˜¯fskçš„ç‰¹é•¿</span></div><div class="line">           (<span class="string">" Assemble ip8"</span>)ï¼›     <span class="comment">//ç»„è£…iphone8ï¼Œè¿™ä¹Ÿæ˜¯fskçš„ç‰¹é•¿     </span></div><div class="line">  </div><div class="line">         &#125;</div><div class="line"></div><div class="line"></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>  å¯Œå£«åº·å¹¶ä¸ç²¾é€šå±å¹•ç”Ÿäº§ï¼Œæ‰€ä»¥å¯Œå£«åº·æœ‰æŠŠå±å¹•çš„ç”Ÿäº§å§”æ‰˜ç»™äº†LGå…¬å¸.LGå…¬å¸è¦ç»™è‹¹æœç”Ÿäº§æœ€æ–°çš„AMOLEDå±å¹•ã€‚<code>è¿™é‡Œå’Œå®é™…çš„å§”æ‰˜æœ‰å‡ºå…¥åªæ˜¯ä¸ºäº†å¥½ç†è§£</code>. å¥½ä¹ˆåˆä¸€ä¸ªå·¥å‚å‡ºæ¥äº†ã€‚å¯Œå£«åº·LGå·¥å‚ã€‚</p>
   <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">//LGå¯Œå£«åº·å·¥å‚åˆå—fskçš„å§”æ‰˜ç”Ÿäº§</span></div><div class="line">     LgFsk <span class="function"><span class="keyword">extends</span> <span class="title">FskApple</span> <span class="params">()</span></span>&#123;</div><div class="line">      init()&#123;  <span class="comment">//LgFskçš„åˆå§‹åŒ–å±æ€§</span></div><div class="line">         founder:<span class="string">"unknow"</span>ï¼›</div><div class="line">         location:<span class="string">"seoul"</span>ï¼›            </div><div class="line">      &#125;</div><div class="line">      </div><div class="line">        makeScreen()&#123; <span class="comment">//å±å¹•   </span></div><div class="line">          (<span class="string">" make circuit"</span>)ï¼›     <span class="comment">//ç”Ÿäº§èƒŒæ¿ç”µè·¯</span></div><div class="line">         (<span class="string">" make panel"</span>)ï¼›     <span class="comment">//ç”Ÿäº§é¢æ¿     </span></div><div class="line"></div><div class="line">       &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®é™…çš„ç”Ÿäº§çš„å§”æ‰˜å…³ç³»æ¯”è¿™ä¸ªå¤æ‚çš„å¤šï¼Œjsçš„å¯¹è±¡é“¾ä¹Ÿæ¯”è¿™ä¸ªå¤æ‚ä¸€ç‚¹ã€‚æˆ‘åœ¨è¿™é‡ŒæŠŠå®ƒç®€åŒ–ä¸ºä¸€æ¡çº¿çš„å§”æ‰˜å…³ç³»åªæ˜¯ä¸ºäº†å¥½ç†è§£ã€‚</p>
<p>ä¸‰ä¸ªå¯¹è±¡çš„<code>å§”æ‰˜é“¾</code>å»ºæˆä»¥åï¼Œå°±å¯ä»¥æŠ•å…¥ç”Ÿäº§äº†ã€‚å¯Œå£«åº·å…¬å¸è¦è°ƒç”¨ip8çš„è®¾è®¡æ–¹æ³•æ—¶ï¼Œä»–å¹¶ä¸è¦è‡ªå·±å»åˆ›å»ºè¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºä»–ä¸æ“…é•¿è¿™ä¸ªæ–¹æ³•ï¼Œä»–ç›´æ¥åˆ©ç”¨å’Œè‹¹æœå…¬å¸çš„å§”æ‰˜å…³ç³»å€Ÿç”¨è‹¹æœå…¬å¸çš„è®¾è®¡æ–¹æ³•å°±å¯ä»¥äº†ã€‚ è‹¹æœæ˜¯å§”æ‰˜å¯Œå£«åº·æ¥ç”Ÿäº§ï¼Œä»æ•´ä¸ªäº§ä¸šé“¾æ¥è¯´ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯å¯Œå£«åº·å§”æ‰˜è‹¹æœå…¬å¸åšäº†è®¾è®¡å·¥ä½œã€‚è‹¹æœä¸ç”Ÿäº§ï¼Œå¯Œå£«åº·ä¸è®¾è®¡ï¼Œä½†æ˜¯ä¸€æ—¦ä¸¤è€…äº§ç”Ÿå§”æ‰˜å…³ç³»ä»¥åï¼Œä¸¤è€…å¯ä»¥å‘æŒ¥å„è‡ªçš„ç‰¹é•¿ï¼Œ2017å¹´iPhone8å°±åœ¨è¿™ä¸ªå§”æ‰˜é“¾ä¸­ç”Ÿäº§å‡ºæ¥äº†ã€‚</p>
<p> ç°ä»£ä¼ä¸šæƒ³æ”¹å˜è¿™ä¹ˆä¸€ä¸ªå‘æŒ¥å„è‡ªä¼˜åŠ¿çš„é“¾æ—¶å¤šä¹ˆçš„ä¸å®¹æ˜“ï¼Œå†ä¹Ÿæ‰¾ä¸åˆ°æ›´å¥½çš„æ–¹æ³•äº†ã€‚æ‰€ä»¥åº“å…‹è¯´è‹¹æœå·¥å‚å†ä¹Ÿå›ä¸å»äº†ã€‚</p>
<p>ä¸ºæ­¤æˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œæ¯”è¾ƒä¸‘ï¼Œå‡‘æ´»ç€çœ‹å§ã€‚è¿™é‡Œå°±æ˜¯ä¸‰ä¸ªå¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚æˆ‘è§‰å¾—å«è¿æ¥å…³ç³»æ¯”è¾ƒå¥½ä¸€ç‚¹ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-3d40a51a813a002b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="screenshot_20.png"><br>åŸç†å¦‚æ­¤ï¼Œä¸‰ä¸ªå¯¹è±¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œä½†æ˜¯ä¹‹é—´å¹¶ä¸æ˜¯ä»å±å…³ç³»ã€‚å¯¹è±¡éƒ½å…·æœ‰è‡ªå·±æ“…é•¿çš„æ–¹æ³•ï¼Œå…¶ä»–å¯¹è±¡çš„æ–¹æ³•ä¹Ÿä¸æ´»å†è´¹åŠ›å»åšä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚lgè¦è®¾è®¡æ–¹æ³•å¯ä»¥æ‰¾å¯Œå£«åº·ï¼Œå¯Œå£«åº·æ²¡æœ‰çš„è¯åˆå¯ä»¥æ‰¾è‹¹æœã€‚</p>
<p>æˆ‘ä»¬å»æ‰ç»†èŠ‚æ¥çœ‹ï¼Œjsçš„å¯¹è±¡ç»§æ‰¿é“¾åªæ˜¯æœ‰äº›å…³é”®å­—å€Ÿç”¨äº†ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡çš„ä¸œè¥¿ï¼Œä½†æ˜¯å®é™…ä¸Šjså’Œjavaçš„å¯¹è±¡æ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p>
<p>###æœ€åå†å¼ºè°ƒä¸€å¥ï¼šjavascriptä¸­çš„å¯¹è±¡ç»§æ‰¿é“¾ä¸æ˜¯å¯¹è±¡ä¹‹é—´çš„ä»å±å…³ç³»ï¼Œè€Œæ˜¯ä¸€ç§å§”æ‰˜å’Œåˆä½œå…³ç³»ã€‚ç†è§£è¿™ä¸€ç‚¹åé¢çš„å­¦ä¹ å°±å¥½åŠäº†ã€‚</p>
<p>   åˆå­¦è€…æ°´å¹³ï¼Œä¸çŸ¥é“è¿™ä¸ªé€šä¿—ç†è§£æ˜¯å¦å¾—ä½“å’Œå‡†ç¡®ï¼Ÿ</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-Immutable-js,æŒä¹…åŒ–æ•°æ®ç»“æ„å’Œç»“æ„å…±äº«]]></title>
      <url>http://yoursite.com/2017/03/08/%E7%BF%BB%E8%AF%91-Immutable-js,%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%BB%93%E6%9E%84%E5%85%B1%E4%BA%AB/</url>
      <content type="html"><![CDATA[<p><em>ä¸ºä»€ä¹ˆè¦ç”¨Immutable.jsæ¥ä»£æ›¿Javascriptçš„å¯¹è±¡</em></p>
<blockquote>
<p>ç¿»è¯‘ç‰ˆæœ¬,<a href="https://medium.com/@dtinth/immutable-js-persistent-data-structures-and-structural-sharing-6d163fbd73d2#.inlzpjxr8" target="_blank" rel="external">åŸæ–‡è¯·è§</a></p>
<hr>
<p>æŠŠä½ çš„æ•°æ®çœ‹æˆæ˜¯ä¸å¯å˜çš„ä¼šå¸¦æ¥å¾ˆå¤šçš„å¥½å¤„.å®é™…ä¸Šåœ¨ReactèƒŒåæœ‰ä¸ªåŸåˆ™:Reactçš„å…ƒç´ æ˜¯ä¸å¯å˜çš„.ä½ å¯èƒ½ä¹Ÿä¼šå¯¹å­¦ä¹ ä¸å¯å˜Appæ„æ¶æœ‰å¾ˆå¤§å…´è¶£.</p>
</blockquote>
<p>ä½†æ˜¯ä½¿ç”¨Immutable.jsçš„å¥½å¤„æ˜¯:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span> (<span class="params">todos, id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> todos.update(id,</div><div class="line">    (todo) =&gt; todo.update(<span class="string">'completed'</span>,<span class="comment">//updateæ˜¯immutableçš„æ–¹æ³•</span></div><div class="line">      (completed) =&gt; !completed</div><div class="line">    )</div><div class="line">  )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>è·³è¿‡ä½¿ç”¨æ™®é€šçš„Javascriptå¯¹è±¡(æŠŠä»–ä»¬çœ‹ä½œä¸ºimmutable,å¯ä»¥é€‰åˆ™ä½¿ç”¨ä¾‹å¦‚seamless-immutableä¹‹ç±»çš„åŠ©æ‰‹å‡½æ•°),åƒè¿™æ ·ï¼Ÿ:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span> (<span class="params">todos, id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123; &#125;, todos, &#123;</div><div class="line">    [id]: <span class="built_in">Object</span>.assign(&#123; &#125;, todos[id], &#123;</div><div class="line">      <span class="attr">completed</span>: !todos[id].completed</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"><span class="comment">// Using updeep</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleTodo</span> (<span class="params">todos, id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> u(&#123;</div><div class="line">    [id]: &#123;</div><div class="line">      <span class="attr">completed</span>: <span class="function">(<span class="params">completed</span>) =&gt;</span> !completed</div><div class="line">    &#125;</div><div class="line">  &#125;, todos)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="ä¸€ä¸ªéå¸¸å¤§çš„å¯¹è±¡â€¦"><a href="#ä¸€ä¸ªéå¸¸å¤§çš„å¯¹è±¡â€¦" class="headerlink" title="ä¸€ä¸ªéå¸¸å¤§çš„å¯¹è±¡â€¦"></a>ä¸€ä¸ªéå¸¸å¤§çš„å¯¹è±¡â€¦</h3><p>è®©æˆ‘ä»¬å‡è®¾todo list é‡Œé¢æœ‰100,00ä¸ªä»»åŠ¡:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> todos = &#123;</div><div class="line">  â‹®</div><div class="line">  t79444dae: &#123; <span class="attr">title</span>: <span class="string">'Task 50001'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t7eaf70c3</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50002'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t2fd2ffa0</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50003'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t6321775c</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50004'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t2148bf88</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50005'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t9e37b9b6</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50006'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">tb5b1b6ae</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50007'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">tfe88b26d</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50008'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  â‹®</div><div class="line">  (<span class="number">100</span>,<span class="number">000</span> items)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æˆ‘åˆšåˆšå®Œæˆç¬¬50005ä»¶ä»»åŠ¡.<br>ç°åœ¨æˆ‘æƒ³æŠŠå®ƒæ ‡è®°ä½å®Œæˆ.</p>
<h3 id="ä½¿ç”¨æ™®é€šJavascript-å¯¹è±¡"><a href="#ä½¿ç”¨æ™®é€šJavascript-å¯¹è±¡" class="headerlink" title="ä½¿ç”¨æ™®é€šJavascript å¯¹è±¡"></a>ä½¿ç”¨æ™®é€šJavascript å¯¹è±¡</h3><p><code>var nextState=toggleTodo(todos,&#39;t2148bf88&#39;)</code></p>
<p>è¿™ä¸ªå•ä¸€çš„æ“ä½œå“ŸèŠ±è´¹134msæ¥è¿è¡Œ.</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå½“ä½ ä½¿ç”¨<code>Object.assign</code>,Javascriptçš„æµ…å¤åˆ¶æ‹·è´æ¯ä¸€ä¸ªæºçš„æ¯ä¸ªå±æ€§åˆ°ç›®çš„åœ°.ä¸€æ¬¡ä¸€ä¸ª.</p>
<p>æˆ‘ä»¬æœ‰100,000ä¸ªtodos,æ‰€ä»¥æ„å‘³ç€æœ‰100,000ä¸ªå±æ€§è¦æ‹·è´.<br>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦èŠ±è¿™ä¹ˆé•¿çš„æ—¶é—´.</p>
<hr>
<h3 id="ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ</h3><p>åœ¨Javascriptä¸­,å¯¹è±¡é»˜è®¤æ˜¯å¯ä»¥çªå˜(mutable)çš„.<br>å½“ä½ å…‹éš†ä¸€ä¸ªå¯¹è±¡,Javascriptæœ‰æ¯ä¸€ä¸ªå±æ€§çš„æ‹·è´,æ‰€ä»¥ä¸¤ä¸ªå¯¹è±¡å˜å¾—å®Œå…¨åˆ†ç¦»çš„.çœ‹ä¸‹å›¾<br><img src="https://ww3.sinaimg.cn/large/006tKfTcly1fdobo2he6bj312w0i2dgz.jpg" alt="100,000ä¸ªå±æ€§è¢«(æµ…)å¤åˆ¶åˆ°ç›®çš„åœ°"></p>
<p>è¿™å°±å…è®¸ä½ åœ¨æ‹·è´ä»¥åæ”¹å˜ä»»ä½•å¯¹è±¡çš„å±æ€§,å¯¹è±¡ä¹‹é—´ä¹Ÿä¸ä¼šç›¸äº’å½±å“.ç”šè‡³åœ¨æŠŠè¿™äº›å¯¹è±¡å¤„ç†ä¸ºä¸å¯å˜(immutable),Javascriptä¹Ÿè¿˜æ˜¯æŒ‰ç…§mutableæ¥å¤„ç†.</p>
<hr>
<h3 id="ä½¿ç”¨Immutable-js"><a href="#ä½¿ç”¨Immutable-js" class="headerlink" title="ä½¿ç”¨Immutable.js"></a>ä½¿ç”¨Immutable.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> todos = Immutable.fromJS(&#123;</div><div class="line">  â‹®</div><div class="line">  t79444dae: &#123; <span class="attr">title</span>: <span class="string">'Task 50001'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t7eaf70c3</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50002'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t2fd2ffa0</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50003'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t6321775c</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50004'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t2148bf88</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50005'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">t9e37b9b6</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50006'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">tb5b1b6ae</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50007'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  <span class="attr">tfe88b26d</span>: &#123; <span class="attr">title</span>: <span class="string">'Task 50008'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</div><div class="line">  â‹®</div><div class="line">  (<span class="number">100</span>,<span class="number">000</span> items)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>ä½¿ç”¨<code>Immutable.Map</code>æ¥ä»£è¡¨æˆ‘ä»¬çš„æ•°æ®,æ›´æ–°ç¬¬50005æ¡ä»»åŠ¡<br><code>var nextState=toggleTodo(todos,&#39;t2148bf88&#39;)</code></p>
<p>è¿™ä¸ªæ“ä½œä»…èŠ±è´¹1.2msæ—¶é—´å»è¿è¡Œ.é€Ÿåº¦æå‡äº†100å€ä»¥ä¸Šï¼</p>
<p>ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå¿«ï¼Ÿ</p>
<h3 id="æŒä¹…æ•°æ®ç»“æ„"><a href="#æŒä¹…æ•°æ®ç»“æ„" class="headerlink" title="æŒä¹…æ•°æ®ç»“æ„"></a>æŒä¹…æ•°æ®ç»“æ„</h3><p>æŒä¹…æ•°æ®ç»“æ„(Persistent data structures)å¼ºåŠ›é™åˆ¶æ‰€æœ‰çš„æ“ä½œéƒ½è¦è¿”å›æ•°æ®ç»“æ„çš„æ–°ç‰ˆæœ¬,ä¿æŒåŸæ•°æ®ç»“æ„çš„å®Œæ•´æ€§,ä¸èƒ½æ›´æ”¹åŸæ•°æ®ç»“æ„.</p>
<p>è¿™ä¸€ç‚¹æš—ç¤ºæ‰€æœ‰çš„æŒä¹…åŒ–æ•°æ®éƒ½æ˜¯ä¸å¯å˜çš„.</p>
<p>åœ¨è¿™ä¸ªç»™å®šçš„é™åˆ¶ä¸‹,å®ç°æŒä¹…åŒ–æ•°æ®ç»“æ„çš„åº“å¯ä»¥è¿›è¡Œå¾ˆå¥½çš„ä¼˜åŒ–,å› ä¸ºè¿™äº›åº“çŸ¥é“æˆ‘ä»¬ä¸ä¼šæ”¹å˜æˆ‘ä»¬çš„æ•°æ®.</p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¼˜åŒ–</p>
<h3 id="ä½¿ç”¨triesæ¥ä¼˜åŒ–"><a href="#ä½¿ç”¨triesæ¥ä¼˜åŒ–" class="headerlink" title="ä½¿ç”¨triesæ¥ä¼˜åŒ–"></a>ä½¿ç”¨triesæ¥ä¼˜åŒ–</h3><p>ä¸ºäº†ç›´è§‚ä¸€ç‚¹,è¯•ä¸€ä¸ªå°ä¾‹å­</p>
<p>æƒ³è±¡å­˜å‚¨ä¸€ä¸ªé”®-å€¼æ˜ å°„:</p>
<p><img src="https://ww1.sinaimg.cn/large/006tKfTcly1fdocl8z802j304d08fglh.jpg" alt=""></p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ•°æ®ç»“æ„å­˜å‚¨åˆ°å•ä¸€çš„Javascirptå¯¹è±¡ä¸­:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">const</span> data = &#123;</div><div class="line">  <span class="attr">to</span>: <span class="number">7</span>,</div><div class="line">  <span class="attr">tea</span>: <span class="number">3</span>,</div><div class="line">  <span class="attr">ted</span>: <span class="number">4</span>,</div><div class="line">  <span class="attr">ten</span>: <span class="number">12</span>,</div><div class="line">  <span class="attr">A</span>: <span class="number">15</span>,</div><div class="line">  <span class="attr">i</span>: <span class="number">11</span>,</div><div class="line">  <span class="attr">in</span>: <span class="number">5</span>,</div><div class="line">  <span class="attr">inn</span>: <span class="number">9</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªtrieæ¥ä»£æ›¿jsçš„å¯¹è±¡å‘¢ï¼Ÿä»–çš„ç»“æ„çœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š<br><img src="https://ww1.sinaimg.cn/large/006tKfTcly1fdocnlha2cj30eo0bhdg5.jpg" alt=""></p>
<p>åŸºæœ¬ä¸Šä½ å¯æ ¹æ®å›¾ä¸Šçš„è·¯å¾„ä»rootå¼€å§‹è·å–åˆ°ä½ éœ€è¦çš„å€¼.</p>
<p>å¦‚æœä½ ä»rootå¼€å§‹æ‰¾<code>data.in</code>,æ ¹æ®æ ‡è®°<code>i</code>å’Œ<code>n</code>çš„è·¯å¾„.å¯ä»¥æ‰¾åˆ°åŒ…å«<code>5</code>çš„èŠ‚ç‚¹.</p>
<p>é‚£ä¹ˆ,æ€ä¹ˆä¿®æ”¹å‘¢ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹æŠŠé”®<code>tea</code>çš„å€¼ä»<code>3</code>æ”¹ä¸º<code>14</code>.</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„trieï¼Œå°½å¯èƒ½çš„ä½¿ç”¨å­˜åœ¨çš„èŠ‚ç‚¹.</p>
<p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1fdocttxa1tj30cq0a7mxf.jpg" alt=""></p>
<p>è€çš„æ ‘å½¢ç»“æ„ä»ç„¶å­˜åœ¨,è€Œä¸”æ²¡æœ‰å˜åŒ–.åœ¨å®ä¾‹ä¸­ä½ å¯ä»¥ä¿ç•™ä¸€ä¸ªå¼•ç”¨</p>
<p><img src="https://ww4.sinaimg.cn/large/006tNc79ly1fdocuasnscj30f00clwf2.jpg" alt=""></p>
<p>åœ¨ä¸Šå›¾ä¸­å¦‚ç»¿è‰²éƒ¨åˆ†æ‰€ç¤º,æˆ‘ä»¬ä»…ä»…åªéœ€è¦æ›´æ–°4ä¸ªèŠ‚ç‚¹æ¥æ›´æ–°è¿™ä¸ªæ•°.å…¶ä»–çš„èŠ‚ç‚¹æ˜¯å¯ä»¥é‡æ–°åˆ©ç”¨çš„ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªå›¾å±•ç¤ºImmutable.jsæ€ä¹ˆå®æ–½<code>Immutable.Map</code>.åˆ›å»ºä¸€ä¸ªæ¯ä¸ªèŠ‚ç‚¹æœ‰32ä¸ªåˆ†æ”¯çš„æ ‘.</p>
<p><img src="https://ww4.sinaimg.cn/large/006tNc79ly1fdodbub78oj30h20cpab6.jpg" alt="Immutable.Mapçš„å®æ–½"></p>
<p> å½“æˆ‘ä»¬æ›´æ–°ä¸€ä¸ªå•ä¸ªé¡¹ç›®,ä»…ä»…åªè¦ä¸€äº›èŠ‚ç‚¹éœ€è¦è¢«é‡æ–°åˆ›å»º.</p>
<p> Immutable.jså€ŸåŠ©crazy advanced techniquesä¿æŒæ ‘å½¢ç»“æ„çš„ç´§å‡‘,æ ¹æ®å„ç§å­æ ‘çš„å„ç§å±æ€§æ¥åˆ›å»ºå¤šç§ç±»å‹çš„èŠ‚ç‚¹.</p>
<p> <img src="https://ww1.sinaimg.cn/large/006tNc79ly1fdoe03ud5ej30h907wt9c.jpg" alt=""></p>
<h3 id="å¹¶ä¸æ€»æ˜¯å¦‚æ­¤â€¦"><a href="#å¹¶ä¸æ€»æ˜¯å¦‚æ­¤â€¦" class="headerlink" title="å¹¶ä¸æ€»æ˜¯å¦‚æ­¤â€¦"></a>å¹¶ä¸æ€»æ˜¯å¦‚æ­¤â€¦</h3><p> ä¸è¦æŠŠæœ¬é—®çš„æœ¬æ„ç†è§£ä¸ºâ€œä½ æ€»æ˜¯éœ€è¦Immutable.jsâ€œ.ä¸æ˜¯è¿™ä¸ªæ„æ€,æˆ‘åªæ˜¯æƒ³å¼ºè°ƒä¸€ä¸‹ä»–çš„å¥½å¤„.è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæ¨èè¦ä½¿ç”¨ä»–.</p>
<p>  æ•°æ®ç»“æ„æ˜¯å¾ˆé‡è¦çš„,ä½†æ˜¯å½“æˆ‘ç¼–å†™è½¯ä»¶çš„æ—¶å€™,æˆ‘é¦–å…ˆè¦å°è¯•æœ€ç®€å•çš„æ–¹å¼.æˆ‘è¿‡å»ä½¿ç”¨æ•°ç»„å’Œå¯¹è±¡,ä¹‹åå½“æˆ‘éœ€è¦é€Ÿåº¦æå‡çš„æ—¶å€™,æˆ‘ä½¿ç”¨Immutable.js,æˆ–è€…æ˜¯åœ¨æˆ‘é‡åˆ°åˆ°æˆ‘éœ€è¦ä»–çš„æ—¶å€™.åœ¨åªè¦å°‘æ•°çš„æ¡ç›®,è¿˜æœ‰å°çš„å¯¹è±¡å’Œé›†åˆçš„æ—¶å€™,æˆ‘å°±ä¸ä¼šä½¿ç”¨Immutable.js.</p>
<h2 id="æ˜¯ä¸æ˜¯æ„æ€æ˜¯æˆ‘å¯èƒ½ä¼šè¿”å›å»å¹¶ä¸”åœ¨åé¢åœ¨æ”¹å˜"><a href="#æ˜¯ä¸æ˜¯æ„æ€æ˜¯æˆ‘å¯èƒ½ä¼šè¿”å›å»å¹¶ä¸”åœ¨åé¢åœ¨æ”¹å˜" class="headerlink" title="æ˜¯ä¸æ˜¯æ„æ€æ˜¯æˆ‘å¯èƒ½ä¼šè¿”å›å»å¹¶ä¸”åœ¨åé¢åœ¨æ”¹å˜?"></a>æ˜¯ä¸æ˜¯æ„æ€æ˜¯æˆ‘å¯èƒ½ä¼šè¿”å›å»å¹¶ä¸”åœ¨åé¢åœ¨æ”¹å˜?</h2><p>  å¯¹ï¼éå¸¸å¥½ï¼å¦‚æœä½ çš„æ•°æ®æ¥å…¥æ˜¯é€šè¿‡å•ä¸€,ç»„ç»‡è‰¯å¥½çš„æ¨¡å—.ä¾‹å¦‚:</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">// -- Todos.js --</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> empty = &#123; &#125;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params">todos, id, todo</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123; &#125;, todos, &#123; [id]: todo &#125;)</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getById</span> (<span class="params">todos, id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> todos[id]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>ä¼°è®¡æ‰€æœ‰çš„åº”ç”¨ä»£ç æ€»æ˜¯è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å—æ¥è·å–æ•°æ®.å½“ä½ æƒ³æ”¹å˜å†…å«çš„æ•°æ®ç»“æ„æ—¶,ä½ ä»…ä»…éœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶.</p>
<p>è¿™ä¸ªæˆ‘ä»¬å«åšâ€å®ä½“æ¨¡å—â€œ,å°è£…äº†ä»£è¡¨æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿçš„æ‰€æœ‰å†…å®¹.è¿™ä¸ªæ¦‚å¿µæ¥è‡ªâ€Clean Architectureâ€œ.æˆ‘è®¡åˆ’ä»¥åæ¥å†™å†™è¿™ä¸ªé—®é¢˜.</p>
<h2 id="ä¸è¦æŠŠåº”ç”¨çš„é€»è¾‘å’Œæ•°æ®ç»“æ„è€¦åˆåœ¨ä¸€èµ·"><a href="#ä¸è¦æŠŠåº”ç”¨çš„é€»è¾‘å’Œæ•°æ®ç»“æ„è€¦åˆåœ¨ä¸€èµ·" class="headerlink" title="ä¸è¦æŠŠåº”ç”¨çš„é€»è¾‘å’Œæ•°æ®ç»“æ„è€¦åˆåœ¨ä¸€èµ·"></a><code>ä¸è¦æŠŠåº”ç”¨çš„é€»è¾‘å’Œæ•°æ®ç»“æ„è€¦åˆåœ¨ä¸€èµ·</code></h2><p>æˆ‘å¾ˆäº†è§£åº”ç”¨é€»è¾‘å’Œæ•°æ®ç»“æ„ä¸è€¦åˆåœ¨ä¸€èµ·çš„è‰°éš¾ä¹‹å¤„.è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“åœ¨æœªæ¥æ•°æ®æ€ä¹ˆæ¥è·å–.</p>
<p>ä¾‹å¦‚:æˆ‘ä»¬çš„todo appç°åœ¨ç®¡ç†ç€100,000ä»»åŠ¡.æˆ‘ä»¬æ”¹ä¸ºä½¿ç”¨Immytable.js.ç°åœ¨æ¯ä¸ªéƒ¨åˆ†éƒ½è¶³å¤Ÿå¥½å’Œè¶³å¤Ÿå¿«.</p>
<p>çªç„¶éœ€æ±‚æ¥äº†:â€ä»»åŠ¡è¦æœ‰ä¸€ä¸ªå®‰æ’è€…â€.(ç±»ä¼¼è€å¸ˆå¸ƒç½®ä½œä¸šç»™å­¦ç”Ÿ),â€ç”¨æˆ·åº”è¯¥å¯ä»¥çœ‹åˆ°ä»»åŠ¡æ˜¯è°ç»™å®‰æ’çš„â€.</p>
<pre><code class="js"> <span class="function"><span class="keyword">function</span> <span class="title">findByAssigneeAsArray</span> (<span class="params">todos, assigneeId</span>) </span>{
  <span class="keyword">return</span> todos.filter(
    <span class="function">(<span class="params">task</span>) =&gt;</span> Task.containsAssignee(task, assigneeId)
  ).toArray()
}
</code></pre>
<hr>
<p>ç”¨æˆ·å¼€å§‹æŠ±æ€¨appå˜æ…¢äº†,åˆ†ææ­ç¤ºä¸Šé¢è¿™ä¸ªå‡½æ•°æ˜¯ä¸ªå¤§é—®é¢˜.</p>
<p>ä½¿ç”¨ä¸Šé¢è¿™æ®µä»£ç éœ€è¦åºåˆ—æœç´¢100ï¼Œ000ä»»åŠ¡.è¿™æ ·åšæ€ä¹ˆèƒ½å¿«çš„èµ·æ¥ï¼Ÿ</p>
<h3 id="è¦ä¼˜åŒ–è¿™ä¸ªæ¡ˆä¾‹-æˆ‘ä»¬éœ€è¦æ”¹å˜å†…åœ¨çš„æ•°æ®ç»“æ„"><a href="#è¦ä¼˜åŒ–è¿™ä¸ªæ¡ˆä¾‹-æˆ‘ä»¬éœ€è¦æ”¹å˜å†…åœ¨çš„æ•°æ®ç»“æ„" class="headerlink" title="è¦ä¼˜åŒ–è¿™ä¸ªæ¡ˆä¾‹,æˆ‘ä»¬éœ€è¦æ”¹å˜å†…åœ¨çš„æ•°æ®ç»“æ„"></a>è¦ä¼˜åŒ–è¿™ä¸ªæ¡ˆä¾‹,æˆ‘ä»¬éœ€è¦æ”¹å˜å†…åœ¨çš„æ•°æ®ç»“æ„</h3><p>è¿™éœ€è¦ä¿æŒä¸€ä¸ªåå‘çš„æŸ¥è¯¢è¡¨,è¿æ¥ä»»åŠ¡å®‰æ’äººå’Œä»»åŠ¡åˆ—è¡¨çš„TaksID.è¿™ä¸ªä¼˜åŒ–çš„ä¿®æ”¹å®ä¾‹æ¥è‡ªäº<code>[Taskworld](https://taskworld.com/)</code>.</p>
<p>å¦‚æœæˆ‘ä»¬çš„reducer/selector/viewä»£ç å’Œæ•°æ®ç»“æ„ç›´æ¥è¿ç³»åœ¨ä¸€èµ·,è¦åšå‡ºè¿™æ ·çš„æ”¹å˜éå¸¸éš¾.</p>
<p>æ‰€ä»¥,å¦‚æœæˆ‘ä»¬æƒ³å¿«é€Ÿè¿­ä»£,æˆ‘ä»¬éœ€è¦ç¡®ä¿å¾ˆå®¹æ˜“åšå‡ºä¿®æ”¹.ä»å¼€å§‹å°±ä¿æŒä»£ç æ•´æ´,ä¹¦å†™æµ‹è¯•,å»ºç«‹æŒç»­é›†æˆ.</p>
<h3 id="æ„Ÿè°¢é˜…è¯»ï¼"><a href="#æ„Ÿè°¢é˜…è¯»ï¼" class="headerlink" title="æ„Ÿè°¢é˜…è¯»ï¼"></a>æ„Ÿè°¢é˜…è¯»ï¼</h3><p> æ›´å¤šçš„è®¨è®ºåœ¨<a href="https://www.reddit.com/r/reactjs/comments/5h7pqz/persistent_data_structures_and_structural_sharing/" target="_blank" rel="external">Reddit</a>.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-Redux-Saga-helloï¼Œworld!]]></title>
      <url>http://yoursite.com/2017/03/08/%E7%BF%BB%E8%AF%91-Redux-Saga-hello%EF%BC%8Cworld!/</url>
      <content type="html"><![CDATA[<p>12 OCTOBER 2016</p>
<blockquote>
<p>è¿™æ˜¯ç¿»è¯‘ç‰ˆæœ¬,<a href="https://ohyayanotherblog.ghost.io/redux-saga-hello-world/" target="_blank" rel="external">åŸæ–‡è¯·è§</a></p>
</blockquote>
<hr>
<p><a href="http://www.jianshu.com/p/6f8678a6ad78" target="_blank" rel="external">ç¬¬ä¸€éƒ¨åˆ†è¯‘æ–‡è¯·è§</a>ï¼Œ<br><a href="http://www.jianshu.com/p/fad0136e77c0" target="_blank" rel="external">ç¬¬äºŒéƒ¨åˆ†è¯‘æ–‡è¯·è§</a>ï¼Œ<br><a href="http://www.jianshu.com/p/88fc4236b505" target="_blank" rel="external">ç¬¬ä¸‰éƒ¨åˆ†è¯‘æ–‡è¯·è§</a>.</p>
<hr>
<p>##ç®€å•çš„Redux Saga æ¨¡æ¿</p>
<p>åœ¨è¿™ä¸ªæ–‡ç« ä¸­,æˆ‘ä»¬å°†å®Œæˆå®Œæ•´çš„React/Redux/Redux Saga app,å¹¶ä¸”æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆè¦è¿™æ ·åš.</p>
<p>æˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªappçš„æ¨¡æ¿ä½œä¸ºæœ¬æ–‡çš„èµ·ç‚¹,æˆ‘ä»¬æ²¡æœ‰å¿…è¦å…³æ³¨ä¸€äº›å¼€å‘çš„ç»†èŠ‚,å› ä¸ºè¿™äº›ç»†èŠ‚ä¸æ˜¯æœ¬ç³»åˆ—æ–‡ç« çš„é‡ç‚¹(æˆ‘å‡è®¾ä½ å·²ç»äº†è§£React,Reduxä»¥åŠä¸æ­¤ç›¸å…³çš„å¼€å‘å·¥å…·.)ä½†æ˜¯æˆ‘ä»ç„¶ä¼šç®€å•å¼ºè°ƒä¸€äº›å†…å®¹,ä»¥ä¾¿äºä½ å¯¹é¡¹ç›®ä¾èµ–åŒ…å’Œé…ç½®æœ‰ä¸€äº›åŸºç¡€çš„äº†è§£.ä½ å¯èƒ½æ˜¯ä¸ªé«˜æ‰‹,æˆ–è€…æ˜¯ä¸ªä¸æŠ˜ä¸æ‰£çš„èœé¸Ÿ(æ˜¯èœé¸Ÿä¹Ÿæ²¡æœ‰å…³ç³»)å¦‚æœä½ ä¸å…³å¿ƒè¿™äº›åŸºç¡€å†…å®¹,ç›´æ¥è·³åˆ°é‚£å‰¯å›¾ç‰‡,çœ‹çœ‹åé¢çš„å†…å®¹.</p>
<p>ç¬¬ä¸€æ­¥,å…‹éš†repo,å¹¶ä¸”å®‰è£…ä¾èµ–åŒ…:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//åŸæ–‡çš„repoä¸èƒ½è¿è¡Œäº†,ä¸‹é¢çš„repoæ˜¯éªŒè¯è¿‡çš„</span></div><div class="line">  git clone https:<span class="comment">//github.com/granmoe/redux-saga-clock-tutorial.git  </span></div><div class="line">cd redux-saga-clock-tutorial  </div><div class="line">npm i</div></pre></td></tr></table></figure></p>
<hr>
<p>å¥½äº†åšå®Œä¸Šé¢çš„å·¥ä½œ,ä½¿ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€é¡¹ç›®,è®©æˆ‘ä»¬å…ˆçœ‹çœ‹é‡Œé¢æœ‰äº›ä»€ä¹ˆå†…å®¹.<br>åœ¨æˆ‘ä»¬çš„package.jsonæ–‡ä»¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯éå¸¸æ ‡å‡†çš„,ä½†æ˜¯è¦æ³¨æ„,å¦‚æœè¦å¯¹ä»˜ä¸æ”¯æŒES2015æ ‡ç –çš„æµè§ˆå™¨,éœ€è¦å¼•å…¥babel-polyfillåŒ….è¿™ä¸ªåŒ…å¿…é¡»åœ¨redux-sagaä¹‹å‰å¼•å…¥(è¯‘è€…:redux-sagaä½¿ç”¨äº†ES2015çš„æŠ€æœ¯ï¼Œæ‰€ä»¥è¦å…ˆè·å¾—æ”¯æŒæ‰å¯ä»¥).</p>
<p>ä½ ä¹Ÿå¯ä»¥æ³¨æ„åˆ°,åœ¨package.jsonä¸­æœ‰ESLintä¾èµ–åŒ…,å› ä¸ºæˆ‘å‘ç°è¿™ä¸ªä¾èµ–åŒ…æ˜¯å¼€å‘ä¸­çš„æ— ä»·ä¹‹å®.</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬çš„babelé…ç½®,åœ¨.babelrcæ–‡ä»¶ä¸­:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"><span class="string">"presets"</span>: [<span class="string">"es2015"</span>, <span class="string">"react"</span>, <span class="string">"stage-2"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>æˆ‘å·²ç»å†³å®šä½¿ç”¨es2015,reactå’Œstage-2.</p>
<p>æˆ‘è¿˜æƒ³è®²è®².eslintrcæ–‡ä»¶,ä½†æ˜¯æˆ‘å®åœ¨æ˜¯ä¸æƒ³è®©ä½ çœ‹åˆ°æƒ³ç¡è§‰.</p>
<p>webpackå’Œindex.htmlæ–‡ä»¶æ²¡è®²,ä½†æ˜¯è¿™é‡Œä¼°è®¡æ²¡æœ‰äººä¼šå¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶æ„Ÿå…´è¶£.</p>
<p>#å¼€å§‹è¿›å…¥æ­£é¢˜å§<br><img src="http://upload-images.jianshu.io/upload_images/2044710-6a256c33dfea1ba8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="patrick Stewart McKellan Elmo.jpg"><br> appçš„å…¥å£æ–‡ä»¶æ˜¯main.jsx:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">import</span> <span class="string">'babel-polyfill'</span> <span class="comment">// generator support  </span></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>  </div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>  </div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'app.jsx'</span>  </div><div class="line"><span class="keyword">import</span> initStore <span class="keyword">from</span> <span class="string">'store'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> store = initStore()</div><div class="line"></div><div class="line">ReactDOM.render(  </div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div></pre></td></tr></table></figure>
<hr>
<p> è¿™é‡Œæˆ‘ä»¬å¯¼å…¥ä¸€äº›ä¾èµ–é¡¹(åŒ…æ‹¬babel-polyfill),å¯¼å…¥æ ¹ç»„ä»¶,redux storeçš„é…ç½®,å®ä¾‹åŒ–store,ç„¶ååœ¨ç»è¿‡Provider classåŒ…è£…çš„â€appâ€divçš„ä¸­ä½¿ç”¨ReactDOMæ¸²æŸ“å‡ºæ ¹ç»„ä»¶,è¿™æ ·ä»¥æ¥,åœ¨appä¸­æ‰€æœ‰ç»„ä»¶æ ‘ç§çš„reactç»„ä»¶éƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„æ¥å…¥åˆ°æˆ‘ä»¬çš„storeå®ä¾‹.</p>
<p> æŸ¥çœ‹store.js,ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨saga middlewareæ¥é…ç½®æˆ‘ä»¬çš„store:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> createSagaMiddleware <span class="keyword">from</span> <span class="string">'redux-saga'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </div><div class="line">  <span class="keyword">const</span> sagaMiddleware = createSagaMiddleware()</div><div class="line"></div><div class="line">  <span class="keyword">const</span> store = createStore(</div><div class="line">    rootReducer,</div><div class="line">    applyMiddleware(sagaMiddleware)</div><div class="line">  )</div><div class="line"></div><div class="line">  sagaMiddleware.run(rootSaga)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> store</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p> é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>createSagaMiddleware</code>æ–¹æ³•æ¥åˆ›å»ºmiddlewareå®ä¾‹.æ¥ä¸‹æ¥,æŠŠæ ¹reducerå’Œmiddlewareä¼ é€’åˆ°<code>createStore</code>,è¿™å°±åˆ›å»ºäº†ä¸€ä¸ªredux store.ç„¶åæŠŠæˆ‘ä»¬appçš„root sagaä¼ é€’è¿›saga middleware.è¿™ä¸€æ­¥ä¸€å®šè¦åœ¨redux storeå®ä¾‹åŒ–ä»¥åå†æ‰§è¡Œ.<code>rootSaga</code>æ˜¯é¡¶çº§generator,è¿™ä¸ªgeneratorè´Ÿè´£ä»£ç†å…¶ä»–æ‰€æœ‰çš„generatorsçš„å·¥ä½œ(é©¬ä¸Šä¼šçœ‹åˆ°.)</p>
<p> ##ä¸Šé¢éƒ½æ˜¯äº›ä»€ä¹ˆè§é¬¼çš„ä»£ç ,ä½ ä¸ªç‹å…«è›‹(è¯‘è€…:åŸæ„ç›´æ¥ç¿»è¯‘å•Š)<br> å…¶å®æˆ‘ä»¬å·²ç»æœ‰äº†æœ‰è¶£çš„ä¸œè¥¿,æˆ‘ä»¬çš„ä»£ç åŸºæœ¬ä¸Šä¾èµ–ä¸¤ä¸ªæ–‡ä»¶.â€app.jsxâ€æ˜¯ä¸€ä¸ªreactç»„ä»¶,å¯ä»¥æ ¹æ®appçš„stateå’ŒåŸºäºDOMäº‹ä»¶ç³»ç»Ÿçš„actionsæ¥è¿”å›æ¸²æŸ“çš„htmlæ ‡è®°.â€duck.jsâ€åŒ…å«å•çº¯å¯¹è±¡actionså’Œreducer,è¿™ä¸¤ä¸ªå‡½æ•°ä¸€èµ·å·¥ä½œæè¿°å‡ºæ€ä¹ˆä¿®æ”¹state.å…¶ä¸­ä¹ŸåŒ…å«äº†æ‰€æœ‰çš„æ§åˆ¶æµä»£ç ,æ§åˆ¶æµä»£ç æè¿°äº†æ•´ä¸ªappçš„å¤„ç†è¿‡ç¨‹.å¦‚æœä½ å¾ˆç†Ÿæ‚‰æ ‡å‡†çš„é¸­å­æ¨¡å‹,æˆ‘ä»…ä»…ä¿®æ”¹äº†é¸­å­æ¨¡å‹,è®©ä»–å¾ˆå®¹æ˜“åŒ…å«sagaä»£ç .è®©æˆ‘ä»¬ä½¿ç”¨é¸­å­æ¨¡å—æ¥å·¥ä½œå§.</p>
<p>  æˆ‘ä»¬å°†ä¼šåˆ›å»ºä¸€ä¸ªå¯ä»¥æ§åˆ¶çš„æ—¶é’Ÿ.å¼€å§‹æ¥æƒ³æƒ³appéœ€è¦çš„æœ€ç²¾ç®€çš„sateç»“æ„.åœ¨ä»»ä½•æ—¶é—´æˆ‘ä»¬è¦è¯¢é—®appçš„çŠ¶æ€æ˜¯â€ç°åœ¨å‡ ç‚¹äº†ï¼Ÿâ€æ‰€æœ‰æˆ‘ä»¬éœ€è¦å­˜å‚¨çš„å°±æ˜¯å•ä¸ªçš„æ•°å­—.ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆæ”¹å˜è¿™ä¸ªçŠ¶æ€.å¥½çš„,æˆ‘ä»¬æˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªæ—¶é’Ÿ,ç”¨æˆ·å¯ä»¥å‘å‰,å‘å,æš‚åœå’Œé‡ç½®.è¿™é‡Œçš„æ„æƒ³æ„å‘³ç€æˆ‘ä»¬è¡¨å¾æ—¶é—´çš„ä»£ç é€»è¾‘éœ€è¦å¢,å‡,ä»€ä¹ˆä¹Ÿä¸åš,é‡ç½®åˆ°0.ä»€ä¹ˆäº‹ä¹Ÿä¸åšæ„å‘³ç€ä¸éœ€è¦sateå‘ç”Ÿæ”¹å˜,æ‰€ä»¥æˆ‘ä»¬ç•™ä¸‹å¢åŠ ,å‡å°‘,é‡ç½®.æˆ‘ä»¬è¦æ˜¾ç¤ºæ—¶é—´çš„æ¯«ç§’æ•°,å› æ­¤appçš„stateå°±å®šä¸ºâ€æ¯«ç§’æ•°â€.</p>
<p>  æ­£å¦‚ä¸Šé¢æ‰€è®²çš„,æˆ‘ä»¬åœ¨reduxä»£ç ä¸­ä½¿ç”¨é¸­å­æ¨¡å‹,å¦‚æœä½ ä¸å–œæ¬¢è¿™æ ·åš,å¯ä»¥åˆ†å‰²æˆä¸‰ä¸ªæ–‡ä»¶.<br>  è®©æˆ‘ä»¬çœ‹çœ‹duck.jsä¸­çš„ç¬¬ä¸€éƒ¨åˆ†,<code>saga actions</code>.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">import</span> &#123; takeLatest &#125; <span class="keyword">from</span> <span class="string">'redux-saga'</span></div><div class="line"><span class="keyword">const</span> initialState = &#123;  </div><div class="line">  <span class="attr">milliseconds</span>: <span class="number">0</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">reducer</span> (<span class="params">currentState = initialState, action</span>) </span>&#123;  </div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'reset-clock'</span>:</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        ...currentState,</div><div class="line">        <span class="attr">milliseconds</span>: <span class="number">0</span></div><div class="line">      &#125;</div><div class="line">    <span class="keyword">case</span> <span class="string">'increment-milliseconds'</span>:</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        ...currentState,</div><div class="line">        <span class="attr">milliseconds</span>: currentState.milliseconds + <span class="number">100</span></div><div class="line">      &#125;</div><div class="line">    <span class="keyword">case</span> <span class="string">'decrement-milliseconds'</span>:</div><div class="line">      <span class="keyword">if</span> (!currentState.milliseconds) &#123; <span class="keyword">return</span> currentState &#125;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        ...currentState,</div><div class="line">        <span class="attr">milliseconds</span>: currentState.milliseconds - <span class="number">100</span></div><div class="line">      &#125;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> currentState</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> resetClock = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'reset-clock'</span> &#125;) </div><div class="line"> </div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> incrementMilliseconds = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'increment-milliseconds'</span> &#125;)  </div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> decrementMilliseconds = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'decrement-milliseconds'</span> &#125;)</div></pre></td></tr></table></figure>
<hr>
<p> ä¸Šé¢è¿™æ®µä»£ç å¾ˆç®€å•.é¦–å…ˆç”±æˆ‘ä»¬éœ€æ±‚å­—æ®µçš„èµ·å§‹state,æ¥ç€æœ‰ä¸€ä¸ªreducer,reducerå®é™…ä¸Šæ“ä½œactions,å®ƒåŸºäºaction typeå¯¹stateåšå‡ºåˆé€‚çš„ä¿®é¥°,ä¹‹ååˆ›å»ºæ–°çš„stateã€‚æœ€åæˆ‘ä»¬export(æ¨¡å—æ¨¡å¼)ä¸€äº›å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨çš„<code>å•çº¯actionå¯¹è±¡</code>.(é©¬ä¸Šæˆ‘ä»¬ä¼šåœ¨sagaä¸­å¯¼å…¥actionå¯¹è±¡ä¹‹ä¸€).ç¤ºä¾‹ä»£ç æ€»æ˜¯è¿™ä¹ˆè¿™ä¹ˆçš„æ•´æ´.</p>
<p> ç°åœ¨æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸‹appçš„æµç¨‹.åœ¨å¤„ç†è¿‡ç¨‹ä¸­,ä»€ä¹ˆçŠ¶æ€éœ€è¦è¾“å…¥ï¼Ÿè¿™ä¸ªé—®é¢˜çš„å¦ä¸€ä¸ªé—®æ³•æ˜¯:appåœ¨æŸä¸ªç‰¹å®šçš„æ—¶é—´åº”è¯¥åšä»€ä¹ˆå·¥ä½œï¼Ÿæˆ‘ä»¬çš„æ—¶é’Ÿå¯ä»¥å‘å‰,å‘å,æš‚åœ.ä¸ºäº†åœ¨è¿™å‡ ä¸ªè¿‡ç¨‹ä¸­ç›¸äº’è½¬å˜,æˆ‘ä»¬éœ€è¦ä¸‰ä¸ªaction,å¼€å§‹æ—¶é’Ÿ,æ‹¨å›æ—¶é—´,æš‚åœæ—¶é’Ÿ.</p>
<p> ä»ä»£ç <code>//saga actions</code>å¼€å§‹,çœ‹çœ‹duckæ¨¡å—çš„å‰©ä½™éƒ¨åˆ†.æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸‰ä¸ªactions,æˆ‘ä»¬çš„root sagaåœ¨æ”¶åˆ°æŸä¸ªactionçš„æ—¶å€™,ä¼šå¯åŠ¨ä¸€ä¸ªå‚»ç“œå¤„ç†æµç¨‹.ç°åœ¨åœ¨ä»£ç é‡Œå‚»ç“œå¤„ç†æµç¨‹åªæ˜¯æ‰“å°ä¸€ä¸‹actionçš„åå­—.åç»­æˆ‘ä»¬ä¼šå¼€å§‹æ ¹æ®action typeå¤„ç†å…·ä½“çš„å¢,å‡,ä¼‘çœ æµç¨‹.è¿™é‡Œæ˜¯duck.jsçš„sagaä»£ç .</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// saga actions</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> startClock = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'start-clock'</span> &#125;)  </div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> pauseClock = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'pause-clock'</span> &#125;)  </div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> rewindClock = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'rewind-clock'</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// saga</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span>* <span class="title">rootSaga</span> (<span class="params"></span>) </span>&#123;  </div><div class="line">  <span class="keyword">yield</span> takeLatest([<span class="string">'start-clock'</span>, <span class="string">'pause-clock'</span>, <span class="string">'rewind-clock'</span>], handleClockAction)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">handleClockAction</span> (<span class="params">&#123; type &#125;</span>) </span>&#123;  </div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Pushed this action to handleClockAction: '</span>, type)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p> actions(ä¸¥æ ¼ä¸Šè®²,æ ¹æ®æœ¯è¯­æ¥è¯´åº”è¯¥æ˜¯å«â€œaction creatorsâ€,ä½†æ˜¯æ— æ‰€è°“,åªè¦ä½ ç†è§£å…·ä½“çš„æ„ä¹‰å°±å¯ä»¥)åº”è¯¥çœ‹èµ·æ¥å’Œå…¶ä»–çš„redux actionsç±»ä¼¼.ä½†æ˜¯è¿™äº›actionåœ¨æˆ‘ä»¬çš„reducerä¸­ä¸èƒ½å¾—åˆ°å¤„ç†.å¦‚æœä¿æŒä»…ä»…åœ¨sagaä»£ç é™„è¿‘ä¿ç•™è¿™äº›actions,è¿™é‡Œçš„acionsä»…ä»…è§¦å‘saga.åšåˆ°è¿™ä¸€ç‚¹,ä¼šé¿å…actionå’Œæ ¹æ®è¿™äº›actionåšå‡ºçš„stateä¿®æ”¹çš„ä»£ç æ··æ‚åœ¨ä¸€èµ·.æ˜¾è€Œæ˜“è§,saga actionä»ç„¶é€šè„±<code>connect</code>å‡½æ•°ç»‘å®šåˆ°storeå®ä¾‹,å¹¶ä¸”è¾“å…¥åˆ°ç»„ä»¶é‡Œ.</p>
<p> ç°åœ¨è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶é‡Œå¥‡æ€ªçš„saga.ä½ è¿˜è®°å¾—<code>rootSaga</code>è¢«ä¼ é€’åˆ°sagaä¸­é—´ä»¶,å¯¹å—ï¼Ÿå¦ç‡è®²,ä½ å¯èƒ½ä¹Ÿä¸çŸ¥é“,ä½†æ˜¯è¿™ä¹Ÿæ²¡å…³ç³».æ¯æ¬¡æˆ‘ä»¬å‘å‡ºä¸€ä¸ªaction,actionä¼šè¢«æ¨é€åˆ°ç»è¿‡<code>sagaMiddleware.run(generator)</code>åŒ…è£…çš„generator.è¿™å°±æ„å‘³ç€,æ¯ä¸ªgeneratoréƒ½æœ‰æœºä¼šå“åº”action,åœ¨æˆ‘ä»¬çš„å®ä¾‹ä¸­,<code>rootSaga</code>é‡åˆ°åŒ¹é…çš„action typeçš„æ—¶å€™æ‰ä¼šåšå‡ºå“åº”.æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä»Redux Sagaè·å–çš„<code>takeLatest</code>åŠ©æ‰‹å‡½æ•°å®Œæˆè¿™ä¸ªå·¥ä½œ.<code>takeLatest</code>æ¥æ”¶ä»»ä½•ä¸action typeæ•°ç»„åŒ¹é…çš„action,ç„¶åæ¥ç€ä¼ é€’ä»–,å¯åŠ¨ä¸€ä¸ª<code>handleClockAcion</code>æµç¨‹,ä¼ é€’è¿›action.<code>takeLatest</code>æ„æ€æ˜¯ç›´æ¥æ”¶æœ€æ–°çš„actionï¼Œå¦‚æœç°åœ¨è¿˜æœ‰æ­£åœ¨è¿è¡Œçš„<code>handleClockAction</code>çš„è¯,åœ¨æ–°çš„actionå¼€å§‹ä¹‹å‰,å½“å‰çš„è¿™ä¸ªå¤„ç†æµç¨‹éœ€è¦å…ˆé€€å‡º.<code>handleClockAction</code>,æœ¬è´¨ä¸Šæ˜¯åœ¨åå°å¯åŠ¨,å…è®¸<code>rootSaga</code>ä¿æŒè¿è¡ŒçŠ¶æ€,å³ä½¿<code>handleClockAction</code>ä»åœ¨è¿è¡Œ,ä¹Ÿå¯ä»¥æ¥å—ä¸‹ä¸€ä¸ªåŒ¹é…çš„action.</p>
<p> æ³¨æ„æˆ‘ä»¬ä½¿ç”¨çš„<code>yield</code>å…³é”®è¯,å›æƒ³ä¸€ä¸‹,<code>yield</code>åœ¨generatorä¸­å‘å‡ºå’Œæ¥æ”¶å€¼.åœ¨ä»»ä½•æ—¶é—´,æˆ‘ä»¬<code>yield</code>ä¸€ä¸ªRedux SagaåŠ©æ‰‹æˆ–è€…effectçš„æ—¶å€™,æˆ‘ä»¬å°±æ­£åœ¨å’ŒSaga middlewareè¿›è¡Œé€šè®¯.åœ¨æˆ‘ä»¬çš„ä¸Šé¢çš„å®ä¾‹ä¸­,Redux Sagaç­‰å¾…åŒ¹é…å‘é€åˆ°sagaçš„action.åé¢æˆ‘ä»¬è¿˜ä¼šæ›´è¿›ä¸€æ­¥æ·±å…¥è®¨è®º.<br> æˆ‘å¸Œæœ›ä½ è‡³å°‘å¯¹è¿™ä¸ªæµç¨‹æœ‰ä¸€ç‚¹æ„Ÿè§‰.æˆ‘è®¤ä¸ºå¯èƒ½åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­(è¯‘è€…ï¼šè¿™é‡Œçš„æ„æ€æ˜¯å®é™…è¿è¡Œä»£ç çš„è¿‡ç¨‹ï¼Œå¹¶ä¸æ˜¯ä»£ç çš„æµ‹è¯•è¿‡ç¨‹)ä½ å¯¹è¿™ä¸ªæµç¨‹æ›´æ¸…æ¥šä¸€ç‚¹.æ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹Reactç»„ä»¶ä¸­æ€ä¹ˆå’Œç”¨æˆ·è¿›è¡Œäº¤äº’çš„è¿‡ç¨‹.<br> åœ¨ç»„ä»¶è¿™ä¸€ç‚¹çœ‹,â€œapp.jsxâ€æ˜¯éå¸¸ç®€å•çš„reactç»„ä»¶.è®©æˆ‘ä»¬çœ‹ä¸ªä»”ç»†.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>  </div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; incrementMilliseconds, decrementMilliseconds, resetClock, startClock, pauseClock, rewindClock &#125; <span class="keyword">from</span> <span class="string">'duck'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;  </div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">const</span> &#123;</div><div class="line">      milliseconds,</div><div class="line">      incrementMilliseconds,</div><div class="line">      decrementMilliseconds,</div><div class="line">      resetClock,</div><div class="line">      startClock,</div><div class="line">      pauseClock,</div><div class="line">      rewindClock</div><div class="line">    &#125; = <span class="keyword">this</span>.props</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">svg</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">incrementMilliseconds</span> &#125; <span class="attr">onDoubleClick</span>=<span class="string">&#123;</span> <span class="attr">resetClock</span> &#125; <span class="attr">onMouseLeave</span>=<span class="string">&#123;</span> <span class="attr">decrementMilliseconds</span> &#125;</span></div><div class="line">          <span class="attr">className</span>=<span class="string">"clock"</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 100 100"</span> <span class="attr">width</span>=<span class="string">"500"</span>&gt;</div><div class="line">          <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">"50"</span> <span class="attr">cy</span>=<span class="string">"50"</span> <span class="attr">r</span>=<span class="string">&#123;</span> <span class="attr">30</span> &#125; <span class="attr">stroke</span>=<span class="string">&#123;</span> '<span class="attr">rgba</span>(<span class="attr">1</span>,<span class="attr">1</span>,<span class="attr">1</span>,<span class="attr">1</span>)' &#125; <span class="attr">fill</span>=<span class="string">"orange"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; milliseconds &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">startClock</span> &#125;&gt;</span>Start Clock<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">pauseClock</span> &#125;&gt;</span>Pause Clock<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">rewindClock</span> &#125;&gt;</span>Rewind Clock<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default connect(state =&gt; (&#123;  </div><div class="line">  milliseconds: state.milliseconds</div><div class="line">&#125;), (&#123;</div><div class="line">  incrementMilliseconds,</div><div class="line">  decrementMilliseconds,</div><div class="line">  resetClock,</div><div class="line">  startClock,</div><div class="line">  pauseClock,</div><div class="line">  rewindClock</div><div class="line">&#125;))(Clock)</div></pre></td></tr></table></figure>
<hr>
<p> é€šè¿‡ä½¿ç”¨connecté«˜å†…èšç»„ä»¶,æˆ‘ä»¬å¯ä»¥ä»storeçš„stateè·å–ä¸€ä¸ªå­—æ®µ,å¹¶ä½œä¸ºpropsä¼ é€’è¿›å…¥ç»„ä»¶.æˆ‘ä»¬ä¹Ÿé€šè¿‡ä¸€ä¸ªå¯¹è±¡ä¼ é€’å››ä¸ªaction creators.ReduxæŠŠè¿™ä¸ªå¯¹è±¡ç»‘å®šåˆ°storeå®ä¾‹ä¸­,ç¡®ä¿æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­è°ƒç”¨è¿™å‡ ä¸ªactionçš„æ—¶å€™,ä»–ä»¬å¯ä»¥æ­£ç¡®çš„è¢«dispatch.<br>  åœ¨æˆ‘ä»¬çš„æ¸²æŸ“ä¸­,æˆ‘ä»¬è¿”å›ä¸€ä¸ª<code>&lt;div&gt;</code>,è¿™ä¸ªå…ƒç´ ä¸­æœ‰ä¸€ä¸ªSVG(åç»­ä¸­å°†ä¼šæ¯”è¾ƒå…³é”®).SVGæœ‰ä¸€äº›äº‹ä»¶æ“ä½œå¥æŸ„,è¿™äº›æ“ä½œå¥æŸ„å°†ä¼šdispatch stateä¿®é¥°actions.æ¥ä¸‹æ¥,ä¼šæœ‰ä¸€ä¸ª<code>&lt;p&gt;</code>å…ƒç´ ä¾æ®appçš„stateæ¥æ˜¾ç¤ºå½“å‰æ—¶é—´.æœ€åæˆ‘ä»¬æœ‰å‡ ä¸ª<code>&lt;button&gt;</code>s è¿æ¥åˆ°sagaçš„actions.<br>  ä¸Šé¢çš„ä»£ç éƒ½å°±ä½ä»¥å,æˆ‘ä»¬å°±è¯•ç€è¿è¡Œä¸€ä¸‹app,éªŒè¯ä¸€ä¸‹åŸºç¡€æ„æ¶å’Œactionsçš„å·¥ä½œæƒ…å†µ.</p>
<p>  ##åˆ°åº•èƒ½å·¥ä½œå—ï¼Ÿ<br>  å›åˆ°ä½ çš„ç»ˆç«¯,è¿è¡Œ<code>npm start</code>.ç°åœ¨è¾“å…¥localhost:8080,åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€devtools,æ£€æŸ¥ä¸€ä¸‹js ç»ˆç«¯.å½“ä½ ç‚¹å‡»buttonsçš„æ—¶å€™,ä¼šçœ‹åˆ°saga actionsçš„æ—¥å¿—è¾“å‡º.ç°åœ¨è¯•ç€åœ¨SVGä¸Šç‚¹å‡»,é¼ æ ‡ä¸€å®š,åŒå‡»action.ä½ å¯ä»¥çœ‹åˆ°æ¯«ç§’æ–‡æœ¬çš„æ›´æ–°.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-740c183a8fff53ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="appçš„ç•Œé¢"></p>
<p>  çœŸå¥½å•Š,æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªRedux Saga appçš„æ¨¡æ¿ç»“æ„,äº†è§£äº†æ€ä¹ˆä½¿ç”¨<code>takeLatest</code>.è¿˜å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯.æ£’ï¼<br>  åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­,æˆ‘ä»¬ä¼šå®Œæˆæ•´ä¸ªæ—¶é’Ÿçš„å®æ–½,å¾—åˆ°ä¸€äº›éå¸¸é…·çš„å†…å®¹.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-å¼€å¯React,Reduxå’ŒImmutableä¹‹æ—…-æµ‹è¯•é©±åŠ¨æ•™ç¨‹(part2)]]></title>
      <url>http://yoursite.com/2017/03/08/%E7%BF%BB%E8%AF%91-%E5%BC%80%E5%90%AFReact,Redux%E5%92%8CImmutable%E4%B9%8B%E6%97%85-%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E6%95%99%E7%A8%8B(part2)/</url>
      <content type="html"><![CDATA[<p>ç¿»è¯‘ç‰ˆæœ¬,<a href="http://www.theodo.fr/blog/2016/03/getting-started-with-react-redux-and-immutable-a-test-driven-tutorial-part-2/" target="_blank" rel="external">åŸæ–‡è¯·è§</a></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNc79ly1fds4960hm8j30xc0b4weu.jpg" alt="Imageç”±[egghead.ioæä¾›](http://egghead.io/)"></p>
<p>è¿™æ˜¯ç¬¬äºŒéƒ¨åˆ†çš„å†…å®¹.</p>
<p>åœ¨ç¬¬ä¸€éƒ¨åˆ†,æˆ‘ä»¬ç½—åˆ—äº†appçš„UI,å¼€å‘å’Œå•å…ƒæµ‹è¯•çš„åŸºç¡€.</p>
<p>æˆ‘ä»¬çœ‹åˆ°äº†appçš„stateé€šè¿‡Reactçš„<code>props</code>å‘ä¸‹ä¼ é€’åˆ°å•ä¸ªçš„ç»„ä»¶,ç”¨æˆ·çš„actionså£°æ˜ä¸ºå›è°ƒå‡½æ•°,å› æ­¤appçš„é€»è¾‘å’ŒUIåˆ†ç¦»å¼€æ¥äº†.</p>
<h2 id="Reduxçš„å·¥ä½œæµä»‹ç»"><a href="#Reduxçš„å·¥ä½œæµä»‹ç»" class="headerlink" title="Reduxçš„å·¥ä½œæµä»‹ç»"></a>Reduxçš„å·¥ä½œæµä»‹ç»</h2><p>åœ¨è¿™ä¸€ç‚¹ä¸Š,æˆ‘ä»¬çš„UIæ˜¯æ²¡æœ‰äº¤äº’æ“ä½œçš„:å°½ç®¡æˆ‘ä»¬å·²ç»æµ‹è¯•äº†å¦‚æœä¸€ä¸ªitemå¦‚æœè¢«è®¾å®šä¸º<code>completed</code>,å®ƒå°†ç»™æ–‡æœ¬åˆ’çº¿,ä½†æ˜¯è¿™é‡Œè¿˜æ²¡æœ‰æ–¹æ³•é‚€è¯·ç”¨æˆ·æ¥å®Œæˆå®ƒ:</p>
<ol>
<li>state treeé€šè¿‡<code>props</code>å®šä¹‰äº†UIå’Œactionå›è°ƒå‡½æ•°.</li>
<li>ç”¨æˆ·çš„actions,ä¾‹å¦‚ç‚¹å‡»,è¢«å‘é€åˆ°action creator,actionè¢«å®ƒèŒƒå¼åŒ–.</li>
<li>redux actionè¢«ä¼ é€’åˆ°reducerå®ç°å®é™…çš„appé€»è¾‘</li>
<li>reduceræ›´æ–°state tree,dispatch stateåˆ°store.</li>
<li>UIæ ¹æ®storeé‡Œçš„æ–°state treeæ¥æ›´æ–°UI</li>
</ol>
<p><img src="https://ww3.sinaimg.cn/large/006tNc79ly1fdua9bq152j30f10870sn.jpg" alt="Redux working flos"></p>
<h2 id="è®¾å®šåˆå§‹åŒ–state"><a href="#è®¾å®šåˆå§‹åŒ–state" class="headerlink" title="è®¾å®šåˆå§‹åŒ–state"></a>è®¾å®šåˆå§‹åŒ–state</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/be48d4d610b3438aeb1dfcd07d317b3c72fbdb3e" target="_blank" rel="external">è¿™éƒ¨åˆ†çš„ä»£ç æäº¤åœ¨è¿™é‡Œ</a></p>
<p>æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªactionå°†ä¼šå…è®¸æˆ‘ä»¬åœ¨Redux storeé‡Œæ­£ç¡®çš„è®¾ç½®åˆå§‹åŒ–state<br>,æˆ‘ä»¬å°†ä¼šåˆ›å»ºstore.</p>
<p>Reduxä¸­çš„actionæ˜¯ä¸€ä¸ªä¿¡æ¯çš„è½½ä½“(payload).actionç”±ä¸€ä¸ªJSONå¯¹è±¡æœ‰ä¸€ä¸ª<code>type</code>å±æ€§,æè¿°actionåˆ°åº•æ˜¯åšä»€ä¹ˆçš„,è¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯appéœ€è¦çš„ä¿¡æ¯.åœ¨æˆ‘ä»¬çš„å®ä¾‹ä¸­,typeè¢«è®¾å®šä¸º<code>SET_STATE</code>,æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªstateå¯¹è±¡åŒ…å«éœ€è¦çš„state:<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attribute">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">  <span class="attribute">state</span>: &#123;</div><div class="line">    <span class="attribute">todos</span>: [</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">1</span>, <span class="attribute">text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">2</span>, <span class="attribute">text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">      &#123;<span class="attribute">id</span>: <span class="number">3</span>, <span class="attribute">text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>, <span class="attribute">editing</span>: false&#125;,</div><div class="line">    ],</div><div class="line">    <span class="attribute">filter</span>: <span class="string">'all'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªactionä¼šè¢«dispatchåˆ°ä¸€ä¸ªreducer,reducerè§’è‰²çš„æ˜¯è¯†åˆ«å’Œå®æ–½å’Œactionå¯¹åº”çš„é€»è¾‘ä»£ç .</p>
<p>è®©æˆ‘ä»¬ä¸ºreduceræ¥å†™å•å…ƒæµ‹è¯•ä»£ç <br><code>test/reducer_spec.js</code><br><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"> <span class="title">import</span> &#123;List, <span class="built_in">Map</span>, fromJS&#125; from <span class="string">'immutable'</span>;</div><div class="line"><span class="title">import</span> &#123;expect&#125; from <span class="string">'chai'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> reducer from <span class="string">'../src/reducer'</span>;</div><div class="line"></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line"></div><div class="line">  it(<span class="string">'handles SET_STATE'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = <span class="built_in">Map</span>();</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attribute">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">      <span class="attribute">state</span>: <span class="built_in">Map</span>(&#123;</div><div class="line">        <span class="attribute">todos</span>: List.of(</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 1, text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;),</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 2, text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;),</div><div class="line">          <span class="built_in">Map</span>(&#123;<span class="attribute">id:</span><span class="string"> 3, text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'completed'</span>&#125;)</div><div class="line">        )</div><div class="line">      &#125;)</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line"></div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attribute">todos</span>: [</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 1, text</span>: <span class="string">'React'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 2, text</span>: <span class="string">'Redux'</span>, <span class="attribute">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attribute">id:</span><span class="string"> 3, text</span>: <span class="string">'Immutable'</span>, <span class="attribute">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†æ–¹ä¾¿ä¸€ç‚¹,<code>state</code>ä½¿ç”¨å•çº¯JSå¯¹è±¡,è€Œä¸æ˜¯ä½¿ç”¨Immutableæ•°æ®ç»“æ„.è®©æˆ‘ä»¬çš„reduceræ¥å¤„ç†è½¬å˜.æœ€å,reducerå°†ä¼šä¼˜é›…çš„å¤„ç†<code>undefined</code>åˆå§‹åŒ–state:<br><code>test/reducer_spec.js</code><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles SET_STATE with plain JS payload'</span>, () =&gt; &#123;</div><div class="line">    const initialState = Map();</div><div class="line">    const action = &#123;</div><div class="line"><span class="symbol">      type:</span> <span class="string">'SET_STATE'</span>,</div><div class="line"><span class="symbol">      state:</span> &#123;</div><div class="line"><span class="symbol">        todos:</span> [</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    const nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line"><span class="symbol">      todos:</span> [</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles SET_STATE without initial state'</span>, () =&gt; &#123;</div><div class="line">    const action = &#123;</div><div class="line"><span class="symbol">      type:</span> <span class="string">'SET_STATE'</span>,</div><div class="line"><span class="symbol">      state:</span> &#123;</div><div class="line"><span class="symbol">        todos:</span> [</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">          &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    const nextState = reducer(undefined, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line"><span class="symbol">      todos:</span> [</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">1</span>, <span class="string">text:</span> <span class="string">'React'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">2</span>, <span class="string">text:</span> <span class="string">'Redux'</span>, <span class="string">status:</span> <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="string">id:</span> <span class="number">3</span>, <span class="string">text:</span> <span class="string">'Immutable'</span>, <span class="string">status:</span> <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çš„reducerå°†ä¼šåŒ¹é…æ¥æ”¶çš„actionsçš„<code>type</code>,å¦‚æœtypeæ˜¯<code>SET_STATE</code>,å½“å‰çš„stateå’Œactionè¿è½½çš„stateèåˆåœ¨ä¸€èµ·:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;<span class="built_in">Map</span>&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setState</span>(<span class="params">state, newState</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.merge(newState);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬ä¸å¾—ä¸æŠŠreducerè¿æ¥åˆ°æˆ‘ä»¬çš„app,æ‰€ä»¥å½“appå¯åŠ¨åˆå§‹åŒ–state.è¿™é‡Œå®é™…æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨Reduxåº“,å®‰è£…ä¸€ä¸‹<br><code>npm install â€”save redux@3.3.1 react-redux@4.4.1</code></p>
<p><code>src/index.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123;List, <span class="built_in">Map</span>&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123;TodoAppContainer&#125; <span class="keyword">from</span> <span class="string">'./components/TodoApp'</span>;</div><div class="line"></div><div class="line"><span class="comment">// We instantiate a new Redux store</span></div><div class="line"><span class="keyword">const</span> store = createStore(reducer);</div><div class="line"><span class="comment">// We dispatch the SET_STATE action holding the desired state</span></div><div class="line">store.dispatch(&#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'SET_STATE'</span>,</div><div class="line">  <span class="attr">state</span>: &#123;</div><div class="line">    <span class="attr">todos</span>: [</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">    ],</div><div class="line">    <span class="attr">filter</span>: <span class="string">'all'</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">require</span>(<span class="string">'../node_modules/todomvc-app-css/index.css'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="comment">// We wrap our app in a Provider component to pass the store down to the components</span></div><div class="line">  &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">TodoAppContainer</span> /&gt;</span></span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ çœ‹çœ‹ä¸Šé¢çš„ä»£ç æ®µ,ä½ å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬çš„<code>TodoApp</code>ç»„ä»¶å®é™…æ˜¯è¢«<code>TodoAppContainer</code>ä»£æ›¿.åœ¨Reduxé‡Œ,æœ‰ä¸¤ç§ç±»å‹çš„ç»„ä»¶:å±•ç¤ºç»„ä»¶å’Œå®¹å™¨.æˆ‘æ¨èä½ é˜…è¯»ä¸€ä¸‹ç”±Dan Abramov(Reduxçš„ä½œè€…)å†™ä½œçš„<a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.e5z2vws8e" target="_blank" rel="external">é«˜ä¿¡æ¯é‡çš„æ–‡ç« </a>,å¼ºè°ƒäº†å±•ç¤ºç»„ä»¶å’Œå®¹å™¨çš„å·®å¼‚æ€§.</p>
<p>å¦‚æœæˆ‘æƒ³æ€»ç»“å¾—å¿«ä¸€ç‚¹,æˆ‘å°†å¼•ç”¨<a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="external">Redux æ–‡æ¡£</a>çš„å†…å®¹ï¼š</p>
<p>â€œå±•ç¤ºç»„ä»¶æ˜¯å…³äºäº‹ä»¶çš„æ ·å­(æ¨¡æ¿å’Œæ ·å¼),å®¹å™¨ç»„ä»¶æ˜¯å…³äºäº‹æƒ…æ˜¯æ€ä¹ˆå·¥ä½œçš„(æ•°æ®è·å–,stateæ›´æ–°)â€.</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ›å»ºstore,ä¼ é€’ç»™<code>TodoAppContainer</code>.ç„¶è€Œä¸ºäº†å­ç»„ä»¶å¯ä»¥ä½¿ç”¨store,æˆ‘ä»¬æŠŠstateæ˜ å°„æˆä¸ºReactç»„ä»¶<code>TodoApp</code>çš„<code>props</code>.<br><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">todos</span>: state.get(<span class="string">'todos'</span>),</div><div class="line">    <span class="attr">filter</span>: state.get(<span class="string">'filter'</span>)</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> TodoAppContainer = connect(mapStateToProps)(TodoApp);</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ åœ¨æµè§ˆå™¨ä¸­é‡æ–°åŠ è½½app,ä½ åº”è¯¥å¯ä»¥çœ‹åˆ°å®ƒåˆå§‹åŒ–å’Œä¹‹å‰ä¸€æ ·,ä¸è¿‡ç°åœ¨ä½¿ç”¨Redux tools.</p>
<h2 id="Redux-dev-å·¥å…·"><a href="#Redux-dev-å·¥å…·" class="headerlink" title="Redux dev å·¥å…·"></a>Redux dev å·¥å…·</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/9e82a2bf7ffaea5d0fda6af361a126517aecc115" target="_blank" rel="external">è¿™ä¸€éƒ¨åˆ†çš„æäº¤ä»£ç </a></p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®äº†redux storeå’Œreducer.æˆ‘ä»¬å¯ä»¥é…ç½®Redux dev toolsæ¥å±•ç°æ•°æ®æµå¼€å‘.</p>
<p>é¦–å…ˆ,è·å–<a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd" target="_blank" rel="external">Redux dev tools Chrome extension</a></p>
<p>dev toolså¯ä»¥åœ¨Storeåˆ›å»ºçš„æ—¶å€™å¯ä»¥åŠ è½½.</p>
<p><code>src/index.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> &#123;compose, createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> createStoreDevTools = compose(</div><div class="line">  <span class="built_in">window</span>.devToolsExtension ? <span class="built_in">window</span>.devToolsExtension() : <span class="function"><span class="params">f</span> =&gt;</span> f</div><div class="line">)(createStore);</div><div class="line"><span class="keyword">const</span> store = createStoreDevTools(reducer);</div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure></p>
<p><img src="https://ww2.sinaimg.cn/large/006tNc79ly1fdubya02s9j31cy0v6dgk.jpg" alt="Redux dev tools"></p>
<p>é‡æ–°åŠ è½½app,ç‚¹å‡»Reduxå›¾æ ‡,æœ‰äº†.</p>
<p>æœ‰ä¸‰ä¸ªä¸åŒçš„ç›‘è§†å™¨å¯ä»¥ä½¿ç”¨:Diffç›‘è§†å™¨,æ—¥å¿—ç›‘è§†å™¨,Sliderç›‘è§†å™¨.</p>
<h2 id="ä½¿ç”¨Action-Creatorsé…ç½®æˆ‘ä»¬çš„actions"><a href="#ä½¿ç”¨Action-Creatorsé…ç½®æˆ‘ä»¬çš„actions" class="headerlink" title="ä½¿ç”¨Action Creatorsé…ç½®æˆ‘ä»¬çš„actions"></a>ä½¿ç”¨Action Creatorsé…ç½®æˆ‘ä»¬çš„actions</h2><p>åˆ‡æ¢itemçš„ä¸åŒçŠ¶æ€.</p>
<p><a href="https://github.com/phacks/redux-todomvc/commit/7a2dc0963684b569c11f92e41a324324dfb21bdc" target="_blank" rel="external">è¿™éƒ¨åˆ†çš„æäº¤ä»£ç åœ¨è¿™é‡Œ</a></p>
<p>ä¸‹ä¸€æ­¥æ˜¯å…è®¸ç”¨æˆ·åœ¨<code>active</code>å’Œ<code>completed</code>ä¹‹å‰åˆ‡æ¢çŠ¶æ€ï¼š<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> &#123;List, <span class="built_in">Map</span>, fromJS&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"><span class="keyword">import</span> &#123;expect&#125; <span class="keyword">from</span> <span class="string">'chai'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'../src/reducer'</span>;</div><div class="line"></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles TOGGLE_COMPLETE by changing the status from active to completed'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles TOGGLE_COMPLETE by changing the status from completed to active'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">3</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Immutable'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†é€šè¿‡è¿™äº›æµ‹è¯•,æˆ‘ä»¬æ›´æ–°reducer:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="comment">// We find the index associated with the itemId</span></div><div class="line">  <span class="keyword">const</span> itemIndex = state.get(<span class="string">'todos'</span>).findIndex(</div><div class="line">    <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">  );</div><div class="line">  <span class="comment">// We update the todo at this index</span></div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .update(<span class="string">'status'</span>, status =&gt; status === <span class="string">'active'</span> ? <span class="string">'completed'</span> : <span class="string">'active'</span>);</div><div class="line"></div><div class="line">  <span class="comment">// We update the state to account for the modified todo</span></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_COMPLETE'</span>:</div><div class="line">      <span class="keyword">return</span> toggleComplete(state, action.itemId);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å’Œ<code>SET_STATE</code>çš„actionåŒä¸€ä¸ªåœ°æ–¹,æˆ‘ä»¬éœ€è¦è®©<code>TodoAppContainer</code>ç»„ä»¶æ„ŸçŸ¥åˆ°action,æ‰€ä»¥<code>toggleComplete</code>å›è°ƒå‡½æ•°ä¼šè¢«ä¼ é€’åˆ°<code>TodoItem</code>ç»„ä»¶(å®é™…è°ƒç”¨å‡½æ•°çš„åœ°æ–¹).</p>
<p>åœ¨Reduxä¸­,æœ‰æ ‡å‡†çš„æ–¹æ³•æ¥åšè¿™ä»¶äº‹ï¼šAction Creators.</p>
<p>action creatorsæ˜¯ç®€å•çš„å‡½æ•°,è¿”å›åˆé€‚çš„actionï¼Œè¿™äº›éŸ©å¼æ˜¯Reactçš„<code>props</code>çš„ä¸€äº›æ˜ å°„ä¹‹ä¸€.<br>è®©æˆ‘ä»¬åˆ›å»ºç¬¬ä¸€ä¸ªaction creator:<br><code>src/action_creators.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'TOGGLE_COMPLETE'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨,å°½ç®¡<code>TodoAppcontainer</code>ç»„ä»¶ä¸­çš„<code>connect</code>å‡½æ•°çš„è°ƒç”¨å¯ä»¥ç”¨æ¥è·å–store,æˆ‘ä»¬å‘Šè¯‰ç»„ä»¶ä½¿ç”¨æ˜ å°„<code>props</code>çš„å›è°ƒå‡½æ•°:<br><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'../action_creators'</span>;</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      // ...</div><div class="line">        // We use the spread operator for better lisibility</div><div class="line">        <span class="tag">&lt;<span class="name">TodoList</span>  &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></div><div class="line">      // ...</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">export const TodoAppContainer = connect(mapStateToProps, actionCreators)(TodoApp);</div></pre></td></tr></table></figure></p>
<p>é‡å¯ä½ çš„webserver,åˆ·æ–°ä¸€ä¸‹ä½ çš„æµè§ˆå™¨:å½“å½“.åœ¨æ¡ç›®ä¸Šç‚¹å‡»ç°åœ¨å¯ä»¥åˆ‡æ¢å®ƒçš„çŠ¶æ€.å¦‚æœä½ æŸ¥çœ‹Redux dev tools,ä½ å¯ä»¥çœ‹åˆ°è§¦å‘çš„actionå’Œåç»§çš„æ›´æ–°.</p>
<h2 id="æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨"><a href="#æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨" class="headerlink" title="æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨"></a>æ”¹å˜ç›®å‰çš„è¿‡æ»¤å™¨</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/3949d4f38912e4b6b8e60fc4c553614d4076028c" target="_blank" rel="external">ç›¸å…³ä»£ç åœ¨åœ¨è¿™é‡Œ</a></p>
<p>ç°åœ¨æ¯ä»¶äº‹æƒ…éƒ½å·²ç»é…ç½®å®Œæ¯•,å†™å…¶ä»–çš„actionæ˜¯ä»¶å°äº‹.æˆ‘ä»¬ç»§ç»­åˆ›å»ºä½ å¸Œæœ›çš„<code>CHANGE_FILTER</code>action,æ”¹å˜å½“å‰stateçš„filter,ç”±æ­¤ä»…ä»…æ˜¾ç¤ºè¿‡æ»¤è¿‡çš„æ¡ç›®.<br>å¼€å§‹åˆ›å»ºaction creatorï¼š<br><code>src/action_creators.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">changeFilter</span>(<span class="params">filter</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CHANGE_FILTER'</span>,</div><div class="line">    filter</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨å†™reducerçš„å•å…ƒæµ‹è¯•:<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles CHANGE_FILTER by changing the filter'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ],</div><div class="line">      <span class="attr">filter</span>: <span class="string">'all'</span></div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CHANGE_FILTER'</span>,</div><div class="line">      <span class="attr">filter</span>: <span class="string">'active'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ],</div><div class="line">      <span class="attr">filter</span>: <span class="string">'active'</span></div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>å…³è”çš„reducerå‡½æ•°:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeFilter</span>(<span class="params">state, filter</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.set(<span class="string">'filter'</span>, filter);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'SET_STATE'</span>:</div><div class="line">      <span class="keyword">return</span> setState(state, action.state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_COMPLETE'</span>:</div><div class="line">      <span class="keyword">return</span> toggleComplete(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'CHANGE_FILTER'</span>:</div><div class="line">      <span class="keyword">return</span> changeFilter(state, action.filter);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æœ€åæˆ‘ä»¬æŠŠ<code>changeFilter</code>å›è°ƒå‡½æ•°ä¼ é€’ç»™<code>TodoTools</code>ç»„ä»¶:<br><code>TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">className</span>=<span class="string">"todoapp"</span>&gt;</span></div><div class="line">        // ...</div><div class="line">        <span class="tag">&lt;<span class="name">TodoTools</span> <span class="attr">changeFilter</span>=<span class="string">&#123;this.props.changeFilter&#125;</span></span></div><div class="line">                   <span class="attr">filter</span>=<span class="string">&#123;this.props.filter&#125;</span></div><div class="line">                   <span class="attr">nbActiveItems</span>=<span class="string">&#123;this.getNbActiveItems()&#125;</span> /&gt;</div><div class="line">      <span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>å®Œæˆäº†,ç¬¬ä¸€ä¸ªfilter selectorå·¥ä½œå®Œç¾</p>
<h2 id="Itemç¼–è¾‘"><a href="#Itemç¼–è¾‘" class="headerlink" title="Itemç¼–è¾‘"></a>Itemç¼–è¾‘</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/2a7b1138f778524d4aa7eac193c995258d28c5a3" target="_blank" rel="external">ä»£ç åœ¨è¿™é‡Œ</a><br> å½“ç”¨æˆ·ç¼–è¾‘ä¸€ä¸ªæ¡ç›®,å®é™…ä¸Šæ˜¯ä¸¤ä¸ªactionsè§¦å‘çš„ä¸‰ä¸ªå¯èƒ½æ€§:</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥ç¼–è¾‘æ¨¡å¼:<code>EDIT_ITEM</code></li>
<li>ç”¨æˆ·é€€å‡ºç¼–è¾‘æ¨¡å¼(ä¸ä¿å­˜å˜åŒ–):<code>CANCEL_EDITING</code></li>
<li>ç”¨æˆ·éªŒè¯ä»–çš„ç¼–è¾‘(ä¿å­˜å˜åŒ–):<code>DONE_EDITING</code></li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä¸ºä¸‰ä¸ªactionsç¼–å†™action creatorsï¼š<br><code>src/action_creators.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">editItem</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'EDIT_ITEM'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">cancelEditing</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CANCEL_EDITING'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">doneEditing</span>(<span class="params">itemId, newText</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'DONE_EDITING'</span>,</div><div class="line">    itemId,</div><div class="line">    newText</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ä¸ºè¿™äº›actionsç¼–å†™å•å…ƒæµ‹è¯•:<br><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles EDIT_ITEM by setting editing to true'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'EDIT_ITEM'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles CANCEL_EDITING by setting editing to false'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CANCEL_EDITING'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles DONE_EDITING by setting by updating the text'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">true</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'DONE_EDITING'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">newText</span>: <span class="string">'Redux'</span>,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>, <span class="attr">editing</span>: <span class="literal">false</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å‘reducerå‡½æ•°,å®é™…æ“ä½œä¸‰ä¸ªactions:<br><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">findItemIndex</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.get(<span class="string">'todos'</span>).findIndex(</div><div class="line">    <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// We can refactor the toggleComplete function to use findItemIndex</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleComplete</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .update(<span class="string">'status'</span>, status =&gt; status === <span class="string">'active'</span> ? <span class="string">'completed'</span> : <span class="string">'active'</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">editItem</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cancelEditing</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doneEditing</span>(<span class="params">state, itemId, newText</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemIndex = findItemIndex(state, itemId);</div><div class="line">  <span class="keyword">const</span> updatedItem = state.get(<span class="string">'todos'</span>)</div><div class="line">    .get(itemIndex)</div><div class="line">    .set(<span class="string">'editing'</span>, <span class="literal">false</span>)</div><div class="line">    .set(<span class="string">'text'</span>, newText);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, todos =&gt; todos.set(itemIndex, updatedItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'EDIT_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> editItem(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'CANCEL_EDITING'</span>:</div><div class="line">      <span class="keyword">return</span> cancelEditing(state, action.itemId);</div><div class="line">    <span class="keyword">case</span> <span class="string">'DONE_EDITING'</span>:</div><div class="line">      <span class="keyword">return</span> doneEditing(state, action.itemId, action.newText);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ¸…é™¤å®Œæˆ-æ·»åŠ å’Œåˆ é™¤æ¡ç›®"><a href="#æ¸…é™¤å®Œæˆ-æ·»åŠ å’Œåˆ é™¤æ¡ç›®" class="headerlink" title="æ¸…é™¤å®Œæˆ,æ·»åŠ å’Œåˆ é™¤æ¡ç›®"></a>æ¸…é™¤å®Œæˆ,æ·»åŠ å’Œåˆ é™¤æ¡ç›®</h2><p><a href="https://github.com/phacks/redux-todomvc/commit/c89059a6767903fdf8b9827209f92e1f7385bdb7" target="_blank" rel="external">ä»£ç åœ¨è¿™é‡Œ</a></p>
<p>ä¸‰ä¸ªå‰©ä¸‹çš„actionæ˜¯:</p>
<ol>
<li><code>CLEAR_COMPLETED</code>,åœ¨<code>TodoTools</code>ç»„ä»¶ä¸­è§¦å‘,ä»åˆ—è¡¨ä¸­æ¸…é™¤å®Œæˆçš„æ¡ç›®</li>
<li><code>ADD_ITEM</code>,åœ¨<code>TodoHeader</code>ä¸­è§¦å‘,æ ¹æ®ç”¨æˆ·çš„çš„è¾“å…¥æ–‡æœ¬æ¥æ·»åŠ æ¡ç›®</li>
<li><code>DELETE_ITEM</code>,ç›¸ä¼¼<code>TodoItem</code>ä¸­è°ƒç”¨,åˆ é™¤ä¸€ä¸ªæ¡ç›®</li>
</ol>
<p>æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„å·¥ä½œæµæ˜¯:æ·»åŠ action creators,å•å…ƒæµ‹è¯•reducerå’Œä»£ç é€»è¾‘,æœ€ç»ˆé€šè¿‡propsä¼ é€’å›è°ƒå‡½æ•°:<br><code>src/action_creators.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">clearCompleted</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'CLEAR_COMPLETED'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addItem</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'ADD_ITEM'</span>,</div><div class="line">    text</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteItem</span>(<span class="params">itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">type</span>: <span class="string">'DELETE_ITEM'</span>,</div><div class="line">    itemId</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>test/reducer_spec.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line">describe(<span class="string">'reducer'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  it(<span class="string">'handles CLEAR_COMPLETED by removing all the completed items'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'CLEAR_COMPLETED'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles ADD_ITEM by adding the item'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'ADD_ITEM'</span>,</div><div class="line">      <span class="attr">text</span>: <span class="string">'Redux'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  it(<span class="string">'handles DELETE_ITEM by removing the item'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> initialState = fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Redux'</span>, <span class="attr">status</span>: <span class="string">'completed'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> action = &#123;</div><div class="line">      <span class="attr">type</span>: <span class="string">'DELETE_ITEM'</span>,</div><div class="line">      <span class="attr">itemId</span>: <span class="number">2</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> nextState = reducer(initialState, action);</div><div class="line">    expect(nextState).to.equal(fromJS(&#123;</div><div class="line">      <span class="attr">todos</span>: [</div><div class="line">        &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'React'</span>, <span class="attr">status</span>: <span class="string">'active'</span>&#125;,</div><div class="line">      ]</div><div class="line">    &#125;));</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><code>src/reducer.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCompleted</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>,</div><div class="line">    (todos) =&gt; todos.filterNot(</div><div class="line">      <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'status'</span>) === <span class="string">'completed'</span></div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addItem</span>(<span class="params">state, text</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> itemId = state.get(<span class="string">'todos'</span>).reduce(<span class="function">(<span class="params">maxId, item</span>) =&gt;</span> <span class="built_in">Math</span>.max(maxId,item.get(<span class="string">'id'</span>)), <span class="number">0</span>) + <span class="number">1</span>;</div><div class="line">  <span class="keyword">const</span> newItem = <span class="built_in">Map</span>(&#123;<span class="attr">id</span>: itemId, <span class="attr">text</span>: text, <span class="attr">status</span>: <span class="string">'active'</span>&#125;);</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>, (todos) =&gt; todos.push(newItem));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteItem</span>(<span class="params">state, itemId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> state.update(<span class="string">'todos'</span>,</div><div class="line">    (todos) =&gt; todos.filterNot(</div><div class="line">      <span class="function">(<span class="params">item</span>) =&gt;</span> item.get(<span class="string">'id'</span>) === itemId</div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">state = Map(</span>), <span class="title">action</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    <span class="keyword">case</span> <span class="string">'CLEAR_COMPLETED'</span>:</div><div class="line">      <span class="keyword">return</span> clearCompleted(state);</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> addItem(state, action.text);</div><div class="line">    <span class="keyword">case</span> <span class="string">'DELETE_ITEM'</span>:</div><div class="line">      <span class="keyword">return</span> deleteItem(state, action.itemId);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> state;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>src/components/TodoApp.jsx</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// ...</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;</div><div class="line">      &lt;section className="todoapp"&gt;</div><div class="line">        // We pass down the addItem callback</div><div class="line">        &lt;TodoHeader addItem=&#123;this.props.addItem&#125;/&gt;</div><div class="line">        &lt;TodoList &#123;...this.props&#125; /&gt;</div><div class="line">        // We pass down the clearCompleted callback</div><div class="line">        &lt;TodoTools changeFilter=&#123;this.props.changeFilter&#125;</div><div class="line">                    filter=&#123;this.props.filter&#125;</div><div class="line">                    nbActiveItems=&#123;this.getNbActiveItems()&#125;</div><div class="line">                    clearCompleted=&#123;this.props.clearCompleted&#125;/&gt;</div><div class="line">      &lt;/section&gt;</div><div class="line">      &lt;Footer /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çš„TodoMVC appç°åœ¨å®Œæˆäº†.</p>
<h2 id="åŒ…è£…èµ·æ¥"><a href="#åŒ…è£…èµ·æ¥" class="headerlink" title="åŒ…è£…èµ·æ¥"></a>åŒ…è£…èµ·æ¥</h2><p>è¿™æˆ‘ä»¬çš„æµ‹è¯•é©±åŠ¨çš„React,Redux&amp;Immutable æŠ€æœ¯æ ˆ</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå†…å®¹,æœ‰æ›´å¤šçš„äº‹æƒ…ç­‰ç€ä½ å»æŒ–æ˜<br>ä¾‹å¦‚:</p>
<ul>
<li><a href="https://github.com/reactjs/react-router-redux" target="_blank" rel="external">React Redux router</a>åˆ›å»ºå®Œå…¨çš„å•é¡µé¢åº”ç”¨</li>
<li>æ˜¯ç”±Reduxåœ¨åå°åŒæ„Redux,çœ‹è¿™<a href="http://teropa.info/blog/2015/09/10/full-stack-redux-tutorial.html" target="_blank" rel="external">1æ•™ç¨‹</a>,<a href="https://blog.diacode.com/trello-clone-with-phoenix-and-react-pt-1" target="_blank" rel="external">2æ•™ç¨‹</a></li>
<li><a href="https://github.com/Ghirro/gambit" target="_blank" rel="external">Gambie</a>,ç®€å•çš„åŒ…è£…å™¨ç®€åŒ–åˆ°APIçš„è¿æ¥</li>
<li><a href="https://egghead.io/series/getting-started-with-redux" target="_blank" rel="external">ç³»åˆ—è§†é¢‘</a>,ä½œè€…æ˜¯Dan Abramov(Reduxçš„åˆ›å»ºè€…)</li>
<li>Redux <a href="http://redux.js.org/docs/introduction/Ecosystem.html" target="_blank" rel="external">ç½‘ç«™ä¸Šæ›´å¤šçš„å†…å®¹</a>!</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[javascriptè¡¨è§‚æ¨¡å¼]]></title>
      <url>http://yoursite.com/2017/03/07/javascript%E8%A1%A8%E8%A7%82%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<blockquote>
<p>è¡¨è§‚æ¨¡å¼(Facade),è¡¨è§‚æ¨¡å¼æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€ä¸ªæ˜¯ç®€åŒ–ç±»çš„æ¥å£ï¼ŒäºŒæ˜¯æ¶ˆé™¤ç±»ä¸ä½¿ç”¨å®ƒçš„å®¢æˆ·ä»£ç ä¹‹é—´çš„è€¦åˆã€‚åœ¨jQueryæ•™ç¨‹ä¸­æ€»æ˜¯ä¼šå‘Šè¯‰ä½¿ç”¨è€…ï¼Œjqueryå·²ç»æ¶ˆé™¤äº†æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ï¼Œåªç”¨ä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥åœ¨æ‰€æœ‰çš„æµè§ˆå™¨ç¯å¢ƒä¸‹ä½¿ç”¨ï¼ŒèƒŒåçš„åŸç†å°±æ˜¯ï¼Œä½œè€…é€šè¿‡è¡¨è§‚æ¨¡å¼æ¶ˆé™¤äº†æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ã€‚</p>
</blockquote>
<p>åœ¨æµè§ˆå™¨çš„äº‹ä»¶ç›‘å¬ä¸­ï¼Œæœ‰äº‹ä»¶ä¼ æ’­å’Œé˜»æ­¢äº‹ä»¶ä¼ é€’çš„å¤„ç†ä¸Šæœ‰å·®å¼‚ã€‚<br>æ‰€ä»¥åœ¨å„ç§jsåº“ä¸­éƒ½ä½¿ç”¨è¡¨è§‚æ¨¡å¼åŠ ä»¥å¤„ç†<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> DED = <span class="built_in">window</span>.DED || &#123;&#125;; <span class="comment">//è®¾ç½®ä¸€ä¸ªå‘½åç©ºé—´</span></div><div class="line">DED.util = &#123;   <span class="comment">//ç”¨åå­—(util,å·¥å…·)ä½¿å‘½åç©ºé—´æ›´åŠ æ˜äº†</span></div><div class="line">  stopPropagation: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; </div><div class="line">    <span class="keyword">if</span> (ev.stopPropagation) &#123;<span class="comment">//æºä»£ç è¿™é‡Œæ˜¯ä¸æ˜¯å¤šäº†ä¸€ä¸ªv?</span></div><div class="line">      <span class="comment">// W3 interface</span></div><div class="line">      e.stopPropagation();</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      <span class="comment">// IE's interface</span></div><div class="line">      e.cancelBubble = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">preventDefault</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (e.preventDefault) &#123;</div><div class="line">      <span class="comment">// W3 interface</span></div><div class="line">      e.preventDefault();</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      <span class="comment">// IE's interface</span></div><div class="line">      e.returnValue = <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* æ›´å…·å…·ä½“ä¼ å…¥çš„äº‹ä»¶å¯¹è±¡æ¥åˆ¤æ–­ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œåœ¨ä½¿ç”¨è€…çœ¼ä¸­ï¼Œåªæœ‰stopEventè¿™ä¸€ä¸ªæ–¹æ³• */</span></div><div class="line">  stopEvent: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    DED.util.stopPropagation(e);</div><div class="line">    DED.util.preventDefault(e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>è®¾ç½®HTMLæ ·å¼çš„è¡¨è§‚æ¨¡å¼æ–¹æ³•<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'content'</span>);</div><div class="line">element.style.color = <span class="string">'red'</span>;</div><div class="line"></div><div class="line">element.style.fontSize = <span class="string">'16px'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> element1 = <span class="built_in">document</span>.getElementById(<span class="string">'foo'</span>);</div><div class="line">element1.style.color = <span class="string">'red'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> element2 = <span class="built_in">document</span>.getElementById(<span class="string">'bar'</span>);</div><div class="line">element2.style.color = <span class="string">'red'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> element3 = <span class="built_in">document</span>.getElementById(<span class="string">'baz'</span>);</div><div class="line">element3.style.color = <span class="string">'red'</span>;</div><div class="line"><span class="comment">//ä¸Šé¢æ˜¯æœ€åŸå§‹çš„æ–¹æ³•</span></div><div class="line"></div><div class="line"></div><div class="line">setStyle([<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>], <span class="string">'color'</span>, <span class="string">'red'</span>); <span class="comment">//ä½¿ç”¨setStyleçš„æ–¹æ³•</span></div><div class="line"><span class="comment">//ä¼ å…¥å…ƒç´ æ•°ç»„ï¼Œå±æ€§ï¼Œå±æ€§å€¼ä¸‰ä¸ªå‚æ•°</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setStyle</span>(<span class="params">elements, prop, val</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = elements.length<span class="number">-1</span>; I &lt; len; ++i) &#123;</div><div class="line">    <span class="built_in">document</span>.getElementById(elements[i]).style[prop] = val;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">setStyle([<span class="string">'foo'</span>], <span class="string">'position'</span>, <span class="string">'absolute'</span>); <span class="comment">//setStyleéƒ½æ˜¯ç±»ä¼¼</span></div><div class="line">setStyle([<span class="string">'foo'</span>], <span class="string">'top'</span>, <span class="string">'50px'</span>);</div><div class="line">setStyle([<span class="string">'foo'</span>], <span class="string">'left'</span>, <span class="string">'300px'</span>);</div><div class="line"></div><div class="line">setCSS([<span class="string">'foo'</span>], &#123; <span class="comment">//ç›´æ¥ä½¿ç”¨setCSSæ–¹æ³•ï¼Œä¼ å…¥å…ƒç´ æ•°ç»„å’Œæ ·å¼å±æ€§å¯¹è±¡</span></div><div class="line">  position: <span class="string">'absolute'</span>,</div><div class="line">  <span class="attr">top</span>: <span class="string">'50px'</span>,</div><div class="line">  <span class="attr">left</span>: <span class="string">'300px'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCSS</span>(<span class="params">el, styles</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> ( <span class="keyword">var</span> prop <span class="keyword">in</span> styles ) &#123; <span class="comment">//éå†å±æ€§å¯¹è±¡é”®å€¼å¯¹</span></div><div class="line">    <span class="keyword">if</span> (!styles.hasOwnProperty(prop)) <span class="keyword">continue</span>;</div><div class="line">    setStyle(el, prop, styles[prop]); <span class="comment">//ä½¿ç”¨setStyleæ–¹æ³•è®¾ç½®å…ƒç´ å±æ€§</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">setCSS([<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>], &#123;</div><div class="line">  <span class="attr">color</span>: <span class="string">'white'</span>,</div><div class="line">  <span class="attr">background</span>: <span class="string">'black'</span>,</div><div class="line">  <span class="attr">fontSize</span>: <span class="string">'16px'</span>,</div><div class="line">  <span class="attr">fontFamily</span>: <span class="string">'georgia, times, serif'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä»¥ä¸Šä¸¤ä¸ªä¾‹å­çœ‹ç€å¥½ç†Ÿæ‚‰ï¼Œåœ¨jqueryçš„apiä¸­åˆ°å¤„éƒ½æœ‰è¿™æ ·çš„æ¨¡å¼ã€‚<br>ä½†æ˜¯ä¹Ÿæœ‰æ€§èƒ½çš„æŸå¤±ã€‚è¦åšå¤šä½™çš„æ“ä½œã€‚ jquery 2.x.xçš„ç‰ˆæœ¬æ²¡æœ‰ç›´æ¥æ”¾å¼ƒäº†IEæµè§ˆå™¨çš„å…¼å®¹æ€§ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯åŸºäºå¯¹è¡¨è§‚æ¨¡å¼çš„è€ƒè™‘ï¼Ÿæ²¡æœ‰è¯»æºç ï¼ŒçŒœæµ‹ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-é‡æ–°æ€è€ƒRedux]]></title>
      <url>http://yoursite.com/2017/03/03/%E7%BF%BB%E8%AF%91-%E9%87%8D%E6%96%B0%E6%80%9D%E8%80%83Redux/</url>
      <content type="html"><![CDATA[<blockquote>
<p><em>Arunoda Susiripala  <a href="https://voice.kadira.io/rethinking-redux-f1e96daba60c#.svx11tv8l" target="_blank" rel="external">å‚çœ‹åŸæ–‡</a>,è¿™ç¯‡æ–‡ç« å‘å¸ƒæœ‰äº›æ—¶é—´äº†,ä½†ä»ç„¶æ˜¯å¾ˆå¥½çš„å­¦ä¹ èµ„æ–™,è€Œä¸”åœ¨éšç€å­¦ä¹ å’Œäº†è§£çš„æ·±å…¥,è®¸å¤šæœ‰æ„æ€çš„æƒ³æ³•å¾—åˆ°è¯å®,é‚£æ„Ÿè§‰çœŸæ˜¯å¾ˆå¥½.æ¯”å¦‚æˆ‘å‰é¢è¯ç”Ÿäº†ä¸€ä¸ªæƒ³æ³•,reduxå°±æ˜¯ä¸€ä¸ªæ•°æ®å±‚å•Š!å¯ä»¥å€ŸåŠ©æ•°æ®åº“çš„æ€æƒ³æ¥å­¦ä¹ ,åŒ…æ‹¬å…¶ä¸­è¯ç”Ÿçš„ä¸€äº›ä¸­é—´æ€æƒ³.åœ¨è¿™ç¯‡æ–‡ç« æœ‰æœ‰äº†æ–°çš„å‘ç°,åœ¨Meteorçš„stateç®¡ç†æ–¹æ³•ç›´æ¥ä½¿ç”¨äº†<code>minimongo cache</code>çš„åå­—,åå­—é‡Œçš„å«ä¹‰ä¸è¨€è‡ªæ˜äº†.å°±æ˜¯è¿™äº›å°ç‚¹æ…¢æ…¢ä½¿æˆ‘çš„å­¦ä¹ è¿‡ç¨‹æ›´åŠ æ·±å…¥.å½“ç„¶ä¹Ÿæœ‰ä¸€äº›æ–°çš„æƒ³æ³•,æœ‰å…´è¶£çš„å¾€ä¸‹çœ‹çœ‹.<br>   Dec 22, 2015</em></p>
<hr>
<p>   #é‡æ–°æ€è€ƒRedux<br>   Reduxæ˜¯éå¸¸å¥½çš„æ¡†æ¶.è¿™ç¯‡æ–‡ç« æ—¢ä¸æ˜¯Reduxçš„æ‰©å……ä¹Ÿä¸æ˜¯è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Fluxåº“,è¿™é‡Œæ˜¯å¯¹Reduxæ¨¡å¼çš„é‡æ–°æ€è€ƒ.</p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯Redux"><a href="#ä»€ä¹ˆæ˜¯Redux" class="headerlink" title="ä»€ä¹ˆæ˜¯Redux?"></a>ä»€ä¹ˆæ˜¯Redux?</h3><p>   åœ¨æˆ‘ä»¬è®¨è®ºæ–°å†…å®¹ä¹‹å‰,è®©æˆ‘ä»¬å…ˆçœ‹çœ‹Reduxæ˜¯ä»€ä¹ˆ.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-078a8427c21f15a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Redux flow pic"></p>
<ul>
<li>æœ¬è´¨ä¸Š,Reduxæ˜¯æˆ‘ä»¬çš„appé‡Œå­˜å‚¨å®¢æˆ·ç«¯stateçš„åœ°æ–¹.</li>
<li>ä¸€äº›actionså¯ä»¥æ”¹å˜state.</li>
<li><p>æˆ‘ä»¬ä½¿ç”¨çº¯å‡½æ•°æ¥ç›‘å¬æ‰€æœ‰çš„actionså¹¶ä¸”ä½¿ç”¨å½“å‰çš„stateä½œä¸ºä¸Šä¸‹æ–‡å»åˆ›å»ºæ–°çš„state.è¿™ä¸ªå‡½æ•°å«reducer.<br>(ä¹‹æ‰€ä»¥å«çº¯å‡½æ•°,æ˜¯å› ä¸ºå®ƒä¸ä¼šçªå˜state,è€Œä¸”å®ƒä¹Ÿæ²¡æœ‰ä»»ä½•å¼‚æ­¥æ“ä½œ.)</p>
</li>
<li><p>æœ‰å¾ˆå¤šè®¢é˜…è€…ç›‘å¬ç€ä»–ä»¬éœ€è¦ä¿®æ”¹çš„state.</p>
</li>
</ul>
<p>å¦‚æœä½ æ˜¯Reduxæ–°æ‰‹,çœ‹çœ‹è¿™äº›ç”±<a href="https://egghead.io/series/getting-started-with-redux" target="_blank" rel="external">Reduxåˆ›å»ºè€…å‘å¸ƒçš„è§†é¢‘</a></p>
<p>æˆ‘ä»¥å‰å’Œä½ ä¸€æ ·,ä½†æ˜¯æˆ‘ç°åœ¨å–œæ¬¢Redux.</p>
<h2 id="ä¸ºä»€ä¹ˆæ˜¯Redux"><a href="#ä¸ºä»€ä¹ˆæ˜¯Redux" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯Redux?"></a>ä¸ºä»€ä¹ˆæ˜¯Redux?</h2><p>ç°åœ¨æœ‰è¶³å¤Ÿçš„ç†ç”±ä½¿ç”¨Reactæ„å»ºapp.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çˆ¶å­æ•°æ®æµ,Meteorçš„Tracker based system,Relayæˆ–è€…Mobservable.</p>
<p>è¿™äº›æ–¹æ³•å¯¹äºç®€å•app(æˆ–è€…ä¸­å‹appåº”ç”¨)æ¥è¯´è¿˜æ˜¯æŒºå¥½çš„.ä½†æ˜¯ä¸€æ—¦appè§„æ¨¡å˜å¤§,ææœ‰å¯èƒ½ä¼šä¸§å¤±appçš„æ§åˆ¶æƒ.</p>
<blockquote>
<p>æˆ‘ä¹‹æ‰€ä»¥è¿™ä¹ˆè¯´æ˜¯ä»æˆ‘ä¸¤æ¬¡é‡æ„kandira UIçš„ç»éªŒæ¥çš„,é‚£ä¸ªè¿‡ç¨‹å¤ªç—›è‹¦äº†.</p>
</blockquote>
<p>èƒ½å’ŒReduxå¾ˆé«˜å·¥ä½œçš„æ„æ¶å°±æ˜¯Redux.</p>
<p>Reduxæ˜¯ä¸€ä¸ªç®€å•æ¦‚å¿µ,å®ƒé‡‡ç”¨äº†ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(å®é™…ä¸Šæ¥è‡ªElm)å’ŒFluxçš„æ„æ¶.</p>
<p>æœ‰äº†Redux,</p>
<ul>
<li>æˆ‘ä»¬çš„stateæ˜¯å¯ä»¥é¢„æœŸçš„,åœ¨appä¸­ä¹Ÿæ˜¯è¿™æ ·</li>
<li>appçš„å¤§éƒ¨åˆ†æ˜¯çº¯å‡½æ•°,UIä¹Ÿæ˜¯çº¯å‡½æ•°.æ‰€ä»¥å¾ˆå®¹æ˜“æµ‹è¯•.</li>
<li>Reduxæ˜¯ä¸€ä¸ªç®€å•çš„åº“,æ‰€ä»¥æ²¡æœ‰ä»»ä½•é­”æ³•.</li>
<li>Reduxé‡Œçš„æ¨¡å¼è¢«å¾ˆå¤šå¼€å‘è€…ä½¿ç”¨.æ‰€æœ‰ä½ å¯ä»¥ä¾æ®å¾ˆå¥½çš„ç”Ÿæ€ç³»ç»Ÿ.</li>
</ul>
<p>ä¸Šé¢è¿™äº›è§‚ç‚¹å°±æ˜¯æˆ‘è®¤ä¸ºReduxéå¸¸é‡è¦çš„åŸå› .</p>
<p>##é‡æ–°æ€è€ƒ<br>æˆ‘ä»¬æ­£åœ¨è€ƒè™‘ä½¿ç”¨å®¢æˆ·ç«¯stateå’ŒMeteroåå°äº¤äº’æ¥é‡å†™app.æˆ‘ä»¬è®¤ä¸ºReduxçš„æ¨¡å‹æ›´åˆé€‚.ä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰è®¸å¤šé—®é¢˜è¦è€ƒè™‘,åœ¨é‚£äº›åœ°æ–¹ä¹¦å†™é€»è¾‘ä»£ç ,æ€ä¹ˆå‡å°‘æ¨¡æ¿ä»£ç é‡.<br> æˆ‘ä»¬ä¹Ÿä¸æ€ä¹ˆç¡®ä¿¡Reduxçš„stateç®¡ç†æ€ä¹ˆå’Œå…¶ä»–çš„stateç®¡ç†ç³»ç»Ÿæ•´åˆ,æ¯”å¦‚Meteorçš„minimongo cache(è¯‘è€…:å•è¯çš„å«ä¹‰æ„å‘³ç€å¯ä»¥çœ‹åšç®€å•çš„mongo æ•°æ®åº“,çœ‹åˆ°è¿™é‡Œä½ æœ‰ä»€ä¹ˆæƒ³æ³•å‘¢ï¼Ÿ).è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æƒ³è¦å¯»æ±‚ä¸€äº›æ”¹å˜.</p>
<p> ç°åœ¨è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹æˆ‘ä»¬å»ºè®®çš„ä¸€äº›ä¿®æ”¹.</p>
<h3 id="ä½¿ç”¨Reduxç®¡ç†UIçš„state"><a href="#ä½¿ç”¨Reduxç®¡ç†UIçš„state" class="headerlink" title="ä½¿ç”¨Reduxç®¡ç†UIçš„state"></a>ä½¿ç”¨Reduxç®¡ç†UIçš„state</h3><p> åœ¨æˆ‘ä»¬çš„appä¸­,æˆ‘ä»¬è¦ä¿ç•™ä¸€äº›states,Reduxå°±æ˜¯ç”¨äºUI stateç®¡ç†çš„ç»„ä»¶.åœ¨Reduxä¹‹å¤–å¯èƒ½ä¼šæœ‰å…¶ä»–éƒ¨åˆ†æ¥ç®¡ç†state,ä¾‹å¦‚åƒæ˜¯REST APIçš„ç¼“å­˜æˆ–è€…GraphQL.åœ¨Meteorä¸­,å¯èƒ½æ˜¯Minimongo cache.</p>
<p> ###Reduxä¸­çš„å¯¼èˆª<br> update:<br>  åœ¨è¯„è®ºå’Œå…¶ä»–åœ°æ–¹,æˆ‘å‡†å¤‡è¯•è¯•simple-redux-router.çœ‹èµ·æ¥å¯ä»¥åœ¨Reduxä¸­è¿›è¡Œå¯¼èˆª.ä»–å…è®¸Reactè·¯ç”±å™¨ç®¡ç†å¸ƒå±€å’Œdispatch actionsåˆ°store.<br>  æˆ‘æŠŠsimple-redux-routerå’Œæˆ‘çš„sample appè¿›è¡Œæ•´åˆ,æ•´åˆè¿‡ç¨‹è¿˜å¥½é™¤äº†å³æ—¶åŠ è½½è¿‡ç¨‹.<br>  ç°åœ¨,æˆ‘ä»¬å‡†å¤‡æŠŠReact Routerå’ŒReduxåˆå¹¶.ä½†æ˜¯æˆ‘ä»¬ä»”ç»†è€ƒè™‘ä¸€ä¸‹å°±å¯ä»¥å‘ç°,routing(è·¯ç”±)å…¶å®æ˜¯å¦ä¸€ç§ç”¨æˆ·çš„action,ç±»ä¼¼æŒ‰é’®çš„ç‚¹å‡»action.æ‰€ä»¥routerä¸åº”è¯¥æˆä¸ºappçš„ç®¡ç†æˆ–è€…app stateçš„ç®¡ç†å·¥å…·.<br>  ç†æƒ³Reduxä¸­çš„routeråº”è¯¥åº”routeçš„æ”¹å˜è€Œå‘èµ·actions.è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦åšçš„å·¥ä½œ.ç„¶åæˆ‘ä»¬ä½¿ç”¨reduceræ¥æ”¹å˜éœ€è¦çš„app state.</p>
<h3 id="ä½¿ç”¨æ¨¡å—çš„ç›®å½•ç»“æ„"><a href="#ä½¿ç”¨æ¨¡å—çš„ç›®å½•ç»“æ„" class="headerlink" title="ä½¿ç”¨æ¨¡å—çš„ç›®å½•ç»“æ„"></a>ä½¿ç”¨æ¨¡å—çš„ç›®å½•ç»“æ„</h3><p>  æ¨èçš„æ˜¯é»˜è®¤çš„å¸ƒå±€ç›®å½•ç»“æ„.ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„ç‰¹æ€§æ—¶,æˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ªç›®å½•ä¸­æ·»åŠ ä»£ç .<br>  æœ‰ä¸€ä¸ªæ¨¡å¼å«åš<code>é¸­å­</code>æ¨¡å‹,å»ºè®®æˆ‘ä»¬æŒ‰ç»„æŠŠç›¸å…³çš„actions creatorså’Œreduceræ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­.æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•.æˆ‘ä»¬ä¹Ÿå‡†å¤‡æŠŠç›¸äº’å…³è”çš„ç»„ä»¶å’Œredux containeræ”¾åˆ°ä¸€ä¸ªå•ä¸€ç›®å½•ä¸­.</p>
<p>  ###ç”¨äºæ•°æ®åŠ è½½çš„ä¸€äº›åŠ©æ‰‹å‡½æ•°.</p>
<p>  æˆ‘ä»¬éœ€è¦æ•°æ®æ¥æ¸²æŸ“ç»„ä»¶,é€šå¸¸æˆ‘ä»¬é€šè¿‡action creatoræ¥åšè¿™ä»¶äº‹.ä½†æ˜¯ä¸ºäº†æŠŠæ•°æ®åŠ è½½å’Œç»„ä»¶æ¸²æŸ“å¾ˆå¥½çš„æ•´åˆåœ¨ä¸€èµ·,æˆ‘ä»¬éœ€è¦å†™ä¸€äº›æ¨¡æ¿å¼çš„ä»£ç .æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›åŠ©æ‰‹æ–¹æ³•æ¥æ¶ˆé™¤è¿™äº›æ¨¡æ¿ä»£ç .</p>
<p>  ###æ•´åˆåœ¨ä¸€èµ·<br>  ä¸ºäº†å……åˆ†ç†è§£è¿™äº›ç†å¿µ,æˆ‘ä»¬å¿…éœ€è¯»ä¸€äº›ä»£ç .è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ„å»ºå®ä¾‹ä»£ç appçš„åŸå› .<br>  è¿™é‡Œæ˜¯repo:<a href="https://github.com/kadira-samples/rethinking-redux-demo" target="_blank" rel="external">rethinking-redux-demo</a>.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç¿»è¯‘-ä¸­é—´ä»¶å’ŒReact-Redux-ç”Ÿå‘½å‘¨æœŸ]]></title>
      <url>http://yoursite.com/2017/03/01/%E7%BF%BB%E8%AF%91-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%92%8CReact-Redux-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      <content type="html"><![CDATA[<blockquote>
<p><em>rajaraodv </em> <a href="https://medium.com/@rajaraodv/using-middlewares-in-react-redux-apps-f7c9652610c6#.fu82u8qjf" target="_blank" rel="external">åŸæ–‡è¯·å‚çœ‹</a>.</p>
<p>å¦‚æœä½ ä½¿ç”¨è¿‡ç±»ä¼¼Express.jsæ¡†æ¶æ„å»ºNode.jsç¨‹åº,ä½ å°±å¯èƒ½åœ¨ä½¿ç”¨ä¸­é—´ä»¶,å¹¶ä¸”çŸ¥é“ä»–ä»¬æ€ä¹ˆå·¥ä½œ.Reduxç»™å‰ç«¯å¼•å…¥åŒæ ·çš„æ¦‚å¿µ.</p>
</blockquote>
<h2 id="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ</h2><p>ä¸­é—´ä»¶æ˜¯å¯ä»¥è¢«æ¡†æ¶è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°,åœ¨æ¡†æ¶ä¸­æ•°æ®æµç»“æŸä¹‹å‰,åœ¨æ•°æ®æµä¸­åŠ å¼ºæˆ–è€…æ”¹å˜è¾“å‡º.<br>ä¾‹å¦‚:å¦‚æœæ¡†æ¶é‡Œé¢æ²¡æœ‰ä¸­é—´ä»¶æ˜¯è¿™ä¸ªæ ·å­çš„:</p>
<p><code>funcAâ€Šâ€”â€Šcallsâ†’ funcBâ€Šâ€”â€Šcallsâ†’ funcC</code></p>
<p>æ·»åŠ äº†ä¸­é—´ä»¶ä»¥å,æ§åˆ¶æµå°±å˜ä¸º:<br><code>funcAâ€Šâ€”â€Šcallsâ†’ funcBâ€Šâ€”â€Šcallsâ†’ funcMiddleWare1â€Šâ€”â€Šback to â†’funcB. funcB â†’ then callsâ†’ funcMiddleWare2â€Šâ€”â€Šback toâ†’ funcB. funcBâ€Šâ€”â€Šfinally callsâ†’ funcC</code></p>
<p>æ³¨æ„ï¼šfuncBæœ€ç»ˆè°ƒç”¨funcCä½†æ˜¯åœ¨è°ƒç”¨funcCä¹‹å‰è¦è°ƒç”¨ä¸¤ä¸ªä¸­é—´ä»¶.</p>
<h2 id="æ²¡æœ‰ä¸­é—´ä»¶çš„Reduxç”Ÿå‘½å‘¨æœŸ"><a href="#æ²¡æœ‰ä¸­é—´ä»¶çš„Reduxç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ²¡æœ‰ä¸­é—´ä»¶çš„Reduxç”Ÿå‘½å‘¨æœŸ"></a>æ²¡æœ‰ä¸­é—´ä»¶çš„Reduxç”Ÿå‘½å‘¨æœŸ</h2><p>è®©æˆ‘ä»¬æƒ³çœ‹çœ‹Redux appç”Ÿå‘½å‘¨æœŸ,æ¥æ›´å¥½çš„ç†è§£å®ƒ.</p>
<p>åœºæ™¯:ç‚¹å‡»â€Click Meâ€æŒ‰é’®,æ›´æ–°â€Clicked xyz timesâ€ æ–‡æœ¬.</p>
<p>å›¾ç‰‡1</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-da53be67e7cd17d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="1*9E8kenASCn6TWNM9-dEL4Q.png"></p>
<p>åœºæ™¯ï¼šç°åœ¨,å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™,æˆ‘ä»¬æƒ³æŠŠç‚¹å‡»çš„æ•°ç›®ä¿å­˜åˆ°æœåŠ¡å™¨,å¹¶ä¸”åœ¨debuggä¸­å±•ç¤ºstateçš„å˜åŒ–æ—¥å¿—.è®©æˆ‘ä»¬çœ‹çœ‹ç°åœ¨çš„æ§åˆ¶æµ.</p>
<p>å›¾ç‰‡2</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2044710-196ed4d492237d61.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="1*kzLsHNZpJ9HVA4On9YkgAw.png"></p>
<p>åœ¨Reduxä¸­,ä¸­é—´ä»¶å‡½æ•°ä¸€ä¸ªæ¥ä¸€ä¸ªçš„è¢«è°ƒç”¨,ç›´åˆ°æ‰€æœ‰çš„ä¸­é—´ä»¶è¢«è°ƒç”¨,ç„¶åâ€œActionâ€å¯¹è±¡å‘—å‘é€åˆ°â€œReducerâ€.</p>
<p>æ³¨æ„:è¿™å°±å…è®¸ä¸­é—´ä»¶æœ‰ä¿®æ”¹Actionå¯¹è±¡çš„æ½œåŠ›,åœ¨æœ€ç»ˆè°ƒç”¨Reducersä¹‹å‰,è§£æAJAXè°ƒç”¨,è¿˜å¯ä»¥åšå…¶ä»–äº‹æƒ…æ¯”å¦‚æ—¥å¿—.Reeucerså°†ä¼šæ›´æ–°state,åœ¨appéœ€è¦çš„æ—¶å€™æ¸²æŸ“ç»„ä»¶.</p>
<h2 id="ä½¿ç”¨ä¸­é—´ä»¶"><a href="#ä½¿ç”¨ä¸­é—´ä»¶" class="headerlink" title="ä½¿ç”¨ä¸­é—´ä»¶"></a>ä½¿ç”¨ä¸­é—´ä»¶</h2><p>Reduxæœ‰ä¸ªå·¨å¤§çš„ç¤¾åŒº,å·²ç»æ„å»ºäº†<a href="https://github.com/xgrommx/awesome-redux#react---a-javascript-library-for-building-user-interfaces" target="_blank" rel="external">å¤§é‡å¯ä»¥å®Œæˆå„ç§ä»»åŠ¡çš„ä¸­é—´ä»¶</a>.</p>
<p>æ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯:</p>
<ol>
<li>é€šè¿‡npm å®‰è£…</li>
<li>é…ç½®æˆ–è€…æ·»åŠ åˆ°Redux</li>
</ol>
<p>ä¾‹å¦‚ï¼šåœ¨æˆ‘å‰é¢çš„blogï¼š<a href="https://medium.com/@rajaraodv/a-guide-for-building-a-react-redux-crud-app-7fe0b8943d0f#.aenutqb0r" target="_blank" rel="external">åˆ›å»ºReact Redux CRUDç¨‹åºæŒ‡å—</a>,appä¸ºCRUDæ“ä½œåšAJAXè¯·æ±‚.<br>åœ¨é‡Œé¢,æˆ‘ä½¿ç”¨AXiosçš„åº“æ¥åšAJAXè°ƒç”¨.ä½†æ˜¯Axiosè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡.ä½†æ˜¯Actionséœ€è¦ä¼ é€’ç»™Reducersçš„æ˜¯ä¸€ä¸ªçº¯ç²¹çš„JSONå¯¹è±¡.æ‰€ä»¥åœ¨åœ¨æ•°æ®åˆ°è¾¾Reducersä¹‹å‰ä½¿ç”¨redux-promiseè§£æActionä¸­çš„Promiseå¯¹è±¡.</p>
<p>ä¸ºäº†ä½¿ç”¨,é¦–å…ˆå®‰è£….</p>
<p><code>npm install â€” save redux-promise</code></p>
<p>å†åšä¸€ç‚¹é…ç½®å·¥ä½œ:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">import</span> React <span class="keyword">from</span> â€˜reactâ€™;</div><div class="line">...</div><div class="line">import &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> â€˜reduxâ€™;</div><div class="line"><span class="keyword">import</span> rp <span class="keyword">from</span> â€˜redux-promiseâ€™; <span class="comment">// &lt;------------ MIDDLEWARE</span></div><div class="line">...</div><div class="line"><span class="comment">//add middlewares</span></div><div class="line"><span class="keyword">const</span> createStoreWithMiddleware = applyMiddleware(rp)(createStore);</div><div class="line">ReactDOM.render(</div><div class="line"> <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;createStoreWithMiddleware(reducers)&#125;</span>&gt;</span></span></div><div class="line"> <span class="tag">&lt;<span class="name">Router</span> <span class="attr">history</span>=<span class="string">&#123;browserHistory&#125;</span> <span class="attr">routes</span>=<span class="string">&#123;routes&#125;</span> /&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></div><div class="line"> , document.getElementById(â€˜bodyâ€™));</div></pre></td></tr></table></figure>
<hr>
<h2 id="ä¸­é—´ä»¶æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"><a href="#ä¸­é—´ä»¶æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ" class="headerlink" title="ä¸­é—´ä»¶æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"></a>ä¸­é—´ä»¶æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h2><p>å¦‚æœä½ çœ‹äº†<a href="https://github.com/acdlite/redux-promise" target="_blank" rel="external">redux-promise</a>,ä½ å°±å¯ä»¥çœ‹åˆ°ä»–æ˜¯æ€ä¹ˆå·¥ä½œçš„.</p>
<p>è¿™é‡Œæ˜¯ä¼ªä»£ç :</p>
<ol>
<li>Reduxè°ƒç”¨ä¸­é—´ä»¶,â€œdispatch(å‡½æ•°)â€,â€œnext(å‡½æ•°)â€å’Œâ€actionâ€œJSONå¯¹è±¡.</li>
<li>ä¸­é—´ä»¶æ£€æŸ¥â€actionâ€å¯¹è±¡,çœ‹çœ‹æ˜¯å¦æœ‰Promiseå¯¹è±¡</li>
<li>å¦‚æœæ²¡æœ‰Promiseå¯¹è±¡,è°ƒç”¨â€nextâ€œå‡½æ•°è¿”å›åˆ°Redux.</li>
<li>å¦‚æœè¿™æ ·åš,ä»–ä¼šé™„åŠ ä¸ŠæˆåŠŸæˆ–è€…å¤±è´¥çš„å›è°ƒå‡½æ•°,ç­‰å¾…æœåŠ¡å™¨çš„å“åº”.</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//redux-promise middleware source code</span></div><div class="line"><span class="keyword">import</span> &#123; isFSA &#125; <span class="keyword">from</span> <span class="string">'flux-standard-action'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPromise</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> val &amp;&amp; <span class="keyword">typeof</span> val.then === <span class="string">'function'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">promiseMiddleware</span>(<span class="params">&#123; dispatch &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="params">next</span> =&gt;</span> action =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (!isFSA(action)) &#123;</div><div class="line">      <span class="keyword">return</span> isPromise(action)</div><div class="line">        ? action.then(dispatch)</div><div class="line">        : next(action);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> isPromise(action.payload)</div><div class="line">      ? action.payload.then(</div><div class="line">          <span class="function"><span class="params">result</span> =&gt;</span> dispatch(&#123; ...action, <span class="attr">payload</span>: result &#125;),</div><div class="line">          error =&gt; dispatch(&#123; ...action, <span class="attr">payload</span>: error, <span class="attr">error</span>: <span class="literal">true</span> &#125;)</div><div class="line">        )</div><div class="line">      : next(action);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æ›´å¤šå†…å®¹è¯·çœ‹:</p>
<ol>
<li><a href="http://redux.js.org/docs/advanced/Middleware.html" target="_blank" rel="external">å®˜æ–¹Redux ä¸­é—´ä»¶æ–‡æ¡£</a></li>
<li><a href="https://github.com/xgrommx/awesome-redux#react---a-javascript-library-for-building-user-interfaces" target="_blank" rel="external">ä¸­é—´ä»¶åˆ—è¡¨</a></li>
<li>åˆ°<a href="https://medium.com/@rajaraodv/a-guide-for-building-a-react-redux-crud-app-7fe0b8943d0f#.aenutqb0r" target="_blank" rel="external">A Guide For Building A React Redux CRUD APP</a>.</li>
</ol>
<p>å°±è¿™äº›å†…å®¹äº†.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Javascript Thiså…³é”®å­—å…¨è§£æ]]></title>
      <url>http://yoursite.com/2017/01/08/This%20keywords/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2044710-9f870a42dbc62877.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/200" alt="cover.jpg"></p>
<p>ã€Šä½ ä¸çŸ¥é“çš„javascriptã€‹è¿™æœ¬ä¹¦è¯»äº†æœ‰å¥½å‡ éäº†ï¼Œä¼¼ä¹æ¯ä¸€æ¬¡è¯»éƒ½æœ‰æ–°å‘ç°ï¼Œæœ‰äº›å†…å®¹å¹¶ä¸æ˜¯ä¸€ä¸‹å­å¯ä»¥å¼„æ‡‚çš„ï¼Œæ¯æ¬¡è¯»ä¼¼ä¹éƒ½èƒ½æ˜ç™½ä¸€äº›æ¦‚å¿µã€‚<br>å†é‡è¯»ä¸€ä¸‹<code>this</code>å…³é”®å­—ã€‚è¿™ä¸ªæ¦‚å¿µéå¸¸çµæ´»ï¼Œä¹Ÿéå¸¸éš¾æŒæ¡ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ç»å¸¸è¯»è¯»æ²¡æœ‰åå¤„ã€‚æœŸå¾…javascriptä¸€æ¡¶æ±Ÿæ¹–ï¼Œè¿™æ ·å­¦ä¹ çš„æˆæœ¬å°±ä½å•¦ï¼<br>å‚è€ƒæœ¬ä¹¦çš„ç¬¬äºŒéƒ¨åˆ†çš„ç¬¬ä¸€ç« ï¼Œç¬¬äºŒç« ã€‚<a id="more"></a></p>
<blockquote>
<p>thiså…³é”®å­—æ˜¯jsä¸­æœ€æœ€å¤æ‚çš„æœºåˆ¶ä¹‹ä¸€ã€‚ä»–è¢«è‡ªåŠ¨å®šä¹‰åˆ°æ‰€æœ‰å‡½æ•°çš„ä½œç”¨åŸŸä¸­ã€‚</p>
</blockquote>
<p>åœ¨å­¦ä¹ è¿™ä¸ªå…³é”®å­—çš„è¿‡ç¨‹ä¸­ä¼¼ä¹ä¹Ÿèµ°äº†å¾ˆé•¿æ—¶é—´çš„å¼¯è·¯ã€‚ä½ è¦é—®æˆ‘ä¸ºä»€ä¹ˆèµ°äº†å¾ˆé•¿æ—¶é—´çš„å¼¯è·¯ï¼Œå…³é”®çš„åœ°æ–¹è¿˜æ˜¯æ²¡æœ‰å¯¹æ ¸å¿ƒçš„æ¦‚å¿µå½»åº•å­¦ä¹ å’Œé¢†ä¼šï¼Œè¿™ä¸€ç‚¹å’Œå°å­¦ç”Ÿå­¦ä¹ æ–°çŸ¥è¯†æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚è¦æƒ³æŒæ¡thisè¿™ä¸ªå…³é”®å­—ï¼Œéœ€è¦ç´§æ‰£å…³é”®æ¦‚å¿µï¼Œä¸è¦å‡­ç©ºæƒ³è±¡è¿™åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚</p>
<p><strong>å…³é”®æ¦‚å¿µï¼šjsä¸­çš„å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œä¸€å®šï¼Œä¸€å®šï¼Œä¸€å®šä¼šç»‘å®šåœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œåœ¨åˆ†æthiså…³é”®å­—çš„æ—¶å€™ï¼Œä¸€å®šè¦çŸ¥é“å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™è¿™ä¸ªå¯¹è±¡åˆ°åº•æ˜¯è°ï¼Ÿ</strong>ã€‚<br><strong>åˆ‡è®°ï¼šjsä¸­å‡½æ•°çš„è°ƒç”¨å’Œå®šä¹‰æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ï¼Œå‡½æ•°æ‰€ç»‘å®šçš„å¯¹è±¡ç›´åˆ°ä»–è¢«è°ƒç”¨çš„æ—¶å€™æ‰èƒ½çŸ¥é“ã€‚</strong></p>
<p>thiså…³é”®å­—çš„ä¸ç¡®å®šå®šæ˜¯æŠŠåŒåˆƒå‰‘ï¼Œä¸€æ˜¯å‡½æ•°è°ƒç”¨æ—¶çš„å¯¹è±¡ä¸ç¡®å®šæ€§ï¼Œæ˜¯jsä¸­å‡½æ•°çš„ä½¿ç”¨å…·æœ‰å¾ˆå¤§çµæ´»æ€§ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥å€Ÿç”¨å…¶ä»–å‡½æ•°æ¥å®ŒæˆåŠŸèƒ½ã€‚äºŒæ˜¯è¿™ä¹Ÿé€ æˆäº†thiså­¦ä¹ çš„ä¸€äº›å›°æ‰°ã€‚æ‰€ä»¥åœ¨å­¦ä¹ çš„æ—¶å€™å…ˆè¦ç†è§£thiså…³é”®å­—çš„ä¼˜ç‚¹ï¼Œç„¶åå†å»å­¦ä¹ é€ æˆå›°æ‰°çš„åœ°æ–¹</p>
<p>é¦–å…ˆçœ‹çœ‹ç¬¬ä¸€æ®µä»£ç <br>page 75<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">  </div><div class="line"><span class="comment">//æ³¨æ„åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æœªè°ƒç”¨ï¼Œè¿™æ—¶å€™å‡½æ•°æ˜¯æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">identify</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.name.toUpperCase();</div><div class="line">&#125;</div><div class="line"><span class="comment">//åŒä¸Šé¢çš„å‡½æ•°,ä½†æ˜¯è¿™ä¸ªå‡½æ•°å†…éƒ¨æœ‰ç‚¹å¤æ‚ï¼Œå¦‚æœä¸‹é¢çš„ä»£ç çœ‹ä¸æ‡‚</span></div><div class="line"><span class="comment">//å¯ä»¥åªçœ‹ä¸Šé¢çš„å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> greeting = <span class="string">"Hello, I'm "</span> + identify.call( <span class="keyword">this</span> );</div><div class="line">	<span class="built_in">console</span>.log( greeting );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> me = &#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå­—é¢é‡å¯¹è±¡</span></div><div class="line">	name: <span class="string">"Kyle"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> you = &#123;<span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå­—é¢é‡å¯¹è±¡</span></div><div class="line">	name: <span class="string">"Reader"</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">//é€šè¿‡callæ–¹å¼æŠŠå‡½æ•°identifyåˆ†åˆ«ç»‘å®šåˆ°ä¸¤ä¸ªå¯¹è±¡ä¸Š</span></div><div class="line"><span class="comment">//è¿™æ—¶çš„thisæ˜¯æŒ‡å‘meå¯¹è±¡ï¼Œå’Œyouå¯¹è±¡</span></div><div class="line">identify.call( me ); <span class="comment">// KYLE  </span></div><div class="line">identify.call( you ); <span class="comment">// READER</span></div><div class="line"></div><div class="line"><span class="comment">//é€šè¿‡callæ–¹å¼æŠŠå‡½æ•°callåˆ†åˆ«ç»‘å®šåˆ°ä¸¤ä¸ªå¯¹è±¡ä¸Š</span></div><div class="line"><span class="comment">//è¿™æ—¶çš„thisæ˜¯æŒ‡å‘meå¯¹è±¡ï¼Œå’Œyouå¯¹è±¡</span></div><div class="line">speak.call( me ); <span class="comment">// Hello, I'm KYLE</span></div><div class="line">speak.call( you ); <span class="comment">// Hello, I'm READER</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>åœ¨javascriptä¸­å®šä¹‰å‡½æ•°çš„æ—¶å€™ï¼Œå‡½æ•°æ˜¯ä¸å±äºä»»ä½•å¯¹è±¡çš„ã€‚è¿™ä¸€ç‚¹éå¸¸çš„å…³é”®ï¼Œéå¸¸çš„å…³é”®ï¼Œéå¸¸çš„å…³é”®ã€‚è¿™æ˜¯ç†è§£thiså…³é”®å­—çš„ç¬¬ä¸€ä¸ªéšœç¢ã€‚</p>
</blockquote>
<p>thiså…³é”®å­—åœ¨jså‡½æ•°å®šä¹‰çš„æ—¶å€™çš„ä¸ç¡®å®šæ€§ä½¿å¾—jså‡½æ•°ä½¿ç”¨æœ‰æå¤§çš„çµæ´»æ€§ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ä»–ã€‚</p>
<p>###thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>thisçš„ç»‘å®šå’Œå‡½æ•°å®šä¹‰çš„ä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåª<code>å–å†³äºå‡½æ•°è°ƒç”¨çš„æ–¹å¼</code>.<br>javascriptä¸­å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ´»åŠ¨è®°å½•(æœ‰æ—¶ä¹Ÿç§°ä¸Šä¸‹æ–‡)ã€‚è¿™ä¸ªè®°å½•åŒ…æ‹¬å‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼Œå‡½æ•°çš„è°ƒç”¨æ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ã€‚thiså°±æ˜¯è®°å½•ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚</p>
<p>è¿™æ ·åœ¨å­¦ä¹ javascriptå…³é”®å­—çš„<code>é¦–è¦é—®é¢˜æ˜¯è¦è§£å†³æ€ä¹ˆçŸ¥é“åˆ°å‡½æ•°çš„è°ƒç”¨ä½ç½®</code>.</p>
<p>###jså¯¹è±¡ç»‘å®šè§„åˆ™</p>
<p>æ¯ä¸ªjså‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ä¸€å®šè¦æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>ç»‘å®š</code>ä»¥åæ‰èƒ½ä½¿ç”¨ã€‚ è¿™é‡Œæ˜¯ç†è§£äº†jså‡½æ•°çš„å®šä¹‰å’Œè°ƒç”¨çš„åŒºåˆ«ä»¥åéœ€è¦æŒæ¡çš„ä¸€ä¸ªè§„æ¨¡æœ€åºå¤§çš„æ¦‚å¿µï¼Œåœ¨jsä¸­ä¸€å…±æœ‰å››ç§ç»‘å®šæ–¹å¼.å°±æˆ‘ä¸ªäººæ¥çœ‹ï¼Œç»‘å®šè§„åˆ™å¹¶ä¸éš¾ï¼Œ<code>éš¾ç‚¹è¿˜æ˜¯åœ¨jsçš„å‡½æ•°ä½œç”¨åŸŸçš„ç†è§£</code>. å°¤å…¶æ˜¯<code>é»˜è®¤ç»‘å®š</code>.è¿™ä¸ªç»‘å®šæ–¹å¼æœ‰æå¤§çš„è¿·æƒ‘æ€§ã€‚</p>
<p>####é»˜è®¤ç»‘å®š<br>è¿™ä¸ªæ˜¯å‡½æ•°çš„ç‹¬ç«‹è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°ç›´æ¥è°ƒç”¨çš„æ—¶å€™ï¼Œä¼¼ä¹æ˜¯æ²¡æœ‰ç»‘å®šåˆ°å¯¹è±¡ä¸Šçš„ï¼Œä½†æ˜¯æ ¹æ®å‰é¢çš„ä»‹ç»ï¼Œjsä¸­å‡½æ•°è°ƒç”¨æ—¶å¿…é¡»è¦ç»‘å®šåˆ°ä¸€ä¸ªå¯¹è±¡ä¸Šã€‚<br>çœ‹ä¸‹é¢ä»£ç  page 83</p>
<pre><code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">//è¿™æ˜¯å‡½æ•°çš„å®šä¹‰ä½ç½®</span></div><div class="line">	<span class="built_in">console</span>.log( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;<span class="comment">//è¿™ä¸ªå˜é‡å®šä¹‰çš„å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä»…ä»…æ˜¯èµ‹å€¼ç»™aå—ï¼Ÿ</span></div><div class="line"></div><div class="line">  foo(); <span class="comment">// 2  //è¿™æ˜¯å‡½æ•°çš„è°ƒç”¨ä½ç½®ã€‚ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡º2å‘¢ï¼Ÿ</span></div></pre></td></tr></table></figure>
</code></pre><blockquote>
<p>å¾ˆå¤šå‡½æ•°éƒ½æ˜¯è¿™ä¹ˆè°ƒç”¨çš„ï¼Œç…§çŒ«ç”»è™ä¹Ÿå¯ä»¥å†™å‡ºæ¥ï¼Œä½†æ˜¯ç†è§£äº†å…·ä½“çš„å«ä¹‰å°±ä¸ä¸€æ ·äº†ã€‚<br>fooè¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸä¸­(windowä½œç”¨åŸŸä¸­)ï¼Œå·§åˆçš„æ˜¯ä»–çš„è°ƒç”¨ä¹Ÿæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæ³¨æ„è¿™ä»…ä»…æ˜¯å·§åˆï¼Œå·§åˆã€‚ é‚£ä¹ˆfoo()è°ƒç”¨çš„æ—¶å€™ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡ºå˜é‡ açš„å€¼å‘¢ï¼Ÿå°½ç®¡ä½¿ç”¨äº†varè¿™ä¸ªå…³é”®å­—ï¼Œä½†æ˜¯åˆ†æä½œç”¨åŸŸå¯ä»¥çŸ¥é“ï¼Œaè¿™ä¸ªå˜é‡å®é™…æ˜¯å…¨å±€å˜é‡ï¼Œè¯´çš„å†æ˜ç™½ä¸€ç‚¹ï¼Œaå®é™…æ˜¯windowè¿™ä¸ªå…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œ2æ˜¯è¿™ä¸ªå±æ€§çš„å±æ€§å€¼ã€‚<br>foo()è°ƒç”¨çš„æ—¶å€™æ˜¯ä¸€ä¸ä¸æŒ‚çš„å…¨è£¸çŠ¶æ€ï¼Œä»…ä»…æ˜¯å‡½æ•°æœ¬èº«ï¼Œæ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™ä»–ä¹Ÿæ²¡æœ‰ä»»ä½•å‡½æ•°åŒ…è£¹ï¼Œå¤„åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹é¢ï¼Œæ‰€ä»¥foo()é‡Œé¢çš„thisæ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡çš„ï¼Œå½“è¦æ‰“å°this.açš„æ—¶å€™ï¼Œå¯»æ‰¾foo()è°ƒç”¨ä½ç½®ä¼šæ‰¾åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ‰¾å…¨å±€ä½œç”¨åŸŸçš„å±æ€§this.açš„æ—¶å€™ä¼šæ‰“å°å‡º2è¿™ä¸ªå±æ€§å€¼ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨setTimeout,setIntervalå‡½æ•°çš„æ—¶å€™ï¼Œå®é™…è¿™ä¸¤ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ä¸æŒ‚çš„ï¼ŒåŒæ ·ç»‘å®šåœ¨windowå¯¹è±¡ä¸Šã€‚</p>
<p>####éšå¼ç»‘å®š</p>
<p>å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™è¢«æ·»åŠ äº†ä¿®é¥°ç¬¦ã€‚çœ‹ä¸‹é¢è¿™ä¸ªä»£ç <br>page 85</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="function">function <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="comment">//å®šä¹‰åœ¨å…¨å±€ä½œç”¨ä¸‹çš„å‡½æ•°ï¼Œä»…ä»…æ˜¯å®šä¹‰ï¼Œä¸æ˜¯è°ƒç”¨ä½ç½®</span></div><div class="line">	console.<span class="built_in">log</span>( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line">var obj = &#123; <span class="comment">//å®šä¹‰ä¸€ä¸ªå¯¹è±¡</span></div><div class="line">	a: <span class="number">2</span>,</div><div class="line">	foo: foo</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.foo(); <span class="comment">// 2  ç»™foo()å‡½æ•°æ‰¾äº†ä¸€ä¸ªå¯¹è±¡ï¼Œthiså°±æŒ‡å‘è¿™ä¸ªå¯¹è±¡äº†</span></div></pre></td></tr></table></figure>
<p>è¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼äº†ï¼Œå¦‚æœä¸å†™å‰é¢çš„objæ˜¯ä¸æ˜¯å°±æ˜¯ä¸Šé¢çš„é»˜è®¤ç»‘å®šäº†ï¼Ÿ</p>
<p><code>éšå¼ä¸¢å¤±</code><br>ç»å¸¸åœ¨jsä»£ç çš„åµŒå¥—å›è°ƒå‡½æ•°ä¸­çœ‹åˆ°åœ¨å¤–å±‚å‡½æ•°å¼€å§‹çš„ä¸€å¥ </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span>  that=<span class="keyword">this</span>; <span class="comment">//è¿™æ˜¯ä»€ä¹ˆå«ä¹‰</span></div></pre></td></tr></table></figure>
<p>æˆ–è®¸ä½ å·²ç»ä¼šç”¨äº†ï¼Œä½†æ˜¯ç†è§£äº†å…¶ä¸­æ„ä¹‰ç”¨èµ·æ¥ä¼šæ›´åŠ å¾—å¿ƒåº”æ‰‹å•Š</p>
<p>çœ‹ä¸‹é¢æ®µä»£ç .è¿™æ®µä»£ç å…¶å®ä»¥å‰æˆ‘ä¹Ÿä¸å¤ªç†è§£ï¼Œé—®é¢˜è¿˜æ˜¯æ²¡æœ‰å½»åº•é¢†æ‚Ÿjså‡½æ•°å®šä¹‰å’Œè°ƒç”¨ä¹‹é—´æ˜¯æ²¡æœ‰å…³ç³»çš„è¿™ä¸€ç‚¹ã€‚<br>page 86</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function">function <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°</span></div><div class="line">	console.<span class="built_in">log</span>( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line">var obj = &#123; <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å­—é¢é‡</span></div><div class="line">	a: <span class="number">2</span>,</div><div class="line">	foo: foo  <span class="comment">//å‡½æ•°ä½œä¸ºå¯¹å¯¹è±¡çš„å±æ€§</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">var bar = obj.foo; <span class="comment">//æŠŠobjå¯¹è±¡çš„å‡½æ•°fooå±æ€§èµ‹å€¼ç»™barå˜é‡</span></div><div class="line"><span class="comment">//è¿™é‡Œå°±æ˜¯ç†è§£è¿™ä¸ªé—®é¢˜çš„å…³é”®ï¼Œå¦‚æœä½ ç°åœ¨è®¤ä¸ºè°ƒç”¨bar()çš„æ—¶å€™ç»‘å®šçš„å¯¹è±¡</span></div><div class="line"><span class="comment">//æ˜¯objé‚£å°±å®Œå…¨æé”™äº†ã€‚è¿™ä¸ªæ—¶å€™ä»…ä»…æ˜¯æŠŠå‡½æ•°fooèµ‹å€¼ç»™äº†varå˜é‡ï¼Œ</span></div><div class="line"><span class="comment">//å¹¶æ²¡æœ‰æŠŠå¯¹è±¡ä¹Ÿç»™barå˜é‡ï¼Œå› ä¸ºè¿™é‡Œè¿˜ä¸æ˜¯foo()å‡½æ•°çš„è°ƒç”¨ä½ç½®ï¼Œç°åœ¨</span></div><div class="line"><span class="comment">//fooå‡½æ•°è¿˜æ²¡æœ‰ç»‘å®šå¯¹è±¡ï¼Œé‚£ä¹ˆè°ƒç”¨bar()çš„æ—¶å€™å¯¹è±¡åˆ°åº•æ˜¯è°ï¼Ÿä¸çŸ¥é“ã€‚</span></div><div class="line"><span class="comment">//è°ƒç”¨çš„æ—¶å€™æ‰çŸ¥é“ã€‚</span></div><div class="line"></div><div class="line">var a = <span class="string">"oops, global"</span>; <span class="comment">// ä»»ç„¶æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§</span></div><div class="line">bar(); <span class="comment">// "oops, global" è¿™é‡Œæ‰§è¡Œçš„æ˜¯é»˜è®¤ç»‘å®šï¼Œthiså°±æ˜¯å»å…¨å±€å¯¹è±¡å•¦</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿™æ®µä»£ç å°±æ˜¯ä½¿ç”¨var that=thisçš„åœºæ™¯<br>åœ¨ä½¿ç”¨å›è°ƒå‡½æ•°çš„æ—¶å€™è¦ç•™å¿ƒã€‚jsä¸­å‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ï¼Œå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¼ å…¥å‡½æ•°ã€‚ é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œäº†ï¼Œå‡½æ•°ä¸€æ—¦ä½œä¸ºå®å‚ä»£æ›¿å½¢å‚çš„æ—¶å€™ï¼Œå®é™…ä¹Ÿæ‰§è¡Œäº†å’Œä¸Šé¢ä»£ç ä¸€æ ·çš„èµ‹å€¼è¿‡ç¨‹ï¼Œå®é™…åªæ˜¯ä¼ é€’äº†å‡½æ•°æœ¬èº«ï¼ŒåŸå…ˆçš„å¯¹è±¡å°±æ²¡æœ‰äº†ã€‚</p>
<p>page 86</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function">function <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°</span></div><div class="line">	console.<span class="built_in">log</span>( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">function <span class="title">doFoo</span><span class="params">(fn)</span> </span>&#123; <span class="comment">//fnæ˜¯å½¢å‚</span></div><div class="line">	<span class="comment">// å¦‚æœå‡½æ•°ä½œä¸ºå®å‚ä¼ å…¥ç›¸å½“äºä»£ç  var fn=obj.foo</span></div><div class="line">	<span class="comment">//å’Œä¸Šé¢ä¸€æ®µä»£ç æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œåªæ˜¯å‡½æ•°æœ¬èº«ï¼Œå¹¶æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡</span></div><div class="line"></div><div class="line">	fn(); <span class="comment">// åœ¨è¿™é‡Œè°ƒç”¨çš„æ—¶å€™ï¼Œç”±äºfnåªä»£è¡¨foo()å‡½æ•°ï¼Œè¢«ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šäº†</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">var obj = &#123;</div><div class="line">	a: <span class="number">2</span>,</div><div class="line">	foo: foo</div><div class="line">&#125;;</div><div class="line"></div><div class="line">var a = <span class="string">"oops, global"</span>; <span class="comment">// `a` also property on global object</span></div><div class="line"></div><div class="line">doFoo( obj.foo ); <span class="comment">// "oops, global"ä¸è¦è¢«obj.fooè¿·æƒ‘äº†</span></div><div class="line"><span class="comment">//æ²¡æœ‰å®é™…æ‰§è¡Œå‡½æ•°çš„è°ƒç”¨ï¼Œæ­¤æ—¶obj.fooä»…ä»…ä»£è¡¨æ²¡æœ‰ç»‘å®šä»»ä½•å¯¹è±¡çš„å‡½æ•°</span></div><div class="line"></div><div class="line"><span class="comment">//è¿™ä¸ªä»£ç å—çœ‹ç€çœ¼ç†Ÿä¹ˆï¼Ÿè¿™å°±æ˜¯javascriptä¸­å›è°ƒå‡½æ•°çš„æ ·å­ï¼Œå½“</span></div><div class="line"><span class="comment">//ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›å¦ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™,è¿™ä¸ªå‚æ•°å‡½æ•°å°±æ‰¾ä¸åˆ°è‡ªå·±ç»‘å®šçš„å¯¹è±¡æ˜¯è°äº†ï¼Œ</span></div><div class="line"><span class="comment">//æ‰€ä»¥å°±é»˜è®¤ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šäº†ã€‚ä½†æ˜¯æˆ‘ä»¬æ—¢ç„¶åœ¨ä¸€ä¸ªå‡½æ•°é‡Œè°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œè‚¯å®šæ˜¯è¦ç”¨è¿™ä¸ªå‡½æ•°æ“ä½œå½“å‰çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ—¢ç„¶æ‰¾ä¸åˆ°äº†ï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨ç»™ä»–æŒ‡å®šä¸€ä¸ªå¯¹è±¡å§ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ä½¿ç”¨</span></div><div class="line"><span class="comment">//var  that=thisçš„åŸå› ã€‚æˆ‘è§‰å¾—ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œjsçš„åŠŸåŠ›è‡³å°‘ä¼šå¢åŠ 5%ğŸ˜ã€‚è‡³äºå…·ä½“ä½¿ç”¨ï¼Œæˆ‘æƒ³å†™å‡ºæ¥å…¶å®æ²¡æœ‰ä»€ä¹ˆå¿…è¦äº†ã€‚è¿™æ ·çš„ä»£</span></div><div class="line"><span class="comment">//ç éšå¤„å¯è§.</span></div></pre></td></tr></table></figure>
<p>æœ€åæˆ‘ä»¬ä¼šè¿”å›æ¥çœ‹çœ‹æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>####æ˜¾ç¤ºç»‘å®š</p>
<p>ç›´æ¥ä½¿ç”¨apply()å’Œcall()æ–¹æ³•æ¥ç»™å‡½æ•°æŒ‡å®šä¸€ä¸ªå¯¹è±¡<br>page 88</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">   <span class="function">function <span class="title">foo</span><span class="params">()</span> </span>&#123;  <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	console.<span class="built_in">log</span>( <span class="keyword">this</span>.a );</div><div class="line">&#125;</div><div class="line"></div><div class="line">var obj = &#123;  <span class="comment">//å¯¹è±¡å­—é¢é‡å®šä¹‰</span></div><div class="line">	a: <span class="number">2</span> </div><div class="line">&#125;;</div><div class="line"></div><div class="line">foo.call( obj ); <span class="comment">// 2  å¼ºåˆ¶ç»‘å®šåˆ°objå¯¹è±¡ä¸Š</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ˜¾ç¤ºç»‘å®šè¿˜ä¸èƒ½è§£å†³thisçš„ä¸¢å¤±é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…è£¹å‡½æ•°</p>
<p>page 89</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">  <span class="function">function <span class="title">foo</span><span class="params">(something)</span> </span>&#123; <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	console.<span class="built_in">log</span>( <span class="keyword">this</span>.a, something );</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a + something;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var obj = &#123; <span class="comment">//å¯¹è±¡å­—é¢é‡</span></div><div class="line">	a: <span class="number">2</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">var bar = function() &#123; åŒ…è£¹å‡½æ•°ï¼Œæ˜¾ç¤ºç»‘å®š</div><div class="line">	<span class="keyword">return</span> foo.apply( obj, arguments );</div><div class="line"> <span class="comment">//è¿”å›ç»‘å®šäº†å¯¹è±¡å’Œä¼ å…¥å‚æ•°çš„å‡½æ•°è°ƒç”¨</span></div><div class="line"> <span class="comment">//è¿™ä¸ªè¯­å¥åœ¨jsçš„ä»£ç ä¸­éå¸¸çš„å¸¸è§</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">var b = bar( <span class="number">3</span> ); <span class="comment">// 2, 3  </span></div><div class="line">console.<span class="built_in">log</span>( b ); <span class="comment">// 5</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//å¯ä»¥æŠŠç»‘å®šå‡½æ•°ç‹¬ç«‹å‡ºæ¥</span></div><div class="line"></div><div class="line"><span class="function">function <span class="title">bind</span><span class="params">(fn, obj)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> function() &#123;</div><div class="line">		<span class="keyword">return</span> fn.apply( obj, arguments );</div><div class="line">	&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>####new ç»‘å®š</p>
<blockquote>
<p>jsä¸­çš„newå…³é”®å­—å’Œjavaä¸­å®Œå…¨ä¸åŒï¼Œjsä¸­æ²¡æœ‰ç±»ï¼Œåªæœ‰å¯¹è±¡ï¼Œåœ¨jsä¸­ä½¿ç”¨new å…³é”®å­—çš„æ—¶å€™åªæ˜¯è¢«è°ƒç”¨çš„æ™®é€šå‡½æ•°</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="function">function <span class="title">foo</span><span class="params">(a)</span> </span>&#123;  <span class="comment">//å®šä¹‰å‡½æ•°</span></div><div class="line">	<span class="keyword">this</span>.a = a;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var bar = <span class="keyword">new</span> foo( <span class="number">2</span> ); <span class="comment">//ä»…ä»…æ˜¯è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°</span></div><div class="line">console.<span class="built_in">log</span>( bar.a ); <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>å¥½äº†ä»¥ä¸Šå°±æ˜¯js thisç»‘å®šçš„å››ç§æ–¹å¼ã€‚  è§£å†³çš„å…³é”®é—®é¢˜æ˜¯jsä¸­åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™åˆ°åº•æ˜¯å±äºå“ªä¸ªå¯¹è±¡çš„é—®é¢˜ã€‚ </p>
<p>åé¢è¿˜æœ‰ä¸€ç‚¹å†…å®¹ï¼Œä½†æ˜¯ä¸Šé¢çš„å†…å®¹æ˜¯æœ€é‡è¦çš„ã€‚  2017å¹´1æœˆ17æ—¥<br><code>çš„ç¡®åŒ…è£¹å‡½æ•°é‚£é‡Œå¥½åƒæ˜¯æ²¡æœ‰è®²æ¸…æ¥šï¼Œæˆ‘ä¹Ÿå¿˜äº†å½“åˆæ˜¯æ€ä¹ˆç†è§£çš„ï¼Œç­‰æˆ‘å†çœ‹çœ‹ï¼Œç„¶åæ›´æ–°ã€‚æœ‰äº›åœ°æ–¹å·²ç»åšäº†æ›´æ–°!</code></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[understanding React(1)]]></title>
      <url>http://yoursite.com/2016/05/29/understanding%20React(1)/</url>
      <content type="html"><![CDATA[<p>Rect/Reduxçš„ç³»åˆ—æ–‡ç« <a id="more"></a><br>ç†è§£Reactç¨‹åº(1)-å®‡å®™å¤§çˆ†ç‚¸çš„å¥‡ç‚¹.<br>å½“å¤§çº¦160äº¿å¹´å‰å®‡å®™å¤§çˆ†ç‚¸ä»ä¸€ä¸ªå¥‡ç‚¹å¼€å§‹çš„æ—¶å€™,ç¬¬ä¸€ç¼•å…‰åœ¨å®‡å®™ä¸­æ‰©å±•å¼€æ¥,çˆ†ç‚¸æ—¶äº§ç”Ÿçš„å®‡å®™èƒŒæ™¯è¾å°„è‡³ä»Šåœ¨å®‡å®™çš„æ—¶ç©ºä¸­åˆ°å¤„æ¸¸è¡,ä½œä¸ºä¸€ä¸ªæ™®é€šäººä¹Ÿå¯ä»¥å¾ˆå®¹æ„ŸçŸ¥åˆ°åˆ°ä»–ä»¬çš„å­˜åœ¨,ä¸ä¿¡çš„è¯æ¬å‡ºä½ å®¶é‡ŒçŠ„è§’æ—®æ—¯é‡Œè½æ»¡ç°å°˜çš„åäºŒå¯¸é»‘ç™½ç”µè§†æœº,åªè¦èƒ½ç‚¹äº®ä½ å°±å¯ä»¥æ„ŸçŸ¥åˆ°ä»–ä»¬å­˜åœ¨.é‚£ä¹ˆä»–ä»¬æ˜¯ä»€ï¼Ÿæ²¡æœ‰ç”µè§†èŠ‚ç›®çš„æ—¶å€™,æ»¡å±çš„é›ªèŠ±ç‚¹å°±æ˜¯ç”µè§†å¤©çº¿æ¥å—åˆ°çš„å®‡å®™èƒŒæ™¯è¾å°„.è‡³ä»Šå…³äºå®‡å®™å¤§çˆ†ç‚¸çš„å¥‡ç‚¹åˆ°åº•æ˜¯æ˜¯ä»€ä¹ˆï¼Ÿè°åšçš„ç¨‹åºæ¶æ„,åˆè¡·æ˜¯ä»€ä¹ˆï¼Ÿè¿·ä»ç„¶æ²¡æœ‰è§£å¼€,ç”šè‡³åœ¨å®‡å®™å¤§çˆ†ç‚¸å¼€å§‹ä¹‹å‰,è¿æ—¶é—´éƒ½æ˜¯ä¸å­˜åœ¨çš„.ç§‘å­¦å®¶å¼„ç»Ÿçš„æŠŠæ‰€æœ‰çš„æœªè§£ä¹‹è°œéƒ½ä¸¢ç»™äº†å¥‡ç‚¹,ä¸ºäº†è‡ªåœ†å…¶è¯´,åˆåˆ›å»ºäº†å…¶ä»–çš„ç†è®º.æˆ–è®¸æœ¬æ¥å°±å­˜åœ¨å¤šä¸ªå¥‡ç‚¹,æ‰€ä»¥å­˜åœ¨å¥½å¤šå¹³è¡Œçš„å®‡å®™.å¥½å§ï¼ä¸Šé¢çš„æ˜¯ä¸€ä¸ªè„‘æ´å¤§å¼€çš„è¿‡ç¨‹,ä½ å¯èƒ½ä¼šè¯´ä½ è¯´çš„è¿™äº›ä¸œè¥¿åˆ°åº•å’Œç¨‹åºå¼€å‘æœ‰åŠç‚¹å…³ç³»å—ï¼Ÿæˆ–è®¸æœ‰å§,ä¹Ÿæˆ–è®¸æ›´æœ¬æ²¡æœ‰ä»»ä½•å…³ç³».çœ‹ä½ æ˜¯æ€ä¹ˆç†è§£äº†.</p>
<p>ä¸‹é¢æˆ‘æŠŠè¿™ä¸ªä¸»é¢˜æœ‰å…³çš„å†™ä½œæƒ³æ³•è®²ä¸€ä¸‹.</p>
<ul>
<li>ç¼–ç¨‹åˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿå”¯ä¸€çš„ç›®çš„æ˜¯:<code>ä¿¡æ¯</code>.ç¼–ç¨‹å°±æ˜¯ä¼ é€’ä¿¡æ¯.Reactä½œä¸ºJavascriptç¼–ç¨‹è¯­è¨€çš„å­é›†,ä»–æ˜¯åœ¨ä¼ é€’ä¿¡æ¯å—ï¼Ÿå½“ç„¶æ˜¯äº†.å¦‚æœä½ æ˜ç™½äº†æˆ‘è¯´çš„è¿™å¥è¯,åé¢æˆ‘è¦è®²çš„é—®é¢˜å°±å®¹æ˜“å•¦. æ‰€æœ‰çš„æ•°æ®ç»“æ„åŒ…æ‹¬æ›´é«˜çº§çš„æ•°æ®åº“éƒ½æ˜¯å›´ç»•ç€<code>ä¿¡æ¯</code>æ¥è¿è½¬çš„.è¿™ä¸ªä¸»é¢˜æˆ‘åŸæœ¬æƒ³æ”¾åˆ°æœ€åæ¥å†™.å¤´è„‘é‡Œå‡ºç°è¿™ä¸ªæ¦‚å¿µçš„æ—¶å€™,å…¶å®ä¹Ÿæ˜¯ç†è§£äº†ä¸€äº›ç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µä»¥åæ‰æœ‰çš„.ä½†æˆ‘æœ¬äººä»¥å‰æ²¡æœ‰æ·±å…¥å­¦ä¹ è¿‡å…¶ä»–ç¼–ç¨‹è¯­è¨€,å¦‚æœä½ æ˜¯æ·±å…¥å­¦ä¹ å’Œäº†è§£è¿‡ä¸€ç§ç¼–ç¨‹è¯­è¨€,é‚£ä¹ˆè¿™é‡Œè®²çš„å†…å®¹å°±å®¹æ˜“ç†è§£äº†.<code>å¦‚æœæˆ‘ä»¬æŠŠä¸ºäº†è§£å†³Reactç¼–ç¨‹ä¸­å‡ºç°çš„stateç®¡ç†é—®é¢˜å¼•å…¥çš„Reduxçœ‹åšæ˜¯ä¸€ç§ç®€å•çš„æ•°æ®åº“ç³»ç»Ÿ</code>,æœ‰äº›é—®é¢˜å°±èƒ½æ‰¾åˆ°å·²çŸ¥æ¦‚å¿µä½œä¸ºç†è§£çš„ä¾æ‰˜äº†.è¿™ä¸ªæ¦‚å¿µ,å¹¶éæˆ‘è‡ªå·±æå‡º,åŸå…ˆæ˜¯æœ‰ç‚¹éšçº¦çš„æƒ³æ³•,åœ¨çœ‹äº†ä¸€æœ¬æœ‰å…³Reactæ¦‚å¿µçš„ä¹¦çš„æ—¶å€™,è§‰å¾—è¿™ä¸ªæƒ³æ³•æ˜¯å¾ˆæ­£ç¡®çš„.æ•°æ®åº“æ“ä½œæ ¸å¿ƒçš„æ¦‚å¿µå°±æ˜¯CRUD,è¿˜æœ‰å—ï¼Ÿæ•°æ®çš„éªŒè¯,æ•°æ®çš„è¿‡æ»¤ç­‰ç­‰.è¿™äº›æ¦‚å¿µå¦‚æœä½ æ¯”ç…§ä»»ä½•ä¸€ç§æ•°æ®åº“çš„æ“ä½œ,éƒ½å¯ä»¥åœ¨Reduxå’ŒReduxä¸­é—´ä»¶ä¸­æ‰¾åˆ°ç±»ä¼¼çš„æ¦‚å¿µ.</li>
<li>æ—¢ç„¶æˆ‘ä»¬è¯´åˆ°äº†å®‡å®™å¤§çˆ†ç‚¸çš„å¥‡ç‚¹ç†è®ºäº†,é‚£ä¹ˆå¦‚æœæŠŠReactç¨‹åºçœ‹æˆæ˜¯ä¸€ä¸ªå¥‡ç‚¹,æ¯”å®‡å®™å¤§çˆ†ç‚¸ç†è®ºå¹¸è¿çš„æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª<code>å¥‡ç‚¹</code>æ˜¯æ€ä¹ˆå½¢æˆçš„.Reactçš„å¥‡ç‚¹æ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶.å¯¹äºReactçš„çˆ†ç‚¸è¿‡ç¨‹,æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥å®Œå…¨è§£é‡Šæ¸…æ¥šçš„.ç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥è®©è¿™ä¸ªçˆ†ç‚¸è¿‡ç¨‹æ— é™æ¬¡çš„é‡å¤.æœ‰ç‚¹è™šå¹»äº†å§.æ²¡æœ‰å¼•å…¥é­”å¹»ç°å®ä¸»ä¹‰çš„<code>ä¸€åªæ–—é¸¡</code>[^è¿™åªæ–—é¸¡æ¥è‡ªäºé©¬å°”å…‹æ–¯çš„ã€Šæ²¡æœ‰äººå†™ä¿¡çš„ä¸Šå°‰ã€‹,å®é™…è¿™æœ¬ä¹¦æ²¡æœ‰ä»»ä½•é­”å¹»å†™è¯—ä¸»ä¹‰,é™¤äº†è¿™åªé¸¡çš„ä¸€ä¸ç‚¹æå†™]å’Œçœ‹æ–‡ç« çš„ä½ æ¥å¯¹è¯,æˆ‘å·²ç»å¦¥åäº†.è¿™ä¸ªè¿‡ç¨‹ä¼šå®é™…éœ€è¦ä¸¤æ–¹é¢çš„å†…å®¹å°±å¯ä»¥äº†,ä¸€æ˜¯Node.jsçš„çŸ¥è¯†å’Œä¸€ç‚¹React-reduxç¨‹åºåˆå§‹åŒ–çš„çŸ¥è¯†.</li>
<li>ä¸Šé¢ç¬¬ä¸€ç‚¹æˆ‘ä»¬è°ˆåˆ°äº†å§‘ä¸”å¯ä»¥æŠŠReduxçœ‹åšæ˜¯ä¸€ç§<code>æ•°æ®åº“</code>.é‚£ä¹ˆæ•°æ®åº“æ“ä½œå°±æœ‰æ•°æ®çš„å¢åˆ æ”¹æŸ¥å’Œæ•°æ®çš„éªŒè¯å’Œè¿‡æ»¤è¿‡ç¨‹,å…·ä½“çš„å®ç°è¯­å¥éƒ½åœ¨react-reduxä¸­å®ç°.å¦‚æœæ˜¯å…¶ä»–è¯­è¨€,æˆ‘ä¸çŸ¥é“æ€ä¹ˆæ¥å®ç°,å¦‚æœæ˜¯Redux,å°±å¥½åŠäº†.Reduxæ¨¡å—é‡Œçš„å†…å®¹å…¶å®æ˜¯éå¸¸å°‘çš„.å°‘åˆ°ä»€ä¹ˆç¨‹åº¦,å¯ä»¥è¿™æ ·è¯´Reduxé‡Œé¢é™¤äº†é—­åŒ…å’Œæ•°ç»„æ“ä½œå°±æ²¡æœ‰æ›´å¤šçš„å†…å®¹äº†.ä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿä¸‹é¢è¿™ä¸ªæ¦‚å¿µéå¸¸å…³é”®.<code>åœ¨javascriptä¸­,å…¶ä»–å¯¹è±¡å’Œå‡½æ•°å¯¹è±¡éƒ½æ˜¯ä¼ å¼•ç”¨èµ‹å€¼çš„</code>.æ²¡é”™!javascriptä¹‹æ‰€ä»¥èƒ½å¤Ÿæˆä¸ºä¸€é—¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€.å¯¹è±¡å’Œå‡½æ•°ä¼ å¼•ç”¨èµ‹å€¼æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ¦‚å¿µ,è¿™æ ·åšä»¥å,å‡½æ•°å’Œå¯¹è±¡å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ ‡è®°çš„<code>é”®å</code>.è¿™ä¸ªé”®åå°±å¯ä»¥åœ¨ç¨‹åºé‡Œåˆ°å¤„è¿è¡Œäº†.è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å€ŸåŠ©äºæ•°æ®åº“çš„æ“ä½œæ¦‚å¿µå’Œjavascriptçš„å‡½æ•°å¼ç¼–ç¨‹æ¦‚å¿µæ¥ç†è§£Reduxçš„æºç .è¿™ä¸€éƒ¨åˆ†å¯èƒ½ä¼šæ¯”è¾ƒå›°éš¾,å›°éš¾ç‚¹å®é™…æ˜¯æ•°ç»„çš„æ“ä½œæ–¹æ³•çš„çµæ´»åº”ç”¨,å½“ç„¶è¿˜æœ‰<code>é—­åŒ…äº†</code>.è¯´é“è¿™ä¸ªåœ°æ–¹çš„æ—¶å€™æˆ‘ä»¬åœ¨è®¨è®º,æœ¬äººå­¦ä¹ ç¼–ç¨‹æ—¶é—´ä¸é•¿,å¯¹äºè¿™äº›æ–¹æ³•æ½œç§»é»˜åŒ–çš„ä¸œè¥¿å¤ªå°‘,å†™åˆ°ç›¸å…³å†…å®¹ä¸€å®šè¯·é«˜æ‰‹æŒ‡æ•™.</li>
<li>Reduxçš„ä¸­é—´ä»¶,å®é™…åº”ç”¨ä¸­,ç®€å•çš„æµç¨‹å®é™…æ˜¯å¾ˆå°‘çš„.è¿™å¾ˆå¥½ç†è§£å•Š!å°±ç®—æ˜¯ä½ å®¶å°±åœ¨è‡ªæ¥æ°´å‚çš„å¤§é—¨å£,ä½ ä¹Ÿä¸å¯èƒ½æ¯å¤©æ‹¿ç€ä¸€ä¸ªæ¡¶å»æ°´å‚æ‰“æ°´.è‡ªæ¥æ°´å‚çš„æ°´ç»è¿‡å¾ˆå¤šé“çš„å·¥åº,å‡ºå‚çš„æ—¶å€™è¿˜è¦ç»è¿‡å¾ˆå¤šçš„ç®¡é“å’Œæ°´è¡¨æ‰èƒ½åˆ°ä½ å®¶é‡Œ.è‡ªæ¥æ°´å‚æ˜¯ä¸å¯èƒ½åš<code>å¤§è‡ªç„¶çš„æ¬è¿å·¥</code>çš„.[^è¿™ä¸ªæ˜¯çœ‹åˆ°æœ‰ä¸ªå¹½é»˜å›¾ç‰‡ï¼Œé¢˜ç›®æ˜¯æˆ‘ä»¬æ˜¯å¤§è‡ªç„¶çš„æ¬è¿å·¥,ç»“æœæ˜¯æ¡¶è£…æ°´é‡Œæœ‰åªé’è›™åœ¨æ¸¸æ³³,æ„æ€çš„ç¡®æ˜¯å¤§è‡ªç„¶æ¬è¿å·¥,é’è›™éƒ½æ¬è¿äº†].åœ¨æ•°æ®åœ¨Reactå’ŒReduxçš„æµåŠ¨ä¸­,éœ€è¦è§£å†³å¾ˆå¤šçš„ç»†èŠ‚é—®é¢˜,ä¸­é—´ä»¶å°±æ˜¯æ¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹.æœ‰æ—¶å€™äº‹æƒ…è¿˜æ²¡å®Œ.è‡ªæ¥æ°´å‚ä¼šåœ¨è‡ªæ¥æ°´ç”Ÿäº§çš„æ—¶å€™æ·»åŠ æ¼‚ç™½æ¶ˆæ¯’å‰‚.ä¸€æ—¦è¿™æ ·,é—®é¢˜å°±å˜å¾—æ›´å¤æ‚äº†.åˆ°åº•é€‰æ‹©å“ªå®¶çš„æ¬¡æ°¯é…¸é’ ,å‡ æ—¶èƒ½åˆ°è´§,æ¯å®¶çš„ä¸œè¥¿æ·»åŠ çš„æ­¥éª¤æ˜¯ä¸æ˜¯ä¸€æ ·?å¦‚æœçªç„¶ç¼ºè´§äº†,æ€ä¹ˆé€šçŸ¥ç”¨æ°´çš„äºº.è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯Reduxä¸­çš„side effectçš„æ¦‚å¿µ,è™½ç„¶ä¸åœ¨ä¸»æµç¨‹ä¸Š,ä½†æ˜¯å¯¹äºä¸»æµç¨‹è¿˜æ˜¯æœ‰å¾ˆå¤§å½±å“.Reduxåˆ°åº•æ€ä¹ˆå¤„ç†è¿™äº›ç»†èŠ‚ï¼Ÿè¿™éƒ½ä¾èµ–äºä¸­é—´ä»¶æ¥å®ç°.æ‰€ä»¥å¦‚æœè¦ç¼–å†™å¤æ‚çš„åº”ç”¨,è¿™ä¸ªåœ°æ–¹æ˜¯éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´çš„.å¦‚æœæ˜¯ç”Ÿäº§å†œå¤«å±±æ³‰è¿˜å¥½åŠ,å¦‚æœæ˜¯ç”Ÿäº§è„‰åŠ¨,é‚£é—®é¢˜å°±æ›´å¤æ‚å•¦ï¼[^å†œå¤«å±±æ³‰åªæ˜¯æ°´,è„‰åŠ¨é‡Œå°±æ·»åŠ äº†å¾ˆå¤šçš„ç»´ç”Ÿç´ ç­‰ç­‰ä¸œè¥¿].Reduxçš„ä¸­é—´ä»¶ç°åœ¨å¾ˆå¤š,ä½†æ˜¯å®é™…ä¸­ä¸å¯èƒ½æ¯ä¸ªéƒ½ç”¨åˆ°å’Œå­¦ä¹ åˆ°,æ‰€ä»¥åªæ˜¯å…³æ³¨å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸­é—´ä»¶å°±å¯ä»¥äº†.</li>
<li>javascriptçš„æ¨¡å¼è®¾è®¡åœ¨Reactå’ŒReduxä¸­çš„åº”ç”¨,æ¨¡å¼è®¾è®¡åœ¨ç¼–ç¨‹ä¸­æ— å¤„ä¸åœ¨çš„,åœ¨é«˜æ‰‹çš„æºç ä¸­çœ‹è¿™äº›æ¨¡å¼è®¾è®¡æ–¹æ³•,å¯èƒ½æ›´åŠ çš„åŸæ±åŸå‘³å’Œæ ‡å‡†,æ‰€ä»¥æˆ‘ä¹ˆä¹Ÿæ¥ç®€å•çš„è°ˆè°ˆè¿™äº›å†…å®¹,æ¨¡å¼è®¾è®¡å…¶å®å°±æ˜¯Reactå¤§çˆ†ç‚¸çš„èƒŒæ™¯è¾å°„,ä»–å°±å­˜åœ¨äºç¨‹åºçš„ä»»ä½•åœ°æ–¹.</li>
<li>æœ‰å…³æµ‹è¯•-ä½œä¸ºåˆå­¦è€…å¯¹äºç¨‹åºçš„æµ‹è¯•ç†è§£å¤ªå°‘,å€ŸåŠ©ç€è¿™æ¬¡å†™ä½œçš„æœºä¼š,åŠ æ·±è®¤è¯†.</li>
</ul>
<blockquote>
<p>å¥½äº†ï¼Œå¤§æ¦‚è¦å†™çš„ä¸œè¥¿å°±æ˜¯è¿™ä¹ˆå¤šï¼Œåç»­å°±æŒ‰ç…§è¿™ä¸ªæ¡†æ¶æ¥å†™ä½œ.æˆ‘è‡ªå·±èµ·äº†ä¸€ä¸ªåå­—å«<code>æ¡†æ¶å†™ä½œ</code>æˆ–è€…<code>å¤§çº²å†™ä½œ</code>.èµ·å› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿‡å¹´çš„æ—¶å€™åœ¨å®¶é‡Œ,åˆšå¥½è§†é¢‘ç›’å­æœ‰ã€Šå£«å…µçªå‡»ã€‹,æ‰€æœ‰åˆçœ‹äº†ä¸€é,è®°ä¸æ¸…æ˜¯çœ‹çš„ç¬¬å‡ å›äº†.ä½†æ˜¯çœ‹åˆ°æœ‰ä¸€é›†ä¸€å›¢æ”¹ç¼–çš„æ—¶å€™,å¸ˆé•¿å‡ºåœº,æˆ‘è®°å¾—æ•´ä¸ªå£«å…µçªå‡»é‡Œåªå‡ºç°è¿‡ä¸¤ä¸ªå¥³æ€§,å°±æ˜¯è¿™ä¸€é›†.å’Œå…¶ä»–çš„å›½äº§å†›äº‹é¢˜æå¤§ç›¸å¾„åº­,å…¶ä»–çš„å›½äº§å†›äº‹é¢˜æé‡Œéƒ½ä¼šå‡ºç°å‡ ä¸ªé•¿ç›¸ä¿Šç¾,æ‹¿ç€ç”µè„‘çˆ±å¥½è€…ç„Šæ¥ç”µè·¯æ¿,èº«æ‰‹ä¸å‡¡çš„,å’Œç”·ä¸»äººå…¬æç€ä¸çŸ¥é“å‡ ä¸ªè§’çš„æ‹çˆ±å…³ç³».å£«å…µçªå‡»å®Œå…¨å¯ä»¥æŠŠè¿™ä¸¤ä¸ªå¥³æ€§å˜ä¸ºè®¸ä¸‰å¤šå°æ—¶å€™åŒç­çš„ä¸‘å°é¸­,çªç„¶ä¸€ä¸‹çªå˜ä¸ºå£«å…µçªå‡»é‡Œçš„è½åœ¨çª è‡¼é‡Œçš„å¥³ä¸»äººå…¬.åœ¨åŸå…ˆ25é›†çš„ä¸»çº¿é‡Œåœ¨æ·»åŠ è¿™ä¹ˆä¸€ä¸ªä¸­é—´ä»¶,åœ¨æ‹25é›†ä¹Ÿä¸æˆé—®é¢˜å•Š.æ·»åŠ è¿™ä¸ªä¸­é—´ä»¶ä»¥å,é—®é¢˜å°±å¤æ‚äº†,è¿™å¥³ä¸»äººå…¬å¯èƒ½æ˜¯æˆææˆ–è€…ä¼å…­ä¸€çš„å¦¹å¦¹[^æˆæ,ä¼å…­ä¸€å’Œè®¸ä¸‰å¤šæ˜¯åŒä¹¡å—·].å“ˆå“ˆside effectå‡ºç°äº†.åé¢ç¼–å‰§æƒ³æ”¶ç¬”å°±å¾ˆéš¾åˆ¹è½¦äº†. ä½ ä¹Ÿåˆ«ä»¥ä¸ºæˆ‘æ˜¯åœ¨è®²ç¬‘è¯,å¦‚æœä½ åœ¨å›¾ä¹¦é¦†çš„å†™ä½œæ ç›®é‡Œæ‰¾æ‰¾,å¯ä»¥çœ‹åˆ°ç¾å‰§å’Œç”µå½±ç¼–å‰§çš„ä¸€äº›ä¹¦ç±,éƒ½æ˜¯è¿™ä¸ªå¥—è·¯.å‘µå‘µ!ä¸èƒ½å†è®²ä¸‹å»äº†,è¦è¿™ä¹ˆå†™å¾—å¿ƒä¸­æœ‰æ¡†æ¶,è€Œè¦å½¢æˆè¿™ä¸ªæ¡†æ¶éœ€è¦çœ‹å¾ˆå¤šçš„ç±»ä¼¼æ¡†æ¶.è¿™ä¹Ÿæ˜¯å­¦ä¹ ç¼–ç¨‹çš„æ–¹æ³•,å­¦ä¹ æ›´å¤šçš„ä»£ç ,æ‰èƒ½çœ‹åˆ°é‡Œé¢çš„æ¡†æ¶.<br>ã€Šå£«å…µçªå‡»ã€‹æˆ‘çœ‹äº†å¾ˆå¤šé,Reactçš„ç¨‹åºæˆ‘ä¹Ÿçœ‹äº†å¥½å¤š,ä½ çš„é€‰æ‹©æ˜¯ä»€ä¹ˆå‘¢?</p>
</blockquote>
<hr>
<p>æ¥ä¸‹æ¥çš„ä¸€ç¯‡æˆ‘ä»¬è¦çœ‹çœ‹ä¸€ä¸ªReactçš„ç¨‹åºæ˜¯æ€ä¹ˆåŠ è½½åˆ°æµè§ˆå™¨ä¸­çš„.<br>éœ€è¦æœ‰ç‚¹<code>node.js</code>çš„åŸºç¡€çŸ¥è¯†å’Œè‡ªåŠ¨åŒ–æ‰“åŒ…ç¨‹åºçš„åŸºç¡€.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[understanding React(2)]]></title>
      <url>http://yoursite.com/2016/05/29/understanding%20React(2)/</url>
      <content type="html"><![CDATA[<p>#####understanding React2</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Redux Persist]]></title>
      <url>http://yoursite.com/2016/05/29/Redux%E5%92%8CReact%E7%BC%96%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h1 id="Redux-Persist"><a href="#Redux-Persist" class="headerlink" title="Redux Persist"></a>Redux Persist</h1><p>Persist and rehydrate a redux store.</p>
<p>Redux Persist is <a href="#why-redux-persist">performant</a>, easy to <a href="#basic-usage">implement</a>, and easy to <a href="./docs/ecosystem.md">extend</a>.</p>
<p><code>npm i --save redux-persist</code></p>
<p><a href="https://travis-ci.org/rt2zz/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/travis/rt2zz/redux-persist/master.svg?style=flat-square" alt="build status"></a><br><a href="https://www.npmjs.com/package/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/npm/v/redux-persist.svg?style=flat-square" alt="npm version"></a><br><a href="https://www.npmjs.com/package/redux-persist" target="_blank" rel="external"><img src="https://img.shields.io/npm/dm/redux-persist.svg?style=flat-square" alt="npm downloads"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><p>Basic usage requires adding a few lines to a traditional redux application:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;compose, applyMiddleware, createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> &#123;persistStore, autoRehydrate&#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"></div><div class="line"><span class="comment">// add `autoRehydrate` as an enhancer to your store (note: `autoRehydrate` is not a middleware)</span></div><div class="line"><span class="keyword">const</span> store = createStore(</div><div class="line">  reducer,</div><div class="line">  <span class="literal">undefined</span>,</div><div class="line">  compose(</div><div class="line">    applyMiddleware(...),</div><div class="line">    autoRehydrate()</div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// begin periodically persisting the store</span></div><div class="line">persistStore(store)</div></pre></td></tr></table></figure></p>
<p>For per reducer rehydration logic, you can opt-in by adding a handler to your reducer:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;REHYDRATE&#125; <span class="keyword">from</span> <span class="string">'redux-persist/constants'</span></div><div class="line"><span class="comment">//...</span></div><div class="line"><span class="keyword">case</span> REHYDRATE:</div><div class="line">  <span class="keyword">var</span> incoming = action.payload.myReducer</div><div class="line">  <span class="keyword">if</span> (incoming) <span class="keyword">return</span> &#123;...state, ...incoming, <span class="attr">specialKey</span>: processSpecial(incoming.specialKey)&#125;</div><div class="line">  <span class="keyword">return</span> state</div></pre></td></tr></table></figure></p>
<p>You may also need to configure the persistence layer, or take action after rehydration has completed:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">persistStore(store, &#123;<span class="attr">blacklist</span>: [<span class="string">'someTransientReducer'</span>]&#125;, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'rehydration complete'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>And if things get out of wack, just purge the storage<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">persistStore(store, config, callback).purge()</div></pre></td></tr></table></figure></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p><a href="./docs/api.md">Full API</a></p>
<h4 id="persistStore-store-config-callback"><a href="#persistStore-store-config-callback" class="headerlink" title="persistStore(store, [config, callback])"></a><code>persistStore(store, [config, callback])</code></h4><ul>
<li>arguments<ul>
<li><strong>store</strong> <em>redux store</em> The store to be persisted.</li>
<li><strong>config</strong> <em>object</em><ul>
<li><strong>blacklist</strong> <em>array</em> keys (read: reducers) to ignore</li>
<li><strong>whitelist</strong> <em>array</em> keys (read: reducers) to persist, if set all other keys will be ignored.</li>
<li><strong>storage</strong> <em>object</em> a <a href="https://github.com/rt2zz/redux-persist#storage-engines" target="_blank" rel="external">conforming</a> storage engine.</li>
<li><strong>transforms</strong> <em>array</em> transforms to be applied during storage and during rehydration.</li>
<li><strong>debounce</strong> <em>integer</em> debounce interval applied to storage calls (in miliseconds).</li>
<li><strong>keyPrefix</strong> <em>string</em> change localstorage default key (default: <strong>reduxPersist:</strong>) <a href="https://github.com/rt2zz/redux-persist/issues/137" target="_blank" rel="external">Discussion on why we need this feature ?</a></li>
</ul>
</li>
<li><strong>callback</strong> <em>function</em> will be called after rehydration is finished.</li>
</ul>
</li>
<li>returns <strong>persistor</strong> object</li>
</ul>
<h4 id="persistor-object"><a href="#persistor-object" class="headerlink" title="persistor object"></a><code>persistor object</code></h4><ul>
<li>the persistor object is returned by persistStore with the following methods:<ul>
<li><code>.purge(keys)</code><ul>
<li><strong>keys</strong> <em>array</em> An array of keys to be purged from storage. If not provided all keys will be purged.</li>
</ul>
</li>
<li><code>.rehydrate(incoming, options)</code><ul>
<li><strong>incoming</strong> <em>object</em> Data to be rehydrated into the store.</li>
<li><strong>options</strong> <em>object</em> If <code>serial:true</code>, incoming should be a <em>string</em>, that will be deserialized and passed through the transforms defined in the persistor.</li>
<li>Manually rehydrates the store with the passed data, dispatching the rehydrate action.</li>
</ul>
</li>
<li><code>pause()</code><ul>
<li>pauses persistence</li>
</ul>
</li>
<li><code>resume()</code><ul>
<li>resumes persistence</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="autoRehydrate-config"><a href="#autoRehydrate-config" class="headerlink" title="autoRehydrate(config)"></a><code>autoRehydrate(config)</code></h4><ul>
<li>This is a store enhancer that will automatically shallow merge the persisted state for each key. Additionally it queues any actions that are dispatched before rehydration is complete, and fires them after rehydration is finished.</li>
<li>arguments<ul>
<li><strong>config</strong> <em>object</em><ul>
<li><strong>log</strong> <em>boolean</em> Turn on debug mode. Default: <em>false</em>.</li>
<li><strong>stateReconciler</strong> <em>function</em> override the default shallow merge state reconciliation.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="constants"><a href="#constants" class="headerlink" title="constants"></a><code>constants</code></h4><ul>
<li><code>import * as constants from &#39;redux-persist/constants&#39;</code>. This includes <code>REHYDRATE</code> and <code>KEY_PREFIX</code>.</li>
</ul>
<h2 id="Alternate-Usage"><a href="#Alternate-Usage" class="headerlink" title="Alternate Usage"></a>Alternate Usage</h2><h4 id="getStoredState-createPersistor"><a href="#getStoredState-createPersistor" class="headerlink" title="getStoredState / createPersistor"></a>getStoredState / createPersistor</h4><p>If you need more control over persistence flow, you can implement <code>getStoredState</code> and <code>createPersistor</code>. For example you can skip autoRehydrate and directly pass restoredState into your store as initialState:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;getStoredState, autoRehydrate, createPersistor&#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> persistConfig = &#123; <span class="comment">/* ... */</span> &#125;</div><div class="line"></div><div class="line">getStoredState(persistConfig, (err, restoredState) =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> store = createStore(reducer, restoredState)</div><div class="line">  <span class="keyword">const</span> persistor = createPersistor(store, persistConfig)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Secondary-Persistor"><a href="#Secondary-Persistor" class="headerlink" title="Secondary Persistor"></a>Secondary Persistor</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;persistStore, createPersistor&#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"><span class="keyword">const</span> persistor = persistStore(store) <span class="comment">// persistStore restores and persists</span></div><div class="line"><span class="keyword">const</span> secondaryPersistor = createPersistor(store, &#123;<span class="attr">storage</span>: specialBackupStorage&#125;) <span class="comment">// createPersistor only persists</span></div></pre></td></tr></table></figure>
<h2 id="Storage-Engines"><a href="#Storage-Engines" class="headerlink" title="Storage Engines"></a>Storage Engines</h2><ul>
<li><strong>localStorage</strong> (default) web</li>
<li><strong>sessionStorage</strong></li>
<li><strong><a href="https://github.com/mozilla/localForage" target="_blank" rel="external">localForage</a></strong> (recommended) web, see usage below</li>
<li><strong><a href="http://facebook.github.io/react-native/docs/asyncstorage.html#content" target="_blank" rel="external">AsyncStorage</a></strong> for react-native</li>
<li><strong><a href="https://github.com/pellejacobs/redux-persist-node-storage" target="_blank" rel="external">redux-persist-node-storage</a></strong> for use in nodejs environments.</li>
<li><strong>custom</strong> any conforming storage api implementing the following methods: <code>setItem</code> <code>getItem</code> <code>removeItem</code> <code>getAllKeys</code>. [<a href="https://github.com/facebook/react-native/blob/master/Libraries/Storage/AsyncStorage.js" target="_blank" rel="external">example</a>]</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sessionStorage</span></div><div class="line"><span class="keyword">import</span> &#123; persistStore &#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"><span class="keyword">import</span> &#123; asyncSessionStorage &#125; <span class="keyword">from</span> <span class="string">'redux-persist/storages'</span></div><div class="line">persistStore(store, &#123;<span class="attr">storage</span>: asyncSessionStorage&#125;)</div><div class="line"></div><div class="line"><span class="comment">// react-native</span></div><div class="line"><span class="keyword">import</span> &#123;AsyncStorage&#125; <span class="keyword">from</span> <span class="string">'react-native'</span></div><div class="line">persistStore(store, &#123;<span class="attr">storage</span>: AsyncStorage&#125;)</div><div class="line"></div><div class="line"><span class="comment">// web with recommended localForage</span></div><div class="line"><span class="keyword">import</span> localForage <span class="keyword">from</span> <span class="string">'localForage'</span></div><div class="line">persistStore(store, &#123;<span class="attr">storage</span>: localForage&#125;)</div></pre></td></tr></table></figure>
<h2 id="Transforms"><a href="#Transforms" class="headerlink" title="Transforms"></a>Transforms</h2><p>Transforms allow for arbitrary state transforms before saving and during rehydration.</p>
<ul>
<li><a href="https://github.com/rt2zz/redux-persist-transform-immutable" target="_blank" rel="external">immutable</a> - support immutable reducers</li>
<li><a href="https://github.com/rt2zz/redux-persist-transform-compress" target="_blank" rel="external">compress</a> - compress your serialized state with lz-string</li>
<li><a href="https://github.com/maxdeviant/redux-persist-transform-encrypt" target="_blank" rel="external">encrypt</a> - encrypt your serialized state with AES</li>
<li><a href="https://github.com/edy/redux-persist-transform-filter" target="_blank" rel="external">filter</a> - store or load a subset of your state</li>
<li><a href="https://github.com/actra-development/redux-persist-transform-filter-immutable" target="_blank" rel="external">filter-immutable</a> - store or load a subset of your state with support for immutablejs</li>
<li><a href="https://github.com/gabceb/redux-persist-transform-expire" target="_blank" rel="external">expire</a> - expire a specific subset of your state based on a property</li>
<li>custom transforms:<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createTransform, persistStore &#125; <span class="keyword">from</span> <span class="string">'redux-persist'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> myTransform = createTransform(</div><div class="line">  <span class="comment">// transform state coming from redux on its way to being serialized and stored</span></div><div class="line">  (inboundState, key) =&gt; specialSerialize(inboundState, key),</div><div class="line">  <span class="comment">// transform state coming from storage, on its way to be rehydrated into redux</span></div><div class="line">  (outboundState, key) =&gt; specialDeserialize(outboundState, key),</div><div class="line">  <span class="comment">// configuration options</span></div><div class="line">  &#123;<span class="attr">whitelist</span>: [<span class="string">'specialReducer'</span>]&#125;</div><div class="line">)</div><div class="line"></div><div class="line">persistStore(store, &#123;<span class="attr">transforms</span>: [myTransform]&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Migrations"><a href="#Migrations" class="headerlink" title="Migrations"></a>Migrations</h2><p>One challenge developers encounter when persisting state for the first time is what happens when the shape of the application state changes between deployments? Solution: <a href="https://github.com/wildlifela/redux-persist-migrate" target="_blank" rel="external">redux-persist-migrate</a></p>
<h2 id="Action-Buffer"><a href="#Action-Buffer" class="headerlink" title="Action Buffer"></a>Action Buffer</h2><p>A common mistake is to fire actions that modify state before rehydration is complete which then will be overwritten by the rehydrate action. You can either defer firing of those actions until rehydration is complete, or you can use an <a href="https://github.com/rt2zz/redux-action-buffer/blob/master/README.md#redux-persist-example" target="_blank" rel="external">action buffer</a>.</p>
<h2 id="Why-Redux-Persist"><a href="#Why-Redux-Persist" class="headerlink" title="Why Redux Persist"></a>Why Redux Persist</h2><ul>
<li>Performant out of the box (uses a time iterator and operates on state partials)</li>
<li>Keeps custom rehydration logic in the reducers (where it intuitively belongs)</li>
<li>Supports localStorage, react-native AsyncStorage, or any conforming storage api</li>
</ul>
<p>Because persisting state is inherently stateful, <code>persistStore</code> lives outside of the redux store. Importantly this keeps the store â€˜pureâ€™ and makes testing and extending the persistor much easier.</p>
<h2 id="About-Auto-Rehydrate"><a href="#About-Auto-Rehydrate" class="headerlink" title="About Auto Rehydrate"></a>About Auto Rehydrate</h2><p>autoRehydrate is a store enhancer that automatically rehydrates state.</p>
<p>While auto rehydration works out of the box, individual reducers can opt in to handling their own rehydration, allowing for more complex operations like data transforms and cache invalidation. Simply define a handler for the rehydrate action in your reducer, and if the state is mutated, auto rehydrate will skip that key.</p>
<p>Auto rehydrate is provided as a convenience. In a large application, or one with atypical reducer composition, auto rehydration may not be convenient. In this case, simply omit autoRehydrate. Rehydration actions will still be fired by <code>persistStore</code>, and can then be handled individually by reducers or using a custom rehydration handler.</p>
]]></content>
    </entry>
    
  
  
</search>
